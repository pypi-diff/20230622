# Comparing `tmp/censoredsummarystats-0.2.4.tar.gz` & `tmp/censoredsummarystats-0.2.5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "censoredsummarystats-0.2.4.tar", max compression
+gzip compressed data, was "censoredsummarystats-0.2.5.tar", max compression
```

## Comparing `censoredsummarystats-0.2.4.tar` & `censoredsummarystats-0.2.5.tar`

### file list

```diff
@@ -1,7 +1,7 @@
--rw-r--r--   0        0        0       58 2023-06-21 09:23:06.539217 censoredsummarystats-0.2.4/censoredsummarystats/__init__.py
--rw-r--r--   0        0        0    56812 2023-06-22 11:23:41.042725 censoredsummarystats-0.2.4/censoredsummarystats/statistics.py
--rw-r--r--   0        0        0     2291 2023-06-21 07:54:57.800594 censoredsummarystats-0.2.4/censoredsummarystats/utils.py
--rw-r--r--   0        0        0    11558 2023-06-21 07:54:57.796594 censoredsummarystats-0.2.4/LICENSE
--rw-r--r--   0        0        0      558 2023-06-22 11:23:56.639875 censoredsummarystats-0.2.4/pyproject.toml
--rw-r--r--   0        0        0     8399 2023-06-22 11:23:41.035725 censoredsummarystats-0.2.4/README.md
--rw-r--r--   0        0        0     9029 1970-01-01 00:00:00.000000 censoredsummarystats-0.2.4/PKG-INFO
+-rw-r--r--   0        0        0       58 2023-06-21 09:23:06.539217 censoredsummarystats-0.2.5/censoredsummarystats/__init__.py
+-rw-r--r--   0        0        0    56782 2023-06-22 20:35:27.332270 censoredsummarystats-0.2.5/censoredsummarystats/statistics.py
+-rw-r--r--   0        0        0     2291 2023-06-21 07:54:57.800594 censoredsummarystats-0.2.5/censoredsummarystats/utils.py
+-rw-r--r--   0        0        0    11558 2023-06-21 07:54:57.796594 censoredsummarystats-0.2.5/LICENSE
+-rw-r--r--   0        0        0      558 2023-06-22 20:35:27.338269 censoredsummarystats-0.2.5/pyproject.toml
+-rw-r--r--   0        0        0     8399 2023-06-22 11:23:41.035725 censoredsummarystats-0.2.5/README.md
+-rw-r--r--   0        0        0     9029 1970-01-01 00:00:00.000000 censoredsummarystats-0.2.5/PKG-INFO
```

### Comparing `censoredsummarystats-0.2.4/censoredsummarystats/statistics.py` & `censoredsummarystats-0.2.5/censoredsummarystats/statistics.py`

 * *Files 0% similar despite different names*

```diff
@@ -952,2600 +952,2598 @@
 00003b70: 2077 6173 2070 6173 7365 642e 2729 0d0a   was passed.')..
 00003b80: 2020 2020 2020 2020 2020 2020 656c 7365              else
 00003b90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
 00003ba0: 2020 2023 204f 7574 7075 7420 7369 7a65     # Output size
 00003bb0: 206f 6620 6772 6f75 7073 0d0a 2020 2020   of groups..    
 00003bc0: 2020 2020 2020 2020 2020 2020 6466 203d              df =
 00003bd0: 2028 6466 2e67 726f 7570 6279 2867 726f   (df.groupby(gro
-00003be0: 7570 6279 5f63 6f6c 7329 0d0a 2020 2020  upby_cols)..    
-00003bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003c00: 2020 2020 2020 2020 2020 2e73 697a 6528            .size(
-00003c10: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00003c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003c30: 202e 7265 7365 745f 696e 6465 7828 290d   .reset_index().
-00003c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003c50: 2020 2020 2020 2020 2020 2020 2020 202e                 .
-00003c60: 7265 6e61 6d65 2863 6f6c 756d 6e73 3d7b  rename(columns={
-00003c70: 2773 697a 6527 3a20 636f 756e 745f 636f  'size': count_co
-00003c80: 6c73 5b30 5d7d 2929 0d0a 2020 2020 2020  ls[0]}))..      
-00003c90: 2020 2020 2020 2020 2020 2320 4d65 7267            # Merg
-00003ca0: 6520 636f 756e 7420 696e 666f 2074 6f20  e count info to 
-00003cb0: 7374 6174 2064 6174 610d 0a20 2020 2020  stat data..     
-00003cc0: 2020 2020 2020 2020 2020 2073 7461 745f             stat_
-00003cd0: 6461 7461 203d 2073 7461 745f 6461 7461  data = stat_data
-00003ce0: 2e6d 6572 6765 2864 662c 0d0a 2020 2020  .merge(df,..    
-00003cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003d10: 2020 2020 2020 2020 686f 773d 276f 7574          how='out
-00003d20: 6572 272c 0d0a 2020 2020 2020 2020 2020  er',..          
-00003d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003d50: 2020 6f6e 3d67 726f 7570 6279 5f63 6f6c    on=groupby_col
-00003d60: 7329 0d0a 2020 2020 2020 2020 2320 456c  s)..        # El
-00003d70: 7365 2067 726f 7570 6279 5f63 6f6c 7320  se groupby_cols 
-00003d80: 6973 206c 6973 7420 6f66 206c 6973 7473  is list of lists
-00003d90: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00003da0: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
-00003db0: 6865 636b 2074 6865 206c 6973 7420 6c65  heck the list le
-00003dc0: 6e67 7468 7320 6172 6520 6964 656e 7469  ngths are identi
-00003dd0: 6361 6c0d 0a20 2020 2020 2020 2020 2020  cal..           
-00003de0: 2069 6620 286c 656e 2863 6f75 6e74 5f63   if (len(count_c
-00003df0: 6f6c 7329 2021 3d20 6c65 6e28 6772 6f75  ols) != len(grou
-00003e00: 7062 795f 636f 6c73 2929 3a0d 0a20 2020  pby_cols)):..   
-00003e10: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00003e20: 7365 2056 616c 7565 4572 726f 7228 2763  se ValueError('c
-00003e30: 6f75 6e74 5f63 6f6c 7320 6d75 7374 2068  ount_cols must h
-00003e40: 6176 6520 7468 6520 7361 6d65 206e 756d  ave the same num
-00003e50: 6265 7220 6f66 2027 0d0a 2020 2020 2020  ber of '..      
-00003e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003e70: 2020 2020 2020 2020 2020 2027 636f 6c75             'colu
-00003e80: 6d6e 206e 616d 6573 2061 7320 7468 6572  mn names as ther
-00003e90: 6520 6172 6520 6772 6f75 7069 6e67 206c  e are grouping l
-00003ea0: 6973 7473 2069 6e20 270d 0a20 2020 2020  ists in '..     
-00003eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003ec0: 2020 2020 2020 2020 2020 2020 2767 726f              'gro
-00003ed0: 7570 6279 5f63 6f6c 732e 2729 0d0a 2020  upby_cols.')..  
-00003ee0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00003ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003f00: 2023 204c 6f6f 7020 7468 726f 7567 6820   # Loop through 
-00003f10: 6c69 7374 206f 6620 6772 6f75 7069 6e67  list of grouping
-00003f20: 7320 616e 6420 7375 6d20 636f 756e 7473  s and sum counts
-00003f30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00003f40: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00003f50: 286c 656e 2867 726f 7570 6279 5f63 6f6c  (len(groupby_col
-00003f60: 7329 293a 0d0a 2020 2020 2020 2020 2020  s)):..          
-00003f70: 2020 2020 2020 2020 2020 6466 5b63 6f75            df[cou
-00003f80: 6e74 5f63 6f6c 735b 695d 5d20 3d20 310d  nt_cols[i]] = 1.
-00003f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003fa0: 2020 2020 2064 6620 3d20 2864 662e 6772       df = (df.gr
-00003fb0: 6f75 7062 7928 6772 6f75 7062 795f 636f  oupby(groupby_co
-00003fc0: 6c73 5b69 5d29 5b63 6f75 6e74 5f63 6f6c  ls[i])[count_col
-00003fd0: 735b 3a69 2b31 5d5d 0d0a 2020 2020 2020  s[:i+1]]..      
-00003fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003ff0: 2020 2020 2020 2020 2e73 756d 2829 0d0a          .sum()..
-00004000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004010: 2020 2020 2020 2020 2020 2020 2020 2e72                .r
-00004020: 6573 6574 5f69 6e64 6578 2829 290d 0a20  eset_index()).. 
-00004030: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00004040: 204d 6572 6765 2063 6f75 6e74 2069 6e66   Merge count inf
-00004050: 6f20 746f 2073 7461 7420 6461 7461 2075  o to stat data u
-00004060: 7369 6e67 206c 6173 7420 6772 6f75 7069  sing last groupi
-00004070: 6e67 0d0a 2020 2020 2020 2020 2020 2020  ng..            
-00004080: 2020 2020 7374 6174 5f64 6174 6120 3d20      stat_data = 
-00004090: 7374 6174 5f64 6174 612e 6d65 7267 6528  stat_data.merge(
-000040a0: 6466 2c0d 0a20 2020 2020 2020 2020 2020  df,..           
-000040b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000040c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000040d0: 2068 6f77 3d27 6f75 7465 7227 2c0d 0a20   how='outer',.. 
-000040e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000040f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004100: 2020 2020 2020 2020 2020 206f 6e3d 6772             on=gr
-00004110: 6f75 7062 795f 636f 6c73 5b2d 315d 290d  oupby_cols[-1]).
-00004120: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00004130: 7374 6174 5f64 6174 610d 0a20 2020 2020  stat_data..     
-00004140: 2020 200d 0a20 2020 2020 2020 200d 0a20     ..        .. 
-00004150: 2020 2023 2525 2053 7461 7469 7374 6963     #%% Statistic
-00004160: 2069 6e74 6572 7661 6c20 6d65 7468 6f64   interval method
-00004170: 730d 0a20 2020 200d 0a20 2020 2064 6566  s..    ..    def
-00004180: 206d 6178 696d 756d 5f69 6e74 6572 7661   maximum_interva
-00004190: 6c28 7365 6c66 2c20 6772 6f75 7062 795f  l(self, groupby_
-000041a0: 636f 6c73 2c20 696e 706c 6163 6520 3d20  cols, inplace = 
-000041b0: 4661 6c73 6529 3a0d 0a20 2020 2020 2020  False):..       
-000041c0: 200d 0a20 2020 2020 2020 2023 2043 7265   ..        # Cre
-000041d0: 6174 6520 6120 636f 7079 206f 6620 7468  ate a copy of th
-000041e0: 6520 6461 7461 0d0a 2020 2020 2020 2020  e data..        
-000041f0: 6466 203d 2073 656c 662e 6461 7461 2e63  df = self.data.c
-00004200: 6f70 7928 290d 0a20 2020 2020 2020 200d  opy()..        .
-00004210: 0a20 2020 2020 2020 2023 2044 6574 6572  .        # Deter
-00004220: 6d69 6e65 206c 6566 7420 626f 756e 6420  mine left bound 
-00004230: 616e 6420 626f 756e 6461 7279 2066 6f72  and boundary for
-00004240: 206d 6178 696d 756d 206f 6620 6561 6368   maximum of each
-00004250: 2067 726f 7570 2e0d 0a20 2020 2020 2020   group...       
-00004260: 200d 0a20 2020 2020 2020 2023 2044 6574   ..        # Det
-00004270: 6572 6d69 6e65 2077 6865 7468 6572 2074  ermine whether t
-00004280: 6865 206c 6172 6765 7374 206c 6566 7420  he largest left 
-00004290: 626f 756e 6420 6973 206f 7065 6e20 6f72  bound is open or
-000042a0: 2063 6c6f 7365 6420 6279 0d0a 2020 2020   closed by..    
-000042b0: 2020 2020 2320 636f 6d70 6172 696e 6720      # comparing 
-000042c0: 7468 6520 6c61 7267 6573 7420 6f70 656e  the largest open
-000042d0: 2061 6e64 206c 6172 6765 7374 2063 6c6f   and largest clo
-000042e0: 7365 6420 626f 756e 640d 0a20 2020 2020  sed bound..     
-000042f0: 2020 206c 6566 7420 3d20 280d 0a20 2020     left = (..   
-00004300: 2020 2020 2020 2020 2064 662e 6772 6f75           df.grou
-00004310: 7062 7928 6772 6f75 7062 795f 636f 6c73  pby(groupby_cols
-00004320: 202b 205b 7365 6c66 2e6c 6566 745f 626f   + [self.left_bo
-00004330: 756e 6461 7279 5f63 6f6c 5d29 0d0a 2020  undary_col])..  
-00004340: 2020 2020 2020 2020 2020 2020 2020 5b73                [s
-00004350: 656c 662e 6c65 6674 5f62 6f75 6e64 5f63  elf.left_bound_c
-00004360: 6f6c 5d0d 0a20 2020 2020 2020 2020 2020  ol]..           
-00004370: 2020 2020 202e 6d61 7828 290d 0a20 2020       .max()..   
-00004380: 2020 2020 2020 2020 2020 2020 202e 756e               .un
-00004390: 7374 6163 6b28 7365 6c66 2e6c 6566 745f  stack(self.left_
-000043a0: 626f 756e 6461 7279 5f63 6f6c 290d 0a20  boundary_col).. 
-000043b0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-000043c0: 2020 2020 2020 2320 456e 7375 7265 2062        # Ensure b
-000043d0: 6f74 6820 626f 756e 6461 7279 2074 7970  oth boundary typ
-000043e0: 6573 2065 7869 7374 0d0a 2020 2020 2020  es exist..      
-000043f0: 2020 666f 7220 6974 656d 2069 6e20 5b27    for item in ['
-00004400: 4f70 656e 272c 2743 6c6f 7365 6427 5d3a  Open','Closed']:
-00004410: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00004420: 2069 7465 6d20 6e6f 7420 696e 206c 6566   item not in lef
-00004430: 742e 636f 6c75 6d6e 733a 0d0a 2020 2020  t.columns:..    
-00004440: 2020 2020 2020 2020 2020 2020 6c65 6674              left
-00004450: 5b69 7465 6d5d 203d 206e 702e 6e61 6e0d  [item] = np.nan.
-00004460: 0a20 2020 2020 2020 2023 2055 7365 2074  .        # Use t
-00004470: 6865 206d 6178 696d 756d 2063 6c6f 7365  he maximum close
-00004480: 6420 626f 756e 6461 7279 2069 6620 7468  d boundary if th
-00004490: 6572 6520 6172 6520 6e6f 206f 7065 6e20  ere are no open 
-000044a0: 626f 756e 6461 7269 6573 206f 720d 0a20  boundaries or.. 
-000044b0: 2020 2020 2020 2023 2069 6620 7468 6520         # if the 
-000044c0: 636c 6f73 6564 2062 6f75 6e64 6172 7920  closed boundary 
-000044d0: 6973 206c 6172 6765 7220 7468 616e 2074  is larger than t
-000044e0: 6865 206c 6172 6765 7374 206f 7065 6e20  he largest open 
-000044f0: 626f 756e 6461 7279 0d0a 2020 2020 2020  boundary..      
-00004500: 2020 636f 6e64 6974 696f 6e20 3d20 286c    condition = (l
-00004510: 6566 745b 2743 6c6f 7365 6427 5d20 3e20  eft['Closed'] > 
-00004520: 6c65 6674 5b27 4f70 656e 275d 2920 7c20  left['Open']) | 
-00004530: 286c 6566 745b 274f 7065 6e27 5d2e 6973  (left['Open'].is
-00004540: 6e61 2829 290d 0a20 2020 2020 2020 206c  na())..        l
-00004550: 6566 745b 7365 6c66 2e6c 6566 745f 626f  eft[self.left_bo
-00004560: 756e 6461 7279 5f63 6f6c 5d20 3d20 280d  undary_col] = (.
-00004570: 0a20 2020 2020 2020 2020 2020 206e 702e  .            np.
-00004580: 7768 6572 6528 636f 6e64 6974 696f 6e2c  where(condition,
-00004590: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000045a0: 2020 2020 2020 2027 436c 6f73 6564 272c         'Closed',
-000045b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000045c0: 2020 2020 2020 2027 4f70 656e 270d 0a20         'Open'.. 
-000045d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000045e0: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
-000045f0: 2020 2029 0d0a 2020 2020 2020 2020 6c65     )..        le
-00004600: 6674 5b73 656c 662e 6c65 6674 5f62 6f75  ft[self.left_bou
-00004610: 6e64 5f63 6f6c 5d20 3d20 280d 0a20 2020  nd_col] = (..   
-00004620: 2020 2020 2020 2020 206e 702e 7768 6572           np.wher
-00004630: 6528 636f 6e64 6974 696f 6e2c 0d0a 2020  e(condition,..  
-00004640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004650: 2020 206c 6566 745b 2743 6c6f 7365 6427     left['Closed'
-00004660: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-00004670: 2020 2020 2020 2020 206c 6566 745b 274f           left['O
-00004680: 7065 6e27 5d0d 0a20 2020 2020 2020 2020  pen']..         
-00004690: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-000046a0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-000046b0: 2020 2020 2020 6c65 6674 203d 206c 6566        left = lef
-000046c0: 745b 5b73 656c 662e 6c65 6674 5f62 6f75  t[[self.left_bou
-000046d0: 6e64 6172 795f 636f 6c2c 2073 656c 662e  ndary_col, self.
-000046e0: 6c65 6674 5f62 6f75 6e64 5f63 6f6c 5d5d  left_bound_col]]
-000046f0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00004700: 2020 2020 2320 4465 7465 726d 696e 6520      # Determine 
-00004710: 7269 6768 7420 626f 756e 6420 616e 6420  right bound and 
-00004720: 626f 756e 6461 7279 2066 6f72 206d 6178  boundary for max
-00004730: 696d 756d 206f 6620 6561 6368 2067 726f  imum of each gro
-00004740: 7570 2e0d 0a20 2020 2020 2020 200d 0a20  up...        .. 
-00004750: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00004760: 2023 2044 6574 6572 6d69 6e65 2077 6865   # Determine whe
-00004770: 7468 6572 2074 6865 206c 6172 6765 7374  ther the largest
-00004780: 2072 6967 6874 2062 6f75 6e64 2069 7320   right bound is 
-00004790: 6f70 656e 206f 7220 636c 6f73 6564 2062  open or closed b
-000047a0: 790d 0a20 2020 2020 2020 2023 2063 6f6d  y..        # com
-000047b0: 7061 7269 6e67 2074 6865 206c 6172 6765  paring the large
-000047c0: 7374 206f 7065 6e20 616e 6420 6c61 7267  st open and larg
-000047d0: 6573 7420 636c 6f73 6564 2062 6f75 6e64  est closed bound
-000047e0: 0d0a 2020 2020 2020 2020 7269 6768 7420  ..        right 
-000047f0: 3d20 280d 0a20 2020 2020 2020 2020 2020  = (..           
-00004800: 2064 662e 6772 6f75 7062 7928 6772 6f75   df.groupby(grou
-00004810: 7062 795f 636f 6c73 202b 205b 7365 6c66  pby_cols + [self
-00004820: 2e72 6967 6874 5f62 6f75 6e64 6172 795f  .right_boundary_
-00004830: 636f 6c5d 290d 0a20 2020 2020 2020 2020  col])..         
-00004840: 2020 2020 2020 205b 7365 6c66 2e72 6967         [self.rig
-00004850: 6874 5f62 6f75 6e64 5f63 6f6c 5d0d 0a20  ht_bound_col].. 
-00004860: 2020 2020 2020 2020 2020 2020 2020 202e                 .
-00004870: 6d61 7828 292e 0d0a 2020 2020 2020 2020  max()...        
-00004880: 2020 2020 2020 2020 756e 7374 6163 6b28          unstack(
-00004890: 7365 6c66 2e72 6967 6874 5f62 6f75 6e64  self.right_bound
-000048a0: 6172 795f 636f 6c29 0d0a 2020 2020 2020  ary_col)..      
-000048b0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-000048c0: 2023 2045 6e73 7572 6520 626f 7468 2062   # Ensure both b
-000048d0: 6f75 6e64 6172 7920 7479 7065 7320 6578  oundary types ex
-000048e0: 6973 740d 0a20 2020 2020 2020 2066 6f72  ist..        for
-000048f0: 2069 7465 6d20 696e 205b 274f 7065 6e27   item in ['Open'
-00004900: 2c27 436c 6f73 6564 275d 3a0d 0a20 2020  ,'Closed']:..   
-00004910: 2020 2020 2020 2020 2069 6620 6974 656d           if item
-00004920: 206e 6f74 2069 6e20 7269 6768 742e 636f   not in right.co
-00004930: 6c75 6d6e 733a 0d0a 2020 2020 2020 2020  lumns:..        
-00004940: 2020 2020 2020 2020 7269 6768 745b 6974          right[it
-00004950: 656d 5d20 3d20 6e70 2e6e 616e 0d0a 2020  em] = np.nan..  
-00004960: 2020 2020 2020 2320 5573 6520 7468 6520        # Use the 
-00004970: 6d61 7869 6d75 6d20 636c 6f73 6564 2062  maximum closed b
-00004980: 6f75 6e64 6172 7920 6966 2074 6865 7265  oundary if there
-00004990: 2061 7265 206e 6f20 6f70 656e 2062 6f75   are no open bou
-000049a0: 6e64 6172 6965 7320 6f72 0d0a 2020 2020  ndaries or..    
-000049b0: 2020 2020 2320 6966 2074 6865 2063 6c6f      # if the clo
-000049c0: 7365 6420 626f 756e 6461 7279 2069 7320  sed boundary is 
-000049d0: 6c61 7267 6572 2074 6861 6e20 6f72 2065  larger than or e
-000049e0: 7175 616c 2074 6f20 7468 6520 6c61 7267  qual to the larg
-000049f0: 6573 7420 0d0a 2020 2020 2020 2020 2320  est ..        # 
-00004a00: 6f70 656e 2062 6f75 6e64 6172 790d 0a20  open boundary.. 
-00004a10: 2020 2020 2020 2063 6f6e 6469 7469 6f6e         condition
-00004a20: 203d 2028 7269 6768 745b 2743 6c6f 7365   = (right['Close
-00004a30: 6427 5d20 3e3d 2072 6967 6874 5b27 4f70  d'] >= right['Op
-00004a40: 656e 275d 2920 7c20 2872 6967 6874 5b27  en']) | (right['
-00004a50: 4f70 656e 275d 2e69 736e 6128 2929 0d0a  Open'].isna())..
-00004a60: 2020 2020 2020 2020 7269 6768 745b 7365          right[se
-00004a70: 6c66 2e72 6967 6874 5f62 6f75 6e64 5f63  lf.right_bound_c
-00004a80: 6f6c 5d20 3d20 280d 0a20 2020 2020 2020  ol] = (..       
-00004a90: 2020 2020 206e 702e 7768 6572 6528 636f       np.where(co
-00004aa0: 6e64 6974 696f 6e2c 0d0a 2020 2020 2020  ndition,..      
-00004ab0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00004ac0: 6967 6874 5b27 436c 6f73 6564 275d 2c0d  ight['Closed'],.
-00004ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004ae0: 2020 2020 2020 7269 6768 745b 274f 7065        right['Ope
-00004af0: 6e27 5d0d 0a20 2020 2020 2020 2020 2020  n']..           
-00004b00: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-00004b10: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-00004b20: 2020 2020 7269 6768 745b 7365 6c66 2e72      right[self.r
-00004b30: 6967 6874 5f62 6f75 6e64 6172 795f 636f  ight_boundary_co
-00004b40: 6c5d 203d 2028 0d0a 2020 2020 2020 2020  l] = (..        
-00004b50: 2020 2020 6e70 2e77 6865 7265 2863 6f6e      np.where(con
-00004b60: 6469 7469 6f6e 2c0d 0a20 2020 2020 2020  dition,..       
-00004b70: 2020 2020 2020 2020 2020 2020 2020 2743                'C
-00004b80: 6c6f 7365 6427 2c0d 0a20 2020 2020 2020  losed',..       
-00004b90: 2020 2020 2020 2020 2020 2020 2020 274f                'O
-00004ba0: 7065 6e27 0d0a 2020 2020 2020 2020 2020  pen'..          
-00004bb0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00004bc0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-00004bd0: 2020 2020 2072 6967 6874 203d 2072 6967       right = rig
-00004be0: 6874 5b5b 7365 6c66 2e72 6967 6874 5f62  ht[[self.right_b
-00004bf0: 6f75 6e64 5f63 6f6c 2c20 7365 6c66 2e72  ound_col, self.r
-00004c00: 6967 6874 5f62 6f75 6e64 6172 795f 636f  ight_boundary_co
-00004c10: 6c5d 5d0d 0a20 2020 2020 2020 200d 0a20  l]]..        .. 
-00004c20: 2020 2020 2020 2023 204d 6572 6765 2074         # Merge t
-00004c30: 6865 2074 776f 2062 6f75 6e64 6172 6965  he two boundarie
-00004c40: 7320 746f 2063 7265 6174 6520 7468 6520  s to create the 
-00004c50: 696e 7465 7276 616c 2066 6f72 2074 6865  interval for the
-00004c60: 206d 6178 696d 756d 0d0a 2020 2020 2020   maximum..      
-00004c70: 2020 2320 4368 6563 6b20 7468 6174 2074    # Check that t
-00004c80: 6865 206d 6572 6765 2069 7320 312d 746f  he merge is 1-to
-00004c90: 2d31 0d0a 2020 2020 2020 2020 6466 203d  -1..        df =
-00004ca0: 206c 6566 742e 6d65 7267 6528 7269 6768   left.merge(righ
-00004cb0: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
-00004cc0: 2020 2020 2020 2020 2020 2020 686f 7720              how 
-00004cd0: 3d20 276f 7574 6572 272c 0d0a 2020 2020  = 'outer',..    
-00004ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004cf0: 2020 2020 6f6e 203d 2067 726f 7570 6279      on = groupby
-00004d00: 5f63 6f6c 732c 0d0a 2020 2020 2020 2020  _cols,..        
-00004d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004d20: 7661 6c69 6461 7465 203d 2027 313a 3127  validate = '1:1'
-00004d30: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-00004d40: 2020 2020 2023 2043 7265 6174 6520 6120       # Create a 
-00004d50: 636f 6c75 6d6e 2074 6861 7420 696e 6469  column that indi
-00004d60: 6361 7465 7320 7468 6520 6765 6e65 7261  cates the genera
-00004d70: 7465 6420 7374 6174 6973 7469 630d 0a20  ted statistic.. 
-00004d80: 2020 2020 2020 2064 665b 7365 6c66 2e73         df[self.s
-00004d90: 7461 745f 636f 6c5d 203d 2027 4d61 7869  tat_col] = 'Maxi
-00004da0: 6d75 6d27 0d0a 2020 2020 2020 2020 0d0a  mum'..        ..
-00004db0: 2020 2020 2020 2020 2320 5265 6f72 6465          # Reorde
-00004dc0: 7220 636f 6c75 6d6e 730d 0a20 2020 2020  r columns..     
-00004dd0: 2020 2064 6620 3d20 6466 5b5b 7365 6c66     df = df[[self
-00004de0: 2e73 7461 745f 636f 6c2c 0d0a 2020 2020  .stat_col,..    
-00004df0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00004e00: 662e 6c65 6674 5f62 6f75 6e64 6172 795f  f.left_boundary_
-00004e10: 636f 6c2c 0d0a 2020 2020 2020 2020 2020  col,..          
-00004e20: 2020 2020 2020 2073 656c 662e 6c65 6674         self.left
-00004e30: 5f62 6f75 6e64 5f63 6f6c 2c0d 0a20 2020  _bound_col,..   
-00004e40: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00004e50: 6c66 2e72 6967 6874 5f62 6f75 6e64 5f63  lf.right_bound_c
-00004e60: 6f6c 2c0d 0a20 2020 2020 2020 2020 2020  ol,..           
-00004e70: 2020 2020 2020 7365 6c66 2e72 6967 6874        self.right
-00004e80: 5f62 6f75 6e64 6172 795f 636f 6c0d 0a20  _boundary_col.. 
-00004e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ea0: 5d5d 0d0a 2020 2020 2020 2020 0d0a 2020  ]]..        ..  
-00004eb0: 2020 2020 2020 2320 5265 7365 7420 696e        # Reset in
-00004ec0: 6465 780d 0a20 2020 2020 2020 2064 6620  dex..        df 
-00004ed0: 3d20 6466 2e72 6573 6574 5f69 6e64 6578  = df.reset_index
-00004ee0: 2829 0d0a 2020 2020 2020 2020 0d0a 2020  ()..        ..  
-00004ef0: 2020 2020 2020 2320 5265 706c 6163 6520        # Replace 
-00004f00: 6f72 2072 6574 7572 6e20 7265 7375 6c74  or return result
-00004f10: 0d0a 2020 2020 2020 2020 6966 2069 6e70  ..        if inp
-00004f20: 6c61 6365 3a0d 0a20 2020 2020 2020 2020  lace:..         
-00004f30: 2020 2073 656c 662e 6461 7461 203d 2064     self.data = d
-00004f40: 660d 0a20 2020 2020 2020 2065 6c73 653a  f..        else:
-00004f50: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00004f60: 7475 726e 2064 660d 0a20 2020 200d 0a20  turn df..    .. 
-00004f70: 2020 2064 6566 206d 696e 696d 756d 5f69     def minimum_i
-00004f80: 6e74 6572 7661 6c28 7365 6c66 2c20 6772  nterval(self, gr
-00004f90: 6f75 7062 795f 636f 6c73 2c20 696e 706c  oupby_cols, inpl
-00004fa0: 6163 6520 3d20 4661 6c73 6529 3a0d 0a20  ace = False):.. 
-00004fb0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00004fc0: 2023 2043 7265 6174 6520 6120 636f 7079   # Create a copy
-00004fd0: 206f 6620 7468 6520 6461 7461 0d0a 2020   of the data..  
-00004fe0: 2020 2020 2020 6466 203d 2073 656c 662e        df = self.
-00004ff0: 6461 7461 2e63 6f70 7928 290d 0a20 2020  data.copy()..   
-00005000: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
-00005010: 2044 6574 6572 6d69 6e65 206c 6566 7420   Determine left 
-00005020: 626f 756e 6420 616e 6420 626f 756e 6461  bound and bounda
-00005030: 7279 2066 6f72 206d 696e 696d 756d 206f  ry for minimum o
-00005040: 6620 6561 6368 2067 726f 7570 2e0d 0a20  f each group... 
-00005050: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00005060: 2023 2044 6574 6572 6d69 6e65 2077 6865   # Determine whe
-00005070: 7468 6572 2074 6865 206c 6561 7374 206c  ther the least l
-00005080: 6566 7420 626f 756e 6420 6973 206f 7065  eft bound is ope
-00005090: 6e20 6f72 2063 6c6f 7365 6420 6279 0d0a  n or closed by..
-000050a0: 2020 2020 2020 2020 2320 636f 6d70 6172          # compar
-000050b0: 696e 6720 7468 6520 6c65 6173 7420 6f70  ing the least op
-000050c0: 656e 2061 6e64 206c 6561 7374 2063 6c6f  en and least clo
-000050d0: 7365 6420 626f 756e 640d 0a20 2020 2020  sed bound..     
-000050e0: 2020 206c 6566 7420 3d20 280d 0a20 2020     left = (..   
-000050f0: 2020 2020 2020 2020 2064 662e 6772 6f75           df.grou
-00005100: 7062 7928 6772 6f75 7062 795f 636f 6c73  pby(groupby_cols
-00005110: 202b 205b 7365 6c66 2e6c 6566 745f 626f   + [self.left_bo
-00005120: 756e 6461 7279 5f63 6f6c 5d29 0d0a 2020  undary_col])..  
-00005130: 2020 2020 2020 2020 2020 2020 2020 5b73                [s
-00005140: 656c 662e 6c65 6674 5f62 6f75 6e64 5f63  elf.left_bound_c
-00005150: 6f6c 5d0d 0a20 2020 2020 2020 2020 2020  ol]..           
-00005160: 2020 2020 202e 6d69 6e28 290d 0a20 2020       .min()..   
-00005170: 2020 2020 2020 2020 2020 2020 202e 756e               .un
-00005180: 7374 6163 6b28 7365 6c66 2e6c 6566 745f  stack(self.left_
-00005190: 626f 756e 6461 7279 5f63 6f6c 290d 0a20  boundary_col).. 
-000051a0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-000051b0: 2020 2020 2020 2320 456e 7375 7265 2062        # Ensure b
-000051c0: 6f74 6820 626f 756e 6461 7279 2074 7970  oth boundary typ
-000051d0: 6573 2065 7869 7374 0d0a 2020 2020 2020  es exist..      
-000051e0: 2020 666f 7220 6974 656d 2069 6e20 5b27    for item in ['
-000051f0: 4f70 656e 272c 2743 6c6f 7365 6427 5d3a  Open','Closed']:
-00005200: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00005210: 2069 7465 6d20 6e6f 7420 696e 206c 6566   item not in lef
-00005220: 742e 636f 6c75 6d6e 733a 0d0a 2020 2020  t.columns:..    
-00005230: 2020 2020 2020 2020 2020 2020 6c65 6674              left
-00005240: 5b69 7465 6d5d 203d 206e 702e 6e61 6e0d  [item] = np.nan.
-00005250: 0a20 2020 2020 2020 2023 2055 7365 2074  .        # Use t
-00005260: 6865 206d 696e 696d 756d 2063 6c6f 7365  he minimum close
-00005270: 6420 626f 756e 6461 7279 2069 6620 7468  d boundary if th
-00005280: 6572 6520 6172 6520 6e6f 206f 7065 6e20  ere are no open 
-00005290: 626f 756e 6461 7269 6573 206f 720d 0a20  boundaries or.. 
-000052a0: 2020 2020 2020 2023 2069 6620 7468 6520         # if the 
-000052b0: 636c 6f73 6564 2062 6f75 6e64 6172 7920  closed boundary 
-000052c0: 6973 206c 6573 7320 7468 616e 206f 7220  is less than or 
-000052d0: 6571 7561 6c20 746f 2074 6865 206c 6561  equal to the lea
-000052e0: 7374 0d0a 2020 2020 2020 2020 2320 6f70  st..        # op
-000052f0: 656e 2062 6f75 6e64 6172 790d 0a20 2020  en boundary..   
-00005300: 2020 2020 2063 6f6e 6469 7469 6f6e 203d       condition =
-00005310: 2028 6c65 6674 5b27 436c 6f73 6564 275d   (left['Closed']
-00005320: 203c 3d20 6c65 6674 5b27 4f70 656e 275d   <= left['Open']
-00005330: 2920 7c20 286c 6566 745b 274f 7065 6e27  ) | (left['Open'
-00005340: 5d2e 6973 6e61 2829 290d 0a20 2020 2020  ].isna())..     
-00005350: 2020 206c 6566 745b 7365 6c66 2e6c 6566     left[self.lef
-00005360: 745f 626f 756e 6461 7279 5f63 6f6c 5d20  t_boundary_col] 
-00005370: 3d20 280d 0a20 2020 2020 2020 2020 2020  = (..           
-00005380: 206e 702e 7768 6572 6528 636f 6e64 6974   np.where(condit
-00005390: 696f 6e2c 0d0a 2020 2020 2020 2020 2020  ion,..          
-000053a0: 2020 2020 2020 2020 2020 2027 436c 6f73             'Clos
-000053b0: 6564 272c 0d0a 2020 2020 2020 2020 2020  ed',..          
-000053c0: 2020 2020 2020 2020 2020 2027 4f70 656e             'Open
-000053d0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-000053e0: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-000053f0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-00005400: 2020 6c65 6674 5b73 656c 662e 6c65 6674    left[self.left
-00005410: 5f62 6f75 6e64 5f63 6f6c 5d20 3d20 280d  _bound_col] = (.
-00005420: 0a20 2020 2020 2020 2020 2020 206e 702e  .            np.
-00005430: 7768 6572 6528 636f 6e64 6974 696f 6e2c  where(condition,
-00005440: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005450: 2020 2020 2020 206c 6566 745b 2743 6c6f         left['Clo
-00005460: 7365 6427 5d2c 0d0a 2020 2020 2020 2020  sed'],..        
-00005470: 2020 2020 2020 2020 2020 2020 206c 6566               lef
-00005480: 745b 274f 7065 6e27 5d0d 0a20 2020 2020  t['Open']..     
-00005490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054a0: 290d 0a20 2020 2020 2020 2020 2020 2029  )..            )
-000054b0: 0d0a 2020 2020 2020 2020 6c65 6674 203d  ..        left =
-000054c0: 206c 6566 745b 5b73 656c 662e 6c65 6674   left[[self.left
-000054d0: 5f62 6f75 6e64 6172 795f 636f 6c2c 2073  _boundary_col, s
-000054e0: 656c 662e 6c65 6674 5f62 6f75 6e64 5f63  elf.left_bound_c
-000054f0: 6f6c 5d5d 0d0a 2020 2020 2020 2020 2020  ol]]..          
-00005500: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-00005510: 2020 2020 2020 2020 2320 4465 7465 726d          # Determ
-00005520: 696e 6520 7269 6768 7420 626f 756e 6420  ine right bound 
-00005530: 616e 6420 626f 756e 6461 7279 2066 6f72  and boundary for
-00005540: 206d 696e 696d 756d 206f 6620 6561 6368   minimum of each
-00005550: 2067 726f 7570 2e0d 0a20 2020 2020 2020   group...       
-00005560: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00005570: 2020 2023 2044 6574 6572 6d69 6e65 2077     # Determine w
-00005580: 6865 7468 6572 2074 6865 206c 6561 7374  hether the least
-00005590: 2072 6967 6874 2062 6f75 6e64 2069 7320   right bound is 
-000055a0: 6f70 656e 206f 7220 636c 6f73 6564 2062  open or closed b
-000055b0: 790d 0a20 2020 2020 2020 2023 2063 6f6d  y..        # com
-000055c0: 7061 7269 6e67 2074 6865 206c 6561 7374  paring the least
-000055d0: 206f 7065 6e20 616e 6420 6c65 6173 7420   open and least 
-000055e0: 636c 6f73 6564 2062 6f75 6e64 0d0a 2020  closed bound..  
-000055f0: 2020 2020 2020 7269 6768 7420 3d20 280d        right = (.
-00005600: 0a20 2020 2020 2020 2020 2020 2064 662e  .            df.
-00005610: 6772 6f75 7062 7928 6772 6f75 7062 795f  groupby(groupby_
-00005620: 636f 6c73 202b 205b 7365 6c66 2e72 6967  cols + [self.rig
-00005630: 6874 5f62 6f75 6e64 6172 795f 636f 6c5d  ht_boundary_col]
-00005640: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00005650: 2020 205b 7365 6c66 2e72 6967 6874 5f62     [self.right_b
-00005660: 6f75 6e64 5f63 6f6c 5d0d 0a20 2020 2020  ound_col]..     
-00005670: 2020 2020 2020 2020 2020 202e 6d69 6e28             .min(
-00005680: 292e 0d0a 2020 2020 2020 2020 2020 2020  )...            
-00005690: 2020 2020 756e 7374 6163 6b28 7365 6c66      unstack(self
-000056a0: 2e72 6967 6874 5f62 6f75 6e64 6172 795f  .right_boundary_
-000056b0: 636f 6c29 0d0a 2020 2020 2020 2020 2020  col)..          
-000056c0: 2020 290d 0a20 2020 2020 2020 2023 2045    )..        # E
-000056d0: 6e73 7572 6520 626f 7468 2062 6f75 6e64  nsure both bound
-000056e0: 6172 7920 7479 7065 7320 6578 6973 740d  ary types exist.
-000056f0: 0a20 2020 2020 2020 2066 6f72 2069 7465  .        for ite
-00005700: 6d20 696e 205b 274f 7065 6e27 2c27 436c  m in ['Open','Cl
-00005710: 6f73 6564 275d 3a0d 0a20 2020 2020 2020  osed']:..       
-00005720: 2020 2020 2069 6620 6974 656d 206e 6f74       if item not
-00005730: 2069 6e20 7269 6768 742e 636f 6c75 6d6e   in right.column
-00005740: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00005750: 2020 2020 7269 6768 745b 6974 656d 5d20      right[item] 
-00005760: 3d20 6e70 2e6e 616e 0d0a 2020 2020 2020  = np.nan..      
-00005770: 2020 2320 5573 6520 7468 6520 6d69 6e69    # Use the mini
-00005780: 6d75 6d20 636c 6f73 6564 2062 6f75 6e64  mum closed bound
-00005790: 6172 7920 6966 2074 6865 7265 2061 7265  ary if there are
-000057a0: 206e 6f20 6f70 656e 2062 6f75 6e64 6172   no open boundar
-000057b0: 6965 7320 6f72 0d0a 2020 2020 2020 2020  ies or..        
-000057c0: 2320 6966 2074 6865 2063 6c6f 7365 6420  # if the closed 
-000057d0: 626f 756e 6461 7279 2069 7320 6c65 7373  boundary is less
-000057e0: 2074 6861 6e20 7468 6520 6c65 6173 7420   than the least 
-000057f0: 6f70 656e 2062 6f75 6e64 6172 790d 0a20  open boundary.. 
-00005800: 2020 2020 2020 2063 6f6e 6469 7469 6f6e         condition
-00005810: 203d 2028 7269 6768 745b 2743 6c6f 7365   = (right['Close
-00005820: 6427 5d20 3c20 7269 6768 745b 274f 7065  d'] < right['Ope
-00005830: 6e27 5d29 207c 2028 7269 6768 745b 274f  n']) | (right['O
-00005840: 7065 6e27 5d2e 6973 6e61 2829 290d 0a20  pen'].isna()).. 
-00005850: 2020 2020 2020 2072 6967 6874 5b73 656c         right[sel
-00005860: 662e 7269 6768 745f 626f 756e 645f 636f  f.right_bound_co
-00005870: 6c5d 203d 2028 0d0a 2020 2020 2020 2020  l] = (..        
-00005880: 2020 2020 6e70 2e77 6865 7265 2863 6f6e      np.where(con
-00005890: 6469 7469 6f6e 2c0d 0a20 2020 2020 2020  dition,..       
-000058a0: 2020 2020 2020 2020 2020 2020 2020 7269                ri
-000058b0: 6768 745b 2743 6c6f 7365 6427 5d2c 0d0a  ght['Closed'],..
-000058c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000058d0: 2020 2020 2072 6967 6874 5b27 4f70 656e       right['Open
-000058e0: 275d 0d0a 2020 2020 2020 2020 2020 2020  ']..            
-000058f0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-00005900: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-00005910: 2020 2072 6967 6874 5b73 656c 662e 7269     right[self.ri
-00005920: 6768 745f 626f 756e 6461 7279 5f63 6f6c  ght_boundary_col
-00005930: 5d20 3d20 280d 0a20 2020 2020 2020 2020  ] = (..         
-00005940: 2020 206e 702e 7768 6572 6528 636f 6e64     np.where(cond
-00005950: 6974 696f 6e2c 0d0a 2020 2020 2020 2020  ition,..        
-00005960: 2020 2020 2020 2020 2020 2020 2027 436c               'Cl
-00005970: 6f73 6564 272c 0d0a 2020 2020 2020 2020  osed',..        
-00005980: 2020 2020 2020 2020 2020 2020 2027 4f70               'Op
-00005990: 656e 270d 0a20 2020 2020 2020 2020 2020  en'..           
-000059a0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-000059b0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-000059c0: 2020 2020 7269 6768 7420 3d20 7269 6768      right = righ
-000059d0: 745b 5b73 656c 662e 7269 6768 745f 626f  t[[self.right_bo
-000059e0: 756e 645f 636f 6c2c 2073 656c 662e 7269  und_col, self.ri
-000059f0: 6768 745f 626f 756e 6461 7279 5f63 6f6c  ght_boundary_col
-00005a00: 5d5d 0d0a 2020 2020 2020 2020 0d0a 2020  ]]..        ..  
-00005a10: 2020 2020 2020 2320 4d65 7267 6520 7468        # Merge th
-00005a20: 6520 7477 6f20 626f 756e 6461 7269 6573  e two boundaries
-00005a30: 2074 6f20 6372 6561 7465 2074 6865 2069   to create the i
-00005a40: 6e74 6572 7661 6c20 666f 7220 7468 6520  nterval for the 
-00005a50: 6d61 7869 6d75 6d0d 0a20 2020 2020 2020  maximum..       
-00005a60: 2023 2043 6865 636b 2074 6861 7420 7468   # Check that th
-00005a70: 6520 6d65 7267 6520 6973 2031 2d74 6f2d  e merge is 1-to-
-00005a80: 310d 0a20 2020 2020 2020 2064 6620 3d20  1..        df = 
-00005a90: 6c65 6674 2e6d 6572 6765 2872 6967 6874  left.merge(right
-00005aa0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00005ab0: 2020 2020 2020 2020 2020 2068 6f77 203d             how =
-00005ac0: 2027 6f75 7465 7227 2c0d 0a20 2020 2020   'outer',..     
-00005ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ae0: 2020 206f 6e20 3d20 6772 6f75 7062 795f     on = groupby_
-00005af0: 636f 6c73 2c0d 0a20 2020 2020 2020 2020  cols,..         
-00005b00: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00005b10: 616c 6964 6174 6520 3d20 2731 3a31 2729  alidate = '1:1')
-00005b20: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00005b30: 2020 2020 2320 4372 6561 7465 2061 2063      # Create a c
-00005b40: 6f6c 756d 6e20 7468 6174 2069 6e64 6963  olumn that indic
-00005b50: 6174 6573 2074 6865 2067 656e 6572 6174  ates the generat
-00005b60: 6564 2073 7461 7469 7374 6963 0d0a 2020  ed statistic..  
-00005b70: 2020 2020 2020 6466 5b73 656c 662e 7374        df[self.st
-00005b80: 6174 5f63 6f6c 5d20 3d20 274d 696e 696d  at_col] = 'Minim
-00005b90: 756d 270d 0a20 2020 2020 2020 200d 0a20  um'..        .. 
-00005ba0: 2020 2020 2020 2023 2052 656f 7264 6572         # Reorder
-00005bb0: 2063 6f6c 756d 6e73 0d0a 2020 2020 2020   columns..      
-00005bc0: 2020 6466 203d 2064 665b 5b73 656c 662e    df = df[[self.
-00005bd0: 7374 6174 5f63 6f6c 2c0d 0a20 2020 2020  stat_col,..     
-00005be0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00005bf0: 2e6c 6566 745f 626f 756e 6461 7279 5f63  .left_boundary_c
-00005c00: 6f6c 2c0d 0a20 2020 2020 2020 2020 2020  ol,..           
-00005c10: 2020 2020 2020 7365 6c66 2e6c 6566 745f        self.left_
-00005c20: 626f 756e 645f 636f 6c2c 0d0a 2020 2020  bound_col,..    
-00005c30: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00005c40: 662e 7269 6768 745f 626f 756e 645f 636f  f.right_bound_co
-00005c50: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
-00005c60: 2020 2020 2073 656c 662e 7269 6768 745f       self.right_
-00005c70: 626f 756e 6461 7279 5f63 6f6c 0d0a 2020  boundary_col..  
-00005c80: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00005c90: 5d0d 0a20 2020 2020 2020 200d 0a20 2020  ]..        ..   
-00005ca0: 2020 2020 2023 2052 6573 6574 2069 6e64       # Reset ind
-00005cb0: 6578 0d0a 2020 2020 2020 2020 6466 203d  ex..        df =
-00005cc0: 2064 662e 7265 7365 745f 696e 6465 7828   df.reset_index(
-00005cd0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-00005ce0: 2020 2020 2023 2052 6570 6c61 6365 206f       # Replace o
-00005cf0: 7220 7265 7475 726e 2072 6573 756c 740d  r return result.
-00005d00: 0a20 2020 2020 2020 2069 6620 696e 706c  .        if inpl
-00005d10: 6163 653a 0d0a 2020 2020 2020 2020 2020  ace:..          
-00005d20: 2020 7365 6c66 2e64 6174 6120 3d20 6466    self.data = df
-00005d30: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00005d40: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00005d50: 7572 6e20 6466 0d0a 2020 2020 0d0a 2020  urn df..    ..  
-00005d60: 2020 6465 6620 6d65 616e 5f6f 725f 7375    def mean_or_su
-00005d70: 6d5f 696e 7465 7276 616c 2873 656c 662c  m_interval(self,
-00005d80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005d90: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00005da0: 7461 742c 0d0a 2020 2020 2020 2020 2020  tat,..          
-00005db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005dc0: 2020 2067 726f 7570 6279 5f63 6f6c 732c     groupby_cols,
-00005dd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005de0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00005df0: 6e70 6c61 6365 203d 2046 616c 7365 293a  nplace = False):
-00005e00: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00005e10: 2020 2020 2320 4372 6561 7465 2061 2063      # Create a c
-00005e20: 6f70 7920 6f66 2074 6865 2064 6174 610d  opy of the data.
-00005e30: 0a20 2020 2020 2020 2064 6620 3d20 7365  .        df = se
-00005e40: 6c66 2e64 6174 612e 636f 7079 2829 0d0a  lf.data.copy()..
-00005e50: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00005e60: 2020 2320 4368 6563 6b20 666f 7220 7661    # Check for va
-00005e70: 6c69 6420 7374 6174 2066 756e 6374 696f  lid stat functio
-00005e80: 6e73 0d0a 2020 2020 2020 2020 6966 2073  ns..        if s
-00005e90: 7461 7420 6e6f 7420 696e 205b 276d 6561  tat not in ['mea
-00005ea0: 6e27 2c27 7375 6d27 5d3a 0d0a 2020 2020  n','sum']:..    
-00005eb0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00005ec0: 6c75 6545 7272 6f72 2827 4974 2069 7320  lueError('It is 
-00005ed0: 6e6f 7420 7265 636f 6d6d 656e 6465 6420  not recommended 
-00005ee0: 666f 7220 7573 6572 7320 746f 2075 7365  for users to use
-00005ef0: 2074 6865 2027 0d0a 2020 2020 2020 2020   the '..        
-00005f00: 2020 2020 2020 2020 2766 756e 6374 696f          'functio
-00005f10: 6e20 6d65 616e 5f6f 725f 7375 6d5f 696e  n mean_or_sum_in
-00005f20: 7465 7276 616c 2e20 5573 6520 6d65 616e  terval. Use mean
-00005f30: 5f69 6e74 6572 7661 6c20 6f72 2027 0d0a  _interval or '..
-00005f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005f50: 2773 756d 5f69 6e74 6572 7661 6c20 696e  'sum_interval in
-00005f60: 7374 6561 642e 2054 6f20 7573 6520 7468  stead. To use th
-00005f70: 6973 2066 756e 6374 696f 6e20 7468 6520  is function the 
-00005f80: 7661 6c75 6520 666f 7220 270d 0a20 2020  value for '..   
-00005f90: 2020 2020 2020 2020 2020 2020 2027 2273               '"s
-00005fa0: 7461 7422 206d 7573 7420 6265 2022 6d65  tat" must be "me
-00005fb0: 616e 2220 6f72 2022 7375 6d22 2e20 270d  an" or "sum". '.
-00005fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005fd0: 2066 2754 6865 2070 726f 7669 6465 6420   f'The provided 
-00005fe0: 7661 6c75 6520 7761 7320 227b 7374 6174  value was "{stat
-00005ff0: 7d22 2e27 290d 0a20 2020 2020 2020 200d  }".')..        .
-00006000: 0a20 2020 2020 2020 2023 2043 7265 6174  .        # Creat
-00006010: 6520 6120 636f 6c75 6d6e 2074 6861 7420  e a column that 
-00006020: 696e 6469 6361 7465 7320 7468 6520 6765  indicates the ge
-00006030: 6e65 7261 7465 6420 7374 6174 6973 7469  nerated statisti
-00006040: 6320 0d0a 2020 2020 2020 2020 6466 5b73  c ..        df[s
-00006050: 656c 662e 7374 6174 5f63 6f6c 5d20 3d20  elf.stat_col] = 
-00006060: 7374 6174 2e63 6170 6974 616c 697a 6528  stat.capitalize(
-00006070: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-00006080: 2020 2020 2023 2043 6861 6e67 6520 6e6f       # Change no
-00006090: 7461 7469 6f6e 206f 6620 2743 6c6f 7365  tation of 'Close
-000060a0: 6427 2061 6e64 2027 4f70 656e 2720 626f  d' and 'Open' bo
-000060b0: 756e 6461 7269 6573 2074 6f20 3020 616e  undaries to 0 an
-000060c0: 6420 312c 200d 0a20 2020 2020 2020 2023  d 1, ..        #
-000060d0: 2072 6573 7065 6374 6976 656c 792e 2054   respectively. T
-000060e0: 6865 2070 7265 7365 6e63 6520 6f66 2061  he presence of a
-000060f0: 6e79 206f 7065 6e20 626f 756e 6461 7269  ny open boundari
-00006100: 6573 206f 6e20 6f6e 6520 7369 6465 2065  es on one side e
-00006110: 6e73 7572 6573 0d0a 2020 2020 2020 2020  nsures..        
-00006120: 2320 7468 6174 2074 6865 2069 6e74 6572  # that the inter
-00006130: 7661 6c20 666f 7220 7468 6520 7265 7375  val for the resu
-00006140: 6c74 2069 7320 616c 736f 206f 7065 6e20  lt is also open 
-00006150: 6f6e 2074 6861 7420 7369 6465 0d0a 2020  on that side..  
-00006160: 2020 2020 2020 6466 5b5b 7365 6c66 2e6c        df[[self.l
-00006170: 6566 745f 626f 756e 6461 7279 5f63 6f6c  eft_boundary_col
-00006180: 2c20 7365 6c66 2e72 6967 6874 5f62 6f75  , self.right_bou
-00006190: 6e64 6172 795f 636f 6c5d 5d20 3d20 280d  ndary_col]] = (.
-000061a0: 0a20 2020 2020 2020 2020 2020 2064 665b  .            df[
-000061b0: 5b73 656c 662e 6c65 6674 5f62 6f75 6e64  [self.left_bound
-000061c0: 6172 795f 636f 6c2c 2073 656c 662e 7269  ary_col, self.ri
-000061d0: 6768 745f 626f 756e 6461 7279 5f63 6f6c  ght_boundary_col
-000061e0: 5d5d 0d0a 2020 2020 2020 2020 2020 2020  ]]..            
-000061f0: 2020 2020 2e72 6570 6c61 6365 285b 2743      .replace(['C
-00006200: 6c6f 7365 6427 2c27 4f70 656e 275d 2c20  losed','Open'], 
-00006210: 5b30 2c31 5d29 0d0a 2020 2020 2020 2020  [0,1])..        
-00006220: 2020 2020 290d 0a20 2020 2020 2020 200d      )..        .
-00006230: 0a20 2020 2020 2020 2023 2047 6574 2074  .        # Get t
-00006240: 6865 206c 6566 742f 7269 6768 7420 626f  he left/right bo
-00006250: 756e 6473 206f 6620 7468 6520 7265 7375  unds of the resu
-00006260: 6c74 2062 7920 6176 6572 6167 696e 6720  lt by averaging 
-00006270: 6f72 2061 6464 696e 6720 616c 6c20 0d0a  or adding all ..
-00006280: 2020 2020 2020 2020 2320 6c65 6674 2f72          # left/r
-00006290: 6967 6874 2062 6f75 6e64 7320 7769 7468  ight bounds with
-000062a0: 696e 2074 6865 2067 726f 7570 2e0d 0a20  in the group... 
-000062b0: 2020 2020 2020 2023 2044 6574 6572 6d69         # Determi
-000062c0: 6e65 2077 6865 7468 6572 2061 6e79 204f  ne whether any O
-000062d0: 7065 6e20 286e 6f77 2076 616c 7565 206f  pen (now value o
-000062e0: 6620 3129 2062 6f75 6e64 6172 6965 7320  f 1) boundaries 
-000062f0: 6578 6973 742e 0d0a 2020 2020 2020 2020  exist...        
-00006300: 2320 4966 2074 6865 7265 2061 7265 2061  # If there are a
-00006310: 6e79 206f 7065 6e20 626f 756e 6461 7269  ny open boundari
-00006320: 6573 2075 7365 6420 696e 2074 6865 2062  es used in the b
-00006330: 6f75 6e64 206d 6561 6e2f 7375 6d2c 0d0a  ound mean/sum,..
-00006340: 2020 2020 2020 2020 2320 7468 656e 2074          # then t
-00006350: 6865 2072 6573 756c 7469 6e67 206d 6561  he resulting mea
-00006360: 6e2f 7375 6d20 7769 6c6c 2062 6520 6f70  n/sum will be op
-00006370: 656e 0d0a 2020 2020 2020 2020 6466 203d  en..        df =
-00006380: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-00006390: 6466 2e67 726f 7570 6279 2867 726f 7570  df.groupby(group
-000063a0: 6279 5f63 6f6c 7320 2b20 5b73 656c 662e  by_cols + [self.
-000063b0: 7374 6174 5f63 6f6c 5d29 0d0a 2020 2020  stat_col])..    
-000063c0: 2020 2020 2020 2020 2020 2020 2e61 6767              .agg
-000063d0: 282a 2a7b 0d0a 2020 2020 2020 2020 2020  (**{..          
-000063e0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-000063f0: 6566 745f 626f 756e 6461 7279 5f63 6f6c  eft_boundary_col
-00006400: 3a20 2873 656c 662e 6c65 6674 5f62 6f75  : (self.left_bou
-00006410: 6e64 6172 795f 636f 6c2c 2027 6d61 7827  ndary_col, 'max'
-00006420: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-00006430: 2020 2020 2020 2020 275f 5f4d 696e 696d          '__Minim
-00006440: 756d 5f5f 273a 2028 7365 6c66 2e6c 6566  um__': (self.lef
-00006450: 745f 626f 756e 645f 636f 6c2c 2027 6d69  t_bound_col, 'mi
-00006460: 6e27 292c 0d0a 2020 2020 2020 2020 2020  n'),..          
-00006470: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00006480: 6566 745f 626f 756e 645f 636f 6c3a 2028  eft_bound_col: (
-00006490: 7365 6c66 2e6c 6566 745f 626f 756e 645f  self.left_bound_
-000064a0: 636f 6c2c 2073 7461 7429 2c0d 0a20 2020  col, stat),..   
-000064b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000064c0: 2073 656c 662e 7269 6768 745f 626f 756e   self.right_boun
-000064d0: 645f 636f 6c3a 2028 7365 6c66 2e72 6967  d_col: (self.rig
-000064e0: 6874 5f62 6f75 6e64 5f63 6f6c 2c20 7374  ht_bound_col, st
-000064f0: 6174 292c 0d0a 2020 2020 2020 2020 2020  at),..          
-00006500: 2020 2020 2020 2020 2020 275f 5f4d 6178            '__Max
-00006510: 696d 756d 5f5f 273a 2028 7365 6c66 2e72  imum__': (self.r
-00006520: 6967 6874 5f62 6f75 6e64 5f63 6f6c 2c20  ight_bound_col, 
-00006530: 276d 6178 2729 2c0d 0a20 2020 2020 2020  'max'),..       
-00006540: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00006550: 662e 7269 6768 745f 626f 756e 6461 7279  f.right_boundary
-00006560: 5f63 6f6c 3a20 2873 656c 662e 7269 6768  _col: (self.righ
-00006570: 745f 626f 756e 6461 7279 5f63 6f6c 2c20  t_boundary_col, 
-00006580: 276d 6178 2729 0d0a 2020 2020 2020 2020  'max')..        
-00006590: 2020 2020 2020 2020 2020 2020 7d29 0d0a              })..
-000065a0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-000065b0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000065c0: 2023 2052 6570 6c61 6365 2069 6e74 6567   # Replace integ
-000065d0: 6572 7320 7769 7468 2074 6578 7420 666f  ers with text fo
-000065e0: 7220 626f 756e 6461 7269 6573 0d0a 2020  r boundaries..  
-000065f0: 2020 2020 2020 6466 5b5b 7365 6c66 2e6c        df[[self.l
-00006600: 6566 745f 626f 756e 6461 7279 5f63 6f6c  eft_boundary_col
-00006610: 2c20 7365 6c66 2e72 6967 6874 5f62 6f75  , self.right_bou
-00006620: 6e64 6172 795f 636f 6c5d 5d20 3d20 280d  ndary_col]] = (.
-00006630: 0a20 2020 2020 2020 2020 2020 2064 665b  .            df[
-00006640: 5b73 656c 662e 6c65 6674 5f62 6f75 6e64  [self.left_bound
-00006650: 6172 795f 636f 6c2c 2073 656c 662e 7269  ary_col, self.ri
-00006660: 6768 745f 626f 756e 6461 7279 5f63 6f6c  ght_boundary_col
-00006670: 5d5d 0d0a 2020 2020 2020 2020 2020 2020  ]]..            
-00006680: 2020 2020 2e72 6570 6c61 6365 285b 302c      .replace([0,
-00006690: 315d 2c20 5b27 436c 6f73 6564 272c 274f  1], ['Closed','O
-000066a0: 7065 6e27 5d29 0d0a 2020 2020 2020 2020  pen'])..        
-000066b0: 2020 2020 290d 0a20 2020 2020 2020 200d      )..        .
-000066c0: 0a20 2020 2020 2020 2023 204d 6561 6e73  .        # Means
-000066d0: 2f73 756d 7320 7769 7468 2069 6e66 696e  /sums with infin
-000066e0: 6974 6520 7661 6c75 6573 2070 726f 6475  ite values produ
-000066f0: 6365 206e 616e 2076 616c 7565 7320 7261  ce nan values ra
-00006700: 7468 6572 2074 6861 6e20 0d0a 2020 2020  ther than ..    
-00006710: 2020 2020 2320 6e70 2e69 6e66 2076 616c      # np.inf val
-00006720: 7565 732e 2043 6f6e 7665 7274 206e 616e  ues. Convert nan
-00006730: 2074 6f20 696e 6620 6f6e 6c79 2069 6620   to inf only if 
-00006740: 696e 6669 6e69 7465 2076 616c 7565 7320  infinite values 
-00006750: 6172 650d 0a20 2020 2020 2020 2023 2069  are..        # i
-00006760: 6e63 6c75 6465 6420 696e 2074 6865 206d  ncluded in the m
-00006770: 6561 6e2f 7375 6d0d 0a20 2020 2020 2020  ean/sum..       
-00006780: 2064 665b 7365 6c66 2e6c 6566 745f 626f   df[self.left_bo
-00006790: 756e 645f 636f 6c5d 203d 2028 0d0a 2020  und_col] = (..  
-000067a0: 2020 2020 2020 2020 2020 6e70 2e77 6865            np.whe
-000067b0: 7265 2864 665b 275f 5f4d 696e 696d 756d  re(df['__Minimum
-000067c0: 5f5f 275d 203d 3d20 2d6e 702e 696e 662c  __'] == -np.inf,
-000067d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000067e0: 2020 2020 2020 202d 6e70 2e69 6e66 2c0d         -np.inf,.
-000067f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006800: 2020 2020 2020 6466 5b73 656c 662e 6c65        df[self.le
-00006810: 6674 5f62 6f75 6e64 5f63 6f6c 5d0d 0a20  ft_bound_col].. 
-00006820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006830: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
-00006840: 2020 2029 0d0a 2020 2020 2020 2020 6466     )..        df
-00006850: 5b73 656c 662e 7269 6768 745f 626f 756e  [self.right_boun
-00006860: 645f 636f 6c5d 203d 2028 0d0a 2020 2020  d_col] = (..    
-00006870: 2020 2020 2020 2020 6e70 2e77 6865 7265          np.where
-00006880: 2864 665b 275f 5f4d 6178 696d 756d 5f5f  (df['__Maximum__
-00006890: 275d 203d 3d20 6e70 2e69 6e66 2c0d 0a20  '] == np.inf,.. 
+00003be0: 7570 6279 5f63 6f6c 732c 2061 735f 696e  upby_cols, as_in
+00003bf0: 6465 783d 4661 6c73 6529 0d0a 2020 2020  dex=False)..    
+00003c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003c10: 2020 2020 2020 2020 2020 2e73 697a 6528            .size(
+00003c20: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00003c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003c40: 202e 7265 6e61 6d65 2863 6f6c 756d 6e73   .rename(columns
+00003c50: 3d7b 2773 697a 6527 3a20 636f 756e 745f  ={'size': count_
+00003c60: 636f 6c73 5b30 5d7d 2929 0d0a 2020 2020  cols[0]}))..    
+00003c70: 2020 2020 2020 2020 2020 2020 2320 4d65              # Me
+00003c80: 7267 6520 636f 756e 7420 696e 666f 2074  rge count info t
+00003c90: 6f20 7374 6174 2064 6174 610d 0a20 2020  o stat data..   
+00003ca0: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+00003cb0: 745f 6461 7461 203d 2073 7461 745f 6461  t_data = stat_da
+00003cc0: 7461 2e6d 6572 6765 2864 662c 0d0a 2020  ta.merge(df,..  
+00003cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003cf0: 2020 2020 2020 2020 2020 686f 773d 276f            how='o
+00003d00: 7574 6572 272c 0d0a 2020 2020 2020 2020  uter',..        
+00003d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d30: 2020 2020 6f6e 3d67 726f 7570 6279 5f63      on=groupby_c
+00003d40: 6f6c 7329 0d0a 2020 2020 2020 2020 2320  ols)..        # 
+00003d50: 456c 7365 2067 726f 7570 6279 5f63 6f6c  Else groupby_col
+00003d60: 7320 6973 206c 6973 7420 6f66 206c 6973  s is list of lis
+00003d70: 7473 0d0a 2020 2020 2020 2020 656c 7365  ts..        else
+00003d80: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
+00003d90: 2043 6865 636b 2074 6865 206c 6973 7420   Check the list 
+00003da0: 6c65 6e67 7468 7320 6172 6520 6964 656e  lengths are iden
+00003db0: 7469 6361 6c0d 0a20 2020 2020 2020 2020  tical..         
+00003dc0: 2020 2069 6620 286c 656e 2863 6f75 6e74     if (len(count
+00003dd0: 5f63 6f6c 7329 2021 3d20 6c65 6e28 6772  _cols) != len(gr
+00003de0: 6f75 7062 795f 636f 6c73 2929 3a0d 0a20  oupby_cols)):.. 
+00003df0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00003e00: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00003e10: 2763 6f75 6e74 5f63 6f6c 7320 6d75 7374  'count_cols must
+00003e20: 2068 6176 6520 7468 6520 7361 6d65 206e   have the same n
+00003e30: 756d 6265 7220 6f66 2027 0d0a 2020 2020  umber of '..    
+00003e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003e50: 2020 2020 2020 2020 2020 2020 2027 636f               'co
+00003e60: 6c75 6d6e 206e 616d 6573 2061 7320 7468  lumn names as th
+00003e70: 6572 6520 6172 6520 6772 6f75 7069 6e67  ere are grouping
+00003e80: 206c 6973 7473 2069 6e20 270d 0a20 2020   lists in '..   
+00003e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003ea0: 2020 2020 2020 2020 2020 2020 2020 2767                'g
+00003eb0: 726f 7570 6279 5f63 6f6c 732e 2729 0d0a  roupby_cols.')..
+00003ec0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00003ed0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00003ee0: 2020 2023 204c 6f6f 7020 7468 726f 7567     # Loop throug
+00003ef0: 6820 6c69 7374 206f 6620 6772 6f75 7069  h list of groupi
+00003f00: 6e67 7320 616e 6420 7375 6d20 636f 756e  ngs and sum coun
+00003f10: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
+00003f20: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00003f30: 6765 286c 656e 2867 726f 7570 6279 5f63  ge(len(groupby_c
+00003f40: 6f6c 7329 293a 0d0a 2020 2020 2020 2020  ols)):..        
+00003f50: 2020 2020 2020 2020 2020 2020 6466 5b63              df[c
+00003f60: 6f75 6e74 5f63 6f6c 735b 695d 5d20 3d20  ount_cols[i]] = 
+00003f70: 310d 0a20 2020 2020 2020 2020 2020 2020  1..             
+00003f80: 2020 2020 2020 2064 6620 3d20 2864 662e         df = (df.
+00003f90: 6772 6f75 7062 7928 6772 6f75 7062 795f  groupby(groupby_
+00003fa0: 636f 6c73 5b69 5d29 5b63 6f75 6e74 5f63  cols[i])[count_c
+00003fb0: 6f6c 735b 3a69 2b31 5d5d 0d0a 2020 2020  ols[:i+1]]..    
+00003fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003fd0: 2020 2020 2020 2020 2020 2e73 756d 2829            .sum()
+00003fe0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004000: 2e72 6573 6574 5f69 6e64 6578 2829 290d  .reset_index()).
+00004010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004020: 2023 204d 6572 6765 2063 6f75 6e74 2069   # Merge count i
+00004030: 6e66 6f20 746f 2073 7461 7420 6461 7461  nfo to stat data
+00004040: 2075 7369 6e67 206c 6173 7420 6772 6f75   using last grou
+00004050: 7069 6e67 0d0a 2020 2020 2020 2020 2020  ping..          
+00004060: 2020 2020 2020 7374 6174 5f64 6174 6120        stat_data 
+00004070: 3d20 7374 6174 5f64 6174 612e 6d65 7267  = stat_data.merg
+00004080: 6528 6466 2c0d 0a20 2020 2020 2020 2020  e(df,..         
+00004090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000040a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000040b0: 2020 2068 6f77 3d27 6f75 7465 7227 2c0d     how='outer',.
+000040c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000040d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000040e0: 2020 2020 2020 2020 2020 2020 206f 6e3d               on=
+000040f0: 6772 6f75 7062 795f 636f 6c73 5b2d 315d  groupby_cols[-1]
+00004100: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00004110: 6e20 7374 6174 5f64 6174 610d 0a20 2020  n stat_data..   
+00004120: 2020 2020 200d 0a20 2020 2020 2020 200d       ..        .
+00004130: 0a20 2020 2023 2525 2053 7461 7469 7374  .    #%% Statist
+00004140: 6963 2069 6e74 6572 7661 6c20 6d65 7468  ic interval meth
+00004150: 6f64 730d 0a20 2020 200d 0a20 2020 2064  ods..    ..    d
+00004160: 6566 206d 6178 696d 756d 5f69 6e74 6572  ef maximum_inter
+00004170: 7661 6c28 7365 6c66 2c20 6772 6f75 7062  val(self, groupb
+00004180: 795f 636f 6c73 2c20 696e 706c 6163 6520  y_cols, inplace 
+00004190: 3d20 4661 6c73 6529 3a0d 0a20 2020 2020  = False):..     
+000041a0: 2020 200d 0a20 2020 2020 2020 2023 2043     ..        # C
+000041b0: 7265 6174 6520 6120 636f 7079 206f 6620  reate a copy of 
+000041c0: 7468 6520 6461 7461 0d0a 2020 2020 2020  the data..      
+000041d0: 2020 6466 203d 2073 656c 662e 6461 7461    df = self.data
+000041e0: 2e63 6f70 7928 290d 0a20 2020 2020 2020  .copy()..       
+000041f0: 200d 0a20 2020 2020 2020 2023 2044 6574   ..        # Det
+00004200: 6572 6d69 6e65 206c 6566 7420 626f 756e  ermine left boun
+00004210: 6420 616e 6420 626f 756e 6461 7279 2066  d and boundary f
+00004220: 6f72 206d 6178 696d 756d 206f 6620 6561  or maximum of ea
+00004230: 6368 2067 726f 7570 2e0d 0a20 2020 2020  ch group...     
+00004240: 2020 200d 0a20 2020 2020 2020 2023 2044     ..        # D
+00004250: 6574 6572 6d69 6e65 2077 6865 7468 6572  etermine whether
+00004260: 2074 6865 206c 6172 6765 7374 206c 6566   the largest lef
+00004270: 7420 626f 756e 6420 6973 206f 7065 6e20  t bound is open 
+00004280: 6f72 2063 6c6f 7365 6420 6279 0d0a 2020  or closed by..  
+00004290: 2020 2020 2020 2320 636f 6d70 6172 696e        # comparin
+000042a0: 6720 7468 6520 6c61 7267 6573 7420 6f70  g the largest op
+000042b0: 656e 2061 6e64 206c 6172 6765 7374 2063  en and largest c
+000042c0: 6c6f 7365 6420 626f 756e 640d 0a20 2020  losed bound..   
+000042d0: 2020 2020 206c 6566 7420 3d20 280d 0a20       left = (.. 
+000042e0: 2020 2020 2020 2020 2020 2064 662e 6772             df.gr
+000042f0: 6f75 7062 7928 6772 6f75 7062 795f 636f  oupby(groupby_co
+00004300: 6c73 202b 205b 7365 6c66 2e6c 6566 745f  ls + [self.left_
+00004310: 626f 756e 6461 7279 5f63 6f6c 5d29 0d0a  boundary_col])..
+00004320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004330: 5b73 656c 662e 6c65 6674 5f62 6f75 6e64  [self.left_bound
+00004340: 5f63 6f6c 5d0d 0a20 2020 2020 2020 2020  _col]..         
+00004350: 2020 2020 2020 202e 6d61 7828 290d 0a20         .max().. 
+00004360: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+00004370: 756e 7374 6163 6b28 7365 6c66 2e6c 6566  unstack(self.lef
+00004380: 745f 626f 756e 6461 7279 5f63 6f6c 290d  t_boundary_col).
+00004390: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
+000043a0: 2020 2020 2020 2020 2320 456e 7375 7265          # Ensure
+000043b0: 2062 6f74 6820 626f 756e 6461 7279 2074   both boundary t
+000043c0: 7970 6573 2065 7869 7374 0d0a 2020 2020  ypes exist..    
+000043d0: 2020 2020 666f 7220 6974 656d 2069 6e20      for item in 
+000043e0: 5b27 4f70 656e 272c 2743 6c6f 7365 6427  ['Open','Closed'
+000043f0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+00004400: 6966 2069 7465 6d20 6e6f 7420 696e 206c  if item not in l
+00004410: 6566 742e 636f 6c75 6d6e 733a 0d0a 2020  eft.columns:..  
+00004420: 2020 2020 2020 2020 2020 2020 2020 6c65                le
+00004430: 6674 5b69 7465 6d5d 203d 206e 702e 6e61  ft[item] = np.na
+00004440: 6e0d 0a20 2020 2020 2020 2023 2055 7365  n..        # Use
+00004450: 2074 6865 206d 6178 696d 756d 2063 6c6f   the maximum clo
+00004460: 7365 6420 626f 756e 6461 7279 2069 6620  sed boundary if 
+00004470: 7468 6572 6520 6172 6520 6e6f 206f 7065  there are no ope
+00004480: 6e20 626f 756e 6461 7269 6573 206f 720d  n boundaries or.
+00004490: 0a20 2020 2020 2020 2023 2069 6620 7468  .        # if th
+000044a0: 6520 636c 6f73 6564 2062 6f75 6e64 6172  e closed boundar
+000044b0: 7920 6973 206c 6172 6765 7220 7468 616e  y is larger than
+000044c0: 2074 6865 206c 6172 6765 7374 206f 7065   the largest ope
+000044d0: 6e20 626f 756e 6461 7279 0d0a 2020 2020  n boundary..    
+000044e0: 2020 2020 636f 6e64 6974 696f 6e20 3d20      condition = 
+000044f0: 286c 6566 745b 2743 6c6f 7365 6427 5d20  (left['Closed'] 
+00004500: 3e20 6c65 6674 5b27 4f70 656e 275d 2920  > left['Open']) 
+00004510: 7c20 286c 6566 745b 274f 7065 6e27 5d2e  | (left['Open'].
+00004520: 6973 6e61 2829 290d 0a20 2020 2020 2020  isna())..       
+00004530: 206c 6566 745b 7365 6c66 2e6c 6566 745f   left[self.left_
+00004540: 626f 756e 6461 7279 5f63 6f6c 5d20 3d20  boundary_col] = 
+00004550: 280d 0a20 2020 2020 2020 2020 2020 206e  (..            n
+00004560: 702e 7768 6572 6528 636f 6e64 6974 696f  p.where(conditio
+00004570: 6e2c 0d0a 2020 2020 2020 2020 2020 2020  n,..            
+00004580: 2020 2020 2020 2020 2027 436c 6f73 6564           'Closed
+00004590: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
+000045a0: 2020 2020 2020 2020 2027 4f70 656e 270d           'Open'.
+000045b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000045c0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+000045d0: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+000045e0: 6c65 6674 5b73 656c 662e 6c65 6674 5f62  left[self.left_b
+000045f0: 6f75 6e64 5f63 6f6c 5d20 3d20 280d 0a20  ound_col] = (.. 
+00004600: 2020 2020 2020 2020 2020 206e 702e 7768             np.wh
+00004610: 6572 6528 636f 6e64 6974 696f 6e2c 0d0a  ere(condition,..
+00004620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004630: 2020 2020 206c 6566 745b 2743 6c6f 7365       left['Close
+00004640: 6427 5d2c 0d0a 2020 2020 2020 2020 2020  d'],..          
+00004650: 2020 2020 2020 2020 2020 206c 6566 745b             left[
+00004660: 274f 7065 6e27 5d0d 0a20 2020 2020 2020  'Open']..       
+00004670: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+00004680: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
+00004690: 2020 2020 2020 2020 6c65 6674 203d 206c          left = l
+000046a0: 6566 745b 5b73 656c 662e 6c65 6674 5f62  eft[[self.left_b
+000046b0: 6f75 6e64 6172 795f 636f 6c2c 2073 656c  oundary_col, sel
+000046c0: 662e 6c65 6674 5f62 6f75 6e64 5f63 6f6c  f.left_bound_col
+000046d0: 5d5d 0d0a 2020 2020 2020 2020 0d0a 2020  ]]..        ..  
+000046e0: 2020 2020 2020 2320 4465 7465 726d 696e        # Determin
+000046f0: 6520 7269 6768 7420 626f 756e 6420 616e  e right bound an
+00004700: 6420 626f 756e 6461 7279 2066 6f72 206d  d boundary for m
+00004710: 6178 696d 756d 206f 6620 6561 6368 2067  aximum of each g
+00004720: 726f 7570 2e0d 0a20 2020 2020 2020 200d  roup...        .
+00004730: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00004740: 2020 2023 2044 6574 6572 6d69 6e65 2077     # Determine w
+00004750: 6865 7468 6572 2074 6865 206c 6172 6765  hether the large
+00004760: 7374 2072 6967 6874 2062 6f75 6e64 2069  st right bound i
+00004770: 7320 6f70 656e 206f 7220 636c 6f73 6564  s open or closed
+00004780: 2062 790d 0a20 2020 2020 2020 2023 2063   by..        # c
+00004790: 6f6d 7061 7269 6e67 2074 6865 206c 6172  omparing the lar
+000047a0: 6765 7374 206f 7065 6e20 616e 6420 6c61  gest open and la
+000047b0: 7267 6573 7420 636c 6f73 6564 2062 6f75  rgest closed bou
+000047c0: 6e64 0d0a 2020 2020 2020 2020 7269 6768  nd..        righ
+000047d0: 7420 3d20 280d 0a20 2020 2020 2020 2020  t = (..         
+000047e0: 2020 2064 662e 6772 6f75 7062 7928 6772     df.groupby(gr
+000047f0: 6f75 7062 795f 636f 6c73 202b 205b 7365  oupby_cols + [se
+00004800: 6c66 2e72 6967 6874 5f62 6f75 6e64 6172  lf.right_boundar
+00004810: 795f 636f 6c5d 290d 0a20 2020 2020 2020  y_col])..       
+00004820: 2020 2020 2020 2020 205b 7365 6c66 2e72           [self.r
+00004830: 6967 6874 5f62 6f75 6e64 5f63 6f6c 5d0d  ight_bound_col].
+00004840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004850: 202e 6d61 7828 292e 0d0a 2020 2020 2020   .max()...      
+00004860: 2020 2020 2020 2020 2020 756e 7374 6163            unstac
+00004870: 6b28 7365 6c66 2e72 6967 6874 5f62 6f75  k(self.right_bou
+00004880: 6e64 6172 795f 636f 6c29 0d0a 2020 2020  ndary_col)..    
+00004890: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+000048a0: 2020 2023 2045 6e73 7572 6520 626f 7468     # Ensure both
+000048b0: 2062 6f75 6e64 6172 7920 7479 7065 7320   boundary types 
+000048c0: 6578 6973 740d 0a20 2020 2020 2020 2066  exist..        f
+000048d0: 6f72 2069 7465 6d20 696e 205b 274f 7065  or item in ['Ope
+000048e0: 6e27 2c27 436c 6f73 6564 275d 3a0d 0a20  n','Closed']:.. 
+000048f0: 2020 2020 2020 2020 2020 2069 6620 6974             if it
+00004900: 656d 206e 6f74 2069 6e20 7269 6768 742e  em not in right.
+00004910: 636f 6c75 6d6e 733a 0d0a 2020 2020 2020  columns:..      
+00004920: 2020 2020 2020 2020 2020 7269 6768 745b            right[
+00004930: 6974 656d 5d20 3d20 6e70 2e6e 616e 0d0a  item] = np.nan..
+00004940: 2020 2020 2020 2020 2320 5573 6520 7468          # Use th
+00004950: 6520 6d61 7869 6d75 6d20 636c 6f73 6564  e maximum closed
+00004960: 2062 6f75 6e64 6172 7920 6966 2074 6865   boundary if the
+00004970: 7265 2061 7265 206e 6f20 6f70 656e 2062  re are no open b
+00004980: 6f75 6e64 6172 6965 7320 6f72 0d0a 2020  oundaries or..  
+00004990: 2020 2020 2020 2320 6966 2074 6865 2063        # if the c
+000049a0: 6c6f 7365 6420 626f 756e 6461 7279 2069  losed boundary i
+000049b0: 7320 6c61 7267 6572 2074 6861 6e20 6f72  s larger than or
+000049c0: 2065 7175 616c 2074 6f20 7468 6520 6c61   equal to the la
+000049d0: 7267 6573 7420 0d0a 2020 2020 2020 2020  rgest ..        
+000049e0: 2320 6f70 656e 2062 6f75 6e64 6172 790d  # open boundary.
+000049f0: 0a20 2020 2020 2020 2063 6f6e 6469 7469  .        conditi
+00004a00: 6f6e 203d 2028 7269 6768 745b 2743 6c6f  on = (right['Clo
+00004a10: 7365 6427 5d20 3e3d 2072 6967 6874 5b27  sed'] >= right['
+00004a20: 4f70 656e 275d 2920 7c20 2872 6967 6874  Open']) | (right
+00004a30: 5b27 4f70 656e 275d 2e69 736e 6128 2929  ['Open'].isna())
+00004a40: 0d0a 2020 2020 2020 2020 7269 6768 745b  ..        right[
+00004a50: 7365 6c66 2e72 6967 6874 5f62 6f75 6e64  self.right_bound
+00004a60: 5f63 6f6c 5d20 3d20 280d 0a20 2020 2020  _col] = (..     
+00004a70: 2020 2020 2020 206e 702e 7768 6572 6528         np.where(
+00004a80: 636f 6e64 6974 696f 6e2c 0d0a 2020 2020  condition,..    
+00004a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004aa0: 2072 6967 6874 5b27 436c 6f73 6564 275d   right['Closed']
+00004ab0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00004ac0: 2020 2020 2020 2020 7269 6768 745b 274f          right['O
+00004ad0: 7065 6e27 5d0d 0a20 2020 2020 2020 2020  pen']..         
+00004ae0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00004af0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00004b00: 2020 2020 2020 7269 6768 745b 7365 6c66        right[self
+00004b10: 2e72 6967 6874 5f62 6f75 6e64 6172 795f  .right_boundary_
+00004b20: 636f 6c5d 203d 2028 0d0a 2020 2020 2020  col] = (..      
+00004b30: 2020 2020 2020 6e70 2e77 6865 7265 2863        np.where(c
+00004b40: 6f6e 6469 7469 6f6e 2c0d 0a20 2020 2020  ondition,..     
+00004b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b60: 2743 6c6f 7365 6427 2c0d 0a20 2020 2020  'Closed',..     
+00004b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b80: 274f 7065 6e27 0d0a 2020 2020 2020 2020  'Open'..        
+00004b90: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
+00004ba0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00004bb0: 2020 2020 2020 2072 6967 6874 203d 2072         right = r
+00004bc0: 6967 6874 5b5b 7365 6c66 2e72 6967 6874  ight[[self.right
+00004bd0: 5f62 6f75 6e64 5f63 6f6c 2c20 7365 6c66  _bound_col, self
+00004be0: 2e72 6967 6874 5f62 6f75 6e64 6172 795f  .right_boundary_
+00004bf0: 636f 6c5d 5d0d 0a20 2020 2020 2020 200d  col]]..        .
+00004c00: 0a20 2020 2020 2020 2023 204d 6572 6765  .        # Merge
+00004c10: 2074 6865 2074 776f 2062 6f75 6e64 6172   the two boundar
+00004c20: 6965 7320 746f 2063 7265 6174 6520 7468  ies to create th
+00004c30: 6520 696e 7465 7276 616c 2066 6f72 2074  e interval for t
+00004c40: 6865 206d 6178 696d 756d 0d0a 2020 2020  he maximum..    
+00004c50: 2020 2020 2320 4368 6563 6b20 7468 6174      # Check that
+00004c60: 2074 6865 206d 6572 6765 2069 7320 312d   the merge is 1-
+00004c70: 746f 2d31 0d0a 2020 2020 2020 2020 6466  to-1..        df
+00004c80: 203d 206c 6566 742e 6d65 7267 6528 7269   = left.merge(ri
+00004c90: 6768 742c 0d0a 2020 2020 2020 2020 2020  ght,..          
+00004ca0: 2020 2020 2020 2020 2020 2020 2020 686f                ho
+00004cb0: 7720 3d20 276f 7574 6572 272c 0d0a 2020  w = 'outer',..  
+00004cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004cd0: 2020 2020 2020 6f6e 203d 2067 726f 7570        on = group
+00004ce0: 6279 5f63 6f6c 732c 0d0a 2020 2020 2020  by_cols,..      
+00004cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004d00: 2020 7661 6c69 6461 7465 203d 2027 313a    validate = '1:
+00004d10: 3127 290d 0a20 2020 2020 2020 200d 0a20  1')..        .. 
+00004d20: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
+00004d30: 6120 636f 6c75 6d6e 2074 6861 7420 696e  a column that in
+00004d40: 6469 6361 7465 7320 7468 6520 6765 6e65  dicates the gene
+00004d50: 7261 7465 6420 7374 6174 6973 7469 630d  rated statistic.
+00004d60: 0a20 2020 2020 2020 2064 665b 7365 6c66  .        df[self
+00004d70: 2e73 7461 745f 636f 6c5d 203d 2027 4d61  .stat_col] = 'Ma
+00004d80: 7869 6d75 6d27 0d0a 2020 2020 2020 2020  ximum'..        
+00004d90: 0d0a 2020 2020 2020 2020 2320 5265 6f72  ..        # Reor
+00004da0: 6465 7220 636f 6c75 6d6e 730d 0a20 2020  der columns..   
+00004db0: 2020 2020 2064 6620 3d20 6466 5b5b 7365       df = df[[se
+00004dc0: 6c66 2e73 7461 745f 636f 6c2c 0d0a 2020  lf.stat_col,..  
+00004dd0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00004de0: 656c 662e 6c65 6674 5f62 6f75 6e64 6172  elf.left_boundar
+00004df0: 795f 636f 6c2c 0d0a 2020 2020 2020 2020  y_col,..        
+00004e00: 2020 2020 2020 2020 2073 656c 662e 6c65           self.le
+00004e10: 6674 5f62 6f75 6e64 5f63 6f6c 2c0d 0a20  ft_bound_col,.. 
+00004e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004e30: 7365 6c66 2e72 6967 6874 5f62 6f75 6e64  self.right_bound
+00004e40: 5f63 6f6c 2c0d 0a20 2020 2020 2020 2020  _col,..         
+00004e50: 2020 2020 2020 2020 7365 6c66 2e72 6967          self.rig
+00004e60: 6874 5f62 6f75 6e64 6172 795f 636f 6c0d  ht_boundary_col.
+00004e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004e80: 2020 5d5d 0d0a 2020 2020 2020 2020 0d0a    ]]..        ..
+00004e90: 2020 2020 2020 2020 2320 5265 7365 7420          # Reset 
+00004ea0: 696e 6465 780d 0a20 2020 2020 2020 2064  index..        d
+00004eb0: 6620 3d20 6466 2e72 6573 6574 5f69 6e64  f = df.reset_ind
+00004ec0: 6578 2829 0d0a 2020 2020 2020 2020 0d0a  ex()..        ..
+00004ed0: 2020 2020 2020 2020 2320 5265 706c 6163          # Replac
+00004ee0: 6520 6f72 2072 6574 7572 6e20 7265 7375  e or return resu
+00004ef0: 6c74 0d0a 2020 2020 2020 2020 6966 2069  lt..        if i
+00004f00: 6e70 6c61 6365 3a0d 0a20 2020 2020 2020  nplace:..       
+00004f10: 2020 2020 2073 656c 662e 6461 7461 203d       self.data =
+00004f20: 2064 660d 0a20 2020 2020 2020 2065 6c73   df..        els
+00004f30: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00004f40: 7265 7475 726e 2064 660d 0a20 2020 200d  return df..    .
+00004f50: 0a20 2020 2064 6566 206d 696e 696d 756d  .    def minimum
+00004f60: 5f69 6e74 6572 7661 6c28 7365 6c66 2c20  _interval(self, 
+00004f70: 6772 6f75 7062 795f 636f 6c73 2c20 696e  groupby_cols, in
+00004f80: 706c 6163 6520 3d20 4661 6c73 6529 3a0d  place = False):.
+00004f90: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00004fa0: 2020 2023 2043 7265 6174 6520 6120 636f     # Create a co
+00004fb0: 7079 206f 6620 7468 6520 6461 7461 0d0a  py of the data..
+00004fc0: 2020 2020 2020 2020 6466 203d 2073 656c          df = sel
+00004fd0: 662e 6461 7461 2e63 6f70 7928 290d 0a20  f.data.copy().. 
+00004fe0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00004ff0: 2023 2044 6574 6572 6d69 6e65 206c 6566   # Determine lef
+00005000: 7420 626f 756e 6420 616e 6420 626f 756e  t bound and boun
+00005010: 6461 7279 2066 6f72 206d 696e 696d 756d  dary for minimum
+00005020: 206f 6620 6561 6368 2067 726f 7570 2e0d   of each group..
+00005030: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00005040: 2020 2023 2044 6574 6572 6d69 6e65 2077     # Determine w
+00005050: 6865 7468 6572 2074 6865 206c 6561 7374  hether the least
+00005060: 206c 6566 7420 626f 756e 6420 6973 206f   left bound is o
+00005070: 7065 6e20 6f72 2063 6c6f 7365 6420 6279  pen or closed by
+00005080: 0d0a 2020 2020 2020 2020 2320 636f 6d70  ..        # comp
+00005090: 6172 696e 6720 7468 6520 6c65 6173 7420  aring the least 
+000050a0: 6f70 656e 2061 6e64 206c 6561 7374 2063  open and least c
+000050b0: 6c6f 7365 6420 626f 756e 640d 0a20 2020  losed bound..   
+000050c0: 2020 2020 206c 6566 7420 3d20 280d 0a20       left = (.. 
+000050d0: 2020 2020 2020 2020 2020 2064 662e 6772             df.gr
+000050e0: 6f75 7062 7928 6772 6f75 7062 795f 636f  oupby(groupby_co
+000050f0: 6c73 202b 205b 7365 6c66 2e6c 6566 745f  ls + [self.left_
+00005100: 626f 756e 6461 7279 5f63 6f6c 5d29 0d0a  boundary_col])..
+00005110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005120: 5b73 656c 662e 6c65 6674 5f62 6f75 6e64  [self.left_bound
+00005130: 5f63 6f6c 5d0d 0a20 2020 2020 2020 2020  _col]..         
+00005140: 2020 2020 2020 202e 6d69 6e28 290d 0a20         .min().. 
+00005150: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+00005160: 756e 7374 6163 6b28 7365 6c66 2e6c 6566  unstack(self.lef
+00005170: 745f 626f 756e 6461 7279 5f63 6f6c 290d  t_boundary_col).
+00005180: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
+00005190: 2020 2020 2020 2020 2320 456e 7375 7265          # Ensure
+000051a0: 2062 6f74 6820 626f 756e 6461 7279 2074   both boundary t
+000051b0: 7970 6573 2065 7869 7374 0d0a 2020 2020  ypes exist..    
+000051c0: 2020 2020 666f 7220 6974 656d 2069 6e20      for item in 
+000051d0: 5b27 4f70 656e 272c 2743 6c6f 7365 6427  ['Open','Closed'
+000051e0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+000051f0: 6966 2069 7465 6d20 6e6f 7420 696e 206c  if item not in l
+00005200: 6566 742e 636f 6c75 6d6e 733a 0d0a 2020  eft.columns:..  
+00005210: 2020 2020 2020 2020 2020 2020 2020 6c65                le
+00005220: 6674 5b69 7465 6d5d 203d 206e 702e 6e61  ft[item] = np.na
+00005230: 6e0d 0a20 2020 2020 2020 2023 2055 7365  n..        # Use
+00005240: 2074 6865 206d 696e 696d 756d 2063 6c6f   the minimum clo
+00005250: 7365 6420 626f 756e 6461 7279 2069 6620  sed boundary if 
+00005260: 7468 6572 6520 6172 6520 6e6f 206f 7065  there are no ope
+00005270: 6e20 626f 756e 6461 7269 6573 206f 720d  n boundaries or.
+00005280: 0a20 2020 2020 2020 2023 2069 6620 7468  .        # if th
+00005290: 6520 636c 6f73 6564 2062 6f75 6e64 6172  e closed boundar
+000052a0: 7920 6973 206c 6573 7320 7468 616e 206f  y is less than o
+000052b0: 7220 6571 7561 6c20 746f 2074 6865 206c  r equal to the l
+000052c0: 6561 7374 0d0a 2020 2020 2020 2020 2320  east..        # 
+000052d0: 6f70 656e 2062 6f75 6e64 6172 790d 0a20  open boundary.. 
+000052e0: 2020 2020 2020 2063 6f6e 6469 7469 6f6e         condition
+000052f0: 203d 2028 6c65 6674 5b27 436c 6f73 6564   = (left['Closed
+00005300: 275d 203c 3d20 6c65 6674 5b27 4f70 656e  '] <= left['Open
+00005310: 275d 2920 7c20 286c 6566 745b 274f 7065  ']) | (left['Ope
+00005320: 6e27 5d2e 6973 6e61 2829 290d 0a20 2020  n'].isna())..   
+00005330: 2020 2020 206c 6566 745b 7365 6c66 2e6c       left[self.l
+00005340: 6566 745f 626f 756e 6461 7279 5f63 6f6c  eft_boundary_col
+00005350: 5d20 3d20 280d 0a20 2020 2020 2020 2020  ] = (..         
+00005360: 2020 206e 702e 7768 6572 6528 636f 6e64     np.where(cond
+00005370: 6974 696f 6e2c 0d0a 2020 2020 2020 2020  ition,..        
+00005380: 2020 2020 2020 2020 2020 2020 2027 436c               'Cl
+00005390: 6f73 6564 272c 0d0a 2020 2020 2020 2020  osed',..        
+000053a0: 2020 2020 2020 2020 2020 2020 2027 4f70               'Op
+000053b0: 656e 270d 0a20 2020 2020 2020 2020 2020  en'..           
+000053c0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+000053d0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+000053e0: 2020 2020 6c65 6674 5b73 656c 662e 6c65      left[self.le
+000053f0: 6674 5f62 6f75 6e64 5f63 6f6c 5d20 3d20  ft_bound_col] = 
+00005400: 280d 0a20 2020 2020 2020 2020 2020 206e  (..            n
+00005410: 702e 7768 6572 6528 636f 6e64 6974 696f  p.where(conditio
+00005420: 6e2c 0d0a 2020 2020 2020 2020 2020 2020  n,..            
+00005430: 2020 2020 2020 2020 206c 6566 745b 2743           left['C
+00005440: 6c6f 7365 6427 5d2c 0d0a 2020 2020 2020  losed'],..      
+00005450: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00005460: 6566 745b 274f 7065 6e27 5d0d 0a20 2020  eft['Open']..   
+00005470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005480: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+00005490: 2029 0d0a 2020 2020 2020 2020 6c65 6674   )..        left
+000054a0: 203d 206c 6566 745b 5b73 656c 662e 6c65   = left[[self.le
+000054b0: 6674 5f62 6f75 6e64 6172 795f 636f 6c2c  ft_boundary_col,
+000054c0: 2073 656c 662e 6c65 6674 5f62 6f75 6e64   self.left_bound
+000054d0: 5f63 6f6c 5d5d 0d0a 2020 2020 2020 2020  _col]]..        
+000054e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000054f0: 0d0a 2020 2020 2020 2020 2320 4465 7465  ..        # Dete
+00005500: 726d 696e 6520 7269 6768 7420 626f 756e  rmine right boun
+00005510: 6420 616e 6420 626f 756e 6461 7279 2066  d and boundary f
+00005520: 6f72 206d 696e 696d 756d 206f 6620 6561  or minimum of ea
+00005530: 6368 2067 726f 7570 2e0d 0a20 2020 2020  ch group...     
+00005540: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00005550: 2020 2020 2023 2044 6574 6572 6d69 6e65       # Determine
+00005560: 2077 6865 7468 6572 2074 6865 206c 6561   whether the lea
+00005570: 7374 2072 6967 6874 2062 6f75 6e64 2069  st right bound i
+00005580: 7320 6f70 656e 206f 7220 636c 6f73 6564  s open or closed
+00005590: 2062 790d 0a20 2020 2020 2020 2023 2063   by..        # c
+000055a0: 6f6d 7061 7269 6e67 2074 6865 206c 6561  omparing the lea
+000055b0: 7374 206f 7065 6e20 616e 6420 6c65 6173  st open and leas
+000055c0: 7420 636c 6f73 6564 2062 6f75 6e64 0d0a  t closed bound..
+000055d0: 2020 2020 2020 2020 7269 6768 7420 3d20          right = 
+000055e0: 280d 0a20 2020 2020 2020 2020 2020 2064  (..            d
+000055f0: 662e 6772 6f75 7062 7928 6772 6f75 7062  f.groupby(groupb
+00005600: 795f 636f 6c73 202b 205b 7365 6c66 2e72  y_cols + [self.r
+00005610: 6967 6874 5f62 6f75 6e64 6172 795f 636f  ight_boundary_co
+00005620: 6c5d 290d 0a20 2020 2020 2020 2020 2020  l])..           
+00005630: 2020 2020 205b 7365 6c66 2e72 6967 6874       [self.right
+00005640: 5f62 6f75 6e64 5f63 6f6c 5d0d 0a20 2020  _bound_col]..   
+00005650: 2020 2020 2020 2020 2020 2020 202e 6d69               .mi
+00005660: 6e28 292e 0d0a 2020 2020 2020 2020 2020  n()...          
+00005670: 2020 2020 2020 756e 7374 6163 6b28 7365        unstack(se
+00005680: 6c66 2e72 6967 6874 5f62 6f75 6e64 6172  lf.right_boundar
+00005690: 795f 636f 6c29 0d0a 2020 2020 2020 2020  y_col)..        
+000056a0: 2020 2020 290d 0a20 2020 2020 2020 2023      )..        #
+000056b0: 2045 6e73 7572 6520 626f 7468 2062 6f75   Ensure both bou
+000056c0: 6e64 6172 7920 7479 7065 7320 6578 6973  ndary types exis
+000056d0: 740d 0a20 2020 2020 2020 2066 6f72 2069  t..        for i
+000056e0: 7465 6d20 696e 205b 274f 7065 6e27 2c27  tem in ['Open','
+000056f0: 436c 6f73 6564 275d 3a0d 0a20 2020 2020  Closed']:..     
+00005700: 2020 2020 2020 2069 6620 6974 656d 206e         if item n
+00005710: 6f74 2069 6e20 7269 6768 742e 636f 6c75  ot in right.colu
+00005720: 6d6e 733a 0d0a 2020 2020 2020 2020 2020  mns:..          
+00005730: 2020 2020 2020 7269 6768 745b 6974 656d        right[item
+00005740: 5d20 3d20 6e70 2e6e 616e 0d0a 2020 2020  ] = np.nan..    
+00005750: 2020 2020 2320 5573 6520 7468 6520 6d69      # Use the mi
+00005760: 6e69 6d75 6d20 636c 6f73 6564 2062 6f75  nimum closed bou
+00005770: 6e64 6172 7920 6966 2074 6865 7265 2061  ndary if there a
+00005780: 7265 206e 6f20 6f70 656e 2062 6f75 6e64  re no open bound
+00005790: 6172 6965 7320 6f72 0d0a 2020 2020 2020  aries or..      
+000057a0: 2020 2320 6966 2074 6865 2063 6c6f 7365    # if the close
+000057b0: 6420 626f 756e 6461 7279 2069 7320 6c65  d boundary is le
+000057c0: 7373 2074 6861 6e20 7468 6520 6c65 6173  ss than the leas
+000057d0: 7420 6f70 656e 2062 6f75 6e64 6172 790d  t open boundary.
+000057e0: 0a20 2020 2020 2020 2063 6f6e 6469 7469  .        conditi
+000057f0: 6f6e 203d 2028 7269 6768 745b 2743 6c6f  on = (right['Clo
+00005800: 7365 6427 5d20 3c20 7269 6768 745b 274f  sed'] < right['O
+00005810: 7065 6e27 5d29 207c 2028 7269 6768 745b  pen']) | (right[
+00005820: 274f 7065 6e27 5d2e 6973 6e61 2829 290d  'Open'].isna()).
+00005830: 0a20 2020 2020 2020 2072 6967 6874 5b73  .        right[s
+00005840: 656c 662e 7269 6768 745f 626f 756e 645f  elf.right_bound_
+00005850: 636f 6c5d 203d 2028 0d0a 2020 2020 2020  col] = (..      
+00005860: 2020 2020 2020 6e70 2e77 6865 7265 2863        np.where(c
+00005870: 6f6e 6469 7469 6f6e 2c0d 0a20 2020 2020  ondition,..     
+00005880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005890: 7269 6768 745b 2743 6c6f 7365 6427 5d2c  right['Closed'],
+000058a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000058b0: 2020 2020 2020 2072 6967 6874 5b27 4f70         right['Op
+000058c0: 656e 275d 0d0a 2020 2020 2020 2020 2020  en']..          
+000058d0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+000058e0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+000058f0: 2020 2020 2072 6967 6874 5b73 656c 662e       right[self.
+00005900: 7269 6768 745f 626f 756e 6461 7279 5f63  right_boundary_c
+00005910: 6f6c 5d20 3d20 280d 0a20 2020 2020 2020  ol] = (..       
+00005920: 2020 2020 206e 702e 7768 6572 6528 636f       np.where(co
+00005930: 6e64 6974 696f 6e2c 0d0a 2020 2020 2020  ndition,..      
+00005940: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00005950: 436c 6f73 6564 272c 0d0a 2020 2020 2020  Closed',..      
+00005960: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00005970: 4f70 656e 270d 0a20 2020 2020 2020 2020  Open'..         
+00005980: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00005990: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+000059a0: 2020 2020 2020 7269 6768 7420 3d20 7269        right = ri
+000059b0: 6768 745b 5b73 656c 662e 7269 6768 745f  ght[[self.right_
+000059c0: 626f 756e 645f 636f 6c2c 2073 656c 662e  bound_col, self.
+000059d0: 7269 6768 745f 626f 756e 6461 7279 5f63  right_boundary_c
+000059e0: 6f6c 5d5d 0d0a 2020 2020 2020 2020 0d0a  ol]]..        ..
+000059f0: 2020 2020 2020 2020 2320 4d65 7267 6520          # Merge 
+00005a00: 7468 6520 7477 6f20 626f 756e 6461 7269  the two boundari
+00005a10: 6573 2074 6f20 6372 6561 7465 2074 6865  es to create the
+00005a20: 2069 6e74 6572 7661 6c20 666f 7220 7468   interval for th
+00005a30: 6520 6d61 7869 6d75 6d0d 0a20 2020 2020  e maximum..     
+00005a40: 2020 2023 2043 6865 636b 2074 6861 7420     # Check that 
+00005a50: 7468 6520 6d65 7267 6520 6973 2031 2d74  the merge is 1-t
+00005a60: 6f2d 310d 0a20 2020 2020 2020 2064 6620  o-1..        df 
+00005a70: 3d20 6c65 6674 2e6d 6572 6765 2872 6967  = left.merge(rig
+00005a80: 6874 2c0d 0a20 2020 2020 2020 2020 2020  ht,..           
+00005a90: 2020 2020 2020 2020 2020 2020 2068 6f77               how
+00005aa0: 203d 2027 6f75 7465 7227 2c0d 0a20 2020   = 'outer',..   
+00005ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ac0: 2020 2020 206f 6e20 3d20 6772 6f75 7062       on = groupb
+00005ad0: 795f 636f 6c73 2c0d 0a20 2020 2020 2020  y_cols,..       
+00005ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005af0: 2076 616c 6964 6174 6520 3d20 2731 3a31   validate = '1:1
+00005b00: 2729 0d0a 2020 2020 2020 2020 0d0a 2020  ')..        ..  
+00005b10: 2020 2020 2020 2320 4372 6561 7465 2061        # Create a
+00005b20: 2063 6f6c 756d 6e20 7468 6174 2069 6e64   column that ind
+00005b30: 6963 6174 6573 2074 6865 2067 656e 6572  icates the gener
+00005b40: 6174 6564 2073 7461 7469 7374 6963 0d0a  ated statistic..
+00005b50: 2020 2020 2020 2020 6466 5b73 656c 662e          df[self.
+00005b60: 7374 6174 5f63 6f6c 5d20 3d20 274d 696e  stat_col] = 'Min
+00005b70: 696d 756d 270d 0a20 2020 2020 2020 200d  imum'..        .
+00005b80: 0a20 2020 2020 2020 2023 2052 656f 7264  .        # Reord
+00005b90: 6572 2063 6f6c 756d 6e73 0d0a 2020 2020  er columns..    
+00005ba0: 2020 2020 6466 203d 2064 665b 5b73 656c      df = df[[sel
+00005bb0: 662e 7374 6174 5f63 6f6c 2c0d 0a20 2020  f.stat_col,..   
+00005bc0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00005bd0: 6c66 2e6c 6566 745f 626f 756e 6461 7279  lf.left_boundary
+00005be0: 5f63 6f6c 2c0d 0a20 2020 2020 2020 2020  _col,..         
+00005bf0: 2020 2020 2020 2020 7365 6c66 2e6c 6566          self.lef
+00005c00: 745f 626f 756e 645f 636f 6c2c 0d0a 2020  t_bound_col,..  
+00005c10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00005c20: 656c 662e 7269 6768 745f 626f 756e 645f  elf.right_bound_
+00005c30: 636f 6c2c 0d0a 2020 2020 2020 2020 2020  col,..          
+00005c40: 2020 2020 2020 2073 656c 662e 7269 6768         self.righ
+00005c50: 745f 626f 756e 6461 7279 5f63 6f6c 0d0a  t_boundary_col..
+00005c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005c70: 205d 5d0d 0a20 2020 2020 2020 200d 0a20   ]]..        .. 
+00005c80: 2020 2020 2020 2023 2052 6573 6574 2069         # Reset i
+00005c90: 6e64 6578 0d0a 2020 2020 2020 2020 6466  ndex..        df
+00005ca0: 203d 2064 662e 7265 7365 745f 696e 6465   = df.reset_inde
+00005cb0: 7828 290d 0a20 2020 2020 2020 200d 0a20  x()..        .. 
+00005cc0: 2020 2020 2020 2023 2052 6570 6c61 6365         # Replace
+00005cd0: 206f 7220 7265 7475 726e 2072 6573 756c   or return resul
+00005ce0: 740d 0a20 2020 2020 2020 2069 6620 696e  t..        if in
+00005cf0: 706c 6163 653a 0d0a 2020 2020 2020 2020  place:..        
+00005d00: 2020 2020 7365 6c66 2e64 6174 6120 3d20      self.data = 
+00005d10: 6466 0d0a 2020 2020 2020 2020 656c 7365  df..        else
+00005d20: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+00005d30: 6574 7572 6e20 6466 0d0a 2020 2020 0d0a  eturn df..    ..
+00005d40: 2020 2020 6465 6620 6d65 616e 5f6f 725f      def mean_or_
+00005d50: 7375 6d5f 696e 7465 7276 616c 2873 656c  sum_interval(sel
+00005d60: 662c 0d0a 2020 2020 2020 2020 2020 2020  f,..            
+00005d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005d80: 2073 7461 742c 0d0a 2020 2020 2020 2020   stat,..        
+00005d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005da0: 2020 2020 2067 726f 7570 6279 5f63 6f6c       groupby_col
+00005db0: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
+00005dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005dd0: 2069 6e70 6c61 6365 203d 2046 616c 7365   inplace = False
+00005de0: 293a 0d0a 2020 2020 2020 2020 0d0a 2020  ):..        ..  
+00005df0: 2020 2020 2020 2320 4372 6561 7465 2061        # Create a
+00005e00: 2063 6f70 7920 6f66 2074 6865 2064 6174   copy of the dat
+00005e10: 610d 0a20 2020 2020 2020 2064 6620 3d20  a..        df = 
+00005e20: 7365 6c66 2e64 6174 612e 636f 7079 2829  self.data.copy()
+00005e30: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00005e40: 2020 2020 2320 4368 6563 6b20 666f 7220      # Check for 
+00005e50: 7661 6c69 6420 7374 6174 2066 756e 6374  valid stat funct
+00005e60: 696f 6e73 0d0a 2020 2020 2020 2020 6966  ions..        if
+00005e70: 2073 7461 7420 6e6f 7420 696e 205b 276d   stat not in ['m
+00005e80: 6561 6e27 2c27 7375 6d27 5d3a 0d0a 2020  ean','sum']:..  
+00005e90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00005ea0: 5661 6c75 6545 7272 6f72 2827 4974 2069  ValueError('It i
+00005eb0: 7320 6e6f 7420 7265 636f 6d6d 656e 6465  s not recommende
+00005ec0: 6420 666f 7220 7573 6572 7320 746f 2075  d for users to u
+00005ed0: 7365 2074 6865 2027 0d0a 2020 2020 2020  se the '..      
+00005ee0: 2020 2020 2020 2020 2020 2766 756e 6374            'funct
+00005ef0: 696f 6e20 6d65 616e 5f6f 725f 7375 6d5f  ion mean_or_sum_
+00005f00: 696e 7465 7276 616c 2e20 5573 6520 6d65  interval. Use me
+00005f10: 616e 5f69 6e74 6572 7661 6c20 6f72 2027  an_interval or '
+00005f20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00005f30: 2020 2773 756d 5f69 6e74 6572 7661 6c20    'sum_interval 
+00005f40: 696e 7374 6561 642e 2054 6f20 7573 6520  instead. To use 
+00005f50: 7468 6973 2066 756e 6374 696f 6e20 7468  this function th
+00005f60: 6520 7661 6c75 6520 666f 7220 270d 0a20  e value for '.. 
+00005f70: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00005f80: 2273 7461 7422 206d 7573 7420 6265 2022  "stat" must be "
+00005f90: 6d65 616e 2220 6f72 2022 7375 6d22 2e20  mean" or "sum". 
+00005fa0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
+00005fb0: 2020 2066 2754 6865 2070 726f 7669 6465     f'The provide
+00005fc0: 6420 7661 6c75 6520 7761 7320 227b 7374  d value was "{st
+00005fd0: 6174 7d22 2e27 290d 0a20 2020 2020 2020  at}".')..       
+00005fe0: 200d 0a20 2020 2020 2020 2023 2043 7265   ..        # Cre
+00005ff0: 6174 6520 6120 636f 6c75 6d6e 2074 6861  ate a column tha
+00006000: 7420 696e 6469 6361 7465 7320 7468 6520  t indicates the 
+00006010: 6765 6e65 7261 7465 6420 7374 6174 6973  generated statis
+00006020: 7469 6320 0d0a 2020 2020 2020 2020 6466  tic ..        df
+00006030: 5b73 656c 662e 7374 6174 5f63 6f6c 5d20  [self.stat_col] 
+00006040: 3d20 7374 6174 2e63 6170 6974 616c 697a  = stat.capitaliz
+00006050: 6528 290d 0a20 2020 2020 2020 200d 0a20  e()..        .. 
+00006060: 2020 2020 2020 2023 2043 6861 6e67 6520         # Change 
+00006070: 6e6f 7461 7469 6f6e 206f 6620 2743 6c6f  notation of 'Clo
+00006080: 7365 6427 2061 6e64 2027 4f70 656e 2720  sed' and 'Open' 
+00006090: 626f 756e 6461 7269 6573 2074 6f20 3020  boundaries to 0 
+000060a0: 616e 6420 312c 200d 0a20 2020 2020 2020  and 1, ..       
+000060b0: 2023 2072 6573 7065 6374 6976 656c 792e   # respectively.
+000060c0: 2054 6865 2070 7265 7365 6e63 6520 6f66   The presence of
+000060d0: 2061 6e79 206f 7065 6e20 626f 756e 6461   any open bounda
+000060e0: 7269 6573 206f 6e20 6f6e 6520 7369 6465  ries on one side
+000060f0: 2065 6e73 7572 6573 0d0a 2020 2020 2020   ensures..      
+00006100: 2020 2320 7468 6174 2074 6865 2069 6e74    # that the int
+00006110: 6572 7661 6c20 666f 7220 7468 6520 7265  erval for the re
+00006120: 7375 6c74 2069 7320 616c 736f 206f 7065  sult is also ope
+00006130: 6e20 6f6e 2074 6861 7420 7369 6465 0d0a  n on that side..
+00006140: 2020 2020 2020 2020 6466 5b5b 7365 6c66          df[[self
+00006150: 2e6c 6566 745f 626f 756e 6461 7279 5f63  .left_boundary_c
+00006160: 6f6c 2c20 7365 6c66 2e72 6967 6874 5f62  ol, self.right_b
+00006170: 6f75 6e64 6172 795f 636f 6c5d 5d20 3d20  oundary_col]] = 
+00006180: 280d 0a20 2020 2020 2020 2020 2020 2064  (..            d
+00006190: 665b 5b73 656c 662e 6c65 6674 5f62 6f75  f[[self.left_bou
+000061a0: 6e64 6172 795f 636f 6c2c 2073 656c 662e  ndary_col, self.
+000061b0: 7269 6768 745f 626f 756e 6461 7279 5f63  right_boundary_c
+000061c0: 6f6c 5d5d 0d0a 2020 2020 2020 2020 2020  ol]]..          
+000061d0: 2020 2020 2020 2e72 6570 6c61 6365 285b        .replace([
+000061e0: 2743 6c6f 7365 6427 2c27 4f70 656e 275d  'Closed','Open']
+000061f0: 2c20 5b30 2c31 5d29 0d0a 2020 2020 2020  , [0,1])..      
+00006200: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+00006210: 200d 0a20 2020 2020 2020 2023 2047 6574   ..        # Get
+00006220: 2074 6865 206c 6566 742f 7269 6768 7420   the left/right 
+00006230: 626f 756e 6473 206f 6620 7468 6520 7265  bounds of the re
+00006240: 7375 6c74 2062 7920 6176 6572 6167 696e  sult by averagin
+00006250: 6720 6f72 2061 6464 696e 6720 616c 6c20  g or adding all 
+00006260: 0d0a 2020 2020 2020 2020 2320 6c65 6674  ..        # left
+00006270: 2f72 6967 6874 2062 6f75 6e64 7320 7769  /right bounds wi
+00006280: 7468 696e 2074 6865 2067 726f 7570 2e0d  thin the group..
+00006290: 0a20 2020 2020 2020 2023 2044 6574 6572  .        # Deter
+000062a0: 6d69 6e65 2077 6865 7468 6572 2061 6e79  mine whether any
+000062b0: 204f 7065 6e20 286e 6f77 2076 616c 7565   Open (now value
+000062c0: 206f 6620 3129 2062 6f75 6e64 6172 6965   of 1) boundarie
+000062d0: 7320 6578 6973 742e 0d0a 2020 2020 2020  s exist...      
+000062e0: 2020 2320 4966 2074 6865 7265 2061 7265    # If there are
+000062f0: 2061 6e79 206f 7065 6e20 626f 756e 6461   any open bounda
+00006300: 7269 6573 2075 7365 6420 696e 2074 6865  ries used in the
+00006310: 2062 6f75 6e64 206d 6561 6e2f 7375 6d2c   bound mean/sum,
+00006320: 0d0a 2020 2020 2020 2020 2320 7468 656e  ..        # then
+00006330: 2074 6865 2072 6573 756c 7469 6e67 206d   the resulting m
+00006340: 6561 6e2f 7375 6d20 7769 6c6c 2062 6520  ean/sum will be 
+00006350: 6f70 656e 0d0a 2020 2020 2020 2020 6466  open..        df
+00006360: 203d 2028 0d0a 2020 2020 2020 2020 2020   = (..          
+00006370: 2020 6466 2e67 726f 7570 6279 2867 726f    df.groupby(gro
+00006380: 7570 6279 5f63 6f6c 7320 2b20 5b73 656c  upby_cols + [sel
+00006390: 662e 7374 6174 5f63 6f6c 5d29 0d0a 2020  f.stat_col])..  
+000063a0: 2020 2020 2020 2020 2020 2020 2020 2e61                .a
+000063b0: 6767 282a 2a7b 0d0a 2020 2020 2020 2020  gg(**{..        
+000063c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000063d0: 2e6c 6566 745f 626f 756e 6461 7279 5f63  .left_boundary_c
+000063e0: 6f6c 3a20 2873 656c 662e 6c65 6674 5f62  ol: (self.left_b
+000063f0: 6f75 6e64 6172 795f 636f 6c2c 2027 6d61  oundary_col, 'ma
+00006400: 7827 292c 0d0a 2020 2020 2020 2020 2020  x'),..          
+00006410: 2020 2020 2020 2020 2020 275f 5f4d 696e            '__Min
+00006420: 696d 756d 5f5f 273a 2028 7365 6c66 2e6c  imum__': (self.l
+00006430: 6566 745f 626f 756e 645f 636f 6c2c 2027  eft_bound_col, '
+00006440: 6d69 6e27 292c 0d0a 2020 2020 2020 2020  min'),..        
+00006450: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00006460: 2e6c 6566 745f 626f 756e 645f 636f 6c3a  .left_bound_col:
+00006470: 2028 7365 6c66 2e6c 6566 745f 626f 756e   (self.left_boun
+00006480: 645f 636f 6c2c 2073 7461 7429 2c0d 0a20  d_col, stat),.. 
+00006490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000064a0: 2020 2073 656c 662e 7269 6768 745f 626f     self.right_bo
+000064b0: 756e 645f 636f 6c3a 2028 7365 6c66 2e72  und_col: (self.r
+000064c0: 6967 6874 5f62 6f75 6e64 5f63 6f6c 2c20  ight_bound_col, 
+000064d0: 7374 6174 292c 0d0a 2020 2020 2020 2020  stat),..        
+000064e0: 2020 2020 2020 2020 2020 2020 275f 5f4d              '__M
+000064f0: 6178 696d 756d 5f5f 273a 2028 7365 6c66  aximum__': (self
+00006500: 2e72 6967 6874 5f62 6f75 6e64 5f63 6f6c  .right_bound_col
+00006510: 2c20 276d 6178 2729 2c0d 0a20 2020 2020  , 'max'),..     
+00006520: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00006530: 656c 662e 7269 6768 745f 626f 756e 6461  elf.right_bounda
+00006540: 7279 5f63 6f6c 3a20 2873 656c 662e 7269  ry_col: (self.ri
+00006550: 6768 745f 626f 756e 6461 7279 5f63 6f6c  ght_boundary_col
+00006560: 2c20 276d 6178 2729 0d0a 2020 2020 2020  , 'max')..      
+00006570: 2020 2020 2020 2020 2020 2020 2020 7d29                })
+00006580: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
+00006590: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+000065a0: 2020 2023 2052 6570 6c61 6365 2069 6e74     # Replace int
+000065b0: 6567 6572 7320 7769 7468 2074 6578 7420  egers with text 
+000065c0: 666f 7220 626f 756e 6461 7269 6573 0d0a  for boundaries..
+000065d0: 2020 2020 2020 2020 6466 5b5b 7365 6c66          df[[self
+000065e0: 2e6c 6566 745f 626f 756e 6461 7279 5f63  .left_boundary_c
+000065f0: 6f6c 2c20 7365 6c66 2e72 6967 6874 5f62  ol, self.right_b
+00006600: 6f75 6e64 6172 795f 636f 6c5d 5d20 3d20  oundary_col]] = 
+00006610: 280d 0a20 2020 2020 2020 2020 2020 2064  (..            d
+00006620: 665b 5b73 656c 662e 6c65 6674 5f62 6f75  f[[self.left_bou
+00006630: 6e64 6172 795f 636f 6c2c 2073 656c 662e  ndary_col, self.
+00006640: 7269 6768 745f 626f 756e 6461 7279 5f63  right_boundary_c
+00006650: 6f6c 5d5d 0d0a 2020 2020 2020 2020 2020  ol]]..          
+00006660: 2020 2020 2020 2e72 6570 6c61 6365 285b        .replace([
+00006670: 302c 315d 2c20 5b27 436c 6f73 6564 272c  0,1], ['Closed',
+00006680: 274f 7065 6e27 5d29 0d0a 2020 2020 2020  'Open'])..      
+00006690: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+000066a0: 200d 0a20 2020 2020 2020 2023 204d 6561   ..        # Mea
+000066b0: 6e73 2f73 756d 7320 7769 7468 2069 6e66  ns/sums with inf
+000066c0: 696e 6974 6520 7661 6c75 6573 2070 726f  inite values pro
+000066d0: 6475 6365 206e 616e 2076 616c 7565 7320  duce nan values 
+000066e0: 7261 7468 6572 2074 6861 6e20 0d0a 2020  rather than ..  
+000066f0: 2020 2020 2020 2320 6e70 2e69 6e66 2076        # np.inf v
+00006700: 616c 7565 732e 2043 6f6e 7665 7274 206e  alues. Convert n
+00006710: 616e 2074 6f20 696e 6620 6f6e 6c79 2069  an to inf only i
+00006720: 6620 696e 6669 6e69 7465 2076 616c 7565  f infinite value
+00006730: 7320 6172 650d 0a20 2020 2020 2020 2023  s are..        #
+00006740: 2069 6e63 6c75 6465 6420 696e 2074 6865   included in the
+00006750: 206d 6561 6e2f 7375 6d0d 0a20 2020 2020   mean/sum..     
+00006760: 2020 2064 665b 7365 6c66 2e6c 6566 745f     df[self.left_
+00006770: 626f 756e 645f 636f 6c5d 203d 2028 0d0a  bound_col] = (..
+00006780: 2020 2020 2020 2020 2020 2020 6e70 2e77              np.w
+00006790: 6865 7265 2864 665b 275f 5f4d 696e 696d  here(df['__Minim
+000067a0: 756d 5f5f 275d 203d 3d20 2d6e 702e 696e  um__'] == -np.in
+000067b0: 662c 0d0a 2020 2020 2020 2020 2020 2020  f,..            
+000067c0: 2020 2020 2020 2020 202d 6e70 2e69 6e66           -np.inf
+000067d0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000067e0: 2020 2020 2020 2020 6466 5b73 656c 662e          df[self.
+000067f0: 6c65 6674 5f62 6f75 6e64 5f63 6f6c 5d0d  left_bound_col].
+00006800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006810: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+00006820: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00006830: 6466 5b73 656c 662e 7269 6768 745f 626f  df[self.right_bo
+00006840: 756e 645f 636f 6c5d 203d 2028 0d0a 2020  und_col] = (..  
+00006850: 2020 2020 2020 2020 2020 6e70 2e77 6865            np.whe
+00006860: 7265 2864 665b 275f 5f4d 6178 696d 756d  re(df['__Maximum
+00006870: 5f5f 275d 203d 3d20 6e70 2e69 6e66 2c0d  __'] == np.inf,.
+00006880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006890: 2020 2020 2020 6e70 2e69 6e66 2c0d 0a20        np.inf,.. 
 000068a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000068b0: 2020 2020 6e70 2e69 6e66 2c0d 0a20 2020      np.inf,..   
-000068c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000068d0: 2020 6466 5b73 656c 662e 7269 6768 745f    df[self.right_
-000068e0: 626f 756e 645f 636f 6c5d 0d0a 2020 2020  bound_col]..    
-000068f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006900: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-00006910: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-00006920: 2020 2020 2023 2052 656f 7264 6572 2063       # Reorder c
-00006930: 6f6c 756d 6e73 0d0a 2020 2020 2020 2020  olumns..        
-00006940: 6466 203d 2064 665b 5b73 656c 662e 6c65  df = df[[self.le
-00006950: 6674 5f62 6f75 6e64 6172 795f 636f 6c2c  ft_boundary_col,
-00006960: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00006970: 2020 2073 656c 662e 6c65 6674 5f62 6f75     self.left_bou
-00006980: 6e64 5f63 6f6c 2c0d 0a20 2020 2020 2020  nd_col,..       
-00006990: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
-000069a0: 6967 6874 5f62 6f75 6e64 5f63 6f6c 2c0d  ight_bound_col,.
-000069b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000069c0: 2020 7365 6c66 2e72 6967 6874 5f62 6f75    self.right_bou
-000069d0: 6e64 6172 795f 636f 6c0d 0a20 2020 2020  ndary_col..     
-000069e0: 2020 2020 2020 2020 2020 2020 5d5d 0d0a              ]]..
-000069f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00006a00: 2020 2320 5265 7365 7420 696e 6465 780d    # Reset index.
-00006a10: 0a20 2020 2020 2020 2064 6620 3d20 6466  .        df = df
-00006a20: 2e72 6573 6574 5f69 6e64 6578 2829 0d0a  .reset_index()..
-00006a30: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00006a40: 2020 2320 5265 706c 6163 6520 6f72 2072    # Replace or r
-00006a50: 6574 7572 6e20 7265 7375 6c74 0d0a 2020  eturn result..  
-00006a60: 2020 2020 2020 6966 2069 6e70 6c61 6365        if inplace
-00006a70: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-00006a80: 656c 662e 6461 7461 203d 2064 660d 0a20  elf.data = df.. 
-00006a90: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00006aa0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00006ab0: 2064 660d 0a20 2020 200d 0a20 2020 2064   df..    ..    d
-00006ac0: 6566 206d 6561 6e5f 696e 7465 7276 616c  ef mean_interval
-00006ad0: 2873 656c 662c 2067 726f 7570 6279 5f63  (self, groupby_c
-00006ae0: 6f6c 732c 2069 6e70 6c61 6365 203d 2046  ols, inplace = F
-00006af0: 616c 7365 293a 0d0a 2020 2020 2020 2020  alse):..        
-00006b00: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00006b10: 2073 656c 662e 6d65 616e 5f6f 725f 7375   self.mean_or_su
-00006b20: 6d5f 696e 7465 7276 616c 2827 6d65 616e  m_interval('mean
-00006b30: 272c 2067 726f 7570 6279 5f63 6f6c 732c  ', groupby_cols,
-00006b40: 2069 6e70 6c61 6365 290d 0a20 2020 200d   inplace)..    .
-00006b50: 0a20 2020 2064 6566 2061 6464 5f69 6e74  .    def add_int
-00006b60: 6572 7661 6c28 7365 6c66 2c20 6772 6f75  erval(self, grou
-00006b70: 7062 795f 636f 6c73 2c20 696e 706c 6163  pby_cols, inplac
-00006b80: 6520 3d20 4661 6c73 6529 3a0d 0a20 2020  e = False):..   
-00006b90: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
-00006ba0: 6574 7572 6e20 7365 6c66 2e6d 6561 6e5f  eturn self.mean_
-00006bb0: 6f72 5f73 756d 5f69 6e74 6572 7661 6c28  or_sum_interval(
-00006bc0: 2773 756d 272c 2067 726f 7570 6279 5f63  'sum', groupby_c
-00006bd0: 6f6c 732c 2069 6e70 6c61 6365 290d 0a20  ols, inplace).. 
-00006be0: 2020 200d 0a20 2020 2064 6566 2070 6572     ..    def per
-00006bf0: 6365 6e74 696c 655f 696e 7465 7276 616c  centile_interval
-00006c00: 2873 656c 662c 0d0a 2020 2020 2020 2020  (self,..        
-00006c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c20: 2020 2020 6772 6f75 7062 795f 636f 6c73      groupby_cols
-00006c30: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00006c40: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00006c50: 6572 6365 6e74 696c 652c 0d0a 2020 2020  ercentile,..    
-00006c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c70: 2020 2020 2020 2020 6d65 7468 6f64 203d          method =
-00006c80: 2027 6861 7a65 6e27 2c0d 0a20 2020 2020   'hazen',..     
-00006c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ca0: 2020 2020 2020 2069 6e70 6c61 6365 203d         inplace =
-00006cb0: 2046 616c 7365 293a 0d0a 2020 2020 2020   False):..      
-00006cc0: 2020 0d0a 2020 2020 2020 2020 2320 4372    ..        # Cr
-00006cd0: 6561 7465 2061 2063 6f70 7920 6f66 2074  eate a copy of t
-00006ce0: 6865 2064 6174 610d 0a20 2020 2020 2020  he data..       
-00006cf0: 2064 6620 3d20 7365 6c66 2e64 6174 612e   df = self.data.
-00006d00: 636f 7079 2829 0d0a 2020 2020 2020 2020  copy()..        
-00006d10: 0d0a 2020 2020 2020 2020 2320 436f 6e76  ..        # Conv
-00006d20: 6572 7420 7065 7263 656e 7469 6c65 2074  ert percentile t
-00006d30: 6f20 6265 2062 6574 7765 656e 2030 2061  o be between 0 a
-00006d40: 6e64 2031 0d0a 2020 2020 2020 2020 7065  nd 1..        pe
-00006d50: 7263 656e 7469 6c65 203d 2070 6572 6365  rcentile = perce
-00006d60: 6e74 696c 652f 3130 300d 0a20 2020 2020  ntile/100..     
-00006d70: 2020 200d 0a20 2020 2020 2020 2023 2044     ..        # D
-00006d80: 6574 6572 6d69 6e65 2073 697a 6520 6f66  etermine size of
-00006d90: 2065 6163 6820 6772 6f75 700d 0a20 2020   each group..   
-00006da0: 2020 2020 2069 6620 6772 6f75 7062 795f       if groupby_
-00006db0: 636f 6c73 203d 3d20 4e6f 6e65 3a0d 0a20  cols == None:.. 
-00006dc0: 2020 2020 2020 2020 2020 2064 665b 275f             df['_
-00006dd0: 5f53 697a 655f 5f27 5d20 3d20 6c65 6e28  _Size__'] = len(
-00006de0: 6466 290d 0a20 2020 2020 2020 2065 6c73  df)..        els
-00006df0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00006e00: 6466 5b27 5f5f 5369 7a65 5f5f 275d 203d  df['__Size__'] =
-00006e10: 2064 662e 6772 6f75 7062 7928 6772 6f75   df.groupby(grou
-00006e20: 7062 795f 636f 6c73 292e 7472 616e 7366  pby_cols).transf
-00006e30: 6f72 6d28 2773 697a 6527 290d 0a20 2020  orm('size')..   
-00006e40: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
-00006e50: 2053 6574 2076 616c 7565 7320 666f 7220   Set values for 
-00006e60: 7065 7263 656e 7469 6c65 206d 6574 686f  percentile metho
-00006e70: 6473 0d0a 2020 2020 2020 2020 6d65 7468  ds..        meth
-00006e80: 6f64 5f64 6963 7420 3d20 7b27 7765 6962  od_dict = {'weib
-00006e90: 616c 6c27 3a20 302e 302c 0d0a 2020 2020  all': 0.0,..    
-00006ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006eb0: 2020 2027 7475 6b65 7927 3a20 312f 332c     'tukey': 1/3,
-00006ec0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00006ed0: 2020 2020 2020 2020 2027 626c 6f6d 273a           'blom':
-00006ee0: 2033 2f38 2c0d 0a20 2020 2020 2020 2020   3/8,..         
-00006ef0: 2020 2020 2020 2020 2020 2020 2020 2768                'h
-00006f00: 617a 656e 273a 2031 2f32 2c0d 0a20 2020  azen': 1/2,..   
-00006f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006f20: 2020 2020 2765 7863 656c 273a 312e 307d      'excel':1.0}
-00006f30: 0d0a 2020 2020 2020 2020 2320 6874 7470  ..        # http
-00006f40: 733a 2f2f 656e 2e77 696b 6970 6564 6961  s://en.wikipedia
-00006f50: 2e6f 7267 2f77 696b 692f 5065 7263 656e  .org/wiki/Percen
-00006f60: 7469 6c65 0d0a 2020 2020 2020 2020 4320  tile..        C 
-00006f70: 3d20 6d65 7468 6f64 5f64 6963 745b 6d65  = method_dict[me
-00006f80: 7468 6f64 5d0d 0a20 2020 2020 2020 200d  thod]..        .
-00006f90: 0a20 2020 2020 2020 2023 2043 616c 6375  .        # Calcu
-00006fa0: 6c61 7465 206d 696e 696d 756d 2064 6174  late minimum dat
-00006fb0: 6120 7369 7a65 2066 6f72 2070 6572 6365  a size for perce
-00006fc0: 6e74 696c 6520 6d65 7468 6f64 2074 6f20  ntile method to 
-00006fd0: 0d0a 2020 2020 2020 2020 2320 656e 7375  ..        # ensu
-00006fe0: 7265 2072 616e 6b20 6973 2061 7420 6c65  re rank is at le
-00006ff0: 6173 7420 3120 616e 6420 6e6f 206d 6f72  ast 1 and no mor
-00007000: 6520 7468 616e 206c 656e 2864 6174 6129  e than len(data)
-00007010: 0d0a 2020 2020 2020 2020 6d69 6e69 6d75  ..        minimu
-00007020: 6d5f 7369 7a65 203d 2072 6f75 6e64 2843  m_size = round(C
-00007030: 202b 2028 312d 4329 2a6d 6178 2828 312d   + (1-C)*max((1-
-00007040: 7065 7263 656e 7469 6c65 292f 7065 7263  percentile)/perc
-00007050: 656e 7469 6c65 2c0d 0a20 2020 2020 2020  entile,..       
-00007060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007080: 2020 2020 7065 7263 656e 7469 6c65 2f28      percentile/(
-00007090: 312d 7065 7263 656e 7469 6c65 2929 2c31  1-percentile)),1
-000070a0: 3029 0d0a 2020 2020 2020 2020 0d0a 2020  0)..        ..  
-000070b0: 2020 2020 2020 2320 4f6e 6c79 2063 6f6e        # Only con
-000070c0: 7369 6465 7220 6772 6f75 7073 2074 6861  sider groups tha
-000070d0: 7420 6d65 6574 2074 6865 206d 696e 696d  t meet the minim
-000070e0: 756d 2073 697a 6520 7265 7175 6972 656d  um size requirem
-000070f0: 656e 740d 0a20 2020 2020 2020 2023 2064  ent..        # d
-00007100: 6620 3d20 6466 5b64 665b 275f 5f53 697a  f = df[df['__Siz
-00007110: 655f 5f27 5d20 3e3d 206d 696e 696d 756d  e__'] >= minimum
-00007120: 5f73 697a 655d 0d0a 2020 2020 2020 2020  _size]..        
-00007130: 6466 5b27 5f5f 5761 726e 696e 675f 5f27  df['__Warning__'
-00007140: 5d20 3d20 2727 0d0a 2020 2020 2020 2020  ] = ''..        
-00007150: 636f 6e64 6974 696f 6e20 3d20 2864 665b  condition = (df[
-00007160: 275f 5f53 697a 655f 5f27 5d20 3c20 6d69  '__Size__'] < mi
-00007170: 6e69 6d75 6d5f 7369 7a65 290d 0a20 2020  nimum_size)..   
-00007180: 2020 2020 2069 6620 7065 7263 656e 7469       if percenti
-00007190: 6c65 203e 2030 2e35 3a0d 0a20 2020 2020  le > 0.5:..     
-000071a0: 2020 2020 2020 2064 662e 6c6f 635b 636f         df.loc[co
-000071b0: 6e64 6974 696f 6e2c 2027 5f5f 5761 726e  ndition, '__Warn
-000071c0: 696e 675f 5f27 5d20 3d20 2720 286c 6f77  ing__'] = ' (low
-000071d0: 2063 6f75 6e74 2c20 7573 6564 206d 6178   count, used max
-000071e0: 2927 0d0a 2020 2020 2020 2020 656c 7365  )'..        else
-000071f0: 3a0d 0a20 2020 2020 2020 2020 2020 2064  :..            d
-00007200: 662e 6c6f 635b 636f 6e64 6974 696f 6e2c  f.loc[condition,
-00007210: 2027 5f5f 5761 726e 696e 675f 5f27 5d20   '__Warning__'] 
-00007220: 3d20 2720 286c 6f77 2063 6f75 6e74 2c20  = ' (low count, 
-00007230: 7573 6564 206d 696e 2927 0d0a 2020 2020  used min)'..    
-00007240: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
-00007250: 4465 7465 726d 696e 6520 6c65 6674 2062  Determine left b
-00007260: 6f75 6e64 2061 6e64 2062 6f75 6e64 6172  ound and boundar
-00007270: 7920 666f 7220 6561 6368 2067 726f 7570  y for each group
-00007280: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00007290: 2020 2020 2320 4368 616e 6765 206e 6f74      # Change not
-000072a0: 6174 696f 6e20 6f66 2027 436c 6f73 6564  ation of 'Closed
-000072b0: 2720 616e 6420 274f 7065 6e27 2062 6f75  ' and 'Open' bou
-000072c0: 6e64 6172 6965 7320 746f 2030 2061 6e64  ndaries to 0 and
-000072d0: 2031 2c0d 0a20 2020 2020 2020 2023 2072   1,..        # r
-000072e0: 6573 7065 6374 6976 656c 792e 2055 7365  espectively. Use
-000072f0: 2030 2066 6f72 2063 6c6f 7365 6420 746f   0 for closed to
-00007300: 2065 6e73 7572 6520 7468 6174 2063 6c6f   ensure that clo
-00007310: 7365 6420 626f 756e 6461 7269 6573 2061  sed boundaries a
-00007320: 7265 0d0a 2020 2020 2020 2020 2320 736f  re..        # so
-00007330: 7274 6564 206c 6573 7320 7468 616e 206f  rted less than o
-00007340: 7065 6e20 626f 756e 6461 7269 6573 2077  pen boundaries w
-00007350: 6865 6e20 7468 6520 6c65 6674 2062 6f75  hen the left bou
-00007360: 6e64 2069 7320 7469 6564 0d0a 2020 2020  nd is tied..    
-00007370: 2020 2020 6466 5b73 656c 662e 6c65 6674      df[self.left
-00007380: 5f62 6f75 6e64 6172 795f 636f 6c5d 203d  _boundary_col] =
-00007390: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-000073a0: 6466 5b73 656c 662e 6c65 6674 5f62 6f75  df[self.left_bou
-000073b0: 6e64 6172 795f 636f 6c5d 0d0a 2020 2020  ndary_col]..    
-000073c0: 2020 2020 2020 2020 2020 2020 2e72 6570              .rep
-000073d0: 6c61 6365 285b 2743 6c6f 7365 6427 2c27  lace(['Closed','
-000073e0: 4f70 656e 275d 2c20 5b30 2c31 5d29 0d0a  Open'], [0,1])..
-000073f0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-00007400: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00007410: 2023 2053 6f72 7420 6c65 6674 2062 6f75   # Sort left bou
-00007420: 6e64 2076 616c 7565 730d 0a20 2020 2020  nd values..     
-00007430: 2020 2067 726f 7570 696e 6720 3d20 5b27     grouping = ['
-00007440: 5f5f 5369 7a65 5f5f 272c 2073 656c 662e  __Size__', self.
-00007450: 6c65 6674 5f62 6f75 6e64 6172 795f 636f  left_boundary_co
-00007460: 6c2c 2073 656c 662e 6c65 6674 5f62 6f75  l, self.left_bou
-00007470: 6e64 5f63 6f6c 5d0d 0a20 2020 2020 2020  nd_col]..       
-00007480: 2069 6620 6772 6f75 7062 795f 636f 6c73   if groupby_cols
-00007490: 2021 3d20 4e6f 6e65 3a0d 0a20 2020 2020   != None:..     
-000074a0: 2020 2020 2020 2067 726f 7570 696e 6720         grouping 
-000074b0: 3d20 6772 6f75 7062 795f 636f 6c73 202b  = groupby_cols +
-000074c0: 2067 726f 7570 696e 670d 0a20 2020 2020   grouping..     
-000074d0: 2020 200d 0a20 2020 2020 2020 206c 6566     ..        lef
-000074e0: 7420 3d20 280d 0a20 2020 2020 2020 2020  t = (..         
-000074f0: 2020 2064 662e 636f 7079 2829 5b67 726f     df.copy()[gro
-00007500: 7570 696e 675d 0d0a 2020 2020 2020 2020  uping]..        
-00007510: 2020 2020 2020 2020 2e73 6f72 745f 7661          .sort_va
-00007520: 6c75 6573 280d 0a20 2020 2020 2020 2020  lues(..         
-00007530: 2020 2020 2020 2020 2020 2062 7920 3d20             by = 
-00007540: 5b73 656c 662e 6c65 6674 5f62 6f75 6e64  [self.left_bound
-00007550: 5f63 6f6c 2c20 7365 6c66 2e6c 6566 745f  _col, self.left_
-00007560: 626f 756e 6461 7279 5f63 6f6c 5d0d 0a20  boundary_col].. 
-00007570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007580: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
-00007590: 2020 290d 0a20 2020 2020 2020 200d 0a20    )..        .. 
-000075a0: 2020 2020 2020 2023 2041 6464 2069 6e64         # Add ind
-000075b0: 6578 2066 6f72 2065 6163 6820 6772 6f75  ex for each grou
-000075c0: 700d 0a20 2020 2020 2020 2069 6620 6772  p..        if gr
-000075d0: 6f75 7062 795f 636f 6c73 203d 3d20 4e6f  oupby_cols == No
-000075e0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-000075f0: 206c 6566 745b 275f 5f49 6e64 6578 5f5f   left['__Index__
-00007600: 275d 203d 2072 616e 6765 2831 2c20 312b  '] = range(1, 1+
-00007610: 6c65 6e28 6c65 6674 2929 0d0a 2020 2020  len(left))..    
-00007620: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00007630: 2020 2020 2020 206c 6566 745b 275f 5f49         left['__I
-00007640: 6e64 6578 5f5f 275d 203d 206c 6566 742e  ndex__'] = left.
-00007650: 6772 6f75 7062 7928 6772 6f75 7062 795f  groupby(groupby_
-00007660: 636f 6c73 292e 6375 6d63 6f75 6e74 2829  cols).cumcount()
-00007670: 202b 2031 0d0a 2020 2020 2020 2020 0d0a   + 1..        ..
-00007680: 2020 2020 2020 2020 2320 4465 7465 726d          # Determ
-00007690: 696e 6520 7468 6520 7261 6e6b 2069 6e20  ine the rank in 
-000076a0: 6561 6368 2067 726f 7570 2066 6f72 2074  each group for t
-000076b0: 6865 2070 6572 6365 6e74 696c 650d 0a20  he percentile.. 
-000076c0: 2020 2020 2020 2023 2055 7365 2072 6f75         # Use rou
-000076d0: 6e64 696e 6720 6174 2038 2064 6563 696d  nding at 8 decim
-000076e0: 616c 7320 746f 2070 7265 7665 6e74 2061  als to prevent a
-000076f0: 7274 6966 6963 6961 6c20 6465 6369 6d61  rtificial decima
-00007700: 6c73 0d0a 2020 2020 2020 2020 6c65 6674  ls..        left
-00007710: 5b27 5f5f 5261 6e6b 5f5f 275d 203d 2072  ['__Rank__'] = r
-00007720: 6f75 6e64 280d 0a20 2020 2020 2020 2020  ound(..         
-00007730: 2020 2043 202b 2070 6572 6365 6e74 696c     C + percentil
-00007740: 652a 286c 6566 745b 275f 5f53 697a 655f  e*(left['__Size_
-00007750: 5f27 5d20 2b20 3120 2d20 322a 4329 2c0d  _'] + 1 - 2*C),.
-00007760: 0a20 2020 2020 2020 2020 2020 2038 0d0a  .            8..
-00007770: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-00007780: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00007790: 2023 2048 616e 646c 6520 7369 7475 6174   # Handle situat
-000077a0: 696f 6e73 2077 6865 7265 2072 616e 6b20  ions where rank 
-000077b0: 6973 206f 7574 7369 6465 2074 6865 2072  is outside the r
-000077c0: 616e 6765 2031 2074 6f20 6c65 6e67 7468  ange 1 to length
-000077d0: 206f 6620 6461 7461 0d0a 2020 2020 2020   of data..      
-000077e0: 2020 636f 6e64 6974 696f 6e73 203d 205b    conditions = [
-000077f0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00007800: 5573 6520 6d61 7869 6d75 6d20 7261 6e6b  Use maximum rank
-00007810: 2069 6620 7261 6e6b 2069 7320 6c61 7267   if rank is larg
-00007820: 6572 2074 6861 6e20 7468 6520 6c65 6e67  er than the leng
-00007830: 7468 206f 6620 7468 6520 6461 7461 7365  th of the datase
-00007840: 740d 0a20 2020 2020 2020 2020 2020 2028  t..            (
-00007850: 6c65 6674 5b27 5f5f 5261 6e6b 5f5f 275d  left['__Rank__']
-00007860: 203e 206c 6566 745b 275f 5f53 697a 655f   > left['__Size_
-00007870: 5f27 5d29 2c0d 0a20 2020 2020 2020 2020  _']),..         
-00007880: 2020 2023 2055 7365 2072 616e 6b20 6f66     # Use rank of
-00007890: 2031 2069 6620 7261 6e6b 2069 7320 6c65   1 if rank is le
-000078a0: 7373 2074 6861 6e20 310d 0a20 2020 2020  ss than 1..     
-000078b0: 2020 2020 2020 2028 6c65 6674 5b27 5f5f         (left['__
-000078c0: 5261 6e6b 5f5f 275d 203c 2031 290d 0a20  Rank__'] < 1).. 
-000078d0: 2020 2020 2020 2020 2020 205d 0d0a 2020             ]..  
-000078e0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000078f0: 7265 7375 6c74 7320 3d20 5b0d 0a20 2020  results = [..   
-00007900: 2020 2020 2020 2020 206c 6566 745b 275f           left['_
-00007910: 5f53 697a 655f 5f27 5d2c 0d0a 2020 2020  _Size__'],..    
-00007920: 2020 2020 2020 2020 310d 0a20 2020 2020          1..     
-00007930: 2020 2020 2020 205d 0d0a 2020 2020 2020         ]..      
-00007940: 2020 0d0a 2020 2020 2020 2020 6c65 6674    ..        left
-00007950: 5b27 5f5f 5261 6e6b 5f5f 275d 203d 206e  ['__Rank__'] = n
-00007960: 702e 7365 6c65 6374 2863 6f6e 6469 7469  p.select(conditi
-00007970: 6f6e 732c 2072 6573 756c 7473 2c20 6c65  ons, results, le
-00007980: 6674 5b27 5f5f 5261 6e6b 5f5f 275d 290d  ft['__Rank__']).
-00007990: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-000079a0: 2020 2023 2047 656e 6572 6174 6520 7072     # Generate pr
-000079b0: 6f78 696d 6974 7920 6f66 2065 6163 6820  oximity of each 
-000079c0: 7265 7375 6c74 2074 6f20 7065 7263 656e  result to percen
-000079d0: 7469 6c65 2072 616e 6b20 7573 696e 6720  tile rank using 
-000079e0: 7468 6520 696e 6465 780d 0a20 2020 2020  the index..     
-000079f0: 2020 206c 6566 745b 275f 5f50 726f 7869     left['__Proxi
-00007a00: 6d69 7479 5f5f 275d 203d 2030 0d0a 2020  mity__'] = 0..  
-00007a10: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00007a20: 636f 6e64 6974 696f 6e73 203d 205b 0d0a  conditions = [..
-00007a30: 2020 2020 2020 2020 2020 2020 2320 4966              # If
-00007a40: 2074 6865 2070 6572 6365 6e74 696c 6520   the percentile 
-00007a50: 7261 6e6b 2069 7320 6120 7768 6f6c 6520  rank is a whole 
-00007a60: 6e75 6d62 6572 2c0d 0a20 2020 2020 2020  number,..       
-00007a70: 2020 2020 2023 2074 6865 6e20 7573 6520       # then use 
-00007a80: 7468 6174 2069 6e64 6578 2072 6573 756c  that index resul
-00007a90: 740d 0a20 2020 2020 2020 2020 2020 2028  t..            (
-00007aa0: 6c65 6674 5b27 5f5f 5261 6e6b 5f5f 275d  left['__Rank__']
-00007ab0: 203d 3d20 6c65 6674 5b27 5f5f 496e 6465   == left['__Inde
-00007ac0: 785f 5f27 5d29 2c0d 0a20 2020 2020 2020  x__']),..       
-00007ad0: 2020 2020 2023 2049 6620 7468 6520 7065       # If the pe
-00007ae0: 7263 656e 7469 6c65 2072 616e 6b20 6973  rcentile rank is
-00007af0: 206c 6573 7320 7468 616e 2031 2061 626f   less than 1 abo
-00007b00: 7665 2074 6865 2069 6e64 6578 2076 616c  ve the index val
-00007b10: 7565 2c0d 0a20 2020 2020 2020 2020 2020  ue,..           
-00007b20: 2023 2074 6865 6e20 6173 7369 676e 2074   # then assign t
-00007b30: 6865 2061 7070 726f 7072 6961 7465 2063  he appropriate c
-00007b40: 6f6e 7472 6962 7574 696f 6e20 746f 2074  ontribution to t
-00007b50: 6861 7420 696e 6465 7820 7661 6c75 650d  hat index value.
-00007b60: 0a20 2020 2020 2020 2020 2020 2028 286c  .            ((l
-00007b70: 6566 745b 275f 5f52 616e 6b5f 5f27 5d20  eft['__Rank__'] 
-00007b80: 2d20 6c65 6674 5b27 5f5f 496e 6465 785f  - left['__Index_
-00007b90: 5f27 5d29 0d0a 2020 2020 2020 2020 2020  _'])..          
-00007ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007bb0: 2020 2020 2020 2020 2020 2020 2020 202e                 .
-00007bc0: 6265 7477 6565 6e28 302c 312c 696e 636c  between(0,1,incl
-00007bd0: 7573 6976 653d 276e 6569 7468 6572 2729  usive='neither')
-00007be0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-00007bf0: 2320 4966 2074 6865 2070 6572 6365 6e74  # If the percent
-00007c00: 696c 6520 7261 6e6b 2069 7320 6c65 7373  ile rank is less
-00007c10: 2074 6861 6e20 3120 6265 6c6f 7720 7468   than 1 below th
-00007c20: 6520 696e 6465 7820 7661 6c75 652c 0d0a  e index value,..
-00007c30: 2020 2020 2020 2020 2020 2020 2320 7468              # th
-00007c40: 656e 2061 7373 6967 6e20 7468 6520 6170  en assign the ap
-00007c50: 7072 6f70 7269 6174 6520 636f 6e74 7269  propriate contri
-00007c60: 6275 7469 6f6e 2074 6f20 7468 6174 2069  bution to that i
-00007c70: 6e64 6578 2076 616c 7565 0d0a 2020 2020  ndex value..    
-00007c80: 2020 2020 2020 2020 2828 6c65 6674 5b27          ((left['
-00007c90: 5f5f 496e 6465 785f 5f27 5d20 2d20 6c65  __Index__'] - le
-00007ca0: 6674 5b27 5f5f 5261 6e6b 5f5f 275d 290d  ft['__Rank__']).
-00007cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007cd0: 2020 2020 2020 2020 2020 2e62 6574 7765            .betwe
-00007ce0: 656e 2830 2c31 2c69 6e63 6c75 7369 7665  en(0,1,inclusive
-00007cf0: 3d27 6e65 6974 6865 7227 2929 0d0a 2020  ='neither'))..  
-00007d00: 2020 2020 2020 2020 2020 5d0d 0a20 2020            ]..   
-00007d10: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
-00007d20: 6573 756c 7473 203d 205b 0d0a 2020 2020  esults = [..    
-00007d30: 2020 2020 2020 2020 312c 0d0a 2020 2020          1,..    
-00007d40: 2020 2020 2020 2020 3120 2d20 286c 6566          1 - (lef
-00007d50: 745b 275f 5f52 616e 6b5f 5f27 5d20 2d20  t['__Rank__'] - 
-00007d60: 6c65 6674 5b27 5f5f 496e 6465 785f 5f27  left['__Index__'
-00007d70: 5d29 2c0d 0a20 2020 2020 2020 2020 2020  ]),..           
-00007d80: 2031 202d 2028 6c65 6674 5b27 5f5f 496e   1 - (left['__In
-00007d90: 6465 785f 5f27 5d20 2d20 6c65 6674 5b27  dex__'] - left['
-00007da0: 5f5f 5261 6e6b 5f5f 275d 292c 0d0a 2020  __Rank__']),..  
-00007db0: 2020 2020 2020 2020 2020 5d0d 0a20 2020            ]..   
-00007dc0: 2020 2020 200d 0a20 2020 2020 2020 206c       ..        l
-00007dd0: 6566 745b 275f 5f50 726f 7869 6d69 7479  eft['__Proximity
-00007de0: 5f5f 275d 203d 206e 702e 7365 6c65 6374  __'] = np.select
-00007df0: 2863 6f6e 6469 7469 6f6e 732c 2072 6573  (conditions, res
-00007e00: 756c 7473 2c20 6e70 2e6e 616e 290d 0a20  ults, np.nan).. 
-00007e10: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00007e20: 2023 2044 726f 7020 6e6f 6e2d 636f 6e74   # Drop non-cont
-00007e30: 7269 6275 7469 6e67 2072 6f77 730d 0a20  ributing rows.. 
-00007e40: 2020 2020 2020 206c 6566 7420 3d20 6c65         left = le
-00007e50: 6674 5b6c 6566 745b 275f 5f50 726f 7869  ft[left['__Proxi
-00007e60: 6d69 7479 5f5f 275d 203e 2030 5d0d 0a20  mity__'] > 0].. 
-00007e70: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00007e80: 2023 2043 616c 6375 6c61 7465 2063 6f6e   # Calculate con
-00007e90: 7472 6962 7574 696f 6e20 666f 7220 696e  tribution for in
-00007ea0: 6465 7820 7661 6c75 6573 2074 6861 7420  dex values that 
-00007eb0: 636f 6e74 7269 6275 7465 2074 6f20 7468  contribute to th
-00007ec0: 6520 7265 7375 6c74 0d0a 2020 2020 2020  e result..      
-00007ed0: 2020 6c65 6674 5b27 5f5f 436f 6e74 7269    left['__Contri
-00007ee0: 6275 7469 6f6e 5f5f 275d 203d 2028 0d0a  bution__'] = (..
-00007ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f00: 6c65 6674 5b27 5f5f 5072 6f78 696d 6974  left['__Proximit
-00007f10: 795f 5f27 5d20 2a20 6c65 6674 5b73 656c  y__'] * left[sel
-00007f20: 662e 6c65 6674 5f62 6f75 6e64 5f63 6f6c  f.left_bound_col
-00007f30: 5d0d 0a20 2020 2020 2020 2020 2020 2029  ]..            )
-00007f40: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00007f50: 2020 2020 2320 4966 2067 726f 7570 6279      # If groupby
-00007f60: 5f63 6f6c 732c 2074 6865 6e20 6772 6f75  _cols, then grou
-00007f70: 7020 6461 7461 0d0a 2020 2020 2020 2020  p data..        
-00007f80: 6966 2067 726f 7570 6279 5f63 6f6c 7320  if groupby_cols 
-00007f90: 3d3d 204e 6f6e 653a 0d0a 2020 2020 2020  == None:..      
-00007fa0: 2020 2020 2020 6c65 6674 203d 2070 642e        left = pd.
-00007fb0: 4461 7461 4672 616d 6528 0d0a 2020 2020  DataFrame(..    
-00007fc0: 2020 2020 2020 2020 2020 2020 5b5b 6d61              [[ma
-00007fd0: 7828 6c65 6674 5b73 656c 662e 6c65 6674  x(left[self.left
-00007fe0: 5f62 6f75 6e64 6172 795f 636f 6c5d 292c  _boundary_col]),
-00007ff0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008000: 2020 2020 7375 6d28 6c65 6674 5b27 5f5f      sum(left['__
-00008010: 436f 6e74 7269 6275 7469 6f6e 5f5f 275d  Contribution__']
-00008020: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-00008030: 2020 2020 2020 6d69 6e28 6c65 6674 5b27        min(left['
-00008040: 5f5f 436f 6e74 7269 6275 7469 6f6e 5f5f  __Contribution__
-00008050: 275d 295d 5d2c 0d0a 2020 2020 2020 2020  '])]],..        
-00008060: 2020 2020 2020 2020 636f 6c75 6d6e 733d          columns=
-00008070: 5b0d 0a20 2020 2020 2020 2020 2020 2020  [..             
-00008080: 2020 2020 2020 2073 656c 662e 6c65 6674         self.left
-00008090: 5f62 6f75 6e64 6172 795f 636f 6c2c 0d0a  _boundary_col,..
-000080a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000080b0: 2020 2020 7365 6c66 2e6c 6566 745f 626f      self.left_bo
-000080c0: 756e 645f 636f 6c2c 0d0a 2020 2020 2020  und_col,..      
-000080d0: 2020 2020 2020 2020 2020 2020 2020 275f                '_
-000080e0: 5f4d 696e 696d 756d 5f5f 270d 0a20 2020  _Minimum__'..   
-000080f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008100: 205d 0d0a 2020 2020 2020 2020 2020 2020   ]..            
-00008110: 2020 2020 290d 0a20 2020 2020 2020 2023      )..        #
-00008120: 2044 6574 6572 6d69 6e65 206c 6566 7420   Determine left 
-00008130: 626f 756e 6420 616e 6420 626f 756e 6461  bound and bounda
-00008140: 7279 2075 7369 6e67 2074 6865 2073 756d  ry using the sum
-00008150: 206f 6620 7468 6520 636f 6e74 7269 6275   of the contribu
-00008160: 7469 6f6e 730d 0a20 2020 2020 2020 2023  tions..        #
-00008170: 2061 6e64 2061 6e20 6f70 656e 2062 6f75   and an open bou
-00008180: 6e64 6172 7920 6966 2061 6e79 206f 6620  ndary if any of 
-00008190: 7468 6520 636f 6e74 7269 6275 7469 6e67  the contributing
-000081a0: 2076 616c 7565 7320 6973 206f 7065 6e0d   values is open.
-000081b0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-000081c0: 2020 2020 2020 2020 2020 2020 6c65 6674              left
-000081d0: 203d 2028 0d0a 2020 2020 2020 2020 2020   = (..          
-000081e0: 2020 2020 2020 6c65 6674 2e67 726f 7570        left.group
-000081f0: 6279 2867 726f 7570 6279 5f63 6f6c 7329  by(groupby_cols)
+000068b0: 2020 2020 6466 5b73 656c 662e 7269 6768      df[self.righ
+000068c0: 745f 626f 756e 645f 636f 6c5d 0d0a 2020  t_bound_col]..  
+000068d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000068e0: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
+000068f0: 2020 290d 0a20 2020 2020 2020 200d 0a20    )..        .. 
+00006900: 2020 2020 2020 2023 2052 656f 7264 6572         # Reorder
+00006910: 2063 6f6c 756d 6e73 0d0a 2020 2020 2020   columns..      
+00006920: 2020 6466 203d 2064 665b 5b73 656c 662e    df = df[[self.
+00006930: 6c65 6674 5f62 6f75 6e64 6172 795f 636f  left_boundary_co
+00006940: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
+00006950: 2020 2020 2073 656c 662e 6c65 6674 5f62       self.left_b
+00006960: 6f75 6e64 5f63 6f6c 2c0d 0a20 2020 2020  ound_col,..     
+00006970: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00006980: 2e72 6967 6874 5f62 6f75 6e64 5f63 6f6c  .right_bound_col
+00006990: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000069a0: 2020 2020 7365 6c66 2e72 6967 6874 5f62      self.right_b
+000069b0: 6f75 6e64 6172 795f 636f 6c0d 0a20 2020  oundary_col..   
+000069c0: 2020 2020 2020 2020 2020 2020 2020 5d5d                ]]
+000069d0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000069e0: 2020 2020 2320 5265 7365 7420 696e 6465      # Reset inde
+000069f0: 780d 0a20 2020 2020 2020 2064 6620 3d20  x..        df = 
+00006a00: 6466 2e72 6573 6574 5f69 6e64 6578 2829  df.reset_index()
+00006a10: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00006a20: 2020 2020 2320 5265 706c 6163 6520 6f72      # Replace or
+00006a30: 2072 6574 7572 6e20 7265 7375 6c74 0d0a   return result..
+00006a40: 2020 2020 2020 2020 6966 2069 6e70 6c61          if inpla
+00006a50: 6365 3a0d 0a20 2020 2020 2020 2020 2020  ce:..           
+00006a60: 2073 656c 662e 6461 7461 203d 2064 660d   self.data = df.
+00006a70: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00006a80: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00006a90: 726e 2064 660d 0a20 2020 200d 0a20 2020  rn df..    ..   
+00006aa0: 2064 6566 206d 6561 6e5f 696e 7465 7276   def mean_interv
+00006ab0: 616c 2873 656c 662c 2067 726f 7570 6279  al(self, groupby
+00006ac0: 5f63 6f6c 732c 2069 6e70 6c61 6365 203d  _cols, inplace =
+00006ad0: 2046 616c 7365 293a 0d0a 2020 2020 2020   False):..      
+00006ae0: 2020 0d0a 2020 2020 2020 2020 7265 7475    ..        retu
+00006af0: 726e 2073 656c 662e 6d65 616e 5f6f 725f  rn self.mean_or_
+00006b00: 7375 6d5f 696e 7465 7276 616c 2827 6d65  sum_interval('me
+00006b10: 616e 272c 2067 726f 7570 6279 5f63 6f6c  an', groupby_col
+00006b20: 732c 2069 6e70 6c61 6365 290d 0a20 2020  s, inplace)..   
+00006b30: 200d 0a20 2020 2064 6566 2061 6464 5f69   ..    def add_i
+00006b40: 6e74 6572 7661 6c28 7365 6c66 2c20 6772  nterval(self, gr
+00006b50: 6f75 7062 795f 636f 6c73 2c20 696e 706c  oupby_cols, inpl
+00006b60: 6163 6520 3d20 4661 6c73 6529 3a0d 0a20  ace = False):.. 
+00006b70: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00006b80: 2072 6574 7572 6e20 7365 6c66 2e6d 6561   return self.mea
+00006b90: 6e5f 6f72 5f73 756d 5f69 6e74 6572 7661  n_or_sum_interva
+00006ba0: 6c28 2773 756d 272c 2067 726f 7570 6279  l('sum', groupby
+00006bb0: 5f63 6f6c 732c 2069 6e70 6c61 6365 290d  _cols, inplace).
+00006bc0: 0a20 2020 200d 0a20 2020 2064 6566 2070  .    ..    def p
+00006bd0: 6572 6365 6e74 696c 655f 696e 7465 7276  ercentile_interv
+00006be0: 616c 2873 656c 662c 0d0a 2020 2020 2020  al(self,..      
+00006bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c00: 2020 2020 2020 6772 6f75 7062 795f 636f        groupby_co
+00006c10: 6c73 2c0d 0a20 2020 2020 2020 2020 2020  ls,..           
+00006c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c30: 2070 6572 6365 6e74 696c 652c 0d0a 2020   percentile,..  
+00006c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c50: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00006c60: 203d 2027 6861 7a65 6e27 2c0d 0a20 2020   = 'hazen',..   
+00006c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c80: 2020 2020 2020 2020 2069 6e70 6c61 6365           inplace
+00006c90: 203d 2046 616c 7365 293a 0d0a 2020 2020   = False):..    
+00006ca0: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
+00006cb0: 4372 6561 7465 2061 2063 6f70 7920 6f66  Create a copy of
+00006cc0: 2074 6865 2064 6174 610d 0a20 2020 2020   the data..     
+00006cd0: 2020 2064 6620 3d20 7365 6c66 2e64 6174     df = self.dat
+00006ce0: 612e 636f 7079 2829 0d0a 2020 2020 2020  a.copy()..      
+00006cf0: 2020 0d0a 2020 2020 2020 2020 2320 436f    ..        # Co
+00006d00: 6e76 6572 7420 7065 7263 656e 7469 6c65  nvert percentile
+00006d10: 2074 6f20 6265 2062 6574 7765 656e 2030   to be between 0
+00006d20: 2061 6e64 2031 0d0a 2020 2020 2020 2020   and 1..        
+00006d30: 7065 7263 656e 7469 6c65 203d 2070 6572  percentile = per
+00006d40: 6365 6e74 696c 652f 3130 300d 0a20 2020  centile/100..   
+00006d50: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+00006d60: 2044 6574 6572 6d69 6e65 2073 697a 6520   Determine size 
+00006d70: 6f66 2065 6163 6820 6772 6f75 700d 0a20  of each group.. 
+00006d80: 2020 2020 2020 2069 6620 6772 6f75 7062         if groupb
+00006d90: 795f 636f 6c73 203d 3d20 4e6f 6e65 3a0d  y_cols == None:.
+00006da0: 0a20 2020 2020 2020 2020 2020 2064 665b  .            df[
+00006db0: 275f 5f53 697a 655f 5f27 5d20 3d20 6c65  '__Size__'] = le
+00006dc0: 6e28 6466 290d 0a20 2020 2020 2020 2065  n(df)..        e
+00006dd0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00006de0: 2020 6466 5b27 5f5f 5369 7a65 5f5f 275d    df['__Size__']
+00006df0: 203d 2064 662e 6772 6f75 7062 7928 6772   = df.groupby(gr
+00006e00: 6f75 7062 795f 636f 6c73 292e 7472 616e  oupby_cols).tran
+00006e10: 7366 6f72 6d28 2773 697a 6527 290d 0a20  sform('size').. 
+00006e20: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00006e30: 2023 2053 6574 2076 616c 7565 7320 666f   # Set values fo
+00006e40: 7220 7065 7263 656e 7469 6c65 206d 6574  r percentile met
+00006e50: 686f 6473 0d0a 2020 2020 2020 2020 6d65  hods..        me
+00006e60: 7468 6f64 5f64 6963 7420 3d20 7b27 7765  thod_dict = {'we
+00006e70: 6962 616c 6c27 3a20 302e 302c 0d0a 2020  iball': 0.0,..  
+00006e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006e90: 2020 2020 2027 7475 6b65 7927 3a20 312f       'tukey': 1/
+00006ea0: 332c 0d0a 2020 2020 2020 2020 2020 2020  3,..            
+00006eb0: 2020 2020 2020 2020 2020 2027 626c 6f6d             'blom
+00006ec0: 273a 2033 2f38 2c0d 0a20 2020 2020 2020  ': 3/8,..       
+00006ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006ee0: 2768 617a 656e 273a 2031 2f32 2c0d 0a20  'hazen': 1/2,.. 
+00006ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006f00: 2020 2020 2020 2765 7863 656c 273a 312e        'excel':1.
+00006f10: 307d 0d0a 2020 2020 2020 2020 2320 6874  0}..        # ht
+00006f20: 7470 733a 2f2f 656e 2e77 696b 6970 6564  tps://en.wikiped
+00006f30: 6961 2e6f 7267 2f77 696b 692f 5065 7263  ia.org/wiki/Perc
+00006f40: 656e 7469 6c65 0d0a 2020 2020 2020 2020  entile..        
+00006f50: 4320 3d20 6d65 7468 6f64 5f64 6963 745b  C = method_dict[
+00006f60: 6d65 7468 6f64 5d0d 0a20 2020 2020 2020  method]..       
+00006f70: 200d 0a20 2020 2020 2020 2023 2043 616c   ..        # Cal
+00006f80: 6375 6c61 7465 206d 696e 696d 756d 2064  culate minimum d
+00006f90: 6174 6120 7369 7a65 2066 6f72 2070 6572  ata size for per
+00006fa0: 6365 6e74 696c 6520 6d65 7468 6f64 2074  centile method t
+00006fb0: 6f20 0d0a 2020 2020 2020 2020 2320 656e  o ..        # en
+00006fc0: 7375 7265 2072 616e 6b20 6973 2061 7420  sure rank is at 
+00006fd0: 6c65 6173 7420 3120 616e 6420 6e6f 206d  least 1 and no m
+00006fe0: 6f72 6520 7468 616e 206c 656e 2864 6174  ore than len(dat
+00006ff0: 6129 0d0a 2020 2020 2020 2020 6d69 6e69  a)..        mini
+00007000: 6d75 6d5f 7369 7a65 203d 2072 6f75 6e64  mum_size = round
+00007010: 2843 202b 2028 312d 4329 2a6d 6178 2828  (C + (1-C)*max((
+00007020: 312d 7065 7263 656e 7469 6c65 292f 7065  1-percentile)/pe
+00007030: 7263 656e 7469 6c65 2c0d 0a20 2020 2020  rcentile,..     
+00007040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007060: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
+00007070: 2f28 312d 7065 7263 656e 7469 6c65 2929  /(1-percentile))
+00007080: 2c31 3029 0d0a 2020 2020 2020 2020 0d0a  ,10)..        ..
+00007090: 2020 2020 2020 2020 2320 4f6e 6c79 2063          # Only c
+000070a0: 6f6e 7369 6465 7220 6772 6f75 7073 2074  onsider groups t
+000070b0: 6861 7420 6d65 6574 2074 6865 206d 696e  hat meet the min
+000070c0: 696d 756d 2073 697a 6520 7265 7175 6972  imum size requir
+000070d0: 656d 656e 740d 0a20 2020 2020 2020 2023  ement..        #
+000070e0: 2064 6620 3d20 6466 5b64 665b 275f 5f53   df = df[df['__S
+000070f0: 697a 655f 5f27 5d20 3e3d 206d 696e 696d  ize__'] >= minim
+00007100: 756d 5f73 697a 655d 0d0a 2020 2020 2020  um_size]..      
+00007110: 2020 6466 5b27 5f5f 5761 726e 696e 675f    df['__Warning_
+00007120: 5f27 5d20 3d20 2727 0d0a 2020 2020 2020  _'] = ''..      
+00007130: 2020 636f 6e64 6974 696f 6e20 3d20 2864    condition = (d
+00007140: 665b 275f 5f53 697a 655f 5f27 5d20 3c20  f['__Size__'] < 
+00007150: 6d69 6e69 6d75 6d5f 7369 7a65 290d 0a20  minimum_size).. 
+00007160: 2020 2020 2020 2069 6620 7065 7263 656e         if percen
+00007170: 7469 6c65 203e 2030 2e35 3a0d 0a20 2020  tile > 0.5:..   
+00007180: 2020 2020 2020 2020 2064 662e 6c6f 635b           df.loc[
+00007190: 636f 6e64 6974 696f 6e2c 2027 5f5f 5761  condition, '__Wa
+000071a0: 726e 696e 675f 5f27 5d20 3d20 2720 286c  rning__'] = ' (l
+000071b0: 6f77 2063 6f75 6e74 2c20 7573 6564 206d  ow count, used m
+000071c0: 6178 2927 0d0a 2020 2020 2020 2020 656c  ax)'..        el
+000071d0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+000071e0: 2064 662e 6c6f 635b 636f 6e64 6974 696f   df.loc[conditio
+000071f0: 6e2c 2027 5f5f 5761 726e 696e 675f 5f27  n, '__Warning__'
+00007200: 5d20 3d20 2720 286c 6f77 2063 6f75 6e74  ] = ' (low count
+00007210: 2c20 7573 6564 206d 696e 2927 0d0a 2020  , used min)'..  
+00007220: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00007230: 2320 4465 7465 726d 696e 6520 6c65 6674  # Determine left
+00007240: 2062 6f75 6e64 2061 6e64 2062 6f75 6e64   bound and bound
+00007250: 6172 7920 666f 7220 6561 6368 2067 726f  ary for each gro
+00007260: 7570 0d0a 2020 2020 2020 2020 0d0a 2020  up..        ..  
+00007270: 2020 2020 2020 2320 4368 616e 6765 206e        # Change n
+00007280: 6f74 6174 696f 6e20 6f66 2027 436c 6f73  otation of 'Clos
+00007290: 6564 2720 616e 6420 274f 7065 6e27 2062  ed' and 'Open' b
+000072a0: 6f75 6e64 6172 6965 7320 746f 2030 2061  oundaries to 0 a
+000072b0: 6e64 2031 2c0d 0a20 2020 2020 2020 2023  nd 1,..        #
+000072c0: 2072 6573 7065 6374 6976 656c 792e 2055   respectively. U
+000072d0: 7365 2030 2066 6f72 2063 6c6f 7365 6420  se 0 for closed 
+000072e0: 746f 2065 6e73 7572 6520 7468 6174 2063  to ensure that c
+000072f0: 6c6f 7365 6420 626f 756e 6461 7269 6573  losed boundaries
+00007300: 2061 7265 0d0a 2020 2020 2020 2020 2320   are..        # 
+00007310: 736f 7274 6564 206c 6573 7320 7468 616e  sorted less than
+00007320: 206f 7065 6e20 626f 756e 6461 7269 6573   open boundaries
+00007330: 2077 6865 6e20 7468 6520 6c65 6674 2062   when the left b
+00007340: 6f75 6e64 2069 7320 7469 6564 0d0a 2020  ound is tied..  
+00007350: 2020 2020 2020 6466 5b73 656c 662e 6c65        df[self.le
+00007360: 6674 5f62 6f75 6e64 6172 795f 636f 6c5d  ft_boundary_col]
+00007370: 203d 2028 0d0a 2020 2020 2020 2020 2020   = (..          
+00007380: 2020 6466 5b73 656c 662e 6c65 6674 5f62    df[self.left_b
+00007390: 6f75 6e64 6172 795f 636f 6c5d 0d0a 2020  oundary_col]..  
+000073a0: 2020 2020 2020 2020 2020 2020 2020 2e72                .r
+000073b0: 6570 6c61 6365 285b 2743 6c6f 7365 6427  eplace(['Closed'
+000073c0: 2c27 4f70 656e 275d 2c20 5b30 2c31 5d29  ,'Open'], [0,1])
+000073d0: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
+000073e0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+000073f0: 2020 2023 2053 6f72 7420 6c65 6674 2062     # Sort left b
+00007400: 6f75 6e64 2076 616c 7565 730d 0a20 2020  ound values..   
+00007410: 2020 2020 2067 726f 7570 696e 6720 3d20       grouping = 
+00007420: 5b27 5f5f 5369 7a65 5f5f 272c 2073 656c  ['__Size__', sel
+00007430: 662e 6c65 6674 5f62 6f75 6e64 6172 795f  f.left_boundary_
+00007440: 636f 6c2c 2073 656c 662e 6c65 6674 5f62  col, self.left_b
+00007450: 6f75 6e64 5f63 6f6c 5d0d 0a20 2020 2020  ound_col]..     
+00007460: 2020 2069 6620 6772 6f75 7062 795f 636f     if groupby_co
+00007470: 6c73 2021 3d20 4e6f 6e65 3a0d 0a20 2020  ls != None:..   
+00007480: 2020 2020 2020 2020 2067 726f 7570 696e           groupin
+00007490: 6720 3d20 6772 6f75 7062 795f 636f 6c73  g = groupby_cols
+000074a0: 202b 2067 726f 7570 696e 670d 0a20 2020   + grouping..   
+000074b0: 2020 2020 200d 0a20 2020 2020 2020 206c       ..        l
+000074c0: 6566 7420 3d20 280d 0a20 2020 2020 2020  eft = (..       
+000074d0: 2020 2020 2064 662e 636f 7079 2829 5b67       df.copy()[g
+000074e0: 726f 7570 696e 675d 0d0a 2020 2020 2020  rouping]..      
+000074f0: 2020 2020 2020 2020 2020 2e73 6f72 745f            .sort_
+00007500: 7661 6c75 6573 280d 0a20 2020 2020 2020  values(..       
+00007510: 2020 2020 2020 2020 2020 2020 2062 7920               by 
+00007520: 3d20 5b73 656c 662e 6c65 6674 5f62 6f75  = [self.left_bou
+00007530: 6e64 5f63 6f6c 2c20 7365 6c66 2e6c 6566  nd_col, self.lef
+00007540: 745f 626f 756e 6461 7279 5f63 6f6c 5d0d  t_boundary_col].
+00007550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007560: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00007570: 2020 2020 290d 0a20 2020 2020 2020 200d      )..        .
+00007580: 0a20 2020 2020 2020 2023 2041 6464 2069  .        # Add i
+00007590: 6e64 6578 2066 6f72 2065 6163 6820 6772  ndex for each gr
+000075a0: 6f75 700d 0a20 2020 2020 2020 2069 6620  oup..        if 
+000075b0: 6772 6f75 7062 795f 636f 6c73 203d 3d20  groupby_cols == 
+000075c0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+000075d0: 2020 206c 6566 745b 275f 5f49 6e64 6578     left['__Index
+000075e0: 5f5f 275d 203d 2072 616e 6765 2831 2c20  __'] = range(1, 
+000075f0: 312b 6c65 6e28 6c65 6674 2929 0d0a 2020  1+len(left))..  
+00007600: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00007610: 2020 2020 2020 2020 206c 6566 745b 275f           left['_
+00007620: 5f49 6e64 6578 5f5f 275d 203d 206c 6566  _Index__'] = lef
+00007630: 742e 6772 6f75 7062 7928 6772 6f75 7062  t.groupby(groupb
+00007640: 795f 636f 6c73 292e 6375 6d63 6f75 6e74  y_cols).cumcount
+00007650: 2829 202b 2031 0d0a 2020 2020 2020 2020  () + 1..        
+00007660: 0d0a 2020 2020 2020 2020 2320 4465 7465  ..        # Dete
+00007670: 726d 696e 6520 7468 6520 7261 6e6b 2069  rmine the rank i
+00007680: 6e20 6561 6368 2067 726f 7570 2066 6f72  n each group for
+00007690: 2074 6865 2070 6572 6365 6e74 696c 650d   the percentile.
+000076a0: 0a20 2020 2020 2020 2023 2055 7365 2072  .        # Use r
+000076b0: 6f75 6e64 696e 6720 6174 2038 2064 6563  ounding at 8 dec
+000076c0: 696d 616c 7320 746f 2070 7265 7665 6e74  imals to prevent
+000076d0: 2061 7274 6966 6963 6961 6c20 6465 6369   artificial deci
+000076e0: 6d61 6c73 0d0a 2020 2020 2020 2020 6c65  mals..        le
+000076f0: 6674 5b27 5f5f 5261 6e6b 5f5f 275d 203d  ft['__Rank__'] =
+00007700: 2072 6f75 6e64 280d 0a20 2020 2020 2020   round(..       
+00007710: 2020 2020 2043 202b 2070 6572 6365 6e74       C + percent
+00007720: 696c 652a 286c 6566 745b 275f 5f53 697a  ile*(left['__Siz
+00007730: 655f 5f27 5d20 2b20 3120 2d20 322a 4329  e__'] + 1 - 2*C)
+00007740: 2c0d 0a20 2020 2020 2020 2020 2020 2038  ,..            8
+00007750: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
+00007760: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00007770: 2020 2023 2048 616e 646c 6520 7369 7475     # Handle situ
+00007780: 6174 696f 6e73 2077 6865 7265 2072 616e  ations where ran
+00007790: 6b20 6973 206f 7574 7369 6465 2074 6865  k is outside the
+000077a0: 2072 616e 6765 2031 2074 6f20 6c65 6e67   range 1 to leng
+000077b0: 7468 206f 6620 6461 7461 0d0a 2020 2020  th of data..    
+000077c0: 2020 2020 636f 6e64 6974 696f 6e73 203d      conditions =
+000077d0: 205b 0d0a 2020 2020 2020 2020 2020 2020   [..            
+000077e0: 2320 5573 6520 6d61 7869 6d75 6d20 7261  # Use maximum ra
+000077f0: 6e6b 2069 6620 7261 6e6b 2069 7320 6c61  nk if rank is la
+00007800: 7267 6572 2074 6861 6e20 7468 6520 6c65  rger than the le
+00007810: 6e67 7468 206f 6620 7468 6520 6461 7461  ngth of the data
+00007820: 7365 740d 0a20 2020 2020 2020 2020 2020  set..           
+00007830: 2028 6c65 6674 5b27 5f5f 5261 6e6b 5f5f   (left['__Rank__
+00007840: 275d 203e 206c 6566 745b 275f 5f53 697a  '] > left['__Siz
+00007850: 655f 5f27 5d29 2c0d 0a20 2020 2020 2020  e__']),..       
+00007860: 2020 2020 2023 2055 7365 2072 616e 6b20       # Use rank 
+00007870: 6f66 2031 2069 6620 7261 6e6b 2069 7320  of 1 if rank is 
+00007880: 6c65 7373 2074 6861 6e20 310d 0a20 2020  less than 1..   
+00007890: 2020 2020 2020 2020 2028 6c65 6674 5b27           (left['
+000078a0: 5f5f 5261 6e6b 5f5f 275d 203c 2031 290d  __Rank__'] < 1).
+000078b0: 0a20 2020 2020 2020 2020 2020 205d 0d0a  .            ]..
+000078c0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000078d0: 2020 7265 7375 6c74 7320 3d20 5b0d 0a20    results = [.. 
+000078e0: 2020 2020 2020 2020 2020 206c 6566 745b             left[
+000078f0: 275f 5f53 697a 655f 5f27 5d2c 0d0a 2020  '__Size__'],..  
+00007900: 2020 2020 2020 2020 2020 310d 0a20 2020            1..   
+00007910: 2020 2020 2020 2020 205d 0d0a 2020 2020           ]..    
+00007920: 2020 2020 0d0a 2020 2020 2020 2020 6c65      ..        le
+00007930: 6674 5b27 5f5f 5261 6e6b 5f5f 275d 203d  ft['__Rank__'] =
+00007940: 206e 702e 7365 6c65 6374 2863 6f6e 6469   np.select(condi
+00007950: 7469 6f6e 732c 2072 6573 756c 7473 2c20  tions, results, 
+00007960: 6c65 6674 5b27 5f5f 5261 6e6b 5f5f 275d  left['__Rank__']
+00007970: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00007980: 2020 2020 2023 2047 656e 6572 6174 6520       # Generate 
+00007990: 7072 6f78 696d 6974 7920 6f66 2065 6163  proximity of eac
+000079a0: 6820 7265 7375 6c74 2074 6f20 7065 7263  h result to perc
+000079b0: 656e 7469 6c65 2072 616e 6b20 7573 696e  entile rank usin
+000079c0: 6720 7468 6520 696e 6465 780d 0a20 2020  g the index..   
+000079d0: 2020 2020 206c 6566 745b 275f 5f50 726f       left['__Pro
+000079e0: 7869 6d69 7479 5f5f 275d 203d 2030 0d0a  ximity__'] = 0..
+000079f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00007a00: 2020 636f 6e64 6974 696f 6e73 203d 205b    conditions = [
+00007a10: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00007a20: 4966 2074 6865 2070 6572 6365 6e74 696c  If the percentil
+00007a30: 6520 7261 6e6b 2069 7320 6120 7768 6f6c  e rank is a whol
+00007a40: 6520 6e75 6d62 6572 2c0d 0a20 2020 2020  e number,..     
+00007a50: 2020 2020 2020 2023 2074 6865 6e20 7573         # then us
+00007a60: 6520 7468 6174 2069 6e64 6578 2072 6573  e that index res
+00007a70: 756c 740d 0a20 2020 2020 2020 2020 2020  ult..           
+00007a80: 2028 6c65 6674 5b27 5f5f 5261 6e6b 5f5f   (left['__Rank__
+00007a90: 275d 203d 3d20 6c65 6674 5b27 5f5f 496e  '] == left['__In
+00007aa0: 6465 785f 5f27 5d29 2c0d 0a20 2020 2020  dex__']),..     
+00007ab0: 2020 2020 2020 2023 2049 6620 7468 6520         # If the 
+00007ac0: 7065 7263 656e 7469 6c65 2072 616e 6b20  percentile rank 
+00007ad0: 6973 206c 6573 7320 7468 616e 2031 2061  is less than 1 a
+00007ae0: 626f 7665 2074 6865 2069 6e64 6578 2076  bove the index v
+00007af0: 616c 7565 2c0d 0a20 2020 2020 2020 2020  alue,..         
+00007b00: 2020 2023 2074 6865 6e20 6173 7369 676e     # then assign
+00007b10: 2074 6865 2061 7070 726f 7072 6961 7465   the appropriate
+00007b20: 2063 6f6e 7472 6962 7574 696f 6e20 746f   contribution to
+00007b30: 2074 6861 7420 696e 6465 7820 7661 6c75   that index valu
+00007b40: 650d 0a20 2020 2020 2020 2020 2020 2028  e..            (
+00007b50: 286c 6566 745b 275f 5f52 616e 6b5f 5f27  (left['__Rank__'
+00007b60: 5d20 2d20 6c65 6674 5b27 5f5f 496e 6465  ] - left['__Inde
+00007b70: 785f 5f27 5d29 0d0a 2020 2020 2020 2020  x__'])..        
+00007b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007ba0: 202e 6265 7477 6565 6e28 302c 312c 696e   .between(0,1,in
+00007bb0: 636c 7573 6976 653d 276e 6569 7468 6572  clusive='neither
+00007bc0: 2729 292c 0d0a 2020 2020 2020 2020 2020  ')),..          
+00007bd0: 2020 2320 4966 2074 6865 2070 6572 6365    # If the perce
+00007be0: 6e74 696c 6520 7261 6e6b 2069 7320 6c65  ntile rank is le
+00007bf0: 7373 2074 6861 6e20 3120 6265 6c6f 7720  ss than 1 below 
+00007c00: 7468 6520 696e 6465 7820 7661 6c75 652c  the index value,
+00007c10: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00007c20: 7468 656e 2061 7373 6967 6e20 7468 6520  then assign the 
+00007c30: 6170 7072 6f70 7269 6174 6520 636f 6e74  appropriate cont
+00007c40: 7269 6275 7469 6f6e 2074 6f20 7468 6174  ribution to that
+00007c50: 2069 6e64 6578 2076 616c 7565 0d0a 2020   index value..  
+00007c60: 2020 2020 2020 2020 2020 2828 6c65 6674            ((left
+00007c70: 5b27 5f5f 496e 6465 785f 5f27 5d20 2d20  ['__Index__'] - 
+00007c80: 6c65 6674 5b27 5f5f 5261 6e6b 5f5f 275d  left['__Rank__']
+00007c90: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00007ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007cb0: 2020 2020 2020 2020 2020 2020 2e62 6574              .bet
+00007cc0: 7765 656e 2830 2c31 2c69 6e63 6c75 7369  ween(0,1,inclusi
+00007cd0: 7665 3d27 6e65 6974 6865 7227 2929 0d0a  ve='neither'))..
+00007ce0: 2020 2020 2020 2020 2020 2020 5d0d 0a20              ].. 
+00007cf0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00007d00: 2072 6573 756c 7473 203d 205b 0d0a 2020   results = [..  
+00007d10: 2020 2020 2020 2020 2020 312c 0d0a 2020            1,..  
+00007d20: 2020 2020 2020 2020 2020 3120 2d20 286c            1 - (l
+00007d30: 6566 745b 275f 5f52 616e 6b5f 5f27 5d20  eft['__Rank__'] 
+00007d40: 2d20 6c65 6674 5b27 5f5f 496e 6465 785f  - left['__Index_
+00007d50: 5f27 5d29 2c0d 0a20 2020 2020 2020 2020  _']),..         
+00007d60: 2020 2031 202d 2028 6c65 6674 5b27 5f5f     1 - (left['__
+00007d70: 496e 6465 785f 5f27 5d20 2d20 6c65 6674  Index__'] - left
+00007d80: 5b27 5f5f 5261 6e6b 5f5f 275d 292c 0d0a  ['__Rank__']),..
+00007d90: 2020 2020 2020 2020 2020 2020 5d0d 0a20              ].. 
+00007da0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00007db0: 206c 6566 745b 275f 5f50 726f 7869 6d69   left['__Proximi
+00007dc0: 7479 5f5f 275d 203d 206e 702e 7365 6c65  ty__'] = np.sele
+00007dd0: 6374 2863 6f6e 6469 7469 6f6e 732c 2072  ct(conditions, r
+00007de0: 6573 756c 7473 2c20 6e70 2e6e 616e 290d  esults, np.nan).
+00007df0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00007e00: 2020 2023 2044 726f 7020 6e6f 6e2d 636f     # Drop non-co
+00007e10: 6e74 7269 6275 7469 6e67 2072 6f77 730d  ntributing rows.
+00007e20: 0a20 2020 2020 2020 206c 6566 7420 3d20  .        left = 
+00007e30: 6c65 6674 5b6c 6566 745b 275f 5f50 726f  left[left['__Pro
+00007e40: 7869 6d69 7479 5f5f 275d 203e 2030 5d0d  ximity__'] > 0].
+00007e50: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00007e60: 2020 2023 2043 616c 6375 6c61 7465 2063     # Calculate c
+00007e70: 6f6e 7472 6962 7574 696f 6e20 666f 7220  ontribution for 
+00007e80: 696e 6465 7820 7661 6c75 6573 2074 6861  index values tha
+00007e90: 7420 636f 6e74 7269 6275 7465 2074 6f20  t contribute to 
+00007ea0: 7468 6520 7265 7375 6c74 0d0a 2020 2020  the result..    
+00007eb0: 2020 2020 6c65 6674 5b27 5f5f 436f 6e74      left['__Cont
+00007ec0: 7269 6275 7469 6f6e 5f5f 275d 203d 2028  ribution__'] = (
+00007ed0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007ee0: 2020 6c65 6674 5b27 5f5f 5072 6f78 696d    left['__Proxim
+00007ef0: 6974 795f 5f27 5d20 2a20 6c65 6674 5b73  ity__'] * left[s
+00007f00: 656c 662e 6c65 6674 5f62 6f75 6e64 5f63  elf.left_bound_c
+00007f10: 6f6c 5d0d 0a20 2020 2020 2020 2020 2020  ol]..           
+00007f20: 2029 0d0a 2020 2020 2020 2020 0d0a 2020   )..        ..  
+00007f30: 2020 2020 2020 2320 4966 2067 726f 7570        # If group
+00007f40: 6279 5f63 6f6c 732c 2074 6865 6e20 6772  by_cols, then gr
+00007f50: 6f75 7020 6461 7461 0d0a 2020 2020 2020  oup data..      
+00007f60: 2020 6966 2067 726f 7570 6279 5f63 6f6c    if groupby_col
+00007f70: 7320 3d3d 204e 6f6e 653a 0d0a 2020 2020  s == None:..    
+00007f80: 2020 2020 2020 2020 6c65 6674 203d 2070          left = p
+00007f90: 642e 4461 7461 4672 616d 6528 0d0a 2020  d.DataFrame(..  
+00007fa0: 2020 2020 2020 2020 2020 2020 2020 5b5b                [[
+00007fb0: 6d61 7828 6c65 6674 5b73 656c 662e 6c65  max(left[self.le
+00007fc0: 6674 5f62 6f75 6e64 6172 795f 636f 6c5d  ft_boundary_col]
+00007fd0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+00007fe0: 2020 2020 2020 7375 6d28 6c65 6674 5b27        sum(left['
+00007ff0: 5f5f 436f 6e74 7269 6275 7469 6f6e 5f5f  __Contribution__
+00008000: 275d 292c 0d0a 2020 2020 2020 2020 2020  ']),..          
+00008010: 2020 2020 2020 2020 6d69 6e28 6c65 6674          min(left
+00008020: 5b27 5f5f 436f 6e74 7269 6275 7469 6f6e  ['__Contribution
+00008030: 5f5f 275d 295d 5d2c 0d0a 2020 2020 2020  __'])]],..      
+00008040: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+00008050: 733d 5b0d 0a20 2020 2020 2020 2020 2020  s=[..           
+00008060: 2020 2020 2020 2020 2073 656c 662e 6c65           self.le
+00008070: 6674 5f62 6f75 6e64 6172 795f 636f 6c2c  ft_boundary_col,
+00008080: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008090: 2020 2020 2020 7365 6c66 2e6c 6566 745f        self.left_
+000080a0: 626f 756e 645f 636f 6c2c 0d0a 2020 2020  bound_col,..    
+000080b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000080c0: 275f 5f4d 696e 696d 756d 5f5f 270d 0a20  '__Minimum__'.. 
+000080d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000080e0: 2020 205d 0d0a 2020 2020 2020 2020 2020     ]..          
+000080f0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+00008100: 2023 2044 6574 6572 6d69 6e65 206c 6566   # Determine lef
+00008110: 7420 626f 756e 6420 616e 6420 626f 756e  t bound and boun
+00008120: 6461 7279 2075 7369 6e67 2074 6865 2073  dary using the s
+00008130: 756d 206f 6620 7468 6520 636f 6e74 7269  um of the contri
+00008140: 6275 7469 6f6e 730d 0a20 2020 2020 2020  butions..       
+00008150: 2023 2061 6e64 2061 6e20 6f70 656e 2062   # and an open b
+00008160: 6f75 6e64 6172 7920 6966 2061 6e79 206f  oundary if any o
+00008170: 6620 7468 6520 636f 6e74 7269 6275 7469  f the contributi
+00008180: 6e67 2076 616c 7565 7320 6973 206f 7065  ng values is ope
+00008190: 6e0d 0a20 2020 2020 2020 2065 6c73 653a  n..        else:
+000081a0: 0d0a 2020 2020 2020 2020 2020 2020 6c65  ..            le
+000081b0: 6674 203d 2028 0d0a 2020 2020 2020 2020  ft = (..        
+000081c0: 2020 2020 2020 2020 6c65 6674 2e67 726f          left.gro
+000081d0: 7570 6279 2867 726f 7570 6279 5f63 6f6c  upby(groupby_col
+000081e0: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+000081f0: 2020 2020 2020 2020 2e61 6767 282a 2a7b          .agg(**{
 00008200: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008210: 2020 2020 2020 2e61 6767 282a 2a7b 0d0a        .agg(**{..
-00008220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008230: 2020 2020 2020 2020 7365 6c66 2e6c 6566          self.lef
-00008240: 745f 626f 756e 6461 7279 5f63 6f6c 3a20  t_boundary_col: 
-00008250: 2873 656c 662e 6c65 6674 5f62 6f75 6e64  (self.left_bound
-00008260: 6172 795f 636f 6c2c 0d0a 2020 2020 2020  ary_col,..      
-00008270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008290: 2020 2020 2020 2020 2020 2027 6d61 7827             'max'
-000082a0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-000082b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000082c0: 2e6c 6566 745f 626f 756e 645f 636f 6c3a  .left_bound_col:
-000082d0: 2028 275f 5f43 6f6e 7472 6962 7574 696f   ('__Contributio
-000082e0: 6e5f 5f27 2c20 2773 756d 2729 2c0d 0a20  n__', 'sum'),.. 
-000082f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008300: 2020 2020 2020 2027 5f5f 4d69 6e69 6d75         '__Minimu
-00008310: 6d5f 5f27 3a20 2827 5f5f 436f 6e74 7269  m__': ('__Contri
-00008320: 6275 7469 6f6e 5f5f 272c 2027 6d69 6e27  bution__', 'min'
-00008330: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00008340: 2020 2020 2020 2020 2020 207d 290d 0a20             }).. 
-00008350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008360: 2020 2029 0d0a 2020 2020 2020 2020 0d0a     )..        ..
-00008370: 2020 2020 2020 2020 2320 5265 706c 6163          # Replac
-00008380: 6520 7468 6520 6e75 6d65 7269 6320 7661  e the numeric va
-00008390: 6c75 6520 666f 7220 7468 6520 626f 756e  lue for the boun
-000083a0: 6461 7279 0d0a 2020 2020 2020 2020 6c65  dary..        le
-000083b0: 6674 5b73 656c 662e 6c65 6674 5f62 6f75  ft[self.left_bou
-000083c0: 6e64 6172 795f 636f 6c5d 203d 2028 0d0a  ndary_col] = (..
-000083d0: 2020 2020 2020 2020 2020 2020 6c65 6674              left
-000083e0: 5b73 656c 662e 6c65 6674 5f62 6f75 6e64  [self.left_bound
-000083f0: 6172 795f 636f 6c5d 0d0a 2020 2020 2020  ary_col]..      
-00008400: 2020 2020 2020 2020 2020 2e72 6570 6c61            .repla
-00008410: 6365 285b 302c 315d 2c20 5b27 436c 6f73  ce([0,1], ['Clos
-00008420: 6564 272c 274f 7065 6e27 5d29 0d0a 2020  ed','Open'])..  
-00008430: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-00008440: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
-00008450: 2053 756d 7320 7769 7468 2069 6e66 696e   Sums with infin
-00008460: 6974 6520 7661 6c75 6573 2070 726f 6475  ite values produ
-00008470: 6365 206e 616e 2076 616c 7565 7320 7261  ce nan values ra
-00008480: 7468 6572 2074 6861 6e20 0d0a 2020 2020  ther than ..    
-00008490: 2020 2020 2320 6e70 2e69 6e66 2076 616c      # np.inf val
-000084a0: 7565 732e 2043 6f6e 7665 7274 206e 616e  ues. Convert nan
-000084b0: 2074 6f20 696e 6620 6f6e 6c79 2069 6620   to inf only if 
-000084c0: 696e 6669 6e69 7465 2076 616c 7565 7320  infinite values 
-000084d0: 6172 650d 0a20 2020 2020 2020 2023 2069  are..        # i
-000084e0: 6e63 6c75 6465 6420 696e 2074 6865 2073  ncluded in the s
-000084f0: 756d 0d0a 2020 2020 2020 2020 6c65 6674  um..        left
-00008500: 5b73 656c 662e 6c65 6674 5f62 6f75 6e64  [self.left_bound
-00008510: 5f63 6f6c 5d20 3d20 280d 0a20 2020 2020  _col] = (..     
-00008520: 2020 2020 2020 206e 702e 7768 6572 6528         np.where(
-00008530: 6c65 6674 5b27 5f5f 4d69 6e69 6d75 6d5f  left['__Minimum_
-00008540: 5f27 5d20 3d3d 202d 6e70 2e69 6e66 2c0d  _'] == -np.inf,.
-00008550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008560: 2020 2020 2020 2d6e 702e 696e 662c 0d0a        -np.inf,..
-00008570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008580: 2020 2020 206c 6566 745b 7365 6c66 2e6c       left[self.l
-00008590: 6566 745f 626f 756e 645f 636f 6c5d 0d0a  eft_bound_col]..
-000085a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000085b0: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
-000085c0: 2020 2020 290d 0a20 2020 2020 2020 200d      )..        .
-000085d0: 0a20 2020 2020 2020 2023 2044 6574 6572  .        # Deter
-000085e0: 6d69 6e65 2072 6967 6874 2062 6f75 6e64  mine right bound
-000085f0: 2061 6e64 2062 6f75 6e64 6172 7920 666f   and boundary fo
-00008600: 7220 6561 6368 2067 726f 7570 0d0a 2020  r each group..  
-00008610: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00008620: 2320 4368 616e 6765 206e 6f74 6174 696f  # Change notatio
-00008630: 6e20 6f66 2027 436c 6f73 6564 2720 616e  n of 'Closed' an
-00008640: 6420 274f 7065 6e27 2062 6f75 6e64 6172  d 'Open' boundar
-00008650: 6965 7320 746f 2031 2061 6e64 2030 2c0d  ies to 1 and 0,.
-00008660: 0a20 2020 2020 2020 2023 2072 6573 7065  .        # respe
-00008670: 6374 6976 656c 792e 2055 7365 2031 2066  ctively. Use 1 f
-00008680: 6f72 2063 6c6f 7365 6420 746f 2065 6e73  or closed to ens
-00008690: 7572 6520 7468 6174 2063 6c6f 7365 6420  ure that closed 
-000086a0: 626f 756e 6461 7269 6573 2061 7265 0d0a  boundaries are..
-000086b0: 2020 2020 2020 2020 2320 736f 7274 6564          # sorted
-000086c0: 206c 6172 6765 7220 7468 616e 206f 7065   larger than ope
-000086d0: 6e20 626f 756e 6461 7269 6573 2077 6865  n boundaries whe
-000086e0: 6e20 7468 6520 7269 6768 7420 626f 756e  n the right boun
-000086f0: 6420 6973 2074 6965 640d 0a20 2020 2020  d is tied..     
-00008700: 2020 2064 665b 7365 6c66 2e72 6967 6874     df[self.right
-00008710: 5f62 6f75 6e64 6172 795f 636f 6c5d 203d  _boundary_col] =
-00008720: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-00008730: 6466 5b73 656c 662e 7269 6768 745f 626f  df[self.right_bo
-00008740: 756e 6461 7279 5f63 6f6c 5d0d 0a20 2020  undary_col]..   
-00008750: 2020 2020 2020 2020 2020 2020 202e 7265               .re
-00008760: 706c 6163 6528 5b27 436c 6f73 6564 272c  place(['Closed',
-00008770: 274f 7065 6e27 5d2c 205b 312c 305d 290d  'Open'], [1,0]).
-00008780: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
-00008790: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000087a0: 2020 2320 536f 7274 2072 6967 6874 2062    # Sort right b
-000087b0: 6f75 6e64 2076 616c 7565 730d 0a20 2020  ound values..   
-000087c0: 2020 2020 2067 726f 7570 696e 6720 3d20       grouping = 
-000087d0: 5b27 5f5f 5369 7a65 5f5f 272c 2073 656c  ['__Size__', sel
-000087e0: 662e 7269 6768 745f 626f 756e 6461 7279  f.right_boundary
-000087f0: 5f63 6f6c 2c20 7365 6c66 2e72 6967 6874  _col, self.right
-00008800: 5f62 6f75 6e64 5f63 6f6c 5d0d 0a20 2020  _bound_col]..   
-00008810: 2020 2020 2069 6620 6772 6f75 7062 795f       if groupby_
-00008820: 636f 6c73 2021 3d20 4e6f 6e65 3a0d 0a20  cols != None:.. 
-00008830: 2020 2020 2020 2020 2020 2067 726f 7570             group
-00008840: 696e 6720 3d20 6772 6f75 7062 795f 636f  ing = groupby_co
-00008850: 6c73 202b 2067 726f 7570 696e 670d 0a20  ls + grouping.. 
-00008860: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00008870: 2072 6967 6874 203d 2028 0d0a 2020 2020   right = (..    
-00008880: 2020 2020 2020 2020 6466 2e63 6f70 7928          df.copy(
-00008890: 295b 6772 6f75 7069 6e67 5d0d 0a20 2020  )[grouping]..   
-000088a0: 2020 2020 2020 2020 2020 2020 202e 736f               .so
-000088b0: 7274 5f76 616c 7565 7328 0d0a 2020 2020  rt_values(..    
-000088c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000088d0: 6279 203d 205b 7365 6c66 2e72 6967 6874  by = [self.right
-000088e0: 5f62 6f75 6e64 5f63 6f6c 2c20 7365 6c66  _bound_col, self
-000088f0: 2e72 6967 6874 5f62 6f75 6e64 6172 795f  .right_boundary_
-00008900: 636f 6c5d 0d0a 2020 2020 2020 2020 2020  col]..          
-00008910: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-00008920: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-00008930: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
-00008940: 4164 6420 696e 6465 7820 666f 7220 6561  Add index for ea
-00008950: 6368 2067 726f 7570 0d0a 2020 2020 2020  ch group..      
-00008960: 2020 6966 2067 726f 7570 6279 5f63 6f6c    if groupby_col
-00008970: 7320 3d3d 204e 6f6e 653a 0d0a 2020 2020  s == None:..    
-00008980: 2020 2020 2020 2020 7269 6768 745b 275f          right['_
-00008990: 5f49 6e64 6578 5f5f 275d 203d 2072 616e  _Index__'] = ran
-000089a0: 6765 2831 2c20 312b 6c65 6e28 7269 6768  ge(1, 1+len(righ
-000089b0: 7429 290d 0a20 2020 2020 2020 2065 6c73  t))..        els
-000089c0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-000089d0: 7269 6768 745b 275f 5f49 6e64 6578 5f5f  right['__Index__
-000089e0: 275d 203d 2072 6967 6874 2e67 726f 7570  '] = right.group
-000089f0: 6279 2867 726f 7570 6279 5f63 6f6c 7329  by(groupby_cols)
-00008a00: 2e63 756d 636f 756e 7428 2920 2b20 310d  .cumcount() + 1.
-00008a10: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00008a20: 2020 2023 2044 6574 6572 6d69 6e65 2074     # Determine t
-00008a30: 6865 2072 616e 6b20 696e 2065 6163 6820  he rank in each 
-00008a40: 6772 6f75 7020 666f 7220 7468 6520 7065  group for the pe
-00008a50: 7263 656e 7469 6c65 0d0a 2020 2020 2020  rcentile..      
-00008a60: 2020 7269 6768 745b 275f 5f52 616e 6b5f    right['__Rank_
-00008a70: 5f27 5d20 3d20 726f 756e 6428 0d0a 2020  _'] = round(..  
-00008a80: 2020 2020 2020 2020 2020 4320 2b20 7065            C + pe
-00008a90: 7263 656e 7469 6c65 2a28 7269 6768 745b  rcentile*(right[
-00008aa0: 275f 5f53 697a 655f 5f27 5d20 2b20 3120  '__Size__'] + 1 
-00008ab0: 2d20 322a 4329 2c0d 0a20 2020 2020 2020  - 2*C),..       
-00008ac0: 2020 2020 2038 0d0a 2020 2020 2020 2020       8..        
-00008ad0: 2020 2020 290d 0a20 2020 2020 2020 200d      )..        .
-00008ae0: 0a20 2020 2020 2020 2023 2048 616e 646c  .        # Handl
-00008af0: 6520 7369 7475 6174 696f 6e73 2077 6865  e situations whe
-00008b00: 7265 2072 616e 6b20 6973 206f 7574 7369  re rank is outsi
-00008b10: 6465 2074 6865 2072 616e 6765 2031 2074  de the range 1 t
-00008b20: 6f20 6c65 6e67 7468 206f 6620 6461 7461  o length of data
-00008b30: 0d0a 2020 2020 2020 2020 636f 6e64 6974  ..        condit
-00008b40: 696f 6e73 203d 205b 0d0a 2020 2020 2020  ions = [..      
-00008b50: 2020 2020 2020 2320 5573 6520 6d61 7869        # Use maxi
-00008b60: 6d75 6d20 7261 6e6b 2069 6620 7261 6e6b  mum rank if rank
-00008b70: 2069 7320 6c61 7267 6572 2074 6861 6e20   is larger than 
-00008b80: 7468 6520 6c65 6e67 7468 206f 6620 7468  the length of th
-00008b90: 6520 6461 7461 7365 740d 0a20 2020 2020  e dataset..     
-00008ba0: 2020 2020 2020 2028 7269 6768 745b 275f         (right['_
-00008bb0: 5f52 616e 6b5f 5f27 5d20 3e20 7269 6768  _Rank__'] > righ
-00008bc0: 745b 275f 5f53 697a 655f 5f27 5d29 2c0d  t['__Size__']),.
-00008bd0: 0a20 2020 2020 2020 2020 2020 2023 2055  .            # U
-00008be0: 7365 2072 616e 6b20 6f66 2031 2069 6620  se rank of 1 if 
-00008bf0: 7261 6e6b 2069 7320 6c65 7373 2074 6861  rank is less tha
-00008c00: 6e20 310d 0a20 2020 2020 2020 2020 2020  n 1..           
-00008c10: 2028 7269 6768 745b 275f 5f52 616e 6b5f   (right['__Rank_
-00008c20: 5f27 5d20 3c20 3129 0d0a 2020 2020 2020  _'] < 1)..      
-00008c30: 2020 2020 2020 5d0d 0a20 2020 2020 2020        ]..       
-00008c40: 200d 0a20 2020 2020 2020 2072 6573 756c   ..        resul
-00008c50: 7473 203d 205b 0d0a 2020 2020 2020 2020  ts = [..        
-00008c60: 2020 2020 7269 6768 745b 275f 5f53 697a      right['__Siz
-00008c70: 655f 5f27 5d2c 0d0a 2020 2020 2020 2020  e__'],..        
-00008c80: 2020 2020 310d 0a20 2020 2020 2020 2020      1..         
-00008c90: 2020 205d 0d0a 2020 2020 2020 2020 0d0a     ]..        ..
-00008ca0: 2020 2020 2020 2020 7269 6768 745b 275f          right['_
-00008cb0: 5f52 616e 6b5f 5f27 5d20 3d20 6e70 2e73  _Rank__'] = np.s
-00008cc0: 656c 6563 7428 636f 6e64 6974 696f 6e73  elect(conditions
-00008cd0: 2c20 7265 7375 6c74 732c 2072 6967 6874  , results, right
-00008ce0: 5b27 5f5f 5261 6e6b 5f5f 275d 290d 0a20  ['__Rank__']).. 
-00008cf0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00008d00: 2023 2047 656e 6572 6174 6520 7072 6f78   # Generate prox
-00008d10: 696d 6974 7920 6f66 2065 6163 6820 7265  imity of each re
-00008d20: 7375 6c74 2074 6f20 7065 7263 656e 7469  sult to percenti
-00008d30: 6c65 2072 616e 6b20 7573 696e 6720 7468  le rank using th
-00008d40: 6520 696e 6465 780d 0a20 2020 2020 2020  e index..       
-00008d50: 2072 6967 6874 5b27 5f5f 5072 6f78 696d   right['__Proxim
-00008d60: 6974 795f 5f27 5d20 3d20 300d 0a20 2020  ity__'] = 0..   
-00008d70: 2020 2020 200d 0a20 2020 2020 2020 2063       ..        c
-00008d80: 6f6e 6469 7469 6f6e 7320 3d20 5b0d 0a20  onditions = [.. 
-00008d90: 2020 2020 2020 2020 2020 2023 2049 6620             # If 
-00008da0: 7468 6520 7065 7263 656e 7469 6c65 2072  the percentile r
-00008db0: 616e 6b20 6973 2061 2077 686f 6c65 206e  ank is a whole n
-00008dc0: 756d 6265 722c 0d0a 2020 2020 2020 2020  umber,..        
-00008dd0: 2020 2020 2320 7468 656e 2075 7365 2074      # then use t
-00008de0: 6861 7420 696e 6465 7820 7265 7375 6c74  hat index result
-00008df0: 0d0a 2020 2020 2020 2020 2020 2020 2872  ..            (r
-00008e00: 6967 6874 5b27 5f5f 5261 6e6b 5f5f 275d  ight['__Rank__']
-00008e10: 203d 3d20 7269 6768 745b 275f 5f49 6e64   == right['__Ind
-00008e20: 6578 5f5f 275d 292c 0d0a 2020 2020 2020  ex__']),..      
-00008e30: 2020 2020 2020 2320 4966 2074 6865 2070        # If the p
-00008e40: 6572 6365 6e74 696c 6520 7261 6e6b 2069  ercentile rank i
-00008e50: 7320 6c65 7373 2074 6861 6e20 3120 6162  s less than 1 ab
-00008e60: 6f76 6520 7468 6520 696e 6465 7820 7661  ove the index va
-00008e70: 6c75 652c 0d0a 2020 2020 2020 2020 2020  lue,..          
-00008e80: 2020 2320 7468 656e 2061 7373 6967 6e20    # then assign 
-00008e90: 7468 6520 6170 7072 6f70 7269 6174 6520  the appropriate 
-00008ea0: 636f 6e74 7269 6275 7469 6f6e 2074 6f20  contribution to 
-00008eb0: 7468 6174 2069 6e64 6578 2076 616c 7565  that index value
-00008ec0: 0d0a 2020 2020 2020 2020 2020 2020 2828  ..            ((
-00008ed0: 7269 6768 745b 275f 5f52 616e 6b5f 5f27  right['__Rank__'
-00008ee0: 5d20 2d20 7269 6768 745b 275f 5f49 6e64  ] - right['__Ind
-00008ef0: 6578 5f5f 275d 290d 0a20 2020 2020 2020  ex__'])..       
-00008f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008f20: 2020 2e62 6574 7765 656e 2830 2c31 2c69    .between(0,1,i
-00008f30: 6e63 6c75 7369 7665 3d27 6e65 6974 6865  nclusive='neithe
-00008f40: 7227 2929 2c0d 0a20 2020 2020 2020 2020  r')),..         
-00008f50: 2020 2023 2049 6620 7468 6520 7065 7263     # If the perc
-00008f60: 656e 7469 6c65 2072 616e 6b20 6973 206c  entile rank is l
-00008f70: 6573 7320 7468 616e 2031 2062 656c 6f77  ess than 1 below
-00008f80: 2074 6865 2069 6e64 6578 2076 616c 7565   the index value
-00008f90: 2c0d 0a20 2020 2020 2020 2020 2020 2023  ,..            #
-00008fa0: 2074 6865 6e20 6173 7369 676e 2074 6865   then assign the
-00008fb0: 2061 7070 726f 7072 6961 7465 2063 6f6e   appropriate con
-00008fc0: 7472 6962 7574 696f 6e20 746f 2074 6861  tribution to tha
-00008fd0: 7420 696e 6465 7820 7661 6c75 650d 0a20  t index value.. 
-00008fe0: 2020 2020 2020 2020 2020 2028 2872 6967             ((rig
-00008ff0: 6874 5b27 5f5f 496e 6465 785f 5f27 5d20  ht['__Index__'] 
-00009000: 2d20 7269 6768 745b 275f 5f52 616e 6b5f  - right['__Rank_
-00009010: 5f27 5d29 0d0a 2020 2020 2020 2020 2020  _'])..          
-00009020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009030: 2020 2020 2020 2020 2020 2020 2020 202e                 .
-00009040: 6265 7477 6565 6e28 302c 312c 696e 636c  between(0,1,incl
-00009050: 7573 6976 653d 276e 6569 7468 6572 2729  usive='neither')
-00009060: 290d 0a20 2020 2020 2020 2020 2020 205d  )..            ]
-00009070: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00009080: 2020 2020 7265 7375 6c74 7320 3d20 5b0d      results = [.
-00009090: 0a20 2020 2020 2020 2020 2020 2031 2c0d  .            1,.
-000090a0: 0a20 2020 2020 2020 2020 2020 2031 202d  .            1 -
-000090b0: 2028 7269 6768 745b 275f 5f52 616e 6b5f   (right['__Rank_
-000090c0: 5f27 5d20 2d20 7269 6768 745b 275f 5f49  _'] - right['__I
-000090d0: 6e64 6578 5f5f 275d 292c 0d0a 2020 2020  ndex__']),..    
-000090e0: 2020 2020 2020 2020 3120 2d20 2872 6967          1 - (rig
-000090f0: 6874 5b27 5f5f 496e 6465 785f 5f27 5d20  ht['__Index__'] 
-00009100: 2d20 7269 6768 745b 275f 5f52 616e 6b5f  - right['__Rank_
-00009110: 5f27 5d29 2c0d 0a20 2020 2020 2020 2020  _']),..         
-00009120: 2020 205d 0d0a 2020 2020 2020 2020 0d0a     ]..        ..
-00009130: 2020 2020 2020 2020 7269 6768 745b 275f          right['_
-00009140: 5f50 726f 7869 6d69 7479 5f5f 275d 203d  _Proximity__'] =
-00009150: 206e 702e 7365 6c65 6374 2863 6f6e 6469   np.select(condi
-00009160: 7469 6f6e 732c 2072 6573 756c 7473 2c20  tions, results, 
-00009170: 6e70 2e6e 616e 290d 0a20 2020 2020 2020  np.nan)..       
-00009180: 200d 0a20 2020 2020 2020 2023 2044 726f   ..        # Dro
-00009190: 7020 6e6f 6e2d 636f 6e74 7269 6275 7469  p non-contributi
-000091a0: 6e67 2072 6f77 730d 0a20 2020 2020 2020  ng rows..       
-000091b0: 2072 6967 6874 203d 2072 6967 6874 5b72   right = right[r
-000091c0: 6967 6874 5b27 5f5f 5072 6f78 696d 6974  ight['__Proximit
-000091d0: 795f 5f27 5d20 3e20 305d 0d0a 2020 2020  y__'] > 0]..    
-000091e0: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
-000091f0: 4361 6c63 756c 6174 6520 636f 6e74 7269  Calculate contri
-00009200: 6275 7469 6f6e 2066 6f72 2069 6e64 6578  bution for index
-00009210: 2076 616c 7565 7320 7468 6174 2063 6f6e   values that con
-00009220: 7472 6962 7574 6520 746f 2074 6865 2072  tribute to the r
-00009230: 6573 756c 740d 0a20 2020 2020 2020 2072  esult..        r
-00009240: 6967 6874 5b27 5f5f 436f 6e74 7269 6275  ight['__Contribu
-00009250: 7469 6f6e 5f5f 275d 203d 2028 0d0a 2020  tion__'] = (..  
-00009260: 2020 2020 2020 2020 2020 7269 6768 745b            right[
-00009270: 275f 5f50 726f 7869 6d69 7479 5f5f 275d  '__Proximity__']
-00009280: 202a 2072 6967 6874 5b73 656c 662e 7269   * right[self.ri
-00009290: 6768 745f 626f 756e 645f 636f 6c5d 0d0a  ght_bound_col]..
-000092a0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-000092b0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000092c0: 2023 2049 6620 6772 6f75 7062 795f 636f   # If groupby_co
-000092d0: 6c73 2c20 7468 656e 2067 726f 7570 2064  ls, then group d
-000092e0: 6174 610d 0a20 2020 2020 2020 2069 6620  ata..        if 
-000092f0: 6772 6f75 7062 795f 636f 6c73 203d 3d20  groupby_cols == 
-00009300: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-00009310: 2020 2072 6967 6874 203d 2070 642e 4461     right = pd.Da
-00009320: 7461 4672 616d 6528 0d0a 2020 2020 2020  taFrame(..      
-00009330: 2020 2020 2020 2020 2020 5b5b 7375 6d28            [[sum(
-00009340: 7269 6768 745b 275f 5f43 6f6e 7472 6962  right['__Contrib
-00009350: 7574 696f 6e5f 5f27 5d29 2c0d 0a20 2020  ution__']),..   
-00009360: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00009370: 696e 2872 6967 6874 5b73 656c 662e 7269  in(right[self.ri
-00009380: 6768 745f 626f 756e 6461 7279 5f63 6f6c  ght_boundary_col
-00009390: 5d29 2c0d 0a20 2020 2020 2020 2020 2020  ]),..           
-000093a0: 2020 2020 2020 206d 6178 2872 6967 6874         max(right
-000093b0: 5b27 5f5f 436f 6e74 7269 6275 7469 6f6e  ['__Contribution
-000093c0: 5f5f 275d 295d 5d2c 0d0a 2020 2020 2020  __'])]],..      
-000093d0: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-000093e0: 733d 5b0d 0a20 2020 2020 2020 2020 2020  s=[..           
-000093f0: 2020 2020 2020 2020 2073 656c 662e 7269           self.ri
-00009400: 6768 745f 626f 756e 645f 636f 6c2c 0d0a  ght_bound_col,..
-00009410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009420: 2020 2020 7365 6c66 2e72 6967 6874 5f62      self.right_b
-00009430: 6f75 6e64 6172 795f 636f 6c2c 0d0a 2020  oundary_col,..  
-00009440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009450: 2020 275f 5f4d 6178 696d 756d 5f5f 270d    '__Maximum__'.
-00009460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009470: 2020 2020 205d 0d0a 2020 2020 2020 2020       ]..        
-00009480: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-00009490: 2020 2023 2044 6574 6572 6d69 6e65 206c     # Determine l
-000094a0: 6566 7420 626f 756e 6420 616e 6420 626f  eft bound and bo
-000094b0: 756e 6461 7279 2075 7369 6e67 2074 6865  undary using the
-000094c0: 2073 756d 206f 6620 7468 6520 636f 6e74   sum of the cont
-000094d0: 7269 6275 7469 6f6e 730d 0a20 2020 2020  ributions..     
-000094e0: 2020 2023 2061 6e64 2061 6e20 6f70 656e     # and an open
-000094f0: 2062 6f75 6e64 6172 7920 6966 2061 6e79   boundary if any
-00009500: 206f 6620 7468 6520 636f 6e74 7269 6275   of the contribu
-00009510: 7469 6e67 2076 616c 7565 7320 6973 206f  ting values is o
-00009520: 7065 6e0d 0a20 2020 2020 2020 2065 6c73  pen..        els
-00009530: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00009540: 7269 6768 7420 3d20 280d 0a20 2020 2020  right = (..     
-00009550: 2020 2020 2020 2020 2020 2072 6967 6874             right
-00009560: 2e67 726f 7570 6279 2867 726f 7570 6279  .groupby(groupby
-00009570: 5f63 6f6c 7329 0d0a 2020 2020 2020 2020  _cols)..        
-00009580: 2020 2020 2020 2020 2020 2020 2e61 6767              .agg
-00009590: 282a 2a7b 0d0a 2020 2020 2020 2020 2020  (**{..          
-000095a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000095b0: 6c66 2e72 6967 6874 5f62 6f75 6e64 5f63  lf.right_bound_c
-000095c0: 6f6c 3a20 2827 5f5f 436f 6e74 7269 6275  ol: ('__Contribu
-000095d0: 7469 6f6e 5f5f 272c 2027 7375 6d27 292c  tion__', 'sum'),
-000095e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000095f0: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
-00009600: 6967 6874 5f62 6f75 6e64 6172 795f 636f  ight_boundary_co
-00009610: 6c3a 2028 7365 6c66 2e72 6967 6874 5f62  l: (self.right_b
-00009620: 6f75 6e64 6172 795f 636f 6c2c 0d0a 2020  oundary_col,..  
+00008210: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00008220: 6566 745f 626f 756e 6461 7279 5f63 6f6c  eft_boundary_col
+00008230: 3a20 2873 656c 662e 6c65 6674 5f62 6f75  : (self.left_bou
+00008240: 6e64 6172 795f 636f 6c2c 0d0a 2020 2020  ndary_col,..    
+00008250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008270: 2020 2020 2020 2020 2020 2020 2027 6d61               'ma
+00008280: 7827 292c 0d0a 2020 2020 2020 2020 2020  x'),..          
+00008290: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000082a0: 6c66 2e6c 6566 745f 626f 756e 645f 636f  lf.left_bound_co
+000082b0: 6c3a 2028 275f 5f43 6f6e 7472 6962 7574  l: ('__Contribut
+000082c0: 696f 6e5f 5f27 2c20 2773 756d 2729 2c0d  ion__', 'sum'),.
+000082d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000082e0: 2020 2020 2020 2020 2027 5f5f 4d69 6e69           '__Mini
+000082f0: 6d75 6d5f 5f27 3a20 2827 5f5f 436f 6e74  mum__': ('__Cont
+00008300: 7269 6275 7469 6f6e 5f5f 272c 2027 6d69  ribution__', 'mi
+00008310: 6e27 290d 0a20 2020 2020 2020 2020 2020  n')..           
+00008320: 2020 2020 2020 2020 2020 2020 207d 290d               }).
+00008330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008340: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00008350: 0d0a 2020 2020 2020 2020 2320 5265 706c  ..        # Repl
+00008360: 6163 6520 7468 6520 6e75 6d65 7269 6320  ace the numeric 
+00008370: 7661 6c75 6520 666f 7220 7468 6520 626f  value for the bo
+00008380: 756e 6461 7279 0d0a 2020 2020 2020 2020  undary..        
+00008390: 6c65 6674 5b73 656c 662e 6c65 6674 5f62  left[self.left_b
+000083a0: 6f75 6e64 6172 795f 636f 6c5d 203d 2028  oundary_col] = (
+000083b0: 0d0a 2020 2020 2020 2020 2020 2020 6c65  ..            le
+000083c0: 6674 5b73 656c 662e 6c65 6674 5f62 6f75  ft[self.left_bou
+000083d0: 6e64 6172 795f 636f 6c5d 0d0a 2020 2020  ndary_col]..    
+000083e0: 2020 2020 2020 2020 2020 2020 2e72 6570              .rep
+000083f0: 6c61 6365 285b 302c 315d 2c20 5b27 436c  lace([0,1], ['Cl
+00008400: 6f73 6564 272c 274f 7065 6e27 5d29 0d0a  osed','Open'])..
+00008410: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00008420: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00008430: 2023 2053 756d 7320 7769 7468 2069 6e66   # Sums with inf
+00008440: 696e 6974 6520 7661 6c75 6573 2070 726f  inite values pro
+00008450: 6475 6365 206e 616e 2076 616c 7565 7320  duce nan values 
+00008460: 7261 7468 6572 2074 6861 6e20 0d0a 2020  rather than ..  
+00008470: 2020 2020 2020 2320 6e70 2e69 6e66 2076        # np.inf v
+00008480: 616c 7565 732e 2043 6f6e 7665 7274 206e  alues. Convert n
+00008490: 616e 2074 6f20 696e 6620 6f6e 6c79 2069  an to inf only i
+000084a0: 6620 696e 6669 6e69 7465 2076 616c 7565  f infinite value
+000084b0: 7320 6172 650d 0a20 2020 2020 2020 2023  s are..        #
+000084c0: 2069 6e63 6c75 6465 6420 696e 2074 6865   included in the
+000084d0: 2073 756d 0d0a 2020 2020 2020 2020 6c65   sum..        le
+000084e0: 6674 5b73 656c 662e 6c65 6674 5f62 6f75  ft[self.left_bou
+000084f0: 6e64 5f63 6f6c 5d20 3d20 280d 0a20 2020  nd_col] = (..   
+00008500: 2020 2020 2020 2020 206e 702e 7768 6572           np.wher
+00008510: 6528 6c65 6674 5b27 5f5f 4d69 6e69 6d75  e(left['__Minimu
+00008520: 6d5f 5f27 5d20 3d3d 202d 6e70 2e69 6e66  m__'] == -np.inf
+00008530: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00008540: 2020 2020 2020 2020 2d6e 702e 696e 662c          -np.inf,
+00008550: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008560: 2020 2020 2020 206c 6566 745b 7365 6c66         left[self
+00008570: 2e6c 6566 745f 626f 756e 645f 636f 6c5d  .left_bound_col]
+00008580: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008590: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+000085a0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+000085b0: 200d 0a20 2020 2020 2020 2023 2044 6574   ..        # Det
+000085c0: 6572 6d69 6e65 2072 6967 6874 2062 6f75  ermine right bou
+000085d0: 6e64 2061 6e64 2062 6f75 6e64 6172 7920  nd and boundary 
+000085e0: 666f 7220 6561 6368 2067 726f 7570 0d0a  for each group..
+000085f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00008600: 2020 2320 4368 616e 6765 206e 6f74 6174    # Change notat
+00008610: 696f 6e20 6f66 2027 436c 6f73 6564 2720  ion of 'Closed' 
+00008620: 616e 6420 274f 7065 6e27 2062 6f75 6e64  and 'Open' bound
+00008630: 6172 6965 7320 746f 2031 2061 6e64 2030  aries to 1 and 0
+00008640: 2c0d 0a20 2020 2020 2020 2023 2072 6573  ,..        # res
+00008650: 7065 6374 6976 656c 792e 2055 7365 2031  pectively. Use 1
+00008660: 2066 6f72 2063 6c6f 7365 6420 746f 2065   for closed to e
+00008670: 6e73 7572 6520 7468 6174 2063 6c6f 7365  nsure that close
+00008680: 6420 626f 756e 6461 7269 6573 2061 7265  d boundaries are
+00008690: 0d0a 2020 2020 2020 2020 2320 736f 7274  ..        # sort
+000086a0: 6564 206c 6172 6765 7220 7468 616e 206f  ed larger than o
+000086b0: 7065 6e20 626f 756e 6461 7269 6573 2077  pen boundaries w
+000086c0: 6865 6e20 7468 6520 7269 6768 7420 626f  hen the right bo
+000086d0: 756e 6420 6973 2074 6965 640d 0a20 2020  und is tied..   
+000086e0: 2020 2020 2064 665b 7365 6c66 2e72 6967       df[self.rig
+000086f0: 6874 5f62 6f75 6e64 6172 795f 636f 6c5d  ht_boundary_col]
+00008700: 203d 2028 0d0a 2020 2020 2020 2020 2020   = (..          
+00008710: 2020 6466 5b73 656c 662e 7269 6768 745f    df[self.right_
+00008720: 626f 756e 6461 7279 5f63 6f6c 5d0d 0a20  boundary_col].. 
+00008730: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+00008740: 7265 706c 6163 6528 5b27 436c 6f73 6564  replace(['Closed
+00008750: 272c 274f 7065 6e27 5d2c 205b 312c 305d  ','Open'], [1,0]
+00008760: 290d 0a20 2020 2020 2020 2020 2020 2029  )..            )
+00008770: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00008780: 2020 2020 2320 536f 7274 2072 6967 6874      # Sort right
+00008790: 2062 6f75 6e64 2076 616c 7565 730d 0a20   bound values.. 
+000087a0: 2020 2020 2020 2067 726f 7570 696e 6720         grouping 
+000087b0: 3d20 5b27 5f5f 5369 7a65 5f5f 272c 2073  = ['__Size__', s
+000087c0: 656c 662e 7269 6768 745f 626f 756e 6461  elf.right_bounda
+000087d0: 7279 5f63 6f6c 2c20 7365 6c66 2e72 6967  ry_col, self.rig
+000087e0: 6874 5f62 6f75 6e64 5f63 6f6c 5d0d 0a20  ht_bound_col].. 
+000087f0: 2020 2020 2020 2069 6620 6772 6f75 7062         if groupb
+00008800: 795f 636f 6c73 2021 3d20 4e6f 6e65 3a0d  y_cols != None:.
+00008810: 0a20 2020 2020 2020 2020 2020 2067 726f  .            gro
+00008820: 7570 696e 6720 3d20 6772 6f75 7062 795f  uping = groupby_
+00008830: 636f 6c73 202b 2067 726f 7570 696e 670d  cols + grouping.
+00008840: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00008850: 2020 2072 6967 6874 203d 2028 0d0a 2020     right = (..  
+00008860: 2020 2020 2020 2020 2020 6466 2e63 6f70            df.cop
+00008870: 7928 295b 6772 6f75 7069 6e67 5d0d 0a20  y()[grouping].. 
+00008880: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+00008890: 736f 7274 5f76 616c 7565 7328 0d0a 2020  sort_values(..  
+000088a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000088b0: 2020 6279 203d 205b 7365 6c66 2e72 6967    by = [self.rig
+000088c0: 6874 5f62 6f75 6e64 5f63 6f6c 2c20 7365  ht_bound_col, se
+000088d0: 6c66 2e72 6967 6874 5f62 6f75 6e64 6172  lf.right_boundar
+000088e0: 795f 636f 6c5d 0d0a 2020 2020 2020 2020  y_col]..        
+000088f0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00008900: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00008910: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00008920: 2320 4164 6420 696e 6465 7820 666f 7220  # Add index for 
+00008930: 6561 6368 2067 726f 7570 0d0a 2020 2020  each group..    
+00008940: 2020 2020 6966 2067 726f 7570 6279 5f63      if groupby_c
+00008950: 6f6c 7320 3d3d 204e 6f6e 653a 0d0a 2020  ols == None:..  
+00008960: 2020 2020 2020 2020 2020 7269 6768 745b            right[
+00008970: 275f 5f49 6e64 6578 5f5f 275d 203d 2072  '__Index__'] = r
+00008980: 616e 6765 2831 2c20 312b 6c65 6e28 7269  ange(1, 1+len(ri
+00008990: 6768 7429 290d 0a20 2020 2020 2020 2065  ght))..        e
+000089a0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+000089b0: 2020 7269 6768 745b 275f 5f49 6e64 6578    right['__Index
+000089c0: 5f5f 275d 203d 2072 6967 6874 2e67 726f  __'] = right.gro
+000089d0: 7570 6279 2867 726f 7570 6279 5f63 6f6c  upby(groupby_col
+000089e0: 7329 2e63 756d 636f 756e 7428 2920 2b20  s).cumcount() + 
+000089f0: 310d 0a20 2020 2020 2020 200d 0a20 2020  1..        ..   
+00008a00: 2020 2020 2023 2044 6574 6572 6d69 6e65       # Determine
+00008a10: 2074 6865 2072 616e 6b20 696e 2065 6163   the rank in eac
+00008a20: 6820 6772 6f75 7020 666f 7220 7468 6520  h group for the 
+00008a30: 7065 7263 656e 7469 6c65 0d0a 2020 2020  percentile..    
+00008a40: 2020 2020 7269 6768 745b 275f 5f52 616e      right['__Ran
+00008a50: 6b5f 5f27 5d20 3d20 726f 756e 6428 0d0a  k__'] = round(..
+00008a60: 2020 2020 2020 2020 2020 2020 4320 2b20              C + 
+00008a70: 7065 7263 656e 7469 6c65 2a28 7269 6768  percentile*(righ
+00008a80: 745b 275f 5f53 697a 655f 5f27 5d20 2b20  t['__Size__'] + 
+00008a90: 3120 2d20 322a 4329 2c0d 0a20 2020 2020  1 - 2*C),..     
+00008aa0: 2020 2020 2020 2038 0d0a 2020 2020 2020         8..      
+00008ab0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+00008ac0: 200d 0a20 2020 2020 2020 2023 2048 616e   ..        # Han
+00008ad0: 646c 6520 7369 7475 6174 696f 6e73 2077  dle situations w
+00008ae0: 6865 7265 2072 616e 6b20 6973 206f 7574  here rank is out
+00008af0: 7369 6465 2074 6865 2072 616e 6765 2031  side the range 1
+00008b00: 2074 6f20 6c65 6e67 7468 206f 6620 6461   to length of da
+00008b10: 7461 0d0a 2020 2020 2020 2020 636f 6e64  ta..        cond
+00008b20: 6974 696f 6e73 203d 205b 0d0a 2020 2020  itions = [..    
+00008b30: 2020 2020 2020 2020 2320 5573 6520 6d61          # Use ma
+00008b40: 7869 6d75 6d20 7261 6e6b 2069 6620 7261  ximum rank if ra
+00008b50: 6e6b 2069 7320 6c61 7267 6572 2074 6861  nk is larger tha
+00008b60: 6e20 7468 6520 6c65 6e67 7468 206f 6620  n the length of 
+00008b70: 7468 6520 6461 7461 7365 740d 0a20 2020  the dataset..   
+00008b80: 2020 2020 2020 2020 2028 7269 6768 745b           (right[
+00008b90: 275f 5f52 616e 6b5f 5f27 5d20 3e20 7269  '__Rank__'] > ri
+00008ba0: 6768 745b 275f 5f53 697a 655f 5f27 5d29  ght['__Size__'])
+00008bb0: 2c0d 0a20 2020 2020 2020 2020 2020 2023  ,..            #
+00008bc0: 2055 7365 2072 616e 6b20 6f66 2031 2069   Use rank of 1 i
+00008bd0: 6620 7261 6e6b 2069 7320 6c65 7373 2074  f rank is less t
+00008be0: 6861 6e20 310d 0a20 2020 2020 2020 2020  han 1..         
+00008bf0: 2020 2028 7269 6768 745b 275f 5f52 616e     (right['__Ran
+00008c00: 6b5f 5f27 5d20 3c20 3129 0d0a 2020 2020  k__'] < 1)..    
+00008c10: 2020 2020 2020 2020 5d0d 0a20 2020 2020          ]..     
+00008c20: 2020 200d 0a20 2020 2020 2020 2072 6573     ..        res
+00008c30: 756c 7473 203d 205b 0d0a 2020 2020 2020  ults = [..      
+00008c40: 2020 2020 2020 7269 6768 745b 275f 5f53        right['__S
+00008c50: 697a 655f 5f27 5d2c 0d0a 2020 2020 2020  ize__'],..      
+00008c60: 2020 2020 2020 310d 0a20 2020 2020 2020        1..       
+00008c70: 2020 2020 205d 0d0a 2020 2020 2020 2020       ]..        
+00008c80: 0d0a 2020 2020 2020 2020 7269 6768 745b  ..        right[
+00008c90: 275f 5f52 616e 6b5f 5f27 5d20 3d20 6e70  '__Rank__'] = np
+00008ca0: 2e73 656c 6563 7428 636f 6e64 6974 696f  .select(conditio
+00008cb0: 6e73 2c20 7265 7375 6c74 732c 2072 6967  ns, results, rig
+00008cc0: 6874 5b27 5f5f 5261 6e6b 5f5f 275d 290d  ht['__Rank__']).
+00008cd0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00008ce0: 2020 2023 2047 656e 6572 6174 6520 7072     # Generate pr
+00008cf0: 6f78 696d 6974 7920 6f66 2065 6163 6820  oximity of each 
+00008d00: 7265 7375 6c74 2074 6f20 7065 7263 656e  result to percen
+00008d10: 7469 6c65 2072 616e 6b20 7573 696e 6720  tile rank using 
+00008d20: 7468 6520 696e 6465 780d 0a20 2020 2020  the index..     
+00008d30: 2020 2072 6967 6874 5b27 5f5f 5072 6f78     right['__Prox
+00008d40: 696d 6974 795f 5f27 5d20 3d20 300d 0a20  imity__'] = 0.. 
+00008d50: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00008d60: 2063 6f6e 6469 7469 6f6e 7320 3d20 5b0d   conditions = [.
+00008d70: 0a20 2020 2020 2020 2020 2020 2023 2049  .            # I
+00008d80: 6620 7468 6520 7065 7263 656e 7469 6c65  f the percentile
+00008d90: 2072 616e 6b20 6973 2061 2077 686f 6c65   rank is a whole
+00008da0: 206e 756d 6265 722c 0d0a 2020 2020 2020   number,..      
+00008db0: 2020 2020 2020 2320 7468 656e 2075 7365        # then use
+00008dc0: 2074 6861 7420 696e 6465 7820 7265 7375   that index resu
+00008dd0: 6c74 0d0a 2020 2020 2020 2020 2020 2020  lt..            
+00008de0: 2872 6967 6874 5b27 5f5f 5261 6e6b 5f5f  (right['__Rank__
+00008df0: 275d 203d 3d20 7269 6768 745b 275f 5f49  '] == right['__I
+00008e00: 6e64 6578 5f5f 275d 292c 0d0a 2020 2020  ndex__']),..    
+00008e10: 2020 2020 2020 2020 2320 4966 2074 6865          # If the
+00008e20: 2070 6572 6365 6e74 696c 6520 7261 6e6b   percentile rank
+00008e30: 2069 7320 6c65 7373 2074 6861 6e20 3120   is less than 1 
+00008e40: 6162 6f76 6520 7468 6520 696e 6465 7820  above the index 
+00008e50: 7661 6c75 652c 0d0a 2020 2020 2020 2020  value,..        
+00008e60: 2020 2020 2320 7468 656e 2061 7373 6967      # then assig
+00008e70: 6e20 7468 6520 6170 7072 6f70 7269 6174  n the appropriat
+00008e80: 6520 636f 6e74 7269 6275 7469 6f6e 2074  e contribution t
+00008e90: 6f20 7468 6174 2069 6e64 6578 2076 616c  o that index val
+00008ea0: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
+00008eb0: 2828 7269 6768 745b 275f 5f52 616e 6b5f  ((right['__Rank_
+00008ec0: 5f27 5d20 2d20 7269 6768 745b 275f 5f49  _'] - right['__I
+00008ed0: 6e64 6578 5f5f 275d 290d 0a20 2020 2020  ndex__'])..     
+00008ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008f00: 2020 2020 2e62 6574 7765 656e 2830 2c31      .between(0,1
+00008f10: 2c69 6e63 6c75 7369 7665 3d27 6e65 6974  ,inclusive='neit
+00008f20: 6865 7227 2929 2c0d 0a20 2020 2020 2020  her')),..       
+00008f30: 2020 2020 2023 2049 6620 7468 6520 7065       # If the pe
+00008f40: 7263 656e 7469 6c65 2072 616e 6b20 6973  rcentile rank is
+00008f50: 206c 6573 7320 7468 616e 2031 2062 656c   less than 1 bel
+00008f60: 6f77 2074 6865 2069 6e64 6578 2076 616c  ow the index val
+00008f70: 7565 2c0d 0a20 2020 2020 2020 2020 2020  ue,..           
+00008f80: 2023 2074 6865 6e20 6173 7369 676e 2074   # then assign t
+00008f90: 6865 2061 7070 726f 7072 6961 7465 2063  he appropriate c
+00008fa0: 6f6e 7472 6962 7574 696f 6e20 746f 2074  ontribution to t
+00008fb0: 6861 7420 696e 6465 7820 7661 6c75 650d  hat index value.
+00008fc0: 0a20 2020 2020 2020 2020 2020 2028 2872  .            ((r
+00008fd0: 6967 6874 5b27 5f5f 496e 6465 785f 5f27  ight['__Index__'
+00008fe0: 5d20 2d20 7269 6768 745b 275f 5f52 616e  ] - right['__Ran
+00008ff0: 6b5f 5f27 5d29 0d0a 2020 2020 2020 2020  k__'])..        
+00009000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009020: 202e 6265 7477 6565 6e28 302c 312c 696e   .between(0,1,in
+00009030: 636c 7573 6976 653d 276e 6569 7468 6572  clusive='neither
+00009040: 2729 290d 0a20 2020 2020 2020 2020 2020  '))..           
+00009050: 205d 0d0a 2020 2020 2020 2020 0d0a 2020   ]..        ..  
+00009060: 2020 2020 2020 7265 7375 6c74 7320 3d20        results = 
+00009070: 5b0d 0a20 2020 2020 2020 2020 2020 2031  [..            1
+00009080: 2c0d 0a20 2020 2020 2020 2020 2020 2031  ,..            1
+00009090: 202d 2028 7269 6768 745b 275f 5f52 616e   - (right['__Ran
+000090a0: 6b5f 5f27 5d20 2d20 7269 6768 745b 275f  k__'] - right['_
+000090b0: 5f49 6e64 6578 5f5f 275d 292c 0d0a 2020  _Index__']),..  
+000090c0: 2020 2020 2020 2020 2020 3120 2d20 2872            1 - (r
+000090d0: 6967 6874 5b27 5f5f 496e 6465 785f 5f27  ight['__Index__'
+000090e0: 5d20 2d20 7269 6768 745b 275f 5f52 616e  ] - right['__Ran
+000090f0: 6b5f 5f27 5d29 2c0d 0a20 2020 2020 2020  k__']),..       
+00009100: 2020 2020 205d 0d0a 2020 2020 2020 2020       ]..        
+00009110: 0d0a 2020 2020 2020 2020 7269 6768 745b  ..        right[
+00009120: 275f 5f50 726f 7869 6d69 7479 5f5f 275d  '__Proximity__']
+00009130: 203d 206e 702e 7365 6c65 6374 2863 6f6e   = np.select(con
+00009140: 6469 7469 6f6e 732c 2072 6573 756c 7473  ditions, results
+00009150: 2c20 6e70 2e6e 616e 290d 0a20 2020 2020  , np.nan)..     
+00009160: 2020 200d 0a20 2020 2020 2020 2023 2044     ..        # D
+00009170: 726f 7020 6e6f 6e2d 636f 6e74 7269 6275  rop non-contribu
+00009180: 7469 6e67 2072 6f77 730d 0a20 2020 2020  ting rows..     
+00009190: 2020 2072 6967 6874 203d 2072 6967 6874     right = right
+000091a0: 5b72 6967 6874 5b27 5f5f 5072 6f78 696d  [right['__Proxim
+000091b0: 6974 795f 5f27 5d20 3e20 305d 0d0a 2020  ity__'] > 0]..  
+000091c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000091d0: 2320 4361 6c63 756c 6174 6520 636f 6e74  # Calculate cont
+000091e0: 7269 6275 7469 6f6e 2066 6f72 2069 6e64  ribution for ind
+000091f0: 6578 2076 616c 7565 7320 7468 6174 2063  ex values that c
+00009200: 6f6e 7472 6962 7574 6520 746f 2074 6865  ontribute to the
+00009210: 2072 6573 756c 740d 0a20 2020 2020 2020   result..       
+00009220: 2072 6967 6874 5b27 5f5f 436f 6e74 7269   right['__Contri
+00009230: 6275 7469 6f6e 5f5f 275d 203d 2028 0d0a  bution__'] = (..
+00009240: 2020 2020 2020 2020 2020 2020 7269 6768              righ
+00009250: 745b 275f 5f50 726f 7869 6d69 7479 5f5f  t['__Proximity__
+00009260: 275d 202a 2072 6967 6874 5b73 656c 662e  '] * right[self.
+00009270: 7269 6768 745f 626f 756e 645f 636f 6c5d  right_bound_col]
+00009280: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
+00009290: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+000092a0: 2020 2023 2049 6620 6772 6f75 7062 795f     # If groupby_
+000092b0: 636f 6c73 2c20 7468 656e 2067 726f 7570  cols, then group
+000092c0: 2064 6174 610d 0a20 2020 2020 2020 2069   data..        i
+000092d0: 6620 6772 6f75 7062 795f 636f 6c73 203d  f groupby_cols =
+000092e0: 3d20 4e6f 6e65 3a0d 0a20 2020 2020 2020  = None:..       
+000092f0: 2020 2020 2072 6967 6874 203d 2070 642e       right = pd.
+00009300: 4461 7461 4672 616d 6528 0d0a 2020 2020  DataFrame(..    
+00009310: 2020 2020 2020 2020 2020 2020 5b5b 7375              [[su
+00009320: 6d28 7269 6768 745b 275f 5f43 6f6e 7472  m(right['__Contr
+00009330: 6962 7574 696f 6e5f 5f27 5d29 2c0d 0a20  ibution__']),.. 
+00009340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009350: 206d 696e 2872 6967 6874 5b73 656c 662e   min(right[self.
+00009360: 7269 6768 745f 626f 756e 6461 7279 5f63  right_boundary_c
+00009370: 6f6c 5d29 2c0d 0a20 2020 2020 2020 2020  ol]),..         
+00009380: 2020 2020 2020 2020 206d 6178 2872 6967           max(rig
+00009390: 6874 5b27 5f5f 436f 6e74 7269 6275 7469  ht['__Contributi
+000093a0: 6f6e 5f5f 275d 295d 5d2c 0d0a 2020 2020  on__'])]],..    
+000093b0: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+000093c0: 6d6e 733d 5b0d 0a20 2020 2020 2020 2020  mns=[..         
+000093d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000093e0: 7269 6768 745f 626f 756e 645f 636f 6c2c  right_bound_col,
+000093f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009400: 2020 2020 2020 7365 6c66 2e72 6967 6874        self.right
+00009410: 5f62 6f75 6e64 6172 795f 636f 6c2c 0d0a  _boundary_col,..
+00009420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009430: 2020 2020 275f 5f4d 6178 696d 756d 5f5f      '__Maximum__
+00009440: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
+00009450: 2020 2020 2020 205d 0d0a 2020 2020 2020         ]..      
+00009460: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+00009470: 2020 2020 2023 2044 6574 6572 6d69 6e65       # Determine
+00009480: 206c 6566 7420 626f 756e 6420 616e 6420   left bound and 
+00009490: 626f 756e 6461 7279 2075 7369 6e67 2074  boundary using t
+000094a0: 6865 2073 756d 206f 6620 7468 6520 636f  he sum of the co
+000094b0: 6e74 7269 6275 7469 6f6e 730d 0a20 2020  ntributions..   
+000094c0: 2020 2020 2023 2061 6e64 2061 6e20 6f70       # and an op
+000094d0: 656e 2062 6f75 6e64 6172 7920 6966 2061  en boundary if a
+000094e0: 6e79 206f 6620 7468 6520 636f 6e74 7269  ny of the contri
+000094f0: 6275 7469 6e67 2076 616c 7565 7320 6973  buting values is
+00009500: 206f 7065 6e0d 0a20 2020 2020 2020 2065   open..        e
+00009510: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00009520: 2020 7269 6768 7420 3d20 280d 0a20 2020    right = (..   
+00009530: 2020 2020 2020 2020 2020 2020 2072 6967               rig
+00009540: 6874 2e67 726f 7570 6279 2867 726f 7570  ht.groupby(group
+00009550: 6279 5f63 6f6c 7329 0d0a 2020 2020 2020  by_cols)..      
+00009560: 2020 2020 2020 2020 2020 2020 2020 2e61                .a
+00009570: 6767 282a 2a7b 0d0a 2020 2020 2020 2020  gg(**{..        
+00009580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009590: 7365 6c66 2e72 6967 6874 5f62 6f75 6e64  self.right_bound
+000095a0: 5f63 6f6c 3a20 2827 5f5f 436f 6e74 7269  _col: ('__Contri
+000095b0: 6275 7469 6f6e 5f5f 272c 2027 7375 6d27  bution__', 'sum'
+000095c0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+000095d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000095e0: 2e72 6967 6874 5f62 6f75 6e64 6172 795f  .right_boundary_
+000095f0: 636f 6c3a 2028 7365 6c66 2e72 6967 6874  col: (self.right
+00009600: 5f62 6f75 6e64 6172 795f 636f 6c2c 0d0a  _boundary_col,..
+00009610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009620: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00009630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009640: 2020 276d 696e 2729 2c0d 0a20 2020 2020    'min'),..     
 00009650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009660: 276d 696e 2729 2c0d 0a20 2020 2020 2020  'min'),..       
-00009670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009680: 2027 5f5f 4d61 7869 6d75 6d5f 5f27 3a20   '__Maximum__': 
-00009690: 2827 5f5f 436f 6e74 7269 6275 7469 6f6e  ('__Contribution
-000096a0: 5f5f 272c 2027 6d61 7827 290d 0a20 2020  __', 'max')..   
-000096b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000096c0: 2020 2020 207d 290d 0a20 2020 2020 2020       })..       
-000096d0: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
-000096e0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000096f0: 2020 2320 5265 706c 6163 6520 7468 6520    # Replace the 
-00009700: 6e75 6d65 7269 6320 7661 6c75 6520 666f  numeric value fo
-00009710: 7220 7468 6520 626f 756e 6461 7279 0d0a  r the boundary..
-00009720: 2020 2020 2020 2020 7269 6768 745b 7365          right[se
-00009730: 6c66 2e72 6967 6874 5f62 6f75 6e64 6172  lf.right_boundar
-00009740: 795f 636f 6c5d 203d 2028 0d0a 2020 2020  y_col] = (..    
-00009750: 2020 2020 2020 2020 7269 6768 745b 7365          right[se
-00009760: 6c66 2e72 6967 6874 5f62 6f75 6e64 6172  lf.right_boundar
-00009770: 795f 636f 6c5d 0d0a 2020 2020 2020 2020  y_col]..        
-00009780: 2020 2020 2020 2020 2e72 6570 6c61 6365          .replace
-00009790: 285b 312c 305d 2c20 5b27 436c 6f73 6564  ([1,0], ['Closed
-000097a0: 272c 274f 7065 6e27 5d29 0d0a 2020 2020  ','Open'])..    
-000097b0: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-000097c0: 2020 200d 0a20 2020 2020 2020 2023 2053     ..        # S
-000097d0: 756d 7320 7769 7468 2069 6e66 696e 6974  ums with infinit
-000097e0: 6520 7661 6c75 6573 2070 726f 6475 6365  e values produce
-000097f0: 206e 616e 2076 616c 7565 7320 7261 7468   nan values rath
-00009800: 6572 2074 6861 6e0d 0a20 2020 2020 2020  er than..       
-00009810: 2023 206e 702e 696e 6620 7661 6c75 6573   # np.inf values
-00009820: 2e20 436f 6e76 6572 7420 6e61 6e20 746f  . Convert nan to
-00009830: 2069 6e66 206f 6e6c 7920 6966 2069 6e66   inf only if inf
-00009840: 696e 6974 6520 7661 6c75 6573 2061 7265  inite values are
-00009850: 0d0a 2020 2020 2020 2020 2320 696e 636c  ..        # incl
-00009860: 7564 6564 2069 6e20 7468 6520 7375 6d0d  uded in the sum.
-00009870: 0a20 2020 2020 2020 2072 6967 6874 5b73  .        right[s
-00009880: 656c 662e 7269 6768 745f 626f 756e 645f  elf.right_bound_
-00009890: 636f 6c5d 203d 2028 0d0a 2020 2020 2020  col] = (..      
-000098a0: 2020 2020 2020 6e70 2e77 6865 7265 2872        np.where(r
-000098b0: 6967 6874 5b27 5f5f 4d61 7869 6d75 6d5f  ight['__Maximum_
-000098c0: 5f27 5d20 3d3d 206e 702e 696e 662c 0d0a  _'] == np.inf,..
+00009660: 2020 2027 5f5f 4d61 7869 6d75 6d5f 5f27     '__Maximum__'
+00009670: 3a20 2827 5f5f 436f 6e74 7269 6275 7469  : ('__Contributi
+00009680: 6f6e 5f5f 272c 2027 6d61 7827 290d 0a20  on__', 'max').. 
+00009690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000096a0: 2020 2020 2020 207d 290d 0a20 2020 2020         })..     
+000096b0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000096c0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000096d0: 2020 2020 2320 5265 706c 6163 6520 7468      # Replace th
+000096e0: 6520 6e75 6d65 7269 6320 7661 6c75 6520  e numeric value 
+000096f0: 666f 7220 7468 6520 626f 756e 6461 7279  for the boundary
+00009700: 0d0a 2020 2020 2020 2020 7269 6768 745b  ..        right[
+00009710: 7365 6c66 2e72 6967 6874 5f62 6f75 6e64  self.right_bound
+00009720: 6172 795f 636f 6c5d 203d 2028 0d0a 2020  ary_col] = (..  
+00009730: 2020 2020 2020 2020 2020 7269 6768 745b            right[
+00009740: 7365 6c66 2e72 6967 6874 5f62 6f75 6e64  self.right_bound
+00009750: 6172 795f 636f 6c5d 0d0a 2020 2020 2020  ary_col]..      
+00009760: 2020 2020 2020 2020 2020 2e72 6570 6c61            .repla
+00009770: 6365 285b 312c 305d 2c20 5b27 436c 6f73  ce([1,0], ['Clos
+00009780: 6564 272c 274f 7065 6e27 5d29 0d0a 2020  ed','Open'])..  
+00009790: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+000097a0: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+000097b0: 2053 756d 7320 7769 7468 2069 6e66 696e   Sums with infin
+000097c0: 6974 6520 7661 6c75 6573 2070 726f 6475  ite values produ
+000097d0: 6365 206e 616e 2076 616c 7565 7320 7261  ce nan values ra
+000097e0: 7468 6572 2074 6861 6e0d 0a20 2020 2020  ther than..     
+000097f0: 2020 2023 206e 702e 696e 6620 7661 6c75     # np.inf valu
+00009800: 6573 2e20 436f 6e76 6572 7420 6e61 6e20  es. Convert nan 
+00009810: 746f 2069 6e66 206f 6e6c 7920 6966 2069  to inf only if i
+00009820: 6e66 696e 6974 6520 7661 6c75 6573 2061  nfinite values a
+00009830: 7265 0d0a 2020 2020 2020 2020 2320 696e  re..        # in
+00009840: 636c 7564 6564 2069 6e20 7468 6520 7375  cluded in the su
+00009850: 6d0d 0a20 2020 2020 2020 2072 6967 6874  m..        right
+00009860: 5b73 656c 662e 7269 6768 745f 626f 756e  [self.right_boun
+00009870: 645f 636f 6c5d 203d 2028 0d0a 2020 2020  d_col] = (..    
+00009880: 2020 2020 2020 2020 6e70 2e77 6865 7265          np.where
+00009890: 2872 6967 6874 5b27 5f5f 4d61 7869 6d75  (right['__Maximu
+000098a0: 6d5f 5f27 5d20 3d3d 206e 702e 696e 662c  m__'] == np.inf,
+000098b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000098c0: 2020 2020 2020 206e 702e 696e 662c 0d0a         np.inf,..
 000098d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000098e0: 2020 2020 206e 702e 696e 662c 0d0a 2020       np.inf,..  
-000098f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009900: 2020 2072 6967 6874 5b73 656c 662e 7269     right[self.ri
-00009910: 6768 745f 626f 756e 645f 636f 6c5d 0d0a  ght_bound_col]..
-00009920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009930: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
-00009940: 2020 2020 290d 0a20 2020 2020 2020 200d      )..        .
-00009950: 0a20 2020 2020 2020 2069 6620 6772 6f75  .        if grou
-00009960: 7062 795f 636f 6c73 203d 3d20 4e6f 6e65  pby_cols == None
-00009970: 3a0d 0a20 2020 2020 2020 2020 2020 2064  :..            d
-00009980: 6620 3d20 6466 5b5b 275f 5f57 6172 6e69  f = df[['__Warni
-00009990: 6e67 5f5f 275d 5d2e 6472 6f70 5f64 7570  ng__']].drop_dup
-000099a0: 6c69 6361 7465 7328 290d 0a20 2020 2020  licates()..     
-000099b0: 2020 2020 2020 2064 6620 3d20 7064 2e63         df = pd.c
-000099c0: 6f6e 6361 7428 5b6c 6566 742c 7269 6768  oncat([left,righ
-000099d0: 742c 6466 5d2c 2061 7869 733d 3129 0d0a  t,df], axis=1)..
-000099e0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-000099f0: 2020 2020 2020 2020 2020 2023 204d 6572             # Mer
-00009a00: 6765 2074 6865 2074 776f 2062 6f75 6e64  ge the two bound
-00009a10: 6172 6965 7320 746f 2063 7265 6174 6520  aries to create 
-00009a20: 7468 6520 696e 7465 7276 616c 2066 6f72  the interval for
-00009a30: 2074 6865 2070 6572 6365 6e74 696c 650d   the percentile.
-00009a40: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
-00009a50: 6865 636b 2074 6861 7420 7468 6520 6d65  heck that the me
-00009a60: 7267 6520 6973 2031 2d74 6f2d 310d 0a20  rge is 1-to-1.. 
-00009a70: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
-00009a80: 6466 5b67 726f 7570 6279 5f63 6f6c 7320  df[groupby_cols 
-00009a90: 2b20 5b27 5f5f 5761 726e 696e 675f 5f27  + ['__Warning__'
-00009aa0: 5d5d 2e64 726f 705f 6475 706c 6963 6174  ]].drop_duplicat
-00009ab0: 6573 2829 0d0a 2020 2020 2020 2020 2020  es()..          
-00009ac0: 2020 6c65 6674 203d 2064 662e 6d65 7267    left = df.merg
-00009ad0: 6528 6c65 6674 2c0d 0a20 2020 2020 2020  e(left,..       
-00009ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009af0: 2020 2020 2068 6f77 203d 2027 696e 6e65       how = 'inne
-00009b00: 7227 2c0d 0a20 2020 2020 2020 2020 2020  r',..           
-00009b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b20: 206f 6e20 3d20 6772 6f75 7062 795f 636f   on = groupby_co
-00009b30: 6c73 290d 0a20 2020 2020 2020 2020 2020  ls)..           
-00009b40: 2064 6620 3d20 6c65 6674 2e6d 6572 6765   df = left.merge
-00009b50: 2872 6967 6874 2c0d 0a20 2020 2020 2020  (right,..       
-00009b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b70: 2020 2020 2068 6f77 203d 2027 6f75 7465       how = 'oute
-00009b80: 7227 2c0d 0a20 2020 2020 2020 2020 2020  r',..           
-00009b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009ba0: 206f 6e20 3d20 6772 6f75 7062 795f 636f   on = groupby_co
-00009bb0: 6c73 2c0d 0a20 2020 2020 2020 2020 2020  ls,..           
-00009bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009bd0: 2076 616c 6964 6174 6520 3d20 2731 3a31   validate = '1:1
-00009be0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-00009bf0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00009c00: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00009c10: 2020 2020 2320 4372 6561 7465 2061 2063      # Create a c
-00009c20: 6f6c 756d 6e20 7468 6174 2069 6e64 6963  olumn that indic
-00009c30: 6174 6573 2074 6865 2067 656e 6572 6174  ates the generat
-00009c40: 6564 2073 7461 7469 7374 6963 0d0a 2020  ed statistic..  
-00009c50: 2020 2020 2020 6966 2070 6572 6365 6e74        if percent
-00009c60: 696c 6520 3d3d 2030 2e35 3a0d 0a20 2020  ile == 0.5:..   
-00009c70: 2020 2020 2020 2020 2064 665b 7365 6c66           df[self
-00009c80: 2e73 7461 745f 636f 6c5d 203d 2027 4d65  .stat_col] = 'Me
-00009c90: 6469 616e 270d 0a20 2020 2020 2020 2065  dian'..        e
-00009ca0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00009cb0: 2020 6466 5b73 656c 662e 7374 6174 5f63    df[self.stat_c
-00009cc0: 6f6c 5d20 3d20 6627 5065 7263 656e 7469  ol] = f'Percenti
-00009cd0: 6c65 2d7b 3130 302a 7065 7263 656e 7469  le-{100*percenti
-00009ce0: 6c65 7d27 0d0a 2020 2020 2020 2020 0d0a  le}'..        ..
-00009cf0: 2020 2020 2020 2020 2320 5265 6f72 6465          # Reorde
-00009d00: 7220 636f 6c75 6d6e 730d 0a20 2020 2020  r columns..     
-00009d10: 2020 2069 6620 6772 6f75 7062 795f 636f     if groupby_co
-00009d20: 6c73 203d 3d20 4e6f 6e65 3a0d 0a20 2020  ls == None:..   
-00009d30: 2020 2020 2020 2020 2064 6620 3d20 6466           df = df
-00009d40: 5b5b 7365 6c66 2e73 7461 745f 636f 6c2c  [[self.stat_col,
-00009d50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009d60: 2020 2020 2020 2073 656c 662e 6c65 6674         self.left
-00009d70: 5f62 6f75 6e64 6172 795f 636f 6c2c 0d0a  _boundary_col,..
-00009d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d90: 2020 2020 2073 656c 662e 6c65 6674 5f62       self.left_b
-00009da0: 6f75 6e64 5f63 6f6c 2c0d 0a20 2020 2020  ound_col,..     
-00009db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009dc0: 7365 6c66 2e72 6967 6874 5f62 6f75 6e64  self.right_bound
-00009dd0: 5f63 6f6c 2c0d 0a20 2020 2020 2020 2020  _col,..         
-00009de0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00009df0: 2e72 6967 6874 5f62 6f75 6e64 6172 795f  .right_boundary_
-00009e00: 636f 6c2c 0d0a 2020 2020 2020 2020 2020  col,..          
-00009e10: 2020 2020 2020 2020 2020 2027 5f5f 5761             '__Wa
-00009e20: 726e 696e 675f 5f27 0d0a 2020 2020 2020  rning__'..      
-00009e30: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00009e40: 5d0d 0a20 2020 2020 2020 2065 6c73 653a  ]..        else:
-00009e50: 0d0a 2020 2020 2020 2020 2020 2020 6466  ..            df
-00009e60: 203d 2064 665b 6772 6f75 7062 795f 636f   = df[groupby_co
-00009e70: 6c73 202b 0d0a 2020 2020 2020 2020 2020  ls +..          
-00009e80: 2020 2020 2020 2020 2020 5b73 656c 662e            [self.
-00009e90: 7374 6174 5f63 6f6c 2c0d 0a20 2020 2020  stat_col,..     
-00009ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009eb0: 7365 6c66 2e6c 6566 745f 626f 756e 6461  self.left_bounda
-00009ec0: 7279 5f63 6f6c 2c0d 0a20 2020 2020 2020  ry_col,..       
-00009ed0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00009ee0: 6c66 2e6c 6566 745f 626f 756e 645f 636f  lf.left_bound_co
-00009ef0: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
-00009f00: 2020 2020 2020 2020 2073 656c 662e 7269           self.ri
-00009f10: 6768 745f 626f 756e 645f 636f 6c2c 0d0a  ght_bound_col,..
-00009f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f30: 2020 2020 2073 656c 662e 7269 6768 745f       self.right_
-00009f40: 626f 756e 6461 7279 5f63 6f6c 2c0d 0a20  boundary_col,.. 
-00009f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f60: 2020 2020 275f 5f57 6172 6e69 6e67 5f5f      '__Warning__
-00009f70: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-00009f80: 2020 2020 2020 2020 5d5d 0d0a 2020 2020          ]]..    
-00009f90: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
-00009fa0: 5265 7365 7420 696e 6465 780d 0a20 2020  Reset index..   
-00009fb0: 2020 2020 2023 2064 6620 3d20 6466 2e72       # df = df.r
-00009fc0: 6573 6574 5f69 6e64 6578 2829 0d0a 2020  eset_index()..  
-00009fd0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00009fe0: 2320 5265 706c 6163 6520 6f72 2072 6574  # Replace or ret
-00009ff0: 7572 6e20 7265 7375 6c74 0d0a 2020 2020  urn result..    
-0000a000: 2020 2020 6966 2069 6e70 6c61 6365 3a0d      if inplace:.
-0000a010: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000a020: 662e 6461 7461 203d 2064 660d 0a20 2020  f.data = df..   
-0000a030: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0000a040: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-0000a050: 660d 0a20 2020 200d 0a20 2020 2023 2525  f..    ..    #%%
-0000a060: 2045 7863 6565 6461 6e63 6520 6173 7365   Exceedance asse
-0000a070: 7373 6d65 6e74 0d0a 2020 2020 0d0a 2020  ssment..    ..  
-0000a080: 2020 6465 6620 6465 7465 726d 696e 655f    def determine_
-0000a090: 6578 6365 6564 616e 6365 7328 7365 6c66  exceedances(self
-0000a0a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000098e0: 2020 2020 2072 6967 6874 5b73 656c 662e       right[self.
+000098f0: 7269 6768 745f 626f 756e 645f 636f 6c5d  right_bound_col]
+00009900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009910: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+00009920: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+00009930: 200d 0a20 2020 2020 2020 2069 6620 6772   ..        if gr
+00009940: 6f75 7062 795f 636f 6c73 203d 3d20 4e6f  oupby_cols == No
+00009950: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00009960: 2064 6620 3d20 6466 5b5b 275f 5f57 6172   df = df[['__War
+00009970: 6e69 6e67 5f5f 275d 5d2e 6472 6f70 5f64  ning__']].drop_d
+00009980: 7570 6c69 6361 7465 7328 290d 0a20 2020  uplicates()..   
+00009990: 2020 2020 2020 2020 2064 6620 3d20 7064           df = pd
+000099a0: 2e63 6f6e 6361 7428 5b6c 6566 742c 7269  .concat([left,ri
+000099b0: 6768 742c 6466 5d2c 2061 7869 733d 3129  ght,df], axis=1)
+000099c0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+000099d0: 0a20 2020 2020 2020 2020 2020 2023 204d  .            # M
+000099e0: 6572 6765 2074 6865 2074 776f 2062 6f75  erge the two bou
+000099f0: 6e64 6172 6965 7320 746f 2063 7265 6174  ndaries to creat
+00009a00: 6520 7468 6520 696e 7465 7276 616c 2066  e the interval f
+00009a10: 6f72 2074 6865 2070 6572 6365 6e74 696c  or the percentil
+00009a20: 650d 0a20 2020 2020 2020 2020 2020 2023  e..            #
+00009a30: 2043 6865 636b 2074 6861 7420 7468 6520   Check that the 
+00009a40: 6d65 7267 6520 6973 2031 2d74 6f2d 310d  merge is 1-to-1.
+00009a50: 0a20 2020 2020 2020 2020 2020 2064 6620  .            df 
+00009a60: 3d20 6466 5b67 726f 7570 6279 5f63 6f6c  = df[groupby_col
+00009a70: 7320 2b20 5b27 5f5f 5761 726e 696e 675f  s + ['__Warning_
+00009a80: 5f27 5d5d 2e64 726f 705f 6475 706c 6963  _']].drop_duplic
+00009a90: 6174 6573 2829 0d0a 2020 2020 2020 2020  ates()..        
+00009aa0: 2020 2020 6c65 6674 203d 2064 662e 6d65      left = df.me
+00009ab0: 7267 6528 6c65 6674 2c0d 0a20 2020 2020  rge(left,..     
+00009ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ad0: 2020 2020 2020 2068 6f77 203d 2027 696e         how = 'in
+00009ae0: 6e65 7227 2c0d 0a20 2020 2020 2020 2020  ner',..         
+00009af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b00: 2020 206f 6e20 3d20 6772 6f75 7062 795f     on = groupby_
+00009b10: 636f 6c73 290d 0a20 2020 2020 2020 2020  cols)..         
+00009b20: 2020 2064 6620 3d20 6c65 6674 2e6d 6572     df = left.mer
+00009b30: 6765 2872 6967 6874 2c0d 0a20 2020 2020  ge(right,..     
+00009b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b50: 2020 2020 2020 2068 6f77 203d 2027 6f75         how = 'ou
+00009b60: 7465 7227 2c0d 0a20 2020 2020 2020 2020  ter',..         
+00009b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b80: 2020 206f 6e20 3d20 6772 6f75 7062 795f     on = groupby_
+00009b90: 636f 6c73 2c0d 0a20 2020 2020 2020 2020  cols,..         
+00009ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009bb0: 2020 2076 616c 6964 6174 6520 3d20 2731     validate = '1
+00009bc0: 3a31 270d 0a20 2020 2020 2020 2020 2020  :1'..           
+00009bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009be0: 2029 0d0a 2020 2020 2020 2020 0d0a 2020   )..        ..  
+00009bf0: 2020 2020 2020 2320 4372 6561 7465 2061        # Create a
+00009c00: 2063 6f6c 756d 6e20 7468 6174 2069 6e64   column that ind
+00009c10: 6963 6174 6573 2074 6865 2067 656e 6572  icates the gener
+00009c20: 6174 6564 2073 7461 7469 7374 6963 0d0a  ated statistic..
+00009c30: 2020 2020 2020 2020 6966 2070 6572 6365          if perce
+00009c40: 6e74 696c 6520 3d3d 2030 2e35 3a0d 0a20  ntile == 0.5:.. 
+00009c50: 2020 2020 2020 2020 2020 2064 665b 7365             df[se
+00009c60: 6c66 2e73 7461 745f 636f 6c5d 203d 2027  lf.stat_col] = '
+00009c70: 4d65 6469 616e 270d 0a20 2020 2020 2020  Median'..       
+00009c80: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00009c90: 2020 2020 6466 5b73 656c 662e 7374 6174      df[self.stat
+00009ca0: 5f63 6f6c 5d20 3d20 6627 5065 7263 656e  _col] = f'Percen
+00009cb0: 7469 6c65 2d7b 3130 302a 7065 7263 656e  tile-{100*percen
+00009cc0: 7469 6c65 7d27 0d0a 2020 2020 2020 2020  tile}'..        
+00009cd0: 0d0a 2020 2020 2020 2020 2320 5265 6f72  ..        # Reor
+00009ce0: 6465 7220 636f 6c75 6d6e 730d 0a20 2020  der columns..   
+00009cf0: 2020 2020 2069 6620 6772 6f75 7062 795f       if groupby_
+00009d00: 636f 6c73 203d 3d20 4e6f 6e65 3a0d 0a20  cols == None:.. 
+00009d10: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
+00009d20: 6466 5b5b 7365 6c66 2e73 7461 745f 636f  df[[self.stat_co
+00009d30: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
+00009d40: 2020 2020 2020 2020 2073 656c 662e 6c65           self.le
+00009d50: 6674 5f62 6f75 6e64 6172 795f 636f 6c2c  ft_boundary_col,
+00009d60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009d70: 2020 2020 2020 2073 656c 662e 6c65 6674         self.left
+00009d80: 5f62 6f75 6e64 5f63 6f6c 2c0d 0a20 2020  _bound_col,..   
+00009d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009da0: 2020 7365 6c66 2e72 6967 6874 5f62 6f75    self.right_bou
+00009db0: 6e64 5f63 6f6c 2c0d 0a20 2020 2020 2020  nd_col,..       
+00009dc0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00009dd0: 6c66 2e72 6967 6874 5f62 6f75 6e64 6172  lf.right_boundar
+00009de0: 795f 636f 6c2c 0d0a 2020 2020 2020 2020  y_col,..        
+00009df0: 2020 2020 2020 2020 2020 2020 2027 5f5f               '__
+00009e00: 5761 726e 696e 675f 5f27 0d0a 2020 2020  Warning__'..    
+00009e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009e20: 205d 5d0d 0a20 2020 2020 2020 2065 6c73   ]]..        els
+00009e30: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00009e40: 6466 203d 2064 665b 6772 6f75 7062 795f  df = df[groupby_
+00009e50: 636f 6c73 202b 0d0a 2020 2020 2020 2020  cols +..        
+00009e60: 2020 2020 2020 2020 2020 2020 5b73 656c              [sel
+00009e70: 662e 7374 6174 5f63 6f6c 2c0d 0a20 2020  f.stat_col,..   
+00009e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009e90: 2020 7365 6c66 2e6c 6566 745f 626f 756e    self.left_boun
+00009ea0: 6461 7279 5f63 6f6c 2c0d 0a20 2020 2020  dary_col,..     
+00009eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ec0: 7365 6c66 2e6c 6566 745f 626f 756e 645f  self.left_bound_
+00009ed0: 636f 6c2c 0d0a 2020 2020 2020 2020 2020  col,..          
+00009ee0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00009ef0: 7269 6768 745f 626f 756e 645f 636f 6c2c  right_bound_col,
+00009f00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009f10: 2020 2020 2020 2073 656c 662e 7269 6768         self.righ
+00009f20: 745f 626f 756e 6461 7279 5f63 6f6c 2c0d  t_boundary_col,.
+00009f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009f40: 2020 2020 2020 275f 5f57 6172 6e69 6e67        '__Warning
+00009f50: 5f5f 270d 0a20 2020 2020 2020 2020 2020  __'..           
+00009f60: 2020 2020 2020 2020 2020 5d5d 0d0a 2020            ]]..  
+00009f70: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00009f80: 2320 5265 7365 7420 696e 6465 780d 0a20  # Reset index.. 
+00009f90: 2020 2020 2020 2023 2064 6620 3d20 6466         # df = df
+00009fa0: 2e72 6573 6574 5f69 6e64 6578 2829 0d0a  .reset_index()..
+00009fb0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00009fc0: 2020 2320 5265 706c 6163 6520 6f72 2072    # Replace or r
+00009fd0: 6574 7572 6e20 7265 7375 6c74 0d0a 2020  eturn result..  
+00009fe0: 2020 2020 2020 6966 2069 6e70 6c61 6365        if inplace
+00009ff0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+0000a000: 656c 662e 6461 7461 203d 2064 660d 0a20  elf.data = df.. 
+0000a010: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0000a020: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000a030: 2064 660d 0a20 2020 200d 0a20 2020 2023   df..    ..    #
+0000a040: 2525 2045 7863 6565 6461 6e63 6520 6173  %% Exceedance as
+0000a050: 7365 7373 6d65 6e74 0d0a 2020 2020 0d0a  sessment..    ..
+0000a060: 2020 2020 6465 6620 6465 7465 726d 696e      def determin
+0000a070: 655f 6578 6365 6564 616e 6365 7328 7365  e_exceedances(se
+0000a080: 6c66 2c0d 0a20 2020 2020 2020 2020 2020  lf,..           
+0000a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a0a0: 2020 2074 6872 6573 686f 6c64 2c0d 0a20     threshold,.. 
 0000a0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a0c0: 2074 6872 6573 686f 6c64 2c0d 0a20 2020   threshold,..   
-0000a0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a0e0: 2020 2020 2020 2020 2020 2074 6872 6573             thres
-0000a0f0: 686f 6c64 5f69 735f 6578 6365 6564 616e  hold_is_exceedan
-0000a100: 6365 203d 2046 616c 7365 2c0d 0a20 2020  ce = False,..   
-0000a110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a120: 2020 2020 2020 2020 2020 2069 6e70 6c61             inpla
-0000a130: 6365 203d 2046 616c 7365 293a 0d0a 2020  ce = False):..  
-0000a140: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000a150: 2320 4368 6563 6b20 7468 6174 2074 6872  # Check that thr
-0000a160: 6573 686f 6c64 2069 7320 696e 7465 6765  eshold is intege
-0000a170: 7220 6f72 2066 6c6f 6174 0d0a 2020 2020  r or float..    
-0000a180: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-0000a190: 7461 6e63 6528 7468 7265 7368 6f6c 642c  tance(threshold,
-0000a1a0: 2028 696e 742c 2066 6c6f 6174 2929 3a0d   (int, float)):.
-0000a1b0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000a1c0: 7365 2056 616c 7565 4572 726f 7228 2749  se ValueError('I
-0000a1d0: 6e70 7574 2066 6f72 2074 6872 6573 686f  nput for thresho
-0000a1e0: 6c64 206e 6565 6473 2074 6f20 6265 2069  ld needs to be i
-0000a1f0: 6e74 6567 6572 206f 7220 270d 0a20 2020  nteger or '..   
-0000a200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a210: 2020 2020 2020 2020 2020 2766 6c6f 6174            'float
-0000a220: 2074 7970 652e 2729 0d0a 2020 2020 2020   type.')..      
-0000a230: 2020 0d0a 2020 2020 2020 2020 2320 4372    ..        # Cr
-0000a240: 6561 7465 2061 2063 6f70 7920 6f66 2074  eate a copy of t
-0000a250: 6865 2064 6174 610d 0a20 2020 2020 2020  he data..       
-0000a260: 2064 6620 3d20 7365 6c66 2e64 6174 612e   df = self.data.
-0000a270: 636f 7079 2829 0d0a 2020 2020 2020 2020  copy()..        
-0000a280: 0d0a 2020 2020 2020 2020 2320 5365 7420  ..        # Set 
-0000a290: 636f 6e64 6974 696f 6e73 2064 6570 656e  conditions depen
-0000a2a0: 6469 6e67 206f 6e20 7768 6574 6865 7220  ding on whether 
-0000a2b0: 7468 6520 7468 7265 7368 6f6c 6420 6973  the threshold is
-0000a2c0: 2061 6e20 6578 6365 6564 616e 6365 0d0a   an exceedance..
-0000a2d0: 2020 2020 2020 2020 6966 2074 6872 6573          if thres
-0000a2e0: 686f 6c64 5f69 735f 6578 6365 6564 616e  hold_is_exceedan
-0000a2f0: 6365 3a0d 0a20 2020 2020 2020 2020 2020  ce:..           
-0000a300: 2023 2053 6574 2063 6f6e 6469 7469 6f6e   # Set condition
-0000a310: 7320 666f 7220 6578 6365 6564 616e 6365  s for exceedance
-0000a320: 7320 616e 6420 6e6f 6e2d 6578 6365 6564  s and non-exceed
-0000a330: 616e 6365 730d 0a20 2020 2020 2020 2020  ances..         
-0000a340: 2020 2063 6f6e 6469 7469 6f6e 7320 3d20     conditions = 
-0000a350: 5b0d 0a20 2020 2020 2020 2020 2020 2020  [..             
-0000a360: 2020 2023 2045 7863 6565 6461 6e63 6520     # Exceedance 
-0000a370: 636f 6e64 6974 696f 6e0d 0a20 2020 2020  condition..     
-0000a380: 2020 2020 2020 2020 2020 2023 2054 6865             # The
-0000a390: 206c 6566 7420 626f 756e 6420 6973 2067   left bound is g
-0000a3a0: 7265 6174 6572 2074 6861 6e20 6f72 2065  reater than or e
-0000a3b0: 7175 616c 2074 6f20 7468 6520 7468 7265  qual to the thre
-0000a3c0: 7368 6f6c 640d 0a20 2020 2020 2020 2020  shold..         
-0000a3d0: 2020 2020 2020 2028 6466 5b73 656c 662e         (df[self.
-0000a3e0: 6c65 6674 5f62 6f75 6e64 5f63 6f6c 5d20  left_bound_col] 
-0000a3f0: 3e3d 2074 6872 6573 686f 6c64 292c 0d0a  >= threshold),..
-0000a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a410: 2320 4e6f 6e2d 6578 6365 6564 616e 6365  # Non-exceedance
-0000a420: 2063 6f6e 6469 7469 6f6e 730d 0a20 2020   conditions..   
-0000a430: 2020 2020 2020 2020 2020 2020 2028 0d0a               (..
-0000a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a450: 2020 2020 2320 5468 6520 7269 6768 7420      # The right 
-0000a460: 626f 756e 6420 6973 206c 6573 7320 7468  bound is less th
-0000a470: 616e 2074 6865 2074 6872 6573 686f 6c64  an the threshold
-0000a480: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000a490: 2020 2020 2020 2864 665b 7365 6c66 2e72        (df[self.r
-0000a4a0: 6967 6874 5f62 6f75 6e64 5f63 6f6c 5d20  ight_bound_col] 
-0000a4b0: 3c20 7468 7265 7368 6f6c 6429 207c 0d0a  < threshold) |..
-0000a4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a4d0: 2020 2020 2320 5468 6520 7269 6768 7420      # The right 
-0000a4e0: 626f 756e 6420 6973 2065 7175 616c 2074  bound is equal t
-0000a4f0: 6f20 7468 6520 7468 7265 7368 6f6c 6420  o the threshold 
-0000a500: 616e 6420 6f70 656e 0d0a 2020 2020 2020  and open..      
-0000a510: 2020 2020 2020 2020 2020 2020 2020 2828                ((
-0000a520: 6466 5b73 656c 662e 7269 6768 745f 626f  df[self.right_bo
-0000a530: 756e 645f 636f 6c5d 203d 3d20 7468 7265  und_col] == thre
-0000a540: 7368 6f6c 6429 2026 0d0a 2020 2020 2020  shold) &..      
-0000a550: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0000a560: 6466 5b73 656c 662e 7269 6768 745f 626f  df[self.right_bo
-0000a570: 756e 6461 7279 5f63 6f6c 5d20 3d3d 2027  undary_col] == '
-0000a580: 4f70 656e 2729 290d 0a20 2020 2020 2020  Open'))..       
-0000a590: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-0000a5a0: 2020 2020 2020 2020 2020 2020 5d0d 0a20              ].. 
-0000a5b0: 2020 2020 2020 2023 2053 6574 2063 6f6e         # Set con
-0000a5c0: 6469 7469 6f6e 7320 7768 656e 2074 6872  ditions when thr
-0000a5d0: 6573 686f 6c64 2069 7320 6e6f 7420 616e  eshold is not an
-0000a5e0: 2065 7863 6565 6461 6e63 650d 0a20 2020   exceedance..   
-0000a5f0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0000a600: 2020 2020 2020 2020 2320 5365 7420 636f          # Set co
-0000a610: 6e64 6974 696f 6e73 2066 6f72 2065 7863  nditions for exc
-0000a620: 6565 6461 6e63 6573 2061 6e64 206e 6f6e  eedances and non
-0000a630: 2d65 7863 6565 6461 6e63 6573 0d0a 2020  -exceedances..  
-0000a640: 2020 2020 2020 2020 2020 636f 6e64 6974            condit
-0000a650: 696f 6e73 203d 205b 0d0a 2020 2020 2020  ions = [..      
-0000a660: 2020 2020 2020 2020 2020 2320 4578 6365            # Exce
-0000a670: 6564 616e 6365 7320 636f 6e64 6974 696f  edances conditio
-0000a680: 6e73 0d0a 2020 2020 2020 2020 2020 2020  ns..            
-0000a690: 2020 2020 280d 0a20 2020 2020 2020 2020      (..         
-0000a6a0: 2020 2020 2020 2020 2020 2023 2054 6865             # The
-0000a6b0: 206c 6566 7420 626f 756e 6420 6973 2067   left bound is g
-0000a6c0: 7265 6174 6572 2074 6861 6e20 7468 6520  reater than the 
-0000a6d0: 7468 7265 7368 6f6c 640d 0a20 2020 2020  threshold..     
-0000a6e0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0000a6f0: 6466 5b73 656c 662e 6c65 6674 5f62 6f75  df[self.left_bou
-0000a700: 6e64 5f63 6f6c 5d20 3e20 7468 7265 7368  nd_col] > thresh
-0000a710: 6f6c 6429 207c 0d0a 2020 2020 2020 2020  old) |..        
-0000a720: 2020 2020 2020 2020 2020 2020 2320 4966              # If
-0000a730: 2074 6865 206c 6566 7420 626f 756e 6420   the left bound 
-0000a740: 6973 2065 7175 616c 2074 6f20 7468 6520  is equal to the 
-0000a750: 7468 7265 7368 6f6c 6420 616e 6420 6f70  threshold and op
-0000a760: 656e 0d0a 2020 2020 2020 2020 2020 2020  en..            
-0000a770: 2020 2020 2020 2020 2828 6466 5b73 656c          ((df[sel
-0000a780: 662e 6c65 6674 5f62 6f75 6e64 5f63 6f6c  f.left_bound_col
-0000a790: 5d20 3d3d 2074 6872 6573 686f 6c64 2920  ] == threshold) 
-0000a7a0: 260d 0a20 2020 2020 2020 2020 2020 2020  &..             
-0000a7b0: 2020 2020 2020 2020 2864 665b 7365 6c66          (df[self
-0000a7c0: 2e6c 6566 745f 626f 756e 6461 7279 5f63  .left_boundary_c
-0000a7d0: 6f6c 5d20 3d3d 2027 4f70 656e 2729 290d  ol] == 'Open')).
-0000a7e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a7f0: 2029 2c0d 0a20 2020 2020 2020 2020 2020   ),..           
-0000a800: 2020 2020 2023 204e 6f6e 2d65 7863 6565       # Non-excee
-0000a810: 6461 6e63 6520 636f 6e64 6974 696f 6e0d  dance condition.
-0000a820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a830: 2023 2054 6865 2072 6967 6874 2062 6f75   # The right bou
-0000a840: 6e64 2069 7320 6c65 7373 2074 6861 6e20  nd is less than 
-0000a850: 6f72 2065 7175 616c 2074 6f20 7468 6520  or equal to the 
-0000a860: 7468 7265 7368 6f6c 640d 0a20 2020 2020  threshold..     
-0000a870: 2020 2020 2020 2020 2020 2028 6466 5b73             (df[s
-0000a880: 656c 662e 7269 6768 745f 626f 756e 645f  elf.right_bound_
-0000a890: 636f 6c5d 203c 3d20 7468 7265 7368 6f6c  col] <= threshol
-0000a8a0: 6429 0d0a 2020 2020 2020 2020 2020 2020  d)..            
-0000a8b0: 2020 2020 5d0d 0a20 2020 2020 2020 2023      ]..        #
-0000a8c0: 2045 7863 6565 6461 6e63 6573 2061 7265   Exceedances are
-0000a8d0: 2069 6e64 6963 6174 6564 2062 7920 696e   indicated by in
-0000a8e0: 7465 6765 7273 0d0a 2020 2020 2020 2020  tegers..        
-0000a8f0: 2320 2831 3d65 7863 6565 6461 6e63 652c  # (1=exceedance,
-0000a900: 2030 3d6e 6f6e 2d65 7863 6565 6461 6e63   0=non-exceedanc
-0000a910: 6529 0d0a 2020 2020 2020 2020 7265 7375  e)..        resu
-0000a920: 6c74 7320 3d20 5b0d 0a20 2020 2020 2020  lts = [..       
-0000a930: 2020 2020 2031 2c0d 0a20 2020 2020 2020       1,..       
-0000a940: 2020 2020 2030 0d0a 2020 2020 2020 2020       0..        
-0000a950: 2020 2020 5d0d 0a20 2020 2020 2020 2023      ]..        #
-0000a960: 2044 6566 6175 6c74 2065 7863 6565 6461   Default exceeda
-0000a970: 6e63 6520 286e 702e 6e61 6e3d 756e 6b6e  nce (np.nan=unkn
-0000a980: 6f77 6e29 0d0a 2020 2020 2020 2020 6466  own)..        df
-0000a990: 5b73 656c 662e 6578 6365 6564 616e 6365  [self.exceedance
-0000a9a0: 735f 636f 6c5d 203d 206e 702e 7365 6c65  s_col] = np.sele
-0000a9b0: 6374 2863 6f6e 6469 7469 6f6e 732c 2072  ct(conditions, r
-0000a9c0: 6573 756c 7473 2c20 6e70 2e6e 616e 290d  esults, np.nan).
-0000a9d0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0000a9e0: 2020 2023 2052 6570 6c61 6365 206f 7220     # Replace or 
-0000a9f0: 7265 7475 726e 2072 6573 756c 740d 0a20  return result.. 
-0000aa00: 2020 2020 2020 2069 6620 696e 706c 6163         if inplac
-0000aa10: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0000aa20: 7365 6c66 2e64 6174 6120 3d20 6466 0d0a  self.data = df..
-0000aa30: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0000aa40: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000aa50: 6e20 6466 0d0a 2020 2020 0d0a 2020 2020  n df..    ..    
-0000aa60: 2325 2520 5374 6174 6973 7469 6320 6d65  #%% Statistic me
-0000aa70: 7468 6f64 730d 0a20 2020 200d 0a20 2020  thods..    ..   
-0000aa80: 2064 6566 2067 656e 6572 616c 5f73 7461   def general_sta
-0000aa90: 7428 7365 6c66 2c0d 0a20 2020 2020 2020  t(self,..       
-0000aaa0: 2020 2020 2020 2020 2020 2020 2020 7374                st
-0000aab0: 6174 2c0d 0a20 2020 2020 2020 2020 2020  at,..           
-0000aac0: 2020 2020 2020 2020 2020 6772 6f75 7062            groupb
-0000aad0: 795f 636f 6c73 203d 204e 6f6e 652c 0d0a  y_cols = None,..
-0000aae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aaf0: 2020 2020 2063 6f75 6e74 5f63 6f6c 7320       count_cols 
-0000ab00: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
-0000ab10: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0000ab20: 706c 6163 6520 3d20 4661 6c73 650d 0a20  place = False.. 
-0000ab30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ab40: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
-0000ab50: 0d0a 2020 2020 2020 2020 2320 4372 6561  ..        # Crea
-0000ab60: 7465 2061 2063 6f70 7920 6f66 2074 6865  te a copy of the
-0000ab70: 2043 656e 736f 7265 6444 6174 6120 6f62   CensoredData ob
-0000ab80: 6a65 6374 0d0a 2020 2020 2020 2020 6364  ject..        cd
-0000ab90: 6620 3d20 636f 7079 2e64 6565 7063 6f70  f = copy.deepcop
-0000aba0: 7928 7365 6c66 290d 0a20 2020 2020 2020  y(self)..       
-0000abb0: 200d 0a20 2020 2020 2020 2023 2049 6620   ..        # If 
-0000abc0: 6e6f 2067 726f 7570 6279 5f63 6f6c 7320  no groupby_cols 
-0000abd0: 7072 6f76 6964 6564 2c20 6361 6c63 756c  provided, calcul
-0000abe0: 6174 6520 7374 6174 2066 6f72 2066 756c  ate stat for ful
-0000abf0: 6c20 6461 7461 7365 740d 0a20 2020 2020  l dataset..     
-0000ac00: 2020 2069 6620 6772 6f75 7062 795f 636f     if groupby_co
-0000ac10: 6c73 203d 3d20 4e6f 6e65 3a0d 0a20 2020  ls == None:..   
-0000ac20: 2020 2020 2020 2020 2073 7461 7428 6364           stat(cd
-0000ac30: 662c 205b 5d2c 2069 6e70 6c61 6365 203d  f, [], inplace =
-0000ac40: 2054 7275 6529 0d0a 2020 2020 2020 2020   True)..        
-0000ac50: 2320 4966 2067 726f 7570 6279 5f63 6f6c  # If groupby_col
-0000ac60: 7320 6973 2061 206c 6973 7420 6f66 206c  s is a list of l
-0000ac70: 6973 7473 2c20 7468 656e 2063 616c 6375  ists, then calcu
-0000ac80: 6c61 7465 2073 7461 7420 666f 7220 6561  late stat for ea
-0000ac90: 6368 0d0a 2020 2020 2020 2020 2320 7365  ch..        # se
-0000aca0: 7175 656e 7469 616c 2067 726f 7570 0d0a  quential group..
-0000acb0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-0000acc0: 6e73 7461 6e63 6528 6772 6f75 7062 795f  nstance(groupby_
-0000acd0: 636f 6c73 5b30 5d2c 206c 6973 7429 3a0d  cols[0], list):.
-0000ace0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0000acf0: 2067 726f 7570 696e 6720 696e 2067 726f   grouping in gro
-0000ad00: 7570 6279 5f63 6f6c 733a 0d0a 2020 2020  upby_cols:..    
-0000ad10: 2020 2020 2020 2020 2020 2020 7374 6174              stat
-0000ad20: 2863 6466 2c20 6772 6f75 7069 6e67 2c20  (cdf, grouping, 
-0000ad30: 696e 706c 6163 6520 3d20 5472 7565 290d  inplace = True).
-0000ad40: 0a20 2020 2020 2020 2023 2049 6620 7468  .        # If th
-0000ad50: 6520 6772 6f75 7062 795f 636f 6c73 2069  e groupby_cols i
-0000ad60: 7320 6120 6c69 7374 206f 6620 636f 6c75  s a list of colu
-0000ad70: 6d6e 206e 616d 6573 2c20 7468 656e 2063  mn names, then c
-0000ad80: 616c 6375 6c61 7465 2073 7461 740d 0a20  alculate stat.. 
-0000ad90: 2020 2020 2020 2023 2066 6f72 2065 6163         # for eac
-0000ada0: 6820 6772 6f75 700d 0a20 2020 2020 2020  h group..       
-0000adb0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-0000adc0: 2867 726f 7570 6279 5f63 6f6c 732c 206c  (groupby_cols, l
-0000add0: 6973 7429 3a0d 0a20 2020 2020 2020 2020  ist):..         
-0000ade0: 2020 2073 7461 7428 6364 662c 2067 726f     stat(cdf, gro
-0000adf0: 7570 6279 5f63 6f6c 732c 2069 6e70 6c61  upby_cols, inpla
-0000ae00: 6365 203d 2054 7275 6529 0d0a 2020 2020  ce = True)..    
-0000ae10: 2020 2020 2320 456c 7365 2075 6e65 7870      # Else unexp
-0000ae20: 6563 7465 6420 666f 726d 6174 2066 6f72  ected format for
-0000ae30: 2067 726f 7570 6279 5f63 6f6c 730d 0a20   groupby_cols.. 
-0000ae40: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0000ae50: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000ae60: 5661 6c75 6545 7272 6f72 2827 5468 6520  ValueError('The 
-0000ae70: 7661 6c75 6520 7072 6f76 6964 6564 2066  value provided f
-0000ae80: 6f72 2022 6772 6f75 7062 795f 636f 6c73  or "groupby_cols
-0000ae90: 2220 6d75 7374 2062 6520 6120 270d 0a20  " must be a '.. 
-0000aea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aeb0: 2020 2020 2020 2020 2020 2020 276c 6973              'lis
-0000aec0: 7420 7261 7468 6572 2074 6861 6e20 7b74  t rather than {t
-0000aed0: 7970 6528 6772 6f75 7062 795f 636f 6c73  ype(groupby_cols
-0000aee0: 297d 2e27 290d 0a20 2020 2020 2020 200d  )}.')..        .
-0000aef0: 0a20 2020 2020 2020 2023 2053 6574 2066  .        # Set f
-0000af00: 6f63 7573 206f 6620 6869 6768 206f 7220  ocus of high or 
-0000af10: 6c6f 770d 0a20 2020 2020 2020 2069 6620  low..        if 
-0000af20: 7374 6174 203d 3d20 4365 6e73 6f72 6564  stat == Censored
-0000af30: 4461 7461 2e6d 6178 696d 756d 5f69 6e74  Data.maximum_int
-0000af40: 6572 7661 6c3a 0d0a 2020 2020 2020 2020  erval:..        
-0000af50: 2020 2020 666f 6375 735f 6869 6768 5f70      focus_high_p
-0000af60: 6f74 656e 7469 616c 203d 2054 7275 650d  otential = True.
-0000af70: 0a20 2020 2020 2020 2065 6c69 6620 7374  .        elif st
-0000af80: 6174 203d 3d20 4365 6e73 6f72 6564 4461  at == CensoredDa
-0000af90: 7461 2e6d 696e 696d 756d 5f69 6e74 6572  ta.minimum_inter
-0000afa0: 7661 6c3a 0d0a 2020 2020 2020 2020 2020  val:..          
-0000afb0: 2020 666f 6375 735f 6869 6768 5f70 6f74    focus_high_pot
-0000afc0: 656e 7469 616c 203d 2046 616c 7365 0d0a  ential = False..
-0000afd0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0000afe0: 2020 2020 2020 2020 2020 2066 6f63 7573             focus
-0000aff0: 5f68 6967 685f 706f 7465 6e74 6961 6c20  _high_potential 
-0000b000: 3d20 7365 6c66 2e66 6f63 7573 5f68 6967  = self.focus_hig
-0000b010: 685f 706f 7465 6e74 6961 6c0d 0a20 2020  h_potential..   
-0000b020: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
-0000b030: 2043 6f6e 7665 7274 2074 6865 2069 6e74   Convert the int
-0000b040: 6572 7661 6c20 666f 7220 7468 6520 7374  erval for the st
-0000b050: 6174 2069 6e74 6f20 6365 6e73 6f72 2061  at into censor a
-0000b060: 6e64 206e 756d 6572 6963 206e 6f74 6174  nd numeric notat
-0000b070: 696f 6e0d 0a20 2020 2020 2020 2063 6466  ion..        cdf
-0000b080: 2e63 6f6d 706f 6e65 6e74 735f 6672 6f6d  .components_from
-0000b090: 5f69 6e74 6572 7661 6c28 666f 6375 735f  _interval(focus_
-0000b0a0: 6869 6768 5f70 6f74 656e 7469 616c 2c20  high_potential, 
-0000b0b0: 696e 706c 6163 6520 3d20 5472 7565 290d  inplace = True).
-0000b0c0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0000b0d0: 2020 2023 2043 7265 6174 6520 636f 6c75     # Create colu
-0000b0e0: 6d6e 2077 6974 6820 696e 7465 7276 616c  mn with interval
-0000b0f0: 206e 6f74 6174 696f 6e0d 0a20 2020 2020   notation..     
-0000b100: 2020 2063 6466 2e69 6e74 6572 7661 6c5f     cdf.interval_
-0000b110: 6e6f 7461 7469 6f6e 2869 6e70 6c61 6365  notation(inplace
-0000b120: 203d 2054 7275 6529 0d0a 2020 2020 2020   = True)..      
-0000b130: 2020 0d0a 2020 2020 2020 2020 2320 436f    ..        # Co
-0000b140: 6d62 696e 6520 7468 6520 6365 6e73 6f72  mbine the censor
-0000b150: 2061 6e64 206e 756d 6572 6963 2063 6f6d   and numeric com
-0000b160: 706f 6e65 6e74 7320 696e 746f 2061 2072  ponents into a r
-0000b170: 6573 756c 740d 0a20 2020 2020 2020 2063  esult..        c
-0000b180: 6466 2e72 6573 756c 745f 6672 6f6d 5f63  df.result_from_c
-0000b190: 6f6d 706f 6e65 6e74 7328 696e 706c 6163  omponents(inplac
-0000b1a0: 6520 3d20 5472 7565 290d 0a20 2020 2020  e = True)..     
-0000b1b0: 2020 200d 0a20 2020 2020 2020 2023 2052     ..        # R
-0000b1c0: 656f 7264 6572 2063 6f6c 756d 6e73 0d0a  eorder columns..
-0000b1d0: 2020 2020 2020 2020 6f75 7470 7574 5f63          output_c
-0000b1e0: 6f6c 7320 3d20 5b63 6466 2e73 7461 745f  ols = [cdf.stat_
-0000b1f0: 636f 6c2c 0d0a 2020 2020 2020 2020 2020  col,..          
-0000b200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b210: 6364 662e 7265 7375 6c74 5f63 6f6c 2c0d  cdf.result_col,.
-0000b220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b230: 2020 2020 2020 2020 2020 2063 6466 2e63             cdf.c
-0000b240: 656e 736f 725f 636f 6c2c 0d0a 2020 2020  ensor_col,..    
-0000b250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b260: 2020 2020 2020 6364 662e 6e75 6d65 7269        cdf.numeri
-0000b270: 635f 636f 6c2c 0d0a 2020 2020 2020 2020  c_col,..        
-0000b280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b290: 2020 6364 662e 696e 7465 7276 616c 5f63    cdf.interval_c
-0000b2a0: 6f6c 5d0d 0a20 2020 2020 2020 200d 0a20  ol]..        .. 
-0000b2b0: 2020 2020 2020 2069 6620 6772 6f75 7062         if groupb
-0000b2c0: 795f 636f 6c73 203d 3d20 4e6f 6e65 3a0d  y_cols == None:.
-0000b2d0: 0a20 2020 2020 2020 2020 2020 2063 6466  .            cdf
-0000b2e0: 2e64 6174 6120 3d20 6364 662e 6461 7461  .data = cdf.data
-0000b2f0: 5b6f 7574 7075 745f 636f 6c73 5d0d 0a20  [output_cols].. 
-0000b300: 2020 2020 2020 2065 6c69 6620 2861 6c6c         elif (all
-0000b310: 2869 7369 6e73 7461 6e63 6528 6e61 6d65  (isinstance(name
-0000b320: 2c20 7374 7229 2066 6f72 206e 616d 6520  , str) for name 
-0000b330: 696e 2067 726f 7570 6279 5f63 6f6c 7329  in groupby_cols)
-0000b340: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0000b350: 6364 662e 6461 7461 203d 2063 6466 2e64  cdf.data = cdf.d
-0000b360: 6174 615b 6772 6f75 7062 795f 636f 6c73  ata[groupby_cols
-0000b370: 202b 206f 7574 7075 745f 636f 6c73 5d0d   + output_cols].
-0000b380: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0000b390: 2020 2020 2020 2020 2020 2020 6364 662e              cdf.
-0000b3a0: 6461 7461 203d 2063 6466 2e64 6174 615b  data = cdf.data[
-0000b3b0: 6772 6f75 7062 795f 636f 6c73 5b2d 315d  groupby_cols[-1]
-0000b3c0: 202b 206f 7574 7075 745f 636f 6c73 5d0d   + output_cols].
-0000b3d0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0000b3e0: 2020 2023 204d 6572 6765 2063 6f75 6e74     # Merge count
-0000b3f0: 2069 6e66 6f0d 0a20 2020 2020 2020 2069   info..        i
-0000b400: 6620 636f 756e 745f 636f 6c73 2021 3d20  f count_cols != 
-0000b410: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-0000b420: 2020 2063 6466 2e64 6174 6120 3d20 7365     cdf.data = se
-0000b430: 6c66 2e6d 6572 6765 5f63 6f75 6e74 7328  lf.merge_counts(
-0000b440: 6364 662e 6461 7461 2c0d 0a20 2020 2020  cdf.data,..     
-0000b450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b470: 2020 2020 636f 756e 745f 636f 6c73 2c0d      count_cols,.
-0000b480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b4a0: 2020 2020 2020 2020 2020 6772 6f75 7062            groupb
-0000b4b0: 795f 636f 6c73 290d 0a20 2020 2020 2020  y_cols)..       
-0000b4c0: 200d 0a20 2020 2020 2020 2023 2052 6570   ..        # Rep
-0000b4d0: 6c61 6365 206f 7220 7265 7475 726e 2072  lace or return r
-0000b4e0: 6573 756c 740d 0a20 2020 2020 2020 2069  esult..        i
-0000b4f0: 6620 696e 706c 6163 653a 0d0a 2020 2020  f inplace:..    
-0000b500: 2020 2020 2020 2020 7365 6c66 2e64 6174          self.dat
-0000b510: 6120 3d20 6364 662e 6461 7461 0d0a 2020  a = cdf.data..  
-0000b520: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0000b530: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000b540: 6364 662e 6461 7461 0d0a 2020 2020 0d0a  cdf.data..    ..
-0000b550: 2020 2020 6465 6620 6d61 7869 6d75 6d28      def maximum(
-0000b560: 7365 6c66 2c0d 0a20 2020 2020 2020 2020  self,..         
-0000b570: 2020 2020 2020 2067 726f 7570 6279 5f63         groupby_c
-0000b580: 6f6c 7320 3d20 4e6f 6e65 2c0d 0a20 2020  ols = None,..   
-0000b590: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
-0000b5a0: 6e74 5f63 6f6c 7320 3d20 4e6f 6e65 2c0d  nt_cols = None,.
-0000b5b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b5c0: 2069 6e70 6c61 6365 203d 2046 616c 7365   inplace = False
-0000b5d0: 293a 0d0a 2020 2020 2020 2020 0d0a 2020  ):..        ..  
-0000b5e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000b5f0: 662e 6765 6e65 7261 6c5f 7374 6174 2843  f.general_stat(C
-0000b600: 656e 736f 7265 6444 6174 612e 6d61 7869  ensoredData.maxi
-0000b610: 6d75 6d5f 696e 7465 7276 616c 2c0d 0a20  mum_interval,.. 
-0000b620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b640: 6772 6f75 7062 795f 636f 6c73 2c0d 0a20  groupby_cols,.. 
-0000b650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a0c0: 2020 2020 2020 2020 2020 2020 2074 6872               thr
+0000a0d0: 6573 686f 6c64 5f69 735f 6578 6365 6564  eshold_is_exceed
+0000a0e0: 616e 6365 203d 2046 616c 7365 2c0d 0a20  ance = False,.. 
+0000a0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a100: 2020 2020 2020 2020 2020 2020 2069 6e70               inp
+0000a110: 6c61 6365 203d 2046 616c 7365 293a 0d0a  lace = False):..
+0000a120: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000a130: 2020 2320 4368 6563 6b20 7468 6174 2074    # Check that t
+0000a140: 6872 6573 686f 6c64 2069 7320 696e 7465  hreshold is inte
+0000a150: 6765 7220 6f72 2066 6c6f 6174 0d0a 2020  ger or float..  
+0000a160: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+0000a170: 6e73 7461 6e63 6528 7468 7265 7368 6f6c  nstance(threshol
+0000a180: 642c 2028 696e 742c 2066 6c6f 6174 2929  d, (int, float))
+0000a190: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+0000a1a0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0000a1b0: 2749 6e70 7574 2066 6f72 2074 6872 6573  'Input for thres
+0000a1c0: 686f 6c64 206e 6565 6473 2074 6f20 6265  hold needs to be
+0000a1d0: 2069 6e74 6567 6572 206f 7220 270d 0a20   integer or '.. 
+0000a1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a1f0: 2020 2020 2020 2020 2020 2020 2766 6c6f              'flo
+0000a200: 6174 2074 7970 652e 2729 0d0a 2020 2020  at type.')..    
+0000a210: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
+0000a220: 4372 6561 7465 2061 2063 6f70 7920 6f66  Create a copy of
+0000a230: 2074 6865 2064 6174 610d 0a20 2020 2020   the data..     
+0000a240: 2020 2064 6620 3d20 7365 6c66 2e64 6174     df = self.dat
+0000a250: 612e 636f 7079 2829 0d0a 2020 2020 2020  a.copy()..      
+0000a260: 2020 0d0a 2020 2020 2020 2020 2320 5365    ..        # Se
+0000a270: 7420 636f 6e64 6974 696f 6e73 2064 6570  t conditions dep
+0000a280: 656e 6469 6e67 206f 6e20 7768 6574 6865  ending on whethe
+0000a290: 7220 7468 6520 7468 7265 7368 6f6c 6420  r the threshold 
+0000a2a0: 6973 2061 6e20 6578 6365 6564 616e 6365  is an exceedance
+0000a2b0: 0d0a 2020 2020 2020 2020 6966 2074 6872  ..        if thr
+0000a2c0: 6573 686f 6c64 5f69 735f 6578 6365 6564  eshold_is_exceed
+0000a2d0: 616e 6365 3a0d 0a20 2020 2020 2020 2020  ance:..         
+0000a2e0: 2020 2023 2053 6574 2063 6f6e 6469 7469     # Set conditi
+0000a2f0: 6f6e 7320 666f 7220 6578 6365 6564 616e  ons for exceedan
+0000a300: 6365 7320 616e 6420 6e6f 6e2d 6578 6365  ces and non-exce
+0000a310: 6564 616e 6365 730d 0a20 2020 2020 2020  edances..       
+0000a320: 2020 2020 2063 6f6e 6469 7469 6f6e 7320       conditions 
+0000a330: 3d20 5b0d 0a20 2020 2020 2020 2020 2020  = [..           
+0000a340: 2020 2020 2023 2045 7863 6565 6461 6e63       # Exceedanc
+0000a350: 6520 636f 6e64 6974 696f 6e0d 0a20 2020  e condition..   
+0000a360: 2020 2020 2020 2020 2020 2020 2023 2054               # T
+0000a370: 6865 206c 6566 7420 626f 756e 6420 6973  he left bound is
+0000a380: 2067 7265 6174 6572 2074 6861 6e20 6f72   greater than or
+0000a390: 2065 7175 616c 2074 6f20 7468 6520 7468   equal to the th
+0000a3a0: 7265 7368 6f6c 640d 0a20 2020 2020 2020  reshold..       
+0000a3b0: 2020 2020 2020 2020 2028 6466 5b73 656c           (df[sel
+0000a3c0: 662e 6c65 6674 5f62 6f75 6e64 5f63 6f6c  f.left_bound_col
+0000a3d0: 5d20 3e3d 2074 6872 6573 686f 6c64 292c  ] >= threshold),
+0000a3e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a3f0: 2020 2320 4e6f 6e2d 6578 6365 6564 616e    # Non-exceedan
+0000a400: 6365 2063 6f6e 6469 7469 6f6e 730d 0a20  ce conditions.. 
+0000a410: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0000a420: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a430: 2020 2020 2020 2320 5468 6520 7269 6768        # The righ
+0000a440: 7420 626f 756e 6420 6973 206c 6573 7320  t bound is less 
+0000a450: 7468 616e 2074 6865 2074 6872 6573 686f  than the thresho
+0000a460: 6c64 0d0a 2020 2020 2020 2020 2020 2020  ld..            
+0000a470: 2020 2020 2020 2020 2864 665b 7365 6c66          (df[self
+0000a480: 2e72 6967 6874 5f62 6f75 6e64 5f63 6f6c  .right_bound_col
+0000a490: 5d20 3c20 7468 7265 7368 6f6c 6429 207c  ] < threshold) |
+0000a4a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a4b0: 2020 2020 2020 2320 5468 6520 7269 6768        # The righ
+0000a4c0: 7420 626f 756e 6420 6973 2065 7175 616c  t bound is equal
+0000a4d0: 2074 6f20 7468 6520 7468 7265 7368 6f6c   to the threshol
+0000a4e0: 6420 616e 6420 6f70 656e 0d0a 2020 2020  d and open..    
+0000a4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a500: 2828 6466 5b73 656c 662e 7269 6768 745f  ((df[self.right_
+0000a510: 626f 756e 645f 636f 6c5d 203d 3d20 7468  bound_col] == th
+0000a520: 7265 7368 6f6c 6429 2026 0d0a 2020 2020  reshold) &..    
+0000a530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a540: 2028 6466 5b73 656c 662e 7269 6768 745f   (df[self.right_
+0000a550: 626f 756e 6461 7279 5f63 6f6c 5d20 3d3d  boundary_col] ==
+0000a560: 2027 4f70 656e 2729 290d 0a20 2020 2020   'Open'))..     
+0000a570: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+0000a580: 2020 2020 2020 2020 2020 2020 2020 5d0d                ].
+0000a590: 0a20 2020 2020 2020 2023 2053 6574 2063  .        # Set c
+0000a5a0: 6f6e 6469 7469 6f6e 7320 7768 656e 2074  onditions when t
+0000a5b0: 6872 6573 686f 6c64 2069 7320 6e6f 7420  hreshold is not 
+0000a5c0: 616e 2065 7863 6565 6461 6e63 650d 0a20  an exceedance.. 
+0000a5d0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0000a5e0: 2020 2020 2020 2020 2020 2320 5365 7420            # Set 
+0000a5f0: 636f 6e64 6974 696f 6e73 2066 6f72 2065  conditions for e
+0000a600: 7863 6565 6461 6e63 6573 2061 6e64 206e  xceedances and n
+0000a610: 6f6e 2d65 7863 6565 6461 6e63 6573 0d0a  on-exceedances..
+0000a620: 2020 2020 2020 2020 2020 2020 636f 6e64              cond
+0000a630: 6974 696f 6e73 203d 205b 0d0a 2020 2020  itions = [..    
+0000a640: 2020 2020 2020 2020 2020 2020 2320 4578              # Ex
+0000a650: 6365 6564 616e 6365 7320 636f 6e64 6974  ceedances condit
+0000a660: 696f 6e73 0d0a 2020 2020 2020 2020 2020  ions..          
+0000a670: 2020 2020 2020 280d 0a20 2020 2020 2020        (..       
+0000a680: 2020 2020 2020 2020 2020 2020 2023 2054               # T
+0000a690: 6865 206c 6566 7420 626f 756e 6420 6973  he left bound is
+0000a6a0: 2067 7265 6174 6572 2074 6861 6e20 7468   greater than th
+0000a6b0: 6520 7468 7265 7368 6f6c 640d 0a20 2020  e threshold..   
+0000a6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a6d0: 2028 6466 5b73 656c 662e 6c65 6674 5f62   (df[self.left_b
+0000a6e0: 6f75 6e64 5f63 6f6c 5d20 3e20 7468 7265  ound_col] > thre
+0000a6f0: 7368 6f6c 6429 207c 0d0a 2020 2020 2020  shold) |..      
+0000a700: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0000a710: 4966 2074 6865 206c 6566 7420 626f 756e  If the left boun
+0000a720: 6420 6973 2065 7175 616c 2074 6f20 7468  d is equal to th
+0000a730: 6520 7468 7265 7368 6f6c 6420 616e 6420  e threshold and 
+0000a740: 6f70 656e 0d0a 2020 2020 2020 2020 2020  open..          
+0000a750: 2020 2020 2020 2020 2020 2828 6466 5b73            ((df[s
+0000a760: 656c 662e 6c65 6674 5f62 6f75 6e64 5f63  elf.left_bound_c
+0000a770: 6f6c 5d20 3d3d 2074 6872 6573 686f 6c64  ol] == threshold
+0000a780: 2920 260d 0a20 2020 2020 2020 2020 2020  ) &..           
+0000a790: 2020 2020 2020 2020 2020 2864 665b 7365            (df[se
+0000a7a0: 6c66 2e6c 6566 745f 626f 756e 6461 7279  lf.left_boundary
+0000a7b0: 5f63 6f6c 5d20 3d3d 2027 4f70 656e 2729  _col] == 'Open')
+0000a7c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000a7d0: 2020 2029 2c0d 0a20 2020 2020 2020 2020     ),..         
+0000a7e0: 2020 2020 2020 2023 204e 6f6e 2d65 7863         # Non-exc
+0000a7f0: 6565 6461 6e63 6520 636f 6e64 6974 696f  eedance conditio
+0000a800: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
+0000a810: 2020 2023 2054 6865 2072 6967 6874 2062     # The right b
+0000a820: 6f75 6e64 2069 7320 6c65 7373 2074 6861  ound is less tha
+0000a830: 6e20 6f72 2065 7175 616c 2074 6f20 7468  n or equal to th
+0000a840: 6520 7468 7265 7368 6f6c 640d 0a20 2020  e threshold..   
+0000a850: 2020 2020 2020 2020 2020 2020 2028 6466               (df
+0000a860: 5b73 656c 662e 7269 6768 745f 626f 756e  [self.right_boun
+0000a870: 645f 636f 6c5d 203c 3d20 7468 7265 7368  d_col] <= thresh
+0000a880: 6f6c 6429 0d0a 2020 2020 2020 2020 2020  old)..          
+0000a890: 2020 2020 2020 5d0d 0a20 2020 2020 2020        ]..       
+0000a8a0: 2023 2045 7863 6565 6461 6e63 6573 2061   # Exceedances a
+0000a8b0: 7265 2069 6e64 6963 6174 6564 2062 7920  re indicated by 
+0000a8c0: 696e 7465 6765 7273 0d0a 2020 2020 2020  integers..      
+0000a8d0: 2020 2320 2831 3d65 7863 6565 6461 6e63    # (1=exceedanc
+0000a8e0: 652c 2030 3d6e 6f6e 2d65 7863 6565 6461  e, 0=non-exceeda
+0000a8f0: 6e63 6529 0d0a 2020 2020 2020 2020 7265  nce)..        re
+0000a900: 7375 6c74 7320 3d20 5b0d 0a20 2020 2020  sults = [..     
+0000a910: 2020 2020 2020 2031 2c0d 0a20 2020 2020         1,..     
+0000a920: 2020 2020 2020 2030 0d0a 2020 2020 2020         0..      
+0000a930: 2020 2020 2020 5d0d 0a20 2020 2020 2020        ]..       
+0000a940: 2023 2044 6566 6175 6c74 2065 7863 6565   # Default excee
+0000a950: 6461 6e63 6520 286e 702e 6e61 6e3d 756e  dance (np.nan=un
+0000a960: 6b6e 6f77 6e29 0d0a 2020 2020 2020 2020  known)..        
+0000a970: 6466 5b73 656c 662e 6578 6365 6564 616e  df[self.exceedan
+0000a980: 6365 735f 636f 6c5d 203d 206e 702e 7365  ces_col] = np.se
+0000a990: 6c65 6374 2863 6f6e 6469 7469 6f6e 732c  lect(conditions,
+0000a9a0: 2072 6573 756c 7473 2c20 6e70 2e6e 616e   results, np.nan
+0000a9b0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+0000a9c0: 2020 2020 2023 2052 6570 6c61 6365 206f       # Replace o
+0000a9d0: 7220 7265 7475 726e 2072 6573 756c 740d  r return result.
+0000a9e0: 0a20 2020 2020 2020 2069 6620 696e 706c  .        if inpl
+0000a9f0: 6163 653a 0d0a 2020 2020 2020 2020 2020  ace:..          
+0000aa00: 2020 7365 6c66 2e64 6174 6120 3d20 6466    self.data = df
+0000aa10: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+0000aa20: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000aa30: 7572 6e20 6466 0d0a 2020 2020 0d0a 2020  urn df..    ..  
+0000aa40: 2020 2325 2520 5374 6174 6973 7469 6320    #%% Statistic 
+0000aa50: 6d65 7468 6f64 730d 0a20 2020 200d 0a20  methods..    .. 
+0000aa60: 2020 2064 6566 2067 656e 6572 616c 5f73     def general_s
+0000aa70: 7461 7428 7365 6c66 2c0d 0a20 2020 2020  tat(self,..     
+0000aa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aa90: 7374 6174 2c0d 0a20 2020 2020 2020 2020  stat,..         
+0000aaa0: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
+0000aab0: 7062 795f 636f 6c73 203d 204e 6f6e 652c  pby_cols = None,
+0000aac0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000aad0: 2020 2020 2020 2063 6f75 6e74 5f63 6f6c         count_col
+0000aae0: 7320 3d20 4e6f 6e65 2c0d 0a20 2020 2020  s = None,..     
+0000aaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ab00: 696e 706c 6163 6520 3d20 4661 6c73 650d  inplace = False.
+0000ab10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ab20: 2020 2020 2020 293a 0d0a 2020 2020 2020        ):..      
+0000ab30: 2020 0d0a 2020 2020 2020 2020 2320 4372    ..        # Cr
+0000ab40: 6561 7465 2061 2063 6f70 7920 6f66 2074  eate a copy of t
+0000ab50: 6865 2043 656e 736f 7265 6444 6174 6120  he CensoredData 
+0000ab60: 6f62 6a65 6374 0d0a 2020 2020 2020 2020  object..        
+0000ab70: 6364 6620 3d20 636f 7079 2e64 6565 7063  cdf = copy.deepc
+0000ab80: 6f70 7928 7365 6c66 290d 0a20 2020 2020  opy(self)..     
+0000ab90: 2020 200d 0a20 2020 2020 2020 2023 2049     ..        # I
+0000aba0: 6620 6e6f 2067 726f 7570 6279 5f63 6f6c  f no groupby_col
+0000abb0: 7320 7072 6f76 6964 6564 2c20 6361 6c63  s provided, calc
+0000abc0: 756c 6174 6520 7374 6174 2066 6f72 2066  ulate stat for f
+0000abd0: 756c 6c20 6461 7461 7365 740d 0a20 2020  ull dataset..   
+0000abe0: 2020 2020 2069 6620 6772 6f75 7062 795f       if groupby_
+0000abf0: 636f 6c73 203d 3d20 4e6f 6e65 3a0d 0a20  cols == None:.. 
+0000ac00: 2020 2020 2020 2020 2020 2073 7461 7428             stat(
+0000ac10: 6364 662c 205b 5d2c 2069 6e70 6c61 6365  cdf, [], inplace
+0000ac20: 203d 2054 7275 6529 0d0a 2020 2020 2020   = True)..      
+0000ac30: 2020 2320 4966 2067 726f 7570 6279 5f63    # If groupby_c
+0000ac40: 6f6c 7320 6973 2061 206c 6973 7420 6f66  ols is a list of
+0000ac50: 206c 6973 7473 2c20 7468 656e 2063 616c   lists, then cal
+0000ac60: 6375 6c61 7465 2073 7461 7420 666f 7220  culate stat for 
+0000ac70: 6561 6368 0d0a 2020 2020 2020 2020 2320  each..        # 
+0000ac80: 7365 7175 656e 7469 616c 2067 726f 7570  sequential group
+0000ac90: 0d0a 2020 2020 2020 2020 656c 6966 2069  ..        elif i
+0000aca0: 7369 6e73 7461 6e63 6528 6772 6f75 7062  sinstance(groupb
+0000acb0: 795f 636f 6c73 5b30 5d2c 206c 6973 7429  y_cols[0], list)
+0000acc0: 3a0d 0a20 2020 2020 2020 2020 2020 2066  :..            f
+0000acd0: 6f72 2067 726f 7570 696e 6720 696e 2067  or grouping in g
+0000ace0: 726f 7570 6279 5f63 6f6c 733a 0d0a 2020  roupby_cols:..  
+0000acf0: 2020 2020 2020 2020 2020 2020 2020 7374                st
+0000ad00: 6174 2863 6466 2c20 6772 6f75 7069 6e67  at(cdf, grouping
+0000ad10: 2c20 696e 706c 6163 6520 3d20 5472 7565  , inplace = True
+0000ad20: 290d 0a20 2020 2020 2020 2023 2049 6620  )..        # If 
+0000ad30: 7468 6520 6772 6f75 7062 795f 636f 6c73  the groupby_cols
+0000ad40: 2069 7320 6120 6c69 7374 206f 6620 636f   is a list of co
+0000ad50: 6c75 6d6e 206e 616d 6573 2c20 7468 656e  lumn names, then
+0000ad60: 2063 616c 6375 6c61 7465 2073 7461 740d   calculate stat.
+0000ad70: 0a20 2020 2020 2020 2023 2066 6f72 2065  .        # for e
+0000ad80: 6163 6820 6772 6f75 700d 0a20 2020 2020  ach group..     
+0000ad90: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+0000ada0: 6365 2867 726f 7570 6279 5f63 6f6c 732c  ce(groupby_cols,
+0000adb0: 206c 6973 7429 3a0d 0a20 2020 2020 2020   list):..       
+0000adc0: 2020 2020 2073 7461 7428 6364 662c 2067       stat(cdf, g
+0000add0: 726f 7570 6279 5f63 6f6c 732c 2069 6e70  roupby_cols, inp
+0000ade0: 6c61 6365 203d 2054 7275 6529 0d0a 2020  lace = True)..  
+0000adf0: 2020 2020 2020 2320 456c 7365 2075 6e65        # Else une
+0000ae00: 7870 6563 7465 6420 666f 726d 6174 2066  xpected format f
+0000ae10: 6f72 2067 726f 7570 6279 5f63 6f6c 730d  or groupby_cols.
+0000ae20: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0000ae30: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000ae40: 6520 5661 6c75 6545 7272 6f72 2827 5468  e ValueError('Th
+0000ae50: 6520 7661 6c75 6520 7072 6f76 6964 6564  e value provided
+0000ae60: 2066 6f72 2022 6772 6f75 7062 795f 636f   for "groupby_co
+0000ae70: 6c73 2220 6d75 7374 2062 6520 6120 270d  ls" must be a '.
+0000ae80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ae90: 2020 2020 2020 2020 2020 2020 2020 276c                'l
+0000aea0: 6973 7420 7261 7468 6572 2074 6861 6e20  ist rather than 
+0000aeb0: 7b74 7970 6528 6772 6f75 7062 795f 636f  {type(groupby_co
+0000aec0: 6c73 297d 2e27 290d 0a20 2020 2020 2020  ls)}.')..       
+0000aed0: 200d 0a20 2020 2020 2020 2023 2053 6574   ..        # Set
+0000aee0: 2066 6f63 7573 206f 6620 6869 6768 206f   focus of high o
+0000aef0: 7220 6c6f 770d 0a20 2020 2020 2020 2069  r low..        i
+0000af00: 6620 7374 6174 203d 3d20 4365 6e73 6f72  f stat == Censor
+0000af10: 6564 4461 7461 2e6d 6178 696d 756d 5f69  edData.maximum_i
+0000af20: 6e74 6572 7661 6c3a 0d0a 2020 2020 2020  nterval:..      
+0000af30: 2020 2020 2020 666f 6375 735f 6869 6768        focus_high
+0000af40: 5f70 6f74 656e 7469 616c 203d 2054 7275  _potential = Tru
+0000af50: 650d 0a20 2020 2020 2020 2065 6c69 6620  e..        elif 
+0000af60: 7374 6174 203d 3d20 4365 6e73 6f72 6564  stat == Censored
+0000af70: 4461 7461 2e6d 696e 696d 756d 5f69 6e74  Data.minimum_int
+0000af80: 6572 7661 6c3a 0d0a 2020 2020 2020 2020  erval:..        
+0000af90: 2020 2020 666f 6375 735f 6869 6768 5f70      focus_high_p
+0000afa0: 6f74 656e 7469 616c 203d 2046 616c 7365  otential = False
+0000afb0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+0000afc0: 0a20 2020 2020 2020 2020 2020 2066 6f63  .            foc
+0000afd0: 7573 5f68 6967 685f 706f 7465 6e74 6961  us_high_potentia
+0000afe0: 6c20 3d20 7365 6c66 2e66 6f63 7573 5f68  l = self.focus_h
+0000aff0: 6967 685f 706f 7465 6e74 6961 6c0d 0a20  igh_potential.. 
+0000b000: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000b010: 2023 2043 6f6e 7665 7274 2074 6865 2069   # Convert the i
+0000b020: 6e74 6572 7661 6c20 666f 7220 7468 6520  nterval for the 
+0000b030: 7374 6174 2069 6e74 6f20 6365 6e73 6f72  stat into censor
+0000b040: 2061 6e64 206e 756d 6572 6963 206e 6f74   and numeric not
+0000b050: 6174 696f 6e0d 0a20 2020 2020 2020 2063  ation..        c
+0000b060: 6466 2e63 6f6d 706f 6e65 6e74 735f 6672  df.components_fr
+0000b070: 6f6d 5f69 6e74 6572 7661 6c28 666f 6375  om_interval(focu
+0000b080: 735f 6869 6768 5f70 6f74 656e 7469 616c  s_high_potential
+0000b090: 2c20 696e 706c 6163 6520 3d20 5472 7565  , inplace = True
+0000b0a0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+0000b0b0: 2020 2020 2023 2043 7265 6174 6520 636f       # Create co
+0000b0c0: 6c75 6d6e 2077 6974 6820 696e 7465 7276  lumn with interv
+0000b0d0: 616c 206e 6f74 6174 696f 6e0d 0a20 2020  al notation..   
+0000b0e0: 2020 2020 2063 6466 2e69 6e74 6572 7661       cdf.interva
+0000b0f0: 6c5f 6e6f 7461 7469 6f6e 2869 6e70 6c61  l_notation(inpla
+0000b100: 6365 203d 2054 7275 6529 0d0a 2020 2020  ce = True)..    
+0000b110: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
+0000b120: 436f 6d62 696e 6520 7468 6520 6365 6e73  Combine the cens
+0000b130: 6f72 2061 6e64 206e 756d 6572 6963 2063  or and numeric c
+0000b140: 6f6d 706f 6e65 6e74 7320 696e 746f 2061  omponents into a
+0000b150: 2072 6573 756c 740d 0a20 2020 2020 2020   result..       
+0000b160: 2063 6466 2e72 6573 756c 745f 6672 6f6d   cdf.result_from
+0000b170: 5f63 6f6d 706f 6e65 6e74 7328 696e 706c  _components(inpl
+0000b180: 6163 6520 3d20 5472 7565 290d 0a20 2020  ace = True)..   
+0000b190: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+0000b1a0: 2052 656f 7264 6572 2063 6f6c 756d 6e73   Reorder columns
+0000b1b0: 0d0a 2020 2020 2020 2020 6f75 7470 7574  ..        output
+0000b1c0: 5f63 6f6c 7320 3d20 5b63 6466 2e73 7461  _cols = [cdf.sta
+0000b1d0: 745f 636f 6c2c 0d0a 2020 2020 2020 2020  t_col,..        
+0000b1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b1f0: 2020 6364 662e 7265 7375 6c74 5f63 6f6c    cdf.result_col
+0000b200: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000b210: 2020 2020 2020 2020 2020 2020 2063 6466               cdf
+0000b220: 2e63 656e 736f 725f 636f 6c2c 0d0a 2020  .censor_col,..  
+0000b230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b240: 2020 2020 2020 2020 6364 662e 6e75 6d65          cdf.nume
+0000b250: 7269 635f 636f 6c2c 0d0a 2020 2020 2020  ric_col,..      
+0000b260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b270: 2020 2020 6364 662e 696e 7465 7276 616c      cdf.interval
+0000b280: 5f63 6f6c 5d0d 0a20 2020 2020 2020 200d  _col]..        .
+0000b290: 0a20 2020 2020 2020 2069 6620 6772 6f75  .        if grou
+0000b2a0: 7062 795f 636f 6c73 203d 3d20 4e6f 6e65  pby_cols == None
+0000b2b0: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
+0000b2c0: 6466 2e64 6174 6120 3d20 6364 662e 6461  df.data = cdf.da
+0000b2d0: 7461 5b6f 7574 7075 745f 636f 6c73 5d0d  ta[output_cols].
+0000b2e0: 0a20 2020 2020 2020 2065 6c69 6620 2861  .        elif (a
+0000b2f0: 6c6c 2869 7369 6e73 7461 6e63 6528 6e61  ll(isinstance(na
+0000b300: 6d65 2c20 7374 7229 2066 6f72 206e 616d  me, str) for nam
+0000b310: 6520 696e 2067 726f 7570 6279 5f63 6f6c  e in groupby_col
+0000b320: 7329 293a 0d0a 2020 2020 2020 2020 2020  s)):..          
+0000b330: 2020 6364 662e 6461 7461 203d 2063 6466    cdf.data = cdf
+0000b340: 2e64 6174 615b 6772 6f75 7062 795f 636f  .data[groupby_co
+0000b350: 6c73 202b 206f 7574 7075 745f 636f 6c73  ls + output_cols
+0000b360: 5d0d 0a20 2020 2020 2020 2065 6c73 653a  ]..        else:
+0000b370: 0d0a 2020 2020 2020 2020 2020 2020 6364  ..            cd
+0000b380: 662e 6461 7461 203d 2063 6466 2e64 6174  f.data = cdf.dat
+0000b390: 615b 6772 6f75 7062 795f 636f 6c73 5b2d  a[groupby_cols[-
+0000b3a0: 315d 202b 206f 7574 7075 745f 636f 6c73  1] + output_cols
+0000b3b0: 5d0d 0a20 2020 2020 2020 200d 0a20 2020  ]..        ..   
+0000b3c0: 2020 2020 2023 204d 6572 6765 2063 6f75       # Merge cou
+0000b3d0: 6e74 2069 6e66 6f0d 0a20 2020 2020 2020  nt info..       
+0000b3e0: 2069 6620 636f 756e 745f 636f 6c73 2021   if count_cols !
+0000b3f0: 3d20 4e6f 6e65 3a0d 0a20 2020 2020 2020  = None:..       
+0000b400: 2020 2020 2063 6466 2e64 6174 6120 3d20       cdf.data = 
+0000b410: 7365 6c66 2e6d 6572 6765 5f63 6f75 6e74  self.merge_count
+0000b420: 7328 6364 662e 6461 7461 2c0d 0a20 2020  s(cdf.data,..   
+0000b430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b450: 2020 2020 2020 636f 756e 745f 636f 6c73        count_cols
+0000b460: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000b470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b480: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
+0000b490: 7062 795f 636f 6c73 290d 0a20 2020 2020  pby_cols)..     
+0000b4a0: 2020 200d 0a20 2020 2020 2020 2023 2052     ..        # R
+0000b4b0: 6570 6c61 6365 206f 7220 7265 7475 726e  eplace or return
+0000b4c0: 2072 6573 756c 740d 0a20 2020 2020 2020   result..       
+0000b4d0: 2069 6620 696e 706c 6163 653a 0d0a 2020   if inplace:..  
+0000b4e0: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
+0000b4f0: 6174 6120 3d20 6364 662e 6461 7461 0d0a  ata = cdf.data..
+0000b500: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0000b510: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000b520: 6e20 6364 662e 6461 7461 0d0a 2020 2020  n cdf.data..    
+0000b530: 0d0a 2020 2020 6465 6620 6d61 7869 6d75  ..    def maximu
+0000b540: 6d28 7365 6c66 2c0d 0a20 2020 2020 2020  m(self,..       
+0000b550: 2020 2020 2020 2020 2067 726f 7570 6279           groupby
+0000b560: 5f63 6f6c 7320 3d20 4e6f 6e65 2c0d 0a20  _cols = None,.. 
+0000b570: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000b580: 6f75 6e74 5f63 6f6c 7320 3d20 4e6f 6e65  ount_cols = None
+0000b590: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000b5a0: 2020 2069 6e70 6c61 6365 203d 2046 616c     inplace = Fal
+0000b5b0: 7365 293a 0d0a 2020 2020 2020 2020 0d0a  se):..        ..
+0000b5c0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000b5d0: 656c 662e 6765 6e65 7261 6c5f 7374 6174  elf.general_stat
+0000b5e0: 2843 656e 736f 7265 6444 6174 612e 6d61  (CensoredData.ma
+0000b5f0: 7869 6d75 6d5f 696e 7465 7276 616c 2c0d  ximum_interval,.
+0000b600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b620: 2020 6772 6f75 7062 795f 636f 6c73 2c0d    groupby_cols,.
+0000b630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b650: 2020 636f 756e 745f 636f 6c73 2c0d 0a20    count_cols,.. 
 0000b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b670: 636f 756e 745f 636f 6c73 2c0d 0a20 2020  count_cols,..   
-0000b680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b690: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0000b6a0: 706c 6163 6529 0d0a 2020 2020 0d0a 2020  place)..    ..  
-0000b6b0: 2020 6465 6620 6d69 6e69 6d75 6d28 7365    def minimum(se
-0000b6c0: 6c66 2c0d 0a20 2020 2020 2020 2020 2020  lf,..           
-0000b6d0: 2020 2020 2067 726f 7570 6279 5f63 6f6c       groupby_col
-0000b6e0: 7320 3d20 4e6f 6e65 2c0d 0a20 2020 2020  s = None,..     
-0000b6f0: 2020 2020 2020 2020 2020 2063 6f75 6e74             count
-0000b700: 5f63 6f6c 7320 3d20 4e6f 6e65 2c0d 0a20  _cols = None,.. 
-0000b710: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000b720: 6e70 6c61 6365 203d 2046 616c 7365 293a  nplace = False):
-0000b730: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0000b740: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000b750: 6765 6e65 7261 6c5f 7374 6174 2843 656e  general_stat(Cen
-0000b760: 736f 7265 6444 6174 612e 6d69 6e69 6d75  soredData.minimu
-0000b770: 6d5f 696e 7465 7276 616c 2c0d 0a20 2020  m_interval,..   
-0000b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b790: 2020 2020 2020 2020 2020 2020 2020 6772                gr
-0000b7a0: 6f75 7062 795f 636f 6c73 2c0d 0a20 2020  oupby_cols,..   
-0000b7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b7c0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0000b7d0: 756e 745f 636f 6c73 2c0d 0a20 2020 2020  unt_cols,..     
-0000b7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b7f0: 2020 2020 2020 2020 2020 2020 696e 706c              inpl
-0000b800: 6163 6529 0d0a 2020 2020 0d0a 2020 2020  ace)..    ..    
-0000b810: 6465 6620 6d65 616e 2873 656c 662c 0d0a  def mean(self,..
-0000b820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b830: 6772 6f75 7062 795f 636f 6c73 203d 204e  groupby_cols = N
-0000b840: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-0000b850: 2020 2020 2020 636f 756e 745f 636f 6c73        count_cols
-0000b860: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
-0000b870: 2020 2020 2020 2020 2020 696e 706c 6163            inplac
-0000b880: 6520 3d20 4661 6c73 6529 3a0d 0a20 2020  e = False):..   
-0000b890: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
-0000b8a0: 6574 7572 6e20 7365 6c66 2e67 656e 6572  eturn self.gener
-0000b8b0: 616c 5f73 7461 7428 4365 6e73 6f72 6564  al_stat(Censored
-0000b8c0: 4461 7461 2e6d 6561 6e5f 696e 7465 7276  Data.mean_interv
-0000b8d0: 616c 2c0d 0a20 2020 2020 2020 2020 2020  al,..           
-0000b8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b8f0: 2020 2020 2020 6772 6f75 7062 795f 636f        groupby_co
-0000b900: 6c73 2c0d 0a20 2020 2020 2020 2020 2020  ls,..           
-0000b910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b920: 2020 2020 2020 636f 756e 745f 636f 6c73        count_cols
-0000b930: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0000b940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b950: 2020 2020 696e 706c 6163 6529 0d0a 2020      inplace)..  
-0000b960: 2020 0d0a 2020 2020 6465 6620 6164 6428    ..    def add(
-0000b970: 7365 6c66 2c0d 0a20 2020 2020 2020 2020  self,..         
-0000b980: 2020 2020 2020 2067 726f 7570 6279 5f63         groupby_c
-0000b990: 6f6c 7320 3d20 4e6f 6e65 2c0d 0a20 2020  ols = None,..   
-0000b9a0: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
-0000b9b0: 6e74 5f63 6f6c 7320 3d20 4e6f 6e65 2c0d  nt_cols = None,.
-0000b9c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b9d0: 2069 6e70 6c61 6365 203d 2046 616c 7365   inplace = False
-0000b9e0: 293a 0d0a 2020 2020 2020 2020 0d0a 2020  ):..        ..  
-0000b9f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000ba00: 662e 6765 6e65 7261 6c5f 7374 6174 2843  f.general_stat(C
-0000ba10: 656e 736f 7265 6444 6174 612e 6164 645f  ensoredData.add_
-0000ba20: 696e 7465 7276 616c 2c0d 0a20 2020 2020  interval,..     
-0000ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ba40: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
-0000ba50: 7062 795f 636f 6c73 2c0d 0a20 2020 2020  pby_cols,..     
-0000ba60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ba70: 2020 2020 2020 2020 2020 2020 636f 756e              coun
-0000ba80: 745f 636f 6c73 2c0d 0a20 2020 2020 2020  t_cols,..       
-0000ba90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000baa0: 2020 2020 2020 2020 2020 696e 706c 6163            inplac
-0000bab0: 6529 0d0a 2020 2020 2020 2020 0d0a 2020  e)..        ..  
-0000bac0: 2020 6465 6620 7065 7263 656e 7469 6c65    def percentile
-0000bad0: 2873 656c 662c 0d0a 2020 2020 2020 2020  (self,..        
-0000bae0: 2020 2020 2020 2020 2020 2067 726f 7570             group
-0000baf0: 6279 5f63 6f6c 7320 3d20 4e6f 6e65 2c0d  by_cols = None,.
-0000bb00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bb10: 2020 2020 636f 756e 745f 636f 6c73 203d      count_cols =
-0000bb20: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-0000bb30: 2020 2020 2020 2020 2020 2070 6572 6365             perce
-0000bb40: 6e74 696c 6520 3d20 4e6f 6e65 2c0d 0a20  ntile = None,.. 
-0000bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb60: 2020 6d65 7468 6f64 203d 2027 6861 7a65    method = 'haze
-0000bb70: 6e27 2c0d 0a20 2020 2020 2020 2020 2020  n',..           
-0000bb80: 2020 2020 2020 2020 696e 706c 6163 6520          inplace 
-0000bb90: 3d20 4661 6c73 650d 0a20 2020 2020 2020  = False..       
-0000bba0: 2020 2020 2020 2020 2020 2020 293a 0d0a              ):..
-0000bbb0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000bbc0: 2020 2320 4372 6561 7465 2061 2063 6f70    # Create a cop
-0000bbd0: 7920 6f66 2074 6865 2043 656e 736f 7265  y of the Censore
-0000bbe0: 6444 6174 6120 6f62 6a65 6374 0d0a 2020  dData object..  
-0000bbf0: 2020 2020 2020 6364 6620 3d20 636f 7079        cdf = copy
-0000bc00: 2e64 6565 7063 6f70 7928 7365 6c66 290d  .deepcopy(self).
-0000bc10: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0000bc20: 2020 2023 2043 6865 636b 2066 6f72 2070     # Check for p
-0000bc30: 6572 6365 6e74 696c 650d 0a20 2020 2020  ercentile..     
-0000bc40: 2020 2069 6620 2870 6572 6365 6e74 696c     if (percentil
-0000bc50: 6520 3e20 3130 3029 207c 2028 7065 7263  e > 100) | (perc
-0000bc60: 656e 7469 6c65 203c 2030 293a 0d0a 2020  entile < 0):..  
-0000bc70: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000bc80: 5661 6c75 6545 7272 6f72 2827 5468 6520  ValueError('The 
-0000bc90: 7065 7263 656e 7469 6c65 206d 7573 7420  percentile must 
-0000bca0: 6265 2062 6574 7765 656e 2030 2061 6e64  be between 0 and
-0000bcb0: 2031 3030 2e27 290d 0a20 2020 2020 2020   100.')..       
-0000bcc0: 200d 0a20 2020 2020 2020 2023 2049 6620   ..        # If 
-0000bcd0: 6e6f 2067 726f 7570 6279 5f63 6f6c 7320  no groupby_cols 
-0000bce0: 7072 6f76 6964 6564 2c20 6361 6c63 756c  provided, calcul
-0000bcf0: 6174 6520 7374 6174 2066 6f72 2066 756c  ate stat for ful
-0000bd00: 6c20 6461 7461 7365 740d 0a20 2020 2020  l dataset..     
-0000bd10: 2020 2069 6620 6772 6f75 7062 795f 636f     if groupby_co
-0000bd20: 6c73 203d 3d20 4e6f 6e65 3a0d 0a20 2020  ls == None:..   
-0000bd30: 2020 2020 2020 2020 2063 6466 2e70 6572           cdf.per
-0000bd40: 6365 6e74 696c 655f 696e 7465 7276 616c  centile_interval
-0000bd50: 2867 726f 7570 6279 5f63 6f6c 732c 0d0a  (groupby_cols,..
-0000bd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bd80: 2020 2020 7065 7263 656e 7469 6c65 2c0d      percentile,.
-0000bd90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b680: 696e 706c 6163 6529 0d0a 2020 2020 0d0a  inplace)..    ..
+0000b690: 2020 2020 6465 6620 6d69 6e69 6d75 6d28      def minimum(
+0000b6a0: 7365 6c66 2c0d 0a20 2020 2020 2020 2020  self,..         
+0000b6b0: 2020 2020 2020 2067 726f 7570 6279 5f63         groupby_c
+0000b6c0: 6f6c 7320 3d20 4e6f 6e65 2c0d 0a20 2020  ols = None,..   
+0000b6d0: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
+0000b6e0: 6e74 5f63 6f6c 7320 3d20 4e6f 6e65 2c0d  nt_cols = None,.
+0000b6f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b700: 2069 6e70 6c61 6365 203d 2046 616c 7365   inplace = False
+0000b710: 293a 0d0a 2020 2020 2020 2020 0d0a 2020  ):..        ..  
+0000b720: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000b730: 662e 6765 6e65 7261 6c5f 7374 6174 2843  f.general_stat(C
+0000b740: 656e 736f 7265 6444 6174 612e 6d69 6e69  ensoredData.mini
+0000b750: 6d75 6d5f 696e 7465 7276 616c 2c0d 0a20  mum_interval,.. 
+0000b760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b780: 6772 6f75 7062 795f 636f 6c73 2c0d 0a20  groupby_cols,.. 
+0000b790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b7b0: 636f 756e 745f 636f 6c73 2c0d 0a20 2020  count_cols,..   
+0000b7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b7d0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0000b7e0: 706c 6163 6529 0d0a 2020 2020 0d0a 2020  place)..    ..  
+0000b7f0: 2020 6465 6620 6d65 616e 2873 656c 662c    def mean(self,
+0000b800: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000b810: 2020 6772 6f75 7062 795f 636f 6c73 203d    groupby_cols =
+0000b820: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
+0000b830: 2020 2020 2020 2020 636f 756e 745f 636f          count_co
+0000b840: 6c73 203d 204e 6f6e 652c 0d0a 2020 2020  ls = None,..    
+0000b850: 2020 2020 2020 2020 2020 2020 696e 706c              inpl
+0000b860: 6163 6520 3d20 4661 6c73 6529 3a0d 0a20  ace = False):.. 
+0000b870: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000b880: 2072 6574 7572 6e20 7365 6c66 2e67 656e   return self.gen
+0000b890: 6572 616c 5f73 7461 7428 4365 6e73 6f72  eral_stat(Censor
+0000b8a0: 6564 4461 7461 2e6d 6561 6e5f 696e 7465  edData.mean_inte
+0000b8b0: 7276 616c 2c0d 0a20 2020 2020 2020 2020  rval,..         
+0000b8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b8d0: 2020 2020 2020 2020 6772 6f75 7062 795f          groupby_
+0000b8e0: 636f 6c73 2c0d 0a20 2020 2020 2020 2020  cols,..         
+0000b8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b900: 2020 2020 2020 2020 636f 756e 745f 636f          count_co
+0000b910: 6c73 2c0d 0a20 2020 2020 2020 2020 2020  ls,..           
+0000b920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b930: 2020 2020 2020 696e 706c 6163 6529 0d0a        inplace)..
+0000b940: 2020 2020 0d0a 2020 2020 6465 6620 6164      ..    def ad
+0000b950: 6428 7365 6c66 2c0d 0a20 2020 2020 2020  d(self,..       
+0000b960: 2020 2020 2020 2020 2067 726f 7570 6279           groupby
+0000b970: 5f63 6f6c 7320 3d20 4e6f 6e65 2c0d 0a20  _cols = None,.. 
+0000b980: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000b990: 6f75 6e74 5f63 6f6c 7320 3d20 4e6f 6e65  ount_cols = None
+0000b9a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000b9b0: 2020 2069 6e70 6c61 6365 203d 2046 616c     inplace = Fal
+0000b9c0: 7365 293a 0d0a 2020 2020 2020 2020 0d0a  se):..        ..
+0000b9d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000b9e0: 656c 662e 6765 6e65 7261 6c5f 7374 6174  elf.general_stat
+0000b9f0: 2843 656e 736f 7265 6444 6174 612e 6164  (CensoredData.ad
+0000ba00: 645f 696e 7465 7276 616c 2c0d 0a20 2020  d_interval,..   
+0000ba10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ba20: 2020 2020 2020 2020 2020 2020 2020 6772                gr
+0000ba30: 6f75 7062 795f 636f 6c73 2c0d 0a20 2020  oupby_cols,..   
+0000ba40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ba50: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0000ba60: 756e 745f 636f 6c73 2c0d 0a20 2020 2020  unt_cols,..     
+0000ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ba80: 2020 2020 2020 2020 2020 2020 696e 706c              inpl
+0000ba90: 6163 6529 0d0a 2020 2020 2020 2020 0d0a  ace)..        ..
+0000baa0: 2020 2020 6465 6620 7065 7263 656e 7469      def percenti
+0000bab0: 6c65 2873 656c 662c 0d0a 2020 2020 2020  le(self,..      
+0000bac0: 2020 2020 2020 2020 2020 2020 2067 726f               gro
+0000bad0: 7570 6279 5f63 6f6c 7320 3d20 4e6f 6e65  upby_cols = None
+0000bae0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000baf0: 2020 2020 2020 636f 756e 745f 636f 6c73        count_cols
+0000bb00: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
+0000bb10: 2020 2020 2020 2020 2020 2020 2070 6572               per
+0000bb20: 6365 6e74 696c 6520 3d20 4e6f 6e65 2c0d  centile = None,.
+0000bb30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000bb40: 2020 2020 6d65 7468 6f64 203d 2027 6861      method = 'ha
+0000bb50: 7a65 6e27 2c0d 0a20 2020 2020 2020 2020  zen',..         
+0000bb60: 2020 2020 2020 2020 2020 696e 706c 6163            inplac
+0000bb70: 6520 3d20 4661 6c73 650d 0a20 2020 2020  e = False..     
+0000bb80: 2020 2020 2020 2020 2020 2020 2020 293a                ):
+0000bb90: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0000bba0: 2020 2020 2320 4372 6561 7465 2061 2063      # Create a c
+0000bbb0: 6f70 7920 6f66 2074 6865 2043 656e 736f  opy of the Censo
+0000bbc0: 7265 6444 6174 6120 6f62 6a65 6374 0d0a  redData object..
+0000bbd0: 2020 2020 2020 2020 6364 6620 3d20 636f          cdf = co
+0000bbe0: 7079 2e64 6565 7063 6f70 7928 7365 6c66  py.deepcopy(self
+0000bbf0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+0000bc00: 2020 2020 2023 2043 6865 636b 2066 6f72       # Check for
+0000bc10: 2070 6572 6365 6e74 696c 650d 0a20 2020   percentile..   
+0000bc20: 2020 2020 2069 6620 2870 6572 6365 6e74       if (percent
+0000bc30: 696c 6520 3e20 3130 3029 207c 2028 7065  ile > 100) | (pe
+0000bc40: 7263 656e 7469 6c65 203c 2030 293a 0d0a  rcentile < 0):..
+0000bc50: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000bc60: 6520 5661 6c75 6545 7272 6f72 2827 5468  e ValueError('Th
+0000bc70: 6520 7065 7263 656e 7469 6c65 206d 7573  e percentile mus
+0000bc80: 7420 6265 2062 6574 7765 656e 2030 2061  t be between 0 a
+0000bc90: 6e64 2031 3030 2e27 290d 0a20 2020 2020  nd 100.')..     
+0000bca0: 2020 200d 0a20 2020 2020 2020 2023 2049     ..        # I
+0000bcb0: 6620 6e6f 2067 726f 7570 6279 5f63 6f6c  f no groupby_col
+0000bcc0: 7320 7072 6f76 6964 6564 2c20 6361 6c63  s provided, calc
+0000bcd0: 756c 6174 6520 7374 6174 2066 6f72 2066  ulate stat for f
+0000bce0: 756c 6c20 6461 7461 7365 740d 0a20 2020  ull dataset..   
+0000bcf0: 2020 2020 2069 6620 6772 6f75 7062 795f       if groupby_
+0000bd00: 636f 6c73 203d 3d20 4e6f 6e65 3a0d 0a20  cols == None:.. 
+0000bd10: 2020 2020 2020 2020 2020 2063 6466 2e70             cdf.p
+0000bd20: 6572 6365 6e74 696c 655f 696e 7465 7276  ercentile_interv
+0000bd30: 616c 2867 726f 7570 6279 5f63 6f6c 732c  al(groupby_cols,
+0000bd40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000bd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bd60: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
+0000bd70: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000bd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bd90: 2020 2020 2020 206d 6574 686f 642c 0d0a         method,..
 0000bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bdb0: 2020 2020 206d 6574 686f 642c 0d0a 2020       method,..  
-0000bdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bde0: 2020 696e 706c 6163 6520 3d20 5472 7565    inplace = True
-0000bdf0: 290d 0a20 2020 2020 2020 2023 2049 6620  )..        # If 
-0000be00: 6772 6f75 7062 795f 636f 6c73 2069 7320  groupby_cols is 
-0000be10: 6120 6c69 7374 206f 6620 6c69 7374 732c  a list of lists,
-0000be20: 2074 6865 6e20 6361 6c63 756c 6174 6520   then calculate 
-0000be30: 7374 6174 2066 6f72 2065 6163 680d 0a20  stat for each.. 
-0000be40: 2020 2020 2020 2023 2073 6571 7565 6e74         # sequent
-0000be50: 6961 6c20 6772 6f75 702c 2075 7365 206d  ial group, use m
-0000be60: 6564 6961 6e20 666f 7220 616c 6c20 6275  edian for all bu
-0000be70: 7420 6c61 7374 2067 726f 7570 0d0a 2020  t last group..  
-0000be80: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-0000be90: 7461 6e63 6528 6772 6f75 7062 795f 636f  tance(groupby_co
-0000bea0: 6c73 5b30 5d2c 206c 6973 7429 3a0d 0a20  ls[0], list):.. 
-0000beb0: 2020 2020 2020 2020 2020 2066 6f72 2067             for g
-0000bec0: 726f 7570 696e 6720 696e 2067 726f 7570  rouping in group
-0000bed0: 6279 5f63 6f6c 733a 0d0a 2020 2020 2020  by_cols:..      
-0000bee0: 2020 2020 2020 2020 2020 6966 2067 726f            if gro
-0000bef0: 7570 696e 6720 3d3d 2067 726f 7570 6279  uping == groupby
-0000bf00: 5f63 6f6c 735b 2d31 5d3a 0d0a 2020 2020  _cols[-1]:..    
-0000bf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bf20: 6364 662e 7065 7263 656e 7469 6c65 5f69  cdf.percentile_i
-0000bf30: 6e74 6572 7661 6c28 6772 6f75 7069 6e67  nterval(grouping
-0000bf40: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0000bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bf60: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000bf70: 6572 6365 6e74 696c 652c 0d0a 2020 2020  ercentile,..    
-0000bf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bfa0: 2020 2020 2020 2020 6d65 7468 6f64 2c0d          method,.
-0000bfb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bfd0: 2020 2020 2020 2020 2020 2020 2069 6e70               inp
-0000bfe0: 6c61 6365 3d54 7275 6529 0d0a 2020 2020  lace=True)..    
-0000bff0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0000c000: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0000c010: 2020 2020 2020 2063 6466 2e70 6572 6365         cdf.perce
-0000c020: 6e74 696c 655f 696e 7465 7276 616c 2867  ntile_interval(g
-0000c030: 726f 7570 696e 672c 0d0a 2020 2020 2020  rouping,..      
-0000c040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bdc0: 2020 2020 696e 706c 6163 6520 3d20 5472      inplace = Tr
+0000bdd0: 7565 290d 0a20 2020 2020 2020 2023 2049  ue)..        # I
+0000bde0: 6620 6772 6f75 7062 795f 636f 6c73 2069  f groupby_cols i
+0000bdf0: 7320 6120 6c69 7374 206f 6620 6c69 7374  s a list of list
+0000be00: 732c 2074 6865 6e20 6361 6c63 756c 6174  s, then calculat
+0000be10: 6520 7374 6174 2066 6f72 2065 6163 680d  e stat for each.
+0000be20: 0a20 2020 2020 2020 2023 2073 6571 7565  .        # seque
+0000be30: 6e74 6961 6c20 6772 6f75 702c 2075 7365  ntial group, use
+0000be40: 206d 6564 6961 6e20 666f 7220 616c 6c20   median for all 
+0000be50: 6275 7420 6c61 7374 2067 726f 7570 0d0a  but last group..
+0000be60: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+0000be70: 6e73 7461 6e63 6528 6772 6f75 7062 795f  nstance(groupby_
+0000be80: 636f 6c73 5b30 5d2c 206c 6973 7429 3a0d  cols[0], list):.
+0000be90: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0000bea0: 2067 726f 7570 696e 6720 696e 2067 726f   grouping in gro
+0000beb0: 7570 6279 5f63 6f6c 733a 0d0a 2020 2020  upby_cols:..    
+0000bec0: 2020 2020 2020 2020 2020 2020 6966 2067              if g
+0000bed0: 726f 7570 696e 6720 3d3d 2067 726f 7570  rouping == group
+0000bee0: 6279 5f63 6f6c 735b 2d31 5d3a 0d0a 2020  by_cols[-1]:..  
+0000bef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bf00: 2020 6364 662e 7065 7263 656e 7469 6c65    cdf.percentile
+0000bf10: 5f69 6e74 6572 7661 6c28 6772 6f75 7069  _interval(groupi
+0000bf20: 6e67 2c0d 0a20 2020 2020 2020 2020 2020  ng,..           
+0000bf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bf50: 2070 6572 6365 6e74 696c 652c 0d0a 2020   percentile,..  
+0000bf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bf80: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+0000bf90: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bfb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000bfc0: 6e70 6c61 6365 3d54 7275 6529 0d0a 2020  nplace=True)..  
+0000bfd0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0000bfe0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0000bff0: 2020 2020 2020 2020 2063 6466 2e70 6572           cdf.per
+0000c000: 6365 6e74 696c 655f 696e 7465 7276 616c  centile_interval
+0000c010: 2867 726f 7570 696e 672c 0d0a 2020 2020  (grouping,..    
+0000c020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c040: 2020 2020 2020 2020 3530 2c0d 0a20 2020          50,..   
 0000c050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c060: 2020 2020 2020 3530 2c0d 0a20 2020 2020        50,..     
-0000c070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c090: 2020 2020 2020 206d 6574 686f 642c 0d0a         method,..
-0000c0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c0c0: 2020 2020 2020 2020 2020 2020 696e 706c              inpl
-0000c0d0: 6163 653d 5472 7565 290d 0a20 2020 2020  ace=True)..     
-0000c0e0: 2020 2023 2049 6620 7468 6520 6772 6f75     # If the grou
-0000c0f0: 7062 795f 636f 6c73 2069 7320 6120 6c69  pby_cols is a li
-0000c100: 7374 206f 6620 636f 6c75 6d6e 206e 616d  st of column nam
-0000c110: 6573 2c20 7468 656e 2063 616c 6375 6c61  es, then calcula
-0000c120: 7465 2073 7461 740d 0a20 2020 2020 2020  te stat..       
-0000c130: 2023 2066 6f72 2065 6163 6820 6772 6f75   # for each grou
-0000c140: 700d 0a20 2020 2020 2020 2065 6c69 6620  p..        elif 
-0000c150: 6973 696e 7374 616e 6365 2867 726f 7570  isinstance(group
-0000c160: 6279 5f63 6f6c 732c 206c 6973 7429 3a0d  by_cols, list):.
-0000c170: 0a20 2020 2020 2020 2020 2020 2063 6466  .            cdf
-0000c180: 2e70 6572 6365 6e74 696c 655f 696e 7465  .percentile_inte
-0000c190: 7276 616c 2867 726f 7570 6279 5f63 6f6c  rval(groupby_col
-0000c1a0: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
-0000c1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c1c0: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
-0000c1d0: 6c65 2c0d 0a20 2020 2020 2020 2020 2020  le,..           
-0000c1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c1f0: 2020 2020 2020 2020 206d 6574 686f 642c           method,
-0000c200: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000c210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c220: 2020 2020 2020 696e 706c 6163 653d 5472        inplace=Tr
-0000c230: 7565 290d 0a20 2020 2020 2020 2023 2045  ue)..        # E
-0000c240: 6c73 6520 756e 6578 7065 6374 6564 2066  lse unexpected f
-0000c250: 6f72 6d61 7420 666f 7220 6772 6f75 7062  ormat for groupb
-0000c260: 795f 636f 6c73 0d0a 2020 2020 2020 2020  y_cols..        
-0000c270: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0000c280: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0000c290: 726f 7228 2754 6865 2076 616c 7565 2070  ror('The value p
-0000c2a0: 726f 7669 6465 6420 666f 7220 2267 726f  rovided for "gro
-0000c2b0: 7570 6279 5f63 6f6c 7322 206d 7573 7420  upby_cols" must 
-0000c2c0: 6265 2061 2027 0d0a 2020 2020 2020 2020  be a '..        
-0000c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c2e0: 2020 2020 2027 6c69 7374 2072 6174 6865       'list rathe
-0000c2f0: 7220 7468 616e 207b 7479 7065 2867 726f  r than {type(gro
-0000c300: 7570 6279 5f63 6f6c 7329 7d2e 2729 0d0a  upby_cols)}.')..
-0000c310: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000c320: 2020 2320 436f 6e76 6572 7420 7468 6520    # Convert the 
-0000c330: 696e 7465 7276 616c 2066 6f72 2074 6865  interval for the
-0000c340: 2073 7461 7420 696e 746f 2063 656e 736f   stat into censo
-0000c350: 7220 616e 6420 6e75 6d65 7269 6320 6e6f  r and numeric no
-0000c360: 7461 7469 6f6e 0d0a 2020 2020 2020 2020  tation..        
-0000c370: 6364 662e 636f 6d70 6f6e 656e 7473 5f66  cdf.components_f
-0000c380: 726f 6d5f 696e 7465 7276 616c 2863 6466  rom_interval(cdf
-0000c390: 2e66 6f63 7573 5f68 6967 685f 706f 7465  .focus_high_pote
-0000c3a0: 6e74 6961 6c2c 2069 6e70 6c61 6365 203d  ntial, inplace =
-0000c3b0: 2054 7275 6529 0d0a 2020 2020 2020 2020   True)..        
-0000c3c0: 0d0a 2020 2020 2020 2020 2320 4372 6561  ..        # Crea
-0000c3d0: 7465 2063 6f6c 756d 6e20 7769 7468 2069  te column with i
-0000c3e0: 6e74 6572 7661 6c20 6e6f 7461 7469 6f6e  nterval notation
-0000c3f0: 0d0a 2020 2020 2020 2020 6364 662e 696e  ..        cdf.in
-0000c400: 7465 7276 616c 5f6e 6f74 6174 696f 6e28  terval_notation(
-0000c410: 696e 706c 6163 6520 3d20 5472 7565 290d  inplace = True).
-0000c420: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0000c430: 2020 2023 2043 6f6d 6269 6e65 2074 6865     # Combine the
-0000c440: 2063 656e 736f 7220 616e 6420 6e75 6d65   censor and nume
-0000c450: 7269 6320 636f 6d70 6f6e 656e 7473 2069  ric components i
-0000c460: 6e74 6f20 6120 7265 7375 6c74 0d0a 2020  nto a result..  
-0000c470: 2020 2020 2020 6364 662e 7265 7375 6c74        cdf.result
-0000c480: 5f66 726f 6d5f 636f 6d70 6f6e 656e 7473  _from_components
-0000c490: 2869 6e70 6c61 6365 203d 2054 7275 6529  (inplace = True)
-0000c4a0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0000c4b0: 2020 2020 6364 662e 6461 7461 5b63 6466      cdf.data[cdf
-0000c4c0: 2e72 6573 756c 745f 636f 6c5d 202b 3d20  .result_col] += 
-0000c4d0: 6364 662e 6461 7461 5b27 5f5f 5761 726e  cdf.data['__Warn
-0000c4e0: 696e 675f 5f27 5d0d 0a20 2020 2020 2020  ing__']..       
-0000c4f0: 200d 0a20 2020 2020 2020 2023 2052 656f   ..        # Reo
-0000c500: 7264 6572 2063 6f6c 756d 6e73 0d0a 2020  rder columns..  
-0000c510: 2020 2020 2020 6f75 7470 7574 5f63 6f6c        output_col
-0000c520: 7320 3d20 5b63 6466 2e73 7461 745f 636f  s = [cdf.stat_co
-0000c530: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
-0000c540: 2020 2020 2020 2020 2020 2020 2020 6364                cd
-0000c550: 662e 7265 7375 6c74 5f63 6f6c 2c0d 0a20  f.result_col,.. 
-0000c560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c570: 2020 2020 2020 2020 2063 6466 2e63 656e           cdf.cen
-0000c580: 736f 725f 636f 6c2c 0d0a 2020 2020 2020  sor_col,..      
-0000c590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c5a0: 2020 2020 6364 662e 6e75 6d65 7269 635f      cdf.numeric_
-0000c5b0: 636f 6c2c 0d0a 2020 2020 2020 2020 2020  col,..          
-0000c5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c5d0: 6364 662e 696e 7465 7276 616c 5f63 6f6c  cdf.interval_col
-0000c5e0: 5d0d 0a20 2020 2020 2020 200d 0a20 2020  ]..        ..   
-0000c5f0: 2020 2020 2069 6620 6772 6f75 7062 795f       if groupby_
-0000c600: 636f 6c73 203d 3d20 4e6f 6e65 3a0d 0a20  cols == None:.. 
-0000c610: 2020 2020 2020 2020 2020 2063 6466 2e64             cdf.d
-0000c620: 6174 6120 3d20 6364 662e 6461 7461 5b6f  ata = cdf.data[o
-0000c630: 7574 7075 745f 636f 6c73 5d0d 0a20 2020  utput_cols]..   
-0000c640: 2020 2020 2065 6c69 6620 2861 6c6c 2869       elif (all(i
-0000c650: 7369 6e73 7461 6e63 6528 6e61 6d65 2c20  sinstance(name, 
-0000c660: 7374 7229 2066 6f72 206e 616d 6520 696e  str) for name in
-0000c670: 2067 726f 7570 6279 5f63 6f6c 7329 293a   groupby_cols)):
-0000c680: 0d0a 2020 2020 2020 2020 2020 2020 6364  ..            cd
-0000c690: 662e 6461 7461 203d 2063 6466 2e64 6174  f.data = cdf.dat
-0000c6a0: 615b 6772 6f75 7062 795f 636f 6c73 202b  a[groupby_cols +
-0000c6b0: 206f 7574 7075 745f 636f 6c73 5d0d 0a20   output_cols].. 
-0000c6c0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0000c6d0: 2020 2020 2020 2020 2020 6364 662e 6461            cdf.da
-0000c6e0: 7461 203d 2063 6466 2e64 6174 615b 6772  ta = cdf.data[gr
-0000c6f0: 6f75 7062 795f 636f 6c73 5b2d 315d 202b  oupby_cols[-1] +
-0000c700: 206f 7574 7075 745f 636f 6c73 5d0d 0a20   output_cols].. 
-0000c710: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000c720: 2023 204d 6572 6765 2063 6f75 6e74 2069   # Merge count i
-0000c730: 6e66 6f0d 0a20 2020 2020 2020 2069 6620  nfo..        if 
-0000c740: 636f 756e 745f 636f 6c73 2021 3d20 4e6f  count_cols != No
-0000c750: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-0000c760: 2063 6466 2e64 6174 6120 3d20 7365 6c66   cdf.data = self
-0000c770: 2e6d 6572 6765 5f63 6f75 6e74 7328 6364  .merge_counts(cd
-0000c780: 662e 6461 7461 2c0d 0a20 2020 2020 2020  f.data,..       
-0000c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c7b0: 2020 636f 756e 745f 636f 6c73 2c0d 0a20    count_cols,.. 
-0000c7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c7e0: 2020 2020 2020 2020 6772 6f75 7062 795f          groupby_
-0000c7f0: 636f 6c73 290d 0a20 2020 2020 2020 200d  cols)..        .
-0000c800: 0a20 2020 2020 2020 2023 2052 6570 6c61  .        # Repla
-0000c810: 6365 206f 7220 7265 7475 726e 2072 6573  ce or return res
-0000c820: 756c 740d 0a20 2020 2020 2020 2069 6620  ult..        if 
-0000c830: 696e 706c 6163 653a 0d0a 2020 2020 2020  inplace:..      
-0000c840: 2020 2020 2020 7365 6c66 2e64 6174 6120        self.data 
-0000c850: 3d20 6364 662e 6461 7461 0d0a 2020 2020  = cdf.data..    
-0000c860: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0000c870: 2020 2020 2020 2072 6574 7572 6e20 6364         return cd
-0000c880: 662e 6461 7461 0d0a 2020 2020 0d0a 2020  f.data..    ..  
-0000c890: 2020 6465 6620 6d65 6469 616e 2873 656c    def median(sel
-0000c8a0: 662c 0d0a 2020 2020 2020 2020 2020 2020  f,..            
-0000c8b0: 2020 2067 726f 7570 6279 5f63 6f6c 7320     groupby_cols 
-0000c8c0: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
-0000c8d0: 2020 2020 2020 2020 636f 756e 745f 636f          count_co
-0000c8e0: 6c73 203d 204e 6f6e 652c 0d0a 2020 2020  ls = None,..    
-0000c8f0: 2020 2020 2020 2020 2020 2069 6e70 6c61             inpla
-0000c900: 6365 203d 2046 616c 7365 293a 0d0a 2020  ce = False):..  
-0000c910: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000c920: 7265 7475 726e 2073 656c 662e 7065 7263  return self.perc
-0000c930: 656e 7469 6c65 2867 726f 7570 6279 5f63  entile(groupby_c
-0000c940: 6f6c 732c 0d0a 2020 2020 2020 2020 2020  ols,..          
-0000c950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c960: 2020 2020 2063 6f75 6e74 5f63 6f6c 732c       count_cols,
-0000c970: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000c060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c070: 2020 2020 2020 2020 206d 6574 686f 642c           method,
+0000c080: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000c090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c0a0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0000c0b0: 706c 6163 653d 5472 7565 290d 0a20 2020  place=True)..   
+0000c0c0: 2020 2020 2023 2049 6620 7468 6520 6772       # If the gr
+0000c0d0: 6f75 7062 795f 636f 6c73 2069 7320 6120  oupby_cols is a 
+0000c0e0: 6c69 7374 206f 6620 636f 6c75 6d6e 206e  list of column n
+0000c0f0: 616d 6573 2c20 7468 656e 2063 616c 6375  ames, then calcu
+0000c100: 6c61 7465 2073 7461 740d 0a20 2020 2020  late stat..     
+0000c110: 2020 2023 2066 6f72 2065 6163 6820 6772     # for each gr
+0000c120: 6f75 700d 0a20 2020 2020 2020 2065 6c69  oup..        eli
+0000c130: 6620 6973 696e 7374 616e 6365 2867 726f  f isinstance(gro
+0000c140: 7570 6279 5f63 6f6c 732c 206c 6973 7429  upby_cols, list)
+0000c150: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
+0000c160: 6466 2e70 6572 6365 6e74 696c 655f 696e  df.percentile_in
+0000c170: 7465 7276 616c 2867 726f 7570 6279 5f63  terval(groupby_c
+0000c180: 6f6c 732c 0d0a 2020 2020 2020 2020 2020  ols,..          
+0000c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c1a0: 2020 2020 2020 2020 2020 7065 7263 656e            percen
+0000c1b0: 7469 6c65 2c0d 0a20 2020 2020 2020 2020  tile,..         
+0000c1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c1d0: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+0000c1e0: 642c 0d0a 2020 2020 2020 2020 2020 2020  d,..            
+0000c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c200: 2020 2020 2020 2020 696e 706c 6163 653d          inplace=
+0000c210: 5472 7565 290d 0a20 2020 2020 2020 2023  True)..        #
+0000c220: 2045 6c73 6520 756e 6578 7065 6374 6564   Else unexpected
+0000c230: 2066 6f72 6d61 7420 666f 7220 6772 6f75   format for grou
+0000c240: 7062 795f 636f 6c73 0d0a 2020 2020 2020  pby_cols..      
+0000c250: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0000c260: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000c270: 4572 726f 7228 2754 6865 2076 616c 7565  Error('The value
+0000c280: 2070 726f 7669 6465 6420 666f 7220 2267   provided for "g
+0000c290: 726f 7570 6279 5f63 6f6c 7322 206d 7573  roupby_cols" mus
+0000c2a0: 7420 6265 2061 2027 0d0a 2020 2020 2020  t be a '..      
+0000c2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c2c0: 2020 2020 2020 2027 6c69 7374 2072 6174         'list rat
+0000c2d0: 6865 7220 7468 616e 207b 7479 7065 2867  her than {type(g
+0000c2e0: 726f 7570 6279 5f63 6f6c 7329 7d2e 2729  roupby_cols)}.')
+0000c2f0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0000c300: 2020 2020 2320 436f 6e76 6572 7420 7468      # Convert th
+0000c310: 6520 696e 7465 7276 616c 2066 6f72 2074  e interval for t
+0000c320: 6865 2073 7461 7420 696e 746f 2063 656e  he stat into cen
+0000c330: 736f 7220 616e 6420 6e75 6d65 7269 6320  sor and numeric 
+0000c340: 6e6f 7461 7469 6f6e 0d0a 2020 2020 2020  notation..      
+0000c350: 2020 6364 662e 636f 6d70 6f6e 656e 7473    cdf.components
+0000c360: 5f66 726f 6d5f 696e 7465 7276 616c 2863  _from_interval(c
+0000c370: 6466 2e66 6f63 7573 5f68 6967 685f 706f  df.focus_high_po
+0000c380: 7465 6e74 6961 6c2c 2069 6e70 6c61 6365  tential, inplace
+0000c390: 203d 2054 7275 6529 0d0a 2020 2020 2020   = True)..      
+0000c3a0: 2020 0d0a 2020 2020 2020 2020 2320 4372    ..        # Cr
+0000c3b0: 6561 7465 2063 6f6c 756d 6e20 7769 7468  eate column with
+0000c3c0: 2069 6e74 6572 7661 6c20 6e6f 7461 7469   interval notati
+0000c3d0: 6f6e 0d0a 2020 2020 2020 2020 6364 662e  on..        cdf.
+0000c3e0: 696e 7465 7276 616c 5f6e 6f74 6174 696f  interval_notatio
+0000c3f0: 6e28 696e 706c 6163 6520 3d20 5472 7565  n(inplace = True
+0000c400: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+0000c410: 2020 2020 2023 2043 6f6d 6269 6e65 2074       # Combine t
+0000c420: 6865 2063 656e 736f 7220 616e 6420 6e75  he censor and nu
+0000c430: 6d65 7269 6320 636f 6d70 6f6e 656e 7473  meric components
+0000c440: 2069 6e74 6f20 6120 7265 7375 6c74 0d0a   into a result..
+0000c450: 2020 2020 2020 2020 6364 662e 7265 7375          cdf.resu
+0000c460: 6c74 5f66 726f 6d5f 636f 6d70 6f6e 656e  lt_from_componen
+0000c470: 7473 2869 6e70 6c61 6365 203d 2054 7275  ts(inplace = Tru
+0000c480: 6529 0d0a 2020 2020 2020 2020 0d0a 2020  e)..        ..  
+0000c490: 2020 2020 2020 6364 662e 6461 7461 5b63        cdf.data[c
+0000c4a0: 6466 2e72 6573 756c 745f 636f 6c5d 202b  df.result_col] +
+0000c4b0: 3d20 6364 662e 6461 7461 5b27 5f5f 5761  = cdf.data['__Wa
+0000c4c0: 726e 696e 675f 5f27 5d0d 0a20 2020 2020  rning__']..     
+0000c4d0: 2020 200d 0a20 2020 2020 2020 2023 2052     ..        # R
+0000c4e0: 656f 7264 6572 2063 6f6c 756d 6e73 0d0a  eorder columns..
+0000c4f0: 2020 2020 2020 2020 6f75 7470 7574 5f63          output_c
+0000c500: 6f6c 7320 3d20 5b63 6466 2e73 7461 745f  ols = [cdf.stat_
+0000c510: 636f 6c2c 0d0a 2020 2020 2020 2020 2020  col,..          
+0000c520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c530: 6364 662e 7265 7375 6c74 5f63 6f6c 2c0d  cdf.result_col,.
+0000c540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c550: 2020 2020 2020 2020 2020 2063 6466 2e63             cdf.c
+0000c560: 656e 736f 725f 636f 6c2c 0d0a 2020 2020  ensor_col,..    
+0000c570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c580: 2020 2020 2020 6364 662e 6e75 6d65 7269        cdf.numeri
+0000c590: 635f 636f 6c2c 0d0a 2020 2020 2020 2020  c_col,..        
+0000c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c5b0: 2020 6364 662e 696e 7465 7276 616c 5f63    cdf.interval_c
+0000c5c0: 6f6c 5d0d 0a20 2020 2020 2020 200d 0a20  ol]..        .. 
+0000c5d0: 2020 2020 2020 2069 6620 6772 6f75 7062         if groupb
+0000c5e0: 795f 636f 6c73 203d 3d20 4e6f 6e65 3a0d  y_cols == None:.
+0000c5f0: 0a20 2020 2020 2020 2020 2020 2063 6466  .            cdf
+0000c600: 2e64 6174 6120 3d20 6364 662e 6461 7461  .data = cdf.data
+0000c610: 5b6f 7574 7075 745f 636f 6c73 5d0d 0a20  [output_cols].. 
+0000c620: 2020 2020 2020 2065 6c69 6620 2861 6c6c         elif (all
+0000c630: 2869 7369 6e73 7461 6e63 6528 6e61 6d65  (isinstance(name
+0000c640: 2c20 7374 7229 2066 6f72 206e 616d 6520  , str) for name 
+0000c650: 696e 2067 726f 7570 6279 5f63 6f6c 7329  in groupby_cols)
+0000c660: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0000c670: 6364 662e 6461 7461 203d 2063 6466 2e64  cdf.data = cdf.d
+0000c680: 6174 615b 6772 6f75 7062 795f 636f 6c73  ata[groupby_cols
+0000c690: 202b 206f 7574 7075 745f 636f 6c73 5d0d   + output_cols].
+0000c6a0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0000c6b0: 2020 2020 2020 2020 2020 2020 6364 662e              cdf.
+0000c6c0: 6461 7461 203d 2063 6466 2e64 6174 615b  data = cdf.data[
+0000c6d0: 6772 6f75 7062 795f 636f 6c73 5b2d 315d  groupby_cols[-1]
+0000c6e0: 202b 206f 7574 7075 745f 636f 6c73 5d0d   + output_cols].
+0000c6f0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0000c700: 2020 2023 204d 6572 6765 2063 6f75 6e74     # Merge count
+0000c710: 2069 6e66 6f0d 0a20 2020 2020 2020 2069   info..        i
+0000c720: 6620 636f 756e 745f 636f 6c73 2021 3d20  f count_cols != 
+0000c730: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+0000c740: 2020 2063 6466 2e64 6174 6120 3d20 7365     cdf.data = se
+0000c750: 6c66 2e6d 6572 6765 5f63 6f75 6e74 7328  lf.merge_counts(
+0000c760: 6364 662e 6461 7461 2c0d 0a20 2020 2020  cdf.data,..     
+0000c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c790: 2020 2020 636f 756e 745f 636f 6c73 2c0d      count_cols,.
+0000c7a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c7c0: 2020 2020 2020 2020 2020 6772 6f75 7062            groupb
+0000c7d0: 795f 636f 6c73 290d 0a20 2020 2020 2020  y_cols)..       
+0000c7e0: 200d 0a20 2020 2020 2020 2023 2052 6570   ..        # Rep
+0000c7f0: 6c61 6365 206f 7220 7265 7475 726e 2072  lace or return r
+0000c800: 6573 756c 740d 0a20 2020 2020 2020 2069  esult..        i
+0000c810: 6620 696e 706c 6163 653a 0d0a 2020 2020  f inplace:..    
+0000c820: 2020 2020 2020 2020 7365 6c66 2e64 6174          self.dat
+0000c830: 6120 3d20 6364 662e 6461 7461 0d0a 2020  a = cdf.data..  
+0000c840: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0000c850: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000c860: 6364 662e 6461 7461 0d0a 2020 2020 0d0a  cdf.data..    ..
+0000c870: 2020 2020 6465 6620 6d65 6469 616e 2873      def median(s
+0000c880: 656c 662c 0d0a 2020 2020 2020 2020 2020  elf,..          
+0000c890: 2020 2020 2067 726f 7570 6279 5f63 6f6c       groupby_col
+0000c8a0: 7320 3d20 4e6f 6e65 2c0d 0a20 2020 2020  s = None,..     
+0000c8b0: 2020 2020 2020 2020 2020 636f 756e 745f            count_
+0000c8c0: 636f 6c73 203d 204e 6f6e 652c 0d0a 2020  cols = None,..  
+0000c8d0: 2020 2020 2020 2020 2020 2020 2069 6e70               inp
+0000c8e0: 6c61 6365 203d 2046 616c 7365 293a 0d0a  lace = False):..
+0000c8f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000c900: 2020 7265 7475 726e 2073 656c 662e 7065    return self.pe
+0000c910: 7263 656e 7469 6c65 2867 726f 7570 6279  rcentile(groupby
+0000c920: 5f63 6f6c 732c 0d0a 2020 2020 2020 2020  _cols,..        
+0000c930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c940: 2020 2020 2020 2063 6f75 6e74 5f63 6f6c         count_col
+0000c950: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
+0000c960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c970: 2020 2035 302c 0d0a 2020 2020 2020 2020     50,..        
 0000c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c990: 2035 302c 0d0a 2020 2020 2020 2020 2020   50,..          
-0000c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c9b0: 2020 2020 2069 6e70 6c61 6365 3d69 6e70       inplace=inp
-0000c9c0: 6c61 6365 290d 0a20 2020 200d 0a20 2020  lace)..    ..   
-0000c9d0: 2064 6566 2070 6572 6365 6e74 5f65 7863   def percent_exc
-0000c9e0: 6565 6461 6e63 6573 2873 656c 662c 0d0a  eedances(self,..
-0000c9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca00: 2020 2020 2020 2020 2020 2020 7468 7265              thre
-0000ca10: 7368 6f6c 642c 0d0a 2020 2020 2020 2020  shold,..        
-0000ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca30: 2020 2020 7468 7265 7368 6f6c 645f 6973      threshold_is
-0000ca40: 5f65 7863 6565 6461 6e63 652c 0d0a 2020  _exceedance,..  
-0000ca50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca60: 2020 2020 2020 2020 2020 6772 6f75 7062            groupb
-0000ca70: 795f 636f 6c73 203d 204e 6f6e 652c 0d0a  y_cols = None,..
-0000ca80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca90: 2020 2020 2020 2020 2020 2020 636f 756e              coun
-0000caa0: 745f 636f 6c73 203d 204e 6f6e 652c 0d0a  t_cols = None,..
-0000cab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cac0: 2020 2020 2020 2020 2020 2020 726f 756e              roun
-0000cad0: 645f 746f 203d 2032 2c0d 0a20 2020 2020  d_to = 2,..     
-0000cae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000caf0: 2020 2020 2020 2069 6e70 6c61 6365 203d         inplace =
-0000cb00: 2046 616c 7365 293a 0d0a 2020 2020 2020   False):..      
-0000cb10: 2020 0d0a 2020 2020 2020 2020 2320 4372    ..        # Cr
-0000cb20: 6561 7465 2061 2063 6f70 7920 6f66 2074  eate a copy of t
-0000cb30: 6865 2043 656e 736f 7265 6444 6174 6120  he CensoredData 
-0000cb40: 6f62 6a65 6374 0d0a 2020 2020 2020 2020  object..        
-0000cb50: 6364 6620 3d20 636f 7079 2e64 6565 7063  cdf = copy.deepc
-0000cb60: 6f70 7928 7365 6c66 290d 0a20 2020 2020  opy(self)..     
-0000cb70: 2020 200d 0a20 2020 2020 2020 2023 2044     ..        # D
-0000cb80: 6574 6572 6d69 6e65 2065 7863 6565 6461  etermine exceeda
-0000cb90: 6e63 6573 2066 6f72 2065 6163 6820 7361  nces for each sa
-0000cba0: 6d70 6c65 0d0a 2020 2020 2020 2020 6364  mple..        cd
-0000cbb0: 662e 6465 7465 726d 696e 655f 6578 6365  f.determine_exce
-0000cbc0: 6564 616e 6365 7328 7468 7265 7368 6f6c  edances(threshol
-0000cbd0: 642c 0d0a 2020 2020 2020 2020 2020 2020  d,..            
-0000cbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cbf0: 2020 2020 2020 7468 7265 7368 6f6c 645f        threshold_
-0000cc00: 6973 5f65 7863 6565 6461 6e63 652c 0d0a  is_exceedance,..
-0000cc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc30: 2020 696e 706c 6163 6520 3d20 5472 7565    inplace = True
-0000cc40: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-0000cc50: 2020 2020 2064 6620 3d20 6364 662e 6461       df = cdf.da
-0000cc60: 7461 0d0a 2020 2020 2020 2020 0d0a 2020  ta..        ..  
-0000cc70: 2020 2020 2020 2320 4966 206e 6f20 6772        # If no gr
-0000cc80: 6f75 7062 795f 636f 6c73 2070 726f 7669  oupby_cols provi
-0000cc90: 6465 642c 2063 616c 6375 6c61 7465 2073  ded, calculate s
-0000cca0: 7461 7420 666f 7220 6675 6c6c 2064 6174  tat for full dat
-0000ccb0: 6173 6574 0d0a 2020 2020 2020 2020 6966  aset..        if
-0000ccc0: 2067 726f 7570 6279 5f63 6f6c 7320 3d3d   groupby_cols ==
-0000ccd0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0000cce0: 2020 2020 6466 203d 2028 6466 0d0a 2020      df = (df..  
-0000ccf0: 2020 2020 2020 2020 2020 2020 2020 2e61                .a
-0000cd00: 6767 282a 2a7b 0d0a 2020 2020 2020 2020  gg(**{..        
-0000cd10: 2020 2020 2020 2020 2020 2020 2320 5375              # Su
-0000cd20: 6d20 6578 6365 6564 616e 6365 730d 0a20  m exceedances.. 
-0000cd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cd40: 2020 2063 6466 2e65 7863 6565 6461 6e63     cdf.exceedanc
-0000cd50: 6573 5f63 6f6c 3a20 2863 6466 2e65 7863  es_col: (cdf.exc
-0000cd60: 6565 6461 6e63 6573 5f63 6f6c 2c27 7375  eedances_col,'su
-0000cd70: 6d27 292c 0d0a 2020 2020 2020 2020 2020  m'),..          
-0000cd80: 2020 2020 2020 2020 2020 2320 436f 756e            # Coun
-0000cd90: 7420 6f66 2061 7373 6573 7361 626c 6520  t of assessable 
-0000cda0: 7661 6c75 6573 0d0a 2020 2020 2020 2020  values..        
-0000cdb0: 2020 2020 2020 2020 2020 2020 275f 5f44              '__D
-0000cdc0: 6574 6572 6d69 6e65 6443 6f75 6e74 5f5f  eterminedCount__
-0000cdd0: 273a 2028 6364 662e 6578 6365 6564 616e  ': (cdf.exceedan
-0000cde0: 6365 735f 636f 6c2c 2763 6f75 6e74 2729  ces_col,'count')
-0000cdf0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0000ce00: 2020 2020 2020 2023 2043 6f75 6e74 206f         # Count o
-0000ce10: 6620 616c 6c20 7661 6c75 6573 2028 696e  f all values (in
-0000ce20: 636c 7564 696e 6720 6e61 6e29 0d0a 2020  cluding nan)..  
-0000ce30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ce40: 2020 275f 5f54 6f74 616c 436f 756e 745f    '__TotalCount_
-0000ce50: 5f27 3a20 2863 6466 2e65 7863 6565 6461  _': (cdf.exceeda
-0000ce60: 6e63 6573 5f63 6f6c 2c27 7369 7a65 2729  nces_col,'size')
-0000ce70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000ce80: 2020 2020 2020 7d29 0d0a 2020 2020 2020        })..      
-0000ce90: 2020 2020 2020 2020 2020 2320 466c 6970            # Flip
-0000cea0: 2073 6572 6965 7320 696e 746f 2061 2074   series into a t
-0000ceb0: 6162 6c65 0d0a 2020 2020 2020 2020 2020  able..          
-0000cec0: 2020 2020 2020 2e74 7261 6e73 706f 7365        .transpose
-0000ced0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-0000cee0: 2020 2020 2e72 6573 6574 5f69 6e64 6578      .reset_index
-0000cef0: 2864 726f 703d 5472 7565 290d 0a20 2020  (drop=True)..   
-0000cf00: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
-0000cf10: 2020 2020 2020 2020 2320 4966 2067 726f          # If gro
-0000cf20: 7570 6279 5f63 6f6c 7320 6973 2061 206c  upby_cols is a l
-0000cf30: 6973 7420 6f66 206c 6973 7473 2c20 7468  ist of lists, th
-0000cf40: 656e 2061 7373 6573 7320 6d61 7869 6d75  en assess maximu
-0000cf50: 6d73 2066 6f72 2066 6972 7374 0d0a 2020  ms for first..  
-0000cf60: 2020 2020 2020 2320 6772 6f75 7069 6e67        # grouping
-0000cf70: 2061 6e64 2070 6572 6365 6e74 6167 6520   and percentage 
-0000cf80: 6f66 2065 7863 6565 6461 6e63 6573 2066  of exceedances f
-0000cf90: 6f72 2074 6865 2073 6563 6f6e 6420 6772  or the second gr
-0000cfa0: 6f75 7069 6e67 0d0a 2020 2020 2020 2020  ouping..        
-0000cfb0: 656c 6966 2028 6973 696e 7374 616e 6365  elif (isinstance
-0000cfc0: 2867 726f 7570 6279 5f63 6f6c 735b 305d  (groupby_cols[0]
-0000cfd0: 2c6c 6973 7429 2920 2620 286c 656e 2867  ,list)) & (len(g
-0000cfe0: 726f 7570 6279 5f63 6f6c 7329 2021 3d20  roupby_cols) != 
-0000cff0: 3229 3a0d 0a20 2020 2020 2020 2020 2020  2):..           
-0000d000: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0000d010: 7228 274f 6e6c 7920 7477 6f20 6c69 7374  r('Only two list
-0000d020: 7320 6361 6e20 6265 2069 6e63 6c75 6465  s can be include
-0000d030: 6420 666f 7220 6772 6f75 7062 795f 636f  d for groupby_co
-0000d040: 6c73 2027 0d0a 2020 2020 2020 2020 2020  ls '..          
-0000d050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d060: 2020 2027 7468 6174 2069 7320 6120 6c69     'that is a li
-0000d070: 7374 206f 6620 6c69 7374 732e 2052 6576  st of lists. Rev
-0000d080: 6965 7720 7468 6520 270d 0a20 2020 2020  iew the '..     
-0000d090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d0a0: 2020 2020 2020 2020 2764 6f63 756d 656e          'documen
-0000d0b0: 7461 7469 6f6e 2066 6f72 2074 6869 7320  tation for this 
-0000d0c0: 6d65 7468 6f64 2e27 290d 0a20 2020 2020  method.')..     
-0000d0d0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-0000d0e0: 6365 2867 726f 7570 6279 5f63 6f6c 735b  ce(groupby_cols[
-0000d0f0: 305d 2c6c 6973 7429 3a0d 0a20 2020 2020  0],list):..     
-0000d100: 2020 2020 2020 2023 2055 7365 206d 6178         # Use max
-0000d110: 696d 756d 2077 6974 6869 6e20 6561 6368  imum within each
-0000d120: 2067 726f 7570 2066 6f72 2066 6972 7374   group for first
-0000d130: 2067 726f 7570 696e 670d 0a20 2020 2020   grouping..     
-0000d140: 2020 2020 2020 2064 6620 3d20 2864 662e         df = (df.
-0000d150: 6772 6f75 7062 7928 6772 6f75 7062 795f  groupby(groupby_
-0000d160: 636f 6c73 5b30 5d29 5b63 6466 2e65 7863  cols[0])[cdf.exc
-0000d170: 6565 6461 6e63 6573 5f63 6f6c 5d0d 0a20  eedances_col].. 
+0000c990: 2020 2020 2020 2069 6e70 6c61 6365 3d69         inplace=i
+0000c9a0: 6e70 6c61 6365 290d 0a20 2020 200d 0a20  nplace)..    .. 
+0000c9b0: 2020 2064 6566 2070 6572 6365 6e74 5f65     def percent_e
+0000c9c0: 7863 6565 6461 6e63 6573 2873 656c 662c  xceedances(self,
+0000c9d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000c9e0: 2020 2020 2020 2020 2020 2020 2020 7468                th
+0000c9f0: 7265 7368 6f6c 642c 0d0a 2020 2020 2020  reshold,..      
+0000ca00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca10: 2020 2020 2020 7468 7265 7368 6f6c 645f        threshold_
+0000ca20: 6973 5f65 7863 6565 6461 6e63 652c 0d0a  is_exceedance,..
+0000ca30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca40: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
+0000ca50: 7062 795f 636f 6c73 203d 204e 6f6e 652c  pby_cols = None,
+0000ca60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000ca70: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0000ca80: 756e 745f 636f 6c73 203d 204e 6f6e 652c  unt_cols = None,
+0000ca90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000caa0: 2020 2020 2020 2020 2020 2020 2020 726f                ro
+0000cab0: 756e 645f 746f 203d 2032 2c0d 0a20 2020  und_to = 2,..   
+0000cac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cad0: 2020 2020 2020 2020 2069 6e70 6c61 6365           inplace
+0000cae0: 203d 2046 616c 7365 293a 0d0a 2020 2020   = False):..    
+0000caf0: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
+0000cb00: 4372 6561 7465 2061 2063 6f70 7920 6f66  Create a copy of
+0000cb10: 2074 6865 2043 656e 736f 7265 6444 6174   the CensoredDat
+0000cb20: 6120 6f62 6a65 6374 0d0a 2020 2020 2020  a object..      
+0000cb30: 2020 6364 6620 3d20 636f 7079 2e64 6565    cdf = copy.dee
+0000cb40: 7063 6f70 7928 7365 6c66 290d 0a20 2020  pcopy(self)..   
+0000cb50: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+0000cb60: 2044 6574 6572 6d69 6e65 2065 7863 6565   Determine excee
+0000cb70: 6461 6e63 6573 2066 6f72 2065 6163 6820  dances for each 
+0000cb80: 7361 6d70 6c65 0d0a 2020 2020 2020 2020  sample..        
+0000cb90: 6364 662e 6465 7465 726d 696e 655f 6578  cdf.determine_ex
+0000cba0: 6365 6564 616e 6365 7328 7468 7265 7368  ceedances(thresh
+0000cbb0: 6f6c 642c 0d0a 2020 2020 2020 2020 2020  old,..          
+0000cbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cbd0: 2020 2020 2020 2020 7468 7265 7368 6f6c          threshol
+0000cbe0: 645f 6973 5f65 7863 6565 6461 6e63 652c  d_is_exceedance,
+0000cbf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000cc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cc10: 2020 2020 696e 706c 6163 6520 3d20 5472      inplace = Tr
+0000cc20: 7565 290d 0a20 2020 2020 2020 200d 0a20  ue)..        .. 
+0000cc30: 2020 2020 2020 2064 6620 3d20 6364 662e         df = cdf.
+0000cc40: 6461 7461 0d0a 2020 2020 2020 2020 0d0a  data..        ..
+0000cc50: 2020 2020 2020 2020 2320 4966 206e 6f20          # If no 
+0000cc60: 6772 6f75 7062 795f 636f 6c73 2070 726f  groupby_cols pro
+0000cc70: 7669 6465 642c 2063 616c 6375 6c61 7465  vided, calculate
+0000cc80: 2073 7461 7420 666f 7220 6675 6c6c 2064   stat for full d
+0000cc90: 6174 6173 6574 0d0a 2020 2020 2020 2020  ataset..        
+0000cca0: 6966 2067 726f 7570 6279 5f63 6f6c 7320  if groupby_cols 
+0000ccb0: 3d3d 204e 6f6e 653a 0d0a 2020 2020 2020  == None:..      
+0000ccc0: 2020 2020 2020 6466 203d 2028 6466 0d0a        df = (df..
+0000ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cce0: 2e61 6767 282a 2a7b 0d0a 2020 2020 2020  .agg(**{..      
+0000ccf0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0000cd00: 5375 6d20 6578 6365 6564 616e 6365 730d  Sum exceedances.
+0000cd10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cd20: 2020 2020 2063 6466 2e65 7863 6565 6461       cdf.exceeda
+0000cd30: 6e63 6573 5f63 6f6c 3a20 2863 6466 2e65  nces_col: (cdf.e
+0000cd40: 7863 6565 6461 6e63 6573 5f63 6f6c 2c27  xceedances_col,'
+0000cd50: 7375 6d27 292c 0d0a 2020 2020 2020 2020  sum'),..        
+0000cd60: 2020 2020 2020 2020 2020 2020 2320 436f              # Co
+0000cd70: 756e 7420 6f66 2061 7373 6573 7361 626c  unt of assessabl
+0000cd80: 6520 7661 6c75 6573 0d0a 2020 2020 2020  e values..      
+0000cd90: 2020 2020 2020 2020 2020 2020 2020 275f                '_
+0000cda0: 5f44 6574 6572 6d69 6e65 6443 6f75 6e74  _DeterminedCount
+0000cdb0: 5f5f 273a 2028 6364 662e 6578 6365 6564  __': (cdf.exceed
+0000cdc0: 616e 6365 735f 636f 6c2c 2763 6f75 6e74  ances_col,'count
+0000cdd0: 2729 2c0d 0a20 2020 2020 2020 2020 2020  '),..           
+0000cde0: 2020 2020 2020 2020 2023 2043 6f75 6e74           # Count
+0000cdf0: 206f 6620 616c 6c20 7661 6c75 6573 2028   of all values (
+0000ce00: 696e 636c 7564 696e 6720 6e61 6e29 0d0a  including nan)..
+0000ce10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce20: 2020 2020 275f 5f54 6f74 616c 436f 756e      '__TotalCoun
+0000ce30: 745f 5f27 3a20 2863 6466 2e65 7863 6565  t__': (cdf.excee
+0000ce40: 6461 6e63 6573 5f63 6f6c 2c27 7369 7a65  dances_col,'size
+0000ce50: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+0000ce60: 2020 2020 2020 2020 7d29 0d0a 2020 2020          })..    
+0000ce70: 2020 2020 2020 2020 2020 2020 2320 466c              # Fl
+0000ce80: 6970 2073 6572 6965 7320 696e 746f 2061  ip series into a
+0000ce90: 2074 6162 6c65 0d0a 2020 2020 2020 2020   table..        
+0000cea0: 2020 2020 2020 2020 2e74 7261 6e73 706f          .transpo
+0000ceb0: 7365 2829 0d0a 2020 2020 2020 2020 2020  se()..          
+0000cec0: 2020 2020 2020 2e72 6573 6574 5f69 6e64        .reset_ind
+0000ced0: 6578 2864 726f 703d 5472 7565 290d 0a20  ex(drop=True).. 
+0000cee0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000cef0: 0d0a 2020 2020 2020 2020 2320 4966 2067  ..        # If g
+0000cf00: 726f 7570 6279 5f63 6f6c 7320 6973 2061  roupby_cols is a
+0000cf10: 206c 6973 7420 6f66 206c 6973 7473 2c20   list of lists, 
+0000cf20: 7468 656e 2061 7373 6573 7320 6d61 7869  then assess maxi
+0000cf30: 6d75 6d73 2066 6f72 2066 6972 7374 0d0a  mums for first..
+0000cf40: 2020 2020 2020 2020 2320 6772 6f75 7069          # groupi
+0000cf50: 6e67 2061 6e64 2070 6572 6365 6e74 6167  ng and percentag
+0000cf60: 6520 6f66 2065 7863 6565 6461 6e63 6573  e of exceedances
+0000cf70: 2066 6f72 2074 6865 2073 6563 6f6e 6420   for the second 
+0000cf80: 6772 6f75 7069 6e67 0d0a 2020 2020 2020  grouping..      
+0000cf90: 2020 656c 6966 2028 6973 696e 7374 616e    elif (isinstan
+0000cfa0: 6365 2867 726f 7570 6279 5f63 6f6c 735b  ce(groupby_cols[
+0000cfb0: 305d 2c6c 6973 7429 2920 2620 286c 656e  0],list)) & (len
+0000cfc0: 2867 726f 7570 6279 5f63 6f6c 7329 2021  (groupby_cols) !
+0000cfd0: 3d20 3229 3a0d 0a20 2020 2020 2020 2020  = 2):..         
+0000cfe0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0000cff0: 726f 7228 274f 6e6c 7920 7477 6f20 6c69  ror('Only two li
+0000d000: 7374 7320 6361 6e20 6265 2069 6e63 6c75  sts can be inclu
+0000d010: 6465 6420 666f 7220 6772 6f75 7062 795f  ded for groupby_
+0000d020: 636f 6c73 2027 0d0a 2020 2020 2020 2020  cols '..        
+0000d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d040: 2020 2020 2027 7468 6174 2069 7320 6120       'that is a 
+0000d050: 6c69 7374 206f 6620 6c69 7374 732e 2052  list of lists. R
+0000d060: 6576 6965 7720 7468 6520 270d 0a20 2020  eview the '..   
+0000d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d080: 2020 2020 2020 2020 2020 2764 6f63 756d            'docum
+0000d090: 656e 7461 7469 6f6e 2066 6f72 2074 6869  entation for thi
+0000d0a0: 7320 6d65 7468 6f64 2e27 290d 0a20 2020  s method.')..   
+0000d0b0: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
+0000d0c0: 616e 6365 2867 726f 7570 6279 5f63 6f6c  ance(groupby_col
+0000d0d0: 735b 305d 2c6c 6973 7429 3a0d 0a20 2020  s[0],list):..   
+0000d0e0: 2020 2020 2020 2020 2023 2055 7365 206d           # Use m
+0000d0f0: 6178 696d 756d 2077 6974 6869 6e20 6561  aximum within ea
+0000d100: 6368 2067 726f 7570 2066 6f72 2066 6972  ch group for fir
+0000d110: 7374 2067 726f 7570 696e 670d 0a20 2020  st grouping..   
+0000d120: 2020 2020 2020 2020 2064 6620 3d20 2864           df = (d
+0000d130: 662e 6772 6f75 7062 7928 6772 6f75 7062  f.groupby(groupb
+0000d140: 795f 636f 6c73 5b30 5d29 5b63 6466 2e65  y_cols[0])[cdf.e
+0000d150: 7863 6565 6461 6e63 6573 5f63 6f6c 5d0d  xceedances_col].
+0000d160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d170: 2020 2020 2020 202e 6d61 7828 290d 0a20         .max().. 
 0000d180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d190: 2020 2020 202e 6d61 7828 290d 0a20 2020       .max()..   
-0000d1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d1b0: 2020 202e 7265 7365 745f 696e 6465 7828     .reset_index(
-0000d1c0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-0000d1d0: 2320 5573 6520 7365 636f 6e64 2067 726f  # Use second gro
-0000d1e0: 7570 696e 6720 666f 7220 7065 7263 656e  uping for percen
-0000d1f0: 7461 6765 206f 6620 6578 6365 6564 616e  tage of exceedan
-0000d200: 6365 730d 0a20 2020 2020 2020 2020 2020  ces..           
-0000d210: 2064 6620 3d20 2864 662e 6772 6f75 7062   df = (df.groupb
-0000d220: 7928 6772 6f75 7062 795f 636f 6c73 5b31  y(groupby_cols[1
-0000d230: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-0000d240: 2020 2020 2020 2e61 6767 282a 2a7b 0d0a        .agg(**{..
-0000d250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d260: 2020 2020 2020 6364 662e 6578 6365 6564        cdf.exceed
-0000d270: 616e 6365 735f 636f 6c3a 2028 6364 662e  ances_col: (cdf.
-0000d280: 6578 6365 6564 616e 6365 735f 636f 6c2c  exceedances_col,
-0000d290: 2773 756d 2729 2c0d 0a20 2020 2020 2020  'sum'),..       
-0000d2a0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0000d2b0: 5f5f 4465 7465 726d 696e 6564 436f 756e  __DeterminedCoun
-0000d2c0: 745f 5f27 3a20 2863 6466 2e65 7863 6565  t__': (cdf.excee
-0000d2d0: 6461 6e63 6573 5f63 6f6c 2c27 636f 756e  dances_col,'coun
-0000d2e0: 7427 292c 0d0a 2020 2020 2020 2020 2020  t'),..          
-0000d2f0: 2020 2020 2020 2020 2020 2020 275f 5f54              '__T
-0000d300: 6f74 616c 436f 756e 745f 5f27 3a20 2863  otalCount__': (c
-0000d310: 6466 2e65 7863 6565 6461 6e63 6573 5f63  df.exceedances_c
-0000d320: 6f6c 2c27 7369 7a65 2729 0d0a 2020 2020  ol,'size')..    
-0000d330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d340: 7d29 0d0a 2020 2020 2020 2020 2020 2020  })..            
-0000d350: 2020 2020 290d 0a20 2020 2020 2020 2023      )..        #
-0000d360: 2049 6620 7468 6520 6772 6f75 7062 795f   If the groupby_
-0000d370: 636f 6c73 2069 7320 6120 6c69 7374 206f  cols is a list o
-0000d380: 6620 636f 6c75 6d6e 206e 616d 6573 2c20  f column names, 
-0000d390: 7468 656e 2063 616c 6375 6c61 7465 2073  then calculate s
-0000d3a0: 7461 740d 0a20 2020 2020 2020 2023 2066  tat..        # f
-0000d3b0: 6f72 2065 6163 6820 6772 6f75 700d 0a20  or each group.. 
-0000d3c0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-0000d3d0: 7374 616e 6365 2867 726f 7570 6279 5f63  stance(groupby_c
-0000d3e0: 6f6c 732c 206c 6973 7429 3a0d 0a20 2020  ols, list):..   
-0000d3f0: 2020 2020 2020 2020 2064 6620 3d20 2864           df = (d
-0000d400: 662e 6772 6f75 7062 7928 6772 6f75 7062  f.groupby(groupb
-0000d410: 795f 636f 6c73 290d 0a20 2020 2020 2020  y_cols)..       
-0000d420: 2020 2020 2020 2020 2020 202e 6167 6728             .agg(
-0000d430: 2a2a 7b0d 0a20 2020 2020 2020 2020 2020  **{..           
-0000d440: 2020 2020 2020 2020 2020 2063 6466 2e65             cdf.e
-0000d450: 7863 6565 6461 6e63 6573 5f63 6f6c 3a20  xceedances_col: 
-0000d460: 2863 6466 2e65 7863 6565 6461 6e63 6573  (cdf.exceedances
-0000d470: 5f63 6f6c 2c27 7375 6d27 292c 0d0a 2020  _col,'sum'),..  
-0000d480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d490: 2020 2020 275f 5f44 6574 6572 6d69 6e65      '__Determine
-0000d4a0: 6443 6f75 6e74 5f5f 273a 2028 6364 662e  dCount__': (cdf.
-0000d4b0: 6578 6365 6564 616e 6365 735f 636f 6c2c  exceedances_col,
-0000d4c0: 2763 6f75 6e74 2729 2c0d 0a20 2020 2020  'count'),..     
-0000d4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d4e0: 2027 5f5f 546f 7461 6c43 6f75 6e74 5f5f   '__TotalCount__
-0000d4f0: 273a 2028 6364 662e 6578 6365 6564 616e  ': (cdf.exceedan
-0000d500: 6365 735f 636f 6c2c 2773 697a 6527 290d  ces_col,'size').
-0000d510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d520: 2020 2020 207d 290d 0a20 2020 2020 2020       })..       
-0000d530: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-0000d540: 2020 2020 2320 456c 7365 2075 6e65 7870      # Else unexp
-0000d550: 6563 7465 6420 666f 726d 6174 2066 6f72  ected format for
-0000d560: 2067 726f 7570 6279 5f63 6f6c 730d 0a20   groupby_cols.. 
-0000d570: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0000d580: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000d590: 5661 6c75 6545 7272 6f72 2827 5468 6520  ValueError('The 
-0000d5a0: 7661 6c75 6520 7072 6f76 6964 6564 2066  value provided f
-0000d5b0: 6f72 2022 6772 6f75 7062 795f 636f 6c73  or "groupby_cols
-0000d5c0: 2220 6d75 7374 2062 6520 6120 270d 0a20  " must be a '.. 
-0000d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d5e0: 2020 2020 2020 2020 2020 2020 276c 6973              'lis
-0000d5f0: 7420 7261 7468 6572 2074 6861 6e20 7b74  t rather than {t
-0000d600: 7970 6528 6772 6f75 7062 795f 636f 6c73  ype(groupby_cols
-0000d610: 297d 2e27 290d 0a20 2020 2020 2020 200d  )}.')..        .
-0000d620: 0a20 2020 2020 2020 2023 2044 6574 6572  .        # Deter
-0000d630: 6d69 6e65 2063 6f75 6e74 7320 616e 6420  mine counts and 
-0000d640: 6361 6c63 756c 6174 6520 7065 7263 656e  calculate percen
-0000d650: 7461 6765 0d0a 2020 2020 2020 2020 6466  tage..        df
-0000d660: 5b63 6466 2e6e 6f6e 5f65 7863 6565 6461  [cdf.non_exceeda
-0000d670: 6e63 6573 5f63 6f6c 5d20 3d20 280d 0a20  nces_col] = (.. 
-0000d680: 2020 2020 2020 2020 2020 2064 665b 275f             df['_
-0000d690: 5f44 6574 6572 6d69 6e65 6443 6f75 6e74  _DeterminedCount
-0000d6a0: 5f5f 275d 202d 2064 665b 6364 662e 6578  __'] - df[cdf.ex
-0000d6b0: 6365 6564 616e 6365 735f 636f 6c5d 0d0a  ceedances_col]..
-0000d6c0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-0000d6d0: 2020 2020 2020 2064 665b 6364 662e 6967         df[cdf.ig
-0000d6e0: 6e6f 7265 645f 636f 6c5d 203d 2064 665b  nored_col] = df[
-0000d6f0: 275f 5f54 6f74 616c 436f 756e 745f 5f27  '__TotalCount__'
-0000d700: 5d20 2d20 6466 5b27 5f5f 4465 7465 726d  ] - df['__Determ
-0000d710: 696e 6564 436f 756e 745f 5f27 5d0d 0a20  inedCount__'].. 
-0000d720: 2020 2020 2020 2064 665b 6364 662e 6e75         df[cdf.nu
-0000d730: 6d65 7269 635f 636f 6c5d 203d 2028 0d0a  meric_col] = (..
-0000d740: 2020 2020 2020 2020 2020 2020 726f 756e              roun
-0000d750: 6428 6466 5b63 6466 2e65 7863 6565 6461  d(df[cdf.exceeda
-0000d760: 6e63 6573 5f63 6f6c 5d20 2f20 6466 5b27  nces_col] / df['
-0000d770: 5f5f 4465 7465 726d 696e 6564 436f 756e  __DeterminedCoun
-0000d780: 745f 5f27 5d20 2a20 3130 302c 0d0a 2020  t__'] * 100,..  
-0000d790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d7a0: 726f 756e 645f 746f 290d 0a20 2020 2020  round_to)..     
-0000d7b0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-0000d7c0: 2020 6466 5b63 6466 2e72 6573 756c 745f    df[cdf.result_
-0000d7d0: 636f 6c5d 203d 2064 665b 6364 662e 6e75  col] = df[cdf.nu
-0000d7e0: 6d65 7269 635f 636f 6c5d 2e61 7374 7970  meric_col].astyp
-0000d7f0: 6528 7374 7229 202b 2027 2527 0d0a 2020  e(str) + '%'..  
-0000d800: 2020 2020 2020 6466 2e6c 6f63 5b64 665b        df.loc[df[
-0000d810: 6364 662e 6967 6e6f 7265 645f 636f 6c5d  cdf.ignored_col]
-0000d820: 203e 2030 2c20 6364 662e 7265 7375 6c74   > 0, cdf.result
-0000d830: 5f63 6f6c 5d20 3d20 280d 0a20 2020 2020  _col] = (..     
-0000d840: 2020 2020 2020 2064 665b 6364 662e 7265         df[cdf.re
-0000d850: 7375 6c74 5f63 6f6c 5d20 2b0d 0a20 2020  sult_col] +..   
-0000d860: 2020 2020 2020 2020 2027 2028 2720 2b20           ' (' + 
-0000d870: 6466 5b63 6466 2e69 676e 6f72 6564 5f63  df[cdf.ignored_c
-0000d880: 6f6c 5d2e 6173 7479 7065 2873 7472 2920  ol].astype(str) 
-0000d890: 2b20 2720 7661 6c75 6528 7329 2069 676e  + ' value(s) ign
-0000d8a0: 6f72 6564 2927 0d0a 2020 2020 2020 2020  ored)'..        
-0000d8b0: 2020 2020 290d 0a20 2020 2020 2020 200d      )..        .
-0000d8c0: 0a20 2020 2020 2020 2023 2043 7265 6174  .        # Creat
-0000d8d0: 6520 6120 636f 6c75 6d6e 2074 6861 7420  e a column that 
-0000d8e0: 696e 6469 6361 7465 7320 7468 6520 6765  indicates the ge
-0000d8f0: 6e65 7261 7465 6420 7374 6174 6973 7469  nerated statisti
-0000d900: 6320 0d0a 2020 2020 2020 2020 6466 5b63  c ..        df[c
-0000d910: 6466 2e73 7461 745f 636f 6c5d 203d 2027  df.stat_col] = '
-0000d920: 5065 7263 656e 7420 4578 6365 6564 616e  Percent Exceedan
-0000d930: 6365 270d 0a20 2020 2020 2020 2064 665b  ce'..        df[
-0000d940: 6364 662e 7468 7265 7368 6f6c 645f 636f  cdf.threshold_co
-0000d950: 6c5d 203d 2066 277b 7468 7265 7368 6f6c  l] = f'{threshol
-0000d960: 647d 270d 0a20 2020 2020 2020 2069 6620  d}'..        if 
-0000d970: 7468 7265 7368 6f6c 645f 6973 5f65 7863  threshold_is_exc
-0000d980: 6565 6461 6e63 653a 0d0a 2020 2020 2020  eedance:..      
-0000d990: 2020 2020 2020 6466 5b63 6466 2e74 6872        df[cdf.thr
-0000d9a0: 6573 686f 6c64 5f63 6f6c 5d20 3d20 273c  eshold_col] = '<
-0000d9b0: 2720 2b20 6466 5b63 6466 2e74 6872 6573  ' + df[cdf.thres
-0000d9c0: 686f 6c64 5f63 6f6c 5d0d 0a20 2020 2020  hold_col]..     
-0000d9d0: 2020 200d 0a20 2020 2020 2020 2023 2052     ..        # R
-0000d9e0: 6573 6574 2069 6e64 6578 0d0a 2020 2020  eset index..    
-0000d9f0: 2020 2020 6466 203d 2064 662e 7265 7365      df = df.rese
-0000da00: 745f 696e 6465 7828 290d 0a20 2020 2020  t_index()..     
-0000da10: 2020 200d 0a20 2020 2020 2020 2023 2052     ..        # R
-0000da20: 656f 7264 6572 2063 6f6c 756d 6e73 0d0a  eorder columns..
-0000da30: 2020 2020 2020 2020 6f75 7470 7574 5f63          output_c
-0000da40: 6f6c 7320 3d20 5b63 6466 2e73 7461 745f  ols = [cdf.stat_
-0000da50: 636f 6c2c 0d0a 2020 2020 2020 2020 2020  col,..          
-0000da60: 2020 2020 2020 2020 2020 2020 2063 6466               cdf
-0000da70: 2e74 6872 6573 686f 6c64 5f63 6f6c 2c0d  .threshold_col,.
-0000da80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000da90: 2020 2020 2020 2020 6364 662e 7265 7375          cdf.resu
-0000daa0: 6c74 5f63 6f6c 2c0d 0a20 2020 2020 2020  lt_col,..       
-0000dab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dac0: 6364 662e 6e75 6d65 7269 635f 636f 6c2c  cdf.numeric_col,
-0000dad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000dae0: 2020 2020 2020 2020 2063 6466 2e65 7863           cdf.exc
-0000daf0: 6565 6461 6e63 6573 5f63 6f6c 2c0d 0a20  eedances_col,.. 
-0000db00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000db10: 2020 2020 2020 6364 662e 6e6f 6e5f 6578        cdf.non_ex
-0000db20: 6365 6564 616e 6365 735f 636f 6c2c 0d0a  ceedances_col,..
-0000db30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000db40: 2020 2020 2020 2063 6466 2e69 676e 6f72         cdf.ignor
-0000db50: 6564 5f63 6f6c 5d0d 0a20 2020 2020 2020  ed_col]..       
-0000db60: 200d 0a20 2020 2020 2020 2069 6620 6772   ..        if gr
-0000db70: 6f75 7062 795f 636f 6c73 203d 3d20 4e6f  oupby_cols == No
-0000db80: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-0000db90: 2063 6466 2e64 6174 6120 3d20 6466 5b6f   cdf.data = df[o
-0000dba0: 7574 7075 745f 636f 6c73 5d0d 0a20 2020  utput_cols]..   
-0000dbb0: 2020 2020 2065 6c69 6620 2861 6c6c 2869       elif (all(i
-0000dbc0: 7369 6e73 7461 6e63 6528 6e61 6d65 2c20  sinstance(name, 
-0000dbd0: 7374 7229 2066 6f72 206e 616d 6520 696e  str) for name in
-0000dbe0: 2067 726f 7570 6279 5f63 6f6c 7329 293a   groupby_cols)):
-0000dbf0: 0d0a 2020 2020 2020 2020 2020 2020 6364  ..            cd
-0000dc00: 662e 6461 7461 203d 2064 665b 6772 6f75  f.data = df[grou
-0000dc10: 7062 795f 636f 6c73 202b 206f 7574 7075  pby_cols + outpu
-0000dc20: 745f 636f 6c73 5d0d 0a20 2020 2020 2020  t_cols]..       
-0000dc30: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0000dc40: 2020 2020 6364 662e 6461 7461 203d 2064      cdf.data = d
-0000dc50: 665b 6772 6f75 7062 795f 636f 6c73 5b2d  f[groupby_cols[-
-0000dc60: 315d 202b 206f 7574 7075 745f 636f 6c73  1] + output_cols
-0000dc70: 5d0d 0a20 2020 2020 2020 200d 0a20 2020  ]..        ..   
-0000dc80: 2020 2020 2023 204d 6572 6765 2063 6f75       # Merge cou
-0000dc90: 6e74 2069 6e66 6f0d 0a20 2020 2020 2020  nt info..       
-0000dca0: 2069 6620 636f 756e 745f 636f 6c73 2021   if count_cols !
-0000dcb0: 3d20 4e6f 6e65 3a0d 0a20 2020 2020 2020  = None:..       
-0000dcc0: 2020 2020 2063 6466 2e64 6174 6120 3d20       cdf.data = 
-0000dcd0: 7365 6c66 2e6d 6572 6765 5f63 6f75 6e74  self.merge_count
-0000dce0: 7328 6364 662e 6461 7461 2c0d 0a20 2020  s(cdf.data,..   
-0000dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd10: 2020 2020 2020 636f 756e 745f 636f 6c73        count_cols
-0000dd20: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0000dd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd40: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
-0000dd50: 7062 795f 636f 6c73 290d 0a20 2020 2020  pby_cols)..     
-0000dd60: 2020 200d 0a20 2020 2020 2020 2023 2052     ..        # R
-0000dd70: 6570 6c61 6365 206f 7220 7265 7475 726e  eplace or return
-0000dd80: 2072 6573 756c 740d 0a20 2020 2020 2020   result..       
-0000dd90: 2069 6620 696e 706c 6163 653a 0d0a 2020   if inplace:..  
-0000dda0: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
-0000ddb0: 6174 6120 3d20 6364 662e 6461 7461 0d0a  ata = cdf.data..
-0000ddc0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0000ddd0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000dde0: 6e20 6364 662e 6461 7461 0d0a            n cdf.data..
+0000d190: 2020 2020 202e 7265 7365 745f 696e 6465       .reset_inde
+0000d1a0: 7828 2929 0d0a 2020 2020 2020 2020 2020  x())..          
+0000d1b0: 2020 2320 5573 6520 7365 636f 6e64 2067    # Use second g
+0000d1c0: 726f 7570 696e 6720 666f 7220 7065 7263  rouping for perc
+0000d1d0: 656e 7461 6765 206f 6620 6578 6365 6564  entage of exceed
+0000d1e0: 616e 6365 730d 0a20 2020 2020 2020 2020  ances..         
+0000d1f0: 2020 2064 6620 3d20 2864 662e 6772 6f75     df = (df.grou
+0000d200: 7062 7928 6772 6f75 7062 795f 636f 6c73  pby(groupby_cols
+0000d210: 5b31 5d29 0d0a 2020 2020 2020 2020 2020  [1])..          
+0000d220: 2020 2020 2020 2020 2e61 6767 282a 2a7b          .agg(**{
+0000d230: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d240: 2020 2020 2020 2020 6364 662e 6578 6365          cdf.exce
+0000d250: 6564 616e 6365 735f 636f 6c3a 2028 6364  edances_col: (cd
+0000d260: 662e 6578 6365 6564 616e 6365 735f 636f  f.exceedances_co
+0000d270: 6c2c 2773 756d 2729 2c0d 0a20 2020 2020  l,'sum'),..     
+0000d280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d290: 2027 5f5f 4465 7465 726d 696e 6564 436f   '__DeterminedCo
+0000d2a0: 756e 745f 5f27 3a20 2863 6466 2e65 7863  unt__': (cdf.exc
+0000d2b0: 6565 6461 6e63 6573 5f63 6f6c 2c27 636f  eedances_col,'co
+0000d2c0: 756e 7427 292c 0d0a 2020 2020 2020 2020  unt'),..        
+0000d2d0: 2020 2020 2020 2020 2020 2020 2020 275f                '_
+0000d2e0: 5f54 6f74 616c 436f 756e 745f 5f27 3a20  _TotalCount__': 
+0000d2f0: 2863 6466 2e65 7863 6565 6461 6e63 6573  (cdf.exceedances
+0000d300: 5f63 6f6c 2c27 7369 7a65 2729 0d0a 2020  _col,'size')..  
+0000d310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d320: 2020 7d29 0d0a 2020 2020 2020 2020 2020    })..          
+0000d330: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+0000d340: 2023 2049 6620 7468 6520 6772 6f75 7062   # If the groupb
+0000d350: 795f 636f 6c73 2069 7320 6120 6c69 7374  y_cols is a list
+0000d360: 206f 6620 636f 6c75 6d6e 206e 616d 6573   of column names
+0000d370: 2c20 7468 656e 2063 616c 6375 6c61 7465  , then calculate
+0000d380: 2073 7461 740d 0a20 2020 2020 2020 2023   stat..        #
+0000d390: 2066 6f72 2065 6163 6820 6772 6f75 700d   for each group.
+0000d3a0: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
+0000d3b0: 696e 7374 616e 6365 2867 726f 7570 6279  instance(groupby
+0000d3c0: 5f63 6f6c 732c 206c 6973 7429 3a0d 0a20  _cols, list):.. 
+0000d3d0: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
+0000d3e0: 2864 662e 6772 6f75 7062 7928 6772 6f75  (df.groupby(grou
+0000d3f0: 7062 795f 636f 6c73 290d 0a20 2020 2020  pby_cols)..     
+0000d400: 2020 2020 2020 2020 2020 2020 202e 6167               .ag
+0000d410: 6728 2a2a 7b0d 0a20 2020 2020 2020 2020  g(**{..         
+0000d420: 2020 2020 2020 2020 2020 2020 2063 6466               cdf
+0000d430: 2e65 7863 6565 6461 6e63 6573 5f63 6f6c  .exceedances_col
+0000d440: 3a20 2863 6466 2e65 7863 6565 6461 6e63  : (cdf.exceedanc
+0000d450: 6573 5f63 6f6c 2c27 7375 6d27 292c 0d0a  es_col,'sum'),..
+0000d460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d470: 2020 2020 2020 275f 5f44 6574 6572 6d69        '__Determi
+0000d480: 6e65 6443 6f75 6e74 5f5f 273a 2028 6364  nedCount__': (cd
+0000d490: 662e 6578 6365 6564 616e 6365 735f 636f  f.exceedances_co
+0000d4a0: 6c2c 2763 6f75 6e74 2729 2c0d 0a20 2020  l,'count'),..   
+0000d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d4c0: 2020 2027 5f5f 546f 7461 6c43 6f75 6e74     '__TotalCount
+0000d4d0: 5f5f 273a 2028 6364 662e 6578 6365 6564  __': (cdf.exceed
+0000d4e0: 616e 6365 735f 636f 6c2c 2773 697a 6527  ances_col,'size'
+0000d4f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000d500: 2020 2020 2020 207d 290d 0a20 2020 2020         })..     
+0000d510: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+0000d520: 2020 2020 2020 2320 456c 7365 2075 6e65        # Else une
+0000d530: 7870 6563 7465 6420 666f 726d 6174 2066  xpected format f
+0000d540: 6f72 2067 726f 7570 6279 5f63 6f6c 730d  or groupby_cols.
+0000d550: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0000d560: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000d570: 6520 5661 6c75 6545 7272 6f72 2827 5468  e ValueError('Th
+0000d580: 6520 7661 6c75 6520 7072 6f76 6964 6564  e value provided
+0000d590: 2066 6f72 2022 6772 6f75 7062 795f 636f   for "groupby_co
+0000d5a0: 6c73 2220 6d75 7374 2062 6520 6120 270d  ls" must be a '.
+0000d5b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d5c0: 2020 2020 2020 2020 2020 2020 2020 276c                'l
+0000d5d0: 6973 7420 7261 7468 6572 2074 6861 6e20  ist rather than 
+0000d5e0: 7b74 7970 6528 6772 6f75 7062 795f 636f  {type(groupby_co
+0000d5f0: 6c73 297d 2e27 290d 0a20 2020 2020 2020  ls)}.')..       
+0000d600: 200d 0a20 2020 2020 2020 2023 2044 6574   ..        # Det
+0000d610: 6572 6d69 6e65 2063 6f75 6e74 7320 616e  ermine counts an
+0000d620: 6420 6361 6c63 756c 6174 6520 7065 7263  d calculate perc
+0000d630: 656e 7461 6765 0d0a 2020 2020 2020 2020  entage..        
+0000d640: 6466 5b63 6466 2e6e 6f6e 5f65 7863 6565  df[cdf.non_excee
+0000d650: 6461 6e63 6573 5f63 6f6c 5d20 3d20 280d  dances_col] = (.
+0000d660: 0a20 2020 2020 2020 2020 2020 2064 665b  .            df[
+0000d670: 275f 5f44 6574 6572 6d69 6e65 6443 6f75  '__DeterminedCou
+0000d680: 6e74 5f5f 275d 202d 2064 665b 6364 662e  nt__'] - df[cdf.
+0000d690: 6578 6365 6564 616e 6365 735f 636f 6c5d  exceedances_col]
+0000d6a0: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
+0000d6b0: 0a20 2020 2020 2020 2064 665b 6364 662e  .        df[cdf.
+0000d6c0: 6967 6e6f 7265 645f 636f 6c5d 203d 2064  ignored_col] = d
+0000d6d0: 665b 275f 5f54 6f74 616c 436f 756e 745f  f['__TotalCount_
+0000d6e0: 5f27 5d20 2d20 6466 5b27 5f5f 4465 7465  _'] - df['__Dete
+0000d6f0: 726d 696e 6564 436f 756e 745f 5f27 5d0d  rminedCount__'].
+0000d700: 0a20 2020 2020 2020 2064 665b 6364 662e  .        df[cdf.
+0000d710: 6e75 6d65 7269 635f 636f 6c5d 203d 2028  numeric_col] = (
+0000d720: 0d0a 2020 2020 2020 2020 2020 2020 726f  ..            ro
+0000d730: 756e 6428 6466 5b63 6466 2e65 7863 6565  und(df[cdf.excee
+0000d740: 6461 6e63 6573 5f63 6f6c 5d20 2f20 6466  dances_col] / df
+0000d750: 5b27 5f5f 4465 7465 726d 696e 6564 436f  ['__DeterminedCo
+0000d760: 756e 745f 5f27 5d20 2a20 3130 302c 0d0a  unt__'] * 100,..
+0000d770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d780: 2020 726f 756e 645f 746f 290d 0a20 2020    round_to)..   
+0000d790: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+0000d7a0: 2020 2020 6466 5b63 6466 2e72 6573 756c      df[cdf.resul
+0000d7b0: 745f 636f 6c5d 203d 2064 665b 6364 662e  t_col] = df[cdf.
+0000d7c0: 6e75 6d65 7269 635f 636f 6c5d 2e61 7374  numeric_col].ast
+0000d7d0: 7970 6528 7374 7229 202b 2027 2527 0d0a  ype(str) + '%'..
+0000d7e0: 2020 2020 2020 2020 6466 2e6c 6f63 5b64          df.loc[d
+0000d7f0: 665b 6364 662e 6967 6e6f 7265 645f 636f  f[cdf.ignored_co
+0000d800: 6c5d 203e 2030 2c20 6364 662e 7265 7375  l] > 0, cdf.resu
+0000d810: 6c74 5f63 6f6c 5d20 3d20 280d 0a20 2020  lt_col] = (..   
+0000d820: 2020 2020 2020 2020 2064 665b 6364 662e           df[cdf.
+0000d830: 7265 7375 6c74 5f63 6f6c 5d20 2b0d 0a20  result_col] +.. 
+0000d840: 2020 2020 2020 2020 2020 2027 2028 2720             ' (' 
+0000d850: 2b20 6466 5b63 6466 2e69 676e 6f72 6564  + df[cdf.ignored
+0000d860: 5f63 6f6c 5d2e 6173 7479 7065 2873 7472  _col].astype(str
+0000d870: 2920 2b20 2720 7661 6c75 6528 7329 2069  ) + ' value(s) i
+0000d880: 676e 6f72 6564 2927 0d0a 2020 2020 2020  gnored)'..      
+0000d890: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+0000d8a0: 200d 0a20 2020 2020 2020 2023 2043 7265   ..        # Cre
+0000d8b0: 6174 6520 6120 636f 6c75 6d6e 2074 6861  ate a column tha
+0000d8c0: 7420 696e 6469 6361 7465 7320 7468 6520  t indicates the 
+0000d8d0: 6765 6e65 7261 7465 6420 7374 6174 6973  generated statis
+0000d8e0: 7469 6320 0d0a 2020 2020 2020 2020 6466  tic ..        df
+0000d8f0: 5b63 6466 2e73 7461 745f 636f 6c5d 203d  [cdf.stat_col] =
+0000d900: 2027 5065 7263 656e 7420 4578 6365 6564   'Percent Exceed
+0000d910: 616e 6365 270d 0a20 2020 2020 2020 2064  ance'..        d
+0000d920: 665b 6364 662e 7468 7265 7368 6f6c 645f  f[cdf.threshold_
+0000d930: 636f 6c5d 203d 2066 277b 7468 7265 7368  col] = f'{thresh
+0000d940: 6f6c 647d 270d 0a20 2020 2020 2020 2069  old}'..        i
+0000d950: 6620 7468 7265 7368 6f6c 645f 6973 5f65  f threshold_is_e
+0000d960: 7863 6565 6461 6e63 653a 0d0a 2020 2020  xceedance:..    
+0000d970: 2020 2020 2020 2020 6466 5b63 6466 2e74          df[cdf.t
+0000d980: 6872 6573 686f 6c64 5f63 6f6c 5d20 3d20  hreshold_col] = 
+0000d990: 273c 2720 2b20 6466 5b63 6466 2e74 6872  '<' + df[cdf.thr
+0000d9a0: 6573 686f 6c64 5f63 6f6c 5d0d 0a20 2020  eshold_col]..   
+0000d9b0: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+0000d9c0: 2052 6573 6574 2069 6e64 6578 0d0a 2020   Reset index..  
+0000d9d0: 2020 2020 2020 6466 203d 2064 662e 7265        df = df.re
+0000d9e0: 7365 745f 696e 6465 7828 290d 0a20 2020  set_index()..   
+0000d9f0: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+0000da00: 2052 656f 7264 6572 2063 6f6c 756d 6e73   Reorder columns
+0000da10: 0d0a 2020 2020 2020 2020 6f75 7470 7574  ..        output
+0000da20: 5f63 6f6c 7320 3d20 5b63 6466 2e73 7461  _cols = [cdf.sta
+0000da30: 745f 636f 6c2c 0d0a 2020 2020 2020 2020  t_col,..        
+0000da40: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000da50: 6466 2e74 6872 6573 686f 6c64 5f63 6f6c  df.threshold_col
+0000da60: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000da70: 2020 2020 2020 2020 2020 6364 662e 7265            cdf.re
+0000da80: 7375 6c74 5f63 6f6c 2c0d 0a20 2020 2020  sult_col,..     
+0000da90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000daa0: 2020 6364 662e 6e75 6d65 7269 635f 636f    cdf.numeric_co
+0000dab0: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
+0000dac0: 2020 2020 2020 2020 2020 2063 6466 2e65             cdf.e
+0000dad0: 7863 6565 6461 6e63 6573 5f63 6f6c 2c0d  xceedances_col,.
+0000dae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000daf0: 2020 2020 2020 2020 6364 662e 6e6f 6e5f          cdf.non_
+0000db00: 6578 6365 6564 616e 6365 735f 636f 6c2c  exceedances_col,
+0000db10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000db20: 2020 2020 2020 2020 2063 6466 2e69 676e           cdf.ign
+0000db30: 6f72 6564 5f63 6f6c 5d0d 0a20 2020 2020  ored_col]..     
+0000db40: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
+0000db50: 6772 6f75 7062 795f 636f 6c73 203d 3d20  groupby_cols == 
+0000db60: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+0000db70: 2020 2063 6466 2e64 6174 6120 3d20 6466     cdf.data = df
+0000db80: 5b6f 7574 7075 745f 636f 6c73 5d0d 0a20  [output_cols].. 
+0000db90: 2020 2020 2020 2065 6c69 6620 2861 6c6c         elif (all
+0000dba0: 2869 7369 6e73 7461 6e63 6528 6e61 6d65  (isinstance(name
+0000dbb0: 2c20 7374 7229 2066 6f72 206e 616d 6520  , str) for name 
+0000dbc0: 696e 2067 726f 7570 6279 5f63 6f6c 7329  in groupby_cols)
+0000dbd0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0000dbe0: 6364 662e 6461 7461 203d 2064 665b 6772  cdf.data = df[gr
+0000dbf0: 6f75 7062 795f 636f 6c73 202b 206f 7574  oupby_cols + out
+0000dc00: 7075 745f 636f 6c73 5d0d 0a20 2020 2020  put_cols]..     
+0000dc10: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0000dc20: 2020 2020 2020 6364 662e 6461 7461 203d        cdf.data =
+0000dc30: 2064 665b 6772 6f75 7062 795f 636f 6c73   df[groupby_cols
+0000dc40: 5b2d 315d 202b 206f 7574 7075 745f 636f  [-1] + output_co
+0000dc50: 6c73 5d0d 0a20 2020 2020 2020 200d 0a20  ls]..        .. 
+0000dc60: 2020 2020 2020 2023 204d 6572 6765 2063         # Merge c
+0000dc70: 6f75 6e74 2069 6e66 6f0d 0a20 2020 2020  ount info..     
+0000dc80: 2020 2069 6620 636f 756e 745f 636f 6c73     if count_cols
+0000dc90: 2021 3d20 4e6f 6e65 3a0d 0a20 2020 2020   != None:..     
+0000dca0: 2020 2020 2020 2063 6466 2e64 6174 6120         cdf.data 
+0000dcb0: 3d20 7365 6c66 2e6d 6572 6765 5f63 6f75  = self.merge_cou
+0000dcc0: 6e74 7328 6364 662e 6461 7461 2c0d 0a20  nts(cdf.data,.. 
+0000dcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dcf0: 2020 2020 2020 2020 636f 756e 745f 636f          count_co
+0000dd00: 6c73 2c0d 0a20 2020 2020 2020 2020 2020  ls,..           
+0000dd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dd20: 2020 2020 2020 2020 2020 2020 2020 6772                gr
+0000dd30: 6f75 7062 795f 636f 6c73 290d 0a20 2020  oupby_cols)..   
+0000dd40: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+0000dd50: 2052 6570 6c61 6365 206f 7220 7265 7475   Replace or retu
+0000dd60: 726e 2072 6573 756c 740d 0a20 2020 2020  rn result..     
+0000dd70: 2020 2069 6620 696e 706c 6163 653a 0d0a     if inplace:..
+0000dd80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000dd90: 2e64 6174 6120 3d20 6364 662e 6461 7461  .data = cdf.data
+0000dda0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+0000ddb0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000ddc0: 7572 6e20 6364 662e 6461 7461 0d0a       urn cdf.data..
```

### Comparing `censoredsummarystats-0.2.4/censoredsummarystats/utils.py` & `censoredsummarystats-0.2.5/censoredsummarystats/utils.py`

 * *Files identical despite different names*

### Comparing `censoredsummarystats-0.2.4/LICENSE` & `censoredsummarystats-0.2.5/LICENSE`

 * *Files identical despite different names*

### Comparing `censoredsummarystats-0.2.4/pyproject.toml` & `censoredsummarystats-0.2.5/pyproject.toml`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 [tool.poetry]
 name = "censoredsummarystats"
-version = "0.2.4"
+version = "0.2.5"
 description = "A python package for calculating summary stats on censored data (data that contains < and > symbols)."
 authors = ["Kurt van Ness <vanness.kurt@gmail.com>"]
 readme = "README.md"
 repository = "https://github.com/kurtvanness/CensoredSummaryStats"
 license = "Apache-2.0"
 packages = [{include = "censoredsummarystats"}]
```

### Comparing `censoredsummarystats-0.2.4/README.md` & `censoredsummarystats-0.2.5/README.md`

 * *Files identical despite different names*

### Comparing `censoredsummarystats-0.2.4/PKG-INFO` & `censoredsummarystats-0.2.5/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: censoredsummarystats
-Version: 0.2.4
+Version: 0.2.5
 Summary: A python package for calculating summary stats on censored data (data that contains < and > symbols).
 Home-page: https://github.com/kurtvanness/CensoredSummaryStats
 License: Apache-2.0
 Author: Kurt van Ness
 Author-email: vanness.kurt@gmail.com
 Requires-Python: >=3.9,<4.0
 Classifier: License :: OSI Approved :: Apache Software License
```

