# Comparing `tmp/watex-0.2.4.tar.gz` & `tmp/watex-0.2.5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "watex-0.2.4.tar", last modified: Fri May 26 14:51:01 2023, max compression
+gzip compressed data, was "watex-0.2.5.tar", last modified: Thu Jun 22 07:45:30 2023, max compression
```

## Comparing `watex-0.2.4.tar` & `watex-0.2.5.tar`

### file list

```diff
@@ -1,366 +1,372 @@
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.190748 watex-0.2.4/
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.798816 watex-0.2.4/.github/
--rw-rw-rw-   0        0        0      524 2023-02-19 15:19:16.000000 watex-0.2.4/.github/dependabot.yml
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.802953 watex-0.2.4/.github/workflows/
--rw-rw-rw-   0        0        0     1616 2023-02-21 12:32:38.000000 watex-0.2.4/.github/workflows/ci.yaml
--rw-rw-rw-   0        0        0     3025 2023-02-19 15:19:16.000000 watex-0.2.4/.github/workflows/codeql.yml
--rw-rw-rw-   0        0        0      905 2023-02-19 15:19:16.000000 watex-0.2.4/.github/workflows/dependency-review.yml
--rw-rw-rw-   0        0        0     1457 2023-03-02 12:14:24.000000 watex-0.2.4/.github/workflows/python-package.yml
--rw-rw-rw-   0        0        0     3118 2023-05-07 17:25:43.000000 watex-0.2.4/.gitignore
--rw-rw-rw-   0        0        0      553 2023-03-17 13:03:23.000000 watex-0.2.4/CITATION.cff
--rw-rw-rw-   0        0        0     1548 2023-01-08 08:20:47.000000 watex-0.2.4/LICENSE
--rw-rw-rw-   0        0        0     1045 2023-05-14 08:24:24.000000 watex-0.2.4/MANIFEST.in
--rw-rw-rw-   0        0        0    15816 2023-05-26 14:51:01.191741 watex-0.2.4/PKG-INFO
--rw-rw-rw-   0        0        0    14379 2023-05-24 12:02:39.000000 watex-0.2.4/README.md
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.822738 watex-0.2.4/docs/
--rw-rw-rw-   0        0        0      139 2023-02-18 10:33:13.000000 watex-0.2.4/docs/.gitignore
--rw-rw-rw-   0        0        0      658 2023-01-08 08:20:47.000000 watex-0.2.4/docs/Makefile
--rw-rw-rw-   0        0        0      251 2023-03-20 12:42:04.000000 watex-0.2.4/docs/README.md
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.843147 watex-0.2.4/docs/_static/
--rw-rw-rw-   0        0        0     2711 2023-01-08 08:52:36.000000 watex-0.2.4/docs/_static/copybutton.js
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.847388 watex-0.2.4/docs/_static/css/
--rw-rw-rw-   0        0        0   155712 2023-01-28 12:21:35.000000 watex-0.2.4/docs/_static/css/bootstrap.min.css
--rw-rw-rw-   0        0        0     7607 2023-05-13 16:07:36.000000 watex-0.2.4/docs/_static/css/custom.css
--rw-rw-rw-   0        0        0    70782 2023-02-01 10:38:29.000000 watex-0.2.4/docs/_static/favicon.ico
--rw-rw-rw-   0        0        0     1150 2023-01-30 16:08:53.000000 watex-0.2.4/docs/_static/favicon0.ico
--rw-rw-rw-   0        0        0     8356 2023-01-08 08:52:36.000000 watex-0.2.4/docs/_static/favicon_old.ico
--rw-rw-rw-   0        0        0     3519 2023-01-30 11:43:04.000000 watex-0.2.4/docs/_static/index_api.svg
--rw-rw-rw-   0        0        0     2528 2023-01-30 11:43:05.000000 watex-0.2.4/docs/_static/index_contribute.svg
--rw-rw-rw-   0        0        0     3977 2023-01-30 11:43:04.000000 watex-0.2.4/docs/_static/index_getting_started.svg
--rw-rw-rw-   0        0        0     6429 2023-01-30 11:43:05.000000 watex-0.2.4/docs/_static/index_user_guide.svg
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.775228 watex-0.2.4/docs/_static/js/
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.849908 watex-0.2.4/docs/_static/js/vendor/
--rw-rw-rw-   0        0        0    58030 2023-01-28 12:21:35.000000 watex-0.2.4/docs/_static/js/vendor/bootstrap.min.js
--rw-rw-rw-   0        0        0    72818 2023-01-28 12:21:35.000000 watex-0.2.4/docs/_static/js/vendor/jquery-3.6.3.slim.min.js
--rw-rw-rw-   0        0        0     1738 2023-02-02 06:30:47.000000 watex-0.2.4/docs/_static/logo.svg
--rw-rw-rw-   0        0        0     2346 2023-01-08 08:52:36.000000 watex-0.2.4/docs/_static/logo_no_name.svg
--rw-rw-rw-   0        0        0     1916 2023-01-28 05:52:08.000000 watex-0.2.4/docs/_static/logo_small.svg
--rw-rw-rw-   0        0        0     2631 2023-01-08 08:52:36.000000 watex-0.2.4/docs/_static/logo_wide.svg
--rw-rw-rw-   0        0        0     1916 2023-01-28 05:52:08.000000 watex-0.2.4/docs/_static/logo_wide_rev.svg
--rw-rw-rw-   0        0        0     3052 2023-01-08 08:52:36.000000 watex-0.2.4/docs/_static/logo_wide_rev0.svg
--rw-rw-rw-   0        0        0     1020 2023-05-25 11:13:58.000000 watex-0.2.4/docs/_static/switcher.json
--rw-rw-rw-   0        0        0      166 2023-01-28 15:18:48.000000 watex-0.2.4/docs/_static/theme.conf
--rw-rw-rw-   0        0        0     1464 2023-01-30 16:00:33.000000 watex-0.2.4/docs/_static/to_favicon.svg
--rw-rw-rw-   0        0        0   125058 2023-01-30 14:23:50.000000 watex-0.2.4/docs/_static/watex_thumb_image.svg
--rw-rw-rw-   0        0        0    26516 2023-01-30 05:05:07.000000 watex-0.2.4/docs/_static/watex_workflow.svg
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.852912 watex-0.2.4/docs/_templates/
--rw-rw-rw-   0        0        0     5128 2023-01-28 12:21:35.000000 watex-0.2.4/docs/_templates/javascript.html
--rw-rw-rw-   0        0        0      867 2023-05-25 11:10:55.000000 watex-0.2.4/docs/_templates/layout.html
--rw-rw-rw-   0        0        0       87 2023-01-09 10:30:31.000000 watex-0.2.4/docs/_templates/version.html
--rw-rw-rw-   0        0        0    16686 2023-02-01 15:09:39.000000 watex-0.2.4/docs/analysis.rst
--rw-rw-rw-   0        0        0    23293 2023-05-26 14:10:01.000000 watex-0.2.4/docs/api_references.rst
--rw-rw-rw-   0        0        0    15873 2023-04-14 23:54:09.000000 watex-0.2.4/docs/base.rst
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.853913 watex-0.2.4/docs/binder/
--rw-rw-rw-   0        0        0      258 2023-01-08 08:52:36.000000 watex-0.2.4/docs/binder/requirements.txt
--rw-rw-rw-   0        0        0    11688 2023-01-30 11:20:05.000000 watex-0.2.4/docs/cases.rst
--rw-rw-rw-   0        0        0     2772 2023-03-17 13:03:23.000000 watex-0.2.4/docs/citing.rst
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.853913 watex-0.2.4/docs/community/
--rw-rw-rw-   0        0        0     2322 2023-02-19 15:58:54.000000 watex-0.2.4/docs/community/CONTRIBUTING.md
--rw-rw-rw-   0        0        0    16384 2023-03-25 08:21:17.000000 watex-0.2.4/docs/conf.py
--rw-rw-rw-   0        0        0    18198 2023-02-01 09:06:05.000000 watex-0.2.4/docs/datasets.rst
--rw-rw-rw-   0        0        0    16155 2023-02-05 16:03:43.000000 watex-0.2.4/docs/development.rst
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.854913 watex-0.2.4/docs/example_thumbs/
--rw-rw-rw-   0        0        0        0 2023-01-08 08:52:36.000000 watex-0.2.4/docs/example_thumbs/.gitkeep
--rw-rw-rw-   0        0        0    69141 2023-01-30 05:05:07.000000 watex-0.2.4/docs/example_thumbs/watex_workflow.gif
--rw-rw-rw-   0        0        0   100537 2023-03-12 07:09:50.000000 watex-0.2.4/docs/glossary.rst
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.859944 watex-0.2.4/docs/history/
--rw-rw-rw-   0        0        0     5834 2023-02-18 16:26:08.000000 watex-0.2.4/docs/history/five_min_understanding.rst
--rw-rw-rw-   0        0        0      385 2023-02-18 15:40:51.000000 watex-0.2.4/docs/history/index.rst
--rw-rw-rw-   0        0        0     5454 2023-02-21 12:32:38.000000 watex-0.2.4/docs/history/project_goals.rst
--rw-rw-rw-   0        0        0     9463 2023-02-20 11:39:27.000000 watex-0.2.4/docs/history/project_story.rst
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.860944 watex-0.2.4/docs/includes/
--rw-rw-rw-   0        0        0      762 2023-01-10 10:17:54.000000 watex-0.2.4/docs/includes/big_toc_css.rst
--rw-rw-rw-   0        0        0     1087 2023-01-10 10:19:34.000000 watex-0.2.4/docs/includes/bigger_toc_css.rst
--rw-rw-rw-   0        0        0     1918 2023-02-19 16:15:09.000000 watex-0.2.4/docs/index.rst
--rw-rw-rw-   0        0        0    12622 2023-03-19 07:20:06.000000 watex-0.2.4/docs/installation.rst
--rwxrwxrwx   0        0        0      804 2023-01-08 08:20:47.000000 watex-0.2.4/docs/make.bat
--rw-rw-rw-   0        0        0       20 2023-01-08 08:52:36.000000 watex-0.2.4/docs/matplotlibrc.txt
--rw-rw-rw-   0        0        0    46356 2023-02-18 06:46:56.000000 watex-0.2.4/docs/methods.rst
--rw-rw-rw-   0        0        0      548 2023-03-24 16:49:23.000000 watex-0.2.4/docs/requirements.txt
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.861944 watex-0.2.4/docs/source/
--rw-rw-rw-   0        0        0    20241 2023-01-10 14:10:18.000000 watex-0.2.4/docs/source/index.html
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.864944 watex-0.2.4/docs/sphinxext/
--rw-rw-rw-   0        0        0       43 2023-01-12 12:03:56.000000 watex-0.2.4/docs/sphinxext/MANIFEST.in
--rw-rw-rw-   0        0        0     6182 2023-01-12 11:57:22.000000 watex-0.2.4/docs/sphinxext/add_toctree_functions.py
--rw-rw-rw-   0        0        0     1784 2023-01-12 12:03:00.000000 watex-0.2.4/docs/sphinxext/doi_role.py
--rw-rw-rw-   0        0        0     8329 2023-01-12 12:01:15.000000 watex-0.2.4/docs/sphinxext/sphinx_issues.py
--rw-rw-rw-   0        0        0    16329 2023-02-05 13:07:26.000000 watex-0.2.4/docs/structure.rst
--rw-rw-rw-   0        0        0     3807 2023-01-10 10:22:10.000000 watex-0.2.4/docs/tune_toc.rst
--rw-rw-rw-   0        0        0      391 2023-02-02 12:44:21.000000 watex-0.2.4/docs/user_guide.rst
--rw-rw-rw-   0        0        0    42796 2023-01-30 09:59:53.000000 watex-0.2.4/docs/utils.rst
--rw-rw-rw-   0        0        0    76837 2023-02-10 02:52:23.000000 watex-0.2.4/docs/view.rst
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.878759 watex-0.2.4/docs/whatsnew/
--rw-rw-rw-   0        0        0      549 2023-05-25 11:14:26.000000 watex-0.2.4/docs/whatsnew/index.rst
--rw-rw-rw-   0        0        0     1737 2023-03-19 09:38:32.000000 watex-0.2.4/docs/whatsnew/v0.1.0.rst
--rw-rw-rw-   0        0        0     2801 2023-03-19 09:37:06.000000 watex-0.2.4/docs/whatsnew/v0.1.1.rst
--rw-rw-rw-   0        0        0     2202 2023-03-19 09:44:19.000000 watex-0.2.4/docs/whatsnew/v0.1.2.rst
--rw-rw-rw-   0        0        0     2120 2023-03-19 09:42:28.000000 watex-0.2.4/docs/whatsnew/v0.1.3.rst
--rw-rw-rw-   0        0        0     3469 2023-03-19 09:27:50.000000 watex-0.2.4/docs/whatsnew/v0.1.4.rst
--rw-rw-rw-   0        0        0     4092 2023-03-19 10:54:01.000000 watex-0.2.4/docs/whatsnew/v0.1.5.rst
--rw-rw-rw-   0        0        0    21723 2023-03-07 14:39:00.000000 watex-0.2.4/docs/whatsnew/v0.1.6-alpha.rst
--rw-rw-rw-   0        0        0     5019 2023-03-19 09:20:02.000000 watex-0.2.4/docs/whatsnew/v0.1.6.rst
--rw-rw-rw-   0        0        0     1457 2023-03-19 10:17:51.000000 watex-0.2.4/docs/whatsnew/v0.1.7.rst
--rw-rw-rw-   0        0        0     2108 2023-03-20 12:42:04.000000 watex-0.2.4/docs/whatsnew/v0.1.8.rst
--rw-rw-rw-   0        0        0     2042 2023-04-14 23:54:09.000000 watex-0.2.4/docs/whatsnew/v0.1.9.rst
--rw-rw-rw-   0        0        0     5730 2023-04-20 04:00:41.000000 watex-0.2.4/docs/whatsnew/v0.2.0.rst
--rw-rw-rw-   0        0        0     4070 2023-04-22 11:36:08.000000 watex-0.2.4/docs/whatsnew/v0.2.1.rst
--rw-rw-rw-   0        0        0     1093 2023-04-22 07:50:27.000000 watex-0.2.4/docs/whatsnew/v0.2.2.rst
--rw-rw-rw-   0        0        0     2011 2023-05-25 12:52:32.000000 watex-0.2.4/docs/whatsnew/v0.2.3.rst
--rw-rw-rw-   0        0        0     4125 2023-05-26 09:54:41.000000 watex-0.2.4/docs/whatsnew/v0.2.4.rst
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.879152 watex-0.2.4/examples/
--rw-rw-rw-   0        0        0      427 2023-01-11 10:44:04.000000 watex-0.2.4/examples/README.txt
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.883152 watex-0.2.4/examples/analysis/
--rw-rw-rw-   0        0        0      109 2023-01-18 16:53:37.000000 watex-0.2.4/examples/analysis/README.txt
--rw-rw-rw-   0        0        0     1031 2023-01-11 15:25:23.000000 watex-0.2.4/examples/analysis/plot_decision_regions.py
--rw-rw-rw-   0        0        0     1171 2023-01-11 15:25:54.000000 watex-0.2.4/examples/analysis/plot_explained_variance_ratio.py
--rw-rw-rw-   0        0        0      875 2023-01-11 15:26:26.000000 watex-0.2.4/examples/analysis/plot_linear_discriminant_analysis.py
--rw-rw-rw-   0        0        0      541 2023-01-11 15:26:56.000000 watex-0.2.4/examples/analysis/plot_pca_vs_factor_with_scedatic_noises.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.891298 watex-0.2.4/examples/applications/
--rw-rw-rw-   0        0        0      510 2023-01-18 17:34:21.000000 watex-0.2.4/examples/applications/README.txt
--rw-rw-rw-   0        0        0     3329 2023-03-05 22:27:58.000000 watex-0.2.4/examples/applications/plot_auto_detect_drilling_location.py
--rw-rw-rw-   0        0        0     8710 2023-01-11 16:26:30.000000 watex-0.2.4/examples/applications/plot_data_exploratory_quick_view.py
--rw-rw-rw-   0        0        0    10236 2023-02-15 12:36:42.000000 watex-0.2.4/examples/applications/plot_dc_em_parameters_computings.py
--rw-rw-rw-   0        0        0     8084 2023-01-20 17:43:45.000000 watex-0.2.4/examples/applications/plot_flow_rate_prediction.py
--rw-rw-rw-   0        0        0     9799 2023-05-26 12:42:36.000000 watex-0.2.4/examples/applications/plot_kmf.py
--rw-rw-rw-   0        0        0     3325 2023-02-16 17:12:25.000000 watex-0.2.4/examples/applications/plot_nsamt_tensor_recovery.py
--rw-rw-rw-   0        0        0     5719 2023-03-17 13:03:23.000000 watex-0.2.4/examples/applications/plot_tensor_restoring.py
--rw-rw-rw-   0        0        0    11379 2023-05-25 12:48:47.000000 watex-0.2.4/examples/applications/plot_ymxs_label_for_k_prediction.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.892301 watex-0.2.4/examples/auto_examples/
--rw-rw-rw-   0        0        0        0 2023-01-25 09:04:31.000000 watex-0.2.4/examples/auto_examples/.gitkeep
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.895303 watex-0.2.4/examples/base/
--rw-rw-rw-   0        0        0      141 2023-01-18 16:52:30.000000 watex-0.2.4/examples/base/README.txt
--rw-rw-rw-   0        0        0     1002 2023-01-11 15:30:46.000000 watex-0.2.4/examples/base/plot_ada_gd.py
--rw-rw-rw-   0        0        0     1032 2023-01-11 15:31:27.000000 watex-0.2.4/examples/base/plot_ada_stochastic_gd.py
--rw-rw-rw-   0        0        0      902 2023-01-11 15:31:50.000000 watex-0.2.4/examples/base/plot_missing.py
--rw-rw-rw-   0        0        0     1392 2023-01-11 15:32:51.000000 watex-0.2.4/examples/base/plot_sbs_feature_selector.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.903948 watex-0.2.4/examples/methods/
--rw-rw-rw-   0        0        0      106 2023-01-08 08:52:36.000000 watex-0.2.4/examples/methods/README.txt
--rw-rw-rw-   0        0        0      874 2023-01-20 17:25:23.000000 watex-0.2.4/examples/methods/plot_2d_tensor_filtered.py
--rw-rw-rw-   0        0        0     1071 2023-01-11 15:40:37.000000 watex-0.2.4/examples/methods/plot_anomaly.py
--rw-rw-rw-   0        0        0     1852 2023-01-11 15:41:46.000000 watex-0.2.4/examples/methods/plot_filtered_tensors.py
--rw-rw-rw-   0        0        0     1007 2023-01-11 15:43:30.000000 watex-0.2.4/examples/methods/plot_logging_predictor_and_target.py
--rw-rw-rw-   0        0        0      884 2023-01-11 15:44:27.000000 watex-0.2.4/examples/methods/plot_logging_predictor_only.py
--rw-rw-rw-   0        0        0      638 2023-01-11 15:44:36.000000 watex-0.2.4/examples/methods/plot_multiple_sites_recovery_signal.py
--rw-rw-rw-   0        0        0     2423 2023-03-02 12:26:23.000000 watex-0.2.4/examples/methods/plot_phase_tensors.py
--rw-rw-rw-   0        0        0      806 2023-01-11 15:44:59.000000 watex-0.2.4/examples/methods/plot_raw_2d_tensor.py
--rw-rw-rw-   0        0        0      915 2023-01-11 15:45:48.000000 watex-0.2.4/examples/methods/plot_ves_fracture_zone.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.926252 watex-0.2.4/examples/utils/
--rw-rw-rw-   0        0        0      125 2023-01-08 08:52:36.000000 watex-0.2.4/examples/utils/README.txt
--rw-rw-rw-   0        0        0      788 2023-01-09 07:43:08.000000 watex-0.2.4/examples/utils/plot_clusters.py
--rw-rw-rw-   0        0        0     2373 2023-03-06 16:32:37.000000 watex-0.2.4/examples/utils/plot_confidence_in_data.py
--rw-rw-rw-   0        0        0     1489 2023-01-11 15:46:32.000000 watex-0.2.4/examples/utils/plot_confusion_matrices.py
--rw-rw-rw-   0        0        0     1124 2023-01-09 07:43:29.000000 watex-0.2.4/examples/utils/plot_confusion_matrix_sweet.py
--rw-rw-rw-   0        0        0      526 2023-01-11 15:46:56.000000 watex-0.2.4/examples/utils/plot_elbow.py
--rw-rw-rw-   0        0        0     1758 2023-01-25 03:02:32.000000 watex-0.2.4/examples/utils/plot_erp.py
--rw-rw-rw-   0        0        0      655 2023-01-11 15:48:44.000000 watex-0.2.4/examples/utils/plot_errors_vs_epochs.py
--rw-rw-rw-   0        0        0      631 2023-01-11 15:49:01.000000 watex-0.2.4/examples/utils/plot_ex_heatmap.py
--rw-rw-rw-   0        0        0      717 2023-01-11 15:50:15.000000 watex-0.2.4/examples/utils/plot_ex_matrix.py
--rw-rw-rw-   0        0        0     1094 2023-01-11 15:50:34.000000 watex-0.2.4/examples/utils/plot_learning_curves.py
--rw-rw-rw-   0        0        0     1787 2023-01-11 15:51:32.000000 watex-0.2.4/examples/utils/plot_log.py
--rw-rw-rw-   0        0        0     1053 2023-01-09 07:44:13.000000 watex-0.2.4/examples/utils/plot_model_confusion_matrix.py
--rw-rw-rw-   0        0        0      751 2023-01-11 15:53:36.000000 watex-0.2.4/examples/utils/plot_naive_dendrogram.py
--rw-rw-rw-   0        0        0      716 2023-01-11 15:53:51.000000 watex-0.2.4/examples/utils/plot_naive_silhouette.py
--rw-rw-rw-   0        0        0      678 2023-01-11 15:54:53.000000 watex-0.2.4/examples/utils/plot_ohmic_area.py
--rw-rw-rw-   0        0        0      814 2023-01-08 08:52:36.000000 watex-0.2.4/examples/utils/plot_pca_components.py
--rw-rw-rw-   0        0        0      611 2023-01-11 15:55:25.000000 watex-0.2.4/examples/utils/plot_regularization_path.py
--rw-rw-rw-   0        0        0      623 2023-01-11 15:55:45.000000 watex-0.2.4/examples/utils/plot_rf_feature_importances.py
--rw-rw-rw-   0        0        0      966 2023-01-24 10:29:45.000000 watex-0.2.4/examples/utils/plot_savitzky_golay1d.py
--rw-rw-rw-   0        0        0     1132 2023-01-08 08:52:36.000000 watex-0.2.4/examples/utils/plot_sbs_feature_selection.py
--rw-rw-rw-   0        0        0     1793 2023-01-25 04:57:49.000000 watex-0.2.4/examples/utils/plot_sfi.py
--rw-rw-rw-   0        0        0     3121 2023-03-04 11:47:12.000000 watex-0.2.4/examples/utils/plot_skew.py
--rw-rw-rw-   0        0        0     2236 2023-03-19 08:17:21.000000 watex-0.2.4/examples/utils/plot_strike.py
--rw-rw-rw-   0        0        0      693 2023-05-14 06:02:07.000000 watex-0.2.4/examples/utils/plot_voronoi.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.956972 watex-0.2.4/examples/view/
--rw-rw-rw-   0        0        0      113 2023-01-18 16:54:11.000000 watex-0.2.4/examples/view/README.txt
--rw-rw-rw-   0        0        0      915 2023-01-24 02:59:52.000000 watex-0.2.4/examples/view/plot_2d_filtered_tensors.py
--rw-rw-rw-   0        0        0      933 2023-01-11 15:58:16.000000 watex-0.2.4/examples/view/plot_base_distributions.py
--rw-rw-rw-   0        0        0     1101 2023-01-16 18:53:31.000000 watex-0.2.4/examples/view/plot_biplot.py
--rw-rw-rw-   0        0        0      553 2023-01-11 15:59:22.000000 watex-0.2.4/examples/view/plot_box.py
--rw-rw-rw-   0        0        0     1678 2023-01-11 16:00:02.000000 watex-0.2.4/examples/view/plot_confusion_matrix_metric.py
--rw-rw-rw-   0        0        0      852 2023-01-08 08:52:36.000000 watex-0.2.4/examples/view/plot_correlating_features.py
--rw-rw-rw-   0        0        0      449 2023-01-11 16:01:24.000000 watex-0.2.4/examples/view/plot_correlation_missing_data.py
--rw-rw-rw-   0        0        0      599 2023-01-11 16:00:47.000000 watex-0.2.4/examples/view/plot_cut_comparison.py
--rw-rw-rw-   0        0        0      453 2023-01-11 16:01:48.000000 watex-0.2.4/examples/view/plot_dendro_missing_data.py
--rw-rw-rw-   0        0        0      921 2023-01-16 17:55:57.000000 watex-0.2.4/examples/view/plot_dendrogram.py
--rw-rw-rw-   0        0        0      854 2023-01-16 17:19:14.000000 watex-0.2.4/examples/view/plot_dendroheat.py
--rw-rw-rw-   0        0        0      920 2023-01-11 16:05:35.000000 watex-0.2.4/examples/view/plot_discussing_features.py
--rw-rw-rw-   0        0        0      697 2023-01-11 16:06:18.000000 watex-0.2.4/examples/view/plot_grid.py
--rw-rw-rw-   0        0        0      676 2023-01-11 16:06:48.000000 watex-0.2.4/examples/view/plot_hist.py
--rw-rw-rw-   0        0        0      888 2023-01-08 08:52:36.000000 watex-0.2.4/examples/view/plot_jointing_features.py
--rw-rw-rw-   0        0        0      644 2023-01-11 16:07:06.000000 watex-0.2.4/examples/view/plot_learning_inspections.py
--rw-rw-rw-   0        0        0     1365 2023-01-11 16:08:38.000000 watex-0.2.4/examples/view/plot_matshow.py
--rw-rw-rw-   0        0        0     2370 2023-01-11 16:10:01.000000 watex-0.2.4/examples/view/plot_model.py
--rw-rw-rw-   0        0        0      588 2023-01-11 16:10:11.000000 watex-0.2.4/examples/view/plot_model_inspection.py
--rw-rw-rw-   0        0        0     1964 2023-01-18 15:28:17.000000 watex-0.2.4/examples/view/plot_model_scores.py
--rw-rw-rw-   0        0        0      725 2023-01-09 07:52:42.000000 watex-0.2.4/examples/view/plot_multiple_feature_distributions.py
--rw-rw-rw-   0        0        0     1226 2023-01-09 07:52:51.000000 watex-0.2.4/examples/view/plot_num_features.py
--rw-rw-rw-   0        0        0     1241 2023-01-11 16:11:17.000000 watex-0.2.4/examples/view/plot_pairwise_corr.py
--rw-rw-rw-   0        0        0      524 2023-01-11 16:11:59.000000 watex-0.2.4/examples/view/plot_pararell_corrdinates.py
--rw-rw-rw-   0        0        0     1372 2023-01-11 16:12:35.000000 watex-0.2.4/examples/view/plot_pca.py
--rw-rw-rw-   0        0        0     5274 2023-03-04 05:56:10.000000 watex-0.2.4/examples/view/plot_phase_sensistive_skew.py
--rw-rw-rw-   0        0        0      818 2023-01-20 17:26:34.000000 watex-0.2.4/examples/view/plot_phase_tensor_2d.py
--rw-rw-rw-   0        0        0      817 2023-01-11 16:12:58.000000 watex-0.2.4/examples/view/plot_pr.py
--rw-rw-rw-   0        0        0     1893 2023-01-16 18:57:53.000000 watex-0.2.4/examples/view/plot_projection.py
--rw-rw-rw-   0        0        0      883 2023-01-11 16:18:27.000000 watex-0.2.4/examples/view/plot_radviz.py
--rw-rw-rw-   0        0        0      929 2023-01-11 16:19:02.000000 watex-0.2.4/examples/view/plot_reg_scoring.py
--rw-rw-rw-   0        0        0      869 2023-01-11 16:19:28.000000 watex-0.2.4/examples/view/plot_res_tensor_2d.py
--rw-rw-rw-   0        0        0     1939 2023-04-20 03:25:59.000000 watex-0.2.4/examples/view/plot_rhoa.py
--rw-rw-rw-   0        0        0     1757 2023-01-11 16:19:47.000000 watex-0.2.4/examples/view/plot_roc.py
--rw-rw-rw-   0        0        0      794 2023-01-11 16:20:19.000000 watex-0.2.4/examples/view/plot_scatter.py
--rw-rw-rw-   0        0        0     1523 2023-01-11 16:20:37.000000 watex-0.2.4/examples/view/plot_scattering_features.py
--rw-rw-rw-   0        0        0      543 2023-01-08 08:52:36.000000 watex-0.2.4/examples/view/plot_silhouette.py
--rw-rw-rw-   0        0        0      759 2023-01-09 07:56:02.000000 watex-0.2.4/examples/view/plot_single_site_signal_recovery.py
--rw-rw-rw-   0        0        0      834 2023-01-11 16:21:15.000000 watex-0.2.4/examples/view/plot_target_inspection.py
--rw-rw-rw-   0        0        0     1615 2023-05-25 04:59:14.000000 watex-0.2.4/pyproject.toml
--rw-rw-rw-   0        0        0      901 2023-05-26 14:51:01.202276 watex-0.2.4/setup.cfg
--rw-rw-rw-   0        0        0     4646 2023-05-25 04:59:14.000000 watex-0.2.4/setup.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.973868 watex-0.2.4/watex/
--rw-rw-rw-   0        0        0     8550 2023-05-25 04:59:14.000000 watex-0.2.4/watex/__init__.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.011078 watex-0.2.4/watex/_build/
--rw-rw-rw-   0        0        0       27 2023-03-11 03:28:02.000000 watex-0.2.4/watex/_build/__init__.py
--rw-rw-rw-   0        0        0       30 2023-01-08 08:20:47.000000 watex-0.2.4/watex/_build/_check_build.pyx
--rw-rw-rw-   0        0        0      333 2023-01-08 08:20:47.000000 watex-0.2.4/watex/_distributor_init.py
--rw-rw-rw-   0        0        0    32062 2023-05-25 04:59:14.000000 watex-0.2.4/watex/_docstring.py
--rw-rw-rw-   0        0        0     3852 2023-03-11 03:28:02.000000 watex-0.2.4/watex/_isotonic.pyx
--rw-rw-rw-   0        0        0    17770 2023-04-14 23:54:09.000000 watex-0.2.4/watex/_typing.py
--rw-rw-rw-   0        0        0      218 2023-05-26 14:50:59.000000 watex-0.2.4/watex/_version.py
--rw-rw-rw-   0        0        0     8798 2023-03-12 01:49:05.000000 watex-0.2.4/watex/_watexlog.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.014079 watex-0.2.4/watex/analysis/
--rw-rw-rw-   0        0        0     1242 2023-02-04 08:11:48.000000 watex-0.2.4/watex/analysis/__init__.py
--rw-rw-rw-   0        0        0    23341 2023-01-18 16:30:53.000000 watex-0.2.4/watex/analysis/decomposition.py
--rw-rw-rw-   0        0        0    25575 2023-02-05 12:23:26.000000 watex-0.2.4/watex/analysis/dimensionality.py
--rw-rw-rw-   0        0        0     9305 2023-02-04 08:20:23.000000 watex-0.2.4/watex/analysis/factor.py
--rw-rw-rw-   0        0        0    85025 2023-03-12 01:49:14.000000 watex-0.2.4/watex/base.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.017261 watex-0.2.4/watex/cases/
--rw-rw-rw-   0        0        0     1078 2023-01-12 16:27:24.000000 watex-0.2.4/watex/cases/__init__.py
--rw-rw-rw-   0        0        0    38684 2023-03-12 01:39:59.000000 watex-0.2.4/watex/cases/features.py
--rw-rw-rw-   0        0        0    31952 2023-03-12 01:40:49.000000 watex-0.2.4/watex/cases/modeling.py
--rw-rw-rw-   0        0        0    39022 2023-03-12 01:40:40.000000 watex-0.2.4/watex/cases/prepare.py
--rw-rw-rw-   0        0        0    49220 2023-03-12 01:41:33.000000 watex-0.2.4/watex/cases/processing.py
--rw-rw-rw-   0        0        0     1353 2023-03-15 12:48:58.000000 watex-0.2.4/watex/cli.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.023248 watex-0.2.4/watex/datasets/
--rw-rw-rw-   0        0        0      868 2023-05-05 12:57:48.000000 watex-0.2.4/watex/datasets/__init__.py
--rw-rw-rw-   0        0        0     7785 2023-03-21 13:31:09.000000 watex-0.2.4/watex/datasets/_config.py
--rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/_hongliu.py
--rw-rw-rw-   0        0        0     5677 2023-03-21 13:58:43.000000 watex-0.2.4/watex/datasets/_p.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.053058 watex-0.2.4/watex/datasets/data/
--rw-rw-rw-   0        0        0       27 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/__init__.py
--rw-rw-rw-   0        0        0   328758 2023-03-20 17:59:44.000000 watex-0.2.4/watex/datasets/data/b.pkl
--rw-rw-rw-   0        0        0    34993 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/bagoue.csv
--rw-rw-rw-   0        0        0    35250 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/boston_house_prices.csv
--rw-rw-rw-   0        0        0      638 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/boundiali_ves.csv
--rw-rw-rw-   0        0        0     1158 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/dcerp_gbalo.csv
--rw-rw-rw-   0        0        0      699 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/dcves_gbalo.csv
--rw-rw-rw-   0        0        0  2216584 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/e.h5
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.056564 watex-0.2.4/watex/datasets/data/edis/
--rw-rw-rw-   0        0        0        4 2023-02-24 10:23:34.000000 watex-0.2.4/watex/datasets/data/edis/__init__.py
--rw-rw-rw-   0        0        0   170380 2023-02-24 10:23:34.000000 watex-0.2.4/watex/datasets/data/edis/raw.E.zip
--rw-rw-rw-   0        0        0   184986 2023-02-24 10:23:34.000000 watex-0.2.4/watex/datasets/data/edis/s.E.zip
--rw-rw-rw-   0        0        0 11940145 2023-05-05 12:57:48.000000 watex-0.2.4/watex/datasets/data/h.h5
--rw-rw-rw-   0        0        0     2885 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/iris.csv
--rw-rw-rw-   0        0        0   731414 2023-05-05 12:57:48.000000 watex-0.2.4/watex/datasets/data/mxs.joblib
--rw-rw-rw-   0        0        0      603 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/semien_ves.csv
--rw-rw-rw-   0        0        0     2230 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/tankesse.csv
--rw-rw-rw-   0        0        0    11336 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/wine_data.csv
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.064666 watex-0.2.4/watex/datasets/descr/
--rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/__init__.py
--rw-rw-rw-   0        0        0     2827 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/bagoue.rst
--rw-rw-rw-   0        0        0     2397 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/boston_house_prices.rst
--rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/boundiali_ves.rst
--rw-rw-rw-   0        0        0     1822 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/california_housing.rst
--rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/gbalo_erp.rst
--rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/gbalo_ves.rst
--rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/huayuan_edis.rst
--rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/iris.rst
--rw-rw-rw-   0        0        0     3544 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/wine_data.rst
--rw-rw-rw-   0        0        0    43799 2023-05-26 10:01:44.000000 watex-0.2.4/watex/datasets/dload.py
--rw-rw-rw-   0        0        0    17331 2023-05-05 12:57:48.000000 watex-0.2.4/watex/datasets/gdata.py
--rw-rw-rw-   0        0        0    13639 2023-03-24 15:43:33.000000 watex-0.2.4/watex/datasets/io.py
--rw-rw-rw-   0        0        0    34896 2023-03-12 01:42:57.000000 watex-0.2.4/watex/datasets/rload.py
--rw-rw-rw-   0        0        0     7098 2023-05-24 12:02:39.000000 watex-0.2.4/watex/datasets/sets.py
--rw-rw-rw-   0        0        0      822 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/setup.py
--rw-rw-rw-   0        0        0   101706 2023-03-12 01:49:23.000000 watex-0.2.4/watex/decorators.py
--rw-rw-rw-   0        0        0   115869 2023-03-23 14:01:07.000000 watex-0.2.4/watex/edi.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.075146 watex-0.2.4/watex/etc/
--rw-rw-rw-   0        0        0     5711 2023-01-08 08:20:47.000000 watex-0.2.4/watex/etc/AGSO.csv
--rw-rw-rw-   0        0        0      351 2023-01-08 08:20:47.000000 watex-0.2.4/watex/etc/AGSO_STCODES.csv
--rw-rw-rw-   0        0        0    14650 2023-03-20 14:32:57.000000 watex-0.2.4/watex/etc/__XTyT.pkl
--rw-rw-rw-   0        0        0    37763 2023-03-20 16:12:55.000000 watex-0.2.4/watex/etc/__Xy.pkl
--rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.4/watex/etc/__init__.py
--rw-rw-rw-   0        0        0   811233 2023-01-08 08:20:47.000000 watex-0.2.4/watex/etc/__memory.pkl
--rw-rw-rw-   0        0        0    28672 2023-01-08 08:20:47.000000 watex-0.2.4/watex/etc/memory.sq3
--rw-rw-rw-   0        0        0 52244397 2023-01-08 08:20:47.000000 watex-0.2.4/watex/etc/p.models.pkl
--rw-rw-rw-   0        0        0     9383 2023-03-24 14:28:17.000000 watex-0.2.4/watex/exceptions.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.148962 watex-0.2.4/watex/exlib/
--rw-rw-rw-   0        0        0     4022 2023-03-27 14:03:16.000000 watex-0.2.4/watex/exlib/__init__.py
--rw-rw-rw-   0        0        0     2580 2023-03-15 12:48:58.000000 watex-0.2.4/watex/exlib/gbm.py
--rw-rw-rw-   0        0        0     7156 2023-03-12 01:43:33.000000 watex-0.2.4/watex/exlib/sklearn.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.152423 watex-0.2.4/watex/externals/
--rw-rw-rw-   0        0        0      313 2023-01-18 17:47:22.000000 watex-0.2.4/watex/externals/__init__.py
--rw-rw-rw-   0        0        0     4835 2023-01-08 08:20:47.000000 watex-0.2.4/watex/externals/_numpy_compiler_patch.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.154430 watex-0.2.4/watex/externals/_pkgs/
--rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.4/watex/externals/_pkgs/__init__.py
--rw-rw-rw-   0        0        0     3035 2023-01-08 08:20:47.000000 watex-0.2.4/watex/externals/_pkgs/_structures.py
--rw-rw-rw-   0        0        0    16762 2023-01-08 08:20:47.000000 watex-0.2.4/watex/externals/_pkgs/version.py
--rw-rw-rw-   0        0        0      273 2023-01-08 08:20:47.000000 watex-0.2.4/watex/externals/readme.md
--rw-rw-rw-   0        0        0    57854 2023-03-23 14:01:07.000000 watex-0.2.4/watex/externals/z.py
--rw-rw-rw-   0        0        0    24161 2023-03-12 01:43:53.000000 watex-0.2.4/watex/externals/zutils.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.159150 watex-0.2.4/watex/geology/
--rw-rw-rw-   0        0        0     1039 2023-05-25 04:59:14.000000 watex-0.2.4/watex/geology/__init__.py
--rw-rw-rw-   0        0        0    12616 2023-05-24 12:02:39.000000 watex-0.2.4/watex/geology/core.py
--rw-rw-rw-   0        0        0    56354 2023-03-12 01:44:15.000000 watex-0.2.4/watex/geology/database.py
--rw-rw-rw-   0        0        0    59717 2023-05-25 04:59:14.000000 watex-0.2.4/watex/geology/drilling.py
--rw-rw-rw-   0        0        0    14488 2023-05-24 12:02:39.000000 watex-0.2.4/watex/geology/geology.py
--rw-rw-rw-   0        0        0    65017 2023-05-24 12:02:39.000000 watex-0.2.4/watex/geology/stratigraphic.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.163144 watex-0.2.4/watex/methods/
--rw-rw-rw-   0        0        0      867 2023-04-15 15:25:13.000000 watex-0.2.4/watex/methods/__init__.py
--rw-rw-rw-   0        0        0    82817 2023-04-22 06:56:19.000000 watex-0.2.4/watex/methods/electrical.py
--rw-rw-rw-   0        0        0   136679 2023-05-14 09:33:31.000000 watex-0.2.4/watex/methods/em.py
--rw-rw-rw-   0        0        0    86661 2023-04-22 06:56:19.000000 watex-0.2.4/watex/methods/erp.py
--rw-rw-rw-   0        0        0    43855 2023-03-12 01:45:26.000000 watex-0.2.4/watex/methods/hydro.py
--rw-rw-rw-   0        0        0    28992 2023-05-24 12:02:39.000000 watex-0.2.4/watex/metrics.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.166651 watex-0.2.4/watex/models/
--rw-rw-rw-   0        0        0     1064 2023-03-24 12:58:06.000000 watex-0.2.4/watex/models/__init__.py
--rw-rw-rw-   0        0        0     6889 2023-03-15 12:48:58.000000 watex-0.2.4/watex/models/_metapredictors.py
--rw-rw-rw-   0        0        0    18878 2023-03-15 12:48:58.000000 watex-0.2.4/watex/models/premodels.py
--rw-rw-rw-   0        0        0    44482 2023-03-28 11:58:09.000000 watex-0.2.4/watex/models/validation.py
--rw-rw-rw-   0        0        0    73950 2023-05-05 12:57:48.000000 watex-0.2.4/watex/property.py
--rw-rw-rw-   0        0        0    48351 2023-04-20 07:15:26.000000 watex-0.2.4/watex/site.py
--rw-rw-rw-   0        0        0    61573 2023-05-26 14:28:41.000000 watex-0.2.4/watex/transformers.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.187434 watex-0.2.4/watex/utils/
--rw-rw-rw-   0        0        0     5875 2023-05-13 14:10:22.000000 watex-0.2.4/watex/utils/__init__.py
--rw-rw-rw-   0        0        0     7140 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/_array_api.py
--rw-rw-rw-   0        0        0     7730 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/_arraytools.py
--rw-rw-rw-   0        0        0     5936 2023-02-01 06:46:13.000000 watex-0.2.4/watex/utils/_dependency.py
--rw-rw-rw-   0        0        0      222 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/_openmp_helpers.pxd
--rw-rw-rw-   0        0        0     2674 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/_openmp_helpers.pyx
--rw-rw-rw-   0        0        0    16659 2023-01-28 02:10:06.000000 watex-0.2.4/watex/utils/_packaging_version.py
--rw-rw-rw-   0        0        0     1616 2023-03-28 11:58:09.000000 watex-0.2.4/watex/utils/_set_gdal.py
--rw-rw-rw-   0        0        0     2583 2023-02-16 08:00:08.000000 watex-0.2.4/watex/utils/_show_versions.py
--rw-rw-rw-   0        0        0    13908 2023-05-26 13:32:06.000000 watex-0.2.4/watex/utils/box.py
--rw-rw-rw-   0        0        0    96738 2023-05-26 13:12:04.000000 watex-0.2.4/watex/utils/coreutils.py
--rw-rw-rw-   0        0        0   580618 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/epsg.npy
--rw-rw-rw-   0        0        0   225756 2023-05-26 14:02:20.000000 watex-0.2.4/watex/utils/exmath.py
--rw-rw-rw-   0        0        0   232075 2023-05-26 09:54:41.000000 watex-0.2.4/watex/utils/funcutils.py
--rw-rw-rw-   0        0        0    54374 2023-05-24 14:24:15.000000 watex-0.2.4/watex/utils/geotools.py
--rw-rw-rw-   0        0        0    58698 2023-03-28 11:58:09.000000 watex-0.2.4/watex/utils/gistools.py
--rw-rw-rw-   0        0        0   139485 2023-05-05 12:57:48.000000 watex-0.2.4/watex/utils/hydroutils.py
--rw-rw-rw-   0        0        0   122844 2023-05-24 12:02:39.000000 watex-0.2.4/watex/utils/mlutils.py
--rw-rw-rw-   0        0        0   138126 2023-05-26 13:15:46.000000 watex-0.2.4/watex/utils/plotutils.py
--rw-rw-rw-   0        0        0      974 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/setup.py
--rw-rw-rw-   0        0        0     3548 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/thread.py
--rw-rw-rw-   0        0        0    86093 2023-05-24 12:02:39.000000 watex-0.2.4/watex/utils/validator.py
--rw-rw-rw-   0        0        0    16835 2023-01-28 01:30:49.000000 watex-0.2.4/watex/utils/version.py
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.190748 watex-0.2.4/watex/view/
--rw-rw-rw-   0        0        0     1008 2023-02-24 10:23:34.000000 watex-0.2.4/watex/view/__init__.py
--rw-rw-rw-   0        0        0   145840 2023-05-14 06:19:47.000000 watex-0.2.4/watex/view/mlplot.py
--rw-rw-rw-   0        0        0   190822 2023-04-22 06:56:19.000000 watex-0.2.4/watex/view/plot.py
--rw-rw-rw-   0        0        0     1222 2023-03-11 03:28:02.000000 watex-0.2.4/watex/wlog.yml
-drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.010078 watex-0.2.4/watex.egg-info/
--rw-rw-rw-   0        0        0    15816 2023-05-26 14:50:59.000000 watex-0.2.4/watex.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0     9490 2023-05-26 14:51:00.000000 watex-0.2.4/watex.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-05-26 14:50:59.000000 watex-0.2.4/watex.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       83 2023-05-26 14:50:59.000000 watex-0.2.4/watex.egg-info/entry_points.txt
--rw-rw-rw-   0        0        0      366 2023-05-26 14:50:59.000000 watex-0.2.4/watex.egg-info/requires.txt
--rw-rw-rw-   0        0        0        6 2023-05-26 14:50:59.000000 watex-0.2.4/watex.egg-info/top_level.txt
--rw-rw-rw-   0        0        0        2 2023-05-26 14:49:57.000000 watex-0.2.4/watex.egg-info/zip-safe
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.715684 watex-0.2.5/
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.319450 watex-0.2.5/.github/
+-rw-rw-rw-   0        0        0      524 2023-02-19 15:19:16.000000 watex-0.2.5/.github/dependabot.yml
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.322368 watex-0.2.5/.github/workflows/
+-rw-rw-rw-   0        0        0     1616 2023-02-21 12:32:38.000000 watex-0.2.5/.github/workflows/ci.yaml
+-rw-rw-rw-   0        0        0     3025 2023-02-19 15:19:16.000000 watex-0.2.5/.github/workflows/codeql.yml
+-rw-rw-rw-   0        0        0      905 2023-02-19 15:19:16.000000 watex-0.2.5/.github/workflows/dependency-review.yml
+-rw-rw-rw-   0        0        0     1457 2023-03-02 12:14:24.000000 watex-0.2.5/.github/workflows/python-package.yml
+-rw-rw-rw-   0        0        0     3118 2023-05-07 17:25:43.000000 watex-0.2.5/.gitignore
+-rw-rw-rw-   0        0        0      553 2023-03-17 13:03:23.000000 watex-0.2.5/CITATION.cff
+-rw-rw-rw-   0        0        0     1548 2023-01-08 08:20:47.000000 watex-0.2.5/LICENSE
+-rw-rw-rw-   0        0        0     1045 2023-05-14 08:24:24.000000 watex-0.2.5/MANIFEST.in
+-rw-rw-rw-   0        0        0    15816 2023-06-22 07:45:30.716661 watex-0.2.5/PKG-INFO
+-rw-rw-rw-   0        0        0    14379 2023-05-24 12:02:39.000000 watex-0.2.5/README.md
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.338766 watex-0.2.5/docs/
+-rw-rw-rw-   0        0        0      139 2023-02-18 10:33:13.000000 watex-0.2.5/docs/.gitignore
+-rw-rw-rw-   0        0        0      658 2023-01-08 08:20:47.000000 watex-0.2.5/docs/Makefile
+-rw-rw-rw-   0        0        0      251 2023-03-20 12:42:04.000000 watex-0.2.5/docs/README.md
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.355477 watex-0.2.5/docs/_static/
+-rw-rw-rw-   0        0        0     2711 2023-01-08 08:52:36.000000 watex-0.2.5/docs/_static/copybutton.js
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.357424 watex-0.2.5/docs/_static/css/
+-rw-rw-rw-   0        0        0   155712 2023-01-28 12:21:35.000000 watex-0.2.5/docs/_static/css/bootstrap.min.css
+-rw-rw-rw-   0        0        0     7607 2023-05-13 16:07:36.000000 watex-0.2.5/docs/_static/css/custom.css
+-rw-rw-rw-   0        0        0    70782 2023-02-01 10:38:29.000000 watex-0.2.5/docs/_static/favicon.ico
+-rw-rw-rw-   0        0        0     1150 2023-01-30 16:08:53.000000 watex-0.2.5/docs/_static/favicon0.ico
+-rw-rw-rw-   0        0        0     8356 2023-01-08 08:52:36.000000 watex-0.2.5/docs/_static/favicon_old.ico
+-rw-rw-rw-   0        0        0     3519 2023-01-30 11:43:04.000000 watex-0.2.5/docs/_static/index_api.svg
+-rw-rw-rw-   0        0        0     2528 2023-01-30 11:43:05.000000 watex-0.2.5/docs/_static/index_contribute.svg
+-rw-rw-rw-   0        0        0     3977 2023-01-30 11:43:04.000000 watex-0.2.5/docs/_static/index_getting_started.svg
+-rw-rw-rw-   0        0        0     6429 2023-01-30 11:43:05.000000 watex-0.2.5/docs/_static/index_user_guide.svg
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.306263 watex-0.2.5/docs/_static/js/
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.359370 watex-0.2.5/docs/_static/js/vendor/
+-rw-rw-rw-   0        0        0    58030 2023-01-28 12:21:35.000000 watex-0.2.5/docs/_static/js/vendor/bootstrap.min.js
+-rw-rw-rw-   0        0        0    72818 2023-01-28 12:21:35.000000 watex-0.2.5/docs/_static/js/vendor/jquery-3.6.3.slim.min.js
+-rw-rw-rw-   0        0        0     1738 2023-02-02 06:30:47.000000 watex-0.2.5/docs/_static/logo.svg
+-rw-rw-rw-   0        0        0     2346 2023-01-08 08:52:36.000000 watex-0.2.5/docs/_static/logo_no_name.svg
+-rw-rw-rw-   0        0        0     1916 2023-01-28 05:52:08.000000 watex-0.2.5/docs/_static/logo_small.svg
+-rw-rw-rw-   0        0        0     2631 2023-01-08 08:52:36.000000 watex-0.2.5/docs/_static/logo_wide.svg
+-rw-rw-rw-   0        0        0     1916 2023-01-28 05:52:08.000000 watex-0.2.5/docs/_static/logo_wide_rev.svg
+-rw-rw-rw-   0        0        0     3052 2023-01-08 08:52:36.000000 watex-0.2.5/docs/_static/logo_wide_rev0.svg
+-rw-rw-rw-   0        0        0     1132 2023-06-20 12:20:59.000000 watex-0.2.5/docs/_static/switcher.json
+-rw-rw-rw-   0        0        0      166 2023-01-28 15:18:48.000000 watex-0.2.5/docs/_static/theme.conf
+-rw-rw-rw-   0        0        0     1464 2023-01-30 16:00:33.000000 watex-0.2.5/docs/_static/to_favicon.svg
+-rw-rw-rw-   0        0        0   125058 2023-01-30 14:23:50.000000 watex-0.2.5/docs/_static/watex_thumb_image.svg
+-rw-rw-rw-   0        0        0    26516 2023-01-30 05:05:07.000000 watex-0.2.5/docs/_static/watex_workflow.svg
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.362321 watex-0.2.5/docs/_templates/
+-rw-rw-rw-   0        0        0     5128 2023-01-28 12:21:35.000000 watex-0.2.5/docs/_templates/javascript.html
+-rw-rw-rw-   0        0        0      867 2023-05-25 11:10:55.000000 watex-0.2.5/docs/_templates/layout.html
+-rw-rw-rw-   0        0        0       87 2023-01-09 10:30:31.000000 watex-0.2.5/docs/_templates/version.html
+-rw-rw-rw-   0        0        0    16686 2023-02-01 15:09:39.000000 watex-0.2.5/docs/analysis.rst
+-rw-rw-rw-   0        0        0    23500 2023-06-21 11:42:13.000000 watex-0.2.5/docs/api_references.rst
+-rw-rw-rw-   0        0        0    15873 2023-04-14 23:54:09.000000 watex-0.2.5/docs/base.rst
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.363604 watex-0.2.5/docs/binder/
+-rw-rw-rw-   0        0        0      258 2023-01-08 08:52:36.000000 watex-0.2.5/docs/binder/requirements.txt
+-rw-rw-rw-   0        0        0    11688 2023-01-30 11:20:05.000000 watex-0.2.5/docs/cases.rst
+-rw-rw-rw-   0        0        0     2772 2023-03-17 13:03:23.000000 watex-0.2.5/docs/citing.rst
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.363604 watex-0.2.5/docs/community/
+-rw-rw-rw-   0        0        0     2322 2023-02-19 15:58:54.000000 watex-0.2.5/docs/community/CONTRIBUTING.md
+-rw-rw-rw-   0        0        0    16384 2023-03-25 08:21:17.000000 watex-0.2.5/docs/conf.py
+-rw-rw-rw-   0        0        0    18198 2023-02-01 09:06:05.000000 watex-0.2.5/docs/datasets.rst
+-rw-rw-rw-   0        0        0    16155 2023-02-05 16:03:43.000000 watex-0.2.5/docs/development.rst
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.364962 watex-0.2.5/docs/example_thumbs/
+-rw-rw-rw-   0        0        0        0 2023-01-08 08:52:36.000000 watex-0.2.5/docs/example_thumbs/.gitkeep
+-rw-rw-rw-   0        0        0    69141 2023-01-30 05:05:07.000000 watex-0.2.5/docs/example_thumbs/watex_workflow.gif
+-rw-rw-rw-   0        0        0   100537 2023-03-12 07:09:50.000000 watex-0.2.5/docs/glossary.rst
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.368494 watex-0.2.5/docs/history/
+-rw-rw-rw-   0        0        0     5834 2023-02-18 16:26:08.000000 watex-0.2.5/docs/history/five_min_understanding.rst
+-rw-rw-rw-   0        0        0      385 2023-02-18 15:40:51.000000 watex-0.2.5/docs/history/index.rst
+-rw-rw-rw-   0        0        0     5454 2023-02-21 12:32:38.000000 watex-0.2.5/docs/history/project_goals.rst
+-rw-rw-rw-   0        0        0     9463 2023-02-20 11:39:27.000000 watex-0.2.5/docs/history/project_story.rst
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.370444 watex-0.2.5/docs/includes/
+-rw-rw-rw-   0        0        0      762 2023-01-10 10:17:54.000000 watex-0.2.5/docs/includes/big_toc_css.rst
+-rw-rw-rw-   0        0        0     1087 2023-01-10 10:19:34.000000 watex-0.2.5/docs/includes/bigger_toc_css.rst
+-rw-rw-rw-   0        0        0     1918 2023-02-19 16:15:09.000000 watex-0.2.5/docs/index.rst
+-rw-rw-rw-   0        0        0    12622 2023-03-19 07:20:06.000000 watex-0.2.5/docs/installation.rst
+-rwxrwxrwx   0        0        0      804 2023-01-08 08:20:47.000000 watex-0.2.5/docs/make.bat
+-rw-rw-rw-   0        0        0       20 2023-01-08 08:52:36.000000 watex-0.2.5/docs/matplotlibrc.txt
+-rw-rw-rw-   0        0        0    46356 2023-02-18 06:46:56.000000 watex-0.2.5/docs/methods.rst
+-rw-rw-rw-   0        0        0      548 2023-03-24 16:49:23.000000 watex-0.2.5/docs/requirements.txt
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.371417 watex-0.2.5/docs/source/
+-rw-rw-rw-   0        0        0    20241 2023-01-10 14:10:18.000000 watex-0.2.5/docs/source/index.html
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.374337 watex-0.2.5/docs/sphinxext/
+-rw-rw-rw-   0        0        0       43 2023-01-12 12:03:56.000000 watex-0.2.5/docs/sphinxext/MANIFEST.in
+-rw-rw-rw-   0        0        0     6182 2023-01-12 11:57:22.000000 watex-0.2.5/docs/sphinxext/add_toctree_functions.py
+-rw-rw-rw-   0        0        0     1784 2023-01-12 12:03:00.000000 watex-0.2.5/docs/sphinxext/doi_role.py
+-rw-rw-rw-   0        0        0     8329 2023-01-12 12:01:15.000000 watex-0.2.5/docs/sphinxext/sphinx_issues.py
+-rw-rw-rw-   0        0        0    16329 2023-02-05 13:07:26.000000 watex-0.2.5/docs/structure.rst
+-rw-rw-rw-   0        0        0     3807 2023-01-10 10:22:10.000000 watex-0.2.5/docs/tune_toc.rst
+-rw-rw-rw-   0        0        0      391 2023-02-02 12:44:21.000000 watex-0.2.5/docs/user_guide.rst
+-rw-rw-rw-   0        0        0    42796 2023-01-30 09:59:53.000000 watex-0.2.5/docs/utils.rst
+-rw-rw-rw-   0        0        0    76837 2023-02-10 02:52:23.000000 watex-0.2.5/docs/view.rst
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.387964 watex-0.2.5/docs/whatsnew/
+-rw-rw-rw-   0        0        0      560 2023-06-20 12:32:10.000000 watex-0.2.5/docs/whatsnew/index.rst
+-rw-rw-rw-   0        0        0     1737 2023-03-19 09:38:32.000000 watex-0.2.5/docs/whatsnew/v0.1.0.rst
+-rw-rw-rw-   0        0        0     2801 2023-03-19 09:37:06.000000 watex-0.2.5/docs/whatsnew/v0.1.1.rst
+-rw-rw-rw-   0        0        0     2202 2023-03-19 09:44:19.000000 watex-0.2.5/docs/whatsnew/v0.1.2.rst
+-rw-rw-rw-   0        0        0     2120 2023-03-19 09:42:28.000000 watex-0.2.5/docs/whatsnew/v0.1.3.rst
+-rw-rw-rw-   0        0        0     3469 2023-03-19 09:27:50.000000 watex-0.2.5/docs/whatsnew/v0.1.4.rst
+-rw-rw-rw-   0        0        0     4092 2023-03-19 10:54:01.000000 watex-0.2.5/docs/whatsnew/v0.1.5.rst
+-rw-rw-rw-   0        0        0    21723 2023-03-07 14:39:00.000000 watex-0.2.5/docs/whatsnew/v0.1.6-alpha.rst
+-rw-rw-rw-   0        0        0     5019 2023-03-19 09:20:02.000000 watex-0.2.5/docs/whatsnew/v0.1.6.rst
+-rw-rw-rw-   0        0        0     1457 2023-03-19 10:17:51.000000 watex-0.2.5/docs/whatsnew/v0.1.7.rst
+-rw-rw-rw-   0        0        0     2108 2023-03-20 12:42:04.000000 watex-0.2.5/docs/whatsnew/v0.1.8.rst
+-rw-rw-rw-   0        0        0     2042 2023-04-14 23:54:09.000000 watex-0.2.5/docs/whatsnew/v0.1.9.rst
+-rw-rw-rw-   0        0        0     5730 2023-04-20 04:00:41.000000 watex-0.2.5/docs/whatsnew/v0.2.0.rst
+-rw-rw-rw-   0        0        0     4070 2023-04-22 11:36:08.000000 watex-0.2.5/docs/whatsnew/v0.2.1.rst
+-rw-rw-rw-   0        0        0     1093 2023-04-22 07:50:27.000000 watex-0.2.5/docs/whatsnew/v0.2.2.rst
+-rw-rw-rw-   0        0        0     2011 2023-05-25 12:52:32.000000 watex-0.2.5/docs/whatsnew/v0.2.3.rst
+-rw-rw-rw-   0        0        0     4124 2023-05-27 00:28:54.000000 watex-0.2.5/docs/whatsnew/v0.2.4.rst
+-rw-rw-rw-   0        0        0     3337 2023-06-22 04:55:18.000000 watex-0.2.5/docs/whatsnew/v0.2.5.rst
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.388937 watex-0.2.5/examples/
+-rw-rw-rw-   0        0        0      427 2023-01-11 10:44:04.000000 watex-0.2.5/examples/README.txt
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.391857 watex-0.2.5/examples/analysis/
+-rw-rw-rw-   0        0        0      109 2023-01-18 16:53:37.000000 watex-0.2.5/examples/analysis/README.txt
+-rw-rw-rw-   0        0        0     1031 2023-01-11 15:25:23.000000 watex-0.2.5/examples/analysis/plot_decision_regions.py
+-rw-rw-rw-   0        0        0     1171 2023-01-11 15:25:54.000000 watex-0.2.5/examples/analysis/plot_explained_variance_ratio.py
+-rw-rw-rw-   0        0        0      875 2023-01-11 15:26:26.000000 watex-0.2.5/examples/analysis/plot_linear_discriminant_analysis.py
+-rw-rw-rw-   0        0        0      541 2023-01-11 15:26:56.000000 watex-0.2.5/examples/analysis/plot_pca_vs_factor_with_scedatic_noises.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.395750 watex-0.2.5/examples/applications/
+-rw-rw-rw-   0        0        0      510 2023-01-18 17:34:21.000000 watex-0.2.5/examples/applications/README.txt
+-rw-rw-rw-   0        0        0     3329 2023-03-05 22:27:58.000000 watex-0.2.5/examples/applications/plot_auto_detect_drilling_location.py
+-rw-rw-rw-   0        0        0     8710 2023-01-11 16:26:30.000000 watex-0.2.5/examples/applications/plot_data_exploratory_quick_view.py
+-rw-rw-rw-   0        0        0    10236 2023-02-15 12:36:42.000000 watex-0.2.5/examples/applications/plot_dc_em_parameters_computings.py
+-rw-rw-rw-   0        0        0     8084 2023-01-20 17:43:45.000000 watex-0.2.5/examples/applications/plot_flow_rate_prediction.py
+-rw-rw-rw-   0        0        0    10004 2023-06-17 08:36:57.000000 watex-0.2.5/examples/applications/plot_kmf.py
+-rw-rw-rw-   0        0        0     3325 2023-02-16 17:12:25.000000 watex-0.2.5/examples/applications/plot_nsamt_tensor_recovery.py
+-rw-rw-rw-   0        0        0     5719 2023-03-17 13:03:23.000000 watex-0.2.5/examples/applications/plot_tensor_restoring.py
+-rw-rw-rw-   0        0        0    11379 2023-05-25 12:48:47.000000 watex-0.2.5/examples/applications/plot_ymxs_label_for_k_prediction.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.396724 watex-0.2.5/examples/auto_examples/
+-rw-rw-rw-   0        0        0        0 2023-01-25 09:04:31.000000 watex-0.2.5/examples/auto_examples/.gitkeep
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.399644 watex-0.2.5/examples/base/
+-rw-rw-rw-   0        0        0      141 2023-01-18 16:52:30.000000 watex-0.2.5/examples/base/README.txt
+-rw-rw-rw-   0        0        0     1002 2023-01-11 15:30:46.000000 watex-0.2.5/examples/base/plot_ada_gd.py
+-rw-rw-rw-   0        0        0     1032 2023-01-11 15:31:27.000000 watex-0.2.5/examples/base/plot_ada_stochastic_gd.py
+-rw-rw-rw-   0        0        0      902 2023-01-11 15:31:50.000000 watex-0.2.5/examples/base/plot_missing.py
+-rw-rw-rw-   0        0        0     1392 2023-01-11 15:32:51.000000 watex-0.2.5/examples/base/plot_sbs_feature_selector.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.405989 watex-0.2.5/examples/methods/
+-rw-rw-rw-   0        0        0      106 2023-01-08 08:52:36.000000 watex-0.2.5/examples/methods/README.txt
+-rw-rw-rw-   0        0        0      874 2023-01-20 17:25:23.000000 watex-0.2.5/examples/methods/plot_2d_tensor_filtered.py
+-rw-rw-rw-   0        0        0     1071 2023-01-11 15:40:37.000000 watex-0.2.5/examples/methods/plot_anomaly.py
+-rw-rw-rw-   0        0        0     1852 2023-01-11 15:41:46.000000 watex-0.2.5/examples/methods/plot_filtered_tensors.py
+-rw-rw-rw-   0        0        0     1007 2023-01-11 15:43:30.000000 watex-0.2.5/examples/methods/plot_logging_predictor_and_target.py
+-rw-rw-rw-   0        0        0      884 2023-01-11 15:44:27.000000 watex-0.2.5/examples/methods/plot_logging_predictor_only.py
+-rw-rw-rw-   0        0        0      638 2023-01-11 15:44:36.000000 watex-0.2.5/examples/methods/plot_multiple_sites_recovery_signal.py
+-rw-rw-rw-   0        0        0     2423 2023-03-02 12:26:23.000000 watex-0.2.5/examples/methods/plot_phase_tensors.py
+-rw-rw-rw-   0        0        0      806 2023-01-11 15:44:59.000000 watex-0.2.5/examples/methods/plot_raw_2d_tensor.py
+-rw-rw-rw-   0        0        0      915 2023-01-11 15:45:48.000000 watex-0.2.5/examples/methods/plot_ves_fracture_zone.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.420589 watex-0.2.5/examples/utils/
+-rw-rw-rw-   0        0        0      125 2023-01-08 08:52:36.000000 watex-0.2.5/examples/utils/README.txt
+-rw-rw-rw-   0        0        0      788 2023-01-09 07:43:08.000000 watex-0.2.5/examples/utils/plot_clusters.py
+-rw-rw-rw-   0        0        0     2373 2023-03-06 16:32:37.000000 watex-0.2.5/examples/utils/plot_confidence_in_data.py
+-rw-rw-rw-   0        0        0     1489 2023-01-11 15:46:32.000000 watex-0.2.5/examples/utils/plot_confusion_matrices.py
+-rw-rw-rw-   0        0        0     1124 2023-01-09 07:43:29.000000 watex-0.2.5/examples/utils/plot_confusion_matrix_sweet.py
+-rw-rw-rw-   0        0        0      526 2023-01-11 15:46:56.000000 watex-0.2.5/examples/utils/plot_elbow.py
+-rw-rw-rw-   0        0        0     1758 2023-01-25 03:02:32.000000 watex-0.2.5/examples/utils/plot_erp.py
+-rw-rw-rw-   0        0        0      655 2023-01-11 15:48:44.000000 watex-0.2.5/examples/utils/plot_errors_vs_epochs.py
+-rw-rw-rw-   0        0        0      631 2023-01-11 15:49:01.000000 watex-0.2.5/examples/utils/plot_ex_heatmap.py
+-rw-rw-rw-   0        0        0      717 2023-01-11 15:50:15.000000 watex-0.2.5/examples/utils/plot_ex_matrix.py
+-rw-rw-rw-   0        0        0     1094 2023-01-11 15:50:34.000000 watex-0.2.5/examples/utils/plot_learning_curves.py
+-rw-rw-rw-   0        0        0     1787 2023-01-11 15:51:32.000000 watex-0.2.5/examples/utils/plot_log.py
+-rw-rw-rw-   0        0        0     1053 2023-01-09 07:44:13.000000 watex-0.2.5/examples/utils/plot_model_confusion_matrix.py
+-rw-rw-rw-   0        0        0      751 2023-01-11 15:53:36.000000 watex-0.2.5/examples/utils/plot_naive_dendrogram.py
+-rw-rw-rw-   0        0        0      716 2023-01-11 15:53:51.000000 watex-0.2.5/examples/utils/plot_naive_silhouette.py
+-rw-rw-rw-   0        0        0      678 2023-01-11 15:54:53.000000 watex-0.2.5/examples/utils/plot_ohmic_area.py
+-rw-rw-rw-   0        0        0      814 2023-01-08 08:52:36.000000 watex-0.2.5/examples/utils/plot_pca_components.py
+-rw-rw-rw-   0        0        0      611 2023-01-11 15:55:25.000000 watex-0.2.5/examples/utils/plot_regularization_path.py
+-rw-rw-rw-   0        0        0      623 2023-01-11 15:55:45.000000 watex-0.2.5/examples/utils/plot_rf_feature_importances.py
+-rw-rw-rw-   0        0        0      966 2023-01-24 10:29:45.000000 watex-0.2.5/examples/utils/plot_savitzky_golay1d.py
+-rw-rw-rw-   0        0        0     1132 2023-01-08 08:52:36.000000 watex-0.2.5/examples/utils/plot_sbs_feature_selection.py
+-rw-rw-rw-   0        0        0     1793 2023-01-25 04:57:49.000000 watex-0.2.5/examples/utils/plot_sfi.py
+-rw-rw-rw-   0        0        0     3121 2023-03-04 11:47:12.000000 watex-0.2.5/examples/utils/plot_skew.py
+-rw-rw-rw-   0        0        0      618 2023-06-21 11:42:13.000000 watex-0.2.5/examples/utils/plot_stratalog.py
+-rw-rw-rw-   0        0        0     2236 2023-03-19 08:17:21.000000 watex-0.2.5/examples/utils/plot_strike.py
+-rw-rw-rw-   0        0        0      693 2023-05-14 06:02:07.000000 watex-0.2.5/examples/utils/plot_voronoi.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.441816 watex-0.2.5/examples/view/
+-rw-rw-rw-   0        0        0      113 2023-01-18 16:54:11.000000 watex-0.2.5/examples/view/README.txt
+-rw-rw-rw-   0        0        0      915 2023-01-24 02:59:52.000000 watex-0.2.5/examples/view/plot_2d_filtered_tensors.py
+-rw-rw-rw-   0        0        0      933 2023-01-11 15:58:16.000000 watex-0.2.5/examples/view/plot_base_distributions.py
+-rw-rw-rw-   0        0        0     1101 2023-01-16 18:53:31.000000 watex-0.2.5/examples/view/plot_biplot.py
+-rw-rw-rw-   0        0        0      553 2023-01-11 15:59:22.000000 watex-0.2.5/examples/view/plot_box.py
+-rw-rw-rw-   0        0        0     1678 2023-01-11 16:00:02.000000 watex-0.2.5/examples/view/plot_confusion_matrix_metric.py
+-rw-rw-rw-   0        0        0      852 2023-01-08 08:52:36.000000 watex-0.2.5/examples/view/plot_correlating_features.py
+-rw-rw-rw-   0        0        0      449 2023-01-11 16:01:24.000000 watex-0.2.5/examples/view/plot_correlation_missing_data.py
+-rw-rw-rw-   0        0        0      599 2023-01-11 16:00:47.000000 watex-0.2.5/examples/view/plot_cut_comparison.py
+-rw-rw-rw-   0        0        0      453 2023-01-11 16:01:48.000000 watex-0.2.5/examples/view/plot_dendro_missing_data.py
+-rw-rw-rw-   0        0        0      921 2023-01-16 17:55:57.000000 watex-0.2.5/examples/view/plot_dendrogram.py
+-rw-rw-rw-   0        0        0      854 2023-01-16 17:19:14.000000 watex-0.2.5/examples/view/plot_dendroheat.py
+-rw-rw-rw-   0        0        0      920 2023-01-11 16:05:35.000000 watex-0.2.5/examples/view/plot_discussing_features.py
+-rw-rw-rw-   0        0        0      697 2023-01-11 16:06:18.000000 watex-0.2.5/examples/view/plot_grid.py
+-rw-rw-rw-   0        0        0      676 2023-01-11 16:06:48.000000 watex-0.2.5/examples/view/plot_hist.py
+-rw-rw-rw-   0        0        0      888 2023-01-08 08:52:36.000000 watex-0.2.5/examples/view/plot_jointing_features.py
+-rw-rw-rw-   0        0        0      644 2023-01-11 16:07:06.000000 watex-0.2.5/examples/view/plot_learning_inspections.py
+-rw-rw-rw-   0        0        0     1365 2023-01-11 16:08:38.000000 watex-0.2.5/examples/view/plot_matshow.py
+-rw-rw-rw-   0        0        0     2370 2023-01-11 16:10:01.000000 watex-0.2.5/examples/view/plot_model.py
+-rw-rw-rw-   0        0        0      588 2023-01-11 16:10:11.000000 watex-0.2.5/examples/view/plot_model_inspection.py
+-rw-rw-rw-   0        0        0     1964 2023-01-18 15:28:17.000000 watex-0.2.5/examples/view/plot_model_scores.py
+-rw-rw-rw-   0        0        0      725 2023-01-09 07:52:42.000000 watex-0.2.5/examples/view/plot_multiple_feature_distributions.py
+-rw-rw-rw-   0        0        0     1226 2023-01-09 07:52:51.000000 watex-0.2.5/examples/view/plot_num_features.py
+-rw-rw-rw-   0        0        0     1241 2023-01-11 16:11:17.000000 watex-0.2.5/examples/view/plot_pairwise_corr.py
+-rw-rw-rw-   0        0        0      524 2023-01-11 16:11:59.000000 watex-0.2.5/examples/view/plot_pararell_corrdinates.py
+-rw-rw-rw-   0        0        0     1372 2023-01-11 16:12:35.000000 watex-0.2.5/examples/view/plot_pca.py
+-rw-rw-rw-   0        0        0     5274 2023-03-04 05:56:10.000000 watex-0.2.5/examples/view/plot_phase_sensistive_skew.py
+-rw-rw-rw-   0        0        0      818 2023-01-20 17:26:34.000000 watex-0.2.5/examples/view/plot_phase_tensor_2d.py
+-rw-rw-rw-   0        0        0      817 2023-01-11 16:12:58.000000 watex-0.2.5/examples/view/plot_pr.py
+-rw-rw-rw-   0        0        0     1893 2023-01-16 18:57:53.000000 watex-0.2.5/examples/view/plot_projection.py
+-rw-rw-rw-   0        0        0      883 2023-01-11 16:18:27.000000 watex-0.2.5/examples/view/plot_radviz.py
+-rw-rw-rw-   0        0        0      929 2023-01-11 16:19:02.000000 watex-0.2.5/examples/view/plot_reg_scoring.py
+-rw-rw-rw-   0        0        0      869 2023-01-11 16:19:28.000000 watex-0.2.5/examples/view/plot_res_tensor_2d.py
+-rw-rw-rw-   0        0        0     1939 2023-04-20 03:25:59.000000 watex-0.2.5/examples/view/plot_rhoa.py
+-rw-rw-rw-   0        0        0     1757 2023-01-11 16:19:47.000000 watex-0.2.5/examples/view/plot_roc.py
+-rw-rw-rw-   0        0        0      794 2023-01-11 16:20:19.000000 watex-0.2.5/examples/view/plot_scatter.py
+-rw-rw-rw-   0        0        0     1523 2023-01-11 16:20:37.000000 watex-0.2.5/examples/view/plot_scattering_features.py
+-rw-rw-rw-   0        0        0      543 2023-01-08 08:52:36.000000 watex-0.2.5/examples/view/plot_silhouette.py
+-rw-rw-rw-   0        0        0      759 2023-01-09 07:56:02.000000 watex-0.2.5/examples/view/plot_single_site_signal_recovery.py
+-rw-rw-rw-   0        0        0      834 2023-01-11 16:21:15.000000 watex-0.2.5/examples/view/plot_target_inspection.py
+-rw-rw-rw-   0        0        0     1615 2023-06-22 05:08:26.000000 watex-0.2.5/pyproject.toml
+-rw-rw-rw-   0        0        0      901 2023-06-22 07:45:30.718607 watex-0.2.5/setup.cfg
+-rw-rw-rw-   0        0        0     4646 2023-05-25 04:59:14.000000 watex-0.2.5/setup.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.479707 watex-0.2.5/watex/
+-rw-rw-rw-   0        0        0     8552 2023-06-20 12:24:38.000000 watex-0.2.5/watex/__init__.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.514360 watex-0.2.5/watex/_build/
+-rw-rw-rw-   0        0        0       27 2023-03-11 03:28:02.000000 watex-0.2.5/watex/_build/__init__.py
+-rw-rw-rw-   0        0        0       30 2023-01-08 08:20:47.000000 watex-0.2.5/watex/_build/_check_build.pyx
+-rw-rw-rw-   0        0        0      333 2023-01-08 08:20:47.000000 watex-0.2.5/watex/_distributor_init.py
+-rw-rw-rw-   0        0        0    32160 2023-06-17 08:36:57.000000 watex-0.2.5/watex/_docstring.py
+-rw-rw-rw-   0        0        0     3852 2023-03-11 03:28:02.000000 watex-0.2.5/watex/_isotonic.pyx
+-rw-rw-rw-   0        0        0    17770 2023-04-14 23:54:09.000000 watex-0.2.5/watex/_typing.py
+-rw-rw-rw-   0        0        0      218 2023-06-22 07:45:29.000000 watex-0.2.5/watex/_version.py
+-rw-rw-rw-   0        0        0     8798 2023-03-12 01:49:05.000000 watex-0.2.5/watex/_watexlog.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.516764 watex-0.2.5/watex/analysis/
+-rw-rw-rw-   0        0        0     1242 2023-02-04 08:11:48.000000 watex-0.2.5/watex/analysis/__init__.py
+-rw-rw-rw-   0        0        0    23341 2023-01-18 16:30:53.000000 watex-0.2.5/watex/analysis/decomposition.py
+-rw-rw-rw-   0        0        0    25575 2023-02-05 12:23:26.000000 watex-0.2.5/watex/analysis/dimensionality.py
+-rw-rw-rw-   0        0        0     9305 2023-02-04 08:20:23.000000 watex-0.2.5/watex/analysis/factor.py
+-rw-rw-rw-   0        0        0    85025 2023-03-12 01:49:14.000000 watex-0.2.5/watex/base.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.519790 watex-0.2.5/watex/cases/
+-rw-rw-rw-   0        0        0     1078 2023-01-12 16:27:24.000000 watex-0.2.5/watex/cases/__init__.py
+-rw-rw-rw-   0        0        0    38684 2023-03-12 01:39:59.000000 watex-0.2.5/watex/cases/features.py
+-rw-rw-rw-   0        0        0    31952 2023-03-12 01:40:49.000000 watex-0.2.5/watex/cases/modeling.py
+-rw-rw-rw-   0        0        0    39022 2023-03-12 01:40:40.000000 watex-0.2.5/watex/cases/prepare.py
+-rw-rw-rw-   0        0        0    49220 2023-03-12 01:41:33.000000 watex-0.2.5/watex/cases/processing.py
+-rw-rw-rw-   0        0        0     1353 2023-03-15 12:48:58.000000 watex-0.2.5/watex/cli.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.526982 watex-0.2.5/watex/datasets/
+-rw-rw-rw-   0        0        0      911 2023-06-20 13:03:34.000000 watex-0.2.5/watex/datasets/__init__.py
+-rw-rw-rw-   0        0        0     7785 2023-03-21 13:31:09.000000 watex-0.2.5/watex/datasets/_config.py
+-rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/_hongliu.py
+-rw-rw-rw-   0        0        0     5677 2023-03-21 13:58:43.000000 watex-0.2.5/watex/datasets/_p.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.568114 watex-0.2.5/watex/datasets/data/
+-rw-rw-rw-   0        0        0       27 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/data/__init__.py
+-rw-rw-rw-   0        0        0   328758 2023-03-20 17:59:44.000000 watex-0.2.5/watex/datasets/data/b.pkl
+-rw-rw-rw-   0        0        0    34993 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/data/bagoue.csv
+-rw-rw-rw-   0        0        0    35250 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/data/boston_house_prices.csv
+-rw-rw-rw-   0        0        0      638 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/data/boundiali_ves.csv
+-rw-rw-rw-   0        0        0     1158 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/data/dcerp_gbalo.csv
+-rw-rw-rw-   0        0        0      699 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/data/dcves_gbalo.csv
+-rw-rw-rw-   0        0        0  2216584 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/data/e.h5
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.571481 watex-0.2.5/watex/datasets/data/edis/
+-rw-rw-rw-   0        0        0        4 2023-02-24 10:23:34.000000 watex-0.2.5/watex/datasets/data/edis/__init__.py
+-rw-rw-rw-   0        0        0   170380 2023-02-24 10:23:34.000000 watex-0.2.5/watex/datasets/data/edis/raw.E.zip
+-rw-rw-rw-   0        0        0   184986 2023-02-24 10:23:34.000000 watex-0.2.5/watex/datasets/data/edis/s.E.zip
+-rw-rw-rw-   0        0        0 11940145 2023-05-05 12:57:48.000000 watex-0.2.5/watex/datasets/data/h.h5
+-rw-rw-rw-   0        0        0     2885 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/data/iris.csv
+-rw-rw-rw-   0        0        0   731414 2023-05-05 12:57:48.000000 watex-0.2.5/watex/datasets/data/mxs.joblib
+-rw-rw-rw-   0        0        0     6955 2023-06-20 12:17:20.000000 watex-0.2.5/watex/datasets/data/nlogs+.csv
+-rw-rw-rw-   0        0        0    13993 2023-06-20 12:17:20.000000 watex-0.2.5/watex/datasets/data/nlogs.csv
+-rw-rw-rw-   0        0        0      603 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/data/semien_ves.csv
+-rw-rw-rw-   0        0        0     2230 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/data/tankesse.csv
+-rw-rw-rw-   0        0        0    11336 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/data/wine_data.csv
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.582319 watex-0.2.5/watex/datasets/descr/
+-rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/descr/__init__.py
+-rw-rw-rw-   0        0        0     2827 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/descr/bagoue.rst
+-rw-rw-rw-   0        0        0     2397 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/descr/boston_house_prices.rst
+-rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/descr/boundiali_ves.rst
+-rw-rw-rw-   0        0        0     1822 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/descr/california_housing.rst
+-rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/descr/gbalo_erp.rst
+-rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/descr/gbalo_ves.rst
+-rw-rw-rw-   0        0        0     2845 2023-06-20 12:17:20.000000 watex-0.2.5/watex/datasets/descr/huayuan_edis.rst
+-rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/descr/iris.rst
+-rw-rw-rw-   0        0        0     3381 2023-06-20 12:17:20.000000 watex-0.2.5/watex/datasets/descr/nanshang+.rst
+-rw-rw-rw-   0        0        0     2332 2023-06-20 12:17:20.000000 watex-0.2.5/watex/datasets/descr/nanshang.rst
+-rw-rw-rw-   0        0        0     3544 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/descr/wine_data.rst
+-rw-rw-rw-   0        0        0    52573 2023-06-20 12:38:30.000000 watex-0.2.5/watex/datasets/dload.py
+-rw-rw-rw-   0        0        0    17331 2023-05-05 12:57:48.000000 watex-0.2.5/watex/datasets/gdata.py
+-rw-rw-rw-   0        0        0    13639 2023-03-24 15:43:33.000000 watex-0.2.5/watex/datasets/io.py
+-rw-rw-rw-   0        0        0    34896 2023-03-12 01:42:57.000000 watex-0.2.5/watex/datasets/rload.py
+-rw-rw-rw-   0        0        0     7180 2023-06-20 12:17:20.000000 watex-0.2.5/watex/datasets/sets.py
+-rw-rw-rw-   0        0        0      822 2023-01-08 08:20:47.000000 watex-0.2.5/watex/datasets/setup.py
+-rw-rw-rw-   0        0        0   101919 2023-06-21 11:42:13.000000 watex-0.2.5/watex/decorators.py
+-rw-rw-rw-   0        0        0   115869 2023-03-23 14:01:07.000000 watex-0.2.5/watex/edi.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.592416 watex-0.2.5/watex/etc/
+-rw-rw-rw-   0        0        0     5711 2023-01-08 08:20:47.000000 watex-0.2.5/watex/etc/AGSO.csv
+-rw-rw-rw-   0        0        0      351 2023-01-08 08:20:47.000000 watex-0.2.5/watex/etc/AGSO_STCODES.csv
+-rw-rw-rw-   0        0        0    14650 2023-03-20 14:32:57.000000 watex-0.2.5/watex/etc/__XTyT.pkl
+-rw-rw-rw-   0        0        0    37763 2023-03-20 16:12:55.000000 watex-0.2.5/watex/etc/__Xy.pkl
+-rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.5/watex/etc/__init__.py
+-rw-rw-rw-   0        0        0   978190 2023-06-22 04:42:01.000000 watex-0.2.5/watex/etc/__memory.pkl
+-rw-rw-rw-   0        0        0    28672 2023-01-08 08:20:47.000000 watex-0.2.5/watex/etc/memory.sq3
+-rw-rw-rw-   0        0        0 52244397 2023-01-08 08:20:47.000000 watex-0.2.5/watex/etc/p.models.pkl
+-rw-rw-rw-   0        0        0     9763 2023-06-21 11:42:13.000000 watex-0.2.5/watex/exceptions.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.664181 watex-0.2.5/watex/exlib/
+-rw-rw-rw-   0        0        0     4022 2023-03-27 14:03:16.000000 watex-0.2.5/watex/exlib/__init__.py
+-rw-rw-rw-   0        0        0     2580 2023-03-15 12:48:58.000000 watex-0.2.5/watex/exlib/gbm.py
+-rw-rw-rw-   0        0        0     7156 2023-03-12 01:43:33.000000 watex-0.2.5/watex/exlib/sklearn.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.669201 watex-0.2.5/watex/externals/
+-rw-rw-rw-   0        0        0      313 2023-01-18 17:47:22.000000 watex-0.2.5/watex/externals/__init__.py
+-rw-rw-rw-   0        0        0     4835 2023-01-08 08:20:47.000000 watex-0.2.5/watex/externals/_numpy_compiler_patch.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.671147 watex-0.2.5/watex/externals/_pkgs/
+-rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.5/watex/externals/_pkgs/__init__.py
+-rw-rw-rw-   0        0        0     3035 2023-01-08 08:20:47.000000 watex-0.2.5/watex/externals/_pkgs/_structures.py
+-rw-rw-rw-   0        0        0    16762 2023-01-08 08:20:47.000000 watex-0.2.5/watex/externals/_pkgs/version.py
+-rw-rw-rw-   0        0        0      273 2023-01-08 08:20:47.000000 watex-0.2.5/watex/externals/readme.md
+-rw-rw-rw-   0        0        0    57854 2023-03-23 14:01:07.000000 watex-0.2.5/watex/externals/z.py
+-rw-rw-rw-   0        0        0    24161 2023-03-12 01:43:53.000000 watex-0.2.5/watex/externals/zutils.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.677223 watex-0.2.5/watex/geology/
+-rw-rw-rw-   0        0        0     1067 2023-06-17 08:36:57.000000 watex-0.2.5/watex/geology/__init__.py
+-rw-rw-rw-   0        0        0    12712 2023-06-22 04:42:01.000000 watex-0.2.5/watex/geology/core.py
+-rw-rw-rw-   0        0        0    56354 2023-03-12 01:44:15.000000 watex-0.2.5/watex/geology/database.py
+-rw-rw-rw-   0        0        0   130836 2023-06-22 07:24:02.000000 watex-0.2.5/watex/geology/drilling.py
+-rw-rw-rw-   0        0        0    14488 2023-05-24 12:02:39.000000 watex-0.2.5/watex/geology/geology.py
+-rw-rw-rw-   0        0        0    73452 2023-06-22 04:42:01.000000 watex-0.2.5/watex/geology/stratigraphic.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.684363 watex-0.2.5/watex/methods/
+-rw-rw-rw-   0        0        0      867 2023-04-15 15:25:13.000000 watex-0.2.5/watex/methods/__init__.py
+-rw-rw-rw-   0        0        0    82817 2023-04-22 06:56:19.000000 watex-0.2.5/watex/methods/electrical.py
+-rw-rw-rw-   0        0        0   136679 2023-05-14 09:33:31.000000 watex-0.2.5/watex/methods/em.py
+-rw-rw-rw-   0        0        0    86661 2023-04-22 06:56:19.000000 watex-0.2.5/watex/methods/erp.py
+-rw-rw-rw-   0        0        0    43855 2023-03-12 01:45:26.000000 watex-0.2.5/watex/methods/hydro.py
+-rw-rw-rw-   0        0        0    28992 2023-05-24 12:02:39.000000 watex-0.2.5/watex/metrics.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.687308 watex-0.2.5/watex/models/
+-rw-rw-rw-   0        0        0     1064 2023-03-24 12:58:06.000000 watex-0.2.5/watex/models/__init__.py
+-rw-rw-rw-   0        0        0     6889 2023-03-15 12:48:58.000000 watex-0.2.5/watex/models/_metapredictors.py
+-rw-rw-rw-   0        0        0    18878 2023-03-15 12:48:58.000000 watex-0.2.5/watex/models/premodels.py
+-rw-rw-rw-   0        0        0    44482 2023-03-28 11:58:09.000000 watex-0.2.5/watex/models/validation.py
+-rw-rw-rw-   0        0        0    73934 2023-06-22 04:42:01.000000 watex-0.2.5/watex/property.py
+-rw-rw-rw-   0        0        0    51498 2023-06-22 07:29:40.000000 watex-0.2.5/watex/site.py
+-rw-rw-rw-   0        0        0    61886 2023-06-17 08:36:57.000000 watex-0.2.5/watex/transformers.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.710803 watex-0.2.5/watex/utils/
+-rw-rw-rw-   0        0        0     6196 2023-06-21 11:42:13.000000 watex-0.2.5/watex/utils/__init__.py
+-rw-rw-rw-   0        0        0     7140 2023-01-08 08:20:47.000000 watex-0.2.5/watex/utils/_array_api.py
+-rw-rw-rw-   0        0        0     7730 2023-01-08 08:20:47.000000 watex-0.2.5/watex/utils/_arraytools.py
+-rw-rw-rw-   0        0        0     5936 2023-02-01 06:46:13.000000 watex-0.2.5/watex/utils/_dependency.py
+-rw-rw-rw-   0        0        0      222 2023-01-08 08:20:47.000000 watex-0.2.5/watex/utils/_openmp_helpers.pxd
+-rw-rw-rw-   0        0        0     2674 2023-01-08 08:20:47.000000 watex-0.2.5/watex/utils/_openmp_helpers.pyx
+-rw-rw-rw-   0        0        0    16659 2023-01-28 02:10:06.000000 watex-0.2.5/watex/utils/_packaging_version.py
+-rw-rw-rw-   0        0        0     1616 2023-03-28 11:58:09.000000 watex-0.2.5/watex/utils/_set_gdal.py
+-rw-rw-rw-   0        0        0     2583 2023-02-16 08:00:08.000000 watex-0.2.5/watex/utils/_show_versions.py
+-rw-rw-rw-   0        0        0    13908 2023-05-26 13:32:06.000000 watex-0.2.5/watex/utils/box.py
+-rw-rw-rw-   0        0        0    98080 2023-06-18 14:15:21.000000 watex-0.2.5/watex/utils/coreutils.py
+-rw-rw-rw-   0        0        0   580618 2023-01-08 08:20:47.000000 watex-0.2.5/watex/utils/epsg.npy
+-rw-rw-rw-   0        0        0   232345 2023-06-22 07:30:24.000000 watex-0.2.5/watex/utils/exmath.py
+-rw-rw-rw-   0        0        0   252184 2023-06-21 11:42:13.000000 watex-0.2.5/watex/utils/funcutils.py
+-rw-rw-rw-   0        0        0    82957 2023-06-22 07:00:16.000000 watex-0.2.5/watex/utils/geotools.py
+-rw-rw-rw-   0        0        0    58698 2023-03-28 11:58:09.000000 watex-0.2.5/watex/utils/gistools.py
+-rw-rw-rw-   0        0        0   139514 2023-06-22 04:42:01.000000 watex-0.2.5/watex/utils/hydroutils.py
+-rw-rw-rw-   0        0        0   122844 2023-05-24 12:02:39.000000 watex-0.2.5/watex/utils/mlutils.py
+-rw-rw-rw-   0        0        0   139113 2023-06-22 05:05:15.000000 watex-0.2.5/watex/utils/plotutils.py
+-rw-rw-rw-   0        0        0      974 2023-01-08 08:20:47.000000 watex-0.2.5/watex/utils/setup.py
+-rw-rw-rw-   0        0        0     3548 2023-01-08 08:20:47.000000 watex-0.2.5/watex/utils/thread.py
+-rw-rw-rw-   0        0        0    86096 2023-06-17 08:36:57.000000 watex-0.2.5/watex/utils/validator.py
+-rw-rw-rw-   0        0        0    16835 2023-01-28 01:30:49.000000 watex-0.2.5/watex/utils/version.py
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.714229 watex-0.2.5/watex/view/
+-rw-rw-rw-   0        0        0     1008 2023-02-24 10:23:34.000000 watex-0.2.5/watex/view/__init__.py
+-rw-rw-rw-   0        0        0   145840 2023-05-14 06:19:47.000000 watex-0.2.5/watex/view/mlplot.py
+-rw-rw-rw-   0        0        0   190822 2023-04-22 06:56:19.000000 watex-0.2.5/watex/view/plot.py
+-rw-rw-rw-   0        0        0     1222 2023-03-11 03:28:02.000000 watex-0.2.5/watex/wlog.yml
+drwxrwxrwx   0        0        0        0 2023-06-22 07:45:30.512398 watex-0.2.5/watex.egg-info/
+-rw-rw-rw-   0        0        0    15816 2023-06-22 07:45:29.000000 watex-0.2.5/watex.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0     9678 2023-06-22 07:45:30.000000 watex-0.2.5/watex.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-06-22 07:45:29.000000 watex-0.2.5/watex.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       83 2023-06-22 07:45:29.000000 watex-0.2.5/watex.egg-info/entry_points.txt
+-rw-rw-rw-   0        0        0      366 2023-06-22 07:45:29.000000 watex-0.2.5/watex.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        6 2023-06-22 07:45:29.000000 watex-0.2.5/watex.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0        2 2023-06-22 07:44:19.000000 watex-0.2.5/watex.egg-info/zip-safe
```

### Comparing `watex-0.2.4/.github/dependabot.yml` & `watex-0.2.5/.github/dependabot.yml`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/.github/workflows/ci.yaml` & `watex-0.2.5/.github/workflows/ci.yaml`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/.github/workflows/codeql.yml` & `watex-0.2.5/.github/workflows/codeql.yml`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/.github/workflows/dependency-review.yml` & `watex-0.2.5/.github/workflows/dependency-review.yml`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/.github/workflows/python-package.yml` & `watex-0.2.5/.github/workflows/python-package.yml`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/.gitignore` & `watex-0.2.5/.gitignore`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/CITATION.cff` & `watex-0.2.5/CITATION.cff`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/LICENSE` & `watex-0.2.5/LICENSE`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/MANIFEST.in` & `watex-0.2.5/MANIFEST.in`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/PKG-INFO` & `watex-0.2.5/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: watex
-Version: 0.2.4
+Version: 0.2.5
 Summary: Machine learning research in water exploration
 Home-page: https://github.com/WEgeophysics/watex
 Download-URL: https://pypi.org/project/watex/#files
 Author: Laurent Kouadio
 Author-email: etanoyau@gmail.com
 Maintainer: Laurent Kouadio
 Maintainer-email: etanoyau@gmail.com
```

### Comparing `watex-0.2.4/README.md` & `watex-0.2.5/README.md`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/Makefile` & `watex-0.2.5/docs/Makefile`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/copybutton.js` & `watex-0.2.5/docs/_static/copybutton.js`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/css/bootstrap.min.css` & `watex-0.2.5/docs/_static/css/bootstrap.min.css`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/css/custom.css` & `watex-0.2.5/docs/_static/css/custom.css`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/favicon.ico` & `watex-0.2.5/docs/_static/favicon.ico`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/favicon0.ico` & `watex-0.2.5/docs/_static/favicon0.ico`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/favicon_old.ico` & `watex-0.2.5/docs/_static/favicon_old.ico`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/index_api.svg` & `watex-0.2.5/docs/_static/index_api.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/index_contribute.svg` & `watex-0.2.5/docs/_static/index_contribute.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/index_getting_started.svg` & `watex-0.2.5/docs/_static/index_getting_started.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/index_user_guide.svg` & `watex-0.2.5/docs/_static/index_user_guide.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/js/vendor/bootstrap.min.js` & `watex-0.2.5/docs/_static/js/vendor/bootstrap.min.js`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/js/vendor/jquery-3.6.3.slim.min.js` & `watex-0.2.5/docs/_static/js/vendor/jquery-3.6.3.slim.min.js`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/logo.svg` & `watex-0.2.5/docs/_static/logo.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/logo_no_name.svg` & `watex-0.2.5/docs/_static/logo_no_name.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/logo_small.svg` & `watex-0.2.5/docs/_static/logo_small.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/logo_wide.svg` & `watex-0.2.5/docs/_static/logo_wide.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/logo_wide_rev.svg` & `watex-0.2.5/docs/_static/logo_wide_rev.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/logo_wide_rev0.svg` & `watex-0.2.5/docs/_static/logo_wide_rev0.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/switcher.json` & `watex-0.2.5/docs/_static/switcher.json`

 * *Files 15% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.85%*

 * *Differences: {'0': "{'version': 'v0.2.6'}",*

 * * '2': "{'name': '0.2.4', 'version': 'v0.2.4'}",*

 * * 'insert': "[(1, OrderedDict([('name', '0.2.5 (stable)'), ('version', 'stable'), ('url', "*

 * *           "'https://watex.readthedocs.io/en/stable/')]))]"}*

```diff
@@ -1,19 +1,24 @@
 [
     {
         "name": "dev",
         "url": "https://watex.readthedocs.io/en/latest/",
-        "version": "v0.2.5"
+        "version": "v0.2.6"
     },
     {
-        "name": "0.2.4(stable)",
-        "url": "https://watex.readthedocs.io/en/0.2.4/",
+        "name": "0.2.5 (stable)",
+        "url": "https://watex.readthedocs.io/en/stable/",
         "version": "stable"
     },
     {
+        "name": "0.2.4",
+        "url": "https://watex.readthedocs.io/en/0.2.4/",
+        "version": "v0.2.4"
+    },
+    {
         "name": "0.2.3",
         "url": "https://watex.readthedocs.io/en/0.2.3/",
         "version": "v0.2.3"
     },
     {
         "name": "0.2.2",
         "url": "https://watex.readthedocs.io/en/0.2.2/",
```

### Comparing `watex-0.2.4/docs/_static/to_favicon.svg` & `watex-0.2.5/docs/_static/to_favicon.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/watex_thumb_image.svg` & `watex-0.2.5/docs/_static/watex_thumb_image.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_static/watex_workflow.svg` & `watex-0.2.5/docs/_static/watex_workflow.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_templates/javascript.html` & `watex-0.2.5/docs/_templates/javascript.html`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/_templates/layout.html` & `watex-0.2.5/docs/_templates/layout.html`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/analysis.rst` & `watex-0.2.5/docs/analysis.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/api_references.rst` & `watex-0.2.5/docs/api_references.rst`

 * *Files 1% similar despite different names*

```diff
@@ -150,14 +150,15 @@
 	datasets.load_boundiali
 	datasets.load_edis
 	datasets.load_gbalo
 	datasets.load_hlogs
 	datasets.load_huayuan
 	datasets.load_iris
 	datasets.load_mxs
+	datasets.load_nlogs
 	datasets.load_semien
 	datasets.load_tankesse
 	datasets.make_erp 
 	datasets.make_ves 
 	
 .. _edi_ref:
 
@@ -302,15 +303,14 @@
 
 	geology.geology.setstructures 
 	geology.core.get_agso_properties
 	geology.core.mapping_stratum
 	geology.core.fetching_data_from_repo
 	geology.core.set_agso_properties
 
-	
 .. _methods_ref:
 
 :mod:`watex.methods`:  Methods
 =========================================
 
 .. automodule:: watex.methods
    :no-members:
@@ -581,14 +581,15 @@
 .. currentmodule:: watex
 
 .. autosummary::
    :toctree: generated/
    :template: function.rst
 
     utils.bi_selector
+	utils.build_random_thickness
 	utils.cattarget
 	utils.check_flow_objectivity
 	utils.classify_k
 	utils.correlatedfeatures
 	utils.cleaner
 	utils.defineConductiveZone
 	utils.erpSelector
@@ -598,20 +599,22 @@
 	utils.find_aquifer_groups
 	utils.find_similar_labels
 	utils.fittensor
 	utils.getGlobalScore
 	utils.get2dtensor
 	utils.get_aquifer_section
 	utils.get_aquifer_sections
+	utils.get_azimuth 
 	utils.get_compressed_vector
 	utils.get_bearing
 	utils.get_distance
 	utils.get_full_frequency
 	utils.get_profile_angle
 	utils.get_sections_from_depth
+	utils.smart_thickness_ranker
 	utils.get_strike
 	utils.get_target
 	utils.get_unique_section
 	utils.get_xs_xr_splits
 	utils.interpolate1d
 	utils.interpolate2d
 	utils.interpolate_grid
@@ -640,14 +643,15 @@
 	utils.plot_mlxtend_matrix
 	utils.plot_naive_dendrogram
 	utils.plot_pca_components
 	utils.plot_regularization_path
 	utils.plot_rf_feature_importances
 	utils.plot_roc_curves
 	utils.plot_sbs_feature_selection
+	utils.plot_stratalog
 	utils.plot_silhouette
 	utils.plot_skew
 	utils.plot_strike
 	utils.plot_voronoi
 	utils.plot_yb_confusion_matrix
 	utils.power
 	utils.predict_NGA_labels
@@ -863,22 +867,25 @@
    :toctree: generated/
    :template: function.rst
 
 	utils.geotools.assert_station
 	utils.geotools.base_log
 	utils.geotools.fit_rocks
 	utils.geotools.fit_stratum_property
+	utils.geotools.get_thick_from_range 
+	utils.geotools.get_thick_from_values 
 	utils.geotools.get_s_thicknesses
 	utils.geotools.grouped_items
 	utils.geotools.lns_and_tres_split
 	utils.geotools.map_bottom
 	utils.geotools.map_top
 	utils.geotools.set_default_hatch_color_values
 	utils.geotools.smart_zoom
 	utils.geotools.zoom_processing
+	
 
 .. _view_ref:
 
 
 :mod:`watex.view`: Plotting 
 ===============================
```

### Comparing `watex-0.2.4/docs/base.rst` & `watex-0.2.5/docs/base.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/cases.rst` & `watex-0.2.5/docs/cases.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/citing.rst` & `watex-0.2.5/docs/citing.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/community/CONTRIBUTING.md` & `watex-0.2.5/docs/community/CONTRIBUTING.md`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/conf.py` & `watex-0.2.5/docs/conf.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/datasets.rst` & `watex-0.2.5/docs/datasets.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/development.rst` & `watex-0.2.5/docs/development.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/example_thumbs/watex_workflow.gif` & `watex-0.2.5/docs/example_thumbs/watex_workflow.gif`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/glossary.rst` & `watex-0.2.5/docs/glossary.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/history/five_min_understanding.rst` & `watex-0.2.5/docs/history/five_min_understanding.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/history/project_goals.rst` & `watex-0.2.5/docs/history/project_goals.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/history/project_story.rst` & `watex-0.2.5/docs/history/project_story.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/includes/big_toc_css.rst` & `watex-0.2.5/docs/includes/big_toc_css.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/includes/bigger_toc_css.rst` & `watex-0.2.5/docs/includes/bigger_toc_css.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/index.rst` & `watex-0.2.5/docs/index.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/installation.rst` & `watex-0.2.5/docs/installation.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/make.bat` & `watex-0.2.5/docs/make.bat`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/methods.rst` & `watex-0.2.5/docs/methods.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/requirements.txt` & `watex-0.2.5/docs/requirements.txt`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/source/index.html` & `watex-0.2.5/docs/source/index.html`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/sphinxext/add_toctree_functions.py` & `watex-0.2.5/docs/sphinxext/add_toctree_functions.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/sphinxext/doi_role.py` & `watex-0.2.5/docs/sphinxext/doi_role.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/sphinxext/sphinx_issues.py` & `watex-0.2.5/docs/sphinxext/sphinx_issues.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/structure.rst` & `watex-0.2.5/docs/structure.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/tune_toc.rst` & `watex-0.2.5/docs/tune_toc.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/utils.rst` & `watex-0.2.5/docs/utils.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/view.rst` & `watex-0.2.5/docs/view.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/index.rst` & `watex-0.2.5/docs/whatsnew/index.rst`

 * *Files 1% similar despite different names*

```diff
@@ -10,14 +10,15 @@
 
 Version 0.2
 -------------
 
 .. toctree::
    :maxdepth: 2
    
+   v0.2.5
    v0.2.4
    v0.2.3
    v0.2.2
    v0.2.1
    v0.2.0
```

### Comparing `watex-0.2.4/docs/whatsnew/v0.1.0.rst` & `watex-0.2.5/docs/whatsnew/v0.1.0.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.1.1.rst` & `watex-0.2.5/docs/whatsnew/v0.1.1.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.1.2.rst` & `watex-0.2.5/docs/whatsnew/v0.1.2.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.1.3.rst` & `watex-0.2.5/docs/whatsnew/v0.1.3.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.1.4.rst` & `watex-0.2.5/docs/whatsnew/v0.1.4.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.1.5.rst` & `watex-0.2.5/docs/whatsnew/v0.1.5.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.1.6-alpha.rst` & `watex-0.2.5/docs/whatsnew/v0.1.6-alpha.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.1.6.rst` & `watex-0.2.5/docs/whatsnew/v0.1.6.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.1.7.rst` & `watex-0.2.5/docs/whatsnew/v0.1.7.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.1.8.rst` & `watex-0.2.5/docs/whatsnew/v0.1.8.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.1.9.rst` & `watex-0.2.5/docs/whatsnew/v0.1.9.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.2.0.rst` & `watex-0.2.5/docs/whatsnew/v0.2.0.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.2.1.rst` & `watex-0.2.5/docs/whatsnew/v0.2.1.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.2.2.rst` & `watex-0.2.5/docs/whatsnew/v0.2.2.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.2.3.rst` & `watex-0.2.5/docs/whatsnew/v0.2.3.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/docs/whatsnew/v0.2.4.rst` & `watex-0.2.5/docs/whatsnew/v0.2.4.rst`

 * *Files 0% similar despite different names*

```diff
@@ -47,15 +47,15 @@
      >>> X_scaled = wx.datasets.load_mxs (key ='scale').X 
      >>> # or by merely calling the boilerplate `fetch_data` function as 
      >>> X_scaled =wx.fetch_data ('mxs', key ='scale').X 
 
   It also accepts `test_ratio` to split the training and test sets via  ``split_X_y=True``. Note that ``return_X_y=True``  is not necessary when 
   `split_X_y` is set to ``True``. 
 
-- |Enhancement | :class:`watex.transformers.featurize_X` accepts `model` as parameter. It is  useful to featurize the test data separately 
+- |Enhancement| :class:`watex.transformers.featurize_X` accepts `model` as parameter. It is  useful to featurize the test data separately 
   from the train data to avoid leakage information. If `sparse` parameter is set to ``True``, the training and testing data are outputted in sparse coordinates format 
   or compressed sparse row format that is controlled by the `sparsity` parameter.
```

### Comparing `watex-0.2.4/examples/analysis/plot_decision_regions.py` & `watex-0.2.5/examples/analysis/plot_decision_regions.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/analysis/plot_explained_variance_ratio.py` & `watex-0.2.5/examples/analysis/plot_explained_variance_ratio.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/analysis/plot_linear_discriminant_analysis.py` & `watex-0.2.5/examples/analysis/plot_linear_discriminant_analysis.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/analysis/plot_pca_vs_factor_with_scedatic_noises.py` & `watex-0.2.5/examples/analysis/plot_pca_vs_factor_with_scedatic_noises.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/applications/plot_auto_detect_drilling_location.py` & `watex-0.2.5/examples/applications/plot_auto_detect_drilling_location.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/applications/plot_data_exploratory_quick_view.py` & `watex-0.2.5/examples/applications/plot_data_exploratory_quick_view.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/applications/plot_dc_em_parameters_computings.py` & `watex-0.2.5/examples/applications/plot_dc_em_parameters_computings.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/applications/plot_flow_rate_prediction.py` & `watex-0.2.5/examples/applications/plot_flow_rate_prediction.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/applications/plot_kmf.py` & `watex-0.2.5/examples/applications/plot_kmf.py`

 * *Files 4% similar despite different names*

```diff
@@ -5,35 +5,38 @@
 Featurize data for boosting the prediction and 
 enforce the model to generalization 
 
 """
 # License: BSD-3-clause
 # Author: L.Kouadio 
 #%% 
-# KMeans Featurisation ( KMF) is a surrogate booster to predict permeability 
-# coefficient (k) before any drilling construction. Indeed, KMF creates a 
-# compressed spatial index of the data which can be fed into the model for ease 
-# of learning and enforce the model capability of generalization. A new 
-# predictor based on model stacking technique is built with full target k 
-# which balances the spatial distribution of k-labels by clustering the original data. 
+# KMeans Featurisation ( KMF) is a surrogate booster use to enforce model 
+# to generalization with an optimal score. Here, the example focuses on predicting 
+# the permeability coefficient (K) also known as Hydraulic conductivity in 
+# civil engineering. K is collected during the pumping set for a successful 
+# drilling construction. Indeed, KMF creates a compressed spatial index 
+# can be fed into the model for ease  of the data which of learning and enforce
+# the model capability of generalization. A new predictor based on model
+# stacking technique is built with full target K which balances the
+#  spatial distribution of k-labels by clustering the original data. 
 
 #%% 
 # We start by importing the required modules 
 import copy 
 import matplotlib.pyplot as plt
 import scipy 
 import numpy as np 
 
 from sklearn.datasets import make_moons
-from sklearn.linear_model import LogisticRegression
 from sklearn.ensemble import GradientBoostingClassifier
-from watex.datasets import load_mxs 
+from sklearn.linear_model import LogisticRegression
 
+from watex.datasets import load_mxs
+from watex.exlib import train_test_split, XGBClassifier, roc_auc_score,roc_curve 
 from watex.transformers import featurize_X,  KMeansFeaturizer
-from watex.exlib import train_test_split, XGBClassifier, roc_auc_score,roc_curve
 from watex.utils import plot_voronoi, plot_roc_curves, replace_data
 
 # %% 
 # * Set the adjusted models XGBClassifiers and Gradient Boosting trees.
 # 
 # Classifiers are initialized with fined tuned values and fixed the seed to ``0``
 # for data reproducing. 
@@ -152,17 +155,17 @@
 # Figure shows that the performace of fined_tuned XGB is greater than 
 # The fine-tuned XGB and LR without applying the KMFeatures. 
 # 
 # * Plot separetly LR and BoostTrees with KMF
 
 clfs = copy.deepcopy([classifiers[-1]]) 
 clfs_cluster = [m.fit( training_with_cluster, training_labels) for m in clfs ]
-ax = plot_roc_curves(clfs_cluster, test_with_cluster, test_labels, all=True, ncols = 2, 
+ax = plot_roc_curves(clfs_cluster, test_with_cluster, test_labels, kind='2', ncols = 2, 
                 fig_size = (10, 4), names = ['Boostree with KMF '], 
-                colors =['orange', 'r'], get_score =True )
+                colors =['orange', 'r'], score =True )
 
 for i, model in enumerate(clfs):
     model.fit(training_data, training_labels)
     fpr, tpr , auc_score = test_roc(model, test_data, test_labels)
     ax[1] .plot(fpr, tpr, label=classifier_names[-1] + f' AUC ={round(auc_score,2)}')
     ax[1].legend() 
 #%%
```

### Comparing `watex-0.2.4/examples/applications/plot_nsamt_tensor_recovery.py` & `watex-0.2.5/examples/applications/plot_nsamt_tensor_recovery.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/applications/plot_tensor_restoring.py` & `watex-0.2.5/examples/applications/plot_tensor_restoring.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/applications/plot_ymxs_label_for_k_prediction.py` & `watex-0.2.5/examples/applications/plot_ymxs_label_for_k_prediction.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/base/plot_ada_gd.py` & `watex-0.2.5/examples/base/plot_ada_gd.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/base/plot_ada_stochastic_gd.py` & `watex-0.2.5/examples/base/plot_ada_stochastic_gd.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/base/plot_missing.py` & `watex-0.2.5/examples/base/plot_missing.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/base/plot_sbs_feature_selector.py` & `watex-0.2.5/examples/base/plot_sbs_feature_selector.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/methods/plot_2d_tensor_filtered.py` & `watex-0.2.5/examples/methods/plot_2d_tensor_filtered.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/methods/plot_anomaly.py` & `watex-0.2.5/examples/methods/plot_anomaly.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/methods/plot_filtered_tensors.py` & `watex-0.2.5/examples/methods/plot_filtered_tensors.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/methods/plot_logging_predictor_and_target.py` & `watex-0.2.5/examples/methods/plot_logging_predictor_and_target.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/methods/plot_logging_predictor_only.py` & `watex-0.2.5/examples/methods/plot_logging_predictor_only.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/methods/plot_multiple_sites_recovery_signal.py` & `watex-0.2.5/examples/methods/plot_multiple_sites_recovery_signal.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/methods/plot_phase_tensors.py` & `watex-0.2.5/examples/methods/plot_phase_tensors.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/methods/plot_raw_2d_tensor.py` & `watex-0.2.5/examples/methods/plot_raw_2d_tensor.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/methods/plot_ves_fracture_zone.py` & `watex-0.2.5/examples/methods/plot_ves_fracture_zone.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_clusters.py` & `watex-0.2.5/examples/utils/plot_clusters.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_confidence_in_data.py` & `watex-0.2.5/examples/utils/plot_confidence_in_data.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_confusion_matrices.py` & `watex-0.2.5/examples/utils/plot_confusion_matrices.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_confusion_matrix_sweet.py` & `watex-0.2.5/examples/utils/plot_confusion_matrix_sweet.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_elbow.py` & `watex-0.2.5/examples/utils/plot_elbow.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_erp.py` & `watex-0.2.5/examples/utils/plot_erp.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_errors_vs_epochs.py` & `watex-0.2.5/examples/utils/plot_errors_vs_epochs.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_ex_heatmap.py` & `watex-0.2.5/examples/utils/plot_ex_heatmap.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_ex_matrix.py` & `watex-0.2.5/examples/utils/plot_ex_matrix.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_learning_curves.py` & `watex-0.2.5/examples/utils/plot_learning_curves.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_log.py` & `watex-0.2.5/examples/utils/plot_log.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_model_confusion_matrix.py` & `watex-0.2.5/examples/utils/plot_model_confusion_matrix.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_naive_dendrogram.py` & `watex-0.2.5/examples/utils/plot_naive_dendrogram.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_naive_silhouette.py` & `watex-0.2.5/examples/utils/plot_naive_silhouette.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_ohmic_area.py` & `watex-0.2.5/examples/utils/plot_ohmic_area.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_pca_components.py` & `watex-0.2.5/examples/utils/plot_pca_components.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_regularization_path.py` & `watex-0.2.5/examples/utils/plot_regularization_path.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_rf_feature_importances.py` & `watex-0.2.5/examples/utils/plot_rf_feature_importances.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_savitzky_golay1d.py` & `watex-0.2.5/examples/utils/plot_savitzky_golay1d.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_sbs_feature_selection.py` & `watex-0.2.5/examples/utils/plot_sbs_feature_selection.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_sfi.py` & `watex-0.2.5/examples/utils/plot_sfi.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_skew.py` & `watex-0.2.5/examples/utils/plot_skew.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_strike.py` & `watex-0.2.5/examples/utils/plot_strike.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/utils/plot_voronoi.py` & `watex-0.2.5/examples/utils/plot_voronoi.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_2d_filtered_tensors.py` & `watex-0.2.5/examples/view/plot_2d_filtered_tensors.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_base_distributions.py` & `watex-0.2.5/examples/view/plot_base_distributions.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_biplot.py` & `watex-0.2.5/examples/view/plot_biplot.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_box.py` & `watex-0.2.5/examples/view/plot_box.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_confusion_matrix_metric.py` & `watex-0.2.5/examples/view/plot_confusion_matrix_metric.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_correlating_features.py` & `watex-0.2.5/examples/view/plot_correlating_features.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_cut_comparison.py` & `watex-0.2.5/examples/view/plot_cut_comparison.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_dendrogram.py` & `watex-0.2.5/examples/view/plot_dendrogram.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_dendroheat.py` & `watex-0.2.5/examples/view/plot_dendroheat.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_discussing_features.py` & `watex-0.2.5/examples/view/plot_discussing_features.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_grid.py` & `watex-0.2.5/examples/view/plot_grid.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_hist.py` & `watex-0.2.5/examples/view/plot_hist.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_jointing_features.py` & `watex-0.2.5/examples/view/plot_jointing_features.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_learning_inspections.py` & `watex-0.2.5/examples/view/plot_learning_inspections.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_matshow.py` & `watex-0.2.5/examples/view/plot_matshow.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_model.py` & `watex-0.2.5/examples/view/plot_model.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_model_inspection.py` & `watex-0.2.5/examples/view/plot_model_inspection.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_model_scores.py` & `watex-0.2.5/examples/view/plot_model_scores.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_multiple_feature_distributions.py` & `watex-0.2.5/examples/view/plot_multiple_feature_distributions.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_num_features.py` & `watex-0.2.5/examples/view/plot_num_features.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_pairwise_corr.py` & `watex-0.2.5/examples/view/plot_pairwise_corr.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_pararell_corrdinates.py` & `watex-0.2.5/examples/view/plot_pararell_corrdinates.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_pca.py` & `watex-0.2.5/examples/view/plot_pca.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_phase_sensistive_skew.py` & `watex-0.2.5/examples/view/plot_phase_sensistive_skew.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_phase_tensor_2d.py` & `watex-0.2.5/examples/view/plot_phase_tensor_2d.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_pr.py` & `watex-0.2.5/examples/view/plot_pr.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_projection.py` & `watex-0.2.5/examples/view/plot_projection.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_radviz.py` & `watex-0.2.5/examples/view/plot_radviz.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_reg_scoring.py` & `watex-0.2.5/examples/view/plot_reg_scoring.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_res_tensor_2d.py` & `watex-0.2.5/examples/view/plot_res_tensor_2d.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_rhoa.py` & `watex-0.2.5/examples/view/plot_rhoa.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_roc.py` & `watex-0.2.5/examples/view/plot_roc.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_scatter.py` & `watex-0.2.5/examples/view/plot_scatter.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_scattering_features.py` & `watex-0.2.5/examples/view/plot_scattering_features.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_silhouette.py` & `watex-0.2.5/examples/view/plot_silhouette.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_single_site_signal_recovery.py` & `watex-0.2.5/examples/view/plot_single_site_signal_recovery.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/examples/view/plot_target_inspection.py` & `watex-0.2.5/examples/view/plot_target_inspection.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/pyproject.toml` & `watex-0.2.5/pyproject.toml`

 * *Files 0% similar despite different names*

```diff
@@ -9,15 +9,15 @@
 00000080: 2243 7974 686f 6e3e 3d30 2e32 392e 3333  "Cython>=0.29.33
 00000090: 222c 0d0a 2020 2020 2020 2020 5d0d 0a62  ",..        ]..b
 000000a0: 7569 6c64 2d62 6163 6b65 6e64 203d 2022  uild-backend = "
 000000b0: 7365 7475 7074 6f6f 6c73 2e62 7569 6c64  setuptools.build
 000000c0: 5f6d 6574 6122 0d0a 0d0a 5b70 726f 6a65  _meta"....[proje
 000000d0: 6374 5d0d 0a6e 616d 6520 3d20 2277 6174  ct]..name = "wat
 000000e0: 6578 220d 0a76 6572 7369 6f6e 3d22 302e  ex"..version="0.
-000000f0: 322e 3422 0d0a 6479 6e61 6d69 6320 3d20  2.4"..dynamic = 
+000000f0: 322e 3522 0d0a 6479 6e61 6d69 6320 3d20  2.5"..dynamic = 
 00000100: 5b20 226b 6579 776f 7264 7322 5d0d 0a0d  [ "keywords"]...
 00000110: 0a64 6570 656e 6465 6e63 6965 733d 5b0d  .dependencies=[.
 00000120: 0a20 2020 2022 7365 6162 6f72 6e20 3e3d  .    "seaborn >=
 00000130: 302e 3132 2e30 222c 200d 0a20 2020 2022  0.12.0", ..    "
 00000140: 7061 6e64 6173 203e 3d31 2e34 2e30 222c  pandas >=1.4.0",
 00000150: 0d0a 2020 2020 2263 7974 686f 6e20 3e3d  ..    "cython >=
 00000160: 302e 3239 2e33 3322 2c0d 0a20 2020 2022  0.29.33",..    "
```

### Comparing `watex-0.2.4/setup.cfg` & `watex-0.2.5/setup.cfg`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/setup.py` & `watex-0.2.5/setup.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/__init__.py` & `watex-0.2.5/watex/__init__.py`

 * *Files 0% similar despite different names*

```diff
@@ -31,15 +31,15 @@
         os.path.dirname(__file__), "wlog.yml")
 
 # generated version by setuptools_scm 
 try:
     from . import _version
     __version__ = _version.version.split('.dev')[0]
 except ImportError:
-    __version__ = '0.2.4' 
+    __version__ = '0.2.5' 
 
 # # set loging Level
 logging.getLogger(__name__)#.setLevel(logging.WARNING)
 # disable the matplotlib font manager logger.
 logging.getLogger('matplotlib.font_manager').disabled = True
 # or ust suppress the DEBUG messages but not the others from that logger.
 # logging.getLogger('matplotlib.font_manager').setLevel(logging.ERROR)
@@ -184,14 +184,15 @@
     plot_rf_feature_importances, 
     plot_logging, 
     plot_silhouette, 
     plot_profiling,
     plot_confidence_in,
     qc,
     )
+
 try : 
     from .utils import ( 
         selectfeatures, 
         naive_imputer, 
         naive_scaler,  
         make_naive_pipe, 
         bi_selector,
```

### Comparing `watex-0.2.4/watex/_docstring.py` & `watex-0.2.5/watex/_docstring.py`

 * *Files 1% similar despite different names*

```diff
@@ -208,14 +208,16 @@
 
 .. _Water concept: https://en.wikipedia.org/wiki/Water
 .. _Water triple point: https://en.wikipedia.org/wiki/Properties_of_water#/media/File:Phase_diagram_of_water.svg
 .. _WATex: https://github.com/WEgeophysics/watex/
 
 .. _pycsamt: https://github.com/WEgeophysics/pycsamt
 
+.. _Oasis montaj: https://www.seequent.com/products-solutions/geosoft-oasis-montaj/extensions/
+
 .. |ohmS| replace:: Pseudo-area of the fractured zone 
 .. |sfi| replace:: Pseudo-fracturing index 
 .. |VES| replace:: Vertical Electrical Sounding 
 .. |ERP| replace:: Electrical Resistivity Profiling 
 .. |MT| replace:: Magnetotelluric 
 .. |AMT| replace:: Audio-Magnetotellurics 
 .. |CSAMT| replace:: Controlled Source |AMT|
```

### Comparing `watex-0.2.4/watex/_isotonic.pyx` & `watex-0.2.5/watex/_isotonic.pyx`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/_typing.py` & `watex-0.2.5/watex/_typing.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/_watexlog.py` & `watex-0.2.5/watex/_watexlog.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/analysis/__init__.py` & `watex-0.2.5/watex/analysis/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/analysis/decomposition.py` & `watex-0.2.5/watex/analysis/decomposition.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/analysis/dimensionality.py` & `watex-0.2.5/watex/analysis/dimensionality.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/analysis/factor.py` & `watex-0.2.5/watex/analysis/factor.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/base.py` & `watex-0.2.5/watex/base.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/cases/__init__.py` & `watex-0.2.5/watex/cases/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/cases/features.py` & `watex-0.2.5/watex/cases/features.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/cases/modeling.py` & `watex-0.2.5/watex/cases/modeling.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/cases/prepare.py` & `watex-0.2.5/watex/cases/prepare.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/cases/processing.py` & `watex-0.2.5/watex/cases/processing.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/cli.py` & `watex-0.2.5/watex/cli.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/__init__.py` & `watex-0.2.5/watex/datasets/__init__.py`

 * *Files 10% similar despite different names*

```diff
@@ -8,14 +8,15 @@
     load_bagoue, 
     load_gbalo, 
     load_iris, 
     load_semien, 
     load_tankesse, 
     load_boundiali,
     load_hlogs,
+    load_nlogs, 
     load_huayuan,
     load_mxs, 
     fetch_data,
     load_edis,
     make_erp , 
     make_ves, 
     DATASET
@@ -25,14 +26,15 @@
          "load_bagoue",
          "load_gbalo", 
          "load_iris", 
          "load_semien", 
          "load_tankesse", 
          "load_boundiali",
          "load_hlogs",
+         "load_nlogs", 
          "load_huayuan",
          "load_mxs", 
          "fetch_data",
          "load_edis",
          "make_erp" , 
          "make_ves", 
          "DATASET"
```

### Comparing `watex-0.2.4/watex/datasets/_config.py` & `watex-0.2.5/watex/datasets/_config.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/_p.py` & `watex-0.2.5/watex/datasets/_p.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/b.pkl` & `watex-0.2.5/watex/datasets/data/b.pkl`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/bagoue.csv` & `watex-0.2.5/watex/datasets/data/bagoue.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/boston_house_prices.csv` & `watex-0.2.5/watex/datasets/data/boston_house_prices.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/boundiali_ves.csv` & `watex-0.2.5/watex/datasets/data/boundiali_ves.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/dcerp_gbalo.csv` & `watex-0.2.5/watex/datasets/data/dcerp_gbalo.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/dcves_gbalo.csv` & `watex-0.2.5/watex/datasets/data/dcves_gbalo.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/e.h5` & `watex-0.2.5/watex/datasets/data/e.h5`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/edis/raw.E.zip` & `watex-0.2.5/watex/datasets/data/edis/raw.E.zip`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/edis/s.E.zip` & `watex-0.2.5/watex/datasets/data/edis/s.E.zip`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/h.h5` & `watex-0.2.5/watex/datasets/data/h.h5`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/iris.csv` & `watex-0.2.5/watex/datasets/data/iris.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/mxs.joblib` & `watex-0.2.5/watex/datasets/data/mxs.joblib`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/semien_ves.csv` & `watex-0.2.5/watex/datasets/data/semien_ves.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/tankesse.csv` & `watex-0.2.5/watex/datasets/data/tankesse.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/data/wine_data.csv` & `watex-0.2.5/watex/datasets/data/wine_data.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/descr/bagoue.rst` & `watex-0.2.5/watex/datasets/descr/bagoue.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/descr/boston_house_prices.rst` & `watex-0.2.5/watex/datasets/descr/boston_house_prices.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/descr/boundiali_ves.rst` & `watex-0.2.5/watex/datasets/descr/boundiali_ves.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/descr/california_housing.rst` & `watex-0.2.5/watex/datasets/descr/california_housing.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/descr/gbalo_erp.rst` & `watex-0.2.5/watex/datasets/descr/gbalo_erp.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/descr/gbalo_ves.rst` & `watex-0.2.5/watex/datasets/descr/gbalo_ves.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/descr/huayuan_edis.rst` & `watex-0.2.5/watex/datasets/descr/iris.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/descr/iris.rst` & `watex-0.2.5/watex/datasets/descr/huayuan_edis.rst`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
-.. _iris_dataset:
+.. _huayuan_dataset:
 
-Iris plants dataset
+_huayuan_dataset 
 --------------------
 
 **Data Set Characteristics:**
 
     :Number of Instances: 150 (50 in each of three classes)
     :Number of Attributes: 4 numeric, predictive attributes and the class
     :Attribute Information:
```

### Comparing `watex-0.2.4/watex/datasets/descr/wine_data.rst` & `watex-0.2.5/watex/datasets/descr/wine_data.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/dload.py` & `watex-0.2.5/watex/datasets/dload.py`

 * *Files 8% similar despite different names*

```diff
@@ -13,26 +13,28 @@
 """
 import scipy 
 import numpy as np
 from warnings import warn 
 from importlib import resources 
 import pandas as pd 
 from .._docstring import erp_doc, ves_doc 
-from .io import csv_data_loader, _to_dataframe, DMODULE, get_data, remove_data 
+from .io import (csv_data_loader, _to_dataframe, DMODULE, 
+    get_data, remove_data, description_loader, DESCR) 
 from ..utils.coreutils import vesSelector, erpSelector 
 from ..utils.mlutils import split_train_test_by_id , existfeatures
 from ..utils.funcutils import ( 
     to_numeric_dtypes , 
     smart_format, str2columns, 
     is_in_if, 
     reshape, 
     zip_extractor , 
     key_checker, 
     random_sampling,
-    assert_ratio
+    assert_ratio, 
+    
     )
 from ..utils.box import Boxspace
 
 __all__= [ "load_bagoue" , "load_gbalo", "load_iris", "load_semien",
           "load_tankesse",  "load_boundiali", "load_hlogs","load_edis"]
 
 def load_tankesse (
@@ -222,15 +224,15 @@
 
 .. _Cote d'Ivoire: https://en.wikipedia.org/wiki/Ivory_Coast
 
 """ 
 def load_hlogs (
         *,  return_X_y=False, as_frame =False, key =None,  split_X_y=False, 
         test_size =.3 , tag =None, tnames = None , data_names=None, 
-        **kws): 
+         **kws): 
     
     drop_observations =kws.pop("drop_observations", False)
     
     cf = as_frame 
     key = key or 'h502' 
     # assertion error if key does not exist. 
     available_sets = {
@@ -313,15 +315,15 @@
     
     return Boxspace(
         data=data.values,
         target=data[tnames].values,
         frame=data,
         tnames=tnames,
         target_names = target_columns,
-        #XXX Add description 
+        # XXX Add description 
         DESCR= '', # fdescr,
         feature_names=feature_names,
         filename=data_file,
         data_module=DMODULE,
     )
 
 load_hlogs.__doc__="""\
@@ -355,18 +357,18 @@
     are collected and compose a multioutput `y`. For a singular classification 
     or regression problem, it is recommended to indicate the name of the target 
     that is needed for the learning task. 
 (tag, data_names): None
     `tag` and `data_names` do nothing. just for API purpose and to allow 
     fetching the same data uing the func:`~watex.data.fetch_data` since the 
     latter already holds `tag` and `data_names` as parameters. 
+    
 key: str, default='h502'
     Kind of logging data to fetch. Can also be the borehole ["h2601", "*"]. 
     If ``key='*'``, all the data is aggregated on a single frame of borehole. 
-    .. versionadded:: 0.1.5
     
     .. versionadded:: 0.2.3. 
        Add 08 new boreholes data from logging, strata, layer thicknesses and 
        rock_names. 
        
 drop_observations: bool, default='False'
     Drop the ``remark`` column in the logging data if set to ``True``.  
@@ -437,15 +439,245 @@
 >>> _, y = load_hlogs (as_frame=True, # return as frame X and y
                        tnames =['pumping_level','aquifer_thickness'], 
                        )
 >>> list(y.columns)
 ... ['pumping_level', 'aquifer_thickness']
  
 """
+def load_nlogs (
+    *,  return_X_y=False, 
+    as_frame =False, 
+    key =None, 
+    split_X_y=False, 
+    test_ratio=.3 , 
+    tag=None, 
+    tnames=None , 
+    data_names=None, 
+    samples=None, 
+    seed =None, 
+    shuffle =False, 
+    **kws
+    ): 
+    
+     
+    key = key or 'b0' 
+    # assertion error if key does not exist. 
+    available_sets = {
+        "b0", 
+        "ns", 
+        "hydrogeological", 
+        "engineering", 
+        }
+    is_keys = set ( list(available_sets))
+    key = key_checker(key, is_keys, deep_search=True )
+    key = "b0" if key in ("b0", "hydrogeological") else (
+        "ns" if key in ("ns",  "engineering") else key )
+    
+    assert key in (is_keys), (
+        f"wrong key {key!r}. Expect {smart_format(is_keys, 'or')}")
+    
+    data_file =f"nlogs{'+' if key=='ns' else ''}.csv" 
+    with resources.path (DMODULE , data_file) as p : 
+        data_file = p 
+
+    data = to_numeric_dtypes( pd.read_csv(data_file )) 
+
+    samples = samples or "*"
+    data = random_sampling(data, samples = samples, random_state= seed, 
+                            shuffle= shuffle) 
+
+    # set up features and target names
+    feature_names = (list( data.columns [:21 ])  + [
+        'filter_pipe_diameter']) if key=='b0' else list(
+            filter(lambda item: item!='ground_height_distance',data.columns)
+            ) 
+    target_columns = ['static_water_level', 'drawdown', 'water_inflow', 
+                      'unit_water_inflow', 'water_inflow_in_m3_d'
+                      ] if key=='b0' else  ['ground_height_distance']
+    
+    tnames = tnames or target_columns
+    # control the existence of the tnames to retreive
+    try : 
+        existfeatures(data[target_columns] , tnames)
+    except Exception as error: 
+        # get valueError message and replace Feature by target 
+        msg = (". Acceptable target values are:"
+               f"{smart_format(target_columns, 'or')}")
+        raise ValueError(str(error).replace(
+            'Features'.replace('s', ''), 'Target(s)')+msg)
+        
+    # read dataframe and separate data to target. 
+    frame, data, target = _to_dataframe(
+        data, feature_names = feature_names, tnames = tnames, 
+        target=data[tnames].values 
+        )
+    # for consistency, re-cast values to numeric 
+    frame = to_numeric_dtypes(frame)
+        
+    if split_X_y: 
+        X, Xt = split_train_test_by_id (
+            data = frame , test_ratio= assert_ratio(test_ratio), 
+            keep_colindex= False )
+        
+        y = X[tnames] 
+        X.drop(columns =target_columns, inplace =True)
+        yt = Xt[tnames]
+        Xt.drop(columns =target_columns, inplace =True)
+        
+        return  (X, Xt, y, yt ) if as_frame else (
+            X.values, Xt.values, y.values , yt.values )
+    
+    
+    if return_X_y: 
+        return (data.values, target.values) if not as_frame else (
+            data, target) 
+    
+    # return frame if as_frame simply 
+    if as_frame: 
+        return frame 
+    
+    fdescr = description_loader(
+        descr_module=DESCR,descr_file=f"nanshang{'+'if key=='ns' else ''}.rst")
+
+    return Boxspace(
+        data=data.values,
+        target=target.values,
+        frame=frame,
+        tnames=tnames,
+        target_names = target_columns,
+        DESCR= fdescr,
+        feature_names=feature_names,
+        filename=data_file,
+        data_module=DMODULE,
+    )
+
+load_nlogs.__doc__="""\
+Load the Nanshang Engineering and hydrogeological drilling dataset.
+
+Dataset contains multi-target and can be used for a classification or 
+regression problem.
+
+Parameters
+----------
+return_X_y : bool, default=False
+    If True, returns ``(data, target)`` instead of a Bowlspace object. See
+    below for more information about the `data` and `target` object.
+
+as_frame : bool, default=False
+    If True, the data is a pandas DataFrame including columns with
+    appropriate dtypes (numeric). The target is
+    a pandas DataFrame or Series depending on the number of target columns.
+    If `return_X_y` is True, then (`data`, `target`) will be pandas
+    DataFrames or Series as described below.
+
+split_X_y: bool, default=False,
+    If True, the data is splitted to hold the training set (X, y)  and the 
+    testing set (Xt, yt) with the according to the test size ratio.  
+test_ratio: float, default is {{.3}} i.e. 30% (X, y)
+    The ratio to split the data into training (X, y)  and testing (Xt, yt) set 
+    respectively. 
+tnames: str, optional 
+    the name of the target to retreive. If ``None`` the full target columns 
+    are collected and compose a multioutput `y`. For a singular classification 
+    or regression problem, it is recommended to indicate the name of the target 
+    that is needed for the learning task. 
+(tag, data_names): None
+    `tag` and `data_names` do nothing. just for API purpose and to allow 
+    fetching the same data uing the func:`~watex.data.fetch_data` since the 
+    latter already holds `tag` and `data_names` as parameters. 
+    
+key: str, default='b0'
+    Kind of drilling data to fetch. Can also be the borehole ["ns"]. The 
+    ``ns`` data refer mostly to engineering drilling whereas the ``b0`` refers 
+    to pure hydrogeological drillings. In the former case, the 
+    ``'ground_height_distance'`` attribute used to control soil settlement is 
+    the target while the latter targets fit the water inflow, the drawdown and 
+    the static water level.
+    
+samples: int,optional 
+   Ratio or number of items from axis to fetch in the data. fetch all data if 
+   `samples` is ``None``.  
+   
+seed: int, array-like, BitGenerator, np.random.RandomState, \
+    np.random.Generator, optional
+   If int, array-like, or BitGenerator, seed for random number generator. 
+   If np.random.RandomState or np.random.Generator, use as given.
+   
+shuffle: bool, default =False, 
+   If ``True``, borehole data should be shuffling before sampling. 
+Returns
+---------
+data : :class:`~watex.utils.Boxspace`
+    Dictionary-like object, with the following attributes.
+    data : {ndarray, dataframe} 
+        The data matrix. If ``as_frame=True``, `data` will be a pandas DataFrame.
+    target: {ndarray, Series} 
+        The classification target. If `as_frame=True`, `target` will be
+        a pandas Series.
+    feature_names: list
+        The names of the dataset columns.
+    target_names: list
+        The names of target classes.
+    frame: DataFrame 
+        Only present when `as_frame=True`. DataFrame with `data` and
+        `target`.
+        .. versionadded:: 0.1.1
+    DESCR: str
+        The full description of the dataset.
+    filename: str
+        The path to the location of the data.
+        .. versionadded:: 0.1.2
+data, target: tuple if ``return_X_y`` is True
+    A tuple of two ndarray. The first containing a 2D array of shape
+    (n_samples, n_features) with each row representing one sample and
+    each column representing the features. The second ndarray of shape
+    (n_samples,) containing the target samples.
+    .. versionadded:: 0.1.2
+X, Xt, y, yt: Tuple if ``split_X_y`` is True 
+    A tuple of two ndarray (X, Xt). The first containing a 2D array of:
+        
+    .. math:: 
+        
+        \\text{shape}(X, y) =  1-  \\text{test_ratio} * (n_{samples}, n_{features}) *100
+        
+        \\text{shape}(Xt, yt)= \\text{test_ratio} * (n_{samples}, n_{features}) *100
+    
+    where each row representing one sample and each column representing the 
+    features. The second ndarray of shape(n_samples,) containing the target 
+    samples.
+     
+Examples
+--------
+Let's say ,we do not have any idea of the columns that compose the target,
+thus, the best approach is to run the function without passing any parameters 
+and then `DESCR` attributes to get the unit of each attribute::
 
+>>> from watex.datasets.dload import load_nlogs
+>>> b= load_nlogs()
+>>> b.target_names
+Out[241]: 
+['static_water_level',
+ 'drawdown',
+ 'water_inflow',
+ 'unit_water_inflow',
+ 'water_inflow_in_m3_d']
+>>> b.DESCR
+... (...)
+>>> # Let's say we are interested of the targets 'drawdown' and 
+>>> # 'static_water_level' and returns `y' 
+>>> _, y = load_nlogs (as_frame=True, # return as frame X and y
+                       tnames =['drawdown','static_water_level'], 
+                       )
+>>> list(y.columns)
+... ['drawdown', 'static_water_level']
+>>> y.head(2) 
+   drawdown  static_water_level
+0     70.03                4.21
+1      7.38                3.60
+"""
 def load_bagoue(
         *, return_X_y=False, as_frame=False, split_X_y=False, test_size =.3 , 
         tag=None , data_names=None, **kws
  ):
     cf = as_frame 
     data_file = "bagoue.csv"
     data, target, target_names, feature_names, fdescr = csv_data_loader(
@@ -1024,31 +1256,28 @@
         data = (random_sampling(d, samples = samples,random_state= seed , 
                                 shuffle= shuffle) for d in (X_csr, y ) 
                 )
         # split now
         return train_test_split (*tuple ( data ),random_state = seed, 
                                  test_size =assert_ratio (test_ratio),
                                  shuffle = shuffle)
-  
-    
     # Append Xy to Boxspace if 
     # return_X_y is not set explicitly.
     Xy = dict() 
     # if for return X and y if k is not None 
     if key is not None and key !="data": 
         if key not in  av.keys():
             key ='raw'
         X, y =  tuple ( [ data_dict[k]  for k in av [key]] ) 
 
         X = random_sampling(X, samples = samples,random_state= seed , 
                             shuffle= shuffle)
         y = random_sampling(y, samples = samples, random_state= seed, 
                             shuffle= shuffle
                                )
-        
         if return_X_y: 
             return (  X, y )  if as_frame or key =='sparse' else (
                 np.array(X), np.array(y))
         
         # if return_X_y is not True 
         Xy ['X']=X ; Xy ['y']=y 
         # Initialize key to 'data' to 
@@ -1086,15 +1315,15 @@
         nga_labels = data_dict.get('nga_labels'), 
         #XXX Add description 
         DESCR= '', # fdescr,
         feature_names=feature_names,
         filename=data_file,
         data_module=DMODULE,
         **Xy
-    )
+        )
     
 load_mxs.__doc__="""\
 Load the dataset after implementing the mixture learning strategy (MXS).
 
 Dataset is composed of 11 boreholes merged with multiple-target that can be 
 used for a classification problem.
 
@@ -1109,18 +1338,18 @@
     appropriate dtypes (numeric). The target is
     a pandas DataFrame or Series depending on the number of target columns.
     If `return_X_y` is True, then (`data`, `target`) will be pandas
     DataFrames or Series as described below.
 
 split_X_y: bool, default=False,
     If True, the data is splitted to hold the training set (X, y)  and the 
-    testing set (Xt, yt) with with test ratio fixed to 20 % 
+    testing set (Xt, yt) based on to the `test_ratio` value.
 
 tnames: str, optional 
-    the name of the target to retreive. If ``None`` the full target columns 
+    the name of the target to retrieve. If ``None`` the full target columns 
     are collected and compose a multioutput `y`. For a singular classification 
     or regression problem, it is recommended to indicate the name of the target 
     that is needed for the learning task. 
 (tag, data_names): None
     `tag` and `data_names` do nothing. just for API purpose and to allow 
     fetching the same data uing the func:`~watex.data.fetch_data` since the 
     latter already holds `tag` and `data_names` as parameters. 
@@ -1128,15 +1357,15 @@
 samples: int,optional 
    Ratio or number of items from axis to fetch in the data. 
    Default = .5 if `samples` is ``None``.
 
 key: str, default='data'
     Kind of MXS data to fetch. Can also be: 
         
-        - "sparse": for a compressed sparsed matric of train set X 
+        - "sparse": for a compressed sparsed row matrix format of train set X. 
         - "scale": returns a scaled X using the standardization strategy 
         - "num": Exclusive numerical data and exclude the 'strata' feature.
         - "test": test data `X` and `y` 
         - "train": train data `X` and  `y` with preprocessing already performed
         - "raw": for original dataset X and y  with no preprocessing 
         - "data": Default when key is not supplied. It returns 
           the :class:`Bowlspace` objects.
@@ -1186,17 +1415,19 @@
     filename: str
         The path to the location of the data.
 data, target: tuple if ``return_X_y`` is True
     A tuple of two ndarray. The first containing a 2D array of shape
     (n_samples, n_features) with each row representing one sample and
     each column representing the features. The second ndarray of shape
     (n_samples,) containing the target samples.
-    .. versionadded:: 0.1.2
+
 X, Xt, y, yt: Tuple if ``split_X_y`` is True 
-    A tuple of two ndarray (X, Xt). The first containing a 2D array of:
+    A tuple of two ndarray (X, Xt). The first containing a 2D array of
+    training and test data whereas `y` and `yt` are training and test labels.
+    The number of samples are based on the `test_ratio`. 
  
 Examples
 --------
 >>> from watex.datasets.dload import load_mxs  
 >>> load_mxs (return_X_y= True, key ='sparse', samples ='*')
 (<1038x21 sparse matrix of type '<class 'numpy.float64'>'
  	with 8298 stored elements in Compressed Sparse Row format>,
```

### Comparing `watex-0.2.4/watex/datasets/gdata.py` & `watex-0.2.5/watex/datasets/gdata.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/io.py` & `watex-0.2.5/watex/datasets/io.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/rload.py` & `watex-0.2.5/watex/datasets/rload.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/datasets/sets.py` & `watex-0.2.5/watex/datasets/sets.py`

 * *Files 5% similar despite different names*

```diff
@@ -12,28 +12,30 @@
 _DTAGS=(
     "bagoue" , 
     "gbalo", 
     "iris", 
     "semien", 
     "tankesse", 
     "boundiali",
-    "hlogs", 
+    "hlogs",
+    "nlogs", 
     "mxs", 
     "huayuan", 
     "edis"
     )
 
 from .dload import (
     load_bagoue , 
     load_gbalo, 
     load_iris, 
     load_semien, 
     load_tankesse , 
     load_boundiali,
     load_hlogs,
+    load_nlogs, 
     load_huayuan, 
     load_edis, 
     load_mxs, 
     ) 
 from .gdata import ( 
     make_erp , 
     make_ves 
@@ -49,29 +51,31 @@
 __all__=[ 
          "load_bagoue" ,
          "load_gbalo", 
          "load_iris", 
          "load_semien", 
          "load_tankesse", 
          "load_boundiali",
-         "load_hlogs", 
+         "load_hlogs",
+         "load_nlogs", 
          "load_huayuan", 
          "fetch_data",
          "load_edis",
          "load_mxs", 
          "make_erp" , 
          "make_ves", 
          "DATASET"
          ]
 
 def fetch_data (tag, **kws): 
     tag = _parse_tags(tag, multi_kind_dataset='bagoue')
     func= _fetch_data if fi else None 
     funcs= (load_bagoue , load_gbalo, load_iris, load_semien, load_tankesse , 
-            load_boundiali, load_hlogs, load_huayuan, load_edis, load_mxs ) 
+            load_boundiali, load_hlogs, load_nlogs, load_huayuan, load_edis, 
+            load_mxs ) 
     funcns = list (map(lambda f: f.__name__.replace('load_', ''), funcs))
     if tag in (funcns): 
         func = funcs[funcns.index (tag)] 
     
     return func (tag=tag, data_names=funcns, **kws) if callable (func) else None
```

### Comparing `watex-0.2.4/watex/datasets/setup.py` & `watex-0.2.5/watex/datasets/setup.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/decorators.py` & `watex-0.2.5/watex/decorators.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,15 +26,15 @@
     F
 )
 from ._watexlog import watexlog
 _logger = watexlog.get_watex_logger(__name__)
 
 __docformat__='restructuredtext'
 
-      
+
 class temp2d: 
     """ Two dimensional plot template 
     
     Parameters 
     ----------
     reason: str, Any 
         Does nothing. But if supplied, it should be the purpose of the 
@@ -1972,18 +1972,18 @@
     
             _f=0 # flag to separated strata model misfit and occam model misfit
                 #   from occamResponse file 
                 
             if self.depth_scale is not None :
                 self.depth_scale= str(self.depth_scale).lower() 
 
-            if self.depth_scale not in ["km", "m"]: 
-                mess ="Depth scale =`{}` is unacceptable value."\
-                    " Should be convert to 'm'.".format(self.depth_scale)
-                warnings.warn(mess)
+            if self.depth_scale not in ("km", "m"): 
+                mess = ("Depth scale expects 'm' or 'km'. By default 'm'"
+                    " is used instead. Got {}").format(self.depth_scale)
+                # warnings.warn(mess)
                 self.depth_scale= "m"
                 self._logging.debug (mess)
             
             if self.depth_scale == 'km':
                 dz  = 1000.
             elif self.depth_scale == 'm': 
                 dz = 1.
@@ -1997,20 +1997,24 @@
     
             # get geomodel data 
             if self.reason is None: 
                 self.reason = 'model'# by default
                 
             # ----populate special attributes from model or misfit ------------
             if self.reason =='model': 
-                occam_model_resistiviy_obj, occam_data_station_names, *m = func(
-                    *args, **kwargs)
-                occam_data_station_offsets, occam_model_depth_offsets, *ddrms= m
-                self.doi, self.depth_scale, self.model_rms, *rmisf = ddrms 
-                self.model_roughness, plot_misfit = rmisf
                 
+                # (data, self.model_stations, self.model_station_locations,
+                #     self.model_depth, self.doi, depth_scale, self.model_rms, 
+                #     self.model_roughness, misfit_G )
+                ( occam_model_resistiviy_obj, occam_data_station_names, 
+                 occam_data_station_offsets, occam_model_depth_offsets, 
+                 self.doi, self.depth_scale, self.model_rms, 
+                 self.model_roughness, plot_misfit ) = func(
+                     *args, **kwargs)
+                    
                 self.doi = occam_model_depth_offsets.max()
                 #     self.doi = occam_model_depth_offsets.max()
                 # --> check doi value provided, and convert to default unit {meters}  
                 self.doi =assert_doi(doi=self.doi)
                 
                 # set boundaries of stations offsets and depth 
                 spec_f = -(self.doi/5)/dz  # assume that depth will  start by
```

### Comparing `watex-0.2.4/watex/edi.py` & `watex-0.2.5/watex/edi.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/etc/AGSO.csv` & `watex-0.2.5/watex/etc/AGSO.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/etc/__XTyT.pkl` & `watex-0.2.5/watex/etc/__XTyT.pkl`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/etc/__Xy.pkl` & `watex-0.2.5/watex/etc/__Xy.pkl`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/etc/memory.sq3` & `watex-0.2.5/watex/etc/memory.sq3`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/etc/p.models.pkl` & `watex-0.2.5/watex/etc/p.models.pkl`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/exceptions.py` & `watex-0.2.5/watex/exceptions.py`

 * *Files 2% similar despite different names*

```diff
@@ -23,16 +23,18 @@
     the prescipted details beforehand."""
     pass 
 
 class DCError (Exception): 
     """Raises exception when data passed to DC base class are not consistent.
     DCType expect D-type for Dataframe , F-type for file object or P-type of 
     pathlike object. 
-    
     """
+class DrillError (Exception): 
+    """Raises exception when any component that composes the Drilling property 
+    or column name is missing in the given data."""
     
 class EDIError(Exception):
     """Raises an Exception if the given SEG-Electrical Data Interchange data 
     does not fit the appropriate EDI-format. The correct SEG-EDI file building
     can be found in `Wight, D.E., Drive, B., 1988.` and can be donwloaded
     at <https://www.mtnet.info/docs/seg_mt_emap_1987.pdf> """
     pass 
@@ -127,15 +129,19 @@
     executed properly."""
     pass
 
 class GeoDatabaseError(Exception): 
     """ Raises an Exception if the database failed to respond. The request is 
     aborted. """
     pass
-
+class ModelError(Exception): 
+    """ Raises an Exception when the requierements for building Geo/Model are
+    are wrong not truly passed. Error also raises when Model construction 
+    is going to fail."""
+    pass
 class ERPError(Exception):
     """Raises an Exception if data passed is not a  valid Electrical Resistivity
     Profiling. Note that 'station' and 'resistivity' must figure out in the 
     ERP data. Station is the position where the measurement is done. By 
     convention is the center of MN and AB, the potential and current electrodes
     respectively."""
     pass
```

### Comparing `watex-0.2.4/watex/exlib/__init__.py` & `watex-0.2.5/watex/exlib/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/exlib/gbm.py` & `watex-0.2.5/watex/exlib/gbm.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/exlib/sklearn.py` & `watex-0.2.5/watex/exlib/sklearn.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/externals/_numpy_compiler_patch.py` & `watex-0.2.5/watex/externals/_numpy_compiler_patch.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/externals/_pkgs/_structures.py` & `watex-0.2.5/watex/externals/_pkgs/_structures.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/externals/_pkgs/version.py` & `watex-0.2.5/watex/externals/_pkgs/version.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/externals/z.py` & `watex-0.2.5/watex/externals/z.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/externals/zutils.py` & `watex-0.2.5/watex/externals/zutils.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/geology/__init__.py` & `watex-0.2.5/watex/geology/__init__.py`

 * *Files 11% similar despite different names*

```diff
@@ -17,19 +17,21 @@
     Structures,
     Structural, 
     )
 from .drilling import ( 
     Borehole , 
     DSBorehole, 
     DSBoreholes, 
+    DSDrill
     )
 from .stratigraphic import  GeoStrataModel
 
 __all__=[ 
     'Geology' ,  
     'Structures',
     'Structural', 
     'Borehole', 
     'GeoStrataModel', 
     'DSBorehole', 
     'DSBoreholes',
+    'DSDrill'
     ]
```

### Comparing `watex-0.2.4/watex/geology/core.py` & `watex-0.2.5/watex/geology/core.py`

 * *Files 2% similar despite different names*

```diff
@@ -70,21 +70,23 @@
             only inversion files and detail-sequences map after including the 
             input true resistivity values and layer names) 
     Futhermore, the "pseudosequences model" could match and describe better 
     the layers disposal (thcikness and contact) in underground than the 
     raw model map which seems to be close to the reality  when `step descent` 
     parameter is not too small at all. 
 
-
     """
     
     def __init__(self, verbose: int =0 , **kwargs):
         self._logging = watexlog.get_watex_logger(self.__class__.__name__)
         self.verbose= verbose 
         
+        for key in list(kwargs.keys()): 
+            setattr(self, key, kwargs[key])
+            
 #++++ configure the geological rocks from files:AGSO & AGSO.STCODES +++++++++++
 __agso_properties =dict(
     GIT_REPO = 'https://github.com/WEgeophysics/watex', 
     GIT_ROOT ='https://raw.githubusercontent.com/WEgeophysics/watex/master/',
     props_dir = 'watex/etc/',
     props_files = ['AGSO.csv', 'AGSO_STCODES.csv'], 
     props_codes = ['code', 'label', 'name', 'pattern','size',
@@ -232,15 +234,14 @@
         >>> code_descr={key:value for key , value in zip (data["CODE"],
                                                        data['__DESCRIPTION'])}
     """
     msg= ''.join(["<`{0}`> is the software property file. Please don't move "
         " or delete the properties files located in <`{1}`> directory."])
     
     pd_pos_read = Config().parsers 
- 
     ext='none'
     if config_file is None: 
         config_file = os.path.join(os.path.realpath('.'), os.path.join(
                        __agso_properties['props_dir'],
                        __agso_properties ['props_files'][0]))
     if config_file is not None: 
         is_config = os.path.isfile(config_file)
```

### Comparing `watex-0.2.4/watex/geology/database.py` & `watex-0.2.5/watex/geology/database.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/geology/drilling.py` & `watex-0.2.5/watex/site.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,276 +1,594 @@
 # -*- coding: utf-8 -*-
-#   License: BSD-3-Clause
+#   Licence:BSD-3-Clause
 #   Author: LKouadio <etanoyau@gmail.com>
-#   Created on Thu Sep 29 08:30:12 2022 
+"""
+Manage site data.
+"""
+from __future__ import annotations 
+import os
+import shutil
+import copy 
+import re
 
-from __future__ import print_function , annotations
-import os 
-from warnings import warn 
+import warnings 
 import numpy as np 
-import pandas as pd 
 
-from .core import get_agso_properties 
-from .geology import Geology
-from .._typing import NDArray, DataFrame
-from ..exceptions import NotFittedError 
-from ..site import Profile 
-from ..utils._dependency import import_optional_dependency 
-from ..utils.box import data2Box 
-from ..utils.coreutils import _is_readable, makeCoords 
-from ..utils.funcutils import ( 
+from ._watexlog import watexlog 
+from ._typing import ( 
+    Optional, 
+    ArrayLike,
+    F
+    )
+from .exceptions import ( 
+    SiteError, 
+    ProfileError,
+    NotFittedError, 
+    )
+from .property import ( 
+    UTM_DESIGNATOR
+    )
+from .utils.coreutils import makeCoords 
+from .utils.exmath import ( 
+    get_bearing, 
+    scalePosition, 
+    )
+from .utils.funcutils import (
     _assert_all_types, 
-    to_numeric_dtypes , 
-    smart_strobj_recognition, 
-    convert_value_in 
+    to_numeric_dtypes,
+    _validate_name_in, 
+    interpolate_grid,
+    reshape,
+    is_iterable
+    ) 
+from .utils.gistools import (
+    assert_elevation_value, 
+    assert_lat_value, 
+    assert_lon_value , 
+    ll_to_utm, 
+    utm_to_ll, 
+    project_point_ll2utm, 
+    project_point_utm2ll,
+    assert_xy_coordinate_system,
+    convert_position_str2float, 
+    convert_position_float2str, 
     )
-from ..utils.geotools import get_random_thickness
-from ..utils.validator import check_array 
+from .utils.validator import ( 
+    _check_consistency_size , 
+    _is_numeric_dtype , 
+    assert_xy_in, 
+    ) 
 
-class DSBoreholes :
-    """
-    Class deals with many boreholes dataset. 
-    
-    DSBoreholes works with the data set composed of multiple borehole data. 
-    The data columns are the all attributes of the object and any 
-    non-alphateic character is replaced by ``_``. For instance, a column name 
-    ``layer thickness`` should have an attribute named ``layer_thickness``. 
-    Each borehole (row) data become its own object which encompasses all 
-    columns as attributes. To have full control of how data must be 
-    retrieved, ``holeid`` parameter must be set. For instance, to retrieve 
-    the borehole with ID equals to `bx02`, after fitting the class with 
-    appropriate parameters, attibute `hole depth` ( if exist in the data) can  
-    be retrieved as ``self.hole.bx02.hole_depth``. 
-    
-    By default if the projection is given as latitude/longitude 
-
-    Parameters
-    ------------
-    area: str
-       Name of area where the data collection is made. 
-      
-    holeid: str, optional 
-       The name of column of the boreholes collections ID. Note that if 
-       given, it should exist in the borehole datasets. 
-      
-    lon, lat: ArrayLike 1d /str  , optional 
-       One dimensional arrays. `xlon` can be consider as the abscissa of   
-       the landmark and `ylat` as ordinates array.  If `xlon` or `ylat` is  
-       passed as string argument, `data` must be passed as `fit_params` 
-       keyword arguments and the name of `xlon` and `y` must be a column 
-       name of the `data`. 
-       By default `xlon` and `ylat` are considered as `longitude` and 
-       `latitude` when ``dms`` or ``ll`` coordinate system is passed.
-       
-    utm_zone: Optional, string
-       zone number and 'S' or 'N' e.g. '55S'. Default to the centre point
-       of coordinates points in the survey area. It should be a string (##N or ##S)
-       in the form of number and North or South hemisphere, 10S or 03N
-       
-    projection: str, ['utm'|'dms'|'ll'] 
-       The coordinate system in which the data points for the profile is collected. 
-       If not given, the auto-detection will be triggered and find the  suitable 
-       coordinate system. However, it is recommended to provide it for consistency. 
-       Note that if `x` and `y` are composed of value less than 180 degrees 
-       for longitude and 90 degrees for latitude, it should be considered as  
-       longitude-latitude (``ll``) coordinates system. If `x` and `y` are 
-       degree-minutes-second (``dms`` or ``dd:mm:ss``) data, they must be 
-       specify as coordinate system in order to accept the non-numerical data 
-       before transforming to ``ll``. If ``data`` is passed to the :meth:`.fit`
-       method and ``dms`` is not specify, `x` and `y` values should be discarded.
-       
-    datum: string, default = 'WGS84'
-       well known datum ex. WGS84, NAD27, NAD83, etc.
+__all__= ['Location', 'Profile']
 
-    epsg: Optional, int
-       epsg number defining projection (
-            see http://spatialreference.org/ref/ for moreinfo)
-       Overrides utm_zone if both are provided. 
-
-    encoding: str, default ='utf8'
-       Default encoding for parsing data. Can also be ['utf-16-be'] for 
-       reading bytes characters. 
-       
-    interp_coords: bool, default=False 
-       Interpolate position coordinates.
-      
-    reference_ellipsoid: int, default=23 
-       reference ellipsoids is derived from Peter H. Dana's website-
-       http://www.utexas.edu/depts/grg/gcraft/notes/datum/elist.html
-       Department of Geography, University of Texas at Austin
-       Internet: pdana@mail.utexas.edu . Default is ``23`` constrained to 
-       WGS84. 
-       
-    verbose: int, default=0 
-       Output messages. 
-      
-    Attributes 
-    ----------
-    lon_, lat_: Arraylike, 
-       longitude/latitude of coordinates arrays. 
-       
-    `hole.<holeid>.<data_column>`: :class:`~watex.utils.box.Boxspace` 
-       Each borehole, commonly which ID correspond to  each row. Each row
-       can be fetched as 'holeID'. If `holeid` is nt specified, the string 
-       literal `hole+index of data` composed the borehole object. 
-       
-    Notes 
-    ------
-    When `data` is supplied and `lon` and `lat` are given by their names 
-    existing in the dataframe columns, by default, the non-numerical 
-    data are removed. However, if `y` and `x` are given in DD:MM:SS in 
-    the dataframe, the coordinate system must explicitly set to ``dms`
-    to keep the non-numerical values in the data. 
+class Profile: 
     
-    """
     def __init__(
+        self , 
+        *, 
+        utm_zone =None, 
+        coordinate_system=None, 
+        datum = 'WGS84', 
+        epsg = None, 
+        reference_ellipsoid =23, 
+        ): 
+        self.epsg=epsg 
+        self.datum =datum 
+        self.reference_ellipsoid= reference_ellipsoid 
+        self.utm_zone=utm_zone
+        self.coordinate_system= coordinate_system
+
+    def fit(
         self, 
-        area:str=None,
-        holeid:str=None,
-        lat:str=None, 
-        lon:str=None, 
-        projection:str ='ll', 
-        utm_zone:str=None, 
-        datum:str='WGS84', 
-        epsg:int=None, 
-        encoding:str='utf-8', 
-        interp_coords:bool=False, 
-        reference_ellipsoide:int=23, 
-        verbose:bool=False 
+        x:ArrayLike |str , 
+        y:ArrayLike | str ,
+        elev: Optional [ArrayLike] =None, 
+        **fit_params
         ): 
+        """ Populate profile attributes from x and y. 
         
-        self.area =area 
-        self.holeid=holeid  
-        self.projection= projection 
-        self.utm_zone=utm_zone 
-        self.reference_ellipsoide= reference_ellipsoide 
-        self.datum=datum 
-        self.encoding= encoding 
-        self.epsg =epsg 
-        self.interp_coords=interp_coords
-        self.lon=lon 
-        self.lat=lat 
-        self.verbose= verbose 
+        By default if the coordinate system is given as latitude/longitude 
+        x, y are latitude and longitude respectively. 
+ 
+        Parameters
+        ------------
+        x, y: ArrayLike 1d /str  
+           One dimensional arrays. `x` can be consider as the abscissa of the  
+           landmark and `y` as ordinates array.  If `x` or `y` is passed as 
+           string argument, `data` must be passed as `fit_params` keyword 
+           arguments and the name of `x` and `y` must be a column name of 
+           the `data`. 
+           By default `x` and `y` are considered as `longitude` and `latitude` 
+           when ``dms`` or ``ll`` coordinate system is passed. 
+  
+        elev: ArrayLike 1d/str 
+            Arraylike 1d of elevation at each positions. If not supplied 
+            should be set to null at each points. If given, it must be  
+            consistent with `x` and `y`. 
             
-    def fit ( self, data, **fit_params): 
-        """ Fit Hole data set and populate attributes. 
+        data: pd.DataFrame 
+           Data containing `x` and `y` values as series. Then if `x` and `y`
+           are given as string argument, their names must be included in the 
+           data columns. Otherwise an error will raise. 
         
-        Parameters 
-        ----------
-        data: Path-like Object or DataFrame 
-          Hole data. 
-          
-        fit_params: dict,
-          Keyword arguments passed to :func:`watex.to_numeric_dtypes` to 
-          sanitize the data. 
-          
         Return 
+        ---------
+        self :`watex.site.Profile` 
+           Object of Profile. 
+           
+        Note 
         ------
-        self: :class:`DSBoreholes`
-          Instanced object for chaining methods. 
-          
+        When `data` is supplied and `x` and `y` are given by their names 
+        existing in the dataframe columns, by default, the non-numerical 
+        data are removed. However, if `y` and `x` are given in DD:MM:SS in 
+        the dataframe, the coordinate system must explicitly set to ``dms`
+        to keep the non-numerical values  in the data. 
+        
         """
-        columns = fit_params.pop ("columns", None  )
-        data = _is_readable(data, as_frame =True, 
-                            input_name= 'b', 
-                            columns = columns, 
-                            encoding =self.encoding 
-                            )
-        
-        data = check_array (
-            data, 
-            force_all_finite= "allow-nan", 
-            dtype =object , 
-            input_name="Boreholes data", 
-            to_frame=True, 
-            )
-        self.lon_=None; self.lat_=None 
         
-        if ( self.lon is not None 
-            and self.lat is not None
-            ): 
-            p = Profile (utm_zone = self.utm_zone , 
-                         coordinate_system= self.projection, 
-                         datum= self.datum , 
-                         epsg= self.epsg, 
-                         reference_ellipsoid=self.reference_ellipsoid 
-                         ) 
-            p.fit (x = self.lon, y = self.lat, data = data ) 
+        emsg =("'DD:MM:SS.ms' coordinate system is detected.")
+        data = fit_params.pop('data', None) 
   
-            if self.interp_coords: 
-               p.interpolate ()
-               
-            self.lon_= p.x 
-            self.lat_= p.y 
+        self.coordinate_system = str(
+            self.coordinate_system).lower().strip() 
+        if  ( 
+                self.coordinate_system.find ('dms')>=0 
+            or 'dd:mm' in self.coordinate_system ) : 
+            self.coordinate_system='dms'
+    
+        if data is not None: 
+            # when coordinate_system is explicity passed 
+            # and data is given, don't suppress the non-numerical 
+            # data. Keep it untouch and try to convert x, y to 
+            # float type later. 
+            suppress_cf = True 
+            if self.coordinate_system=='dms': 
+               suppress_cf= False 
+            # suppress non numerical values 
+            data = to_numeric_dtypes(data, pop_cat_features= suppress_cf)
+            # get elevation if string is given 
+            if isinstance (elev , str): 
+                elev = elev if elev in data.columns else None 
+                if elev is None: 
+                    warnings.warn("Elevation not found in the dataframe")
+                if elev is not None: 
+                    elev = np.array (data[elev]) 
+        
+        self.x, self.y = assert_xy_in( x , y, data = data )
+        
+        # set x and y names useful for 
+        # plotting labels. 
+        self.xname_=None ; self.yname_=None 
+        if ( 
+                isinstance ( x, str ) 
+                or hasattr (x, "name" )
+                ) : 
+            self.xname_= x if isinstance ( x, str ) else x.name 
+        if ( 
+                isinstance ( y, str ) 
+                or hasattr (y, "name" )
+                ) : 
+           self.yname_= y if isinstance ( y, str ) else y.name 
+        
+        if self.coordinate_system in ('none', 'auto'): 
+            self.coordinate_system = assert_xy_coordinate_system (
+                self.x, self.y )
+        
+        if self.coordinate_system =='dms' : 
+            try : 
+                self.x, self.y = Profile.dms2ll(self.x, self.y) 
+            except ValueError as e: 
+                raise ValueError( emsg + str(e))
+            else: 
+                # initialize the system to ll if 
+                # conversion succeeded. 
+                self.coordinate_system =='ll' 
+        # set 0. to elevation 
+        self.elev = elev if elev is not None else np.zeros_like(
+            self.x, dtype = np.float32 ) 
+        self.elev = np.array (self.elev , dtype = np.float32 )
+        
+        if not _check_consistency_size (self.x , np.array( self.elev),
+                                        error ='ignore'  ): 
+            raise ProfileError ("Elevation and x or y must be consistent."
+                              f" Got {len(x)} and {len(elev)}") 
+        return self 
+        
+    def bearing (self, *, to_degree:bool = True ): 
+        """
+        Compute the bearing between two coordinates.
+        
+        A bearing is a direction of one point relative to another point, 
+        usually given as an angle measured clockwise from north. 
+        In navigation, bearings are often used to determine the direction 
+        to a destination or to plot a course on a map. There are two main 
+        types of bearings: absolute bearing and relative bearing.
+        
+        - Relative bearing 
+          refers to the angle between the forward direction of a craft 
+          (heading) and the location of another object. 
+        - Absolute bearing 
+          refers to the angle between the magnetic north (magnetic bearing) 
+          or true north (true bearing) and an object
+          
+        The  bearing (:math:`\beta`) between two coordinates points 1(lon1, lat1) 
+        and 2 (lon2, lat2) can becalculated as:
+        
+        .. math:: 
             
-        # For consistency, Check the datatype, sanitize columns 
-        # and drop all NaN columns and row values
-        data, nf, cf = to_numeric_dtypes(
-            data , 
-            return_feature_types= True, 
-            verbose =self.verbose, 
-            sanitize_columns= True, 
-            fill_pattern='_', 
-            **fit_params 
-            )
+            \beta = atan2(sin(lon2-lon1)*cos(lat2), cos(lat1)*sin(lat2)  \
+                          sin(lat1)*cos(lat2)*cos(lon2-lon1))
+                
+        By default, the first and last coordinates for points 1 and 2 are 
+        used as `latlon1` and `latlon2` respectively. 
+        
+        Parameters 
+        ------------
+        to_degree: bool, default=True 
+          Convert the bearing from radians to degree. 
+          
+        Returns 
+        --------
+        :math:`\beta` : float, 
+           The value of bearing in degree ( default). 
+           
+        """
+        msg =(
+            "x, y are not in longitude/latitude format"
+            " while 'utm_zone' is not set. The bearing"
+            " should be less accurate. Provide the UTM"
+            " zone to improve the accuracy.")
+        
+        self.inspect 
+        
+        if self.coordinate_system =='ll': 
+            xs = np.array(copy.deepcopy(self.x)) 
+            ys = np.array(copy.deepcopy(self.y))
+        
+        if ( 
+                self.coordinate_system !='ll' 
+                and self.utm_zone is None) : 
+            warnings.warn(msg ) 
+            
+        self.utm_zone = self.utm_zone or '49R'    
+        if self.coordinate_system !='ll': 
+            # recompute value to lat/lon 
+            # from easting/northing
+            ys , xs = Location.to_latlon_in(
+                self.x, self.y, utm_zone= self.utm_zone) 
+        # compute bearing.     
+        return get_bearing((ys[0], xs[0]) , ( ys[-1], xs[-1] ), 
+                           to_deg= to_degree 
+                           ) 
+    
+    def distance (self, *, average_distance: bool = True): 
+        """Compute the distance between profile coordinates points.
+        
+        Preferably, it uses the UTM coordinates positions. By default 
+        the coordinate system is automatically detected. 
+        
+        Parameters 
+        -----------
+        average_distance: bool, default =True, 
+           Returns the average value of the distance between different points. 
 
-        self.feature_names_in_ = nf + cf 
+        Returns 
+        ---------
+        d: Arraylike of shape (N-1) 
+          Is the distance between points or the average of all distances.  
+        
+        See Also 
+        ---------
+        watex.utils.exmath.get_distance: 
+            Get the distance from longitude/latitude or easting/northing 
+            coordinates. 
+            
+        Examples 
+        --------- 
+        >>> import numpy as np 
+        >>> from watex.site import Profile 
+        >>> posx = np.random.rand (7) *10 
+        >>> posx = np.abs ( np.random.randn (7) * 12 ) 
+        >>> po= Profile().fit(posx, posy )
+        >>> # convert data to UTM and compute distance becuase 
+        >>> # our toy example has value less than 90 and 180.
+        >>> po.distance () 
+        251053.3287093233
+        >>> po.coordinate_system = 'UTM' 
+        >>> 6.451210308544236
+        """
+        self.inspect 
+        
+        x, y = self.x , self.y 
         
-        if len(cf )!=0:
-            # sanitize the categorical values 
-            for c in cf : 
-                data[c] = data[c].str.strip() 
+        if self.coordinate_system =='ll': 
+            x , y = Location.to_utm_in(
+                lats= self.y, lons =self.y, 
+                epsg = self.epsg , 
+                datum = self.datum , 
+                reference_ellipsoid= self.reference_ellipsoid
+            ) 
+    
+        d = np.sqrt( np.diff (x) **2 + np.diff (y)**2 ) 
+        
+        return d.mean()  if average_distance else d 
+    
+    def scale_positions (self, **sp_kws): 
+        """
+        Scale the position coordinates along x and y.
+        
+        Parameters
+        -----------
+        sp_kws: dict 
+           Keyword arguments passed to :func:`~watex.utils.scalePosition`. 
+           
+        Returns 
+        --------
+        x, y : Arraylikes 
+           Scaled positions 
+           
+        See also 
+        ---------
+        watex.utils.scalePositions: 
+            Scale positions using the `scipy` curve fit. 
+        watex.utils.exmath.scale_positions: 
+            Scale and shift positions using bearing. 
             
-        for name in data.columns : 
-            setattr (self, name, data[name])
+        """
+        self.inspect 
+        x, *_ = scalePosition(self.x , **sp_kws) 
+        y, *_ = scalePosition(self.y , **sp_kws)
+        
+        return x, y 
+    
+    def shift_positions (
+        self, 
+        *, 
+        step:float= None, 
+        use_average_dist:bool=False,
+        angle:Optional[float]=None,
+        ): 
+        """
+        Shift the x and y  position coordinates from the step and angle. 
+         
+        By default, it consider `x` and `y` as easting/latitude and 
+        northing/longitude coordinates respectively. It latitude and longitude 
+        are given, specify the parameter `is_latlon` to ``True``. 
+        
+        Parameters
+        ------------
+        step: float, Optional 
+           The positions separation. If not given, the average distance between 
+           all positions should be used instead. 
+        use_average_dist: bool, default=False, 
+           Use the distance computed between positions for the correction. 
+           
+        angle: float, Optional 
+           Bearing angle in degree to shift the profile line . If ``None``, 
+           the ``bearing`` of `x` and `y` is used instead.
+           
+        Returns 
+        --------
+        xx, yy: Arraylike 1d, 
+           The arrays of position correction from `x` and `y` using the 
+           bearing. 
+           
+        See Also 
+        ---------
+        watex.utils.exmath.get_bearing: 
+            Compute the  direction of one point relative to another point. 
+          
+        Examples
+        ---------
+        >>> from watex.utils.exmath import scale_positions 
+        >>> east = [336698.731, 336714.574, 336730.305] 
+        >>> north = [3143970.128, 3143957.934, 3143945.76]
+        >>> p= Profile().fit (east, north)
+        >>> east_c , north_c= p.scale_positions (east, north, step =20) 
+        >>> east_c , north_c
+        (array([336686.69198337, 336702.53498337, 336718.26598337]),
+         array([3143986.09866306, 3143973.90466306, 3143961.73066306]))
+        """
+        cs ={'ll': 'longitude/latitude', 
+             'dms': 'dd:mm:ss'}
+        self.inspect 
+        
+        if self.coordinate_system !='utm': 
+            cse = cs.get('ll').title () if self.coordinate_system =='ll' else (
+                cs.get('dms').upper()  if self.coordinate_system =='dms' else
+              self.coordinate_system .upper() )
+            warnings.warn((
+                "{0!r} coordinates system is detected. Shifting positions" 
+                " expects UTM coordinates. It is recommended to convert"
+                " positions data to UTM (ref:`watex.site.to_utm_in`) before"
+                " processing. The following with {0} coordinates"
+                " might lead to invalid results. Use at your own risk." 
+                ).format(cse)
+                          )
+            
+        if ( not use_average_dist
+            and step is None 
+            ): 
+            warnings.warn("Step is not given. The mean-distance of"
+                          " positions should be used instead.")
+            use_average_dist =True 
+            
+        if use_average_dist: 
+            step = self.distance (
+                average_distance= use_average_dist) 
+ 
+        step  = float (_assert_all_types(step, float, int, objname ='Step'))
+
+        if angle is not None: 
+            angle  = float (_assert_all_types(
+                step, float, int, objname ='Bearing angle (in degree)'))
             
-        # set depth attributes 
-        if 'depth'  in self.feature_names_in_: 
-            self.depth_= data['depth']
+            angle = np.deg2rad (angle %360)  
             
-        self.data_ = data.copy() 
+        angle = angle or self.bearing(to_degree =False ) # return bearing in rad.
+     
+        xx = self.x + ( step * np.cos (angle))
+        yy = self.y +  (step  * np.sin(angle))
+
+        return xx, yy 
+    
+    @staticmethod 
+    def f_ (ar , /,  func: str | F  = 'dms->ll'): 
+        """
+        Converter position function from dms to longitude/latitude degree 
+        decimal or vice versa.
         
-        use_col =False 
-        if self.holeid is not None: 
-            use_col = True 
-        else: self.holeid ='hole'
-            
-        self.hole = data2Box ( 
-            self.data_ , 
-            name =self.holeid, 
-            use_colname= use_col
-                      )
+        Convert position from str (DD:MM:SS) to float (latitude/longitude)
+        and vice versa.
+        
+        Parameters 
+        -----------
+        ar: ArrayLike 1d, 
+           Array containing the position coordinates for conversion. 
+        func: Callable or str, default ='dms->ll'
+            Converter functions. They can be: 
+               
+            - :func:`~watex.utils.gistools.convert_position_str2float` 
+              for ``:dd:mm:ss``  to foat(long, lat) coordinates. If 
+              string is passed it should be ['dms2ll'|'dmstoll'|'dms-<ll']. 
+            - :func:`~watex.utils.gistools.convert_position_float2str` 
+              from float (long, lat) in decimal degree coordinates 
+              to ``dd:mm:ss``. When string is passed, it should be 
+              ['ll2dms'|'lltodms'|'ll->dms']
+               
+        Returns
+        --------
+        generator obj. 
+           Map object composed of value converted. 
         
-        return self  
+        """
+        if isinstance (func, str): 
+            f = _validate_name_in(func, defaults = (
+                'll2dms', 'lltodms', 'll->dms'), 
+                expect_name= convert_position_float2str 
+                ) 
+        if not callable (f): 
+            f = convert_position_str2float 
+            
+        # faster than 
+        # x = np.array ( [ convert_position_str2float(i) for i in x ], 
+        #               dtype = np.float64)
+        # while apply_along not possible due to the string dtype during 
+        # the loop
+        # x = np.apply_along_axis(convert_position_str2float, 0, 
+        #                         np.array (x, dtype =str ))
+        return map ( lambda i: f(i) , ar)
+    
+    @staticmethod 
+    def dms2ll (x:ArrayLike|str  , y:ArrayLike|str , *,  data=None): 
+        """ Convert array x and y from DD:MM:SS to degree decimal -longitude 
+        (x) and latitude (y). 
+        
+        Parameters
+        -----------
+        x, y: ArrayLike containing the degree-minutes-seconds (DMS) coordinates
+           positions.
+        Returns 
+        --------
+        x, y: Arraylike or str
+           ArrayLike in degree decimal coordinates format. By default `x` and 
+           `y` are longitude and latitude respectively. 
+           If `x` and `y` has a string argument, data must be provided, 
+           otherwise an error raises. 
+           
+        data: pd.DataFrame 
+          DataFrame containg the position x and y. 
+          
+          .. versionadded:: 0.2.5 
+          
+        Example
+        ---------
+        >>> from watex.site import Profile 
+        >>> x=['20:15:35'] ; y =['7:45:8.5'] 
+        >>> Profile.dms2ll (x, y)
+        Out[83]: (array([20.25972222]), array([7.75236111]))
+        """
+        if ( 
+                (isinstance (x, str) 
+                or isinstance (y, str)) 
+                and data is None
+                ): 
+            raise TypeError(
+                "Data can't be None when x or y has a string argument.")
+        if data is not None: 
+            x, y = assert_xy_in(x, y, data=data )
+            
+        if not _is_numeric_dtype(x , to_array =True ): 
+           # reconvert object to str for consistency  
+           x = np.array ( list ( Profile.f_(x)), dtype = np.float64 )
+        if not _is_numeric_dtype(y , to_array =True): 
+           y = np.array ( list (Profile.f_ (y)), dtype = np.float64 )
+          
+        return x, y
     
-    def set_coordinates (
+    @staticmethod 
+    def ll2dms (x:ArrayLike|str  , y:ArrayLike|str , *, data=None ): 
+        """
+        Convert array x and y from degree decimal  to 
+        degree-minutes-seconds (DMS)
+        
+        Parameters 
+        -----------
+        x, y: ArrayLike or str 
+           Arrays containing the degree decimal position coordinates.
+           If `x` and `y` has a string argument, data must be provided,
+           otherwise an error raises
+        
+        Returns 
+        --------
+        x, y: Arraylike 
+           ArrayLike in DD:MM:SS coordinates format.
+          
+        data: pd.DataFrame 
+          DataFrame containg the position x and y.
+          
+          .. versionadded:: 0.2.5
+          
+        Example
+        ---------
+        >>> from watex.site import Profile 
+        >>> x =[15.18 ] ; y =[19.60]
+        >>> Profile.ll2dms (x, y)
+        Out[84]: (array(['15:10:48.00'], dtype='<U11'), 
+                  array(['19:36:00.00'], dtype='<U11'))
+        """
+        if ( (isinstance (x, str) 
+              or isinstance (y, str)) 
+              and data is None): 
+            raise TypeError(
+                "Data can't be None when x or y has a string argument.")
+            
+        if data is not None: 
+            x, y = assert_xy_in(x, y, data=data )
+        if _is_numeric_dtype(x , to_array =True ):  
+           x = np.array ( list (Profile.f_ (x, 'll->dms')), dtype = str )
+        if _is_numeric_dtype(y , to_array =True): 
+           y = np.array ( list (Profile.f_ (y, 'll->dms')), dtype = str)
+          
+        return x, y
+    
+    def make_xy_coordinates (
         self, 
-        reflong, 
-        reflat,  
-        step ='5m', 
-        todms=False, 
-        r= 45, 
-        **kws
-         ): 
-        """ Generate longitude and latitude coordinates for boreholes. 
+        *, 
+        step =None,
+        r = None, 
+        todms:bool =False, 
+        **kws 
+        ): 
+        """
+        Generate synthetic coordinates from references latitude and 
+        longitude from x and y. 
         
-        It assumes boreholes are  aligned along the same axis. 
-     
         Parameters 
         -----------
-        reflong: float or string or list of [start, stop]
-            Reference longitude  in degree decimal or in DD:MM:SS for 
-            the first site considered as the origin of the landmark.
-            
-        reflat: float or string or list of [start, stop]
-            Reference latitude in degree decimal or in DD:MM:SS for the 
-            reference site considered as the landmark origin. If value is 
-            given in a list, it can containt the start point and the 
-            stop point. 
-            
         step: float or str 
             Offset or the distance of seperation between different sites 
             in meters. If the value is given as string type, except 
             the ``km``, it should be considered as a ``m`` value. Only 
             meters and kilometers are accepables.
             
         r: float or int 
@@ -282,1170 +600,895 @@
             Reconvert the longitude/latitude degree decimal values into 
             the DD:MM:SS. 
      
         kws: dict, 
            Additional keywords of :func:`~watex.utils.exmath.makeCoords`.   
            
         Returns 
+        ----------
+        lon, lat : ArrayLike 
+           ArrayLike of synthetic coordinates latitude and longitude. 
+          
+        See Also 
         --------
-        self: Instanced object 
-        
-          Instanced object for method chaining.
-        
+        watex.utils.coreutils.makeCoords: 
+            Create mutiple coordinates with different strategies using 
+            references latitude and longitude. 
+            
+        Examples 
+        ----------
+        >>> import watex as wx 
+        >>> # get two coordinates from random stations
+        >>> data = wx.make_erp (n_stations =2 ).frame 
+        >>> p = Profile ().fit(data.longitude, data.latitude)
+        >>> longs, lats = p.make_xy_coordinates(step =100 , todms =True )
+        >>> longs
+        Out[40]: array(['-99:13:48.11', '-99:13:48.11'], dtype='<U12')
+        >>> lats
+        array(['-85:31:37.57', '-85:31:37.57'], dtype='<U12')
+        >>> p = Profile ().fit(data.easting, data.northing)
+        >>> longs, lats = p.make_xy_coordinates(step =100 , todms =True )
+        >>> longs, lats
+        Out[43]: 
+        (array(['110:58:55.00', '110:58:55.00'], dtype='<U12'),
+         array(['4:32:10.96', '4:32:10.96'], dtype='<U10'))
         """
-        self.inspect
-        
-        nsites = len(self.data_ )
-        isutm = False if self.projection =='ll' else True 
+        def _auto ( v): 
+            if str (v).lower().strip() in ('none', 'auto'): 
+                return None 
+            
+        self.inspect 
+        step = _auto (step ); r = _auto (r )
+        # use distance by default and bearing as r angle 
+        step = step or self.distance (average_distance= True )
+        r = r or self.bearing() 
+  
+        reflat = ( self.y[0], self.y[-1]) 
+        reflong = (self.x[0], self.x[-1])
+  
+        isutm = False if self.coordinate_system =='ll' else True 
         utm_zone =  kws.pop ('utm_zone', None ) or self.utm_zone 
         
-        self.lon_, self.lat_= makeCoords(
+        return makeCoords(
             reflong, 
             reflat, 
-            nsites =nsites, 
+            nsites = len(self.x ), 
             r= r ,  
             step =step , 
             todms=todms, 
             utm_zone= utm_zone, 
             is_utm= isutm, 
             datum=self.datum, 
             espg=self.epsg,
             **kws
             ) 
-        
-        return self    
-        
-    def __repr__(self):
-        """ Pretty format for programmer guidance following the API... """
-        _t = ("name", "dname", "projection", "utm_zone", "encoding", "datum", 
-              "epsg", "reference_ellipsoid" ,"interp_coords", "verbose")
-        outm = ( '<{!r}:' + ', '.join(
-            [f"{k}={ False if getattr(self, k)==... else  getattr(self, k)!r}" 
-             for k in _t]) + '>' 
-            ) 
-        return  outm.format(self.__class__.__name__)
-       
     
-    def __getattr__(self, name):
-       rv = smart_strobj_recognition(name, self.__dict__, deep =True)
-       appender  = "" if rv is None else f'. Do you mean {rv!r}'
-       
-       err_msg =  f'{appender}{"" if rv is None else "?"}' 
-       
-       raise AttributeError (
-           f'{self.__class__.__name__!r} object has no attribute {name!r}'
-           f'{err_msg}'
-           )
-
-    @property 
-    def inspect (self): 
-        """ Inspect object whether is fitted or not"""
-        msg = ( "{obj.__class__.__name__} instance is not fitted yet."
-               " Call 'fit' with appropriate arguments before using"
-               " this method"
-               )
-        
-        if not hasattr (self, 'hole'): 
-            raise NotFittedError(msg.format(
-                obj=self)
-            )
-        return 1  
-    
-    
-class DSBorehole: 
-    """ Class delas with Borehole datasets. 
-    
-    :class:`watex.geology.drilling.DSBorehole` works with data collected in 
-    a single borehole. For instance, it could follow the arrangement of 
-    ``h502`` data in :func:`watex.datasets.load_hlogs`
-    
-    Parameters
-    ------------
-    name: str
-       Name or ID of the borehole. 
-      
-    dname: str, optional 
-       Depth column name. If `depth` is specify an attribute `depth_` should 
-       be created. Depth specification is usefull for log plotting of machine
-       training.
-       
-    utm_zone: Optional, string
-       zone number and 'S' or 'N' e.g. '55S'. Default to the centre point
-       of coordinates points in the survey area. It should be a string (##N or ##S)
-       in the form of number and North or South hemisphere, 10S or 03N
-       
-    projection: str, ['utm'|'dms'|'ll'] 
-       The coordinate system in which the data points for the profile is collected. 
-       If not given, the auto-detection will be triggered and find the  suitable 
-       coordinate system. However, it is recommended to provide it for consistency. 
-       Note that if `x` and `y` are composed of value less than 180 degrees 
-       for longitude and 90 degrees for latitude, it should be considered as  
-       longitude-latitude (``ll``) coordinates system. If `x` and `y` are 
-       degree-minutes-second (``dms`` or ``dd:mm:ss``) data, they must be 
-       specify as coordinate system in order to accept the non-numerical data 
-       before transforming to ``ll``. If ``data`` is passed to the :meth:`.fit`
-       method and ``dms`` is not specify, `x` and `y` values should be discarded.
-       
-    datum: string, default = 'WGS84'
-       well known datum ex. WGS84, NAD27, NAD83, etc.
-
-    epsg: Optional, int
-       epsg number defining projection (
-            see http://spatialreference.org/ref/ for moreinfo)
-       Overrides utm_zone if both are provided. 
-
-    reference_ellipsoid: int, default=23 
-       reference ellipsoids is derived from Peter H. Dana's website-
-       http://www.utexas.edu/depts/grg/gcraft/notes/datum/elist.html
-       Department of Geography, University of Texas at Austin
-       Internet: pdana@mail.utexas.edu . Default is ``23`` constrained to 
-       WGS84. 
-        
-    encoding: str, default ='utf8'
-       Default encoding for parsing data. Can also be ['utf-16-be'] for 
-       reading bytes characters. 
-       
-    lonlat: Tuple, Optional 
-       longitude/latitude for borehole coordinates. The location where the 
-       borehole is performed. 
-      
-    verbose: int, default=0 
-       Output messages. 
-      
-    Attributes
-    -----------
-    depth_: Series 
-       Depth array if `dname` is specified. 
-    data_: Pandas DataFrame
-       Sanitized dataframe. 
-    
-    Note 
-    ------
-    Each columns of the dataframe is an attribute. Note that all the non-
-    alphabetic letters is removed and replace by '_'. 
-    
-    """
-    def __init__ (
-        self,
-        name:str=None, 
-        dname: str=None,
-        projection:str='ll', 
-        utm_zone:str=None, 
-        datum:str ='WGS84', 
-        epsg:int=None, 
-        reference_ellipsoid:int=23,
-        encoding:str ='utf-8', 
-        lonlat:tuple =None, 
-        verbose:int= 0, 
+    def interpolate(
+        self, 
+        method ='linear', 
+        inplace =True, 
+        **kws
         ): 
+        """
+        Interpolate x, y and elev ( if applicable).
         
-        self.name=name
-        self.dname=dname 
-        self.projection= projection 
-        self.utm_zone=utm_zone 
-        self.reference_ellipsoid= reference_ellipsoid 
-        self.datum=datum 
-        self.encoding= encoding
-        self.epsg =epsg 
-        self.verbose= verbose 
-   
-    def fit(self, data,  **fit_params ):
-        """ Fit Borehole data and populate attribute data. 
         
-        By default if the projection is given as latitude/longitude 
-        xlon, ylat are longitude and latitude respectively. 
- 
-        Parameters
-        ------------
-        data: pd.DataFrame or Path-like object. 
-           Data containing `xlon` and `y` values as series. Then if `xlon` and `y`
-           are given as string argument, their names must be included in the 
-           data columns. Otherwise an error will raise. 
+        Parameters 
+        -----------
+        inplace: bool, default=True 
+           Erase existing value of x , y and elev with the interpolated one. 
+           If ``False`` , it returns interpolated x, y and elev and 
+           keep the previous attributes x, y and elev untouchable.
+
+        method: bool, default='nearest', 
+           Method of interpolation. One of ['nearest'|'linear'|'cubic'] 
+         
+        kws: dict,
+           Additional keywords arguments passed to
+           :func:`~watex.utils.funcutils.interpolate_grid`. 
            
-        Return 
-        ---------
-        self : Instanced object 
-            Instanced object for chaining method. 
+        Returns
+        --------
+        self|x, y, elev: :class:`~watex.site.Profile` or Arraylikes 
+           `:class:`.Profile` objects if `inplace` is ``True`` or 
+           interpolated x, y and elev. 
+           
+        See Also 
+        --------
+        watex.utils.funcutils.interpolate_grid: 
+            Interpolate two dimensional array. 
             
-        """
-        columns = fit_params.pop ("columns", None  )
-        data = _is_readable(data, as_frame =True, input_name= 'b', 
-                columns = columns, encoding =self.encoding )
-        
-        data = check_array (
-            data, 
-            force_all_finite= "allow-nan", 
-            dtype =object , 
-            input_name="Borehe data", 
-            to_frame=True, 
-            )
-        
-        data, nf, cf = to_numeric_dtypes(
-            data , 
-            return_feature_types= True, 
-            verbose =self.verbose, 
-            sanitize_columns= True, 
-            fill_pattern='_', 
-            **fit_params 
-            )
+        Examples 
+        --------
+        >>> import numpy as np 
+        >>> from watex.site import Profile 
+        >>> x = [ 28, np.nan, 50, 60 ]
+        >>> y =[ np.nan, 1000, 2000, 3000]
+        >>> elev=[ 0, 1 , np.nan, np.nan]
+        >>> po = Profile().fit(x, y, elev )
+        >>> po.interpolate () 
+        >>> po.x 
+        array([28., 39., 50., 60.])
+        >>> po.y 
+        array([1000., 1000., 2000., 3000.])
+        >>> po.elev 
+        array([0., 1., 1., 1.])
 
-        self.feature_names_in_ = nf + cf 
-        
-        if len(cf )!=0:
-            # sanitize the categorical values 
-            for c in cf : 
-                data[c] = data[c].str.strip() 
-            
-        
-        for name in data.columns : 
-            setattr (self, name, data[name])
-            
-        # set depth attributes 
-        self.depth_= None 
-        
-        if self.dname is not None: 
-            if self.dname not in self.feature_names_in_: 
-                self.dname ='depth' 
+        """ 
+        emsg = ("Interpolation expects x, y and elev to have a consistent"
+                " size. sizes x, y and elev are {}, {} and {}.")
         
-        if self.dname  in self.feature_names_in_: 
-            self.depth_= data[self.dname]
-            
-        self.data_ = data.copy() 
+        self.inspect 
         
-        return self 
-    
-    
-    def set_depth ( 
-        self ,z0=0.,  max_depth =None, 
-        ): 
-        """ Set the a random depth if depth is not given.
+        try :
+            _check_consistency_size(self.x, self.y) 
+            _check_consistency_size(self.y, self.elev)
+        except: 
+            raise ProfileError(emsg.format(
+                len(self.x), len(self.y), len(self.elev )) )
+            
+        # make a grid data along axis =0 
+        ar = np.vstack ((self.x, self.y, self.elev ))
+        # interpolate is done along axis =0 so 
+        # for x, y and elev we may transpose 
+        # the data first and do the reverse 
+        # processing back for new x, y and z 
+        ar = interpolate_grid(ar, method = method , **kws) 
+        
+        x , y, elev = np.vsplit (ar  , 3 )
+        x, y, elev = reshape (x) , reshape (y), reshape (elev)
+        if inplace : 
+            self.x, self.y, self.elev = x, y, elev 
+            
+            return self 
+        
+        return x, y, elev 
+
+    @staticmethod 
+    def out (
+        x:ArrayLike , 
+        y:ArrayLike, 
+        /, 
+        elev:ArrayLike =None, 
+        filename:str=None, 
+        basename:str=None , 
+        counter:bool= False , 
+        sep:str =None , 
+        savepath:str =None, 
+        extension:str ='.txt', 
+        how:str='py', 
+        verbose:int=0, 
+        ):
+        """Export coordinates data. 
         
-        To fetch the depth, use attribute `depth_`. Note that if the depth 
-        exist, calling `set_depth` will arase the former depth value. Use 
-        in cautioness. 
+        File to export should be ['name' | 'x' |'y' |'elev' ]. 
         
         Parameters 
         -----------
-        z0: float, default=0.
-         The surface reference. Preferably, it is set to null. 
-         
-        max_depth: float, default=700. 
-          The maximum depth. Depth size must fit the length of the data in 
-          meters. Default depth is fixed to 700 meters. 
+        x: Arraylike 
+           X-coordinate values to export. 
+           
+        y: ArrayLike, 
+          Y -coordinate values to export. 
           
-        Return
-        -------
-        self: Instanced object 
-            Instanced object for chaining method. 
+        elev: ArrayLike, 
+           Elevation values to export. If not given should be null. 
+           
+        filename: str, 
+           Name of output file. 
+           
+        basename: str, default='Site'
+           Station/site name of each coordinate (x, y)  position. If not given 
+           should be ``site``. 
+           
+        counter: bool, default=False 
+            If ``True``, count the number site and prefix it. For instance of 
+            `42` sites with the ``basename=AMT``, the first counter site 
+            should be ``00_AMT for Python indexing (``how='py'``)
+            
+        sep: str, default =' ' 
+           the separator between site, x, y, elev. 
+           
+        savepath: str, 
+           Output file destination. Default is current directory. 
+           
+        extension: str, default='.txt'
+           The format of output coordinates files. If the `extension` is 
+           suffixed with the `filename`, it should be used instead. 
+           
+        how: str, default='py'
+          Way for counting the site/station. Any other value should starting 
+          counting the site from 1. 
+             
+        verbose:int, default=False 
+           show message to where the file is saved. 
+           
+        .. versionadded:: 0.2.1 
+        
         
+        Examples 
+        ---------
+        >>> import numpy as np 
+        >>> import watex as wx 
+        >>> data = wx.make_erp (n_stations=24).frame 
+        >>> wx.site.Profile.out (data.easting, data.northing, verbose =True  )
+        >>> elev = np.random.permutation  (len(data.easting)) *100 
+        >>> wx.site.Profile.out (data.easting, data.northing, elev, 
+                                 filename ='coordinates.txt', basename ='AMT-E1', 
+                                 counter =True )
         """
-        self.inspect 
-        z0 = convert_value_in (z0 )
+       
+        x = np.array( is_iterable(
+            x, exclude_string =True, transform =True )) 
+        y = np.array( is_iterable(y , exclude_string =True, transform =True )) 
+        elev = np.array( is_iterable(elev , exclude_string =True, 
+                                     transform =True )) 
+        
+        _check_consistency_size(x, y )
+        
+        elev = elev if elev is not None else np.repeat([0.], len(x))
+        # for consitency 
+        _check_consistency_size(y, elev )
+        
+        basename = basename or 'Site'
+        basename = str (basename )
+        filename= filename or 'site'
+        filename = str(filename )
         
-        max_depth = 700. if not max_depth else max_depth 
-
-        max_depth = float( _assert_all_types ( max_depth, int, float, 
-                                              objname = 'Maximum-depth')) 
+        sep = sep or " "
+        sep = str(sep )
  
-        self.depth_ = pd.Series ( np.linspace ( z0, max_depth, len(self.data_) 
-                                               ), name ='depth')
-        # append depth data 
-        # self.data_.insert (0 , 'depth', self.depth_, allow_duplicates =True)
-        self.data_ = pd.concat ([ self.depth_, self.data_], axis = 1, 
-                                ignore_index =True )
-
-        return self 
-    
-    def set_thickness(self, h0= 1 , **kws ): 
-        """ Set a random layer thickness from borehole refering to the depth.
+        # make site 
+        sites = [(( f"{ii:02}_" if how=='py' else f"{ii+1:02}_") 
+                  if counter else '') + basename 
+                 for ii in range (len(x )) ]
+        writelines =[]
+        #x = x.astype (str) ; y = y.astype (str) ; elev= elev.astype (str)
+        for site, east, north , elev in zip ( sites, x, y, elev ): 
+            writelines.extend(
+                [site + sep + 
+                 f"{east:.3f}"  +sep +  
+                 f"{north:.3f}"+ sep + 
+                 f"{elev:.3f}"  + '\n' ]
+                )
+
+        filename, ex  = os.path.splitext(filename )
+        extension = extension if ex =='' else ex
+        
+        extension ='.'+ extension.replace ('.', '') # for consistency 
+        
+        with open (filename + extension, 'w',encoding='utf8') as df:
+            df.writelines(writelines)
+
+        if savepath : 
+            shutil.move (filename + extension, savepath )
+            
+        if verbose: 
+            print(f"--> File {filename+extension} is successfull written" + 
+                  (f"to {savepath}." if savepath else '.'))
         
-        To fetch the thickness, use attribute `layer_thickness_`. 
+    
+    def plot (
+        self, 
+        sites: ArrayLike[str]=None , 
+        basename:str ='S', 
+        coerce:bool=True,  
+        **kws): 
+        """Base plot of the profile. 
         
         Parameters 
         -----------
-        h0: int, default='1m' 
-          Thickness of the first layer. 
-          
-        shuffle: bool, default=True 
-          Shuffle the random generated thicknesses. 
-
-        dirichlet_dis: bool, default=False 
-          Draw samples from the Dirichlet distribution. A Dirichlet-distributed 
-          random variable can be seen as a multivariate generalization of a 
-          Beta distribution. The Dirichlet distribution is a conjugate prior 
-          of a multinomial distribution in Bayesian inference.
-          
-        random_state: int, array-like, BitGenerator, np.random.RandomState, \
-             np.random.Generator, optional
-          If int, array-like, or BitGenerator, seed for random number generator. 
-          If np.random.RandomState or np.random.Generator, use as given.
-          
-        unit: str, default='m' 
-          The reference unit for generated layer thicknesses. Default is 
-          ``meters``
         
-        Return
-        -------
-        self: Instanced object 
-            Instanced object for chaining method. 
+        sites: str, Arraylike 
+            The name of the sites that fits each position x, y
+ 
+        basename: str, default='S' 
+           the text to prefix the `site` position when the text is not given. 
         
-        """
-        self.inspect 
+        coerce:bool, default=True 
+           Force the plot despite the given sites do not match the number of  
+           positions `x` and `y`. If ``False``, number of positions must be 
+           consistent with x and y, otherwise error raises. 
+           
+        kws: dict, 
+           Additional keyword arguments passed to
+           :func:`~watex.utils.plotutils.plot_text`
+           
+        .. versionadded:: 0.2.1 
         
-        if self.depth_ is None:
-            self.set_depth () 
-            
-        thickness = get_random_thickness  ( self.depth_, **kws)
         
-        self.layer_thickness_= pd.Series (thickness, name='layer_thickness' )
-        self.data_ = pd.concat ([  self.data_,  self.layer_thickness_], 
-                                axis = 1, ignore_index =True )
+        """
+        from .utils.plotutils import plot_text 
         
-        return self 
-    
-
-    def __repr__(self):
-        """ Pretty format for programmer guidance following the API... """
-        _t = ("name", "dname", "projection", "utm_zone", "encoding", "datum", 
-              "epsg", "reference_ellipsoid" ,"interp_coords", "verbose")
-        outm = ( '<{!r}:' + ', '.join(
-            [f"{k}={ False if getattr(self, k)==... else  getattr(self, k)!r}" 
-             for k in _t]) + '>' 
-            ) 
-        return  outm.format(self.__class__.__name__)
-       
-    
-    def __getattr__(self, name):
-       rv = smart_strobj_recognition(name, self.__dict__, deep =True)
-       appender  = "" if rv is None else f'. Do you mean {rv!r}'
-       
-       err_msg =  f'{appender}{"" if rv is None else "?"}' 
-       
-       raise AttributeError (
-           f'{self.__class__.__name__!r} object has no attribute {name!r}'
-           f'{err_msg}'
-           )
-
+        self.inspect 
+        
+        return plot_text (
+            self.x, 
+            self.y , 
+            text = sites, 
+            coerce =coerce, 
+            basename=basename,
+            xlabel= self.xname_ or '', 
+            ylabel = self.yname_ or '', 
+            **kws 
+            )
+ 
     @property 
     def inspect (self): 
         """ Inspect object whether is fitted or not"""
         msg = ( "{obj.__class__.__name__} instance is not fitted yet."
                " Call 'fit' with appropriate arguments before using"
                " this method"
                )
-        
-        if not hasattr (self, 'data_'): 
+        if not hasattr (self, 'x'): 
             raise NotFittedError(msg.format(
                 obj=self)
             )
-        return 1
+        return 1 
     
-     
-class Borehole(Geology): 
-    """
-    Focused on Wells and `Borehole` offered to the population. To use the data
-    for prediction purpose, each `Borehole` provided must be referenced on 
-    coordinates values or provided the same as the one used on `ves` or `erp` 
-    file. 
-    
-    """
-    def __init__(
-        self,
-        lat:float = None, 
-        lon:float = None, 
-        area:str = None, 
-        status:str =None, 
-        depth:float = None, 
-        base_depth:float =None, 
-        geol:str=None, 
-        staticlevel:float =None, 
-        airlift:float =None, 
-        id=None, 
-        qmax =None, 
-        **kwds
-        ): 
-       super().__init__(**kwds)
+    def __repr__(self): 
+        """ Represent the output class format """
+        t_=("utm_zone" ,"coordinate_system","datum" ,
+            "epsg" ,"reference_ellipsoid" ) 
         
-       self.lat=lat 
-       self.lon=lon 
-       self.area=area 
-       self.status=status 
-       self.depth=depth 
-       self.base_depth=base_depth 
-       self.geol=geol 
-       self.staticlevel=staticlevel 
-       self.airlift =airlift 
-       self.id=id 
-       self.qmax=qmax 
-       
-       for key in list(kwds.keys()): 
-           setattr (self, key, kwds[key])
+        outm = ( '<{!r}:' + ', '.join(
+            [f"{k}={getattr(self, k)!r}" for k in t_]) + '>' 
+            ) 
+        return  outm.format(self.__class__.__name__)
+    
+    
+Profile.__doc__="""\
+Profile class deals with the positions collected in the survey area. 
 
+In principle, there is no exact solution  between longitude/latitude to 
+x/y coordinates. Indeed, there is no isometric map from the sphere to the 
+plane. when you convert lon/lat coordinates from the sphere to x/y 
+coordinates in the plane, we cannot hope that all lengths will be preserved 
+by this operation. Therefore, we have to accept some kind of deformation. 
+For smallish parts of earth's surface, transverse Mercator is quite common.
+
+By default, we use ``x`` for `longitude` and ``y`` for `latitude`. This is 
+useful when data is passed as longitude-latitude (``ll``) or degree-minutes-
+seconds (``dms``) in the `fit` method.
+
+Parameters 
+----------
+utm_zone: Optional, string
+   zone number and 'S' or 'N' e.g. '55S'. Default to the centre point
+   of coordinates points in the survey area. It should be a string (##N or ##S)
+   in the form of number and North or South hemisphere, 10S or 03N
+coordinate_system: str, ['utm'|'dms'|'ll'] 
+   The coordinate system in which the data points for the profile is collected. 
+   If not given, the auto-detection will be triggered and find the  suitable 
+   coordinate system. However, it is recommended to provide it for consistency. 
+   Note that if `x` and `y` are composed of value less than 180 degrees 
+   for longitude and 90 degrees for latitude, it should be considered as  
+   longitude-latitude (``ll``) coordinates system. If `x` and `y` are 
+   degree-minutes-second (``dms`` or ``dd:mm:ss``) data, they must be 
+   specify as coordinate system in order to accept the non-numerical data 
+   before transforming to ``ll``. If ``data`` is passed to the :meth:`.fit`
+   method and ``dms`` is not specify, `x` and `y` values should be discarded.
+   
+datum: string, default = 'WGS84'
+   well known datum ex. WGS84, NAD27, NAD83, etc.
+
+epsg: Optional, int
+   epsg number defining projection (
+        see http://spatialreference.org/ref/ for moreinfo)
+   Overrides utm_zone if both are provided. 
+
+reference_ellipsoid: int, default=23 
+   reference ellipsoids is derived from Peter H. Dana's website-
+   http://www.utexas.edu/depts/grg/gcraft/notes/datum/elist.html
+   Department of Geography, University of Texas at Austin
+   Internet: pdana@mail.utexas.edu . Default is ``23`` constrained to 
+   WGS84. 
+    
+Examples 
+--------- 
+>>> from watex.datasets import load_edis
+>>> from watex.site import Profile  
+>>> xy = load_edis (samples =17 , as_frame =True , key ='latitude longitude') 
+>>> xy.head (2)
+    longitude   latitude
+0  110.485833  26.051390
+1  110.486153  26.051794 
+>>> pro= Profile ().fit( xy.longitude, xy.latitude) 
+>>> pro.distance ()
+62.890276656978244
+>>> pro.bearing () 
+35.4252016495945
+>>> pro.make_xy_coordinates( ) 
+(array([110.48583316, 110.48615319, 110.48647322, 110.48679325,
+       110.48711328, 110.48743331, 110.48775334]), 
+ array([26.05138954, 26.05179371, 26.05219788, 26.05260205, 26.05300622,
+       26.05341038, 26.05381455]))
+"""
     
-    def fit(self,
-            data: str |DataFrame | NDArray 
-        )-> object: 
-        """ Fit Borehole data and populate the corrsponding attributes"""
-        
-        self._logging.info ("fit {self.__class__.__name__!r} for corresponding"
-                            "attributes. ")
-    
-        return self
-    
-class Drill(Geology):
-    """
-    This class is focus on well logs . How to generate well Log for Oasis:
-        
-    Arguments
-    -----------
-    **well_filename** : string ,
-        The  well filename. 02 options is set : 
-        1rst option is to build well data manually and the program will  
-        generate a report.  2nd option is to send to
-        the program a typical file type to be parsed . the programm parses
-        only the typical well datafile. If None ,  the program will 
-        redirect to build mannually option . 
-                
-    **auto** : bool  
-        option to automatically well data . set to True 
-         if you want to build manually a well data .
-        *default* is False
-
-    ====================  ==========  =========================================    
-    Key Words/Attributes  Type          Description    
-    ====================  ==========  =========================================   
-    utm_zone                str         utm WGS84 zone. should be N or S.   
-                                        *default* is 49N .
-    compute_azimuth         bool        if no azimuth is provided. 
-                                        set to True to letprogram to compute
-                                        azimuth .*Default* is False.
-    Drill_dip               float       The dip of drill hole.*default* is 90
-    Drill_buttom            float       The average bottom of drill , 
-                                        can be filled during the well
-                                        buiding . *default* is  None
-    mask                    int         the mask of DrillHole(DH) data. 
-                                        *Default * is 1.
-    ====================  ==========  =========================================
-    
-    ==================  =======================================================
-    Methods                   Description
-    ==================  =======================================================
-    _collar             build _collar data *return*  collar log dataframe 
-                        format
-     dhGeology          build DH log geology *return* geology log dataframe.        
-    dhSample            build DH Geochemistry-Strutural sample, *return* Sample
-                        log dataframe    
-    dhSurveyElevAz      build DH Elevation & Azimuth logs.*return * Elevation
-                        & Azimuth dataframes
-    writeDHDATA          output log :* return *  the right log to output for
-                        Oasis Montaj 
-    ==================  =======================================================
-        
-    :Example: 
-        
-    >>> from watex.geoloy.drilling import Drill 
-    >>> parser_file ='nbleDH.csv'
-    >>> drill_obj=Drill(well_filename='data/drill/drill_example_files')
-    >>>  scollar=drill._collar(DH_Top=None)
-    >>> sgeo=drill.dhGeology()
-    >>> ssam=drill.dhSample()
-    >>> selevaz=drill.dhSurveyElevAz( add_elevation=None, 
-    ...                             add_azimuth=None)
-    >>> swrite=drill.writeDHData(data2write ="*", savepath =None)
-    """
-
-    import_optional_dependency ("openpyxl")   
-    def __init__(self, well_filename=None , auto=True, **kwargs):
-        
-        self.wfilename=well_filename
-        self.auto=auto
-        
-        self.mask=kwargs.pop("mask",1)
-        self.utm_zone=kwargs.pop("utm_zone","49N")
-        self.compute_azimuth=kwargs.pop("compute_azimuth",False)
-        self.dip =kwargs.pop("Drill_dip",90)
-        self.buttom=kwargs.pop("Drill_buttom", None)
-        self.savepath =kwargs.pop('savepath', None )
-
-        
-        self.easts=None
-        self.norths= None
-        self.wellnames= None
-        self._f=None 
-        
-        #populate attribute later 
-        self.wdico={"DH_Hole" :None, 
-                    "DH_East":None, 
-                    "DH_North":None, 
-                    "Mask": None,
-                    "DH_RH":None, 
-                    'DH_From':None , 
-                    "DH_To": None , 
-                    "Rock": None , 
-                    "DH_Azimuth":None , 
-                    'DH_Top':None, 
-                    'DH_Bottom':None,
-                    'DH_PlanDepth':None, 
-                    'DH_Decr':None, 
-                    'Sample':None,
-                    'DH_Dip': None, 
-                    'Elevation':None,
-                    'DH_RL':None,
-                    }        
-        
-        # if self.auto is False and self.wfilename is None :
-            
-        #     self.daTA=func.build_wellData (add_azimuth=self.compute_azimuth, 
-        #                                     utm_zone=self.utm_zone,
-        #                                     report_path = self.savepath, 
-        #                                     )
-        #     self.wdata=self.daTA[1]
-            
-        #     self.wdico["DH_East"]   =   self.wdata[:,1]
-        #     self.wdico["DH_North"]  =   self.wdata[:,2]
-        #     self.wdico["DH_Hole"]   =   self.wdata[:,0]
-        #     self.wdico['DH_Dip']    =   self.wdata[:,4]
-        #     self.wdico['DH_Bottom'] =   self.wdata[:,3]
-        #     self.wdico['DH_Decr'] =   self.wdata[:,7]
-        #     self.wdico['DH_PlanDepth'] =   self.wdata[:,6]
-        #     self.wdico["DH_Azimuth"] =   self.wdata[:,5]
-            
-        #     self._f=0
-
-
-        # elif  self.wfilename is not None :
-            
-        #     self.daTA=func.parse_wellData(filename=self.wfilename,
-        #                                   include_azimuth=False,
-        #                                   utm_zone=self.utm_zone)
-        #     self.wdata=self.daTA[1]
-        #     self.wdico.__setitem__("DH_East", self.wdata[:,1])
-        #     self.wdico.__setitem__("DH_North", self.wdata[:,2])
-        #     self.wdico.__setitem__("DH_Hole", self.wdata[:,0])
-        #     self.wdico.__setitem__('DH_Dip', self.wdata[:,3])
-        #     self.wdico.__setitem__('DH_PlanDepth', self.wdata[:,8])
-        #     self.wdico.__setitem__("DH_Azimuth", self.wdata[:,5])
-        #     self.wdico.__setitem__('DH_Decr', self.wdata[:,9])
-        #     self.wdico.__setitem__('DH_Bottom', self.wdata[:,7])
-            
-        #     self._f=1
-            
-
-        #set Mask and set dr_rh
-        self.mask=np.full((self.wdata.shape[0]),self.mask,dtype='<U12')
-        # print(self.mask.shape)
-        self.wdico.__setitem__("Mask", self.mask)
-        self.dh_rh=np.zeros((self.wdata.shape[0]))
-        self.wdico.__setitem__("DH_RH", self.dh_rh)  
+class Location (object): 
 
-        for keys in kwargs.keys():
-            self.__setattr__(keys, kwargs[keys])
-            
+    def __init__(
+        self, 
+        lat= None, 
+        lon=None,
+        elev=None, 
+        datum='WGS84', 
+        epsg=None,
+        reference_ellipsoid=23,
+        utm_zone=None, 
+        **kwds
+        ) :
+        self._logging = watexlog.get_watex_logger(
+            self.__class__.__name__)
+        self._lat = lat 
+        self._lon = lon 
+        self._utm_zone=utm_zone
+        self._elev=elev
+        
+        self.datum=datum
+        self.epsg=epsg 
+        self.reference_ellipsoid=reference_ellipsoid
+        
+        self._east= None 
+        self._north =None 
+        
+        for key in list(kwds.keys()) : 
+            setattr (self, key, kwds[key])
             
-    def _collar(self, DH_Top=None,add_elevation =None ):
-        """
-        Method to build Collar Data 
+    @property 
+    def utm_zone (self): 
+        return self._utm_zone
+        
+    @property 
+    def lat(self): 
+        return self._lat
+    @property 
+    def lon(self) : 
+        return self._lon
+    @property 
+    def east(self ): 
+        return self._east
+    @property 
+    def north(self):
+        return self._north
+    @property 
+    def elev(self): 
+        return self._elev
+
+    @utm_zone.setter 
+    def utm_zone (self, utm_zone): 
+        utm_xone = copy.deepcopy(utm_zone) 
+        utm_zone = str(utm_zone).upper().strip() 
+        str_ = f"{'|'.join([ i for i in UTM_DESIGNATOR.keys()]).lower()}"
+        regex= re.compile(rf'{str_}', flags=re.IGNORECASE)
+        if regex.search(utm_zone) is None: 
+           raise SiteError (f"Wrong UTM zone value!: {utm_xone!r} ")
+        self._utm_zone =utm_zone.upper() 
+    
+    @lat.setter 
+    def lat (self, lat): 
+        self._lat = assert_lat_value(lat)
+        
+        
+    @lon.setter 
+    def lon(self, lon) : 
+        self._lon = assert_lon_value(lon)
+        
+    @elev.setter 
+    def elev(self, elev) : 
+        self._elev = assert_elevation_value(elev ) 
+        
+    @east.setter 
+    def east (self, east): 
+        self._east = np.array(east, dtype = float )
+
+    @north.setter 
+    def north (self, north): 
+        self._north = np.array(north, dtype =float)
         
+    def to_utm (
+        self, 
+        lat:float=None, 
+        lon:float=None, 
+        datum:str= None ,
+        utm_zone:str=None, 
+        epsg:int=None, 
+        reference_ellipsoid:int= None
+        ): 
+        """
+        Project coordinates to utm if coordinates are in degrees at  
+        given reference ellipsoid constrained to WGS84 by default. 
+         
         Parameters 
-        ----------
-        * DH_Top  : np.ndarray ,
-                it's the Top of data for each Hole Name. 
-                ndaray (number of DH , 1) 
-                *Default* is None.
+        -----------
+        lat: float or string (DD:MM:SS.ms)
+            latitude of point
+                  
+        lon: float or string (DD:MM:SS.ms)
+            longitude of point
+        
+        datum: string, default='WGS84'
+            well known datum ex. WGS84, NAD27, NAD83, etc.
+
+        utm_zone: Optional, string
+            zone number and 'S' or 'N' e.g. '55S'. Defaults to the centre point
+            of the provided points
+                       
+        epsg: Optional, int
+            epsg number defining projection (see http://spatialreference.org/ref/ for moreinfo)
+            Overrides utm_zone if both are provided
+
+        reference_ellipsoid: Optional, int 
+            reference ellipsoids is derived from Peter H. Dana's website-
+            http://www.utexas.edu/depts/grg/gcraft/notes/datum/elist.html
+            Department of Geography, University of Texas at Austin
+            Internet: pdana@mail.utexas.edu . Default is ``23`` constrained to 
+            WGS84. 
+             
         Returns
-        -------
-        pd.DataFrme 
-            collar Drillhole log
+        --------
+        proj_point: tuple(easting, northing, zone)
+            projected point in UTM in Datum
+            
         """
-
-        if DH_Top is None :
-            DH_Top=np.zeros((self.wdata.shape[0]))
-        elif type(DH_Top) is float or type(DH_Top) is int :
-            DH_Top=np.full((self.wdata.shape[0]),DH_Top,dtype='<U12')
-            
-        elif DH_Top is not None :
-            if type(DH_Top)==list:
-                DH_Top=np.array(DH_Top)
-                
-            assert DH_Top.shape[0]==self.wdata.shape[0],'the input DH_Top '\
-                'shape doesnt match. The convenience '\
-                    ' shape is %d.'%self.wdata.shape[0]
-        
-        # print(DH_Top)
-        self.wdico.__setitem__('DH_Top',DH_Top)
-        
-        if self._f == 0 :
-            if add_elevation is None :
-                #No topography is added , set to 0 
-                add_elevation=np.full((len(self.wdico['DH_East']),1),0,
-                                      dtype='<U12')
-            elif add_elevation is not None :
-                if type(add_elevation ) is list :
-                    add_elevation =np.array(add_elevation)
-                assert add_elevation.shape[0]==\
-                    self.wdico['DH_East'].shape[0],"INDEXERROR:"\
-                    " The the current dimention of Elevation data is {0}.It's must be"\
-                        " the size {1}.".format(
-                            add_elevation.shape[0],self.wdico['DH_East'].shape[0])
+        
+        if lat is not None : 
+            self.lat = lat
+        if lon is not None : 
+            self.lon =lon
             
-            self.wdico.__setitem__("Elevation", add_elevation)
-                    
-        elif self._f == 1 :
+        if (self.lat or self.lon) is None : 
+            raise SiteError (" Latitude and longitude must not be None")
             
-            if add_elevation is not None:
-                
-                if type(add_elevation ) is list :
-                    add_elevation =np.array(add_elevation)
-                try :
-                    np.concat((add_elevation,self.wdico['DH_East']))
-                except Exception : 
-                    mess =''.join([
-                        'SIZEERROR! Try to set the elevation dimentional as ', 
-                            'same size like the collar data'])
-                    self._logging.error(mess)
-                    warn(mess)
-                    
-            elif add_elevation is None :
-                add_elevation=self.daTA [1][:,4]
-        
-            self.wdico.__setitem__("Elevation", add_elevation)
-        
-        collarKeys=["DH_Hole",	"DH_East",	"DH_North",	"DH_RH",
-                    "DH_Dip", "Elevation", "DH_Azimuth","DH_Top", "DH_Bottom",
-                    "DH_PlanDepth",	"DH_Decr",	"Mask"] 
-        
-        # print(self.wdico)
-        collar=self.wdico[collarKeys[0]]
-        collar=collar.reshape((collar.shape[0],1))
-        for ss, collk in enumerate(collarKeys[1:]):  
-            # print(collk)
-            for key , value in self.wdico.items():
-                if key == collk :
-                    value=value.reshape((value.shape[0],1))
-                    collar=np.concatenate((collar,value), axis=1)
-        
+        self.epsg = epsg or self.epsg 
+        self.datum = datum  or self.datum 
         
-        self.coLLAR=pd.DataFrame(data=collar, columns=collarKeys)
+        self.reference_ellipsoid = reference_ellipsoid or \
+            self.reference_ellipsoid
+     
+        try : 
+            self.east, self.north, self.utm_zone= project_point_ll2utm(
+                lat = self.lat ,
+                lon= self.lon,
+                datum = self.datum , 
+                utm_zone = self.utm_zone ,
+                epsg= self.epsg 
+                ) 
+   
+        except :
 
-        return self.coLLAR
-    
+            self.utm_zone, self.east, self.north= ll_to_utm(
+                reference_ellipsoid=self.reference_ellipsoid,
+                lat = self.lat, 
+                lon= self.lon)
+        
+            
+        return float(self.east), float(self.north)
     
-    def dhGeology (self, dh_geomask=None):
-        """
-        Method to build geology drillhole log. The name of input rock must
-        feell exaction accordinag to a convention AGSO file . If not sure
-        for the name of rock and Description and label. You may consult
-        the geocode folder before building the well_filename. If the entirely
-        rock name is given , program will search on the AGSO file the 
-        corresponding Label and code . If the rock name is  founc then 
-        it will take its CODE else it will generate exception. 
- 
-        Parameters
-        ----------
-        * dh_geomask : np.ndarray, optional
-                    geology mask. send mask value can take exactly
-                    the np.ndarray(num_of_geology set ,). The better way 
-                    to set geology maskis to fill on the wellfilename.
-                    if not , programm will take the general mask value. 
-                    The *default* is None.
-
-        Returns
-        -------
-        pd.DataFrame 
-            geology drillhole log.
+        
+    def to_latlon(
+        self, 
+        east:float=None, 
+        north:float= None, 
+        utm_zone:str=None, 
+        reference_ellipsoid:int=None , 
+        datum:str = None 
+        ): 
         """
+        Project coodinate on longitude latitude once  data are utm at  given
+        reference ellispoid constrained to WGS-84 by default. 
         
+        Parameters 
+        -----------
+        east: float
+            easting coordinate in meters
+                    
+        north: float
+            northing coordinate in meters
         
-        geolKeys=["DH_Hole","DH_From",	"DH_To","Rock",	"Sample",
-                  "East",	"DH_North",	"DH_RH",	"Mask"]
+        utm_zone: Optional, string (##N or ##S)
+            utm zone in the form of number and North or South hemisphere, 10S or 03N
         
-        wgeo=self.daTA[2]
-        # print(wgeo)
-        
-        self.wdico.__setitem__('DH_From', wgeo[:,1])
-        self.wdico.__setitem__('DH_To', wgeo[:,2])
-        self.wdico.__setitem__("Rock",wgeo[:,3])
-        dhgeopseudosamp=np.zeros((wgeo.shape[0]))
-        
-        ###### FIND AGSO MODULE #######
-        #Try to check the name of rocks and their acronym
-        geoelm= get_agso_properties()
-            # #extract elem with their acronym 
-        geolemDico_AGSO={key:value for key , value in \
-                         zip (geoelm["CODE"],geoelm['__DESCRIPTION'])}
-        # elemgeo_AGSO=sorted(geolemDico.items())
-        for ii, elm in enumerate (self.wdico['Rock']):
-            if elm.upper() in geolemDico_AGSO.keys():
-                pass 
-            elif elm.upper() not in geolemDico_AGSO.keys():
-                if elm.lower() in geolemDico_AGSO.values():
-                    for key, values in geolemDico_AGSO.items():
-                        if elm.lower() == values :
-                            self.wdico['Rock'][ii]=key
-                else  :
-                    mess=''.join(['The Geological Name ({0})'
-                                  ' given in is wrong'.format(elm),
-                                'Please provide a right name the right Name.', 
-                                'Please consult the AGSO file in _geocodes folder', 
-                                'without changing anything.'])
-                    self._logging.warn(mess)
-                    warn(mess)
-
-        ######END AGS0 ########
-        
-        self.dh_geoleast=np.zeros((wgeo.shape[0]))
-        self.dh_geol_norths=np.zeros((wgeo.shape[0]))
-        
-        for ss , value in enumerate(self.dh_geoleast):
-            for indix, val in enumerate(self.wdico["DH_East"]):
-                if wgeo[:,0][ss] in self.wdico["DH_Hole"]:
-                    value=val
-                    self.dh_geoleast[ss] =value
-                    self.dh_geol_norths[ss]=self.wdico["DH_North"][indix]
-                    
-        dhgeopseudosamp=np.zeros((wgeo.shape[0]))
-
-        if dh_geomask == None :
-            dh_geomask =self.mask[0]
-        maskgeo= np.full((wgeo.shape[0]),dh_geomask,dtype='<U12')
-        dhrhgeo=np.array([ -1* np.float(ii) for ii in self.wdico['DH_From']])
-        dhGeol=np.concatenate((wgeo[:,0].reshape(wgeo[:,0].shape[0],1),
-                              self.wdico['DH_From'].reshape((
-                                  self.wdico['DH_From'].shape[0],1)),
-                              self.wdico['DH_To'].reshape((
-                                  self.wdico['DH_To'].shape[0],1)),
-                              self.wdico['Rock'].reshape((
-                                  self.wdico['Rock'].shape[0],1)),
-                              dhgeopseudosamp.reshape((
-                                  dhgeopseudosamp.shape[0],1)),
-                              self.dh_geoleast.reshape((
-                                  self.dh_geoleast.shape[0],1)),
-                              self.dh_geol_norths.reshape((
-                                  self.dh_geol_norths.shape[0],1)),
-                              dhrhgeo.reshape((dhrhgeo.shape[0],1)),
-                              maskgeo.reshape((maskgeo.shape[0],1))),axis=1)
-        self.geoDHDATA=pd.DataFrame(data=dhGeol, columns=geolKeys)
-        
-        return self.geoDHDATA
-    
-           
-    def dhSample (self,path_to_agso_codefile=None, dh_sampmask=None):
-        """
-        Method to build Sample log. This method focuses on the sample obtained 
-        during the DH trip.it may georeferenced as the well_filename needed. 
-        A main thing is to set the AGSO_STCODES file. AGSO_STCODES is the 
-        conventional code of structurals sample. If you have an own AGSO_STCODES ,
-        you may provide the path * kwargs=path_to_ags_codefile * . 
-        the program will read and generate logs according to the  DESCRIPTION 
-        and STCODES figured. if None, the program will take it STCODES  and set
-        the samplelogs. When you set the Sample code aor sample name , 
-        make sur that the name match the same name on STCODES. If not ,
-        program will raises an error. 
-
-        Parameters
-        ----------
-        * path_to_agso_codefile : str, optional
-                            path to conventional
-                            AGSO_STRUCTURAL CODES.
-                            The *default* is None.
-                            
-        * dh_sampmask : np.ndarray, optional
-                        Structural mask. The default is None.
-
+        datum: string, default ='WGS84'
+            well known datum ex. WGS84, NAD27, etc.
+            
+        reference_ellipsoid: Optional, int 
+            reference ellipsoids is derived from Peter H. Dana's website-
+            http://www.utexas.edu/depts/grg/gcraft/notes/datum/elist.html
+            Department of Geography, University of Texas at Austin
+            Internet: pdana@mail.utexas.edu . Default is ``23`` constrained to 
+            WGS84.
+            
         Returns
         -------
-        pd.DataFrame 
-            Sample DH log.
+        proj_point: tuple(lat, lon)
+            projected point in lat and lon in Datum, as decimal degrees.
+                        
         """
+        if east is not None: 
+            self.east = east 
+        if north is not None: 
+            self.north = north 
+        
+        if (self.east or self.north) is None : 
+            raise SiteError(" Easting and northing must not be None")
+            
+        if utm_zone is not None : 
+            self._utm_zone =utm_zone 
+            
+        self.datum = datum or self.datum 
+        self.reference_ellipsoid = reference_ellipsoid or \
+            self.reference_ellipsoid
+                          
+        try : 
+            self.lat , self.lon = project_point_utm2ll(
+                easting = self.east,
+                northing= self.north, 
+                utm_zone = self.utm_zone, 
+                datum= self.datum, 
+                epsg= self.epsg 
+                ) 
+
+        except : 
+             self.lat, self.lon  = utm_to_ll(
+                reference_ellipsoid=self.reference_ellipsoid, 
+                northing = self.north , 
+                easting= self.east, 
+                zone= self.utm_zone 
+                                  ) 
+            
+        return self.lat, self.lon 
+        
+    @staticmethod 
+    def to_utm_in(
+        lats:ArrayLike, 
+        lons:ArrayLike, 
+        *, 
+        data=None, 
+        utm_zone:str =None, 
+        datum: str=None, 
+        **kws 
+        ):
+        """ Convert array of longitude and latitude to array of X, y UTM 
+        coordinates. 
         
-        sampKeys=["DH_Hole","DH_From",	"DH_To","Rock",	"Sample",
-                  "East",	"DH_North",	"DH_RH",	"Mask"]
-        
-        wsamp=self.daTA[3]
-        # print(wgeo)
-        if wsamp is None :
-            self.sampleDHDATA = None 
-            return  # mean no geochemistry sample is provided 
-        
-        self.wdico.__setitem__('DH_From', wsamp[:,1])
-        self.wdico.__setitem__('DH_To', wsamp[:,2])
-        self.wdico.__setitem__("Sample",wsamp[:,3])
-        dhsampseudorock=np.zeros((wsamp.shape[0]))
-        
-        ###### FIND AGSO MODULE (AGSO_STCODES) #######
-        #Try to check the name of sample and their acronym
-        
-        if path_to_agso_codefile is None:
-            path_to_agso_codefile=os.path.join(os.path.abspath('.'),
-                                             'watex/etc/_geocodes' )
-            sampelm= get_agso_properties(
-                config_file = os.path.join(path_to_agso_codefile,
-                                           'AGSO_STCODES.csv') )
-            # #extrcat elem with their acronym 
-        sampelmDico_AGSO={key:value for key , value in \
-                         zip (sampelm["CODE"],sampelm['__DESCRIPTION'])}
-        # elemgeo_AGSO=sorted(geolemDico.items())
-
-        for ii, elm in enumerate (self.wdico['Sample']):
-            if elm.lower() in sampelmDico_AGSO.keys():
-                pass 
-            elif elm.lower() not in sampelmDico_AGSO.keys():
-                if elm in sampelmDico_AGSO.values():
-                    for key, values in sampelmDico_AGSO.items():
-                        if elm  == values :
-                            self.wdico['Sample'][ii]=key
-                else  :
-                    mess=''.join([
-                        'The Sample Name({0}) given in is wrong'.format(elm),
-                        'Please provide a right name the right Name.', 
-                        'Please consult the AGSO_STCODES.csv file located in ', 
-                        '<watex/etc/_geocodes> dir. Please keep the'
-                        '  header safe and untouchable.'])
-                    self._logging.warn(mess)
-                    warn(mess)
-
-        ######END AGS0_STCODES ########
-        
-        dh_sampeast=np.zeros((wsamp.shape[0]))
-        dh_sampnorths=np.zeros((wsamp.shape[0]))
-        
-        for ss , value in enumerate(dh_sampeast):
-            for indix, val in enumerate(self.wdico["DH_East"]):
-                if wsamp[:,0][ss] in self.wdico["DH_Hole"]:
-                    value=val
-                    dh_sampeast[ss] =value
-                    dh_sampnorths[ss]=self.wdico["DH_North"][indix]
-                    
-        dhsampseudorock=np.zeros((wsamp.shape[0]))
-
-        if dh_sampmask == None :
-            dh_sampmask =self.mask[0]
-        masksamp= np.full((wsamp.shape[0]),dh_sampmask,dtype='<U12')
-        dhrhsamp=np.array([ -1* np.float(ii) for ii in self.wdico['DH_From']])
-        dhSample=np.concatenate((wsamp[:,0].reshape(wsamp[:,0].shape[0],1),
-                              self.wdico['DH_From'].reshape(
-                                  (self.wdico['DH_From'].shape[0],1)),
-                              self.wdico['DH_To'].reshape(
-                                  (self.wdico['DH_To'].shape[0],1)),
-                              dhsampseudorock.reshape(
-                                  (dhsampseudorock.shape[0],1)),
-                              self.wdico['Sample'].reshape(
-                                  (self.wdico['Sample'].shape[0],1)),
-                              dh_sampeast.reshape(
-                                  (dh_sampeast.shape[0],1)),
-                              dh_sampnorths.reshape(
-                                  (dh_sampnorths.shape[0],1)),
-                              dhrhsamp.reshape((dhrhsamp.shape[0],1)),
-                              masksamp.reshape((masksamp.shape[0],1))),axis=1)
-        self.sampleDHDATA=pd.DataFrame(data=dhSample, columns=sampKeys)
-        
-        return self.sampleDHDATA
-    
-    def dhSurveyElevAz(self, add_elevation=None, add_azimuth=None, **kwargs):
-        """
-        Method to build Elevation & Azimuth DH logs. if add_elevation and . 
-        add_azimuth are set . The programm will ignore the computated azimuth,
-        and it will replace to the new azimuth   provided . all elevation will 
-        be ignore and set by the new elevation . *kwargs arguments 
-        {add_elevation , add-azimuth }  must match the same size like the 
-        number of Drillholes . Each one must be on ndarray(num_of_holes, 1). 
+        Parameters 
+        ------------
+        lats: arraylike 1d, 
+           Array composed of latitude values 
+        lons: ArrayLike 1d, 
+           Array composed of longitude values. 
+           
+        data: pd.dataFrame
+           Accepts dataframe containing the latitude and longitude coordinates
+           by specifying the columns through 'lats' and 'lons' columns. 
+           
+           .. versionadded:: 0.2.5
+           
+        utm_zone: Optional, string
+           zone number and 'S' or 'N' e.g. '55S'. Defaults to the centre point
+           of the provided points, 
+        datum: string
+            well known datum ex. WGS84, NAD27, NAD83, etc.
+            
+        kws: dict, 
+           Keywords argument passed to :meth:`~watex.site.Location.to_utm`. 
+           
+        Returns
+        --------
+        (easts, norths): Iterable object composed of easting and northing 
+           coordinates. 
+           
+        .. versionadded:: 0.1.8 
         
-        Parameters
+        See Also
         ----------
-            * add_elevation : np.nadarray , optional
-                    elevation data (num_of_holes, 1) 
-                    The *default* is None.
-                    
-            * add_azimuth : np.ndarray , optional
-                    azimuth data (num_of_holes,1). 
-                    The *default* is None.
-                    
-            * DH_RL :np.float or np.ndarray(num_of_hole,1),
-                    if not provided , it's set to 0. means No topography is added'.
-                
-        Returns
-        -------
-            pd.Dataframe 
-                Elevation DH log .
-            pd.DataFrame 
-                Azimuth DH log.
-        """
-        dh_rl=kwargs.pop("DH_RL",None)
-        
-        # sizep=self.wdico['DH_East'].shape[0]
-        if self._f == 0 :
-            if add_elevation is None :
-                #No topography is added , set to 0 
-                add_elevation=np.full((len(self.wdico['DH_East']),1),0,
-                                      dtype='<U12')
-            elif add_elevation is not None :
-                if type(add_elevation ) is list :
-                    add_elevation =np.array(add_elevation)
-                assert add_elevation.shape[0]==self.wdico[
-                    'DH_East'].shape[0],"INDEXERROR:"\
-                    " The the current dimention of Elevation data is {0}.It's must be"\
-                        " the size {1}.".format(
-                            add_elevation.shape[0],self.wdico['DH_East'].shape[0])
+        watex.site.Location.to_utm: 
+            Convert longitude and latitude value to easting and northing 
+            coordinates. 
             
-            self.wdico.__setitem__("Elevation", add_elevation)
-                    
-        elif self._f == 1 :
+        """
+        if ( 
+                (isinstance (lats, str ) 
+                or isinstance ( lons, str) )
+                and data is None): 
+            raise TypeError ("Data can't be None when latitude or longitude"
+                             " has a string argumemt.")
+        if data is not None: 
+            lats, lons = assert_xy_in(lats, lons , data = data )      
+        
+        emsg = ("longitude is " if lons is None else 'latitude is') if (
+            lats is None or lons is None) else "Both longitude and latitude are"
+        
+        if lats is None or lons is None: 
+            raise TypeError (emsg + "missing.") 
+        # For consistency, check iterable values 
+        
+        lats = is_iterable(lats, exclude_string= True, transform =True ) 
+        lons = is_iterable(lons, exclude_string= True, transform= True )
+        
+        _check_consistency_size(lats, lons)
+        lats = np.array(lats ) ; lons = np.array (lons )
+        easts = np.zeros_like (lats , dtype = np.float64)
+        norths = np.zeros_like (lons , dtype = np.float64)
+        
+        for ii, (lat, lon) in enumerate (zip (lats, lons )) : 
+            Loc = Location()
+            x, y  = Loc.to_utm (lat, lon , utm_zone= utm_zone , **kws )
+            easts[ii] = x ; norths [ii] =y 
+    
+        return  easts, norths 
+    
+            
+    @staticmethod 
+    def to_latlon_in(
+        easts:ArrayLike, 
+        norths:ArrayLike, 
+        *, 
+        data=None,
+        utm_zone:str, 
+        datum: str=None, 
+        **kws 
+        ):
+        """ 
+        Convert array of longitude and latitude to array of X, y UTM 
+        coordinates. 
+        
+        Parameters 
+        ------------
+        lats: arraylike 1d, 
+           Array composed of latitude values 
+        lons: ArrayLike 1d, 
+           Array composed of longitude values. 
+ 
+        utm_zone: Optional, string
+           zone number and 'S' or 'N' e.g. '55S'. Defaults to the centre point
+           of the provided points, 
+           
+        data: pd.dataFrame
+           Accepts dataframe containing the easting and northing coordinates
+           by specifying the columns through 'easts' and 'lats' columns. 
+           
+           .. versionadded:: 0.2.5
+           
+        datum: string
+           well known datum ex. WGS84, NAD27, NAD83, etc.
             
-            if add_elevation is not None:
-                
-                if type(add_elevation ) is list :
-                    add_elevation =np.array(add_elevation)
-                try :
-                    np.concat((add_elevation,self.wdico['DH_East']))
-                except :
-                    mess= ''.join([
-                        'SIZEERROR! Try to set the elevation dimentional. ', 
-                        'same like the collar data '])
-                    self._logging.error(mess)
-                    warn(mess)
-            elif add_elevation is None :
-                add_elevation=self.daTA [1][:,4]
-        
-            self.wdico.__setitem__("Elevation", add_elevation)
-            
-        #set DH_RL
-        if dh_rl is not None : 
-            if type (dh_rl) is list : 
-                dh_rl=np.array (dh_rl)
-            assert dh_rl.shape[0]==self.data.shape[0]," DH_RL data size is out"\
-                " of the range.Must be {0}".format(self.data.shape[0])
-                
-            self.wdico.__setitem__("DH_RL",dh_rl)
+        kws: dict, 
+           Keywords argument passed to :meth:`~watex.site.Location.to_latlon`. 
+           
+        Returns 
+        -------
+        (lats, lons): Iterable object composed of latitude and longitude 
+           coordinates. 
+          
+        .. versionadded:: 0.1.8 
+        
+        See Also
+        ------------
+        watex.site.Location.to_latlon: 
+           Convert easting and northing value to latitude and  longitude 
+           coordinates. 
             
-        elif dh_rl is None :
-            #if None set DH_RL to None :
-            self.wdico.__setitem__("DH_RL",np.full(
-                (self.daTA[1].shape[0]),0,dtype='<U12'))
-        
-        #set azimuth 
-        if add_azimuth  is not None : 
-            if type(add_azimuth) ==list : 
-                add_azimuth=np.array(add_azimuth)
-            assert add_azimuth.shape[0]==self.data.shape[0]," Azimuth data size is out"\
-                " of the range.Must be {0}".format(self.data.shape[0])
-                
-            self.wdico.__setitem__("DH_Azimuth",add_azimuth) 
+        """
+        if (  ( isinstance (easts, str ) 
+            or isinstance ( norths, str) )
+            and data is None): 
+            raise TypeError ("Data can't be None when easting or northing"
+                             " has a string argumemt.")
+        if data is not None: 
+            easts , norths = assert_xy_in(easts, norths, data = data )
+            
+        emsg = ("easting is" if easts is None else 'northing is') if (
+            easts is None or norths is None) else (
+                "Both easting and northing are")
+        
+        if easts is None or norths is None: 
+            raise TypeError (emsg + " missing.") 
+            
+        # For consistency, check iterable values 
+        easts = is_iterable(easts, exclude_string= True,  transform =True ) 
+        norths = is_iterable(norths, transform= True , exclude_string =True 
+                             )
+        
+        _check_consistency_size(easts, norths)
+        easts = np.array(easts ) ; norths = np.array (norths )
+        lats_lons =[]
+        for east, north in zip (easts, norths ) : 
+           Loc = Location()
+           lats_lons.append (
+               Loc.to_latlon(east, north , utm_zone= utm_zone , **kws )
+               )
+           
+        return tuple (zip ( *lats_lons))  
+                   
+Location.__doc__="""\
+Location class
+
+Assert, convert coordinates lat/lon , east/north  
+to appropriate formats. 
+
+Location does not follow the `scikit-learn` API in order to encompass the 
+the syntax of :term:`pycsamt` and :term:`mtpy`. The latter follows the 
+Generci Mapping Tool (`GMT <ttps://www.generic-mapping-tools.org>`__)  API 
+format.   
+  
+Parameters  
+--------------
+lat: float or string (DD:MM:SS.ms)
+    latitude of point
+          
+lon: float or string (DD:MM:SS.ms)
+    longitude of point
+    
+east: float
+    easting coordinate in meters
             
-        elif add_azimuth is None : 
-            pass 
-                
-        elevazKeys=['DH_Hole', 'Depth','DH_East',
-                    'DH_North','Elevation','DH_RL','DH_Dip']
+north: float
+    northing coordinate in meters
+     
+datum: string
+    well known datum ex. WGS84, NAD27, NAD83, etc.
+
+utm_zone: Optional, string
+    zone number and 'S' or 'N' e.g. '55S'. Defaults to the centre point
+    of the provided points
+               
+epsg: Optional, int
+    epsg number defining projection (see http://spatialreference.org/ref/ for moreinfo)
+    Overrides utm_zone if both are provided
+
+reference_ellipsoid: Optional, int 
+    reference ellipsoids is derived from Peter H. Dana's website-
+    http://www.utexas.edu/depts/grg/gcraft/notes/datum/elist.html
+    Department of Geography, University of Texas at Austin
+    Internet: pdana@mail.utexas.edu . Default is ``23`` constrained to 
+    WGS84. 
+"""     
         
-        self.wdico.__setitem__("DH_RL",np.full(
-            (self.daTA[1].shape[0]),0,dtype='<U12'))
-        # add Hole and Depth 
-        
-        surveyELEV =np.concatenate((self.wdico['DH_Hole'].reshape(
-            (self.wdico['DH_Hole'].shape[0],1)),
-                                    self.wdico["DH_Bottom"].reshape(
-             (self.wdico["DH_Bottom"].shape[0],1))),
-                                       axis=1)
-        surveyAZIM=np.concatenate((self.wdico['DH_Hole'].reshape(
-            (self.wdico['DH_Hole'].shape[0],1)),
-                                    self.wdico["DH_Bottom"].reshape(
-             (self.wdico["DH_Bottom"].shape[0],1))),
-                                      axis=1)
-        
-        for ss , elm in enumerate (elevazKeys[2:]):
-            for key, values in self.wdico.items():
-                if elm==key :
-                    values=values.reshape((values.shape[0],1))
-                    if elm =='DH_RL'or elm=='DH_Dip':
-                        # print(values)
-                        surveyAZIM=np.concatenate((surveyAZIM,values),axis=1)
-                    elif  elm=='Elevation':
-                        surveyELEV =np.concatenate((surveyELEV,values),axis=1)
-                    else:
-                        surveyAZIM=np.concatenate((surveyAZIM,values),axis=1)
-                        if ss < elevazKeys.index('Elevation')-1: 
-                            surveyELEV =np.concatenate((surveyELEV,values),axis=1)
-                            
-        
-        self.surveyDHELEV=pd.DataFrame(
-            data=surveyELEV, columns=elevazKeys[:5])
-        # pop the elevation elm on the list 
-        [elevazKeys.pop(ii) for ii, elm in 
-         enumerate(elevazKeys) if elm=='Elevation']
         
-        self.surveyDHAZIM=pd.DataFrame(data=surveyAZIM, 
-                                       columns=elevazKeys)
         
-        return (self.surveyDHELEV, self.surveyDHAZIM)
         
-                    
-    def writeDHData (self, data2write =None ,**kwargs):
-        """ 
-        Method to write allDH logs. It depends to the users to sort which data 
-        want to export and which format. the program support only two format 
-        (.xlsx and .csv) if one is set , it will ouptput the convenience format.
-        Users can give a list of  the name of log he want to export.
-        Program is dynamic and flexible. It tolerates quite symbols number to
-         extract data logs. 
         
-        Parameters
-        ----------
-        * data2write : str or list , optional
-                    the search key. The default is None.
         
-        * datafn :str
-                savepath to exported file 
-                *Default* is current work directory.
-                
-        * write_index_on_sheet : bool, 
-                choice to write the sheet with pandas.Dataframe index. 
-                
-        * writeType : str , 
-                file type . its may *.csv or *.xlsx .
-                *Default* is *.xlsx
-                
-        * add_header : bool, 
-                add head on exported sheet. set False to mask heads. 
-                *Default* is True. 
-                
-        * csv_separateType : str , 
-                Indicated for csv exported files , 
-                the type of comma delimited . defaut is ','.
-        """
-    
-        savepath =kwargs.pop("savepath",None )
-        writeIndex=kwargs.pop('write_index_on_sheet',False)
-        writeType =kwargs.pop('writeType', 'xlsx')
-        # csvencoding =kwargs.pop('encoding','utf-8')
-        csvsetHeader =kwargs.pop('add_header',True)
-        csvsep =kwargs.pop('csv_separateType',',')
-        
-        
-        wDATA ={"collar": self._collar,
-                 "geology": self.dhGeology,
-                 'sample':self.dhSample,
-                 'elevazim':self.dhSurveyElevAz}
-        
-        _all=['5',"all","__all__",'CollGeoSampElevAz','CGSAZ','cgsaz',
-              ['Collar','Geology','Sample','Elevation','Azimuth'],
-              'colgeosamelevaz','alldata','*']
-        
-        df_collar=wDATA['collar']()
-        df_geology=wDATA['geology']()
-        df_sample=wDATA['sample']()
-        df_elevation,df_azimuth=wDATA['elevazim']()
-        
-        # for df_ in  [df_collar, df_geology, df_sample,
-        # df_elevation,df_azimuth]: 
-        # df_.set_index(setIndex) # this is unnecessary 
-        _dHDico ={'collar': [['1','c'], df_collar],
-                 'geology':[['2','g'],df_geology],
-                 'sample': [['3','s'],df_sample],
-                 'survey_elevation':[['4','elev', 'topo','topography','e'],
-                                     df_elevation],
-                 'survey_azimuth': [['5','-1','azim','a'],df_azimuth]}
-        # skip the sample building  geochemistry doesnt exists
-        if self.sampleDHDATA is None :   
-            data2write =['1','2','4','5']
-          
-        if data2write is None or data2write in _all :  # write all 
-            with pd.ExcelWriter(''.join([self.daTA[0][:-1],'.xlsx'])) as writer :
-                for keys, df_ in _dHDico.items():
-                    df_[1].to_excel(writer,sheet_name=keys, index =writeIndex)
-
-                                
-        elif data2write is not None :
-            
-            if type(data2write) is not list:
-                data2write=str(data2write)
-
-                try :
-                    if writeType in ['xlsx','.xlsx', 'excell',
-                                     'Excell','excel','Excel','*.xlsx']:
-                        for keys, df in _dHDico.items():
-                            if data2write ==keys or data2write.lower(
-                                    ) in keys or  data2write in df[0]:
-                              df[1].to_excel('.'.join(
-                                  [self.daTA[0][:-1],'xlsx']),
-                                  sheet_name=keys,index =writeIndex)  
-
-                        
-                    elif writeType in ['csv','.csv', 'comma delimited','*.csv',
-                                       'comma-separated-value',
-                                       'comma seperated value',
-                                       'comsepval']:
-                        # print('passed')
-                        for keys, df_ in _dHDico.items():
-                            if data2write == keys or data2write.lower(
-                                    ) in keys or data2write in df_[0]:
-                              df_[1].to_csv(''.join(
-                                  [self.daTA[0][:-1],'.csv']),
-                                  header=csvsetHeader,
-                                    index =writeIndex,sep=csvsep)  
-
-                except Exception as error :
-                    self._logging.error (
-                        'The type you provide as WriteType argument is wrong.'
-                                ' Support only *.xlsx and *.csv format',error)
-                    warn (
-                        'Argument writeType support only [xlsx or csv] format.'
-                        ' Must change your *.{0} format'.format(writeType))
-
-                
-            elif type(data2write) is list :
-                data2write=[str(elm) for elm in data2write] # check the string format
-                with pd.ExcelWriter(''.join(
-                        [self.daTA[0][:-1],'xlsx'])) as writer :
-                    for ii, df in enumerate (data2write):
-                        for keys, df__ in _dHDico.items():
-                            if df.lower() in keys or df in df__[0] : 
-                                df__[1].to_excel(
-                                    writer,sheet_name=keys, index =writeIndex)
-            else :
-                self._logging.error (
-                    'The key you provide  as agrument of data2write is wrong. '
-                    'the data2write argument should be either [collar, geology,'
-                        ' sample, elevation, azimuth] or all (*). ')
-                warn (
-                    'Wrong format of input data2write ! Argument dataType is str,'
-                    ' or list of string element choosen among [collar, geology,'
-                        'sample, elevation, azimuth] or all (*),'
-                        ' not {0}'.format(data2write))
- 
-         # export to savepath 
-        if savepath is not None : self.savepath = savepath 
-        # create a folder in your current work directory
-        if self.savepath is None : 
-            try :
-                self.savepath  = os.path.join(os.getcwd(), '_outputDH_')
-                if not os.path.isdir(self.savepath):
-                    os.mkdir(self.savepath)#  mode =0o666)
-            except : 
-                warn("It seems the path already exists !")
-        
-        
-        if self.savepath is not None  :
-            import shutil
-            
-            if writeType in ['csv','.csv', 'comma delimited',
-                             'comma-separated-value','comma sperated value',
-                                       'comsepval']:
-                shutil.move ( os.path.join(os.getcwd(),
-                                           ''.join(
-                                               [self.daTA[0][:-1],'csv'])),
-                             self.savepath)
-                print('---> Borehole output <{0}> has been written to {1}.'.\
-                      format(os.path.basename(
-                    ''.join([self.daTA[0][:-1],'.csv'])), self.savepath))
-                
-            elif writeType in ['xlsx','.xlsx', 'excell','Excell','excel','Excel']:
-                try :
-                    shutil.move (os.path.join(os.getcwd(),
-                                               '.'.join([self.daTA[0][:-1],'xlsx'])),
-                                 self.savepath)
-                except: 
-                    print("--> It seems the destination path "
-                          f"{self.savepath} already exists")
-                
-                print('---> Borehole output <{0}> has been written to {1}.'.\
-                      format(os.path.basename(
-                      '.'.join([self.daTA[0][:-1],'xlsx'])), self.savepath))
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+        
+
```

#### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

### Comparing `watex-0.2.4/watex/geology/geology.py` & `watex-0.2.5/watex/geology/geology.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/geology/stratigraphic.py` & `watex-0.2.5/watex/geology/stratigraphic.py`

 * *Files 25% similar despite different names*

```diff
@@ -2,59 +2,69 @@
 #   License: BSD-3-Clause
 #   Author: LKouadio <etanoyau@gmail.com>
 #   Created on Thu Sep 22 12:21:11 2022
 
 """
 Stratigraphic 
 ==============
-Construct layers model from given layers properties such as density , porosity 
+Construct layers model from given layers properties such as density, porosity 
 permeability, transmissivity, resistivity , patches and so on ... 
 Build Statigraphic model from Inversion models blocks. This should be used to 
 predict the log under each station as well as the thicknesses from the collected 
 true boreholes and well resistivity data in the survey area. 
 
 """
 import os
 import warnings
 import copy
 from importlib import resources
 import numpy as np
 
-from .._typing import NDArray 
+from .._typing import ( 
+    NDArray, List 
+    )
 from .._watexlog import watexlog 
 from ..decorators import (
     gplot2d
     )
-from ..exceptions import NotFittedError
+from ..exceptions import ( 
+    NotFittedError, 
+    ModelError, 
+    DepthError,
+    )
 from .core import (
     GeoBase 
     )
 from .database import ( 
     GeoDataBase,
     )
 from ..utils.funcutils import ( 
     serialize_data, 
     load_serialized_data,
     smart_format, 
     concat_array_from_list,
     parse_json, 
     parse_yaml,
+    is_iterable, 
+    convert_value_in, 
+    ellipsis2false
     )
 from ..utils.geotools import (
     _sanitize_db_items,
     _assert_model_type,
     assert_len_lns_tres, 
     assert_station, 
     fit_rocks, 
     fit_stratum_property, 
     get_s_thicknesses, 
     print_running_line_prop, 
-    pseudostratigraphic_log,
+    plot_stratalog,
     get_closest_gap,
-    lns_and_tres_split, 
+    lns_and_tres_split,
+    find_similar_structures
     
     )
 from ..utils._dependency import ( 
     import_optional_dependency
     )
 
 TQDM= False 
@@ -65,219 +75,435 @@
 else: 
     import tqdm 
     TQDM = True 
 _logger = watexlog().get_watex_logger(__name__ )
 
 __all__=["GeoStrataModel"]
 
-#XXXTODO: add MODEM construction block  in progress 
+
 class GeoStrataModel(GeoBase):
+    """
+    Create a stratigraphic model from 2D inversion models blocks. 
 
+    The Inversion model block is two dimensional array of shape 
+    (n_vertical_nodes, n_horizontal_nodes ). Can use external packages to
+     build blocks and provide the 2Dblock into `crm` parameter. 
+
+    The challenge of this class  is firstly to delineate with much accuracy 
+    the existing layer boundary (top and bottom) and secondly,to predict the 
+    stratigraphy log before the drilling operations at each station. Moreover, 
+    it's a better way to select the right drilling locationand also to estimate 
+    the thickness of existing layer such as water table layer as well as to 
+    figure out the water reservoir rock in the case of groundwater 
+    exploration [1]_. 
+
+    Note that if the model blocks is build from external softwares. User can
+    provided model usefull details into the keyword arguments of the `fit` 
+    methods. For instance the `model_station_locations`, `model_depth`, 
+    `model_x_nodes` etc. See more details in `fit` method docstring. 
+
+    Parameters 
+    ----------
+    area:str, optional 
+      The name of the area where the survey is done. 
+
+    beta:  int,  default=5              
+            Value to  divide into the CRM blocks to improve 
+            the computation times.                       
+    n_epochs:  int,  default=100
+       Number of iterations for new resistivity model construction (NM). 
+            
+    ptol: float, default=.1   
+       the error value to tolerate during NM construction between the `tres` 
+       values given and the calculated resistivity in `crm`. Higher is the 
+       error, less is the accuracy. 
+     
+    eta: float, default=1e4 
+       It is the learning rate for gradient descent computing to reach its 
+       convergence. If `kind` is  set to `polynomial` the default value should 
+       be  set`1e-8`.  
+          
+    kind: str , default='linear'        
+       Kind of model function to compute the best fit model to replace the
+       value in `crm` . Can be 'linear' or 'polynomial'. if `polynomial` is 
+       set, specify the `degree`.
+        
+    degree: int, default=1
+         Polynomial function degree to implement gradient descent algorithm. 
+         If `kind` is set to `Polynomial` the default `degree` is ``3.`` 
+         
+    z0: float, default=0. 
+       The elevation at the first stations. Note here, we consider that no
+       topography is included and the default is the level of the sea. If 
+       the `model_depth`if provided in the `fit_params`, no need to specify. 
+       
+    max_depth: float, default=700 
+      The maximum depth for building the block. by default, the unit is in 
+      meters. If `model_depth` is given, no need to provide. 
+      
+    step: float, default=50 
+       The step between stations. Here the unit is in meters. If the 
+       `model_station_locations` if given through the `fit_params`, no need to 
+       specified. 
+       
+    doi: default='1km' 
+       the depth of investigation of the skin-depth. By default without any 
+       unit suffix, it should be in meters. 
+       
+    tolog10: bool, default=False 
+       Convert the true values of layer resistivities to log10. 
+
+    verbose: bool, default=False  
+      Output messages and warn users. 
+
+    Attributes
+    -----------
+    nm_: Ndarray of ( n_depth , n_stations )     
+        The New resistivity model (NM) matrix with the same dimension 
+        with `crm` model blocks.
+    nmSites_: ArrayLike 
+       The recomputed station locations of the new resistivity model (NM)
+    crmSites_: ArrayLike, 
+       The recomputed stations locations of the model-calculated resistivity 
+       (CRM)
+       
+    Examples
+    ----------
+    >>> import numpy as np 
+    >>> from watex.geology.stratigraphic import GeoStrataModel
+    >>> 
+    >>> # (1):  Using the CRM without any inversion specified files. 
+    >>> 
+    >>> # test while files 
+    >>> np.random.seed (42)
+    >>> # generate a model calculated resistivity, layers and true 
+    >>> # resistivities values
+    >>> crm = np.abs( np.random.randn (215 , 70 ) *1000 )
+    >>> tres = np.linspace (crm.min() +1  , crm.max() +1 , 12 ) # 
+    >>> layers = ['granites', 'gneiss', 'sedim.']
+    >>> gs= GeoStrataModel (tres = tres, layers =layers, to_log10 =True )
+    >>> gs.fit(crm).buildNM(display_infos =True )
+    >>> print( gs.nm.shape) 
+    >>> gs.strataModel () # plot strata model, by default kind ='NM'
+    >>> gs.plotStrata ('s7')  # plot strata log at station S7 
+    >>> 
+    >>> # (2): Works with occam2d inversion files if 'pycsamt' or 'mtpy' 
+    >>> # is installed. It will call the module Geodrill from pycsamt to 
+    >>> make occam2d 2D resistivity block for our demo.
+    >>> # It presumes pycsamt is installed. 
+    >>> 
+    >>> from pycsamt.geodrill.geocore import Geodrill 
+    >>> path=r'data/inversfiles/inver_res/K4' # path to inversion files 
+    >>> inversion_files = {'model_fn':'Occam2DModel', 
+    ...                   'mesh_fn': 'Occam2DMesh',
+    ...                    "iter_fn":'ITER27.iter',
+    ...                   'data_fn':'OccamDataFile.dat'
+    ...                    }
+    >>> tres =[10, 66, 70, 180, 1000, 2000, 3000, 7000, 15000 ] 
+    >>> layers =['river water', 'fracture zone', 'granite']
+    >>> inversion_files = {key:os.path.join(path, vv) for key,
+                    vv in inversion_files.items()}
+    >>> gdrill= Geodrill (**inversion_files, 
+                         input_resistivities=input_resistivity_values
+                         )
+    >>> # we can collect the 'model_res' and occam2d inversion usefull 
+    >>> # 'attributes' from  `gdrill object` and passed to the 
+    >>> # 'GeoStrataModel' then fit_params keyword arguments method as 
+    >>> geosObj = GeoStrataModel(ptol =0.1).fit(
+                         crm = gdrill.model_res ,
+                         tres=gdrill.input_resistivities, 
+                         layers=gdrill.input_layer_names, 
+                         model_x_nodes=gdrill.model_x_nodes, 
+                         model_stations= gdrill.station_names,
+                         model_depth= gdrill.geo_depth, 
+                         model_station_locations= gdrill.station_locations,
+                         data_fn = gdrill.data_fn , 
+                         mesh_fn=gdrill.mesh_fn, 
+                         iter_fn= gdrill.iter_fn
+                         model_fn= gdrill.model_fn)
+    >>> geosObj.buildNM () 
+    >>> zmodel = geosObj._zmodel
+    >>> geosobj.nm_ # New constructed resistivity 2D model block
+
+    Notes
+    ------
+    Modules work properly with occam2d inversion files if 'pycsamt' or 'mtpy' 
+    is installed and  inherits the `GeoBase` class which works with geological
+    structures and properties. Furhermore, Occam2d inversion files are also 
+    acceptables for building model blocks. However the MODEM resistivity 
+    files development is still ongoing.
+    
+    References 
+    -----------
+    .. [1] Kouadio, L. K., Liu, R., Malory, A. O., Liu, W., Liu, C., A novel 
+           approach for water reservoir mapping using controlled source 
+           audio - frequency magnetotelluric in Xingning area , Hunan 
+           Province, China. Geophys. Prospect., 
+           https://doi.org/10.1111/1365-2478.1338
+    """
     def __init__(
         self, 
-        beta=5, 
-        ptol=0.1 , 
-        n_epochs=100, 
-        tres=None,
-        eta=1e-4, 
-        kind='linear', 
-        degree=1, 
-        build=False, 
+        area:str=None, 
+        beta: int=5,  
+        n_epochs: int=100, 
+        ptol: float=0.1 , 
+        eta: float=1e-4, 
+        kind: str='linear', 
+        degree: int=1,
+        z0: float=0., 
+        max_depth: float=700., 
+        step: float=50., 
+        doi: str='1km',
+        tolog10: bool=False,
+        verbose: bool=False,
         **kwargs
         ):
-        super().__init__( **kwargs)
+        super().__init__( verbose= verbose, **kwargs)
 
-        self._beta =beta 
-        self._ptol =ptol 
-        self._n_epochs = n_epochs
-        self._tres = tres
-        self._eta = eta
-        self._kind =kind
-        self._degree = degree
-        self._b = build
-        
+        self.area=area
+        self.z0=z0
+        self.step=step
+        self.max_depth=max_depth 
+        self.beta=beta 
+        self.ptol=ptol 
+        self.n_epochs=n_epochs
+        self.eta=eta
+        self.kind=kind
+        self.degree=degree
+        self.tolog10=tolog10
+        self.doi=convert_value_in(doi)
+
+        self._tres=None 
         self.s0 =None 
         self._zmodel =None
-        self.nm= None 
-        self.z =None
-        self.nmSites=None
-        self.crmSites=None 
+        self.nm_= None 
+        self._z =None
+        self.nmSites_=None
+        self.crmSites_=None 
 
-        for key in list(kwargs.keys()): 
-            setattr(self, key, kwargs[key])
-            
-    def fit(self, crm: NDArray =None, beta =5 , ptol= 0.1, **kws): 
+    def fit(self, crm: NDArray, tres: List[float]=None,
+            layers: List[str]=None, **fit_params): 
         """ 
-        Fit, populate attributes and construct the new stratigraphic 
-        model (NM)
+        Check, populate attributes and rebuild the model-calculated 
+        resistivity (CRM). 
         
         Parameters 
         ------------
         crm : ndarray of shape(n_vertical_nodes, n_horizontal_nodes ),  
-            Array-like of inversion two dimensional model blocks. Note that 
-            the `n_vertical_nodes` is the node from the surface to the depth 
-            while `n_horizontal_nodes` must include the station location 
-            (sites/stations) 
-            
-        beta:  int,                
-                Value to  divide into the CRM blocks to improve 
-                the computation times. default is`5`                               
-        n_epochs:  int,  
-                Number of iterations. default is `100`
-        ptols: float,   
-                Existing tolerance error between the `tres` values given and 
-                the calculated resistivity in `crm` 
+           Array-like of inversion two dimensional model blocks. Note that 
+           the `n_vertical_nodes` is the node from the surface to the depth 
+           while `n_horizontal_nodes` must include the station location 
+           (sites/stations) 
+           
+        tres: List, Arraylike of float, 
+           Layer true values of resistivity collected in the survey area.
+           refer to [1]_ for more details. Resistivity is preferable to  
+           be distinct. 
+
+        layers: list or ArrayLike of str 
+           The name of layers collected in the survey area. Their corresponding
+           resistivity values are the argument of `tres`. Mostly, it refers to 
+           the geological informations of collected in the area. 
+                
+        fit_params: dict, 
+           If a keyword argument refering to inversion model details, it 
+           should be prefixed by the keyword `model_` such as the the
+           following attributes: 
+               
+           - `model_depth`: Arraylike shape (n_depth, ) of the model. It is  
+             the depth the surface to the bottom of each layer that 
+             composed the pseudo-boreholes. It refer to the n_vertical nodes. 
+           - `model_resistivities`: ArrayLike of shape ( y_nodes , x_nodes ). 
+             It is array of model block composed of resistivity values of  
+             vertical nodes and horizontal nodes. It is the model-calculated 
+             resistivity. No need if the value is passed to `crm` parameter. 
+           - `model_x_nodes`: ArrayLike of shape (x_nodes, ) is  the  
+             horizontal nodes of the model block. 
+           - `model_station_locations`: Arraylike of offset of valid stations 
+             locations. It might truly refers to the number of investigated 
+             stations. 
+           - `model_stations`: List or Arrylike of the stations names of 
+             the investigated area. It might be consistent with the 
+             `model_station_locations`. 
+           - `model_rms`: Root-Mean-Squared values of the models after 
+             inversion. By default , the target is set to ``1.0``. 
+           - `model_roughness`: Roughness of the models. This is an optional 
+             parameters and using when OCCAM2D software is used to invert the 
+             data. 
+             
+           Model files can also be includes. In that case, the attributes must 
+           suffixes with `_fn`. Some useful model files can be `model`, `mesh`
+           `data` and `iter`. For instance to set the data file to a keyword 
+           arguments it sould be ``data_fn=xxxx`` whether the new data attribute 
+           should be retrived as `data_fn`. Note that: 
+               
+           - `model_fn` is the model files after inversions 
+           - `data_fn` is the data files before inversions 
+           - `iter_fn` is the iteration results files if applicable with 
+              the kind of inversion software used 
+           - `mesh_fn` is the mesh files construct for forward modeling. 
+
         Return 
         --------
         ``self``: :class:`watex.geology.stratigraphic.GeoStrataModel`. 
             return `self` for methods chaining. 
         
+        References 
+        -----------
+        .. [1] Kouadio, L. K., Liu, R., Malory, A. O., Liu, W., Liu, C., A novel 
+               approach for water reservoir mapping using controlled source 
+               audio - frequency magnetotelluric in Xingning area , Hunan 
+               Province, China. Geophys. Prospect., 
+               https://doi.org/10.1111/1365-2478.1338
         """
-        for key in list(kws.keys()): 
-            setattr(self, key, kws[key])
-            
-        if crm is not None: 
-            self.crm=crm 
-        # expect the bock is build from 
-        # external modeling softwares 
-        if hasattr (self, "input_resistivities"):  
-            if self.input_resistivities: 
-                self.tres = self.input_resistivities
-        if hasattr (self, 'model_res'): 
-            if self.model_res is not None : 
-                self.crm = self.model_res 
-                self.s0= np.zeros_like(self.model_res)
+        self.crm = crm 
+        self.layers=layers 
+        self.tres = tres 
+        
+        if self.layers is None or self.tres is None: 
+            msgn= "Layers are missing. " if self.layers is None else (
+                "The layers true resistivities (TRES) are missing. " if 
+                self.tres is None else '')
+            raise ModelError (f"{msgn}Layers and their corresponding"
+                              " resistivities(TRES) are expected for building"
+                              " the new discrete resistivity model(NM)."
+                              )
+        self.layers = is_iterable(
+            self.layers , exclude_string= True, transform =True )
+        self.tres = is_iterable(self.tres, exclude_string= True, transform =True 
+                                )
+        
+        self.set_inversion_model_attr(**fit_params)
+    
+        self.s0= np.zeros_like(self.crm )
             
         if self.crm is not None: 
             self._makeBlock()
-            
-        self.build 
-        
+
         return self
     
-    @property 
-    def inspect (self): 
-        """ Inspect object whether is fitted or not"""
-        msg = ( "{obj.__class__.__name__} instance is not fitted yet."
-               " Call 'fit' with appropriate arguments before using"
-               " this method"
-               )
+    def buildNM (self, return_NM: bool= ..., display_infos: bool=... ):
+        """ Build New discrete resistivity from the model-calculated 
+        resistivity CRM 
+        Trigger the NM build and return the NM building option
         
-        if not hasattr (self, 'crm'): 
-            raise NotFittedError(msg.format(
-                obj=self)
-            )
-        return 1 
-    
-    @property 
-    def n_epochs(self): 
-        """ Iteration numbers"""
-        return self._n_epochs 
-    @n_epochs.setter 
-    def n_epochs(self, n_iterations): 
-        """ n_epochs must be in integers value and greater than 0"""
-        try : 
-            self._n_epochs = int(n_iterations)
-        except: 
-             TypeError('Iteration number must be `integer`') 
-        else: 
-            if self._n_epochs  <=0: 
-                self._logging.debug(
-                 " Unaceptable iteration value! Must be a positive value not "
-                f"{'a negative value.' if self._n_epochs <0 else 'equal to 0.'}")
-                warnings.warn(f" {self._n_epochs} is unaceptable value."
-                          " Could be resset to the default value=100.")
-                self._n_epochs = 100 
-                
-    @property 
-    def beta (self): 
-        """ Block constructor param"""
-        return self._beta 
-    @beta.setter 
-    def beta(self, beta0 ):
-        """ Block constructor must be integer value."""
-        try : 
-            self._beta = int(beta0)
-        except Exception: 
-            raise TypeError
-        else: 
-            if self._beta <=0 :
-                self._logging.debug(
-                    f'{self._beta} is unaceptable. Could resset to 5.')
-                warnings.warn(
-                    f'`{self._beta}` is unaceptable. Could resset to 5.')
-                self._beta= 5
-    @property 
-    def ptol(self) :
-        """ Tolerance parameter """
-        return self._ptol 
-    @ptol.setter 
-    def ptol(self, ptol0): 
-        """ Tolerance parameter must be different to zero and includes 
-        between 0 and 1"""
-        try : 
-            self._ptol =float(ptol0)
-        except Exception :
-            raise TypeError ('Tolerance parameter `ptol` should be '
-                             f'a float number not {type (ptol0)!r}.')
-        else : 
-            if 0 >= self._ptol >1: 
-                self._logging.debug(f"Tolerance value `{self._ptol}` is "
-                  "{'greater' if self._ptol >1 else 'is unacceptable value'}`."
-                    "Could resset to 10%")
-                warnings.warn(
-                    f'Tolerance value `{self._ptol}` is unacceptable value.'
-                    'Could resset to 10%')
-                self._ptol = 0.1
-    @property 
-    def tres(self): 
-        """ Input true resistivity"""
-        return self._tres 
-    @tres.setter 
-    def tres(self, ttres):
-        """ Convert Tres to log 10 resistivity """
-        try : 
-            self._tres =[np.log10(t) for t in ttres]
-        except : 
-            raise ValueError('Unable to convert TRES values') 
+        """
+        return_NM, display_infos = ellipsis2false(return_NM, display_infos)
         
-    @property 
-    def build (self): 
-        """ Trigger the NM build and return the NM building option """
+        self.inspect 
         
-        ntres ='True resistivity values'
-        nln ='collected layer names (True)'
-        mes =''.join([
-            '{0} {1} not defined. Unable to triggered the NM construction. '
-            'Please, provide the list/array of {2} of survey area.'])
-         
-        if self._b:
-            if (self.tres and self.input_layers ) is None: 
-                warnings.warn(mes.format(
-                    'TRES and LN', 'are', ntres +'and'+nln))
-                self._b=False 
-            elif self.tres is None and self.input_layers is not None: 
-                warnings.warn(mes.format('TRES', 'is', ntres))
-                self._b=False 
-            elif self.input_layers is None and self.tres is not None: 
-                warnings.warn(mes.format('LN', 'is', nln))
-                self._b=False 
-                
-            if not self._b:
-                self._logging.debug ( "Build is set to TRUE, however,"
-                    '{0}'.mes.format(
-                        f'{"TRES" if self.tres is None else "LN"}',
-                        'is', f'{ntres if self.tres is None else nln}')
-                )
-                
-        if self._b: 
-            self._createNM()
+        return self._createNM( return_NM= return_NM, 
+                              display_infos= display_infos ) 
+    
+    def set_inversion_model_attr ( self, **model_params): 
+        """ Set inversion model parameters as attributes. Note all related 
+        to the raw inversion model strats with attribte `model_xxx ` while 
+        all related to files must must suffixed with `_fn`. For instances 
+        the folling data such ['model', 'iter', 'data' , 'mesh']  can be 
+        added as keywords arguments where `_fn` is suffixed to each names.
         
+        Parameters 
+        -----------
+        model_parameters: dict 
+          Keyword arguments from inversion model parameters. The useful 
+          attributes passed to accurathe model creation are: 
+        
+          - model_depth: Arraylike shape (n_depth, ) of the model, mostly 
+            refer to the vertical nodes. 
+          - model_resistivities: ArrayLike of shape ( y_nodes , x_nodes ). It 
+            is array of model block composed of resistivity values of vertical 
+            nodels and horizontal nodes. It is the model-calculated resistivity. 
+            It is usefull to pass the same argument as `crm` parameters. 
+          - model_x_nodes: ArrayLike of shape (x_nodes, ) is  the horizontal 
+            nodes of the model block. 
+          - model_station_locations: Arraylike of offset of valid stations 
+            locations. It might truly refers to the number of investigated 
+            stations. 
+          - model_stations: List or Arraylike of the stations names of 
+            the investigated area. It might be consistent with the 
+            `model_station_locations`. 
+          - model_rms: Root-Mean-Squared values of the models after inversion. 
+            By default , the target is set to ``1.0``. 
+          - model_roughness: Roughness of the models. This is an optional 
+            parameters and using when OCCAM2D software is used to invert the 
+            data.
+            
+          Model files can also be includes. In that case, the attributes must 
+          suffixes with `_fn`. Some useful model files can be `model`, `mesh`
+          `data` and `iter`. For instance to set the data file to a keyword 
+          arguments it sould be ``data_fn=xxxx`` whether the new data attribute 
+          should be retrived as `data_fn`. Note that: 
+            
+          - `model_fn` is the model files after inversions 
+          - `data_fn` is the data files before inversions 
+          - `iter_fn` is the iteration results files if applicable with 
+            the kind of inversion software used 
+          - `mesh_fn` is the mesh files construct for forward modeling. 
+
+        """
+        model_depth = model_params.pop("model_depth", None  )
+        model_resistivities = model_params.pop(
+            'model_resistivities', None)
+        model_x_nodes = model_params.pop ('model_x_nodes', None)
+        model_station_locations = model_params.pop (
+            'model_station_locations', None )
+        model_stations = model_params.pop("model_stations", None)
+        model_rms = model_params.pop("model_rms", 1.)
+        model_roughness = model_params.pop("model_roughness", 42. )
+        
+        if model_resistivities is not None: 
+            self.crm = model_resistivities 
+            
+        if model_depth is not None: 
+            model_depth = np.array ( model_depth, dtype = float)
+            
+            if len(model_depth )!= len(self.crm): 
+                raise DepthError ("Model depth and model-calculated resistivity"
+                                  " (CRM) must be a consistent size. Got"
+                                  f" {len(model_depth)} and {len(self.crm)}.")
+            self.model_depth= model_depth 
+        
+        if not hasattr (self, 'model_depth'): 
+            # create a pseudo depth
+            self.model_depth = np.linspace (self.z0, self.max_depth, len(self.crm))
+            
+        if model_resistivities is not None: 
+            self.model_resistivities = model_resistivities 
+            
+        if model_x_nodes is not None: 
+            self.model_x_nodes = model_x_nodes 
+    
+        if model_station_locations is not None: 
+            self.model_station_locations= model_station_locations
+            
+        if not hasattr ( self, 'model_station_locations' ): 
+            self.model_station_locations = np.arange (
+                0 , self.crm.shape [1])* self.step 
+            
+        if not hasattr (self, 'model_x_nodes'): 
+            self.model_x_nodes = self.model_station_locations 
+            
+        if not hasattr ( self, "model_resistivities"): 
+            self.model_resistivities = self.crm 
+            
+        if model_stations is not None: 
+            self.model_stations= model_stations 
+            
+        if not hasattr ( self, 'model_stations'): 
+            self.model_stations = [f'S{i:02}' for i in range (
+                len(self.model_station_locations)) ]
+            
+        self.model_rms = model_rms 
+        self.model_roughness = model_roughness 
    
- 
+        # Append other attributes such as data, model, iter, mesh files
+        # suffixed with `_fn` like `data_fn=xxx`.
+        for key in list(model_params.keys ()) : 
+            setattr ( self, key , model_params[key])
+
     def _createNM(self, crm =None, beta =5 , ptol= 0.1, **kws): 
         """ Create NM through the differents steps of NM creatings. 
         
         - step 1 : soft minimal computing 
         - step2 : model function computing 
         - step 3: add automatic layers
         - step 4: use ANN to find likehood layers
@@ -306,46 +532,46 @@
                     if rock == ro: 
                         h_.append(rho_[jj])
                 m_= np.array(h_)
                 hres[ii]= m_.mean()
                 h_=[]
             return r_, hres 
         
-        iln =kws.pop('input_layers', None)
-        tres =kws.pop('tres', None)
+        # iln =kws.pop('layers', None)
+        # tres =kws.pop('tres', None)
         subblocks =kws.pop('subblocks', None)
         disp= kws.pop('display_infos', True)
-        n_epochs = kws.pop('n_epochs', None)
+        # n_epochs = kws.pop('n_epochs', None)
         hinfos =kws.pop('headerinfos',
                         ' Layers [auto=automatic]')
+        return_NM= kws.pop( 'return_NM', False  )
+        
         if subblocks is not None: 
             self.subblocks = subblocks
         
-        if iln is not None: 
-            self.input_layers = iln 
-        if tres is not None: 
-            self.tres = tres 
-        
-        if crm is not None:
-            self.crm = crm 
-        if beta is not None: 
-            self.beta = beta 
-        if ptol is not None:
-            self.ptol = ptol 
-        if n_epochs is not None: 
-            self.n_epochs = n_epochs 
+        # if iln is not None: 
+        #     self.layers = iln 
+        # if tres is not None: 
+        #     self.tres = tres 
+        
+        # if crm is not None:
+        #     self.crm = crm 
+        # if beta is not None: 
+        #     self.beta = beta 
+        # if ptol is not None:
+        #     self.ptol = ptol 
+        # if n_epochs is not None: 
+        #     self.n_epochs = n_epochs 
             
         self.s0 , errors=[], []
         #step1 : SOFMINERROR 
         if TQDM : 
-            pbar =tqdm.tqdm(total= 3,
-                             ascii=True,unit='B',
-                             desc ='geostrata', 
-                             ncols =77)
-            
+            pbar =tqdm.tqdm(total= 3,ascii=True,unit='B',
+                             desc ='build-NM', ncols =77)
+       
         for ii in range(len(self.subblocks)):
             s1, error = self._softMinError(subblocks= self.subblocks[ii])
             self.s0.append(s1)
             errors.append(error)
             if TQDM : pbar.update(1)
         #step2 : MODELFUNCTION USING DESCENT GRADIENT 
         for ii in range(len(self.s0)):
@@ -360,60 +586,68 @@
         for ii in range(len(self.s0)):
             if 0 in self.s0[ii][:, :]: 
                 s3, autorock_properties= self._createAutoLayer(
                     subblocks=self.subblocks[ii], s0=self.s0[ii]  )
                 arp_.append(autorock_properties)
                 self.s0[ii]=s3       
         # Assembly the blocks 
-        self.nm = np.concatenate((self.s0))
-        self.z=self.nm[:, 0]
-        self.nm = self.nm[:, 1:]
+        self.nm_ = np.concatenate((self.s0))
+        self._z=self.nm_[:, 0]
+        self.nm_ = self.nm_[:, 1:]
         
         if TQDM : 
             pbar.update(3)
-            print(' process completed')
+            # print(' process completed')
             pbar.close()
             
         # make site blocks 
-        self.nmSites= makeBlockSites(x_nodes=self.model_x_nodes, 
-                        station_location= self.station_location, 
-                             block_model=self.nm )
-        self.crmSites = makeBlockSites(x_nodes=self.model_x_nodes, 
-                            station_location= self.station_location, 
-                             block_model=self.model_res)
-
+        self.nmSites_= makeBlockSites(x_nodes=self.model_x_nodes, 
+                        station_location= self.model_station_locations, 
+                             block_model=self.nm_ )
+        self.crmSites_ = makeBlockSites(x_nodes=self.model_x_nodes, 
+                            station_location= self.model_station_locations, 
+                             block_model=self.model_resistivities)
         #Update TRES and LN 
         gammaL, gammarho = s__auto_rocks(arp_) 
         
-        if self.input_layers is not None: 
-            print_layers = self.input_layers  + [ ' {0} (auto)'.format(l) 
+        if self.layers is not None: 
+            print_layers = self.layers  + [ ' {0} (auto)'.format(l) 
                                                  for l in gammaL ]
-            self.input_layers = self.input_layers + gammaL
+            self.layers = self.layers + gammaL
         # keep the auto_layer found     
         self.auto_layers =gammaL
-        self.tres = list(np.power(10,self._tres))  + list (np.power(10, 
-                  np.array([float(rv) for rv in gammarho])))
+        with warnings.catch_warnings():
+            warnings.filterwarnings(action='ignore', category=RuntimeWarning)
+            # reconvert to power10 since database value is 
+            # not in log10
+            if self.tolog10: 
+                self.tres = list(np.power(10,self._tres))  + list (
+                    np.power(10, np.array([float(rv) for rv in gammarho])))
+            else: self.tres = list(self.tres) + [
+                float(rv) for rv in gammarho]
+            
         # display infos 
         if disp:
             display_infos(infos=print_layers,
                           header= hinfos)
         #STEP 4: Train ANN: (still in development) to predict your 
-        #layer: No need to plot the NM 
-        
+        #l ayer: No need to plot the NM  (Need huge amount of data)
         # copy main attributes for pseudostratigraphic plot purpose 
-        import copy 
         for name , attrval in zip(['TRES', 'LNS'], 
-                              [self.tres , self.input_layers]):
+                              [self.tres , self.layers]):
             setattr(self, name, copy.deepcopy(attrval))
         # memorize data 
         _ps_memory_management(self)
         
-        return self.nm
-
+        # turn off log10 to False
+        # to not convert any more data 
+        self.tolog10 =False 
         
+        return self.nm_ if return_NM else self 
+    
     def _softMinError(self, subblocks=None, **kws ): 
         """
         Replace the calculated resistivity by the true resistivity 
         using the soft minimal error ()
         
         :param crm: Is the calculated resistivity model from Occam2D 
         inversion results 
@@ -442,19 +676,30 @@
         return s0, error 
 
 
     def _hardMinError(self, tres=None, subblocks=None, s0=None, ptol = None,
                          kind='linear', **kwargs ): 
         """The second step introduces the model function F=WZ  where W
         contains the weights of parameters number and Z is V2 matrix 
-        that contains a bias column. If the parameter number P equal to two, 
-        the model function f(z)=_(p=1)^Pw_(p-1) z^(p-1)    becomes a
-        linear function with f_1^((1) ) (z)=  wz+r_0  with w_1=w and w_0=r_0
-        he gradient descent algorithm  is used to find the best parameters w
-        and r_0  that  minimizes the  MSE loss function  J .
+        that contains a "bias" column. If the parameter number P equal to two, 
+        the model function:
+            
+        .. math:: 
+            
+            f(z)= \sum_{p=1}^{P} [w_{p-1} z ^{p-1}]
+            
+        becomes alinear function with: 
+            
+        .. math::
+            
+            f_1^{(1)} (z) = wz+r_0 \qual \text{with} w_1=w \aqual \text{and} w_0=r_0
+            
+        Indeed, the gradient descent algorithm  is used to find the 
+        best parameters :math:`w` and :math:`r_0`  that  minimizes the  
+        MSE loss function  :math:`J`.
         
         :param subblocks: `crm` block  
         :param s0: blocks from the first step :meth:`~._sofminError`
         :param kind: Type of model function to apply. Can also be 
                 a `polynomial` by specifying the `degree` 
                 into argument `degree`.
         :Example: 
@@ -469,36 +714,36 @@
         if tres is not None:
             self.tres = tres 
         if ptol is not None: 
             self.ptol = ptol 
         
         eta = kwargs.pop('eta', None)
         if eta is not None: 
-            self._eta = eta 
+            self.eta = eta 
         n_epochs =kwargs.pop('n_epochs', None)
         if n_epochs is not None: 
             self.n_epochs = n_epochs 
         kind = kwargs.pop('kind', None)
         if kind is not None:
-            self._kind = kind 
+            self.kind = kind 
         degree = kwargs.pop('degree', None) 
         if degree is not None: 
-            self._degree = degree 
+            self.degree = degree 
         
         buffer =self.ptol +1  #bufferr error 
         _z= s0[:, 0]
         s0 = s0[:, 1:].T
 
         subblocks=subblocks[:, 1:].T
         error =[]
         for ii in range(s0.shape[0]): # hnodes N
             F, *_= self.gradient_descent(z=_z,s=subblocks[ii,:],
-                                         alpha= self._eta,
+                                         alpha= self.eta,
                                          n_epochs= self.n_epochs, 
-                                         kind= self._kind)
+                                         kind= self.kind)
             for jj in range(s0.shape[1]): # znodes V
                  if s0[ii, jj] ==0. : 
                     rp =F[jj]
                     for k in range(len(self.tres)) :
                         with np.errstate(all='ignore'): 
                             sfme_k = (rp -self.tres[k])**2\
                                  /rp**2
@@ -511,15 +756,15 @@
                                
                     buffer = self.ptol +1      # initialize buffer 
                     
         s0= np.concatenate((_z.reshape(_z.shape[0], 1), s0.T), axis =1)    
         return s0, error 
         
     @staticmethod    
-    def gradient_descent(z, s, alpha, n_epochs, **kws): 
+    def gradient_descent(z, s, alpha, n_epochs,raise_warn=False,  **kws): 
         """ Gradient descent algorithm to  fit the best model parameter. 
         
         :param z: vertical nodes containing the values of depth V
         :param s: vertical vector containin the resistivity values 
         :param alpha: step descent parameter or learning rate. 
                     *Default* is ``0.01`
         :param n_epochs: number of iterations. *Default* is ``100``
@@ -543,24 +788,26 @@
             >>> import matplotlib.pyplot as plt 
             >>> plt.scatter (z, res)
             >>> plt.plot(z, fz)
         """
         kind_=kws.pop('kind', 'linear')
         kind_degree = kws.pop('degree', 1)
         
+        
         if kind_degree >1 : kind_='poly'
         
         if kind_.lower() =='linear': 
             kind_degree = 1 
         elif kind_.lower().find('poly')>=0 : 
             if kind_degree <=1 :
                 _logger.debug(
                     'The model function is set to `Polynomial`. '
                     'The degree must be greater than 1. Degree wil reset to 2.')
-                warnings.warn('Polynomial degree must be greater than 1.'
+                if raise_warn:
+                    warnings.warn('Polynomial degree must be greater than 1.'
                               'Value is ressetting to `2`.')
                 kind_degree = 2
             try : 
                 kind_degree= int(kind_degree)
             except Exception :
                 raise ValueError(f'Could not `{kind_degree}` convert to integer.')
                 
@@ -577,18 +824,21 @@
             c= []
             deg = degree 
             w = np.zeros((degree+1, 1)) # initialize weights 
             
             def init_weights (x, y): 
                 """ Init weights by calculating the scope of the function along 
                  the vertical nodes axis for each columns. """
-                for j in range(x.shape[1]-1): 
-                    a= (y.max()-y.min())/(x[:, j].max()-x[:, j].min())
-                    w[j]=a
-                w[-1] = y.mean()
+                with warnings.catch_warnings():
+                    warnings.filterwarnings(action='ignore', 
+                                            category=RuntimeWarning)
+                    for j in range(x.shape[1]-1): 
+                        a= (y.max()-y.min())/(x[:, j].max()-x[:, j].min())
+                        w[j]=a
+                    w[-1] = y.mean()
                 return w   # return weights 
         
             for i in range(degree):
                 c.append(x ** deg)
                 deg= deg -1 
         
             if len(c)> 1: 
@@ -646,37 +896,37 @@
             
         
     def _makeBlock (self): 
         """ Construct the differnt block  based on `beta` param. Separate blocks 
         from number of vertical nodes generated by the first `beta` value applied 
         to the `crm`."""
 
-        self.zmodel = np.concatenate((self.geo_depth.reshape(
-            self.geo_depth.shape[0], 1),  self.model_res), axis =1) 
+        self.zmodel_ = np.concatenate((self.model_depth.reshape(
+            self.model_depth.shape[0], 1),  self.model_resistivities), axis =1) 
                                     
-        vv = self.zmodel[-1, 0] / self.beta 
-        for ii, nodev in enumerate(self.zmodel[:, 0]): 
+        vv = self.zmodel_[-1, 0] / self.beta 
+        for ii, nodev in enumerate(self.zmodel_[:, 0]): 
             if nodev >= vv: 
                 npts = ii       # collect number of points got.
                 break 
         self._subblocks =[]
         
         bp, jj =npts, 0
-        if len(self.zmodel[:, 0]) <= npts: 
-            self._subblocks.append(self.zmodel)
+        if len(self.zmodel_[:, 0]) <= npts: 
+            self._subblocks.append(self.zmodel_)
         else: 
-            for ii , row in enumerate(self.zmodel) : 
+            for ii , row in enumerate(self.zmodel_) : 
                 if ii == bp: 
-                    _tp = self.zmodel[jj:ii, :]
+                    _tp = self.zmodel_[jj:ii, :]
                     self._subblocks.append(_tp )
                     bp +=npts
                     jj=ii
                     
-                if len(self.zmodel[jj:, 0])<= npts: 
-                    self._subblocks.append(self.zmodel[jj:, :])
+                if len(self.zmodel_[jj:, 0])<= npts: 
+                    self._subblocks.append(self.zmodel_[jj:, :])
                     break 
                 
         return self._subblocks 
  
     @property 
     def subblocks(self): 
         """ Model subblocks divised by `beta`"""
@@ -712,16 +962,15 @@
             self.tres = tres 
         if ptol is not None: 
             self.ptol = ptol 
         
         def _findGeostructures(_res): 
             """ Find the layer from database and keep the ceiled value of 
             `_res` calculated resistivities"""
-            
-            structures = self.get_structure(_res)
+            structures = find_similar_structures(_res)
             if len(structures) !=0 or structures is not None:
                 if structures[0].find('/')>=0 : 
                     ln = structures[0].split('/')[0].lower() 
                 else: ln = structures[0].lower()
                 return ln, _res
             else: 
                 valEpropsNames = self._getProperties(db_properties)
@@ -767,39 +1016,40 @@
             return  finalln, finalres 
             
         _z= s0[:, 0]
         s0 = s0[:, 1:].T
         _temptres , _templn =[], []
         subblocks=subblocks[:, 1:].T
 
-        for ii in range(s0.shape[0]): # hnodes N
-            for jj in range(s0.shape[1]): # znodes V
-                if s0[ii, jj] ==0. : 
-                    lnames, lcres =_findGeostructures(
-                        np.power(10, subblocks[ii, jj]))
-                    _temptres.append(np.log10(lcres))
-                    _templn.append(lnames)
-
+        with warnings.catch_warnings():
+            warnings.filterwarnings(action='ignore', category=RuntimeWarning)
+            for ii in range(s0.shape[0]): # hnodes N
+                for jj in range(s0.shape[1]): # znodes V
+                    if s0[ii, jj] ==0. : 
+                        lnames, lcres =_findGeostructures(
+                            np.power(10, subblocks[ii, jj]))
+                        _temptres.append(np.log10(lcres))
+                        _templn.append(lnames)
+    
         auto_rocks_names_res, automatics_resistivities =\
             _normalizeAutoresvalues(_templn,_temptres )
-        
+            
         for ii in range(s0.shape[0]): # hnodes N
            for jj in range(s0.shape[1]): # znodes V
                if s0[ii, jj] ==0. :
                    for k in range(automatics_resistivities.shape[1]): 
                        subblocks[ii, jj] == automatics_resistivities[0,:][k]
                        s0[ii, jj]= automatics_resistivities[1,:][k]
                        break 
-        
-                                   
+                      
         s0= np.concatenate((_z.reshape(_z.shape[0], 1), s0.T), axis =1) 
         
         # display infos 
         if disp:
-            display_infos(infos=self.input_layers,
+            display_infos(infos=self.layers,
                           header= hinfos)
         
         return  s0, auto_rocks_names_res
         
     @staticmethod
     def _getProperties(properties =['electrical_props', '__description'], 
                        sproperty ='electrical_props'): 
@@ -862,15 +1112,15 @@
         :param in_percent`: Set to `True` to see your plot map scaled in %.
         
         :Example: 
             
             >>> from watex.geology.stratigraphic import GeostrataModel
             >>> geosObj = GeostrataModel().fit(**inversion_files,
                                   input_resistivities=input_resistivity_values, 
-                                  input_layers=input_layer_names)
+                                  layers=input_layer_names)
             >>> geosObj.strataModel(kind='nm', misfit_G =False)
         """
         m_='watex.geology.GeostrataModel.strataModel'
         def compute_misfit(rawb, newb, percent=True): 
             """ Compute misfit with calculated block and new model block """
             m_misfit = .01* np.sqrt (
                 (rawb - newb)**2 /rawb**2 ) 
@@ -882,48 +1132,50 @@
             kind ='nm' if kind else 'crm'
 
         depth_scale = kwargs.pop('scale', 'm')
         misfit_G =kwargs.pop('misfit_G', False)
         misfit_percentage = kwargs.pop('in_percent', True)
         
         kind = _assert_model_type(kind)
-        if self.nm is None: 
+        if self.nm_ is None: 
             self._createNM()  
                 
         if kind =='nm':
-            data = self.nmSites 
+            data = self.nmSites_ 
         if kind =='crm': 
-            data = self.crmSites
+            data = self.crmSites_
 
       # compute model_misfit
-        if misfit_G is True : 
-            if kind =='crm': 
-                warnings.warn(
-                    "By default, the plot should be the stratigraphic"
-                    " misfit<misfit_G>.")
+        if misfit_G: 
+            if kind =='crm':
+                if self.verbose:
+                    warnings.warn(
+                        "By default, the plot should be the stratigraphic"
+                        " misfit<misfit_G>.")
     
             self._logging.info('Visualize the stratigraphic misfit.')
-            data = compute_misfit(rawb=self.crmSites , 
-                                  newb= self.nmSites, 
+            data = compute_misfit(rawb=self.crmSites_ , newb= self.nmSites_, 
                                   percent = misfit_percentage)
             
-            print('{0:-^77}'.format('StrataMisfit info'))
-            print('** {0:<37} {1} {2} {3}'.format(
-                'Misfit max ','=',data.max()*100., '%' ))                      
-            print('** {0:<37} {1} {2} {3}'.format(
-                'Misfit min','=',data.min()*100., '%' ))                          
-            print('-'*77)
-            
-        warnings.warn(
-            f'Data stored from {m_!r} should be moved on binary drive and'
-            ' method arguments should be keywordly only.', FutureWarning)
-        
-        return (data, self.station_names, self.station_location,
-            self.geo_depth, self.doi, depth_scale, self.model_rms, 
-            self.model_roughness, misfit_G ) 
+            if self.verbose:
+                print('{0:-^77}'.format('StrataMisfit info'))
+                print('** {0:<37} {1} {2} {3}'.format(
+                    'Misfit max ','=',data.max()*100., '%' ))                      
+                print('** {0:<37} {1} {2} {3}'.format(
+                    'Misfit min','=',data.min()*100., '%' ))                          
+                print('-'*77)
+            
+        if self.verbose:
+            warnings.warn(
+                f'Data stored from {m_!r} should be moved on binary drive and'
+                ' method arguments should be keywordly only.', FutureWarning)
+            
+        return (data, self.model_stations, self.model_station_locations,
+            self.model_depth, self.doi, depth_scale, self.model_rms, 
+            self.model_roughness, misfit_G )
     
 
     @staticmethod
     def _strataPropertiesOfSite(obj, station =None, display_s=True): 
         """ Build all properties of strata under each station.  
         
         Parameters
@@ -936,50 +1188,51 @@
             Display the log layer infos as well as layers thicknesses
         
         Examples
         --------
         >>> from watex.geology.stratigraphic import GeoStrataModel 
         >>> import watex.utils.geotools as GU 
         >>> geosObj = GeoStrataModel().fit( input_resistivities=TRES, 
-        ...              input_layers=LNS,**INVERS_KWS)
+        ...              layers=LNS,**INVERS_KWS)
         >>> geosObj._strataPropertiesOfSite(geosObj,station= 'S05')
         """
         
         def stamping_ignored_rocks(fittedrocks, lns): 
             """ Stamping the pseudo rocks and ignored them during plot."""
             ir= set(fittedrocks).difference(set(lns))
             for k in range( len(fittedrocks)): 
                 if fittedrocks[k] in ir : 
                     fittedrocks[k] ='$(i)$'
             return fittedrocks
         
         # assert the station, get it appropriate index and take the tres 
         # at that index 
         if station is None: 
-            stns = ["S{:02}".format(i) for i in range(obj.nmSites.shape[1])]
+            stns = ["S{:02}".format(i) for i in range(obj.nmSites_.shape[1])]
             obj._logging.error('None station is found. Please select one station'
                                 f' between {smart_format(stns)}')
-            warnings.warn("NoneType can not be read as station name."
-                            " Please provide your station name. list of sites" 
-                             f" are {smart_format(stns)}")
+            if obj.verbose:
+                warnings.warn("NoneType can not be read as station name."
+                                " Please provide your station name. list of " 
+                                 f" sites are {smart_format(stns)}")
             raise ValueError("NoneType can not be read as station name."
                              " Please provide your station name.")
         
-        if  obj.nmSites is None: 
+        if  obj.nmSites_ is None: 
                 obj._createNM()
         
         try : 
             id0= int(station.lower().replace('s', ''))
         except : 
-            id_ =assert_station(id= station, nm = obj.nmSites)
+            id_ =assert_station(id= station, nm = obj.nmSites_)
             station_ = 'S{0:02}'.format(id_)
         else : 
-            id_ =assert_station(id= id0 + 1, nm = obj.nmSites)
+            id_ =assert_station(id= id0 + 1, nm = obj.nmSites_)
             station_ = 'S{0:02}'.format(id0)
-        obj.logS = obj.nmSites[:, id_] 
+        obj.logS = obj.nmSites_[:, id_] 
      
         # assert the input  given layers and tres 
         is_the_same_length, msg  = assert_len_lns_tres(
             obj.LNS , obj.TRES)
         
         if is_the_same_length :
             # then finf 
@@ -987,76 +1240,120 @@
             pstres= obj.TRES 
             ps_lnstres   = [(a, b) for a , b 
                             in zip(obj.LNS, obj.TRES)] 
         if not is_the_same_length:
             # find the pseudoTRES and LNS for unknowrocks or layers
             msg +=  "Unknow layers should be ignored."   
             _logger.debug(msg)
-            warnings.warn(msg)
+            warnings.warn(msg) if obj.verbose else None
             
             pslns, pstres, ps_lnstres =  fit_tres(
                                             obj.LNS, obj.TRES, 
                                             obj.auto_layers)
         # now build the fitting rocks 
-        fitted_rocks =fit_rocks(logS_array= obj.nmSites[:,id_],
+        fitted_rocks =fit_rocks(logS_array= obj.nmSites_[:,id_],
                                    lns_=pslns , tres_=pstres)
         # set the raws fitted rocks 
         import copy
         setattr(obj, 'fitted_rocks_r', copy.deepcopy(fitted_rocks) )
         # change the pseudo-rocks  located in fitted rocks par ignored $i$
         # and get  the stamped rocks 
         setattr(obj, 'fitted_rocks',stamping_ignored_rocks(
             fitted_rocks, obj.LNS ) )
         
         # fit stratum property 
         sg, _, zg, _= fit_stratum_property (obj.fitted_rocks,
-                                obj.z, obj.logS)
+                                obj._z, obj.logS)
         obj.log_thicknesses, obj.log_layers,\
             obj.coverall = get_s_thicknesses( 
             zg, sg,display_s= display_s, station = station_ )
             
         # set the dfault layers properties hatch and colors from database
         obj.hatch , obj.color =  fit_default_layer_properties(
             obj.log_layers) 
         
         return obj
     
     @staticmethod
-    def plotPseudostratigraphic(station, zoom=None, annotate_kws=None, **kws):
-        """ Build the pseudostratigraphic log. 
+    def plotStrata(station, zoom=None, annotate_kws=None, **kws):
+        """ Build the Stratalog. 
         :param station: station to visualize the plot.
         :param zoom: float  represented as visualization ratio
             ex: 0.25 --> 25% view from top =0.to 0.25* investigation depth 
             or a list composed of list [top, bottom].
         
         :Example: 
             >>> input_resistivity_values =[10, 66,  700, 1000, 1500,  2000, 
                                     3000, 7000, 15000 ] 
             >>> input_layer_names =['river water', 'fracture zone', 'granite']
             # Run it to create your model block alfter that you can only use 
-            #  `plotPseudostratigraphic` only
+            #  `plotStrata` only
             # >>> obj= quick_read_geomodel(lns = input_layer_names, 
             #                             tres = input_resistivity_values)
-            >>> plotPseudostratigraphic(station ='S00')
+            >>> plotStrata(station ='S00')
         
         """
         
         if annotate_kws is None: annotate_kws = {'fontsize':12}
         if not isinstance(annotate_kws, dict):
             annotate_kws=dict()
         obj = _ps_memory_management(option ='get' )  
         obj = GeoStrataModel._strataPropertiesOfSite (obj,station=station,
                                                        **kws )
         # plot the logs with attributes 
-        pseudostratigraphic_log (obj.log_thicknesses, obj.log_layers,station,
+        plot_stratalog (obj.log_thicknesses, obj.log_layers, station,
                                     hatch =obj.hatch ,zoom=zoom,
                                     color =obj.color, **annotate_kws)
         print_running_line_prop(obj)
         
         return obj 
+
+    @property 
+    def tres(self): 
+        """ Input true resistivity"""
+        return self._tres 
+    @tres.setter 
+    def tres(self, ttres):
+        """ Convert Tres to log 10 resistivity if tolog10 is set to ``True``. """
+        ttres = is_iterable (ttres, transform =True )
+        
+        try : 
+            self._tres =[np.log10(t) for t in ttres] if self.tolog10 else [ 
+                float(t) for t in ttres]
+        except : 
+            raise ValueError("TRES expect values to be numeric."
+                             f"Got {np.array(ttres).dtype.name !r}")
+    @property 
+    def inspect (self): 
+        """ Inspect object whether is fitted or not"""
+        msg = ( "{obj.__class__.__name__} instance is not fitted yet."
+               " Call 'fit' with appropriate arguments before using"
+               " this method"
+               )
+        
+        if not hasattr (self, 'crm'): 
+            raise NotFittedError(msg.format(
+                obj=self)
+            )
+        return 1 
+    
+    
+    def __repr__(self):
+        """ Pretty format for programmer guidance following the API... """
+        _t = ("area", "beta", "n_epochs","ptol",  "eta","kind", "degree",
+              "z0" , "max_depth","step","doi", "tolog10", "verbose")
+
+        outm ='<{!r}:' + ', '.join( [
+            "{}={}".format( k,   False if getattr(self, k)==... else (
+                    "[...]" if len( is_iterable(getattr (
+                        self, k),exclude_string=True, transform=True))>3
+                 else str (getattr(self, k)))) 
+            for k in _t]) + '>' 
+            
+        return  outm.format(self.__class__.__name__)
     
 def _ps_memory_management(obj=None, option='set'): 
     """ Manage the running times for stratigraphic model construction.
     
     The script allows to avoid running several times the GeoStrataModel model
     construction to retrieve the pseudostratigraphic (PS) log at each station.  
     It memorizes the model data for the first run and used it when calling it
@@ -1085,18 +1382,19 @@
             memory_exists =  os.path.isfile(os.path.join(memorypath, memory))
         except: 
             memory_exists =  os.path.isfile(memory_file)
             
         if not memory_exists: 
             _logger.error('No memory found. Run the GeoStrataModel class '
                           'beforehand to create your first model.')
+
             warnings.warn("No memory found. You need to build your "
                           " GeoStrataModel model by running the class first.")
-            raise  MemoryError("Memory not found. Use the GeoStrataModel class to "
-                               "create your model first.")
+            raise  MemoryError("Memory not found. Run the `buildNM` method"
+                               " to create your model first.")
         try: 
             psobj_token, data_ = load_serialized_data(
                 os.path.join(memorypath, memory))
         except: 
             psobj_token, data_ = load_serialized_data(memory_file )
             
         data = dict(data_)
@@ -1104,15 +1402,14 @@
         # dictattributes of GeoStrataModel class
         psobj = type ('PseudoStratigraphic', (), { 
             k:v for k, v in data.items()})
         psobj.__token = psobj_token
         
         return psobj
                                 
-        
 def makeBlockSites(station_location, x_nodes, block_model): 
     """ Build block that contains only the station locations values
     
     :param station_location: array of stations locations. Must be  
                 self contains on the horizontal nodes (x_nodes)
     :param x_nodes: Number of nodes in horizontal 
     :param block_model: Resistivity blocks model 
@@ -1233,33 +1530,36 @@
                 gg[k]= __gammaProps[1:][kk][ix]
                 
     r_props = [_sanitize_db_items(r_props[k], force=True )
                for k in range(len (r_props))]
     return tuple(r_props)    
  
 def __build_ps__token(obj):
-    """ Build a special token for each GeoStrataModel model. Please don't 
-    edit anything here. Force editing is your own risk."""
+    """ Build a special token for each GeoStrataModel model. Memory uses 
+    each model token to fetch the strata log at each station without 
+    any model recomputation. Please don't edit anything here at least you
+    knwow what your are doing. Force editing is your own risk."""
     import random 
     random.seed(42)
-    __c =''.join([ i for i in  [''.join([str(c) for c in obj.crmSites.shape]), 
-     ''.join([str(n) for n in obj.nmSites.shape]),
-    ''.join([l for l in obj.input_layers]) + str(len(obj.input_layers)), 
+    __c =''.join([ i for i in  [''.join([str(c) for c in obj.crmSites_.shape]), 
+     ''.join([str(n) for n in obj.nmSites_.shape]),
+    ''.join([l for l in obj.layers]) + str(len(obj.layers)), 
     str(len(obj.tres))] + [''.join(
-        [str(i) for i in [obj._eta, obj.beta, obj.doi,obj.n_epochs,
-                          obj.ptol, str(obj.z.max())]])]])
-    __c = ''.join(random.sample(__c, len(__c))).replace(' ', '')                                               
-    n= ''.join([str(getattr(obj, f'{l}'+'_fn'))
+        [str(i) for i in [obj.eta, obj.beta, obj.doi,obj.n_epochs,
+                          obj.ptol, str(obj._z.max())]])]])
+    __c = ''.join(random.sample(__c, len(__c))).replace(' ', '')  
+    n= ''.join([str(getattr(obj, f'{l}'+'_fn', str(obj.area).lower() ))
                          for l in ['model', 'iter', 'mesh', 'data']])
     n = ''.join([s.lower() 
                  for s in random.sample(n, len(n))]
                 ).replace('/', '').replace('\\', '')
     
     return ''.join([n, __c]).replace('.', '')
         
+    
 def fit_tres(lns, tres, autorocks, force=False, **kws): 
     """ Read and get the resistivity values from tres that match the 
      the given layers.
      
     Find the layers and  their corresponding resistivity values from the 
     database especially when values in the TRES and LN are not the same
     length. It's not possible to match each value to its
@@ -1366,32 +1666,44 @@
                           condition_status =True, skip_value =0 )
         # get the index of this values in tres
         index = r0.index (_val) 
         newTRES[index] = (_gammaLN[ix], nvalue)
         
     # create for each tres its pseudorock name 
     # and pseudorock value
-    pseudo_lns = [a [0] for a in newTRES] + rlns 
-    pseudo_tres = [b[1] for b in newTRES] + rtres 
+    # print(newTRES)
+    # print(rlns, rtres )
+    pseudo_lns, pseudo_tres=[], [] 
+    
+    for value  in newTRES: 
+        if hasattr (value , '__iter__'): 
+            pseudo_lns.append (value[0] )
+            pseudo_tres.append (value[1] )
+        else :
+            pseudo_lns .append (None)
+            pseudo_tres.append (np.nan )
+            
+    pseudo_lns +=rlns
+    pseudo_tres += rtres 
+    # pseudo_lns = [a [0] for a in newTRES] + rlns 
+    # pseudo_tres = [b[1] for b in newTRES] + rtres 
     newTRES += [(a, b) for a , b in zip(rlns, rtres)]
     
     return pseudo_lns , pseudo_tres , newTRES 
 
-
-
 def quick_read_geomodel(lns=None, tres=None):
     """Quick read and build the geostratigraphy model (NM) 
     
     :param lns: list of input layers 
     :param tres: list of input true resistivity values 
     
     :Example: 
         >>> import watex.geology.stratigraphic as GM 
         >>> obj= GM.quick_read_geomodel()
-        >>> GC.fit_tres(obj.input_layers, obj.tres, obj.auto_layer_names)
+        >>> GC.fit_tres(obj.layers, obj.tres, obj.auto_layer_names)
     """
     PATH = 'data/occam2D'
     k_ =['model', 'iter', 'mesh', 'data']
 
     try : 
         INVERS_KWS = {
             s +'_fn':os.path.join(PATH, file) 
@@ -1413,165 +1725,12 @@
         _logger.error("NoneType can not be read! Need the basics Occam2D"
                          f" inversion {smart_format(k_)} files.")
 
         raise ValueError("NoneType can not be read! Need the basics Occam2D"
                          f" inversion {smart_format(k_)} files.")
         
     geosObj = GeoStrataModel( input_resistivities=tres, 
-                      input_layers=lns,**INVERS_KWS)
+                      layers=lns,**INVERS_KWS)
     geosObj._createNM()
     
     return geosObj 
 
-GeoStrataModel.__doc__="""\
-Create a stratigraphic model from inversion models blocks. 
-
-The Inversion model block is two dimensional array of shape 
-(n_vertical_nodes, n_horizontal_nodes ). Can use external packages 
-to build blocks and provide the 2Dblock into `crm` parameter. 
-
-The challenge of this class  is firstly to delineate with much 
-accuracy the existing layer boundary (top and bottom) and secondly,
-to predict the stratigraphy log before the drilling operations at each 
-station. Moreover, its a better way to select the right drilling location
-and also to estimate the thickness of existing layer such as water table 
-layer as well as to figure out the water reservoir rock in the case of 
-groundwater exploration. 
-
-Note that if the model blocks is build from externam softwares. You may as  
-in the keywordsr argumments of `GeoStrataModel` the following attributes: 
-    
-    - model_res : 2D resitivity model of (n_vertical_nodes, n_horizontal_nodes)
-        If `crm` is given , no need to provided it. 
-    - geo_depth: Is the depth the surface to the bottom of each layer that 
-        composed the pseudo-boreholes. Note the N-vertical nodes values 
-    - input_resistivities: list of input resistivities. If the `tres` is passed 
-        not need to given. 
-        
-Parameters 
-----------
-crm : ndarray of shape(n_vertical_nodes, n_horizontal_nodes ),  
-    Array-like of inversion two dimensional model blocks. Note that 
-    the `n_vertical_nodes` is the node from the surface to the depth 
-    while `n_horizontal_nodes` must include the station location 
-    (sites/stations) 
-    
-beta:  int,                
-        Value to  divide into the CRM blocks to improve 
-        the computation times. default is`5`                               
-n_epochs:  int,  
-        Number of iterations. default is `100`
-tres:  array_like, 
-        Truth values of resistivities. Refer to 
-        :class:`~.geodrill.Geodrill` for more details
-ptols: float,   
-        Existing tolerance error between the `tres` values given and 
-        the calculated resistivity in `crm` 
-input_layers: list or array_like  
-        True input_layers names : geological 
-        informations of collected in the area.
-            
-kind: str         
-    Kind of model function to compute the best fit model to replace the
-    value in `crm` . Can be 'linear' or 'polynomial'. if `polynomial` is 
-    set, specify the `degree. Default is 'linear'. 
-    
-alpha: float , 
-    Learning rate for gradient descent computing.  *Default* is ``1e+4`` 
-    for linear. If `kind` is  set to `polynomial` the default value should 
-    be `1e-8`. 
-degree: int,
-     Polynomial function degree to implement gradient descent algorithm. 
-     If `kind` is set to `Polynomial` the default `degree` is ``3.`` and 
-     details sequences 
-**nm**:  ndarray     
-    The NM matrix with the same dimension with `crm` model blocks. 
-
-
-Examples
-----------
->>> from watex.geology.stratigraphic import GeoStrataModel 
->>> # Works with occam2d inversion files if 'pycsamt' or 'mtpy' is installed
->>> # will call the module Geodrill from pycsamt to make occam2d 2D resistivity
->>> # block for our demo. It presumes pycsamt is installed. 
->>> from pycsamt.geodrill.geocore import Geodrill 
->>> path=r'data/inversfiles/inver_res/K4' # path to inversion files 
->>> inversion_files = {'model_fn':'Occam2DModel', 
-...                   'mesh_fn': 'Occam2DMesh',
-...                    "iter_fn":'ITER27.iter',
-...                   'data_fn':'OccamDataFile.dat'
-...                    }
->>> input_resistivity_values =[10, 66, 70, 180, 1000, 2000, 
-...                           3000, 50, 7] 
->>> input_resistivity_values =[10, 66, 70, 180, 1000, 2000, 
-...                               3000, 7000, 15000 ] 
->>> input_layer_names =['river water', 'fracture zone', 'granite']
->>> inversion_files = {key:os.path.join(path, vv) for key,
-                vv in inversion_files.items()}
->>> gdrill= Geodrill (**inversion_files, 
-                     input_resistivities=input_resistivity_values
-                     )
->>> # we can collect the 'model_res' and 'geo_depth_attributes' from 
->>> # `gdrill object` and passed to 'GeoStrataModel' fit method as 
->>> geosObj = GeoStrataModel(ptol =0.1).fit(crm = model_res , 
-                     input_resistivities=gdrill.input_resistivity_values
-                     geo_depth= gdrill.geo_depth )
->>> zmodel = geosObj._zmodel
->>> geosObj.nm # resistivity 2D model block is constructed 
-
-Notes
-------
-Modules work properly with occam2d inversion files if 'pycsamt' or 'mtpy' is 
-installed and  inherits the `Base package` which works with occam2d  model.
-Occam2d inversion files are also acceptables for building model blocks. 
-However the MODEM resistivity files development is still ongoing 
-
-"""
-# def assert_len_layers_with_resistivities(
-#         real_layer_names:str or list, real_layer_resistivities: float or list ): 
-#     """
-#     Assert the length of of the real resistivites with their
-#     corresponding layers. If the length of resistivities is larger than 
-#     the layer's names list of array, the best the remained resistivities
-#     should be topped up to match the same length. Otherwise if the length 
-#     of layers is larger than the resistivities array or list, layer'length
-#     should be reduced to fit the length of the given resistivities.
-    
-#     Parameters
-#     ----------
-#         * real_layer_names: array_like, list 
-#                     list of input layer names as real 
-#                     layers names encountered in area 
-                    
-#         * real_layer_resistivities :array_like , list 
-#                     list of resistivities get on survey area
-                
-#     Returns 
-#     --------
-#         list 
-#             real_layer_names,  new list of input layers 
-#     """
-#     # for consistency put on string if user provide a digit
-#     real_layer_names =[str(ly) for ly in real_layer_names]      
-    
-#     if len(real_layer_resistivities) ==len(real_layer_names): 
-#         return real_layer_names
-    
-#     elif len(real_layer_resistivities) > len(real_layer_names): 
-#          # get the last value of resistivities  to match the structures
-#          # names and its resistivities 
-#         sec_res = real_layer_resistivities[len(real_layer_names):]        
-#        # fetch the name of structure 
-#         geos =Geodrill.get_structure(resistivities_range=sec_res) 
-#         if len(geos)>1 : tm = 's'
-#         else :tm =''
-#         print(f"---> Temporar{'ies' if tm=='s' else 'y'} "
-#               f"{len(geos)} geological struture{tm}."
-#               f" {'were' if tm =='s' else 'was'} added."
-#               " Uncertained layers should be ignored.")
-        
-#         real_layer_names.extend(geos)       
-#         return real_layer_names 
-#     elif len(real_layer_names) > len(real_layer_resistivities): 
-#         real_layer_names = real_layer_names[:len(real_layer_resistivities)]        
-#         return real_layer_names
-
```

### Comparing `watex-0.2.4/watex/methods/__init__.py` & `watex-0.2.5/watex/methods/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/methods/electrical.py` & `watex-0.2.5/watex/methods/electrical.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/methods/em.py` & `watex-0.2.5/watex/methods/em.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/methods/erp.py` & `watex-0.2.5/watex/methods/erp.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/methods/hydro.py` & `watex-0.2.5/watex/methods/hydro.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/metrics.py` & `watex-0.2.5/watex/metrics.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/models/__init__.py` & `watex-0.2.5/watex/models/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/models/_metapredictors.py` & `watex-0.2.5/watex/models/_metapredictors.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/models/premodels.py` & `watex-0.2.5/watex/models/premodels.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/models/validation.py` & `watex-0.2.5/watex/models/validation.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/property.py` & `watex-0.2.5/watex/property.py`

 * *Files 1% similar despite different names*

```diff
@@ -1432,29 +1432,29 @@
             
         return 0
     
     @property 
     def geo_rocks_properties(self ):
         """ Get some sample of the geological rocks. """
         return {
-             "basement rocks" :            [1e99,1e6 ],
-             "igneous rocks":              [1e6, 1e3], 
+             "hard rock" :            [1e99,1e6 ],
+             "igneous rock":              [1e6, 1e3], 
              "duricrust"   :               [5.1e3 , 5.1e2],
              "gravel/sand" :               [1e4  , 7.943e0],
              "conglomerate"    :           [1e4  , 8.913e1],
              "dolomite/limestone" :        [1e5 ,  1e3],
             "permafrost"  :                [1e5  , 4.169e2],
-             "metamorphic rocks" :         [5.1e2 , 1e1],
+             "metamorphic rock" :         [5.1e2 , 1e1],
              "tills"  :                    [8.1e2 , 8.512e1],
              "standstone conglomerate" :   [1e4 , 8.318e1],
              "lignite/coal":               [7.762e2 , 1e1],
              "shale"   :                   [5.012e1 , 3.20e1],
              "clay"   :                    [1e2 ,  5.012e1],
              "saprolite" :                 [6.310e2 , 3.020e1],
-             "sedimentary rocks":          [1e4 , 1e0],
+             "sedimentary rock":          [1e4 , 1e0],
              "fresh water"  :              [3.1e2 ,1e0],
              "salt water"   :              [1e0 , 1.41e0],
              "massive sulphide" :          [1e0   ,  1e-2],
              "sea water"     :             [1.231e-1 ,1e-1],
              "ore minerals"  :             [1e0   , 1e-4],
              "graphite"    :               [3.1623e-2, 3.162e-3]
                 
@@ -1485,32 +1485,32 @@
                 x   - crossed diagonal
                 o   - small circle
                 O   - large circle
                 .   - dots
                 *   - stars
         """
         return  {
-             "basement rocks" :      ['.+++++.', (.25, .5, .5)],
-             "igneous rocks":        ['.o.o.', (1., 1., 1.)], 
+             "hard rock" :      ['.+++++.', (.25, .5, .5)],
+             "igneous rock":        ['.o.o.', (1., 1., 1.)], 
              "duricrust"   :         ['+.+',(1., .2, .36)],
              "gravel" :              ['oO',(.75,.86,.12)],
              "sand":                 ['....',(.23, .36, .45)],
              "conglomerate"    :     ['.O.', (.55, 0., .36)],
              "dolomite" :            ['.-.', (0., .75, .23)],
              "limestone" :           ['//.',(.52, .23, .125)],
             "permafrost"  :          ['o.', (.2, .26, .75)],
-             "metamorphic rocks" :   ['*o.', (.2, .2, .3)],
+             "metamorphic rock" :   ['*o.', (.2, .2, .3)],
              "tills"  :              ['-.', (.7, .6, .9)],
              "standstone ":          ['..', (.5, .6, .9)],
              "lignite coal":         ['+/.',(.5, .5, .4)],
              "coal":                 ['*.', (.8, .9, 0.)],
              "shale"   :             ['=', (0., 0., 0.7)],
              "clay"   :              ['=.',(.9, .8, 0.8)],
              "saprolite" :           ['*/',(.3, 1.2, .4)],
-             "sedimentary rocks":    ['...',(.25, 0., .25)],
+             "sedimentary rock":    ['...',(.25, 0., .25)],
              "fresh water"  :        ['.-.',(0., 1.,.2)],
              "salt water"   :        ['o.-',(.2, 1., .2)],
              "massive sulphide" :    ['.+O',(1.,.5, .5 )],
              "sea water"     :       ['.--',(.0, 1., 0.)],
              "ore minerals"  :       ['--|',(.8, .2, .2)],
              "graphite"    :         ['.++.',(.2, .7, .7)],
```

### Comparing `watex-0.2.4/watex/transformers.py` & `watex-0.2.5/watex/transformers.py`

 * *Files 0% similar despite different names*

```diff
@@ -1394,40 +1394,42 @@
     """ Featurize X with the cluster based on the KMeans featurization
     
     Parameters 
     -----------
     X : {array-like, sparse matrix} of shape (n_samples, n_features)
         Training vector, where `n_samples` is the number of samples and
         `n_features` is the number of features. 
-        Note ttaht when `n_components` is set, sparse matrix for `X` is not 
+        Note that when `n_components` is set, sparse matrix for `X` is not 
         acceptable. 
 
     y : array-like of shape (n_samples,)
         Target vector relative to X.
         
     n_clusters: int, default=7
        Number of initial clusters
        
     target_scale: float, default=5.0 
        Apply appropriate scaling and include it in the input data to k-means.
+       
     n_components: int, optional
        Number of components for reduced down the predictor X. It uses the PCA 
-       to reduce down dimension to the importance components. 
+       to reduce down dimension to the importance features. 
        
     model: :class:`KMeansFeaturizer`. 
        KMeasFeaturizer model. Model can be provided to featurize the 
-       test data seperated from the train data. 
+       test data separated from the train data. 
        
        .. versionadded:: 0.2.4 
        
     random_state: int, Optional 
        State for shuffling the data 
        
     split_X_y: bool, default=False, 
-       Split the X, y into train data and test data  according to the test_size 
+       Split the X, y into train data and test data  according to the test 
+       size 
        
     test_ratio: int, default=0.2 
        ratio to keep for a test data. 
        
     shuffle: bool, default=True
        Suffling the data set. 
        
@@ -1448,20 +1450,27 @@
     Returns 
     -------- 
     X, y : NDArray shape (m_samples, n_features +1) or \
         shape (m_samples, n_sparse_features)
         Returns NDArray of m_features plus the clusters features from KMF 
         feturization procedures. The `n_sparse_features` is created if 
         `to_sparse` is set to ``True``. 
-   X, y, KMFmodel: NDarray and KMF models 
+   X, y, model: NDarray and KMF models 
        Returns transformed array X and y and model if   ``return_model`` is 
        set to ``True``. 
    
       Array like train data X transformed  and test if `split_X_y` is set to 
       ``True``. 
+    X, Xtest, y, ytest: NDArray (KMF), ArrayLike 
+       Split tuple is returned when `split_X_y=True``.
+       
+    Note
+    -----
+    Everytimes ``return_model=True``, KMF model (:class:`KMeansFeaturizer`) 
+    is appended to the return results. 
     
     Examples 
     --------
     >>> import numpy as np 
     >>> from watex.transformers import featurize_X 
     >>> X = np.random.randn (12 , 7 ) ; y = np.arange(12 )
     >>> y[ y < 6 ]= 0 ; y [y >0 ]= 1  # for binary data 
@@ -1490,17 +1499,18 @@
     if return_model is ...:
         return_model =False 
     if to_sparse is ...:
         to_sparse =False 
     
     # if sparse convert X  to sparse matrix 
     if to_sparse: 
+        sparsity= str(sparsity).lower().strip() 
         d_sparsity  = dict ( csr =  sparse.csr_matrix , 
             coo=  sparse.coo_matrix ) 
-        sparse_func = sparse.coo_matrix  if str(sparsity) not in (
+        sparse_func = sparse.coo_matrix  if sparsity not in (
             'coo', 'csr')  else d_sparsity.get (sparsity ) 
     
     # reduce down feature to two. 
     kmf_data = []
     if n_components: 
         from watex.analysis import nPCA 
         X =nPCA (X, n_components = n_components  )
```

### Comparing `watex-0.2.4/watex/utils/__init__.py` & `watex-0.2.5/watex/utils/__init__.py`

 * *Files 8% similar despite different names*

```diff
@@ -44,28 +44,36 @@
     plot_confidence_in,
     plot_sfi, 
     get_distance,
     smooth1d, 
     smoothing, 
     rhophi2z, 
     qc, 
+    get_azimuth, 
+    
     )
 from .funcutils import ( 
     reshape, 
     to_numeric_dtypes, 
     smart_label_classifier, 
     remove_outliers,
     normalizer, 
     cleaner, 
     savejob, 
     random_selector, 
     interpolate_grid, 
     twinning, 
     random_sampling, 
-    replace_data
+    replace_data, 
+    storeOrwritehdf5
+    )
+from .geotools import ( 
+    smart_thickness_ranker , 
+    build_random_thickness, 
+    plot_stratalog, 
     )
 from .hydroutils import ( 
     select_base_stratum , 
     get_aquifer_section , 
     get_aquifer_sections, 
     get_unique_section, 
     get_compressed_vector, 
@@ -120,14 +128,15 @@
         select_feature_importances, 
         make_naive_pipe, 
         bi_selector, 
         get_target, 
         )
 except ImportError :pass 
 
+
 __all__=[
         'plotAnomaly', 
         'vesSelector', 
         'erpSelector', 
         'defineConductiveZone',
         'erpSmartDetector', 
         'makeCoords', 
@@ -219,12 +228,17 @@
         'smooth1d', 
         'smoothing', 
         'rhophi2z', 
         'twinning', 
         'random_sampling', 
         'plot_voronoi', 
         'plot_roc_curves', 
-        'replace_data'
+        'replace_data', 
+        'storeOrwritehdf5', 
+        'get_azimuth', 
+        'smart_thickness_ranker', 
+        'build_random_thickness',
+        'plot_stratalog'
         ]
```

### Comparing `watex-0.2.4/watex/utils/_array_api.py` & `watex-0.2.5/watex/utils/_array_api.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/utils/_arraytools.py` & `watex-0.2.5/watex/utils/_arraytools.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/utils/_dependency.py` & `watex-0.2.5/watex/utils/_dependency.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/utils/_openmp_helpers.pyx` & `watex-0.2.5/watex/utils/_openmp_helpers.pyx`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/utils/_packaging_version.py` & `watex-0.2.5/watex/utils/_packaging_version.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/utils/_set_gdal.py` & `watex-0.2.5/watex/utils/_set_gdal.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/utils/_show_versions.py` & `watex-0.2.5/watex/utils/_show_versions.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/utils/box.py` & `watex-0.2.5/watex/utils/box.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/utils/coreutils.py` & `watex-0.2.5/watex/utils/coreutils.py`

 * *Files 2% similar despite different names*

```diff
@@ -51,14 +51,15 @@
 )
 from .funcutils import (
     smart_format as smft,
     _isin , 
     _assert_all_types,
     accept_types,
     read_from_excelsheets,
+    to_numeric_dtypes, 
     reshape, 
     is_iterable, 
     is_in_if
     ) 
 from .gistools import (
     assert_lat_value,
     assert_lon_value,
@@ -2268,38 +2269,69 @@
                               )
     # for consitency delte all empty string in the list 
     sdata = list(filter (None, sdata ))
     
     return np.array(sdata )if arg=='station' else reshape (np.array(
         sdata ).astype(float))
 
-
 def read_data (
-        f:str | pathlib.PurePath, 
-        **read_kws
+    f:str | pathlib.PurePath, 
+    sanitize: bool= ..., 
+    reset_index: bool=..., 
+    verbose: bool= ..., 
+    **read_kws
  ) -> DataFrame: 
     """ Assert and read specific files and url allowed by the package
     
-    Readable files are systematically convert to a pandas dataframe frame.  
+    Readable files are systematically convert to a data frame.  
     
     Parameters 
     -----------
-    f : str, Path-like object 
-        File path or Pathlib object. Must contain a valid file name  and 
-        should be a readable file or url    
+    f: str, Path-like object 
+       File path or Pathlib object. Must contain a valid file name  and 
+       should be a readable file or url 
+        
+    sanitize: bool, default=False, 
+       Push a minimum sanitization of the data such as: 
+           - replace a non-alphabetic column items with a pattern '_' 
+           - cast data values to numeric if applicable 
+           - drop full NaN columns and rows in the data 
+    reset_index: bool, default=False, 
+      Reset index if full NaN columns are dropped after sanitization. 
+      
+      .. versionadded:: 0.2.5
+          Apply minimum data sanitization after reading data. 
+          
     read_kws: dict, 
-        Additional keywords arguments passed to pandas readable file keywords. 
+       Additional keywords arguments passed to pandas readable file keywords. 
         
     Returns 
     -------
     f: :class:`pandas.DataFrame` 
         A dataframe with head contents by default.  
+        
     """
+    if sanitize is ...: 
+        sanitize = False 
+
+    def min_sanitizer ( d, /):
+        """ Apply a minimum sanitization to the data `d`."""
+        d = to_numeric_dtypes(
+            d, sanitize_columns= True, drop_nan_columns= True, 
+            reset_index= False if reset_index is ... else reset_index, 
+            verbose = False if verbose  is ... else verbose , 
+            fill_pattern='_', drop_index = True,  
+                              )
+        return d 
+        
     if isinstance (f, pd.DataFrame): 
-        return f 
+        if sanitize: 
+            f = min_sanitizer (f)
+            
+        return  f 
     
     cpObj= Config().parsers 
     f= _check_readable_file(f)
     _, ex = os.path.splitext(f) 
     if ex.lower() not in tuple (cpObj.keys()):
         raise TypeError(f"Can only parse the {smft(cpObj.keys(), 'or')} files"
                         )
@@ -2308,19 +2340,23 @@
     except FileNotFoundError:
         raise FileNotFoundError (
             f"No such file in directory: {os.path.basename (f)!r}")
     except: 
         raise FileHandlingError (
             f" Can not parse the file : {os.path.basename (f)!r}")
 
+    if sanitize: 
+        f = min_sanitizer (f)
+        
     return f 
     
 def _check_readable_file (f): 
     """ Return file name from path objects """
-    msg =(f"Expects a Path-like object or URL, got: {type(f).__name__!r} ")
+    msg =(f"Expects a Path-like object or URL. Please, check your"
+          f" file: {os.path.basename(f)!r}")
     if not os.path.isfile (f): # force pandas read html etc 
         if not ('http://'  in f or 'https://' in f ):  
             raise TypeError (msg)
     elif not isinstance (f,  (str , pathlib.PurePath)): 
          raise TypeError (msg)
     if isinstance(f, str): f =f.strip() # for consistency 
     return f 
@@ -2375,14 +2411,16 @@
     except : 
         raise ResistivityError(
             "Data validation aborted! Missing resistivity values.")
     else : 
         # In the case, we got a multiple resistivity values 
         # corresponding to the different sounding values 
         index_rhoa = index_rhoa or 0 
+        # for consistency 
+        index_rhoa = int (index_rhoa )
         if ( not _is_arraylike_1d( rhoa) 
              and (
                  index_rhoa >= rhoa.shape[1]
                   or index_rhoa < 0 
                   ) 
             ): 
             warnings.warn(f"The index {index_rhoa} is out of the range."
```

### Comparing `watex-0.2.4/watex/utils/epsg.npy` & `watex-0.2.5/watex/utils/epsg.npy`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/utils/exmath.py` & `watex-0.2.5/watex/utils/exmath.py`

 * *Files 1% similar despite different names*

```diff
@@ -72,42 +72,208 @@
     fmt_text, 
     find_position_from_sa , 
     concat_array_from_list, 
     get_confidence_ratio,
     remove_outliers, 
     find_feature_positions,
     find_close_position,
+    ellipsis2false,    
     smart_format,
     is_iterable, 
     reshape,
     ismissing,
     fillNaN, 
-    spi, 
-                   
+    spi,       
 )
 from .validator import ( 
     _is_arraylike_1d, 
     _validate_ves_operator, 
     _assert_z_or_edi_objs, 
     _validate_tensor,
     _is_numeric_dtype,
     check_consistency_size,
     is_valid_dc_data,
     check_y,
     check_array,
-
+    assert_xy_in
     )
 
 try: import scipy.stats as spstats
 except: pass 
 
 _logger =watexlog.get_watex_logger(__name__)
 
 mu0 = 4 * np.pi * 1e-7 
 
+def get_azimuth (
+    xlon: str | ArrayLike, 
+    ylat: str| ArrayLike, 
+    *, 
+    data: DataFrame =None, 
+    utm_zone:str=None, 
+    projection:str='ll', 
+    isdeg:bool=True, 
+    mode:str='soft', 
+    extrapolate:bool =...,
+    view:bool=..., 
+    ): 
+    """Compute azimuth from coordinate locations ( latitude,  longitude). 
+    
+    If `easting` and `northing` are given rather than `longitude` and  
+    `latitude`, the projection should explicitely set to ``UTM`` to perform 
+    the ideal conversion. However if mode is set to `soft` (default), the type
+    of projection is automatically detected . Note that when UTM coordinates 
+    are provided, `xlon` and `ylat` fit ``easting`` and ``northing`` 
+    respectively.
+    
+    Parameters
+    -----------
+    xlon, ylat : Arraylike 1d or str, str 
+       ArrayLike of easting/longitude and arraylike of nothing/latitude. They 
+       should be one dimensional. In principle if data is supplied, they must 
+       be series.  If `xlon` and `ylat` are given as string values, the 
+       `data` must be supplied. xlon and ylat names must be included in the  
+       dataframe otherwise an error raises. 
+       
+    data: pd.DataFrame, 
+       Data containing x and y names. Need to be supplied when x and y 
+       are given as string names. 
+       
+    utm_zone: Optional, string
+       zone number and 'S' or 'N' e.g. '55S'. Default to the centre point
+       of coordinates points in the survey area. It should be a string (##N or ##S)
+       in the form of number and North or South hemisphere, 10S or 03N
+       
+    projection: str, ['utm'|'ll'] 
+       The coordinate system in which the data points for the profile is collected. 
+       when `mode='soft'`,  the auto-detection will be triggered and find the 
+       suitable coordinate system. However, it is recommended to explicitly 
+       provide projection when data is in UTM coordinates. 
+       Note that if `x` and `y` are composed of value greater than 180 degrees 
+       for longitude and 90 degrees for latitude, and method is still in 
+       the ``soft` mode, it should be considered as  longitude-latitude ``UTM``
+       coordinates system. 
+       
+    isdeg: bool, default=True 
+      By default xlon and xlat are in degree coordinates. If both arguments 
+      are given in radians, set to ``False`` instead. 
+      
+    mode: str , ['soft'|'strict']
+      ``strict`` mode does not convert any coordinates system to other at least
+      it is explicitly set to `projection` whereas the `soft` does.
+      
+    extrapolate: bool, default=False 
+      In principle, the azimuth is compute between two points. Thus, the number
+      of values computed for :math:`N` stations should  be  :math:`N-1`. To fit
+      values to match the number of size of the array, `extrapolate` should be 
+      ``True``. In that case, the first station holds a <<fake>> azimuth as 
+      the closer value computed from interpolation of all azimuths. 
+      
+    view: bool, default=False, 
+       Quick view of the azimuth. It is usefull especially when 
+       extrapolate is set to ``True``. 
+       
+    Return 
+    --------
+    azim: ArrayLike 
+       Azimuth computed from locations. 
+       
+    Examples 
+    ----------
+    >>> import watex as wx 
+    >>> from watex.utils.exmath import get_azimuth 
+    >>> # generate a data from ERP 
+    >>> data = wx.make_erp (n_stations =7 ).frame 
+    >>> get_azimuth ( data.longitude, data.latitude)
+    array([54.575, 54.575, 54.575, 54.575, 54.575, 54.575])
+    >>> get_azimuth ( data.longitude, data.latitude, view =True, extrapolate=True)
+    array([54.57500007, 54.575     , 54.575     , 54.575     , 54.575     ,
+           54.575     , 54.575     ])
+    
+    """
+    from ..site import Location 
+    
+    mode = str(mode).lower() 
+    projection= str(projection).lower()
+    extrapolate, view = ellipsis2false (extrapolate, view)
+
+    xlon , ylat = assert_xy_in(xlon , ylat , data = data )
+    
+    if ( 
+            xlon.max() > 180.  and ylat.max() > 90.  
+            and projection=='ll' 
+            and mode=='soft'
+            ): 
+        warnings.warn("xlon and ylat arguments are greater than 180 degrees."
+                     " we assume the coordinates are UTM. Set explicitly"
+                     " projection to ``UTM`` to avoid this warning.")
+        projection='utm'
+        
+    if projection=='utm':
+        if utm_zone is None: 
+            raise TypeError ("utm_zone cannot be None when projection is UTM.")
+            
+        ylat , xlon = Location.to_latlon_in(
+            xlon, ylat, utm_zone= utm_zone)
+        
+    if len(xlon) ==1 or len(ylat)==1: 
+        msg = "Azimuth computation expects at least two points. Got 1"
+        if mode=='soft': 
+            warnings.warn(msg) 
+            return 0. 
+        
+        raise TypeError(msg )
+    # convert to radian 
+    if isdeg: 
+        xlon = np.deg2rad (xlon ) ; ylat = np.deg2rad ( ylat)
+    
+    dx = map (lambda ii: np.cos ( ylat[ii]) * np.sin( ylat [ii+1 ]) - 
+        np.sin(ylat[ii]) * np.cos( ylat[ii+1]) * np.cos (xlon[ii+1]- xlon[ii]), 
+        range (len(xlon)-1)
+        )
+    dy = map( lambda ii: np.cos (ylat[ii+1])* np.sin( xlon[ii+1]- xlon[ii]), 
+                   range ( len(xlon)-1)
+                   )
+    # to deg 
+    z = np.around ( np.rad2deg ( np.arctan2(list(dx) , list(dy) ) ), 3)  
+    azim = z.copy() 
+    if extrapolate: 
+        # use mean azimum of the total area zone and 
+        # recompute the position by interpolation 
+        azim = np.hstack ( ( [z.mean(), z ]))
+        # reset the interpolare value at the first position
+        with warnings.catch_warnings():
+            #warnings.filterwarnings(action='ignore', category=OptimizeWarning)
+            warnings.simplefilter("ignore")
+            azim [0] = scalePosition(azim )[0][0] 
+        
+    if view: 
+        x = np.arange ( len(azim )) 
+        fig,  ax = plt.subplots (1, 1, figsize = (10, 4))
+        # add Nan to the first position of z 
+        z = np.hstack (([np.nan], z )) if extrapolate else z 
+       
+        ax.plot (x, 
+                 azim, 
+                 c='#0A4CEE',
+                 marker = 'o', 
+                 label ='extra-azimuth'
+                 ) 
+        
+        ax.plot (x, 
+                z, 
+                'ok-', 
+                label ='raw azimuth'
+                )
+        ax.legend ( ) 
+        ax.set_xlabel ('x')
+        ax.set_ylabel ('y') 
+
+    return azim
+
 def linkage_matrix(
     df: DataFrame ,
     columns:List[str] =None,  
     kind:str ='design', 
     metric:str ='euclidean',   
     method:str ='complete', 
     as_frame =False,
@@ -730,15 +896,14 @@
     # imaginary basement curve
     # fdummy (x) = slope (45degree) * x + intercept (beta)
     slope = np.sin(np.deg2rad(slope))
     func45 = lambda x: slope * x + beta 
     
     return func45, beta 
 
-
 def find_limit_for_integration(
         ix_arr: ArrayLike[DType[int]],
         b0: List[T] =[]
 )-> List[T]: 
     r""" Use the roots between f curve and basement curves to 
     detect the limit of integration.
     
@@ -765,15 +930,14 @@
             oc= v
         s= v 
     if v ==ix_arr[-1]: 
         b0.append(oc); b0.append(v)
         
     return b0 
 
-
 def find_bound_for_integration(
         ix_arr: ArrayLike[DType[int]],
         b0: List[T] =[]
 )-> List[T]: 
     r""" Recursive function to find the roots between f curve and basement 
     curves so to detect the  integration bounds. 
     
@@ -804,15 +968,14 @@
     b0.append(min(ix_arr[index]))
     b0.append(max(ix_arr[index]))
     #now take the max index and add +1 and start by this part 
     # retreived the values 
     array_init = ix_arr[int(max(index)) +1:]
     return b0 if len(
         array_init)==0 else find_bound_for_integration(array_init, b0)
- 
     
 def fitfunc(
         x: ArrayLike[T], 
         y: ArrayLike[T], 
         deg: float | int  =None,
         sample: int =1000
 )-> Tuple[F, ArrayLike[T]]: 
@@ -1245,15 +1408,14 @@
     for ii, ( obj , ix) in enumerate( zip(('ohms', 'graph'), [1, -1])): 
         if objective ==obj : 
             rv[ii + ix ]= (None, None, None)
             break 
 
     return rv
  
-
 def _type_mechanism (
         cz: ArrayLike |List[float],
         dipolelength : float =10.
 ) -> Tuple[str, float]: 
     """ Using the type mechanism helps to not repeat several time the same 
     process during the `type` definition. 
     
@@ -1668,15 +1830,14 @@
         plt.xlabel('x')
         plt.ylabel('y')
         plt.legend()
         plt.show()
         
     return ydata_new, popt, pcov 
 
-
 def __sves__ (
         s_index: int  , 
         cz: ArrayLike | List[float], 
 ) -> Tuple[ArrayLike, ArrayLike]: 
     """ Divide the conductive zone in leftzone and rightzone from 
     the drilling location index . 
 
@@ -1707,15 +1868,14 @@
     side =... 
     # find with positions 
     for _, sid  in zip((rmax_ls , rmax_rs ) , ('leftside', 'rightside')) : 
             side = sid ; break 
         
     return (rho_ls, side), (rmax_ls , rmax_rs )
 
-
 def detect_station_position (
         s : Union[str, int] ,
         p: SP, 
 ) -> Tuple [int, float]: 
     """ Detect station position and return the index in positions
     
     :param s: str, int - Station location  in the position array. It should 
@@ -1949,15 +2109,14 @@
     components = cz, p, xn, yn
     
     if view: 
         plot_(p,cz,'-ok', xn, yn, raw = raw , **plotkws)
         
     return (sfi_ , components) if return_components else sfi_ 
 
-
 def plot_sfi(
     cz: Sub[ArrayLike],
     p: Sub[SP[ArrayLike]] = None, 
     s: Optional [str] =None, 
     dipolelength: Optional [float]= None, 
     fig_size:tuple = (10, 4), 
     style:str='classic', 
@@ -2142,16 +2301,15 @@
     """ Manage the ohmic-area plot colors """
     c = c or default 
     if isinstance(c, str): 
         c= [c] 
     c = list(c) +  default 
     
     return c [:3] # return 3colors 
-
-        
+     
 @refAppender(refglossary.__doc__)
 def plot_ (
     *args : List [Union [str, ArrayLike, ...]],
     fig_size: Tuple[int] = None,
     raw : bool = False, 
     style : str = 'seaborn',   
     dtype: str  ='erp',
@@ -2303,24 +2461,21 @@
     if show_grid is not None: 
         # plt.minorticks_on()
         plt.grid (visible =True, which='both')
     plt.tight_layout()
     fig.suptitle(**fig_title_kws)
     plt.legend (leg, loc ='best') if leg  else plt.legend ()
     plt.show ()
-        
-    
+   
 def quickplot (arr: ArrayLike | List[float], dl:float  =10)-> None: 
     """Quick plot to see the anomaly"""
     
     plt.plot(np.arange(0, len(arr) * dl, dl), arr , ls ='-', c='k')
     plt.show() 
-    
-    
-
+ 
 def magnitude (cz:Sub[ArrayLike[float, DType[float]]] ) -> float: 
     r""" 
     Compute the magnitude of selected conductive zone. 
     
     The magnitude parameter is the absolute resistivity value between
     the minimum :math:`\min \rho_a` and maximum :math:`\max \rho_a` 
     value of selected anomaly:
@@ -2353,15 +2508,14 @@
     :param p: array-like. Station position of conductive zone.
     
     :return: Absolute value of the width of conductive zone in meters. 
     
     """
     return np.abs(p.min()- p.max()) 
 
-
 def _find_cz_bound_indexes (
     erp: Union[ArrayLike[float, DType[float]], List[float], pd.Series],
     cz: Union [Sub[ArrayLike], List[float]] 
 )-> Tuple[int, int]: 
     """ 
     Fetch the limits 'LB' and 'UB' of the selected conductive zone.
     
@@ -2386,15 +2540,14 @@
         raise ValueError ('Expected the conductive zone array being a '
                           'subset of the resistivity array.')
     # find the indexes using np.argwhere  
     cz_indexes = np.argwhere(np.isin(erp, cz)).ravel()
     
     return cz_indexes [0] , cz_indexes [-1] 
 
-
 def convert_distance_to_m(
         value:T ,
         converter:float =1e3,
         unit:str ='km'
 )-> float: 
     """ Convert distance from `km` to `m` or vice versa even a string 
     value is given.
@@ -2411,16 +2564,15 @@
                               )*converter if value.find(
                 'km')>=0 else float(value.replace('m', ''))
         except: 
             raise TypeError(f"Expected float not {type(value)!r}."
                )
             
     return value
-    
-    
+       
 def get_station_number (
         dipole:float,
         distance:float , 
         from0:bool = False,
         **kws
 )-> float: 
     """ Get the station number from dipole length and 
@@ -2545,15 +2697,14 @@
     conductive_zone = np.concatenate((lb, ub))
     # get the index of station number from the conductive zone.
     ix_stn, = np.where (conductive_zone == conductive_zone[stn])
     ix_stn = int(ix_stn[0]) if len(ix_stn)> 1 else  int(ix_stn)
     
     return  conductive_zone, conductive_zone[stn], ix_stn 
     
-
 #FR0: #CED9EF # (206, 217, 239)
 #FR1: #9EB3DD # (158, 179, 221)
 #FR2: #3B70F2 # (59, 112, 242) #repl rgb(52, 54, 99)
 #FR3: #0A4CEE # (10, 76, 238)
 
 def shortPlot (erp, cz=None): 
     """ 
@@ -2706,15 +2857,14 @@
         
         if sfi ==np.nan : 
                 sfi = - np.sqrt(2)
     except : 
 
         sfi = - np.sqrt(2)
   
-    
     return sfi
   
 def get_anomaly_ratio(erp: ArrayLike, czposix=None, cz = None, 
              cz_sfi= None,  raise_exception=True,  p=None, 
              e_spacing = None, **sfi_kws,
              ): 
     r""" Computes the selected anomaly ratio (ANR) from the whole ERP line.
@@ -5803,15 +5953,14 @@
     if to_deg: 
         # convert bearing to degree and make sure it 
         # is positive between 360 degree 
         b = ( np.rad2deg ( b) + 360 )% 360 
         
     return b 
 
-        
 def find_closest( arr, /, values ): 
     """Get the closest value in array  from given values.
     
     Parameters 
     -----------
     arr : Arraylike  
        Array to find the values
```

### Comparing `watex-0.2.4/watex/utils/funcutils.py` & `watex-0.2.5/watex/utils/funcutils.py`

 * *Files 4% similar despite different names*

```diff
@@ -41,14 +41,15 @@
     ArrayLike,
     F,
     T,
     List ,
     DataFrame, 
     Sub,
     NDArray, 
+    Text, 
     )
 from ..property import P
 from ..exceptions import ( 
     EDIError,
     ParameterNumberError, 
     )
 from ._dependency import import_optional_dependency
@@ -77,49 +78,59 @@
 except ImportError: 
     
     warnings.warn(_msg0)
     _logger.warning(_msg0)
     
     interp_import = False
     
-#-----
 
 def to_numeric_dtypes (
-    arr: NDArray | DataFrame, *, 
-    columns:List[str, ...] = None, 
-    return_feature_types:bool =False , 
-    missing_values:float = np.nan, 
-    pop_cat_features:bool=False, 
-    sanitize_columns:bool=False, 
-    regex: re | str =None, 
+    arr: NDArray|DataFrame, *, 
+    columns: List[str, ...]=None, 
+    return_feature_types: bool=... , 
+    missing_values: float=np.nan, 
+    pop_cat_features: bool=..., 
+    sanitize_columns: bool=..., 
+    regex: re|str=None, 
     fill_pattern: str=None, 
     drop_nan_columns: bool=True, 
-    how:str='all', 
-    reset_index:bool= False, 
+    how: str='all', 
+    reset_index: bool=..., 
     drop_index: bool=True, 
-    verbose:bool= False,
+    verbose: bool=...,
     )-> DataFrame : 
     """ Convert array to dataframe and coerce arguments to appropriate dtypes. 
     
+    Function includes additional tools to manipulate the transformed data 
+    such as: 
+    
+    - `pop_cat_features` to remove the categorical attributes, 
+    - `sanitize_columns` to clean the columns of the dataframe by removing 
+      the undesirable characters, 
+    - `drop_nan_columns` to drop all the columns and/or rows that contains 
+      full NaN, ...
+ 
     Parameters 
     -----------
-    arr: Ndarray or Dataframe, shape (M=samples, N=features)
-        Array of dataframe to create
+    arr: Ndarray or Dataframe, shape (m_samples, n_features)
+        Array of dataframe to create, to sanitize or to auto-detect
+        feature categories ( numerical or categorical).
         
     columns: list of str, optional 
         Usefull to create a dataframe when array is given. Be aware to fit the 
         number of array columns (shape[1])
         
     return_feature_types: bool, default=False, 
-        return the list of numerical and categorial features
-    missing_values: float: 
+        return the list of numerical and categorial features.
+    
+    missing_values: float, default='NaN' 
         Replace the missing or empty string if exist in the dataframe.
         
     pop_cat_features:bool, default=False, 
-        remove removes the categorial features  from the DataFrame.
+        remove the categorial features  from the DataFrame.
         
     sanitize_columns: bool, default=False, 
        remove undesirable character in the data columns using the default
        argument of `regex` parameters. 
        
        .. versionadded:: 0.1.9
        
@@ -183,14 +194,24 @@
     ... shape         object
         power        float64
         magnitude    float64
         dtype: object
         
     """
     from .validator import _is_numeric_dtype
+    
+    # pass ellipsis argument to False 
+    ( sanitize_columns, reset_index, verbose, return_feature_types, 
+     pop_cat_features ) = ellipsis2false(
+        sanitize_columns, reset_index, verbose, return_feature_types, 
+        pop_cat_features
+        )
+   
+    if not is_iterable (arr, exclude_string=True): 
+        raise TypeError("Expect array. Got {type (arr).__name__!r}")
 
     if hasattr ( arr, '__array__') and hasattr ( arr, 'columns'): 
         df = arr.copy()
         if columns is not None: 
             if verbose: 
                 print("Dataframe is passed. Columns should be replaced.")
             df =pd.DataFrame ( np.array ( arr), columns =columns )
@@ -3702,15 +3723,18 @@
     raise ValueError(
         "%r cannot be used to seed a numpy.random.RandomState instance" % seed
     )
 
 def is_iterable (
         y, /, exclude_string= False, transform = False , parse_string =False, 
         )->bool | list: 
-    """ Asserts iterable object and returns 'True' or 'False' 
+    """ Asserts iterable object and returns 'True' or 'False'
+    
+    Function can also transform a non-iterable object to an iterable if 
+    `transform` is set to ``True``.
     
     :param y: any, object to be asserted 
     :param exclude_string: bool, does not consider string as an iterable 
         object if `y` is passed as a string object. 
     :param transform: bool, transform  `y` to an iterable objects. But default 
         puts `y` in a list object. 
     :param parse_string: bool, parse string and convert the list of string 
@@ -3972,15 +3996,18 @@
             ) : 
         raise TypeError ("Expect an array or dataframe,"
                          f" not {type (d).__name__!r}")
         
     if hasattr (d, '__array__') and hasattr (d, "columns"): 
         # assert whether pytables is installed 
         import_optional_dependency ('tables') 
-        store = pd.HDFStore(str(fn) +'.h5' ,  **hdf5_kws)
+        # remove extension if exist.
+        fn = str(fn).replace ('.h5', "").replace(".hdf5", "")
+        # then store. 
+        store = pd.HDFStore(fn +'.h5' ,  **hdf5_kws)
         objname = objname or 'data'
         store[ str(objname) ] = d 
 
     
     elif not hasattr(d, '__array__'): 
         d = np.asarray(d) 
  
@@ -6017,16 +6044,21 @@
     sheet_names = list(map(
         lambda o: regex.sub('_', o).lower(), ddict.keys()))
 
     data = list(ddict.values ()) 
 
     return data, sheet_names      
  
-def key_checker ( keys: str , /,  valid_keys, regex = None, 
-                   pattern = None ): 
+def key_checker (
+    keys: str , /,  
+    valid_keys:List[str, ...], 
+    regex:re = None, 
+    pattern:str = None , 
+    deep_search:bool =...
+    ): 
     """check whether a give key exists in valid_keys and return a list if 
     many keys are found.
     
     Parameters 
     -----------
     keys: str, list of str 
        Key value to find in the valid_keys 
@@ -6039,14 +6071,20 @@
             
             >>> import re 
             >>> re.compile (r'[_#&*@!_,;\s-]\s*', flags=re.IGNORECASE)
             
     pattern: str, default = '[_#&*@!_,;\s-]\s*'
         The base pattern to split the text into a columns
         
+    deep_search: bool, default=False 
+       If deep-search, the key finder is no sensistive to lower/upper case 
+       or whether a numeric data is included. 
+       
+       .. versionadded:: 0.2.5 
+       
     Returns 
     --------
     keys: str, list , 
       List of keys that exists in the `valid_keys`. 
       
     Examples
     --------
@@ -6059,23 +6097,36 @@
     >>> key_checker('h502 h2601', valid_keys= ['h502', 'h253','h2601'])
     Out[70]: ['h502', 'h2601']
     >>> key_checker(['h502',  'h2601'], valid_keys= ['h502', 'h253','h2601'])
     Out[73]: ['h502', 'h2601']
     >>> key_checker(['h502',  'h2602'], valid_keys= ['h502', 'h253','h2601'])
     UserWarning: key 'h2602' is missing in ['h502', 'h2602']
     Out[82]: 'h502'
+    >>> key_checker(['502',  'H2601'], valid_keys= ['h502', 'h253','h2601'], 
+                    deep_search=True )
+    Out[57]: ['h502', 'h2601']
+    
     """
+    deep_search, =ellipsis2false(deep_search)
+
     _keys = copy.deepcopy(keys)
     valid_keys = is_iterable(valid_keys , exclude_string =True, transform =True )
     if isinstance ( keys, str): 
         pattern = pattern or '[_#&@!_+,;\s-]\s*'
         keys = str2columns (keys, regex = regex , pattern=pattern )
     # If iterbale object , save obj 
     # to improve error 
     kkeys = copy.deepcopy(keys)
+    
+    if deep_search: 
+        keys = key_search(keys, default_keys= valid_keys,deep=True, 
+                          raise_exception= True,
+                          )
+        
+        return keys[0] if len(keys)==1 else keys 
     # for consistency 
     keys = [ k for k in keys if ''.join(
         [ str(i) for i in valid_keys] ).find(k)>=0 ]
     
     # assertion error if key does not exist. 
     if len(keys)==0: 
         verb1, verb2 = ('', 'es') if len(kkeys)==1 else ('s', '') 
@@ -6245,30 +6296,38 @@
                                      default= classifiers, size =3 , 
                                      from_index =False  )
     ['SVC', 'LR', 'SVC']
     
     """
     if default==... or None : default =[]
     # for consistency 
-    default = list( is_iterable (default, exclude_string =True, transform =True ) ) 
+    default = list( is_iterable (default, exclude_string =True,
+                                 transform =True ) ) 
     
     if item not in ( ...,  None) : 
-         item = list( is_iterable( item , exclude_string =True , transform = True ) ) 
+         item = list( is_iterable( item , exclude_string =True ,
+                                  transform = True ) ) 
     else: item = [] 
     
     item += default[len(item):] if from_index else default 
     
     if size is not None: 
-        size = int (_assert_all_types(size, int, float, objname = "Item 'size'") )
+        size = int (_assert_all_types(size, int, float,
+                                      objname = "Item 'size'") )
         item = item [:size]
         
     return item
     
     
-def replace_data(X, y =None, n_times: int  = 1, axis = 0, reset_index :bool =...  ): 
+def replace_data(
+    X, y =None, 
+    n_times: int  = 1, 
+    axis = 0, 
+    reset_index :bool =...  
+    ): 
     """ Replace items in data :math:`n` times 
     
     Parameters 
     ----------
     X: Arraylike 1D or pd.DataFrame 
       Data to replace. Note Sparse matrices is not allowed. Use 
       :func:`random_sampling` instead. 
@@ -6320,15 +6379,14 @@
         
     if not hasattr (y, '__array__') and y is not None : 
         y = np.array(y)
 
     return concat_data ( X) if y is None else (
             concat_data( X) , concat_data(y))
         
-        
 def convert_value_in (v, /, unit ='m'): 
     """Convert value based on the reference unit.
     
     Parameters 
     ------------
     v: str, float, int, 
       value to convert 
@@ -6343,17 +6401,17 @@
        
     Examples 
     ---------
     >>> from watex.utils.funcutils import convert_value_in 
     >>> convert_value_in (20) 
     20.0
     >>> convert_value_in ('20mm') 
-    20000.0
-    >>> convert_value_in ('20kg', unit='g') 
     0.02
+    >>> convert_value_in ('20kg', unit='g') 
+    20000.0
     >>> convert_value_in ('20') 
     20.0
     >>> convert_value_in ('20m', unit='g')
     ValueError: Unknwon unit 'm'...
     """
     c= { 'k':1e3 , 
         'h':1e2 , 
@@ -6374,22 +6432,528 @@
         v = v.replace (unit, '')
 
     if unit not in c.keys(): 
         raise ValueError (
             f"Unknwon unit {unit!r}. Expect {smart_format(c.keys(), 'or' )}."
             f" Or rename the `unit` parameter maybe to {unit[-1]!r}.")
     
-    return float ( v)/ (c.get(unit) or 1e0) 
+    return float ( v) * (c.get(unit) or 1e0) 
+
+def split_list(lst:List[Any, ...],/,  val:int, fill_value:Any=None ):
+    """Module to extract a slice of elements from the list 
+    
+    Parameters 
+    ------------
+    lst: list, 
+      List composed of item elements 
+    val: int, 
+      Number of item to group by default. 
+      
+    Returns 
+    --------
+    group with slide items 
+    
+    Examples
+    --------
+    >>> from watex.utils.funcutils import split_list
+    >>> lst = [1, 2, 3, 4, 5, 6, 7, 8]
+    >>> val = 3
+    >>> print(split_list(lst, val))
+    [[1, 2, 3], [4, 5, 6], [7, 8]]
+ 
+    """
 
+    lst = is_iterable(lst , exclude_string =True , transform =True ) 
+    val = int ( _assert_all_types(val, int, float )) 
+    try: 
+        sl= [list(group) for key, group in itertools.groupby(
+                lst, lambda x: (x-1)//val)]
+    except: 
+        # when string is given 
+        sl= list(itertools.zip_longest(
+            *(iter(lst),)*val,fillvalue =fill_value),)
+    return sl 
+
+def key_search (
+    keys: str, /, 
+    default_keys: Text | List[str], 
+    regex :re=None, 
+    pattern :str=None, 
+    deep: bool =...,
+    raise_exception:bool=...
+    ): 
+    """Find key in a list of default keys and select the best match. 
+    
+    Parameters 
+    -----------
+    keys: str or list 
+       The string or a list of key. When multiple keys is passed as a string, 
+       use the space for key separating. 
+       
+    default_keys: str or list 
+       The likehood key to find. Can be a litteral text. When a litteral text 
+       is passed, it is better to provide the regex in order to skip some 
+       character to parse the text properly. 
+       
+    regex: `re` object,  
+        Regular expresion object. Regex is important to specify the kind
+        of data to parse. the default is:: 
+            
+            >>> import re 
+            >>> re.compile (r'[_#&*@!_,;\s-]\s*', flags=re.IGNORECASE)
+            
+    pattern: str, default = '[_#&*@!_,;\s-]\s*'
+        The base pattern to split the text into a columns. Pattern is 
+        important especially when some character are considers as a part of 
+        word but they are not a separator. For example a data columns with 
+        a name `'DH_Azimuth'`, if a pattern is not explicitely provided, 
+        the default pattern will parse as two separated word which is far 
+        from the expected results. 
+        
+    deep: bool, default=False 
+       Not sensistive to uppercase. 
+       
+    raise_exception: bool, default=False 
+       raise error when key is not find. 
+       
+    Return 
+    -------
+    list: list of valid keys or None if not find ( default) 
+    
+    
+    Examples
+    ---------
+    >>> from watex.utils.funcutils import key_search 
+    >>> key_search('h502-hh2601', default_keys= ['h502', 'h253','HH2601'])
+    Out[44]: ['h502']
+    >>> from watex.utils.funcutils import key_search 
+    >>> key_search('h502-hh2601', default_keys= ['h502', 'h253','HH2601'], 
+                   deep=True)
+    Out[46]: ['h502', 'HH2601']
+    >>> key_search('253', default_keys= ("I m here to find key among h502,
+                                             h253 and HH2601"))
+    Out[53]: ['h253'] 
+
+    """
+    deep, raise_exception = ellipsis2false(deep, raise_exception)
+    
+    if is_iterable(keys , exclude_string= True ): 
+        keys = ' '.join ( [str(k) for k in keys ]) 
+        
+    # for consisteny checker 
+    pattern = pattern or '[_#&@!_+,;\s-]\s*'
+    keys = str2columns ( keys , regex = regex , pattern = pattern ) 
+    kinit = copy.deepcopy(keys)
+    if is_iterable ( default_keys , exclude_string=True ): 
+        default_keys = ' '. join ( [ str(k) for k in default_keys ])
+        
+    # make a copy
+    dk_init =  str2columns(
+        default_keys, regex =regex , pattern = pattern )
+
+    if deep: 
+        keys= [str(it).lower() for it in keys  ]
+        default_keys = default_keys.lower() 
+
+    valid_keys =[]
+    for key in keys: 
+        vk = re.findall(rf'\b\w*{key}\w*\b', default_keys)
+        valid_keys.extend( vk )
+
+    # if deep take the real values in defaults keys. 
+    if deep and len(vk)!=0: 
+        # remake a list based on the parsing regex 
+        default_keys= str2columns(
+            default_keys, regex =regex , pattern = pattern )
+        for ii, vk in enumerate ( valid_keys) : 
+            ix = default_keys.index ( vk )
+            valid_keys [ii] = dk_init[ix ]
+
+    if raise_exception and len(valid_keys)==0: 
+        kverb ='s' if len(kinit)> 1 else ''
+        raise KeyError (f"key{kverb} {smart_format(kinit)} not found."
+                          f" Expect {smart_format(dk_init, 'or')}")
+    
+    return None if len(valid_keys)==0 else valid_keys 
 
+def repeat_item_insertion(text, /, pos, item ='', fill_value=''): 
+    """ Insert character in  text according from it position. 
+    
+    Parameters
+    -----------
+    v: text
+       Text 
+    pos: int 
+      position where the item must be insert. 
+    item: str, 
+      Item to insert at each position. 
+    fill_value: str, 
+      Does nothing special; fill the the last position. 
+    Returns
+    --------
+    text: str, 
+      New construct object. 
+      
+    Examples
+    ----------
+    >>> from watex.utils.funcutils import repeat_item_insertion
+    >>> repeat_item_insertion ( '0125356.45', pos=2, item=':' ) 
+    Out[65]: '01:25:35:6.45'
+    >>> repeat_item_insertion ( 'Function inserts car in text.', pos=10, item='TK' )
+    Out[69]: 'Function iTKnserts carTK in text.'
+    """
+    pos= _assert_all_types(pos, int, float, 
+                           objname=f'Position for {item} insertion')
+    # for consistency
+    lst = list( str(text)) 
+    # checher whether there is a decimal then remove it 
+    dec_part=[]
+    ent_part= lst
+    for i, it in enumerate ( lst)  :
+        if it =='.': 
+            ent_part, dec_part  = lst [:i],  lst[i:]
+            break 
+    # now split list
+    value = split_list(ent_part, val= pos , fill_value=fill_value) 
+    #value = split_list ( ent_part, 2)
+    #[[1, 2, 3], [4, 5, 6], [7, 8]]
+    join_lst= list (map ( lambda s : ''.join( s), value))
+    #[123, 456, 78]
+    #join with mark 
+    return f'{str(item)}'.join(join_lst) +''.join(dec_part)
+        
+def numstr2dms (
+    sdigit: str, /, 
+    sanitize: bool=True, 
+    func: F=None, 
+    args: tuple=(),  
+    regex: re=None,   
+    pattern: str=None, 
+    return_values: bool=..., 
+    **kws
+    ): 
+    """ Convert numerical digit string to DD:MM:SS
+    
+    Note that the any string digit for Minutes and seconds must be composed
+    of two values i.e the function accepts at least six digits, otherwise an 
+    error occurs. For instance the value between [0-9] must be prefixed by 0 
+    beforehand. Here is an example for designating 1degree-1min-1seconds::
+        
+        sdigit= 1'1'1" --> 01'01'01 or 010101
+        
+    where ``010101`` is the right arguments for ``111``. 
     
+    Parameters
+    -----------
+    sdigit: str, 
+      Digit string composing of unique values. 
+    func: Callable, 
+      Function uses to parse digit. Function must return a string values. 
+      Any other values should be convert to str 
+      
+    args: tuple
+      Function `func` positional arguments 
+      
+    regex: `re` object,  
+        Regular expresion object. Regex is important to specify the kind
+        of data to parse. the default is:: 
+            
+            >>> import re 
+            >>> re.compile (r'[_#&@!+,;:"\'\s-]\s*', flags=re.IGNORECASE) 
+            
+    pattern: str, default = '[_#&@!+,;:"\'\s-]\s*'
+      Specific pattern for sanitizing sdigit. For instance remove undesirable 
+      non-character. 
+      
+    sanitize:bool=default=True 
+       Remove undesirable character using the default argument of `pattern`
+       parameter. 
+       
+    return_values: bool, default=False, 
+       return the DD:MM:SS into a tuple of (DD,MM,SS)
     
+    Returns 
+    -------
+    sdigit/tuple: str, tuple 
+      DD:MM:SS or tuple of ( DD, MM, SS) 
+      
+    Examples
+    --------
+    >>> from watex.utils.funcutils import numstr2dms
+    >>> numstr2dms ("1134132.08")
+    Out[17]: '113:41:32.08
+    >>> numstr2dms ("13'41'32.08")
+    Out[18]: '13:41:32.08'
+    >>> numstr2dms ("11:34:13:2.08", return_values=True)
+    Out[19]: (113.0, 41.0, 32.08)
+            
+    """
+    # remove any character from the string digit
+    if return_values is ...:return_values=False 
+    sdigit= str(sdigit)
+    
+    if sanitize: 
+        pattern = pattern or '[_#&@!+,;:"\'\s-]\s*'
+        sdigit = re.sub(pattern , "", str(sdigit), flags=re.IGNORECASE)
+        
+    try : float (sdigit)
+    except: raise ValueError ("Wrong value. Expects a string-digit or digit."
+                              f" Got {sdigit!r}")
+    if callable (func): 
+        sdigit= func (sdigit, *args, **kws )
+        
+    # In the case there is'
+    decimal ='0'
+    # remove decimal
+    sdigit_list  = str(sdigit).split(".")
+    
+    if len(sdigit_list)==2: 
+        sdigit, decimal =sdigit_list
+        
+    if len(sdigit) < 6: 
+        raise ValueError(f"DMS expects at list six digits(DD:MM:SS)."
+                         f" Got {sdigit!r}")
+        
+    sec , sdigit = sdigit[-2:] , sdigit [:-2]
+    mm , sdigit = sdigit[-2:], sdigit [:-2]
+    deg = sdigit # the remain part 
+    # conca second ecimal 
+    sec +=f".{decimal}" 
+    
+    return tuple (map ( float, [deg, mm, sec]) ) if return_values \
+        else ':'.join([deg, mm, sec]) 
+
+    
+def storeOrwritehdf5 (
+    d, /, 
+    key:str= None, 
+    mode:str='a',  
+    kind: str=None, 
+    path_or_buf:str= None, 
+    encoding:str="utf8", 
+    csv_sep: str=",",
+    index: bool=..., 
+    columns: str |List[Any, ...]=None, 
+    sanitize_columns:bool=...,  
+    func: F= None, 
+    args: tuple=(), 
+    applyto: str|List[Any, ...]=None, 
+    **func_kwds, 
+    )->None|DataFrame: 
+    """ Store data to hdf5 or write data to csv file. 
     
+    Note that by default, the data is not store nor write and 
+    return data if frame or transform the Path-Like object to data frame. 
+
+    Parameters 
+    -----------
+    d: Dataframe, shape (m_samples, n_features)
+        data to store or write or sanitize.
+    key:str
+       Identifier for the group in the store.
+       
+    mode: {'a', 'w', 'r+'}, default 'a'
+       Mode to open file:
+    
+       - 'w': write, a new file is created (an existing file with the 
+                                          same name would be deleted).
+       - 'a': append, an existing file is opened for reading and writing, 
+         and if the file does not exist it is created.
+       - 'r+': similar to 'a', but the file must already exist.
+       
+    kind: str, {'store', 'write', None} , default=None 
+       Type of task to perform: 
+           
+       - 'store': Store data to hdf5
+       - 'write': export data to csv file.
+       - None: construct a dataframe if array is passed or sanitize it. 
+
+    path_or_buf: str or pandas.HDFStore, or str, path object, file-like \
+        object, or None, default=None 
+       File path or HDFStore object. String, path object
+       (implementing os.PathLike[str]), or file-like object implementing 
+       a write() function. If ``write=True`` and  None, the result is returned 
+       as a string. If a non-binary file object is passed, it should be 
+       opened with newline=" ", disabling universal newlines. If a binary 
+       file object is passed, mode might need to contain a 'b'.
+      
+    encoding: str, default='utf8'
+       A string representing the encoding to use in the output file, 
+       Encoding is not supported if path_or_buf is a non-binary file object. 
+
+    csv_sep: str, default=',', 
+       String of length 1. Field delimiter for the output file.
+       
+    index: bool, index =False, 
+       Write data to csv with index or not. 
+       
+    columns: list of str, optional 
+        Usefull to create a dataframe when array is passed. Be aware to fit 
+        the number of array columns (shape[1])
+        
+    sanitize_columns: bool, default=False, 
+       remove undesirable character in the data columns using the default
+       argument of `regex` parameters and fill pattern to underscore '_'. 
+       The default regex implementation is:: 
+           
+           >>> import re 
+           >>> re.compile (r'[_#&.)(*@!,;\s-]\s*', flags=re.IGNORECASE)
+           
+    func: callable, Optional 
+       A custom sanitizing function and apply to each columns of the dataframe.
+       If provide, the expected columns must be listed to `applyto` parameter.
+       
+    args: tuple, optional 
+       Positional arguments of the sanitizing columns 
+       
+    applyto: str or list of str, Optional 
+       The list of columns to apply the function ``func``. To apply the 
+       function to all columns, use the ``*`` instead. 
+       
+    func_kwds: dict, 
+       Keywords arguments of the sanitizing function ``func``. 
+       
+    Return 
+    -------
+    None or d: None of dataframe. 
+      returns None if `kind` is set to ``write`` or ``store`` otherwise 
+      return the dataframe. 
+  
+    Examples
+    --------
+    >>> from watex.utils.funcutils import storeOrwritehdf5
+    >>> from watex.datasets import load_bagoue 
+    >>> data = load_bagoue().frame 
+    >>> data.geol[:5]
+    0    VOLCANO-SEDIM. SCHISTS
+    1                  GRANITES
+    2                  GRANITES
+    3                  GRANITES
+    4          GEOSYN. GRANITES
+    Name: geol, dtype: object
+    >>> data = storeOrwritehdf5 ( data, sanitize_columns = True)
+    >>> data[['type', 'geol', 'shape']] # put all to lowercase
+      type                    geol shape
+    0   cp  volcano-sedim. schists     w
+    1   ec                granites     v
+    2   ec                granites     v
+    >>> # compute using func 
+    >>> def test_func ( a, times  , to_percent=False ): 
+            return ( a * times / 100)   if to_percent else ( a *times )
+    >>> data.sfi[:5]
+    0    0.388909
+    1    1.340127
+    2    0.446594
+    3    0.763676
+    4    0.068501
+    Name: sfi, dtype: float64
+    >>> d = storeOrwritehdf5 ( data,  func = test_func, args =(7,), applyto='sfi')
+    >>> d.sfi[:5] 
+    0    2.722360
+    1    9.380889
+    2    3.126156
+    3    5.345733
+    4    0.479507
+    Name: sfi, dtype: float64
+    >>> storeOrwritehdf5 ( data,  func = test_func, args =(7,),
+                          applyto='sfi', to_percent=True).sfi[:5]
+    0    0.027224
+    1    0.093809
+    2    0.031262
+    3    0.053457
+    4    0.004795
+    Name: sfi, dtype: float64
+    >>> # write data to hdf5 and outputs to current directory 
+    >>> storeOrwritehdf5 ( d, key='test0', path_or_buf= 'test_data.h5', 
+                          kind ='store')
+    >>> # export data to csv 
+    >>> storeOrwritehdf5 ( d, key='test0', path_or_buf= 'test_data', 
+                          kind ='export')
+    """
+    kind= key_search (str(kind), default_keys=(
+        "none", "store", "write", "export", "tocsv"), 
+        raise_exception=True , deep=True)[0]
+    
+    kind = "export" if kind in ('write', 'tocsv') else kind 
+    
+    if sanitize_columns is ...: 
+        sanitize_columns=False 
+    d = to_numeric_dtypes(d, columns=columns,sanitize_columns=sanitize_columns, 
+                          fill_pattern='_')
+   
+    # get categorical variables 
+    if ( sanitize_columns 
+        or func is not None
+        ): 
+        d, _, cf = to_numeric_dtypes(d, return_feature_types= True )
+        #( strip then pass to lower case all non-numerical data) 
+        # for minimum sanitization  
+        for cat in cf : 
+            d[cat]= d[cat].str.lower()
+            d[cat]= d[cat].str.strip()
+            
+    if func is not None: 
+        if not callable(func): 
+            raise TypeError(
+                f"Expect a callable for `func`. Got {type(func).__name__!r}")
+
+        if applyto is None:
+            raise ValueError("Need to specify the data column to apply"
+                             f"{func.__name__!r} to.")
+        
+        applyto = is_iterable( applyto, exclude_string=True,
+                               transform =True ) if applyto !="*" else d.columns 
+        # check whether the applyto columns are in data columns 
+        exist_features(d, applyto)
+        
+        # map each colum 
+        for col in applyto: 
+            d [col]=d[col].apply( func, args=args, **func_kwds )
+
+    # store in h5 file. 
+    if kind=='store':
+        if path_or_buf is None: 
+            print("Destination file is missing. Use 'data.h5' instead outputs"
+                  f" in the current directory {os.getcwd()}")
+            path_or_buf= 'data.h5'
+ 
+        d.to_hdf ( path_or_buf , key =key, mode =mode )
+    # export to csv file
+    if kind=="export": 
+        d.to_csv(path_or_buf, encoding = encoding  , sep=csv_sep , 
+                 index =False if index is ... else index   )
+        
+    return d if kind not in ("store", "export") else None 
+
+def ellipsis2false( *parameters  ): 
+    """ Turn all parameter arguments to False if ellipsis.
     
+    Note that the output arguments must be in the same order like the 
+    positional arguments. 
+ 
+    :param parameters: tuple 
+       List of parameters  
+    :return: tuple, same list of parameters passed ellipsis to ``False``. 
+       For a single parameters, uses the trailing comma for collecting 
+       the parameters 
+       
+    :example: 
+        >>> from watex.utils.funcutils import ellipsis2false 
+        >>> var, = ellipsis2false (...)
+        >>> var 
+        False
+        >>> data, sep , verbose = ellipsis2false ([2,3, 4], ',', ...)
+        >>> verbose 
+        False 
+    """
+    return tuple ( ( False  if param is  ... else param  
+                    for param in parameters) )  
+   
     
+
```

### Comparing `watex-0.2.4/watex/utils/gistools.py` & `watex-0.2.5/watex/utils/gistools.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/utils/hydroutils.py` & `watex-0.2.5/watex/utils/hydroutils.py`

 * *Files 0% similar despite different names*

```diff
@@ -141,8578 +141,8580 @@
 000008c0: 616e 6365 222c 200d 0a20 2020 2022 7661  ance", ..    "va
 000008d0: 6c69 6461 7465 5f6c 6162 656c 7322 2c20  lidate_labels", 
 000008e0: 0d0a 2020 2020 2272 656e 616d 655f 6c61  ..    "rename_la
 000008f0: 6265 6c73 5f69 6e22 2c20 0d0a 2020 2020  bels_in", ..    
 00000900: 2274 7261 6e73 6d69 7373 6962 696c 6974  "transmissibilit
 00000910: 7922 2c20 0d0a 2020 2020 2263 6174 6567  y", ..    "categ
 00000920: 6f72 697a 655f 7461 7267 6574 222c 200d  orize_target", .
-00000930: 0a20 2020 205d 0d0a 0d0a 232d 2d2d 2d2d  .    ]....#-----
+00000930: 0a20 2020 205d 0d0a 232d 2d2d 2d2d 2d2d  .    ]..#-------
 00000940: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000950: 2d2d 0d0a 5f70 6172 616d 5f64 6f63 7320  --.._param_docs 
-00000960: 3d20 446f 6373 7472 696e 6743 6f6d 706f  = DocstringCompo
-00000970: 6e65 6e74 732e 6672 6f6d 5f6e 6573 7465  nents.from_neste
-00000980: 645f 636f 6d70 6f6e 656e 7473 280d 0a20  d_components(.. 
-00000990: 2020 2063 6f72 653d 5f63 6f72 655f 646f     core=_core_do
-000009a0: 6373 5b22 7061 7261 6d73 225d 2c20 0d0a  cs["params"], ..
-000009b0: 2020 2020 290d 0a23 2d2d 2d2d 2d2d 2d2d      )..#--------
-000009c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000009d0: 0d0a 0d0a 6465 6620 6d61 6b65 5f4d 5853  ....def make_MXS
-000009e0: 5f6c 6162 656c 7320 280d 0a20 2020 2079  _labels (..    y
-000009f0: 5f74 7275 652c 200d 0a20 2020 2079 5f70  _true, ..    y_p
-00000a00: 7265 642c 200d 0a20 2020 2074 6872 6573  red, ..    thres
-00000a10: 686f 6c64 3d20 4e6f 6e65 2c20 0d0a 2020  hold= None, ..  
-00000a20: 2020 7369 6d69 6c61 725f 6c61 6265 6c73    similar_labels
-00000a30: 3d20 4e6f 6e65 2c20 0d0a 2020 2020 7365  = None, ..    se
-00000a40: 7020 3d4e 6f6e 652c 200d 0a20 2020 2070  p =None, ..    p
-00000a50: 7265 6669 7820 3d4e 6f6e 652c 200d 0a20  refix =None, .. 
-00000a60: 2020 206d 6574 686f 643d 276e 6169 7665     method='naive
-00000a70: 272c 200d 0a20 2020 2074 7261 696c 6572  ', ..    trailer
-00000a80: 3d22 2a22 2c0d 0a20 2020 2072 6574 7572  ="*",..    retur
-00000a90: 6e5f 6f62 6a3d 4661 6c73 652c 2020 0d0a  n_obj=False,  ..
-00000aa0: 2020 2020 2a2a 6b77 730d 0a20 2020 293a      **kws..   ):
-00000ab0: 200d 0a20 2020 2022 2222 2043 7265 6174   ..    """ Creat
-00000ac0: 6520 6120 4d69 7874 7572 6520 4c65 6172  e a Mixture Lear
-00000ad0: 6e69 6e67 2053 7472 6174 6567 7920 284d  ning Strategy (M
-00000ae0: 5853 2920 6c61 6265 6c73 2066 726f 6d20  XS) labels from 
-00000af0: 7472 7565 206c 6162 656c 7320 0d0a 2020  true labels ..  
-00000b00: 2020 2779 5f74 7275 6527 2061 6e64 2074    'y_true' and t
-00000b10: 6865 2070 7265 6469 6374 6564 204e 6169  he predicted Nai
-00000b20: 7665 2047 726f 7570 206f 6620 4171 7569  ve Group of Aqui
-00000b30: 6665 7220 284e 4741 2920 6c61 6265 6c73  fer (NGA) labels
-00000b40: 2027 795f 7072 6564 270d 0a20 2020 200d   'y_pred'..    .
-00000b50: 0a20 2020 2050 6172 616d 6574 6572 730d  .    Parameters.
-00000b60: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
-00000b70: 0d0a 2020 2020 795f 7472 7565 3a20 6172  ..    y_true: ar
-00000b80: 7261 792d 6c69 6b65 2031 642c 2070 616e  ray-like 1d, pan
-00000b90: 6461 732e 5365 7269 6573 200d 0a20 2020  das.Series ..   
-00000ba0: 2020 2020 2041 7272 6179 2063 6f6d 706f       Array compo
-00000bb0: 7365 6420 6f66 2076 616c 6964 206b 2d76  sed of valid k-v
-00000bc0: 616c 7565 7320 616e 6420 706f 7373 6962  alues and possib
-00000bd0: 6c65 206d 6973 7369 6e67 206b 2d76 616c  le missing k-val
-00000be0: 7565 732e 200d 0a20 2020 2020 2020 200d  ues. ..        .
-00000bf0: 0a20 2020 2079 5f70 7265 643a 2041 7272  .    y_pred: Arr
-00000c00: 6179 2d6c 696b 6520 3164 2c20 7061 6e64  ay-like 1d, pand
-00000c10: 6173 2e53 6572 6965 730d 0a20 2020 2020  as.Series..     
-00000c20: 2020 2041 7272 6179 2063 6f6d 706f 7369     Array composi
-00000c30: 6e67 2074 6865 2076 616c 6964 204e 4741  ng the valid NGA
-00000c40: 206c 6162 656c 732e 204e 6f74 6520 7468   labels. Note th
-00000c50: 6174 204e 4741 206c 6162 656c 7320 6973  at NGA labels is
-00000c60: 2020 6120 0d0a 2020 2020 2020 2020 7072    a ..        pr
-00000c70: 6564 6963 7465 6420 6c61 6265 6c73 206d  edicted labels m
-00000c80: 6f73 746c 7920 7573 696e 6720 7468 6520  ostly using the 
-00000c90: 756e 7375 7065 7276 6973 696e 6720 6c65  unsupervising le
-00000ca0: 6172 6e69 6e67 2e20 0d0a 2020 2020 2020  arning. ..      
-00000cb0: 2020 200d 0a20 2020 2074 6872 6573 686f     ..    thresho
-00000cc0: 6c64 3a20 666c 6f61 742c 2064 6566 6175  ld: float, defau
-00000cd0: 6c74 3d4e 6f6e 6520 0d0a 2020 2020 2020  lt=None ..      
-00000ce0: 2020 5468 6520 7468 7265 7368 6f6c 6420    The threshold 
-00000cf0: 6672 6f6d 2077 6869 6368 2c20 6c61 6265  from which, labe
-00000d00: 6c20 696e 2027 795f 7472 7565 2720 6361  l in 'y_true' ca
-00000d10: 6e20 6265 2063 6f6e 7369 6465 7265 6420  n be considered 
-00000d20: 200d 0a20 2020 2020 2020 2073 696d 696c   ..        simil
-00000d30: 6172 2074 6861 6e20 7468 6520 6f6e 6520  ar than the one 
-00000d40: 696e 204e 4741 206c 6162 656c 7320 2779  in NGA labels 'y
-00000d50: 5f70 7265 6427 2e20 5468 6520 6465 6661  _pred'. The defa
-00000d60: 756c 7420 6973 2027 4e6f 6e65 2720 7768  ult is 'None' wh
-00000d70: 6963 6820 0d0a 2020 2020 2020 2020 6d65  ich ..        me
-00000d80: 616e 7320 6e6f 6e65 2072 756c 6520 6973  ans none rule is
-00000d90: 2063 6f6e 7369 6465 7265 6420 616e 6420   considered and 
-00000da0: 7468 6520 6869 6768 2070 7265 706f 6e64  the high prepond
-00000db0: 6572 656e 6365 206f 7220 6f63 6375 7265  erence or occure
-00000dc0: 6e63 6520 0d0a 2020 2020 2020 2020 696e  nce ..        in
-00000dd0: 2074 6865 2064 6174 6120 636f 6d70 6172   the data compar
-00000de0: 6564 2074 6f20 6f74 6865 7220 6c61 6265  ed to other labe
-00000df0: 6c73 2069 7320 636f 6e73 6964 6572 6564  ls is considered
-00000e00: 2061 7320 7468 6520 6d6f 7374 200d 0a20   as the most .. 
-00000e10: 2020 2020 2020 2072 6570 7265 7365 6e74         represent
-00000e20: 6174 6976 6520 2061 6e64 2073 696d 696c  ative  and simil
-00000e30: 6172 2e20 5365 7474 696e 6720 7468 6520  ar. Setting the 
-00000e40: 7275 6c65 2069 6e73 7465 6164 2062 7920  rule instead by 
-00000e50: 6669 7869 6e67 200d 0a20 2020 2020 2020  fixing ..       
-00000e60: 2074 6865 2074 6872 6573 686f 6c64 2069   the threshold i
-00000e70: 7320 7265 636f 6d6d 656e 6465 6420 6573  s recommended es
-00000e80: 7065 6369 616c 6c79 2069 6e20 6120 6875  pecially in a hu
-00000e90: 6765 2064 6174 6173 6574 2e0d 0a20 2020  ge dataset...   
-00000ea0: 2020 2020 200d 0a20 2020 2073 696d 696c       ..    simil
-00000eb0: 6172 5f6c 6162 656c 733a 206c 6973 7420  ar_labels: list 
-00000ec0: 6f66 2074 7570 6c65 2c20 6f70 7469 6f6e  of tuple, option
-00000ed0: 616c 2020 200d 0a20 2020 2020 2020 206c  al   ..        l
-00000ee0: 6973 7420 6f66 2074 7570 6c65 2069 6e20  ist of tuple in 
-00000ef0: 7061 6972 2028 6c61 6265 6c20 616e 6420  pair (label and 
-00000f00: 7369 6d69 6c61 7220 6772 6f75 7029 2e20  similar group). 
-00000f10: 4966 2067 6976 656e 2c20 7468 6520 7369  If given, the si
-00000f20: 6d69 6c61 7220 0d0a 2020 2020 2020 2020  milar ..        
-00000f30: 6772 6f75 7020 6d75 7374 2062 6520 7468  group must be th
-00000f40: 6520 6c61 6265 6c20 6578 6973 7469 6e67  e label existing
-00000f50: 2069 6e20 7468 6520 7072 6564 6963 7465   in the predicte
-00000f60: 6420 4e47 412e 2049 6620 6060 4e6f 6e65  d NGA. If ``None
-00000f70: 6060 2c20 0d0a 2020 2020 2020 2020 7468  ``, ..        th
-00000f80: 6520 6175 746f 2d73 696d 696c 6172 6974  e auto-similarit
-00000f90: 7920 6973 2074 7269 6767 6572 6564 2e20  y is triggered. 
-00000fa0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00000fb0: 7365 703a 2073 7472 2c20 6465 6661 756c  sep: str, defaul
-00000fc0: 7427 2720 0d0a 2020 2020 2020 2020 5365  t'' ..        Se
-00000fd0: 7061 7261 746f 7220 6265 7477 6565 6e20  parator between 
-00000fe0: 7468 6520 7472 7565 206c 6162 656c 7320  the true labels 
-00000ff0: 2779 5f74 7275 6527 2061 6e64 2070 7265  'y_true' and pre
-00001000: 6469 6374 6564 204e 4741 206c 6162 656c  dicted NGA label
-00001010: 732e 0d0a 2020 2020 2020 2020 5365 7020  s...        Sep 
-00001020: 6973 2075 7365 6420 746f 2072 6577 7269  is used to rewri
-00001030: 7465 2074 6865 204d 5853 206c 6162 656c  te the MXS label
-00001040: 732e 204d 6f73 746c 7920 7468 6520 4d58  s. Mostly the MX
-00001050: 5320 6c61 6265 6c73 2069 7320 6120 0d0a  S labels is a ..
-00001060: 2020 2020 2020 2020 636f 6d62 696e 6169          combinai
-00001070: 736f 6e20 7769 7468 2074 6865 2074 7275  son with the tru
-00001080: 6520 6c61 6265 6c20 6f66 2070 6572 6d65  e label of perme
-00001090: 6162 696c 6974 7920 636f 6566 6669 6369  ability coeffici
-000010a0: 656e 7420 276b 2720 616e 6420 0d0a 2020  ent 'k' and ..  
-000010b0: 2020 2020 2020 7468 6520 6c61 6265 6c20        the label 
-000010c0: 6f66 204e 4741 2074 6f20 636f 6d70 6f73  of NGA to compos
-000010d0: 6520 6e65 7720 7369 6d69 6c61 7269 7479  e new similarity
-000010e0: 206c 6162 656c 732e 2046 6f72 2069 6e73   labels. For ins
-000010f0: 7461 6e63 6520 0d0a 2020 2020 2020 2020  tance ..        
-00001100: 0d0a 2020 2020 2020 2020 3e3e 3e20 7472  ..        >>> tr
-00001110: 7565 5f6c 6162 656c 733d 5b27 6b31 272c  ue_labels=['k1',
-00001120: 2027 6b32 272c 2027 6b33 275d 203b 204e   'k2', 'k3'] ; N
-00001130: 4741 5f6c 6162 656c 7320 3d5b 2749 4927  GA_labels =['II'
-00001140: 2c20 2749 272c 2027 4956 275d 0d0a 2020  , 'I', 'IV']..  
-00001150: 2020 2020 2020 3e3e 3e20 2320 6769 7665        >>> # give
-00001160: 7320 0d0a 2020 2020 2020 2020 3e3e 3e20  s ..        >>> 
-00001170: 4d58 535f 6c61 6265 6c73 3d20 5b27 6b31  MXS_labels= ['k1
-00001180: 5f49 4927 2c20 276b 325f 4927 2c20 276b  _II', 'k2_I', 'k
-00001190: 335f 4956 275d 0d0a 2020 2020 0d0a 2020  3_IV']..    ..  
-000011a0: 2020 2020 2020 7768 6572 6520 7468 6520        where the 
-000011b0: 7365 7065 7261 746f 7220 6073 6570 6020  seperator `sep` 
-000011c0: 6973 2073 6574 2074 6f20 6060 5f60 602e  is set to ``_``.
-000011d0: 2054 6869 7320 6861 7070 656e 7320 6573   This happens es
-000011e0: 7065 6369 616c 6c79 200d 0a20 2020 2020  pecially ..     
-000011f0: 2020 2077 6865 6e20 6f6e 6520 6f66 2074     when one of t
-00001200: 6865 206c 6162 656c 2028 4e47 4120 6f72  he label (NGA or
-00001210: 2074 7275 655f 6c61 6265 6c73 2920 6973   true_labels) is
-00001220: 206e 6f74 2061 206e 756d 6572 6963 2064   not a numeric d
-00001230: 6174 6174 7970 6520 0d0a 2020 2020 2020  atatype ..      
-00001240: 2020 616e 6420 6120 7369 6d69 6c61 7269    and a similari
-00001250: 7920 6973 2066 6f75 6e64 2062 6574 7765  y is found betwe
-00001260: 656e 2027 6b31 2720 616e 6420 2749 4927  en 'k1' and 'II'
-00001270: 2c20 276b 3227 2061 6e64 2027 4927 2061  , 'k2' and 'I' a
-00001280: 6e64 2073 6f20 6f6e 2e0d 0a20 2020 2020  nd so on...     
-00001290: 2020 200d 0a20 2020 2070 7265 6669 783a     ..    prefix:
-000012a0: 2073 7472 2c20 6465 6661 756c 743d 2727   str, default=''
-000012b0: 0d0a 2020 2020 2020 2020 7072 6566 6978  ..        prefix
-000012c0: 2069 7320 7573 6564 2074 6f20 7265 6e61   is used to rena
-000012d0: 6d65 2074 6865 2074 7275 655f 6c61 6265  me the true_labe
-000012e0: 6c73 2069 2e65 2074 6865 2074 7275 6520  ls i.e the true 
-000012f0: 7661 6c69 642d 6b2e 2046 6f72 0d0a 2020  valid-k. For..  
-00001300: 2020 2020 2020 696e 7374 616e 6365 3a3a        instance::
-00001310: 0d0a 2020 2020 2020 2020 2020 2020 3e3e  ..            >>
-00001320: 3e20 6b5f 7661 6c69 6420 3d5b 312c 2032  > k_valid =[1, 2
-00001330: 2c20 2e2e 5d20 2d3e 206b 5f6e 6577 203d  , ..] -> k_new =
-00001340: 205b 6b31 2c20 6b32 2c20 2e2e 2e5d 0d0a   [k1, k2, ...]..
-00001350: 2020 2020 2020 2020 7768 6572 6520 276b          where 'k
-00001360: 2720 6973 2074 6865 2070 7265 6669 782e  ' is the prefix.
-00001370: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-00001380: 206d 6574 686f 643a 2073 7472 205b 276e   method: str ['n
-00001390: 6169 7665 272c 2027 7374 7269 6374 275d  aive', 'strict']
-000013a0: 2c20 6465 6661 756c 743d 276e 6169 7665  , default='naive
-000013b0: 270d 0a20 2020 2020 2020 2054 6865 206b  '..        The k
-000013c0: 696e 6420 6f66 2073 7472 6174 6567 7920  ind of strategy 
-000013d0: 746f 2063 6f6d 7075 7465 2074 6865 2072  to compute the r
-000013e0: 6570 7265 7365 6e74 6174 6976 6974 7920  epresentativity 
-000013f0: 6f66 2061 206c 6162 656c 200d 0a20 2020  of a label ..   
-00001400: 2020 2020 2069 6e20 7468 6520 7072 6564       in the pred
-00001410: 6963 7465 6420 6172 7261 7920 2779 5f70  icted array 'y_p
-00001420: 7265 6427 2e20 4974 2063 616e 2061 6c73  red'. It can als
-00001430: 6f20 6265 2027 7374 7269 6374 272e 2049  o be 'strict'. I
-00001440: 6e64 6565 643a 0d0a 2020 2020 2020 2020  ndeed:..        
-00001450: 0d0a 2020 2020 2020 2020 2d20 6060 6e61  ..        - ``na
-00001460: 6976 6560 6020 636f 6d70 7574 6573 2074  ive`` computes t
-00001470: 6865 2069 6d70 6f72 7461 6e63 6520 6f66  he importance of
-00001480: 2074 6865 206c 6162 656c 2062 7920 7468   the label by th
-00001490: 6520 6e75 6d62 6572 206f 6620 6974 730d  e number of its.
-000014a0: 0a20 2020 2020 2020 2020 2020 206f 6363  .            occ
-000014b0: 7572 656e 6365 2066 6f72 2074 6869 7320  urence for this 
-000014c0: 7370 6563 6966 6963 206c 6162 656c 2069  specific label i
-000014d0: 6e20 7468 6520 6172 7261 7920 2779 5f74  n the array 'y_t
-000014e0: 7275 6527 2e20 4974 2064 6f65 7320 6e6f  rue'. It does no
-000014f0: 7420 0d0a 2020 2020 2020 2020 2020 2020  t ..            
-00001500: 7461 6b65 2069 6e74 6f20 6163 636f 756e  take into accoun
-00001510: 7420 6f66 2074 6865 206f 6363 7572 656e  t of the occuren
-00001520: 6365 206f 6620 6f74 6865 7220 6578 6973  ce of other exis
-00001530: 7469 6e67 206c 6162 656c 732e 2054 6869  ting labels. Thi
-00001540: 7320 0d0a 2020 2020 2020 2020 2020 2020  s ..            
-00001550: 6973 2075 7365 6675 6c6c 2066 6f72 2075  is usefull for u
-00001560: 6e62 616c 616e 6365 6420 636c 6173 7320  nbalanced class 
-00001570: 6c61 6265 6c73 2069 6e20 6079 5f74 7275  labels in `y_tru
-00001580: 6560 2e0d 0a20 2020 2020 2020 202d 2060  e`...        - `
-00001590: 6073 7472 6963 7460 6020 636f 6d70 7574  `strict`` comput
-000015a0: 6573 2074 6865 2069 6d70 6f72 7461 6e63  es the importanc
-000015b0: 6520 6f66 2074 6865 206c 6162 656c 2062  e of the label b
-000015c0: 7920 7468 6520 6e75 6d62 6572 206f 6620  y the number of 
-000015d0: 0d0a 2020 2020 2020 2020 2020 2020 6f63  ..            oc
-000015e0: 6375 7265 6e63 6520 696e 2074 6865 2077  curence in the w
-000015f0: 686f 6c65 2076 616c 6964 2060 795f 7472  hole valid `y_tr
-00001600: 7565 6020 692e 652e 2075 6e64 6572 2074  ue` i.e. under t
-00001610: 6865 2074 6f74 616c 206f 6620 0d0a 2020  he total of ..  
-00001620: 2020 2020 2020 2020 2020 6f63 6375 7265            occure
-00001630: 6e63 6520 6f66 2061 6c6c 2074 6865 206c  nce of all the l
-00001640: 6162 656c 7320 7468 6174 2065 7869 7374  abels that exist
-00001650: 2069 6e20 7468 6520 7768 6f6c 6520 2761   in the whole 'a
-00001660: 7272 5f61 7127 2e20 0d0a 2020 2020 2020  rr_aq'. ..      
-00001670: 2020 2020 2020 5468 6973 2063 616e 2067        This can g
-00001680: 6976 6520 6120 7375 6974 6162 6c65 2061  ive a suitable a
-00001690: 6e61 796c 7365 2072 6573 756c 7473 2069  naylse results i
-000016a0: 6620 7468 6520 6461 7461 2069 7320 6e6f  f the data is no
-000016b0: 7420 0d0a 2020 2020 2020 2020 2020 2020  t ..            
-000016c0: 756e 6261 6c61 6e63 6564 2066 6f72 2065  unbalanced for e
-000016d0: 6163 6820 6c61 6265 6c73 2069 6e20 6079  ach labels in `y
-000016e0: 5f70 7265 6460 2e0d 0a20 2020 2020 2020  _pred`...       
-000016f0: 2020 2020 200d 0a20 2020 2074 7261 696c       ..    trail
-00001700: 6572 3a20 7374 722c 2064 6566 6175 6c74  er: str, default
-00001710: 3d27 2a27 0d0a 2020 2020 2020 2020 5468  ='*'..        Th
-00001720: 6520 4d69 7874 7572 6520 7374 7261 7465  e Mixture strate
-00001730: 6779 206d 6172 6b65 7220 746f 2064 6966  gy marker to dif
-00001740: 6665 7265 6e74 6961 7465 2074 6865 2065  ferentiate the e
-00001750: 7869 7374 696e 6720 636c 6173 7320 6c61  xisting class la
-00001760: 6265 6c20 200d 0a20 2020 2020 2020 2069  bel  ..        i
-00001770: 6e20 2779 5f74 7275 6527 2077 6974 6820  n 'y_true' with 
-00001780: 7468 6520 7072 6564 6963 7465 6420 6c61  the predicted la
-00001790: 6265 6c73 2027 795f 7072 6564 2720 6573  bels 'y_pred' es
-000017a0: 7065 6369 616c 6c79 2077 6865 6e20 200d  pecially when  .
-000017b0: 0a20 2020 2020 2020 2074 6865 2073 616d  .        the sam
-000017c0: 6520 636c 6173 7320 6c61 6265 6c73 2061  e class labels a
-000017d0: 7265 2061 6c73 6f20 7072 6573 656e 7420  re also present 
-000017e0: 7468 6520 7472 7565 206c 6162 656c 2077  the true label w
-000017f0: 6974 6820 7468 6520 0d0a 2020 2020 2020  ith the ..      
-00001800: 2020 7361 6d65 206c 6162 656c 2d69 6465    same label-ide
-00001810: 6e74 6966 6965 7220 6e61 6d65 2e20 5468  ntifier name. Th
-00001820: 6973 2075 7365 6675 6c6c 2020 746f 2061  is usefull  to a
-00001830: 766f 6964 2061 6e79 2063 6f6e 6675 7369  void any confusi
-00001840: 6f6e 2020 666f 720d 0a20 2020 2020 2020  on  for..       
-00001850: 2062 6f74 6820 6c61 6265 6c73 2020 696e   both labels  in
-00001860: 2060 795f 7472 7565 6020 616e 6420 6079   `y_true` and `y
-00001870: 5f70 7265 6460 2066 6f72 2062 6574 7465  _pred` for bette
-00001880: 7220 6465 6d61 7263 6174 696f 6e20 616e  r demarcation an
-00001890: 6420 0d0a 2020 2020 2020 2020 6469 7374  d ..        dist
-000018a0: 696e 6374 696f 6e2e 204e 6f74 6520 7468  inction. Note th
-000018b0: 6174 2069 6620 7468 6520 6074 7261 696c  at if the `trail
-000018c0: 6572 6069 7320 7365 7420 746f 2060 604e  er`is set to ``N
-000018d0: 6f6e 6560 6020 616e 6420 626f 7468 200d  one`` and both .
-000018e0: 0a20 2020 2020 2020 2060 795f 7472 7565  .        `y_true
-000018f0: 6020 616e 6420 6079 5f70 7265 6460 2061  ` and `y_pred` a
-00001900: 7265 206e 756d 6572 6963 2064 6174 612c  re numeric data,
-00001910: 2074 6865 206c 6162 656c 7320 696e 2060   the labels in `
-00001920: 795f 7072 6564 6020 6172 6520 0d0a 2020  y_pred` are ..  
-00001930: 2020 2020 2020 7379 7374 656d 6174 6963        systematic
-00001940: 616c 6c79 2072 656e 616d 6564 2074 6f20  ally renamed to 
-00001950: 6265 2064 6973 7469 6e63 7420 7769 7468  be distinct with
-00001960: 2074 6865 206f 6e65 7320 696e 2074 6865   the ones in the
-00001970: 2027 795f 7472 7565 272e 200d 0a20 2020   'y_true'. ..   
-00001980: 2020 2020 2046 6f72 2069 6e73 7461 6e63       For instanc
-00001990: 6520 3a3a 200d 0a20 2020 2020 2020 2020  e :: ..         
-000019a0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-000019b0: 203e 3e3e 2074 7275 655f 6c61 6265 6c73   >>> true_labels
-000019c0: 3d5b 312c 2032 2c20 335d 203b 204e 4741  =[1, 2, 3] ; NGA
-000019d0: 5f6c 6162 656c 7320 3d5b 302c 2031 2c20  _labels =[0, 1, 
-000019e0: 325d 0d0a 2020 2020 2020 2020 2020 2020  2]..            
-000019f0: 3e3e 3e20 2320 7769 7468 2074 7261 696c  >>> # with trail
-00001a00: 6572 202c 204d 5853 206c 6162 656c 7320  er , MXS labels 
-00001a10: 7368 6f75 6c64 2062 6520 0d0a 2020 2020  should be ..    
-00001a20: 2020 2020 2020 2020 3e3e 3e20 204d 5853          >>>  MXS
-00001a30: 5f6c 6162 656c 733d 205b 2730 272c 2027  _labels= ['0', '
-00001a40: 312a 272c 2027 322a 272c 2027 3327 5d20  1*', '2*', '3'] 
-00001a50: 2320 3120 616e 6420 3220 6172 6520 696e  # 1 and 2 are in
-00001a60: 2074 7275 655f 6c61 6265 6c73 200d 0a20   true_labels .. 
-00001a70: 2020 2020 2020 2020 2020 203e 3e3e 2023             >>> #
-00001a80: 2077 6974 6820 6e6f 2074 7261 696c 6572   with no trailer
-00001a90: 200d 0a20 2020 2020 2020 2020 2020 203e   ..            >
-00001aa0: 3e3e 204d 5853 5f6c 6162 656c 733d 205b  >> MXS_labels= [
-00001ab0: 302c 2034 2c20 352c 2033 5d20 2320 3120  0, 4, 5, 3] # 1 
-00001ac0: 616e 6420 3220 6861 7665 2062 6565 6e20  and 2 have been 
-00001ad0: 6368 616e 6765 6420 746f 205b 342c 2035  changed to [4, 5
-00001ae0: 5d0d 0a20 2020 2020 2020 2020 2020 200d  ]..            .
-00001af0: 0a20 2020 2072 6574 7572 6e5f 6f62 6a3a  .    return_obj:
-00001b00: 203a 636c 6173 733a 6077 6174 6578 2e75   :class:`watex.u
-00001b10: 7469 6c73 2e62 6f78 2e42 6f78 7370 6163  tils.box.Boxspac
-00001b20: 6560 0d0a 2020 2020 2020 2020 4966 2060  e`..        If `
-00001b30: 6054 7275 6560 602c 2072 6574 7572 6e73  `True``, returns
-00001b40: 2061 204d 5853 206f 626a 6563 7420 7769   a MXS object wi
-00001b50: 7468 2075 7365 6675 6c6c 2061 7474 7269  th usefull attri
-00001b60: 6275 7465 7320 7375 6368 2061 733a 200d  butes such as: .
-00001b70: 0a20 2020 2020 2020 2020 2020 202d 206d  .            - m
-00001b80: 7873 5f63 6c61 7373 6573 5f20 3d20 7468  xs_classes_ = th
-00001b90: 6520 4d58 5320 636c 6173 7320 6c61 6265  e MXS class labe
-00001ba0: 6c73 200d 0a20 2020 2020 2020 2020 2020  ls ..           
-00001bb0: 202d 206d 7873 5f6c 6162 656c 735f 3d20   - mxs_labels_= 
-00001bc0: 2074 6865 2061 7272 6179 2d6c 696b 6520   the array-like 
-00001bd0: 6f66 204d 5853 206c 6162 656c 732e 2049  of MXS labels. I
-00001be0: 7420 616c 736f 2069 6e63 6c75 6465 7320  t also includes 
-00001bf0: 736f 6d65 0d0a 2020 2020 2020 2020 2020  some..          
-00001c00: 2020 2020 2020 6e6f 6e20 7369 6d69 6c61        non simila
-00001c10: 7220 6c61 6265 6c73 2066 726f 6d20 4e47  r labels from NG
-00001c20: 410d 0a20 2020 2020 2020 2020 2020 206d  A..            m
-00001c30: 7873 5f6d 6170 5f63 6c61 7373 6573 5f3d  xs_map_classes_=
-00001c40: 2061 2064 6963 7420 6f72 206f 7269 6769   a dict or origi
-00001c50: 6e61 6c20 636c 6173 7320 6c61 6265 6c73  nal class labels
-00001c60: 206f 6620 7468 6520 6172 7261 790d 0a20   of the array.. 
-00001c70: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00001c80: 6b27 203c 2779 5f74 7275 6527 3e20 616e  k' <'y_true'> an
-00001c90: 6420 7468 6569 7220 7465 6d70 6f72 6172  d their temporar
-00001ca0: 7920 696e 7465 6765 7220 636c 6173 7320  y integer class 
-00001cb0: 6c61 6265 6c73 2e0d 0a20 2020 2020 2020  labels...       
-00001cc0: 2020 2020 2020 2020 2049 6e64 6565 642c           Indeed,
-00001cd0: 2069 6620 2779 5f74 7275 6527 2063 6c61   if 'y_true' cla
-00001ce0: 7373 206c 6162 656c 7320 6172 6520 6e6f  ss labels are no
-00001cf0: 7420 6120 6e75 6d65 7269 6320 6474 7970  t a numeric dtyp
-00001d00: 652c 200d 0a20 2020 2020 2020 2020 2020  e, ..           
-00001d10: 2020 2020 204e 6577 206c 6162 656c 7320       New labels 
-00001d20: 7769 7468 2069 6e74 6567 6572 2064 7479  with integer dty
-00001d30: 7065 2069 7320 6372 6561 7465 642e 2054  pe is created. T
-00001d40: 6865 2064 6963 7420 6973 2075 7365 6420  he dict is used 
-00001d50: 746f 200d 0a20 2020 2020 2020 2020 2020  to ..           
-00001d60: 2020 2020 2077 7261 7020 7468 6520 7472       wrap the tr
-00001d70: 7565 206c 6162 656c 7320 286f 7269 6769  ue labels (origi
-00001d80: 6e61 6c20 6f6e 6573 2920 6475 7269 6e67  nal ones) during
-00001d90: 2074 6865 204d 5853 2063 7265 6174 696f   the MXS creatio
-00001da0: 6e2e 200d 0a20 2020 2020 2020 2020 2020  n. ..           
-00001db0: 2020 2020 2054 6875 732c 2074 6865 206f       Thus, the o
-00001dc0: 7269 6769 6e61 6c20 6c61 6265 6c73 2061  riginal labels a
-00001dd0: 7265 206e 6f74 2061 6c74 6572 6564 2061  re not altered a
-00001de0: 6e64 2077 696c 6c20 6265 206d 6170 2069  nd will be map i
-00001df0: 6e20 0d0a 2020 2020 2020 2020 2020 2020  n ..            
-00001e00: 2020 2020 7475 726e 2020 6174 2074 6865      turn  at the
-00001e10: 2065 6e64 2074 6f20 7265 636f 7665 7220   end to recover 
-00001e20: 7468 6569 7220 706f 7369 7469 6f6e 7320  their positions 
-00001e30: 6173 2077 656c 6c20 696e 200d 0a20 2020  as well in ..   
-00001e40: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00001e50: 204d 5853 2061 7272 6179 2e20 4974 2069   MXS array. It i
-00001e60: 7320 7365 7420 746f 2027 4e6f 6e65 2720  s set to 'None' 
-00001e70: 6966 2027 795f 7472 7565 2720 6861 7320  if 'y_true' has 
-00001e80: 6120 6e75 6d65 7269 6320 0d0a 2020 2020  a numeric ..    
-00001e90: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-00001ea0: 652e 200d 0a20 2020 2020 2020 2020 2020  e. ..           
-00001eb0: 206d 7873 5f67 726f 7570 5f63 6c61 7373   mxs_group_class
-00001ec0: 6573 5f3a 2064 6963 7420 6f66 2061 6c6c  es_: dict of all
-00001ed0: 2074 6865 2073 696d 696c 6172 2067 726f   the similar gro
-00001ee0: 7570 206c 6162 656c 7320 2077 6974 6820  up labels  with 
-00001ef0: 7468 6520 0d0a 2020 2020 2020 2020 2020  the ..          
-00001f00: 2020 2020 2020 4d58 5320 6c61 6265 6c73        MXS labels
-00001f10: 2072 656c 6174 6564 2066 726f 6d20 7468   related from th
-00001f20: 6520 6d6f 6469 6669 6564 2065 7869 7374  e modified exist
-00001f30: 696e 6720 6772 6f75 7073 206f 6620 4e47  ing groups of NG
-00001f40: 412e 0d0a 2020 2020 2020 2020 2020 2020  A...            
-00001f50: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
-00001f60: 6520 6e6f 6e2d 7369 6d69 6c61 7220 6772  e non-similar gr
-00001f70: 6f75 7020 6172 6520 6d6f 6469 6669 6564  oup are modified
-00001f80: 2069 6620 7468 6569 7220 6c61 6265 6c73   if their labels
-00001f90: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00001fa0: 2020 2061 7265 2061 6c73 6f20 666f 756e     are also foun
-00001fb0: 6420 696e 2074 6865 2074 7275 655f 6c61  d in the true_la
-00001fc0: 6265 6c73 2074 6f20 6176 6f69 6420 616e  bels to avoid an
-00001fd0: 7920 636f 6e66 7573 696f 6e2e 2054 6875  y confusion. Thu
-00001fe0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-00001ff0: 2020 2074 6865 2064 6963 7420 7772 6170     the dict wrap
-00002000: 2074 6865 206e 6f6e 2d73 696d 696c 6172   the non-similar
-00002010: 206c 6162 656c 2077 6974 6820 7468 6569   label with thei
-00002020: 7220 6e65 7720 7465 6d70 6f72 6179 200d  r new temporay .
-00002030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002040: 206c 6162 656c 732e 200d 0a20 2020 2020   labels. ..     
-00002050: 2020 2020 2020 206d 7873 5f73 696d 696c         mxs_simil
-00002060: 6172 5f67 726f 7570 735f 3d20 6c69 7374  ar_groups_= list
-00002070: 206f 6620 7468 6520 7369 6d69 6c61 7220   of the similar 
-00002080: 6c61 6265 6c73 2066 6f75 6e64 2069 6e20  labels found in 
-00002090: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000020a0: 2020 795f 7472 7565 2074 6861 7420 6861    y_true that ha
-000020b0: 7665 2061 2073 696d 696c 6172 6974 7920  ve a similarity 
-000020c0: 696e 204e 4741 2e20 200d 0a20 2020 2020  in NGA.  ..     
-000020d0: 2020 2020 2020 206d 7873 5f73 696d 696c         mxs_simil
-000020e0: 6172 6974 795f 3d20 5475 706c 6520 6f66  arity_= Tuple of
-000020f0: 2073 696d 696c 6172 6974 7920 696e 2070   similarity in p
-00002100: 6169 7220 286c 6162 656c 2c20 6772 6f75  air (label, grou
-00002110: 7029 200d 0a20 2020 2020 2020 2020 2020  p) ..           
-00002120: 2020 2020 2065 7869 7374 696e 6720 6265       existing be
-00002130: 7477 6565 6e20 7468 6520 6c61 6265 6c20  tween the label 
-00002140: 636c 6173 7320 696e 2079 5f74 7275 6520  class in y_true 
-00002150: 616e 6420 4e47 412e 200d 0a20 2020 2020  and NGA. ..     
-00002160: 2020 2020 2020 206d 7873 5f67 726f 7570         mxs_group
-00002170: 5f6c 6162 656c 735f 3d20 6c69 7374 206f  _labels_= list o
-00002180: 6620 7468 6520 7369 6d69 6c61 7220 6772  f the similar gr
-00002190: 6f75 7073 2066 6f75 6e64 2069 6e20 7468  oups found in th
-000021a0: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
-000021b0: 2020 2020 7072 6564 6963 7465 6420 4e47      predicted NG
-000021c0: 4120 7468 6174 2068 6176 6520 6120 7369  A that have a si
-000021d0: 6d69 6c61 7269 7479 2069 6e20 7472 7565  milarity in true
-000021e0: 206c 6162 656c 7320 2779 5f74 7275 6527   labels 'y_true'
-000021f0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00002200: 5265 7475 726e 7320 0d0a 2020 2020 2d2d  Returns ..    --
-00002210: 2d2d 2d2d 2d2d 2d0d 0a20 2020 204d 5853  -------..    MXS
-00002220: 3a20 6172 7261 792d 6c69 6b65 2031 6420  : array-like 1d 
-00002230: 6f72 203a 636c 6173 733a 607e 7761 7465  or :class:`~wate
-00002240: 782e 7574 696c 732e 626f 782e 426f 7873  x.utils.box.Boxs
-00002250: 7061 6365 600d 0a20 2020 2020 2020 2061  pace`..        a
-00002260: 7272 6179 206c 696b 6520 6f66 204d 5853  rray like of MXS
-00002270: 206c 6162 656c 7320 6f72 204d 5853 206f   labels or MXS o
-00002280: 626a 6563 7420 636f 6e74 6169 6e69 6e67  bject containing
-00002290: 2074 6865 200d 0a20 2020 2020 2020 2075   the ..        u
-000022a0: 7365 6675 6c6c 2061 7474 7269 6275 7465  sefull attribute
-000022b0: 732e 200d 0a20 2020 200d 0a20 2020 2053  s. ..    ..    S
-000022c0: 6565 2041 6c73 6f0d 0a20 2020 202d 2d2d  ee Also..    ---
-000022d0: 2d2d 2d2d 2d2d 0d0a 2020 2020 7072 6564  ------..    pred
-000022e0: 6963 745f 4e47 415f 6c61 6265 6c73 3a20  ict_NGA_labels: 
-000022f0: 5072 6564 6963 7473 204e 6169 7665 2067  Predicts Naive g
-00002300: 726f 7570 206f 6620 4171 7569 6665 7273  roup of Aquifers
-00002310: 2020 6c61 6265 6c73 2e20 0d0a 2020 2020    labels. ..    
-00002320: 0d0a 2020 2020 0d0a 2020 2020 4578 616d  ..    ..    Exam
-00002330: 706c 6573 0d0a 2020 2020 2d2d 2d2d 2d2d  ples..    ------
-00002340: 2d2d 2d0d 0a20 2020 203e 3e3e 2066 726f  ---..    >>> fro
-00002350: 6d20 7761 7465 782e 6461 7461 7365 7473  m watex.datasets
-00002360: 2069 6d70 6f72 7420 6c6f 6164 5f68 6c6f   import load_hlo
-00002370: 6773 0d0a 2020 2020 3e3e 3e20 6672 6f6d  gs..    >>> from
-00002380: 2077 6174 6578 2e75 7469 6c73 2069 6d70   watex.utils imp
-00002390: 6f72 7420 7265 6164 5f64 6174 6120 0d0a  ort read_data ..
-000023a0: 2020 2020 3e3e 3e20 6672 6f6d 2077 6174      >>> from wat
-000023b0: 6578 2e75 7469 6c73 2e68 7964 726f 7574  ex.utils.hydrout
-000023c0: 696c 7320 696d 706f 7274 2063 6c61 7373  ils import class
-000023d0: 6966 795f 6b2c 206d 616b 655f 4d58 535f  ify_k, make_MXS_
-000023e0: 6c61 6265 6c73 0d0a 2020 2020 3e3e 3e20  labels..    >>> 
-000023f0: 6461 7461 203d 206c 6f61 645f 686c 6f67  data = load_hlog
-00002400: 7320 2829 2e66 7261 6d65 200d 0a20 2020  s ().frame ..   
-00002410: 203e 3e3e 2023 206d 6170 2064 6174 612e   >>> # map data.
-00002420: 6b20 746f 2063 6174 6567 6f72 697a 6520  k to categorize 
-00002430: 6b20 7661 6c75 6573 200d 0a20 2020 203e  k values ..    >
-00002440: 3e3e 2079 6d61 7020 3d20 636c 6173 7369  >> ymap = classi
-00002450: 6679 5f6b 2864 6174 612e 6b20 2c20 6465  fy_k(data.k , de
-00002460: 6661 756c 745f 6675 6e63 203d 5472 7565  fault_func =True
-00002470: 2920 0d0a 2020 2020 3e3e 3e20 795f 6d78  ) ..    >>> y_mx
-00002480: 7320 3d20 6d61 6b65 5f4d 5853 5f6c 6162  s = make_MXS_lab
-00002490: 656c 7320 2879 6d61 702c 2064 6174 612e  els (ymap, data.
-000024a0: 6171 7569 6665 725f 6772 6f75 7029 0d0a  aquifer_group)..
-000024b0: 2020 2020 3e3e 3e20 795f 6d78 735b 3134      >>> y_mxs[14
-000024c0: 3a32 345d 200d 0a20 2020 202e 2e2e 2020  :24] ..    ...  
-000024d0: 6172 7261 7928 5b27 4927 2c20 2749 272c  array(['I', 'I',
-000024e0: 2032 2c20 322c 2032 2c20 322c 2032 2c20   2, 2, 2, 2, 2, 
-000024f0: 322c 2032 2c20 325d 2c20 6474 7970 653d  2, 2, 2], dtype=
-00002500: 6f62 6a65 6374 290d 0a20 2020 203e 3e3e  object)..    >>>
-00002510: 206d 7873 5f6f 626a 203d 206d 616b 655f   mxs_obj = make_
-00002520: 4d58 535f 6c61 6265 6c73 2028 796d 6170  MXS_labels (ymap
-00002530: 2c20 6461 7461 2e61 7175 6966 6572 5f67  , data.aquifer_g
-00002540: 726f 7570 2c20 7265 7475 726e 5f6f 626a  roup, return_obj
-00002550: 3d54 7275 6520 290d 0a20 2020 203e 3e3e  =True )..    >>>
-00002560: 206d 7873 5f6f 626a 2e6d 7873 5f6c 6162   mxs_obj.mxs_lab
-00002570: 656c 735f 5b31 343a 2032 345d 0d0a 2020  els_[14: 24]..  
-00002580: 2020 2e2e 2e20 6172 7261 7928 5b27 4927    ... array(['I'
-00002590: 2c20 2749 272c 2032 2c20 322c 2032 2c20  , 'I', 2, 2, 2, 
-000025a0: 322c 2032 2c20 322c 2032 2c20 325d 2c20  2, 2, 2, 2, 2], 
-000025b0: 6474 7970 653d 6f62 6a65 6374 290d 0a20  dtype=object).. 
-000025c0: 2020 203e 3e3e 2023 206e 6f77 2077 6520     >>> # now we 
-000025d0: 6469 6420 7468 6520 7361 6d65 2074 6173  did the same tas
-000025e0: 6b20 7573 696e 6720 7468 6520 7072 6976  k using the priv
-000025f0: 6174 6520 6461 7461 2027 6866 2e63 7376  ate data 'hf.csv
-00002600: 270d 0a20 2020 203e 3e3e 2023 2063 6f6d  '..    >>> # com
-00002610: 706f 7365 6420 6f66 2031 3120 626f 7265  posed of 11 bore
-00002620: 686f 6c65 732e 2046 6f72 2064 6566 6175  holes. For defau
-00002630: 6c74 2077 6520 616c 7465 726e 6174 6976  lt we alternativ
-00002640: 656c 7920 7573 6573 200d 0a20 2020 203e  ely uses ..    >
-00002650: 3e3e 2023 2074 6865 2061 7175 6966 6572  >> # the aquifer
-00002660: 2067 726f 7570 7320 6c69 6b65 2061 2066   groups like a f
-00002670: 616b 6520 4e47 4120 0d0a 2020 2020 3e3e  ake NGA ..    >>
-00002680: 3e20 6461 7461 203d 2072 6561 645f 6461  > data = read_da
-00002690: 7461 2028 2764 6174 612f 626f 7265 686f  ta ('data/boreho
-000026a0: 6c65 732f 6866 2e63 7376 2729 200d 0a20  les/hf.csv') .. 
-000026b0: 2020 203e 3e3e 2079 6d61 7020 3d20 2063     >>> ymap =  c
-000026c0: 6c61 7373 6966 795f 6b28 6461 7461 2e6b  lassify_k(data.k
-000026d0: 202c 2064 6566 6175 6c74 5f66 756e 6320   , default_func 
-000026e0: 3d54 7275 6529 2020 0d0a 2020 2020 3e3e  =True)  ..    >>
-000026f0: 3e20 795f 6d78 733d 206d 616b 655f 4d58  > y_mxs= make_MX
-00002700: 535f 6c61 6265 6c73 2028 796d 6170 2c20  S_labels (ymap, 
-00002710: 6461 7461 2e61 7175 6966 6572 5f67 726f  data.aquifer_gro
-00002720: 7570 290d 0a20 2020 203e 3e3e 206e 702e  up)..    >>> np.
-00002730: 756e 6971 7565 2028 795f 6d78 7329 0d0a  unique (y_mxs)..
-00002740: 2020 2020 2e2e 2e20 6172 7261 7928 5b27      ... array(['
-00002750: 3127 2c20 2731 5627 2c20 2732 272c 2027  1', '1V', '2', '
-00002760: 3249 4949 272c 2027 3327 2c20 2749 272c  2III', '3', 'I',
-00002770: 2027 4949 272c 2027 4949 4926 4956 272c   'II', 'III&IV',
-00002780: 2027 4956 275d 2c0d 0a20 2020 2020 2020   'IV'],..       
-00002790: 2020 2064 7479 7065 3d27 3c55 3627 290d     dtype='<U6').
-000027a0: 0a20 2020 203e 3e3e 2023 202a 636f 6d6d  .    >>> # *comm
-000027b0: 656e 7473 3a20 0d0a 2020 2020 2020 2020  ents: ..        
-000027c0: 2320 6c61 6265 6c20 2731 5627 206d 6561  # label '1V' mea
-000027d0: 6e73 2074 6865 2067 726f 7570 2056 2028  ns the group V (
-000027e0: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
-000027f0: 2063 6c75 7374 6572 2920 0d0a 2020 2020   cluster) ..    
-00002800: 2020 2020 2320 616e 6420 6c61 6265 6c20      # and label 
-00002810: 3120 2874 7275 6520 6c61 6265 6c73 2920  1 (true labels) 
-00002820: 6861 7665 2061 2073 696d 696c 6172 6974  have a similarit
-00002830: 7920 0d0a 2020 2020 2020 2020 2320 7468  y ..        # th
-00002840: 6520 7361 6d65 206f 6620 6c61 6265 6c20  e same of label 
-00002850: 2732 4949 4927 2077 6869 6c65 2074 6865  '2III' while the
-00002860: 2072 656d 6169 6e20 6c61 6265 6c20 3320   remain label 3 
-00002870: 646f 6573 206e 6f74 2020 0d0a 2020 2020  does not  ..    
-00002880: 2020 2020 2320 2061 6e79 2073 696d 696c      #  any simil
-00002890: 6172 6974 7920 696e 2074 6865 206f 7468  arity in the oth
-000028a0: 6572 206c 6162 656c 7320 2069 6e20 7468  er labels  in th
-000028b0: 6520 2779 5f70 7265 6427 2065 7870 6563  e 'y_pred' expec
-000028c0: 7465 6420 0d0a 2020 2020 2020 2020 2320  ted ..        # 
-000028d0: 746f 2062 6520 4e47 4120 6c61 6265 6c73  to be NGA labels
-000028e0: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
-000028f0: 2020 2222 220d 0a20 2020 2043 4f4e 5445    """..    CONTE
-00002900: 5854 5f4d 5347 203d 2028 0d0a 2020 2020  XT_MSG = (..    
-00002910: 2020 2020 2243 616e 206f 6e6c 7920 7072      "Can only pr
-00002920: 6f63 6573 7320 756e 6675 6e63 207b 3021  ocess unfunc {0!
-00002930: 727d 2069 6620 616e 6420 6f6e 6c79 2069  r} if and only i
-00002940: 6620 7b31 7d20 7369 6d69 6c61 7269 7479  f {1} similarity
-00002950: 220d 0a20 2020 2020 2020 2022 2069 7320  "..        " is 
-00002960: 666f 756e 6420 6265 7477 6565 6e20 7472  found between tr
-00002970: 7565 206c 6162 656c 7320 696e 2027 795f  ue labels in 'y_
-00002980: 7472 7565 2720 616e 6420 7468 6520 7072  true' and the pr
-00002990: 6564 6963 7465 6420 4e47 4122 0d0a 2020  edicted NGA"..  
-000029a0: 2020 2020 2020 2220 6c61 6265 6c73 2069        " labels i
-000029b0: 6e20 2779 5f70 7265 6427 2e22 0d0a 2020  n 'y_pred'."..  
-000029c0: 2020 2020 2020 290d 0a20 2020 200d 0a20        )..    .. 
-000029d0: 2020 2073 6570 203d 2073 6570 206f 7220     sep = sep or 
-000029e0: 2727 200d 0a20 2020 2070 7265 6669 7820  '' ..    prefix 
-000029f0: 3d20 7072 6566 6978 206f 7220 2727 200d  = prefix or '' .
-00002a00: 0a20 2020 2023 2066 6f72 2063 6f6e 7369  .    # for consi
-00002a10: 7374 656e 6379 0d0a 2020 2020 2320 6368  stency..    # ch
-00002a20: 6563 6b20 6172 7261 7973 200d 0a20 2020  eck arrays ..   
-00002a30: 2079 5f74 7275 6520 3d20 6368 6563 6b5f   y_true = check_
-00002a40: 7920 280d 0a20 2020 2020 2020 2079 5f74  y (..        y_t
-00002a50: 7275 652c 200d 0a20 2020 2020 2020 2061  rue, ..        a
-00002a60: 6c6c 6f77 5f6e 616e 3d20 5472 7565 2c20  llow_nan= True, 
-00002a70: 0d0a 2020 2020 2020 2020 746f 5f66 7261  ..        to_fra
-00002a80: 6d65 203d 5472 7565 2c20 0d0a 2020 2020  me =True, ..    
-00002a90: 2020 2020 696e 7075 745f 6e61 6d65 3d22      input_name="
-00002aa0: 795f 7472 7565 222c 0d0a 2020 2020 2020  y_true",..      
-00002ab0: 2020 2920 200d 0a0d 0a20 2020 2079 5f70    )  ....    y_p
-00002ac0: 7265 6420 3d20 6368 6563 6b5f 7920 280d  red = check_y (.
-00002ad0: 0a20 2020 2020 2020 2079 5f70 7265 642c  .        y_pred,
-00002ae0: 200d 0a20 2020 2020 2020 2074 6f5f 6672   ..        to_fr
-00002af0: 616d 6520 3d20 5472 7565 2c20 0d0a 2020  ame = True, ..  
-00002b00: 2020 2020 2020 616c 6c6f 775f 6e61 6e3d        allow_nan=
-00002b10: 2046 616c 7365 2c20 0d0a 2020 2020 2020   False, ..      
-00002b20: 2020 696e 7075 745f 6e61 6d65 203d 224e    input_name ="N
-00002b30: 4741 206c 6162 656c 7322 0d0a 2020 2020  GA labels"..    
-00002b40: 2020 2020 290d 0a0d 0a20 2020 205f 6368      )....    _ch
-00002b50: 6563 6b5f 636f 6e73 6973 7465 6e63 795f  eck_consistency_
-00002b60: 7369 7a65 2879 5f74 7275 652c 2079 5f70  size(y_true, y_p
-00002b70: 7265 6420 2920 0d0a 2020 2020 2320 6368  red ) ..    # ch
-00002b80: 6563 6b20 7768 6574 6865 7220 7468 6520  eck whether the 
-00002b90: 795f 7472 7565 2069 7320 6e75 6d65 7269  y_true is numeri
-00002ba0: 6361 6c20 6461 7461 200d 0a20 2020 2023  cal data ..    #
-00002bb0: 2069 6620 6e6f 7420 7265 6e61 6d65 2079   if not rename y
-00002bc0: 5f74 7275 6520 616e 6420 6b65 6570 2074  _true and keep t
-00002bd0: 6865 2063 6c61 7373 6573 200d 0a20 2020  he classes ..   
-00002be0: 2023 2066 6f72 206d 6170 7069 6e67 2061   # for mapping a
-00002bf0: 7420 7468 6520 656e 6420 6f66 2063 6c61  t the end of cla
-00002c00: 7373 2074 7261 6e73 666f 726d 6174 696f  ss transformatio
-00002c10: 6e20 0d0a 2020 2020 2379 5f74 7275 655f  n ..    #y_true_
-00002c20: 7472 616e 7366 2c20 6d78 735f 6d61 705f  transf, mxs_map_
-00002c30: 636c 6173 7365 735f 2020 3d20 5f6b 6d61  classes_  = _kma
-00002c40: 7070 696e 6728 2079 5f74 7275 6520 290d  pping( y_true ).
-00002c50: 0a20 2020 200d 0a20 2020 2069 6620 7369  .    ..    if si
-00002c60: 6d69 6c61 725f 6c61 6265 6c73 2069 7320  milar_labels is 
-00002c70: 4e6f 6e65 3a20 0d0a 2020 2020 2020 2020  None: ..        
-00002c80: 7369 6d69 6c61 725f 6c61 6265 6c73 203d  similar_labels =
-00002c90: 2066 696e 645f 7369 6d69 6c61 725f 6c61   find_similar_la
-00002ca0: 6265 6c73 2028 0d0a 2020 2020 2020 2020  bels (..        
-00002cb0: 2020 2020 795f 7472 7565 2c20 0d0a 2020      y_true, ..  
-00002cc0: 2020 2020 2020 2020 2020 795f 7072 6564            y_pred
-00002cd0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00002ce0: 7468 7265 7368 6f6c 643d 2074 6872 6573  threshold= thres
-00002cf0: 686f 6c64 2c20 0d0a 2020 2020 2020 2020  hold, ..        
-00002d00: 2020 2020 6d65 7468 6f64 3d6d 6574 686f      method=metho
-00002d10: 642c 200d 0a20 2020 2020 2020 2020 2020  d, ..           
-00002d20: 202a 2a6b 7773 200d 0a20 2020 2020 2020   **kws ..       
-00002d30: 2020 2020 2029 200d 0a20 2020 2020 2020       ) ..       
-00002d40: 200d 0a20 2020 2043 4f4e 5445 5854 203d   ..    CONTEXT =
-00002d50: 2027 6e6f 2720 6966 206c 656e 2873 696d   'no' if len(sim
-00002d60: 696c 6172 5f6c 6162 656c 7329 3d3d 3020  ilar_labels)==0 
-00002d70: 2065 6c73 6520 2773 696d 696c 6172 6974   else 'similarit
-00002d80: 7920 6973 2066 6f75 6e64 2720 0d0a 0d0a  y is found' ....
-00002d90: 2020 2020 6966 2043 4f4e 5445 5854 203d      if CONTEXT =
-00002da0: 3d27 6e6f 2720 3a20 0d0a 2020 2020 2020  ='no' : ..      
-00002db0: 2020 795f 6d78 732c 2067 726f 7570 5f63    y_mxs, group_c
-00002dc0: 6c61 7373 6573 5f2c 2067 726f 7570 5f6c  lasses_, group_l
-00002dd0: 6162 656c 732c 2073 696d 5f67 726f 7570  abels, sim_group
-00002de0: 7320 3d20 5f4d 5853 5f69 665f 6e6f 280d  s = _MXS_if_no(.
-00002df0: 0a20 2020 2020 2020 2020 2020 2043 4f4e  .            CON
-00002e00: 5445 5854 2c20 0d0a 2020 2020 2020 2020  TEXT, ..        
-00002e10: 2020 2020 795f 7472 7565 2c20 0d0a 2020      y_true, ..  
-00002e20: 2020 2020 2020 2020 2020 795f 7072 6564            y_pred
-00002e30: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00002e40: 636d 7367 3d43 4f4e 5445 5854 5f4d 5347  cmsg=CONTEXT_MSG
-00002e50: 202c 200d 0a20 2020 2020 2020 2020 2020   , ..           
-00002e60: 2074 7261 696c 6572 3d74 7261 696c 6572   trailer=trailer
-00002e70: 200d 0a20 2020 2020 2020 2020 2020 2029   ..            )
-00002e80: 0d0a 2020 2020 656c 7365 203a 200d 0a20  ..    else : .. 
-00002e90: 2020 2020 2020 2079 5f6d 7873 2c20 6772         y_mxs, gr
-00002ea0: 6f75 705f 636c 6173 7365 735f 2c20 6772  oup_classes_, gr
-00002eb0: 6f75 705f 6c61 6265 6c73 2c20 7369 6d5f  oup_labels, sim_
-00002ec0: 6772 6f75 7073 203d 205f 4d58 535f 6966  groups = _MXS_if
-00002ed0: 5f79 6573 280d 0a20 2020 2020 2020 2020  _yes(..         
-00002ee0: 2020 2043 4f4e 5445 5854 202c 200d 0a20     CONTEXT , .. 
-00002ef0: 2020 2020 2020 2020 2020 2073 696d 696c             simil
-00002f00: 6172 5f6c 6162 656c 732c 200d 0a20 2020  ar_labels, ..   
-00002f10: 2020 2020 2020 2020 2079 5f70 7265 642c           y_pred,
-00002f20: 200d 0a20 2020 2020 2020 2020 2020 2079   ..            y
-00002f30: 5f74 7275 652c 200d 0a20 2020 2020 2020  _true, ..       
-00002f40: 2020 2020 2073 6570 203d 7365 702c 0d0a       sep =sep,..
-00002f50: 2020 2020 2020 2020 2020 2020 7072 6566              pref
-00002f60: 6978 3d20 7072 6566 6978 2c20 0d0a 2020  ix= prefix, ..  
-00002f70: 2020 2020 2020 2020 2020 636d 7367 3d20            cmsg= 
-00002f80: 434f 4e54 4558 545f 4d53 472c 200d 0a20  CONTEXT_MSG, .. 
-00002f90: 2020 2020 2020 2020 2020 2074 7261 696c             trail
-00002fa0: 6572 3d20 7472 6169 6c65 7220 0d0a 2020  er= trailer ..  
-00002fb0: 2020 2020 2020 290d 0a20 2020 2023 2023        )..    # #
-00002fc0: 2073 6176 6520 7468 6520 6e6f 745f 6e61   save the not_na
-00002fd0: 6e20 696e 6469 6365 7320 746f 206e 6f74  n indices to not
-00002fe0: 200d 0a20 2020 2023 2023 2061 6c74 6572   ..    # # alter
-00002ff0: 6564 2074 6865 206b 2d76 616c 6964 2076  ed the k-valid v
-00003000: 616c 7565 7320 0d0a 2020 2020 6e6f 745f  alues ..    not_
-00003010: 6e61 6e5f 696e 6469 6365 732c 2020 3d20  nan_indices,  = 
-00003020: 6e70 2e77 6865 7265 2028 207e 6e70 2e69  np.where ( ~np.i
-00003030: 736e 616e 2028 795f 7472 7565 2920 290d  snan (y_true) ).
-00003040: 0a20 2020 2023 2023 206e 6f74 2061 6c74  .    # # not alt
-00003050: 6572 6564 2074 6865 206b 2d76 616c 6964  ered the k-valid
-00003060: 2064 6174 610d 0a20 2020 2074 7279 3a20   data..    try: 
-00003070: 0d0a 2020 2020 2020 2020 2320 7472 7920  ..        # try 
-00003080: 746f 2072 6563 6f6e 7665 7274 2063 6c61  to reconvert cla
-00003090: 7373 206c 6162 656c 7320 746f 2069 6e74  ss labels to int
-000030a0: 6567 6572 0d0a 2020 2020 2020 2020 2320  eger..        # 
-000030b0: 6966 2063 6c61 7373 2061 7265 206e 756d  if class are num
-000030c0: 6572 6963 2076 616c 7565 732c 206f 7468  eric values, oth
-000030d0: 6572 7769 7365 2020 0d0a 2020 2020 2020  erwise  ..      
-000030e0: 2020 2320 6b65 6570 2074 6865 2076 616c    # keep the val
-000030f0: 7565 7320 6173 2074 6865 7920 7765 7265  ues as they were
-00003100: 2e0d 0a20 2020 2020 2020 2079 5f6d 7873  ...        y_mxs
-00003110: 205b 6e6f 745f 6e61 6e5f 696e 6469 6365   [not_nan_indice
-00003120: 735d 203d 2079 5f74 7275 6520 5b6e 6f74  s] = y_true [not
-00003130: 5f6e 616e 5f69 6e64 6963 6573 5d2e 6173  _nan_indices].as
-00003140: 7479 7065 286e 702e 696e 7433 3229 0d0a  type(np.int32)..
-00003150: 2020 2020 6578 6365 7074 203a 2020 0d0a      except :  ..
-00003160: 2020 2020 2020 2020 795f 6d78 7320 5b6e          y_mxs [n
-00003170: 6f74 5f6e 616e 5f69 6e64 6963 6573 5d20  ot_nan_indices] 
-00003180: 3d20 795f 7472 7565 205b 6e6f 745f 6e61  = y_true [not_na
-00003190: 6e5f 696e 6469 6365 735d 0d0a 2020 2020  n_indices]..    
-000031a0: 0d0a 2020 2020 236c 6574 2070 616e 6461  ..    #let panda
-000031b0: 7320 746f 2066 696e 6420 7468 6520 6265  s to find the be
-000031c0: 7374 2064 7479 7065 2073 696e 6365 200d  st dtype since .
-000031d0: 0a20 2020 2023 2073 7472 696e 6720 7661  .    # string va
-000031e0: 6c75 6520 696e 2079 5f6d 7873 206f 626a  lue in y_mxs obj
-000031f0: 6563 7420 7265 6d61 696e 2061 2073 7472  ect remain a str
-00003200: 696e 6720 0d0a 2020 2020 2320 6f62 6a65  ing ..    # obje
-00003210: 6374 2069 6e20 6461 7461 0d0a 2020 2020  ct in data..    
-00003220: 795f 6d78 7320 3d20 7064 2e53 6572 6965  y_mxs = pd.Serie
-00003230: 7320 2879 5f6d 7873 2c20 6e61 6d65 203d  s (y_mxs, name =
-00003240: 276d 7873 2729 2e76 616c 7565 7320 0d0a  'mxs').values ..
-00003250: 0d0a 2020 2020 7472 7920 3a20 0d0a 2020  ..    try : ..  
-00003260: 2020 2020 2020 795f 6d78 7320 3d20 795f        y_mxs = y_
-00003270: 6d78 7320 2e61 7374 7970 6520 2869 6e74  mxs .astype (int
-00003280: 2920 0d0a 2020 2020 6578 6365 7074 203a  ) ..    except :
-00003290: 2079 5f6d 7873 3d20 795f 6d78 732e 6173   y_mxs= y_mxs.as
-000032a0: 7479 7065 2873 7472 2029 0d0a 2020 2020  type(str )..    
-000032b0: 0d0a 2020 2020 4d58 5320 3d79 5f6d 7873  ..    MXS =y_mxs
-000032c0: 202e 636f 7079 2829 200d 0a20 2020 200d   .copy() ..    .
-000032d0: 0a20 2020 2069 6620 7265 7475 726e 5f6f  .    if return_o
-000032e0: 626a 203a 200d 0a20 2020 2020 2020 2023  bj : ..        #
-000032f0: 2063 7265 6174 6520 6120 6d65 7461 7479   create a metaty
-00003300: 7065 206f 6620 6d69 7874 7572 6520 6f62  pe of mixture ob
-00003310: 6a65 6374 2063 6c61 7373 2061 6e64 200d  ject class and .
-00003320: 0a20 2020 2020 2020 2023 2077 7261 7070  .        # wrapp
-00003330: 2074 6865 2069 6d70 6f72 7461 6e63 6520   the importance 
-00003340: 6174 7472 6962 7574 6573 200d 0a20 2020  attributes ..   
-00003350: 2020 2020 2074 7279 203a 200d 0a20 2020       try : ..   
-00003360: 2020 2020 2020 2020 206d 7873 5f63 6c61           mxs_cla
-00003370: 7373 6573 5f20 3d20 6e70 2e75 6e69 7175  sses_ = np.uniqu
-00003380: 6520 2879 5f6d 7873 2920 0d0a 2020 2020  e (y_mxs) ..    
-00003390: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
-000033a0: 2020 2020 2020 2020 206d 7873 5f63 6c61           mxs_cla
-000033b0: 7373 6573 5f20 3d20 6e70 2e75 6e69 7175  sses_ = np.uniqu
-000033c0: 6520 2879 5f6d 7873 2e61 7374 7970 6520  e (y_mxs.astype 
-000033d0: 2873 7472 2029 2029 200d 0a20 2020 2020  (str ) ) ..     
-000033e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000033f0: 204d 5853 5f61 7474 7269 6275 7465 7320   MXS_attributes 
-00003400: 3d20 6469 6374 2028 0d0a 2020 2020 2020  = dict (..      
-00003410: 2020 2020 2020 6d78 735f 636c 6173 7365        mxs_classe
-00003420: 735f 203d 206d 7873 5f63 6c61 7373 6573  s_ = mxs_classes
-00003430: 5f2c 200d 0a20 2020 2020 2020 2020 2020  _, ..           
-00003440: 206d 7873 5f6c 6162 656c 735f 3d20 795f   mxs_labels_= y_
-00003450: 6d78 7320 2c20 200d 0a20 2020 2020 2020  mxs ,  ..       
-00003460: 2020 2020 2023 206d 7873 5f6d 6170 5f63       # mxs_map_c
-00003470: 6c61 7373 6573 5f3d 206d 7873 5f6d 6170  lasses_= mxs_map
-00003480: 5f63 6c61 7373 6573 5f2c 200d 0a20 2020  _classes_, ..   
-00003490: 2020 2020 2020 2020 206d 7873 5f67 726f           mxs_gro
-000034a0: 7570 5f63 6c61 7373 6573 5f3d 6772 6f75  up_classes_=grou
-000034b0: 705f 636c 6173 7365 735f 202c 0d0a 2020  p_classes_ ,..  
-000034c0: 2020 2020 2020 2020 2020 6d78 735f 7369            mxs_si
-000034d0: 6d69 6c61 725f 6c61 6265 6c73 5f3d 2073  milar_labels_= s
-000034e0: 696d 696c 6172 5f6c 6162 656c 732c 200d  imilar_labels, .
-000034f0: 0a20 2020 2020 2020 2020 2020 206d 7873  .            mxs
-00003500: 5f73 696d 696c 6172 6974 795f 3d20 7369  _similarity_= si
-00003510: 6d5f 6772 6f75 7073 2c20 200d 0a20 2020  m_groups,  ..   
-00003520: 2020 2020 2020 2020 206d 7873 5f67 726f           mxs_gro
-00003530: 7570 5f6c 6162 656c 735f 3d20 6772 6f75  up_labels_= grou
-00003540: 705f 6c61 6265 6c73 0d0a 2020 2020 2020  p_labels..      
-00003550: 2020 2020 2020 2920 200d 0a20 2020 2020        )  ..     
-00003560: 2020 200d 0a20 2020 2020 2020 204d 5853     ..        MXS
-00003570: 203d 2042 6f78 7370 6163 6528 2a2a 4d58   = Boxspace(**MX
-00003580: 535f 6174 7472 6962 7574 6573 290d 0a20  S_attributes).. 
-00003590: 2020 2020 2020 200d 0a20 2020 2072 6574         ..    ret
-000035a0: 7572 6e20 4d58 5320 0d0a 0d0a 6465 6620  urn MXS ....def 
-000035b0: 7072 6564 6963 745f 4e47 415f 6c61 6265  predict_NGA_labe
-000035c0: 6c73 2820 0d0a 2020 2020 2020 2020 582c  ls( ..        X,
-000035d0: 202f 202c 206e 5f63 6c75 7374 6572 7320   / , n_clusters 
-000035e0: 2c20 7261 6e64 6f6d 5f73 7461 7465 203d  , random_state =
-000035f0: 3020 2c20 6b65 6570 5f6c 6162 656c 5f30  0 , keep_label_0
-00003600: 203d 2046 616c 7365 2c20 0d0a 2020 2020   = False, ..    
-00003610: 2020 2020 6e5f 696e 6974 3d22 6175 746f      n_init="auto
-00003620: 222c 7265 7475 726e 5f63 6c75 7374 6572  ",return_cluster
-00003630: 5f63 656e 7465 7273 203d 4661 6c73 652c  _centers =False,
-00003640: 2020 2a2a 6b77 7320 0d0a 2020 2020 2020    **kws ..      
-00003650: 2020 293a 200d 0a20 2020 2022 2222 0d0a    ): ..    """..
-00003660: 2020 2020 5072 6564 6963 7420 7468 6520      Predict the 
-00003670: 4e61 6976 6520 4772 6f75 7020 6f66 2041  Naive Group of A
-00003680: 7175 6966 6572 2028 4e47 4129 206c 6162  quifer (NGA) lab
-00003690: 656c 732e 200d 0a20 2020 200d 0a20 2020  els. ..    ..   
-000036a0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-000036b0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-000036c0: 2058 203a 207b 6172 7261 792d 6c69 6b65   X : {array-like
-000036d0: 2c20 7370 6172 7365 206d 6174 7269 787d  , sparse matrix}
-000036e0: 206f 6620 7368 6170 6520 286e 5f73 616d   of shape (n_sam
-000036f0: 706c 6573 2c20 6e5f 6665 6174 7572 6573  ples, n_features
-00003700: 290d 0a20 2020 2020 2020 2054 7261 696e  )..        Train
-00003710: 696e 6720 696e 7374 616e 6365 7320 746f  ing instances to
-00003720: 2063 6c75 7374 6572 2e20 4974 206d 7573   cluster. It mus
-00003730: 7420 6265 206e 6f74 6564 2074 6861 7420  t be noted that 
-00003740: 7468 6520 6461 7461 0d0a 2020 2020 2020  the data..      
-00003750: 2020 7769 6c6c 2062 6520 636f 6e76 6572    will be conver
-00003760: 7465 6420 746f 2043 206f 7264 6572 696e  ted to C orderin
-00003770: 672c 2077 6869 6368 2077 696c 6c20 6361  g, which will ca
-00003780: 7573 6520 6120 6d65 6d6f 7279 0d0a 2020  use a memory..  
-00003790: 2020 2020 2020 636f 7079 2069 6620 7468        copy if th
-000037a0: 6520 6769 7665 6e20 6461 7461 2069 7320  e given data is 
-000037b0: 6e6f 7420 432d 636f 6e74 6967 756f 7573  not C-contiguous
-000037c0: 2e0d 0a20 2020 2020 2020 2049 6620 6120  ...        If a 
-000037d0: 7370 6172 7365 206d 6174 7269 7820 6973  sparse matrix is
-000037e0: 2070 6173 7365 642c 2061 2063 6f70 7920   passed, a copy 
-000037f0: 7769 6c6c 2062 6520 6d61 6465 2069 6620  will be made if 
-00003800: 6974 2773 206e 6f74 2069 6e0d 0a20 2020  it's not in..   
-00003810: 2020 2020 2043 5352 2066 6f72 6d61 742e       CSR format.
-00003820: 0d0a 2020 2020 6e5f 636c 7573 7465 7273  ..    n_clusters
-00003830: 203a 2069 6e74 2c20 6465 6661 756c 743d   : int, default=
-00003840: 380d 0a20 2020 2020 2020 2054 6865 206e  8..        The n
-00003850: 756d 6265 7220 6f66 2063 6c75 7374 6572  umber of cluster
-00003860: 7320 746f 2066 6f72 6d20 6173 2077 656c  s to form as wel
-00003870: 6c20 6173 2074 6865 206e 756d 6265 7220  l as the number 
-00003880: 6f66 0d0a 2020 2020 2020 2020 6365 6e74  of..        cent
-00003890: 726f 6964 7320 746f 2067 656e 6572 6174  roids to generat
-000038a0: 652e 0d0a 0d0a 2020 2020 7261 6e64 6f6d  e.....    random
-000038b0: 5f73 7461 7465 203a 2069 6e74 2c20 5261  _state : int, Ra
-000038c0: 6e64 6f6d 5374 6174 6520 696e 7374 616e  ndomState instan
-000038d0: 6365 206f 7220 4e6f 6e65 2c20 6465 6661  ce or None, defa
-000038e0: 756c 743d 3432 0d0a 2020 2020 2020 2020  ult=42..        
-000038f0: 4465 7465 726d 696e 6573 2072 616e 646f  Determines rando
-00003900: 6d20 6e75 6d62 6572 2067 656e 6572 6174  m number generat
-00003910: 696f 6e20 666f 7220 6365 6e74 726f 6964  ion for centroid
-00003920: 2069 6e69 7469 616c 697a 6174 696f 6e2e   initialization.
-00003930: 2055 7365 0d0a 2020 2020 2020 2020 616e   Use..        an
-00003940: 2069 6e74 2074 6f20 6d61 6b65 2074 6865   int to make the
-00003950: 2072 616e 646f 6d6e 6573 7320 6465 7465   randomness dete
-00003960: 726d 696e 6973 7469 632e 0d0a 2020 200d  rministic...   .
-00003970: 0a20 2020 206b 6565 705f 6c61 6265 6c5f  .    keep_label_
-00003980: 303a 2062 6f6f 6c2c 2064 6566 6175 6c74  0: bool, default
-00003990: 3d46 616c 7365 0d0a 2020 2020 2020 2020  =False..        
-000039a0: 5468 6520 7072 6564 6963 7469 6f6e 2061  The prediction a
-000039b0: 6c72 6561 6479 2069 6e63 6c75 6465 7320  lready includes 
-000039c0: 7468 6520 6c61 6265 6c20 302e 2048 6f77  the label 0. How
-000039d0: 6576 6572 2c20 696e 636c 7564 696e 6720  ever, including 
-000039e0: 3020 696e 200d 0a20 2020 2020 2020 2074  0 in ..        t
-000039f0: 6865 2070 7265 6469 6374 6564 206c 6162  he predicted lab
-00003a00: 656c 2072 6566 6572 7320 746f 2027 6b3d  el refers to 'k=
-00003a10: 3027 2069 2e65 2e20 7065 726d 6561 6269  0' i.e. permeabi
-00003a20: 6c69 7479 2063 6f65 6666 6963 6965 6e74  lity coefficient
-00003a30: 200d 0a20 2020 2020 2020 2065 7175 616c   ..        equal
-00003a40: 7320 746f 2030 2c20 7768 6963 6820 6973  s to 0, which is
-00003a50: 206e 6f74 2054 7275 6520 696e 2070 7269   not True in pri
-00003a60: 6e63 6970 6c65 2c20 6265 6361 7573 6520  nciple, because 
-00003a70: 616c 6c20 726f 636b 7320 2068 6176 6520  all rocks  have 
-00003a80: 0d0a 2020 2020 2020 2020 6120 7065 726d  ..        a perm
-00003a90: 6561 6269 6c69 7479 2063 6f65 6666 6963  eability coeffic
-00003aa0: 6965 6e74 2027 6b27 2e20 4865 7265 2077  ient 'k'. Here w
-00003ab0: 6520 636f 6e73 6964 6572 6564 2027 6b3d  e considered 'k=
-00003ac0: 3027 2061 7320 616e 2075 6e64 6566 696e  0' as an undefin
-00003ad0: 6564 200d 0a20 2020 2020 2020 2070 6572  ed ..        per
-00003ae0: 6d65 6162 696c 6974 7920 636f 6566 6669  meability coeffi
-00003af0: 6369 656e 742e 2054 6865 7265 666f 7265  cient. Therefore
-00003b00: 2c20 2730 2720 2c20 6361 6e20 6265 2065  , '0' , can be e
-00003b10: 7863 6c75 6465 2073 696e 6365 2c20 6974  xclude since, it
-00003b20: 2063 616e 200d 0a20 2020 2020 2020 2061   can ..        a
-00003b30: 6c73 6f20 636f 6e73 6964 6572 6564 2061  lso considered a
-00003b40: 7320 6120 6d69 7373 696e 6720 276b 272d  s a missing 'k'-
-00003b50: 7661 6c75 652e 2049 6620 7072 6564 6963  value. If predic
-00003b60: 7465 6420 2730 2720 6973 2069 6e20 7468  ted '0' is in th
-00003b70: 6520 7461 7267 6574 200d 0a20 2020 2020  e target ..     
-00003b80: 2020 2069 7420 7368 6f75 6c64 206d 6561     it should mea
-00003b90: 6e20 6120 6d69 7373 696e 6720 276b 272d  n a missing 'k'-
-00003ba0: 7661 6c75 6520 7261 7468 6572 2074 6861  value rather tha
-00003bb0: 6e20 6265 696e 6720 6120 636f 6e63 7265  n being a concre
-00003bc0: 7465 206c 6162 656c 2e20 200d 0a20 2020  te label.  ..   
-00003bd0: 2020 2020 2054 6865 7265 666f 7265 2c20       Therefore, 
-00003be0: 746f 2061 766f 6964 2061 6e79 2063 6f6e  to avoid any con
-00003bf0: 6675 7369 6f6e 2c20 2730 2720 6973 2061  fusion, '0' is a
-00003c00: 6c74 6572 6564 2074 6f20 2731 2720 736f  ltered to '1' so
-00003c10: 2074 6865 2076 616c 7565 200d 0a20 2020   the value ..   
-00003c20: 2020 2020 2060 2b31 6020 6973 2075 7365       `+1` is use
-00003c30: 6420 746f 206d 6f76 6520 666f 7277 6172  d to move forwar
-00003c40: 6420 616c 6c20 636c 6173 7320 6c61 6265  d all class labe
-00003c50: 6c73 2074 6865 7265 6279 2065 7863 6c75  ls thereby exclu
-00003c60: 6469 6e67 200d 0a20 2020 2020 2020 2074  ding ..        t
-00003c70: 6865 2027 3027 206c 6162 656c 2e20 546f  he '0' label. To
-00003c80: 2066 6f72 6365 2069 6e63 6c75 6465 2030   force include 0
-00003c90: 2069 6e20 7468 6520 6c61 6265 6c2c 2073   in the label, s
-00003ca0: 6574 2060 6b65 6570 5f6c 6162 656c 5f30  et `keep_label_0
-00003cb0: 6020 0d0a 2020 2020 2020 2020 746f 2060  ` ..        to `
-00003cc0: 6054 7275 6560 602e 200d 0a20 2020 2020  `True``. ..     
-00003cd0: 2020 200d 0a20 2020 206e 5f69 6e69 7420     ..    n_init 
-00003ce0: 3a20 2761 7574 6f27 206f 7220 696e 742c  : 'auto' or int,
-00003cf0: 2064 6566 6175 6c74 3d31 300d 0a20 2020   default=10..   
-00003d00: 2020 2020 204e 756d 6265 7220 6f66 2074       Number of t
-00003d10: 696d 6573 2074 6865 206b 2d6d 6561 6e73  imes the k-means
-00003d20: 2061 6c67 6f72 6974 686d 2069 7320 7275   algorithm is ru
-00003d30: 6e20 7769 7468 2064 6966 6665 7265 6e74  n with different
-00003d40: 2063 656e 7472 6f69 640d 0a20 2020 2020   centroid..     
-00003d50: 2020 2073 6565 6473 2e20 5468 6520 6669     seeds. The fi
-00003d60: 6e61 6c20 7265 7375 6c74 7320 6973 2074  nal results is t
-00003d70: 6865 2062 6573 7420 6f75 7470 7574 206f  he best output o
-00003d80: 6620 606e 5f69 6e69 7460 2063 6f6e 7365  f `n_init` conse
-00003d90: 6375 7469 7665 2072 756e 730d 0a20 2020  cutive runs..   
-00003da0: 2020 2020 2069 6e20 7465 726d 7320 6f66       in terms of
-00003db0: 2069 6e65 7274 6961 2e20 5365 7665 7261   inertia. Severa
-00003dc0: 6c20 7275 6e73 2061 7265 2072 6563 6f6d  l runs are recom
-00003dd0: 6d65 6e64 6564 2066 6f72 2073 7061 7273  mended for spars
-00003de0: 650d 0a20 2020 2020 2020 2068 6967 682d  e..        high-
-00003df0: 6469 6d65 6e73 696f 6e61 6c20 7072 6f62  dimensional prob
-00003e00: 6c65 6d73 2028 7365 6520 3a72 6566 3a60  lems (see :ref:`
-00003e10: 6b6d 6561 6e73 5f73 7061 7273 655f 6869  kmeans_sparse_hi
-00003e20: 6768 5f64 696d 6029 2e0d 0a20 2020 200d  gh_dim`)...    .
-00003e30: 0a20 2020 2020 2020 2057 6865 6e20 606e  .        When `n
-00003e40: 5f69 6e69 743d 2761 7574 6f27 602c 2074  _init='auto'`, t
-00003e50: 6865 206e 756d 6265 7220 6f66 2072 756e  he number of run
-00003e60: 7320 7769 6c6c 2062 6520 3130 2069 6620  s will be 10 if 
-00003e70: 7573 696e 670d 0a20 2020 2020 2020 2060  using..        `
-00003e80: 696e 6974 3d27 7261 6e64 6f6d 2760 2c20  init='random'`, 
-00003e90: 616e 6420 3120 6966 2075 7369 6e67 2060  and 1 if using `
-00003ea0: 696e 6974 3d27 6b6d 6561 6e73 2b2b 2760  init='kmeans++'`
-00003eb0: 2e0d 0a20 2020 200d 0a20 2020 2020 2020  ...    ..       
-00003ec0: 202e 2e20 7665 7273 696f 6e61 6464 6564   .. versionadded
-00003ed0: 3a3a 2030 2e32 2e30 200d 0a20 2020 2020  :: 0.2.0 ..     
-00003ee0: 2020 2020 2020 4164 6465 6420 2761 7574        Added 'aut
-00003ef0: 6f27 206f 7074 696f 6e20 666f 7220 606e  o' option for `n
-00003f00: 5f69 6e69 7460 2e0d 0a20 2020 200d 0a20  _init`...    .. 
-00003f10: 2020 2072 6574 7572 6e5f 636c 7573 7465     return_cluste
-00003f20: 725f 6365 6e74 6572 733a 2062 6f6f 6c2c  r_centers: bool,
-00003f30: 2064 6566 6175 6c74 3d46 616c 7365 2c20   default=False, 
-00003f40: 0d0a 2020 2020 2020 2020 6578 706f 7274  ..        export
-00003f50: 2074 6865 2061 7272 6179 206f 6620 636c   the array of cl
-00003f60: 7573 7465 7273 2063 656e 7465 7273 2069  usters centers i
-00003f70: 6620 6060 5472 7565 6060 2e20 0d0a 2020  f ``True``. ..  
-00003f80: 2020 6b77 733a 2064 6963 742c 200d 0a20    kws: dict, .. 
-00003f90: 2020 2020 2020 2041 6464 6974 696f 6e61         Additiona
-00003fa0: 6c20 6b65 7977 6f72 6420 6172 6775 6d65  l keyword argume
-00003fb0: 6e74 7320 7061 7373 6564 2074 6f20 3a63  nts passed to :c
-00003fc0: 6c61 7373 3a60 736b 6c65 6172 6e2e 636c  lass:`sklearn.cl
-00003fd0: 7573 7465 7273 2e4b 4d65 616e 7360 2e0d  usters.KMeans`..
-00003fe0: 0a20 2020 2020 2020 2020 0d0a 2020 2020  .         ..    
-00003ff0: 5265 7475 726e 7320 0d0a 2020 2020 2d2d  Returns ..    --
-00004000: 2d2d 2d2d 2d2d 2d0d 0a20 2020 204e 4741  -------..    NGA
-00004010: 3a20 6172 7261 795f 6c69 6b65 206f 6620  : array_like of 
-00004020: 2073 6861 7065 2028 6e5f 7361 6d70 6c65   shape (n_sample
-00004030: 732c 206e 5f66 6561 7475 7265 7329 0d0a  s, n_features)..
-00004040: 2020 2020 2020 2020 5072 6564 6963 7465          Predicte
-00004050: 6420 4e47 4120 6c61 6265 6c73 2e20 0d0a  d NGA labels. ..
-00004060: 2020 2020 2820 4e47 4120 2c20 636c 7573      ( NGA , clus
-00004070: 7465 725f 6365 6e74 6572 7329 203a 2054  ter_centers) : T
-00004080: 7570 6c65 206f 6620 6172 7261 792d 6c69  uple of array-li
-00004090: 6b65 2c20 0d0a 2020 2020 2020 204d 4741  ke, ..       MGA
-000040a0: 2061 6e64 2063 6c75 7374 6572 7320 6365   and clusters ce
-000040b0: 6e74 6572 7320 6966 2060 6072 6574 7572  nters if ``retur
-000040c0: 6e5f 636c 7573 7465 725f 6365 6e74 6572  n_cluster_center
-000040d0: 7360 2069 7320 0d0a 2020 2020 2020 2073  s` is ..       s
-000040e0: 6574 2074 6f20 6060 5472 7565 6060 2e20  et to ``True``. 
-000040f0: 0d0a 2020 2020 2222 220d 0a20 2020 2066  ..    """..    f
-00004100: 726f 6d20 2e2e 6578 6c69 622e 736b 6c65  rom ..exlib.skle
-00004110: 6172 6e20 696d 706f 7274 204b 4d65 616e  arn import KMean
-00004120: 7320 0d0a 2020 2020 2378 7878 7878 7878  s ..    #xxxxxxx
+00000950: 0d0a 5f70 6172 616d 5f64 6f63 7320 3d20  .._param_docs = 
+00000960: 446f 6373 7472 696e 6743 6f6d 706f 6e65  DocstringCompone
+00000970: 6e74 732e 6672 6f6d 5f6e 6573 7465 645f  nts.from_nested_
+00000980: 636f 6d70 6f6e 656e 7473 280d 0a20 2020  components(..   
+00000990: 2063 6f72 653d 5f63 6f72 655f 646f 6373   core=_core_docs
+000009a0: 5b22 7061 7261 6d73 225d 2c20 0d0a 2020  ["params"], ..  
+000009b0: 2020 290d 0a23 2d2d 2d2d 2d2d 2d2d 2d2d    )..#----------
+000009c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
+000009d0: 6465 6620 6d61 6b65 5f4d 5853 5f6c 6162  def make_MXS_lab
+000009e0: 656c 7320 280d 0a20 2020 2079 5f74 7275  els (..    y_tru
+000009f0: 652c 200d 0a20 2020 2079 5f70 7265 642c  e, ..    y_pred,
+00000a00: 200d 0a20 2020 2074 6872 6573 686f 6c64   ..    threshold
+00000a10: 3d20 4e6f 6e65 2c20 0d0a 2020 2020 7369  = None, ..    si
+00000a20: 6d69 6c61 725f 6c61 6265 6c73 3d20 4e6f  milar_labels= No
+00000a30: 6e65 2c20 0d0a 2020 2020 7365 7020 3d4e  ne, ..    sep =N
+00000a40: 6f6e 652c 200d 0a20 2020 2070 7265 6669  one, ..    prefi
+00000a50: 7820 3d4e 6f6e 652c 200d 0a20 2020 206d  x =None, ..    m
+00000a60: 6574 686f 643d 276e 6169 7665 272c 200d  ethod='naive', .
+00000a70: 0a20 2020 2074 7261 696c 6572 3d22 2a22  .    trailer="*"
+00000a80: 2c0d 0a20 2020 2072 6574 7572 6e5f 6f62  ,..    return_ob
+00000a90: 6a3d 4661 6c73 652c 2020 0d0a 2020 2020  j=False,  ..    
+00000aa0: 2a2a 6b77 730d 0a20 2020 293a 200d 0a20  **kws..   ): .. 
+00000ab0: 2020 2022 2222 2043 7265 6174 6520 6120     """ Create a 
+00000ac0: 4d69 7874 7572 6520 4c65 6172 6e69 6e67  Mixture Learning
+00000ad0: 2053 7472 6174 6567 7920 284d 5853 2920   Strategy (MXS) 
+00000ae0: 6c61 6265 6c73 2066 726f 6d20 7472 7565  labels from true
+00000af0: 206c 6162 656c 7320 0d0a 2020 2020 2779   labels ..    'y
+00000b00: 5f74 7275 6527 2061 6e64 2074 6865 2070  _true' and the p
+00000b10: 7265 6469 6374 6564 204e 6169 7665 2047  redicted Naive G
+00000b20: 726f 7570 206f 6620 4171 7569 6665 7220  roup of Aquifer 
+00000b30: 284e 4741 2920 6c61 6265 6c73 2027 795f  (NGA) labels 'y_
+00000b40: 7072 6564 270d 0a20 2020 200d 0a20 2020  pred'..    ..   
+00000b50: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00000b60: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020   -----------..  
+00000b70: 2020 795f 7472 7565 3a20 6172 7261 792d    y_true: array-
+00000b80: 6c69 6b65 2031 642c 2070 616e 6461 732e  like 1d, pandas.
+00000b90: 5365 7269 6573 200d 0a20 2020 2020 2020  Series ..       
+00000ba0: 2041 7272 6179 2063 6f6d 706f 7365 6420   Array composed 
+00000bb0: 6f66 2076 616c 6964 206b 2d76 616c 7565  of valid k-value
+00000bc0: 7320 616e 6420 706f 7373 6962 6c65 206d  s and possible m
+00000bd0: 6973 7369 6e67 206b 2d76 616c 7565 732e  issing k-values.
+00000be0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00000bf0: 2079 5f70 7265 643a 2041 7272 6179 2d6c   y_pred: Array-l
+00000c00: 696b 6520 3164 2c20 7061 6e64 6173 2e53  ike 1d, pandas.S
+00000c10: 6572 6965 730d 0a20 2020 2020 2020 2041  eries..        A
+00000c20: 7272 6179 2063 6f6d 706f 7369 6e67 2074  rray composing t
+00000c30: 6865 2076 616c 6964 204e 4741 206c 6162  he valid NGA lab
+00000c40: 656c 732e 204e 6f74 6520 7468 6174 204e  els. Note that N
+00000c50: 4741 206c 6162 656c 7320 6973 2020 6120  GA labels is  a 
+00000c60: 0d0a 2020 2020 2020 2020 7072 6564 6963  ..        predic
+00000c70: 7465 6420 6c61 6265 6c73 206d 6f73 746c  ted labels mostl
+00000c80: 7920 7573 696e 6720 7468 6520 756e 7375  y using the unsu
+00000c90: 7065 7276 6973 696e 6720 6c65 6172 6e69  pervising learni
+00000ca0: 6e67 2e20 0d0a 2020 2020 2020 2020 200d  ng. ..         .
+00000cb0: 0a20 2020 2074 6872 6573 686f 6c64 3a20  .    threshold: 
+00000cc0: 666c 6f61 742c 2064 6566 6175 6c74 3d4e  float, default=N
+00000cd0: 6f6e 6520 0d0a 2020 2020 2020 2020 5468  one ..        Th
+00000ce0: 6520 7468 7265 7368 6f6c 6420 6672 6f6d  e threshold from
+00000cf0: 2077 6869 6368 2c20 6c61 6265 6c20 696e   which, label in
+00000d00: 2027 795f 7472 7565 2720 6361 6e20 6265   'y_true' can be
+00000d10: 2063 6f6e 7369 6465 7265 6420 200d 0a20   considered  .. 
+00000d20: 2020 2020 2020 2073 696d 696c 6172 2074         similar t
+00000d30: 6861 6e20 7468 6520 6f6e 6520 696e 204e  han the one in N
+00000d40: 4741 206c 6162 656c 7320 2779 5f70 7265  GA labels 'y_pre
+00000d50: 6427 2e20 5468 6520 6465 6661 756c 7420  d'. The default 
+00000d60: 6973 2027 4e6f 6e65 2720 7768 6963 6820  is 'None' which 
+00000d70: 0d0a 2020 2020 2020 2020 6d65 616e 7320  ..        means 
+00000d80: 6e6f 6e65 2072 756c 6520 6973 2063 6f6e  none rule is con
+00000d90: 7369 6465 7265 6420 616e 6420 7468 6520  sidered and the 
+00000da0: 6869 6768 2070 7265 706f 6e64 6572 656e  high preponderen
+00000db0: 6365 206f 7220 6f63 6375 7265 6e63 6520  ce or occurence 
+00000dc0: 0d0a 2020 2020 2020 2020 696e 2074 6865  ..        in the
+00000dd0: 2064 6174 6120 636f 6d70 6172 6564 2074   data compared t
+00000de0: 6f20 6f74 6865 7220 6c61 6265 6c73 2069  o other labels i
+00000df0: 7320 636f 6e73 6964 6572 6564 2061 7320  s considered as 
+00000e00: 7468 6520 6d6f 7374 200d 0a20 2020 2020  the most ..     
+00000e10: 2020 2072 6570 7265 7365 6e74 6174 6976     representativ
+00000e20: 6520 2061 6e64 2073 696d 696c 6172 2e20  e  and similar. 
+00000e30: 5365 7474 696e 6720 7468 6520 7275 6c65  Setting the rule
+00000e40: 2069 6e73 7465 6164 2062 7920 6669 7869   instead by fixi
+00000e50: 6e67 200d 0a20 2020 2020 2020 2074 6865  ng ..        the
+00000e60: 2074 6872 6573 686f 6c64 2069 7320 7265   threshold is re
+00000e70: 636f 6d6d 656e 6465 6420 6573 7065 6369  commended especi
+00000e80: 616c 6c79 2069 6e20 6120 6875 6765 2064  ally in a huge d
+00000e90: 6174 6173 6574 2e0d 0a20 2020 2020 2020  ataset...       
+00000ea0: 200d 0a20 2020 2073 696d 696c 6172 5f6c   ..    similar_l
+00000eb0: 6162 656c 733a 206c 6973 7420 6f66 2074  abels: list of t
+00000ec0: 7570 6c65 2c20 6f70 7469 6f6e 616c 2020  uple, optional  
+00000ed0: 200d 0a20 2020 2020 2020 206c 6973 7420   ..        list 
+00000ee0: 6f66 2074 7570 6c65 2069 6e20 7061 6972  of tuple in pair
+00000ef0: 2028 6c61 6265 6c20 616e 6420 7369 6d69   (label and simi
+00000f00: 6c61 7220 6772 6f75 7029 2e20 4966 2067  lar group). If g
+00000f10: 6976 656e 2c20 7468 6520 7369 6d69 6c61  iven, the simila
+00000f20: 7220 0d0a 2020 2020 2020 2020 6772 6f75  r ..        grou
+00000f30: 7020 6d75 7374 2062 6520 7468 6520 6c61  p must be the la
+00000f40: 6265 6c20 6578 6973 7469 6e67 2069 6e20  bel existing in 
+00000f50: 7468 6520 7072 6564 6963 7465 6420 4e47  the predicted NG
+00000f60: 412e 2049 6620 6060 4e6f 6e65 6060 2c20  A. If ``None``, 
+00000f70: 0d0a 2020 2020 2020 2020 7468 6520 6175  ..        the au
+00000f80: 746f 2d73 696d 696c 6172 6974 7920 6973  to-similarity is
+00000f90: 2074 7269 6767 6572 6564 2e20 0d0a 2020   triggered. ..  
+00000fa0: 2020 2020 2020 0d0a 2020 2020 7365 703a        ..    sep:
+00000fb0: 2073 7472 2c20 6465 6661 756c 7427 2720   str, default'' 
+00000fc0: 0d0a 2020 2020 2020 2020 5365 7061 7261  ..        Separa
+00000fd0: 746f 7220 6265 7477 6565 6e20 7468 6520  tor between the 
+00000fe0: 7472 7565 206c 6162 656c 7320 2779 5f74  true labels 'y_t
+00000ff0: 7275 6527 2061 6e64 2070 7265 6469 6374  rue' and predict
+00001000: 6564 204e 4741 206c 6162 656c 732e 0d0a  ed NGA labels...
+00001010: 2020 2020 2020 2020 5365 7020 6973 2075          Sep is u
+00001020: 7365 6420 746f 2072 6577 7269 7465 2074  sed to rewrite t
+00001030: 6865 204d 5853 206c 6162 656c 732e 204d  he MXS labels. M
+00001040: 6f73 746c 7920 7468 6520 4d58 5320 6c61  ostly the MXS la
+00001050: 6265 6c73 2069 7320 6120 0d0a 2020 2020  bels is a ..    
+00001060: 2020 2020 636f 6d62 696e 6169 736f 6e20      combinaison 
+00001070: 7769 7468 2074 6865 2074 7275 6520 6c61  with the true la
+00001080: 6265 6c20 6f66 2070 6572 6d65 6162 696c  bel of permeabil
+00001090: 6974 7920 636f 6566 6669 6369 656e 7420  ity coefficient 
+000010a0: 276b 2720 616e 6420 0d0a 2020 2020 2020  'k' and ..      
+000010b0: 2020 7468 6520 6c61 6265 6c20 6f66 204e    the label of N
+000010c0: 4741 2074 6f20 636f 6d70 6f73 6520 6e65  GA to compose ne
+000010d0: 7720 7369 6d69 6c61 7269 7479 206c 6162  w similarity lab
+000010e0: 656c 732e 2046 6f72 2069 6e73 7461 6e63  els. For instanc
+000010f0: 6520 0d0a 2020 2020 2020 2020 0d0a 2020  e ..        ..  
+00001100: 2020 2020 2020 3e3e 3e20 7472 7565 5f6c        >>> true_l
+00001110: 6162 656c 733d 5b27 6b31 272c 2027 6b32  abels=['k1', 'k2
+00001120: 272c 2027 6b33 275d 203b 204e 4741 5f6c  ', 'k3'] ; NGA_l
+00001130: 6162 656c 7320 3d5b 2749 4927 2c20 2749  abels =['II', 'I
+00001140: 272c 2027 4956 275d 0d0a 2020 2020 2020  ', 'IV']..      
+00001150: 2020 3e3e 3e20 2320 6769 7665 7320 0d0a    >>> # gives ..
+00001160: 2020 2020 2020 2020 3e3e 3e20 4d58 535f          >>> MXS_
+00001170: 6c61 6265 6c73 3d20 5b27 6b31 5f49 4927  labels= ['k1_II'
+00001180: 2c20 276b 325f 4927 2c20 276b 335f 4956  , 'k2_I', 'k3_IV
+00001190: 275d 0d0a 2020 2020 0d0a 2020 2020 2020  ']..    ..      
+000011a0: 2020 7768 6572 6520 7468 6520 7365 7065    where the sepe
+000011b0: 7261 746f 7220 6073 6570 6020 6973 2073  rator `sep` is s
+000011c0: 6574 2074 6f20 6060 5f60 602e 2054 6869  et to ``_``. Thi
+000011d0: 7320 6861 7070 656e 7320 6573 7065 6369  s happens especi
+000011e0: 616c 6c79 200d 0a20 2020 2020 2020 2077  ally ..        w
+000011f0: 6865 6e20 6f6e 6520 6f66 2074 6865 206c  hen one of the l
+00001200: 6162 656c 2028 4e47 4120 6f72 2074 7275  abel (NGA or tru
+00001210: 655f 6c61 6265 6c73 2920 6973 206e 6f74  e_labels) is not
+00001220: 2061 206e 756d 6572 6963 2064 6174 6174   a numeric datat
+00001230: 7970 6520 0d0a 2020 2020 2020 2020 616e  ype ..        an
+00001240: 6420 6120 7369 6d69 6c61 7269 7920 6973  d a similariy is
+00001250: 2066 6f75 6e64 2062 6574 7765 656e 2027   found between '
+00001260: 6b31 2720 616e 6420 2749 4927 2c20 276b  k1' and 'II', 'k
+00001270: 3227 2061 6e64 2027 4927 2061 6e64 2073  2' and 'I' and s
+00001280: 6f20 6f6e 2e0d 0a20 2020 2020 2020 200d  o on...        .
+00001290: 0a20 2020 2070 7265 6669 783a 2073 7472  .    prefix: str
+000012a0: 2c20 6465 6661 756c 743d 2727 0d0a 2020  , default=''..  
+000012b0: 2020 2020 2020 7072 6566 6978 2069 7320        prefix is 
+000012c0: 7573 6564 2074 6f20 7265 6e61 6d65 2074  used to rename t
+000012d0: 6865 2074 7275 655f 6c61 6265 6c73 2069  he true_labels i
+000012e0: 2e65 2074 6865 2074 7275 6520 7661 6c69  .e the true vali
+000012f0: 642d 6b2e 2046 6f72 0d0a 2020 2020 2020  d-k. For..      
+00001300: 2020 696e 7374 616e 6365 3a3a 0d0a 2020    instance::..  
+00001310: 2020 2020 2020 2020 2020 3e3e 3e20 6b5f            >>> k_
+00001320: 7661 6c69 6420 3d5b 312c 2032 2c20 2e2e  valid =[1, 2, ..
+00001330: 5d20 2d3e 206b 5f6e 6577 203d 205b 6b31  ] -> k_new = [k1
+00001340: 2c20 6b32 2c20 2e2e 2e5d 0d0a 2020 2020  , k2, ...]..    
+00001350: 2020 2020 7768 6572 6520 276b 2720 6973      where 'k' is
+00001360: 2074 6865 2070 7265 6669 782e 200d 0a20   the prefix. .. 
+00001370: 2020 2020 2020 200d 0a20 2020 206d 6574         ..    met
+00001380: 686f 643a 2073 7472 205b 276e 6169 7665  hod: str ['naive
+00001390: 272c 2027 7374 7269 6374 275d 2c20 6465  ', 'strict'], de
+000013a0: 6661 756c 743d 276e 6169 7665 270d 0a20  fault='naive'.. 
+000013b0: 2020 2020 2020 2054 6865 206b 696e 6420         The kind 
+000013c0: 6f66 2073 7472 6174 6567 7920 746f 2063  of strategy to c
+000013d0: 6f6d 7075 7465 2074 6865 2072 6570 7265  ompute the repre
+000013e0: 7365 6e74 6174 6976 6974 7920 6f66 2061  sentativity of a
+000013f0: 206c 6162 656c 200d 0a20 2020 2020 2020   label ..       
+00001400: 2069 6e20 7468 6520 7072 6564 6963 7465   in the predicte
+00001410: 6420 6172 7261 7920 2779 5f70 7265 6427  d array 'y_pred'
+00001420: 2e20 4974 2063 616e 2061 6c73 6f20 6265  . It can also be
+00001430: 2027 7374 7269 6374 272e 2049 6e64 6565   'strict'. Indee
+00001440: 643a 0d0a 2020 2020 2020 2020 0d0a 2020  d:..        ..  
+00001450: 2020 2020 2020 2d20 6060 6e61 6976 6560        - ``naive`
+00001460: 6020 636f 6d70 7574 6573 2074 6865 2069  ` computes the i
+00001470: 6d70 6f72 7461 6e63 6520 6f66 2074 6865  mportance of the
+00001480: 206c 6162 656c 2062 7920 7468 6520 6e75   label by the nu
+00001490: 6d62 6572 206f 6620 6974 730d 0a20 2020  mber of its..   
+000014a0: 2020 2020 2020 2020 206f 6363 7572 656e           occuren
+000014b0: 6365 2066 6f72 2074 6869 7320 7370 6563  ce for this spec
+000014c0: 6966 6963 206c 6162 656c 2069 6e20 7468  ific label in th
+000014d0: 6520 6172 7261 7920 2779 5f74 7275 6527  e array 'y_true'
+000014e0: 2e20 4974 2064 6f65 7320 6e6f 7420 0d0a  . It does not ..
+000014f0: 2020 2020 2020 2020 2020 2020 7461 6b65              take
+00001500: 2069 6e74 6f20 6163 636f 756e 7420 6f66   into account of
+00001510: 2074 6865 206f 6363 7572 656e 6365 206f   the occurence o
+00001520: 6620 6f74 6865 7220 6578 6973 7469 6e67  f other existing
+00001530: 206c 6162 656c 732e 2054 6869 7320 0d0a   labels. This ..
+00001540: 2020 2020 2020 2020 2020 2020 6973 2075              is u
+00001550: 7365 6675 6c6c 2066 6f72 2075 6e62 616c  sefull for unbal
+00001560: 616e 6365 6420 636c 6173 7320 6c61 6265  anced class labe
+00001570: 6c73 2069 6e20 6079 5f74 7275 6560 2e0d  ls in `y_true`..
+00001580: 0a20 2020 2020 2020 202d 2060 6073 7472  .        - ``str
+00001590: 6963 7460 6020 636f 6d70 7574 6573 2074  ict`` computes t
+000015a0: 6865 2069 6d70 6f72 7461 6e63 6520 6f66  he importance of
+000015b0: 2074 6865 206c 6162 656c 2062 7920 7468   the label by th
+000015c0: 6520 6e75 6d62 6572 206f 6620 0d0a 2020  e number of ..  
+000015d0: 2020 2020 2020 2020 2020 6f63 6375 7265            occure
+000015e0: 6e63 6520 696e 2074 6865 2077 686f 6c65  nce in the whole
+000015f0: 2076 616c 6964 2060 795f 7472 7565 6020   valid `y_true` 
+00001600: 692e 652e 2075 6e64 6572 2074 6865 2074  i.e. under the t
+00001610: 6f74 616c 206f 6620 0d0a 2020 2020 2020  otal of ..      
+00001620: 2020 2020 2020 6f63 6375 7265 6e63 6520        occurence 
+00001630: 6f66 2061 6c6c 2074 6865 206c 6162 656c  of all the label
+00001640: 7320 7468 6174 2065 7869 7374 2069 6e20  s that exist in 
+00001650: 7468 6520 7768 6f6c 6520 2761 7272 5f61  the whole 'arr_a
+00001660: 7127 2e20 0d0a 2020 2020 2020 2020 2020  q'. ..          
+00001670: 2020 5468 6973 2063 616e 2067 6976 6520    This can give 
+00001680: 6120 7375 6974 6162 6c65 2061 6e61 796c  a suitable anayl
+00001690: 7365 2072 6573 756c 7473 2069 6620 7468  se results if th
+000016a0: 6520 6461 7461 2069 7320 6e6f 7420 0d0a  e data is not ..
+000016b0: 2020 2020 2020 2020 2020 2020 756e 6261              unba
+000016c0: 6c61 6e63 6564 2066 6f72 2065 6163 6820  lanced for each 
+000016d0: 6c61 6265 6c73 2069 6e20 6079 5f70 7265  labels in `y_pre
+000016e0: 6460 2e0d 0a20 2020 2020 2020 2020 2020  d`...           
+000016f0: 200d 0a20 2020 2074 7261 696c 6572 3a20   ..    trailer: 
+00001700: 7374 722c 2064 6566 6175 6c74 3d27 2a27  str, default='*'
+00001710: 0d0a 2020 2020 2020 2020 5468 6520 4d69  ..        The Mi
+00001720: 7874 7572 6520 7374 7261 7465 6779 206d  xture strategy m
+00001730: 6172 6b65 7220 746f 2064 6966 6665 7265  arker to differe
+00001740: 6e74 6961 7465 2074 6865 2065 7869 7374  ntiate the exist
+00001750: 696e 6720 636c 6173 7320 6c61 6265 6c20  ing class label 
+00001760: 200d 0a20 2020 2020 2020 2069 6e20 2779   ..        in 'y
+00001770: 5f74 7275 6527 2077 6974 6820 7468 6520  _true' with the 
+00001780: 7072 6564 6963 7465 6420 6c61 6265 6c73  predicted labels
+00001790: 2027 795f 7072 6564 2720 6573 7065 6369   'y_pred' especi
+000017a0: 616c 6c79 2077 6865 6e20 200d 0a20 2020  ally when  ..   
+000017b0: 2020 2020 2074 6865 2073 616d 6520 636c       the same cl
+000017c0: 6173 7320 6c61 6265 6c73 2061 7265 2061  ass labels are a
+000017d0: 6c73 6f20 7072 6573 656e 7420 7468 6520  lso present the 
+000017e0: 7472 7565 206c 6162 656c 2077 6974 6820  true label with 
+000017f0: 7468 6520 0d0a 2020 2020 2020 2020 7361  the ..        sa
+00001800: 6d65 206c 6162 656c 2d69 6465 6e74 6966  me label-identif
+00001810: 6965 7220 6e61 6d65 2e20 5468 6973 2075  ier name. This u
+00001820: 7365 6675 6c6c 2020 746f 2061 766f 6964  sefull  to avoid
+00001830: 2061 6e79 2063 6f6e 6675 7369 6f6e 2020   any confusion  
+00001840: 666f 720d 0a20 2020 2020 2020 2062 6f74  for..        bot
+00001850: 6820 6c61 6265 6c73 2020 696e 2060 795f  h labels  in `y_
+00001860: 7472 7565 6020 616e 6420 6079 5f70 7265  true` and `y_pre
+00001870: 6460 2066 6f72 2062 6574 7465 7220 6465  d` for better de
+00001880: 6d61 7263 6174 696f 6e20 616e 6420 0d0a  marcation and ..
+00001890: 2020 2020 2020 2020 6469 7374 696e 6374          distinct
+000018a0: 696f 6e2e 204e 6f74 6520 7468 6174 2069  ion. Note that i
+000018b0: 6620 7468 6520 6074 7261 696c 6572 6069  f the `trailer`i
+000018c0: 7320 7365 7420 746f 2060 604e 6f6e 6560  s set to ``None`
+000018d0: 6020 616e 6420 626f 7468 200d 0a20 2020  ` and both ..   
+000018e0: 2020 2020 2060 795f 7472 7565 6020 616e       `y_true` an
+000018f0: 6420 6079 5f70 7265 6460 2061 7265 206e  d `y_pred` are n
+00001900: 756d 6572 6963 2064 6174 612c 2074 6865  umeric data, the
+00001910: 206c 6162 656c 7320 696e 2060 795f 7072   labels in `y_pr
+00001920: 6564 6020 6172 6520 0d0a 2020 2020 2020  ed` are ..      
+00001930: 2020 7379 7374 656d 6174 6963 616c 6c79    systematically
+00001940: 2072 656e 616d 6564 2074 6f20 6265 2064   renamed to be d
+00001950: 6973 7469 6e63 7420 7769 7468 2074 6865  istinct with the
+00001960: 206f 6e65 7320 696e 2074 6865 2027 795f   ones in the 'y_
+00001970: 7472 7565 272e 200d 0a20 2020 2020 2020  true'. ..       
+00001980: 2046 6f72 2069 6e73 7461 6e63 6520 3a3a   For instance ::
+00001990: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
+000019a0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+000019b0: 2074 7275 655f 6c61 6265 6c73 3d5b 312c   true_labels=[1,
+000019c0: 2032 2c20 335d 203b 204e 4741 5f6c 6162   2, 3] ; NGA_lab
+000019d0: 656c 7320 3d5b 302c 2031 2c20 325d 0d0a  els =[0, 1, 2]..
+000019e0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+000019f0: 2320 7769 7468 2074 7261 696c 6572 202c  # with trailer ,
+00001a00: 204d 5853 206c 6162 656c 7320 7368 6f75   MXS labels shou
+00001a10: 6c64 2062 6520 0d0a 2020 2020 2020 2020  ld be ..        
+00001a20: 2020 2020 3e3e 3e20 204d 5853 5f6c 6162      >>>  MXS_lab
+00001a30: 656c 733d 205b 2730 272c 2027 312a 272c  els= ['0', '1*',
+00001a40: 2027 322a 272c 2027 3327 5d20 2320 3120   '2*', '3'] # 1 
+00001a50: 616e 6420 3220 6172 6520 696e 2074 7275  and 2 are in tru
+00001a60: 655f 6c61 6265 6c73 200d 0a20 2020 2020  e_labels ..     
+00001a70: 2020 2020 2020 203e 3e3e 2023 2077 6974         >>> # wit
+00001a80: 6820 6e6f 2074 7261 696c 6572 200d 0a20  h no trailer .. 
+00001a90: 2020 2020 2020 2020 2020 203e 3e3e 204d             >>> M
+00001aa0: 5853 5f6c 6162 656c 733d 205b 302c 2034  XS_labels= [0, 4
+00001ab0: 2c20 352c 2033 5d20 2320 3120 616e 6420  , 5, 3] # 1 and 
+00001ac0: 3220 6861 7665 2062 6565 6e20 6368 616e  2 have been chan
+00001ad0: 6765 6420 746f 205b 342c 2035 5d0d 0a20  ged to [4, 5].. 
+00001ae0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00001af0: 2072 6574 7572 6e5f 6f62 6a3a 203a 636c   return_obj: :cl
+00001b00: 6173 733a 6077 6174 6578 2e75 7469 6c73  ass:`watex.utils
+00001b10: 2e62 6f78 2e42 6f78 7370 6163 6560 0d0a  .box.Boxspace`..
+00001b20: 2020 2020 2020 2020 4966 2060 6054 7275          If ``Tru
+00001b30: 6560 602c 2072 6574 7572 6e73 2061 204d  e``, returns a M
+00001b40: 5853 206f 626a 6563 7420 7769 7468 2075  XS object with u
+00001b50: 7365 6675 6c6c 2061 7474 7269 6275 7465  sefull attribute
+00001b60: 7320 7375 6368 2061 733a 200d 0a20 2020  s such as: ..   
+00001b70: 2020 2020 2020 2020 202d 206d 7873 5f63           - mxs_c
+00001b80: 6c61 7373 6573 5f20 3d20 7468 6520 4d58  lasses_ = the MX
+00001b90: 5320 636c 6173 7320 6c61 6265 6c73 200d  S class labels .
+00001ba0: 0a20 2020 2020 2020 2020 2020 202d 206d  .            - m
+00001bb0: 7873 5f6c 6162 656c 735f 3d20 2074 6865  xs_labels_=  the
+00001bc0: 2061 7272 6179 2d6c 696b 6520 6f66 204d   array-like of M
+00001bd0: 5853 206c 6162 656c 732e 2049 7420 616c  XS labels. It al
+00001be0: 736f 2069 6e63 6c75 6465 7320 736f 6d65  so includes some
+00001bf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001c00: 2020 6e6f 6e20 7369 6d69 6c61 7220 6c61    non similar la
+00001c10: 6265 6c73 2066 726f 6d20 4e47 410d 0a20  bels from NGA.. 
+00001c20: 2020 2020 2020 2020 2020 206d 7873 5f6d             mxs_m
+00001c30: 6170 5f63 6c61 7373 6573 5f3d 2061 2064  ap_classes_= a d
+00001c40: 6963 7420 6f72 206f 7269 6769 6e61 6c20  ict or original 
+00001c50: 636c 6173 7320 6c61 6265 6c73 206f 6620  class labels of 
+00001c60: 7468 6520 6172 7261 790d 0a20 2020 2020  the array..     
+00001c70: 2020 2020 2020 2020 2020 2027 6b27 203c             'k' <
+00001c80: 2779 5f74 7275 6527 3e20 616e 6420 7468  'y_true'> and th
+00001c90: 6569 7220 7465 6d70 6f72 6172 7920 696e  eir temporary in
+00001ca0: 7465 6765 7220 636c 6173 7320 6c61 6265  teger class labe
+00001cb0: 6c73 2e0d 0a20 2020 2020 2020 2020 2020  ls...           
+00001cc0: 2020 2020 2049 6e64 6565 642c 2069 6620       Indeed, if 
+00001cd0: 2779 5f74 7275 6527 2063 6c61 7373 206c  'y_true' class l
+00001ce0: 6162 656c 7320 6172 6520 6e6f 7420 6120  abels are not a 
+00001cf0: 6e75 6d65 7269 6320 6474 7970 652c 200d  numeric dtype, .
+00001d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001d10: 204e 6577 206c 6162 656c 7320 7769 7468   New labels with
+00001d20: 2069 6e74 6567 6572 2064 7479 7065 2069   integer dtype i
+00001d30: 7320 6372 6561 7465 642e 2054 6865 2064  s created. The d
+00001d40: 6963 7420 6973 2075 7365 6420 746f 200d  ict is used to .
+00001d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001d60: 2077 7261 7020 7468 6520 7472 7565 206c   wrap the true l
+00001d70: 6162 656c 7320 286f 7269 6769 6e61 6c20  abels (original 
+00001d80: 6f6e 6573 2920 6475 7269 6e67 2074 6865  ones) during the
+00001d90: 204d 5853 2063 7265 6174 696f 6e2e 200d   MXS creation. .
+00001da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001db0: 2054 6875 732c 2074 6865 206f 7269 6769   Thus, the origi
+00001dc0: 6e61 6c20 6c61 6265 6c73 2061 7265 206e  nal labels are n
+00001dd0: 6f74 2061 6c74 6572 6564 2061 6e64 2077  ot altered and w
+00001de0: 696c 6c20 6265 206d 6170 2069 6e20 0d0a  ill be map in ..
+00001df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001e00: 7475 726e 2020 6174 2074 6865 2065 6e64  turn  at the end
+00001e10: 2074 6f20 7265 636f 7665 7220 7468 6569   to recover thei
+00001e20: 7220 706f 7369 7469 6f6e 7320 6173 2077  r positions as w
+00001e30: 656c 6c20 696e 200d 0a20 2020 2020 2020  ell in ..       
+00001e40: 2020 2020 2020 2020 206e 6577 204d 5853           new MXS
+00001e50: 2061 7272 6179 2e20 4974 2069 7320 7365   array. It is se
+00001e60: 7420 746f 2027 4e6f 6e65 2720 6966 2027  t to 'None' if '
+00001e70: 795f 7472 7565 2720 6861 7320 6120 6e75  y_true' has a nu
+00001e80: 6d65 7269 6320 0d0a 2020 2020 2020 2020  meric ..        
+00001e90: 2020 2020 2020 2020 6474 7970 652e 200d          dtype. .
+00001ea0: 0a20 2020 2020 2020 2020 2020 206d 7873  .            mxs
+00001eb0: 5f67 726f 7570 5f63 6c61 7373 6573 5f3a  _group_classes_:
+00001ec0: 2064 6963 7420 6f66 2061 6c6c 2074 6865   dict of all the
+00001ed0: 2073 696d 696c 6172 2067 726f 7570 206c   similar group l
+00001ee0: 6162 656c 7320 2077 6974 6820 7468 6520  abels  with the 
+00001ef0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001f00: 2020 4d58 5320 6c61 6265 6c73 2072 656c    MXS labels rel
+00001f10: 6174 6564 2066 726f 6d20 7468 6520 6d6f  ated from the mo
+00001f20: 6469 6669 6564 2065 7869 7374 696e 6720  dified existing 
+00001f30: 6772 6f75 7073 206f 6620 4e47 412e 0d0a  groups of NGA...
+00001f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001f50: 4e6f 7465 2074 6861 7420 7468 6520 6e6f  Note that the no
+00001f60: 6e2d 7369 6d69 6c61 7220 6772 6f75 7020  n-similar group 
+00001f70: 6172 6520 6d6f 6469 6669 6564 2069 6620  are modified if 
+00001f80: 7468 6569 7220 6c61 6265 6c73 200d 0a20  their labels .. 
+00001f90: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00001fa0: 7265 2061 6c73 6f20 666f 756e 6420 696e  re also found in
+00001fb0: 2074 6865 2074 7275 655f 6c61 6265 6c73   the true_labels
+00001fc0: 2074 6f20 6176 6f69 6420 616e 7920 636f   to avoid any co
+00001fd0: 6e66 7573 696f 6e2e 2054 6875 730d 0a20  nfusion. Thus.. 
+00001fe0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00001ff0: 6865 2064 6963 7420 7772 6170 2074 6865  he dict wrap the
+00002000: 206e 6f6e 2d73 696d 696c 6172 206c 6162   non-similar lab
+00002010: 656c 2077 6974 6820 7468 6569 7220 6e65  el with their ne
+00002020: 7720 7465 6d70 6f72 6179 200d 0a20 2020  w temporay ..   
+00002030: 2020 2020 2020 2020 2020 2020 206c 6162               lab
+00002040: 656c 732e 200d 0a20 2020 2020 2020 2020  els. ..         
+00002050: 2020 206d 7873 5f73 696d 696c 6172 5f67     mxs_similar_g
+00002060: 726f 7570 735f 3d20 6c69 7374 206f 6620  roups_= list of 
+00002070: 7468 6520 7369 6d69 6c61 7220 6c61 6265  the similar labe
+00002080: 6c73 2066 6f75 6e64 2069 6e20 0d0a 2020  ls found in ..  
+00002090: 2020 2020 2020 2020 2020 2020 2020 795f                y_
+000020a0: 7472 7565 2074 6861 7420 6861 7665 2061  true that have a
+000020b0: 2073 696d 696c 6172 6974 7920 696e 204e   similarity in N
+000020c0: 4741 2e20 200d 0a20 2020 2020 2020 2020  GA.  ..         
+000020d0: 2020 206d 7873 5f73 696d 696c 6172 6974     mxs_similarit
+000020e0: 795f 3d20 5475 706c 6520 6f66 2073 696d  y_= Tuple of sim
+000020f0: 696c 6172 6974 7920 696e 2070 6169 7220  ilarity in pair 
+00002100: 286c 6162 656c 2c20 6772 6f75 7029 200d  (label, group) .
+00002110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002120: 2065 7869 7374 696e 6720 6265 7477 6565   existing betwee
+00002130: 6e20 7468 6520 6c61 6265 6c20 636c 6173  n the label clas
+00002140: 7320 696e 2079 5f74 7275 6520 616e 6420  s in y_true and 
+00002150: 4e47 412e 200d 0a20 2020 2020 2020 2020  NGA. ..         
+00002160: 2020 206d 7873 5f67 726f 7570 5f6c 6162     mxs_group_lab
+00002170: 656c 735f 3d20 6c69 7374 206f 6620 7468  els_= list of th
+00002180: 6520 7369 6d69 6c61 7220 6772 6f75 7073  e similar groups
+00002190: 2066 6f75 6e64 2069 6e20 7468 6520 0d0a   found in the ..
+000021a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000021b0: 7072 6564 6963 7465 6420 4e47 4120 7468  predicted NGA th
+000021c0: 6174 2068 6176 6520 6120 7369 6d69 6c61  at have a simila
+000021d0: 7269 7479 2069 6e20 7472 7565 206c 6162  rity in true lab
+000021e0: 656c 7320 2779 5f74 7275 6527 0d0a 2020  els 'y_true'..  
+000021f0: 2020 2020 2020 0d0a 2020 2020 5265 7475        ..    Retu
+00002200: 726e 7320 0d0a 2020 2020 2d2d 2d2d 2d2d  rns ..    ------
+00002210: 2d2d 2d0d 0a20 2020 204d 5853 3a20 6172  ---..    MXS: ar
+00002220: 7261 792d 6c69 6b65 2031 6420 6f72 203a  ray-like 1d or :
+00002230: 636c 6173 733a 607e 7761 7465 782e 7574  class:`~watex.ut
+00002240: 696c 732e 626f 782e 426f 7873 7061 6365  ils.box.Boxspace
+00002250: 600d 0a20 2020 2020 2020 2061 7272 6179  `..        array
+00002260: 206c 696b 6520 6f66 204d 5853 206c 6162   like of MXS lab
+00002270: 656c 7320 6f72 204d 5853 206f 626a 6563  els or MXS objec
+00002280: 7420 636f 6e74 6169 6e69 6e67 2074 6865  t containing the
+00002290: 200d 0a20 2020 2020 2020 2075 7365 6675   ..        usefu
+000022a0: 6c6c 2061 7474 7269 6275 7465 732e 200d  ll attributes. .
+000022b0: 0a20 2020 200d 0a20 2020 2053 6565 2041  .    ..    See A
+000022c0: 6c73 6f0d 0a20 2020 202d 2d2d 2d2d 2d2d  lso..    -------
+000022d0: 2d2d 0d0a 2020 2020 7072 6564 6963 745f  --..    predict_
+000022e0: 4e47 415f 6c61 6265 6c73 3a20 5072 6564  NGA_labels: Pred
+000022f0: 6963 7473 204e 6169 7665 2067 726f 7570  icts Naive group
+00002300: 206f 6620 4171 7569 6665 7273 2020 6c61   of Aquifers  la
+00002310: 6265 6c73 2e20 0d0a 2020 2020 0d0a 2020  bels. ..    ..  
+00002320: 2020 0d0a 2020 2020 4578 616d 706c 6573    ..    Examples
+00002330: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0d  ..    ---------.
+00002340: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
+00002350: 7465 782e 6461 7461 7365 7473 2069 6d70  tex.datasets imp
+00002360: 6f72 7420 6c6f 6164 5f68 6c6f 6773 0d0a  ort load_hlogs..
+00002370: 2020 2020 3e3e 3e20 6672 6f6d 2077 6174      >>> from wat
+00002380: 6578 2e75 7469 6c73 2069 6d70 6f72 7420  ex.utils import 
+00002390: 7265 6164 5f64 6174 6120 0d0a 2020 2020  read_data ..    
+000023a0: 3e3e 3e20 6672 6f6d 2077 6174 6578 2e75  >>> from watex.u
+000023b0: 7469 6c73 2e68 7964 726f 7574 696c 7320  tils.hydroutils 
+000023c0: 696d 706f 7274 2063 6c61 7373 6966 795f  import classify_
+000023d0: 6b2c 206d 616b 655f 4d58 535f 6c61 6265  k, make_MXS_labe
+000023e0: 6c73 0d0a 2020 2020 3e3e 3e20 6461 7461  ls..    >>> data
+000023f0: 203d 206c 6f61 645f 686c 6f67 7320 2829   = load_hlogs ()
+00002400: 2e66 7261 6d65 200d 0a20 2020 203e 3e3e  .frame ..    >>>
+00002410: 2023 206d 6170 2064 6174 612e 6b20 746f   # map data.k to
+00002420: 2063 6174 6567 6f72 697a 6520 6b20 7661   categorize k va
+00002430: 6c75 6573 200d 0a20 2020 203e 3e3e 2079  lues ..    >>> y
+00002440: 6d61 7020 3d20 636c 6173 7369 6679 5f6b  map = classify_k
+00002450: 2864 6174 612e 6b20 2c20 6465 6661 756c  (data.k , defaul
+00002460: 745f 6675 6e63 203d 5472 7565 2920 0d0a  t_func =True) ..
+00002470: 2020 2020 3e3e 3e20 795f 6d78 7320 3d20      >>> y_mxs = 
+00002480: 6d61 6b65 5f4d 5853 5f6c 6162 656c 7320  make_MXS_labels 
+00002490: 2879 6d61 702c 2064 6174 612e 6171 7569  (ymap, data.aqui
+000024a0: 6665 725f 6772 6f75 7029 0d0a 2020 2020  fer_group)..    
+000024b0: 3e3e 3e20 795f 6d78 735b 3134 3a32 345d  >>> y_mxs[14:24]
+000024c0: 200d 0a20 2020 202e 2e2e 2020 6172 7261   ..    ...  arra
+000024d0: 7928 5b27 4927 2c20 2749 272c 2032 2c20  y(['I', 'I', 2, 
+000024e0: 322c 2032 2c20 322c 2032 2c20 322c 2032  2, 2, 2, 2, 2, 2
+000024f0: 2c20 325d 2c20 6474 7970 653d 6f62 6a65  , 2], dtype=obje
+00002500: 6374 290d 0a20 2020 203e 3e3e 206d 7873  ct)..    >>> mxs
+00002510: 5f6f 626a 203d 206d 616b 655f 4d58 535f  _obj = make_MXS_
+00002520: 6c61 6265 6c73 2028 796d 6170 2c20 6461  labels (ymap, da
+00002530: 7461 2e61 7175 6966 6572 5f67 726f 7570  ta.aquifer_group
+00002540: 2c20 7265 7475 726e 5f6f 626a 3d54 7275  , return_obj=Tru
+00002550: 6520 290d 0a20 2020 203e 3e3e 206d 7873  e )..    >>> mxs
+00002560: 5f6f 626a 2e6d 7873 5f6c 6162 656c 735f  _obj.mxs_labels_
+00002570: 5b31 343a 2032 345d 0d0a 2020 2020 2e2e  [14: 24]..    ..
+00002580: 2e20 6172 7261 7928 5b27 4927 2c20 2749  . array(['I', 'I
+00002590: 272c 2032 2c20 322c 2032 2c20 322c 2032  ', 2, 2, 2, 2, 2
+000025a0: 2c20 322c 2032 2c20 325d 2c20 6474 7970  , 2, 2, 2], dtyp
+000025b0: 653d 6f62 6a65 6374 290d 0a20 2020 203e  e=object)..    >
+000025c0: 3e3e 2023 206e 6f77 2077 6520 6469 6420  >> # now we did 
+000025d0: 7468 6520 7361 6d65 2074 6173 6b20 7573  the same task us
+000025e0: 696e 6720 7468 6520 7072 6976 6174 6520  ing the private 
+000025f0: 6461 7461 2027 6866 2e63 7376 270d 0a20  data 'hf.csv'.. 
+00002600: 2020 203e 3e3e 2023 2063 6f6d 706f 7365     >>> # compose
+00002610: 6420 6f66 2031 3120 626f 7265 686f 6c65  d of 11 borehole
+00002620: 732e 2046 6f72 2064 6566 6175 6c74 2077  s. For default w
+00002630: 6520 616c 7465 726e 6174 6976 656c 7920  e alternatively 
+00002640: 7573 6573 200d 0a20 2020 203e 3e3e 2023  uses ..    >>> #
+00002650: 2074 6865 2061 7175 6966 6572 2067 726f   the aquifer gro
+00002660: 7570 7320 6c69 6b65 2061 2066 616b 6520  ups like a fake 
+00002670: 4e47 4120 0d0a 2020 2020 3e3e 3e20 6461  NGA ..    >>> da
+00002680: 7461 203d 2072 6561 645f 6461 7461 2028  ta = read_data (
+00002690: 2764 6174 612f 626f 7265 686f 6c65 732f  'data/boreholes/
+000026a0: 6866 2e63 7376 2729 200d 0a20 2020 203e  hf.csv') ..    >
+000026b0: 3e3e 2079 6d61 7020 3d20 2063 6c61 7373  >> ymap =  class
+000026c0: 6966 795f 6b28 6461 7461 2e6b 202c 2064  ify_k(data.k , d
+000026d0: 6566 6175 6c74 5f66 756e 6320 3d54 7275  efault_func =Tru
+000026e0: 6529 2020 0d0a 2020 2020 3e3e 3e20 795f  e)  ..    >>> y_
+000026f0: 6d78 733d 206d 616b 655f 4d58 535f 6c61  mxs= make_MXS_la
+00002700: 6265 6c73 2028 796d 6170 2c20 6461 7461  bels (ymap, data
+00002710: 2e61 7175 6966 6572 5f67 726f 7570 290d  .aquifer_group).
+00002720: 0a20 2020 203e 3e3e 206e 702e 756e 6971  .    >>> np.uniq
+00002730: 7565 2028 795f 6d78 7329 0d0a 2020 2020  ue (y_mxs)..    
+00002740: 2e2e 2e20 6172 7261 7928 5b27 3127 2c20  ... array(['1', 
+00002750: 2731 5627 2c20 2732 272c 2027 3249 4949  '1V', '2', '2III
+00002760: 272c 2027 3327 2c20 2749 272c 2027 4949  ', '3', 'I', 'II
+00002770: 272c 2027 4949 4926 4956 272c 2027 4956  ', 'III&IV', 'IV
+00002780: 275d 2c0d 0a20 2020 2020 2020 2020 2064  '],..          d
+00002790: 7479 7065 3d27 3c55 3627 290d 0a20 2020  type='<U6')..   
+000027a0: 203e 3e3e 2023 202a 636f 6d6d 656e 7473   >>> # *comments
+000027b0: 3a20 0d0a 2020 2020 2020 2020 2320 6c61  : ..        # la
+000027c0: 6265 6c20 2731 5627 206d 6561 6e73 2074  bel '1V' means t
+000027d0: 6865 2067 726f 7570 2056 2028 6578 7065  he group V (expe
+000027e0: 6374 6564 2074 6f20 6265 2061 2063 6c75  cted to be a clu
+000027f0: 7374 6572 2920 0d0a 2020 2020 2020 2020  ster) ..        
+00002800: 2320 616e 6420 6c61 6265 6c20 3120 2874  # and label 1 (t
+00002810: 7275 6520 6c61 6265 6c73 2920 6861 7665  rue labels) have
+00002820: 2061 2073 696d 696c 6172 6974 7920 0d0a   a similarity ..
+00002830: 2020 2020 2020 2020 2320 7468 6520 7361          # the sa
+00002840: 6d65 206f 6620 6c61 6265 6c20 2732 4949  me of label '2II
+00002850: 4927 2077 6869 6c65 2074 6865 2072 656d  I' while the rem
+00002860: 6169 6e20 6c61 6265 6c20 3320 646f 6573  ain label 3 does
+00002870: 206e 6f74 2020 0d0a 2020 2020 2020 2020   not  ..        
+00002880: 2320 2061 6e79 2073 696d 696c 6172 6974  #  any similarit
+00002890: 7920 696e 2074 6865 206f 7468 6572 206c  y in the other l
+000028a0: 6162 656c 7320 2069 6e20 7468 6520 2779  abels  in the 'y
+000028b0: 5f70 7265 6427 2065 7870 6563 7465 6420  _pred' expected 
+000028c0: 0d0a 2020 2020 2020 2020 2320 746f 2062  ..        # to b
+000028d0: 6520 4e47 4120 6c61 6265 6c73 2e20 0d0a  e NGA labels. ..
+000028e0: 2020 2020 2020 2020 0d0a 2020 2020 2222          ..    ""
+000028f0: 220d 0a20 2020 2043 4f4e 5445 5854 5f4d  "..    CONTEXT_M
+00002900: 5347 203d 2028 0d0a 2020 2020 2020 2020  SG = (..        
+00002910: 2243 616e 206f 6e6c 7920 7072 6f63 6573  "Can only proces
+00002920: 7320 756e 6675 6e63 207b 3021 727d 2069  s unfunc {0!r} i
+00002930: 6620 616e 6420 6f6e 6c79 2069 6620 7b31  f and only if {1
+00002940: 7d20 7369 6d69 6c61 7269 7479 220d 0a20  } similarity".. 
+00002950: 2020 2020 2020 2022 2069 7320 666f 756e         " is foun
+00002960: 6420 6265 7477 6565 6e20 7472 7565 206c  d between true l
+00002970: 6162 656c 7320 696e 2027 795f 7472 7565  abels in 'y_true
+00002980: 2720 616e 6420 7468 6520 7072 6564 6963  ' and the predic
+00002990: 7465 6420 4e47 4122 0d0a 2020 2020 2020  ted NGA"..      
+000029a0: 2020 2220 6c61 6265 6c73 2069 6e20 2779    " labels in 'y
+000029b0: 5f70 7265 6427 2e22 0d0a 2020 2020 2020  _pred'."..      
+000029c0: 2020 290d 0a20 2020 200d 0a20 2020 2073    )..    ..    s
+000029d0: 6570 203d 2073 6570 206f 7220 2727 200d  ep = sep or '' .
+000029e0: 0a20 2020 2070 7265 6669 7820 3d20 7072  .    prefix = pr
+000029f0: 6566 6978 206f 7220 2727 200d 0a20 2020  efix or '' ..   
+00002a00: 2023 2066 6f72 2063 6f6e 7369 7374 656e   # for consisten
+00002a10: 6379 0d0a 2020 2020 2320 6368 6563 6b20  cy..    # check 
+00002a20: 6172 7261 7973 200d 0a20 2020 2079 5f74  arrays ..    y_t
+00002a30: 7275 6520 3d20 6368 6563 6b5f 7920 280d  rue = check_y (.
+00002a40: 0a20 2020 2020 2020 2079 5f74 7275 652c  .        y_true,
+00002a50: 200d 0a20 2020 2020 2020 2061 6c6c 6f77   ..        allow
+00002a60: 5f6e 616e 3d20 5472 7565 2c20 0d0a 2020  _nan= True, ..  
+00002a70: 2020 2020 2020 746f 5f66 7261 6d65 203d        to_frame =
+00002a80: 5472 7565 2c20 0d0a 2020 2020 2020 2020  True, ..        
+00002a90: 696e 7075 745f 6e61 6d65 3d22 795f 7472  input_name="y_tr
+00002aa0: 7565 222c 0d0a 2020 2020 2020 2020 2920  ue",..        ) 
+00002ab0: 200d 0a0d 0a20 2020 2079 5f70 7265 6420   ....    y_pred 
+00002ac0: 3d20 6368 6563 6b5f 7920 280d 0a20 2020  = check_y (..   
+00002ad0: 2020 2020 2079 5f70 7265 642c 200d 0a20       y_pred, .. 
+00002ae0: 2020 2020 2020 2074 6f5f 6672 616d 6520         to_frame 
+00002af0: 3d20 5472 7565 2c20 0d0a 2020 2020 2020  = True, ..      
+00002b00: 2020 616c 6c6f 775f 6e61 6e3d 2046 616c    allow_nan= Fal
+00002b10: 7365 2c20 0d0a 2020 2020 2020 2020 696e  se, ..        in
+00002b20: 7075 745f 6e61 6d65 203d 224e 4741 206c  put_name ="NGA l
+00002b30: 6162 656c 7322 0d0a 2020 2020 2020 2020  abels"..        
+00002b40: 290d 0a0d 0a20 2020 205f 6368 6563 6b5f  )....    _check_
+00002b50: 636f 6e73 6973 7465 6e63 795f 7369 7a65  consistency_size
+00002b60: 2879 5f74 7275 652c 2079 5f70 7265 6420  (y_true, y_pred 
+00002b70: 2920 0d0a 2020 2020 2320 6368 6563 6b20  ) ..    # check 
+00002b80: 7768 6574 6865 7220 7468 6520 795f 7472  whether the y_tr
+00002b90: 7565 2069 7320 6e75 6d65 7269 6361 6c20  ue is numerical 
+00002ba0: 6461 7461 200d 0a20 2020 2023 2069 6620  data ..    # if 
+00002bb0: 6e6f 7420 7265 6e61 6d65 2079 5f74 7275  not rename y_tru
+00002bc0: 6520 616e 6420 6b65 6570 2074 6865 2063  e and keep the c
+00002bd0: 6c61 7373 6573 200d 0a20 2020 2023 2066  lasses ..    # f
+00002be0: 6f72 206d 6170 7069 6e67 2061 7420 7468  or mapping at th
+00002bf0: 6520 656e 6420 6f66 2063 6c61 7373 2074  e end of class t
+00002c00: 7261 6e73 666f 726d 6174 696f 6e20 0d0a  ransformation ..
+00002c10: 2020 2020 2379 5f74 7275 655f 7472 616e      #y_true_tran
+00002c20: 7366 2c20 6d78 735f 6d61 705f 636c 6173  sf, mxs_map_clas
+00002c30: 7365 735f 2020 3d20 5f6b 6d61 7070 696e  ses_  = _kmappin
+00002c40: 6728 2079 5f74 7275 6520 290d 0a20 2020  g( y_true )..   
+00002c50: 200d 0a20 2020 2069 6620 7369 6d69 6c61   ..    if simila
+00002c60: 725f 6c61 6265 6c73 2069 7320 4e6f 6e65  r_labels is None
+00002c70: 3a20 0d0a 2020 2020 2020 2020 7369 6d69  : ..        simi
+00002c80: 6c61 725f 6c61 6265 6c73 203d 2066 696e  lar_labels = fin
+00002c90: 645f 7369 6d69 6c61 725f 6c61 6265 6c73  d_similar_labels
+00002ca0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+00002cb0: 795f 7472 7565 2c20 0d0a 2020 2020 2020  y_true, ..      
+00002cc0: 2020 2020 2020 795f 7072 6564 2c20 0d0a        y_pred, ..
+00002cd0: 2020 2020 2020 2020 2020 2020 7468 7265              thre
+00002ce0: 7368 6f6c 643d 2074 6872 6573 686f 6c64  shold= threshold
+00002cf0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00002d00: 6d65 7468 6f64 3d6d 6574 686f 642c 200d  method=method, .
+00002d10: 0a20 2020 2020 2020 2020 2020 202a 2a6b  .            **k
+00002d20: 7773 200d 0a20 2020 2020 2020 2020 2020  ws ..           
+00002d30: 2029 200d 0a20 2020 2020 2020 200d 0a20   ) ..        .. 
+00002d40: 2020 2043 4f4e 5445 5854 203d 2027 6e6f     CONTEXT = 'no
+00002d50: 2720 6966 206c 656e 2873 696d 696c 6172  ' if len(similar
+00002d60: 5f6c 6162 656c 7329 3d3d 3020 2065 6c73  _labels)==0  els
+00002d70: 6520 2773 696d 696c 6172 6974 7920 6973  e 'similarity is
+00002d80: 2066 6f75 6e64 2720 0d0a 0d0a 2020 2020   found' ....    
+00002d90: 6966 2043 4f4e 5445 5854 203d 3d27 6e6f  if CONTEXT =='no
+00002da0: 2720 3a20 0d0a 2020 2020 2020 2020 795f  ' : ..        y_
+00002db0: 6d78 732c 2067 726f 7570 5f63 6c61 7373  mxs, group_class
+00002dc0: 6573 5f2c 2067 726f 7570 5f6c 6162 656c  es_, group_label
+00002dd0: 732c 2073 696d 5f67 726f 7570 7320 3d20  s, sim_groups = 
+00002de0: 5f4d 5853 5f69 665f 6e6f 280d 0a20 2020  _MXS_if_no(..   
+00002df0: 2020 2020 2020 2020 2043 4f4e 5445 5854           CONTEXT
+00002e00: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00002e10: 795f 7472 7565 2c20 0d0a 2020 2020 2020  y_true, ..      
+00002e20: 2020 2020 2020 795f 7072 6564 2c20 0d0a        y_pred, ..
+00002e30: 2020 2020 2020 2020 2020 2020 636d 7367              cmsg
+00002e40: 3d43 4f4e 5445 5854 5f4d 5347 202c 200d  =CONTEXT_MSG , .
+00002e50: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
+00002e60: 696c 6572 3d74 7261 696c 6572 200d 0a20  iler=trailer .. 
+00002e70: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00002e80: 2020 656c 7365 203a 200d 0a20 2020 2020    else : ..     
+00002e90: 2020 2079 5f6d 7873 2c20 6772 6f75 705f     y_mxs, group_
+00002ea0: 636c 6173 7365 735f 2c20 6772 6f75 705f  classes_, group_
+00002eb0: 6c61 6265 6c73 2c20 7369 6d5f 6772 6f75  labels, sim_grou
+00002ec0: 7073 203d 205f 4d58 535f 6966 5f79 6573  ps = _MXS_if_yes
+00002ed0: 280d 0a20 2020 2020 2020 2020 2020 2043  (..            C
+00002ee0: 4f4e 5445 5854 202c 200d 0a20 2020 2020  ONTEXT , ..     
+00002ef0: 2020 2020 2020 2073 696d 696c 6172 5f6c         similar_l
+00002f00: 6162 656c 732c 200d 0a20 2020 2020 2020  abels, ..       
+00002f10: 2020 2020 2079 5f70 7265 642c 200d 0a20       y_pred, .. 
+00002f20: 2020 2020 2020 2020 2020 2079 5f74 7275             y_tru
+00002f30: 652c 200d 0a20 2020 2020 2020 2020 2020  e, ..           
+00002f40: 2073 6570 203d 7365 702c 0d0a 2020 2020   sep =sep,..    
+00002f50: 2020 2020 2020 2020 7072 6566 6978 3d20          prefix= 
+00002f60: 7072 6566 6978 2c20 0d0a 2020 2020 2020  prefix, ..      
+00002f70: 2020 2020 2020 636d 7367 3d20 434f 4e54        cmsg= CONT
+00002f80: 4558 545f 4d53 472c 200d 0a20 2020 2020  EXT_MSG, ..     
+00002f90: 2020 2020 2020 2074 7261 696c 6572 3d20         trailer= 
+00002fa0: 7472 6169 6c65 7220 0d0a 2020 2020 2020  trailer ..      
+00002fb0: 2020 290d 0a20 2020 2023 2023 2073 6176    )..    # # sav
+00002fc0: 6520 7468 6520 6e6f 745f 6e61 6e20 696e  e the not_nan in
+00002fd0: 6469 6365 7320 746f 206e 6f74 200d 0a20  dices to not .. 
+00002fe0: 2020 2023 2023 2061 6c74 6572 6564 2074     # # altered t
+00002ff0: 6865 206b 2d76 616c 6964 2076 616c 7565  he k-valid value
+00003000: 7320 0d0a 2020 2020 6e6f 745f 6e61 6e5f  s ..    not_nan_
+00003010: 696e 6469 6365 732c 2020 3d20 6e70 2e77  indices,  = np.w
+00003020: 6865 7265 2028 207e 6e70 2e69 736e 616e  here ( ~np.isnan
+00003030: 2028 795f 7472 7565 2920 290d 0a20 2020   (y_true) )..   
+00003040: 2023 2023 206e 6f74 2061 6c74 6572 6564   # # not altered
+00003050: 2074 6865 206b 2d76 616c 6964 2064 6174   the k-valid dat
+00003060: 610d 0a20 2020 2074 7279 3a20 0d0a 2020  a..    try: ..  
+00003070: 2020 2020 2020 2320 7472 7920 746f 2072        # try to r
+00003080: 6563 6f6e 7665 7274 2063 6c61 7373 206c  econvert class l
+00003090: 6162 656c 7320 746f 2069 6e74 6567 6572  abels to integer
+000030a0: 0d0a 2020 2020 2020 2020 2320 6966 2063  ..        # if c
+000030b0: 6c61 7373 2061 7265 206e 756d 6572 6963  lass are numeric
+000030c0: 2076 616c 7565 732c 206f 7468 6572 7769   values, otherwi
+000030d0: 7365 2020 0d0a 2020 2020 2020 2020 2320  se  ..        # 
+000030e0: 6b65 6570 2074 6865 2076 616c 7565 7320  keep the values 
+000030f0: 6173 2074 6865 7920 7765 7265 2e0d 0a20  as they were... 
+00003100: 2020 2020 2020 2079 5f6d 7873 205b 6e6f         y_mxs [no
+00003110: 745f 6e61 6e5f 696e 6469 6365 735d 203d  t_nan_indices] =
+00003120: 2079 5f74 7275 6520 5b6e 6f74 5f6e 616e   y_true [not_nan
+00003130: 5f69 6e64 6963 6573 5d2e 6173 7479 7065  _indices].astype
+00003140: 286e 702e 696e 7433 3229 0d0a 2020 2020  (np.int32)..    
+00003150: 6578 6365 7074 203a 2020 0d0a 2020 2020  except :  ..    
+00003160: 2020 2020 795f 6d78 7320 5b6e 6f74 5f6e      y_mxs [not_n
+00003170: 616e 5f69 6e64 6963 6573 5d20 3d20 795f  an_indices] = y_
+00003180: 7472 7565 205b 6e6f 745f 6e61 6e5f 696e  true [not_nan_in
+00003190: 6469 6365 735d 0d0a 2020 2020 0d0a 2020  dices]..    ..  
+000031a0: 2020 236c 6574 2070 616e 6461 7320 746f    #let pandas to
+000031b0: 2066 696e 6420 7468 6520 6265 7374 2064   find the best d
+000031c0: 7479 7065 2073 696e 6365 200d 0a20 2020  type since ..   
+000031d0: 2023 2073 7472 696e 6720 7661 6c75 6520   # string value 
+000031e0: 696e 2079 5f6d 7873 206f 626a 6563 7420  in y_mxs object 
+000031f0: 7265 6d61 696e 2061 2073 7472 696e 6720  remain a string 
+00003200: 0d0a 2020 2020 2320 6f62 6a65 6374 2069  ..    # object i
+00003210: 6e20 6461 7461 0d0a 2020 2020 795f 6d78  n data..    y_mx
+00003220: 7320 3d20 7064 2e53 6572 6965 7320 2879  s = pd.Series (y
+00003230: 5f6d 7873 2c20 6e61 6d65 203d 276d 7873  _mxs, name ='mxs
+00003240: 2729 2e76 616c 7565 7320 0d0a 0d0a 2020  ').values ....  
+00003250: 2020 7472 7920 3a20 0d0a 2020 2020 2020    try : ..      
+00003260: 2020 795f 6d78 7320 3d20 795f 6d78 7320    y_mxs = y_mxs 
+00003270: 2e61 7374 7970 6520 2869 6e74 2920 0d0a  .astype (int) ..
+00003280: 2020 2020 6578 6365 7074 203a 2079 5f6d      except : y_m
+00003290: 7873 3d20 795f 6d78 732e 6173 7479 7065  xs= y_mxs.astype
+000032a0: 2873 7472 2029 0d0a 2020 2020 0d0a 2020  (str )..    ..  
+000032b0: 2020 4d58 5320 3d79 5f6d 7873 202e 636f    MXS =y_mxs .co
+000032c0: 7079 2829 200d 0a20 2020 200d 0a20 2020  py() ..    ..   
+000032d0: 2069 6620 7265 7475 726e 5f6f 626a 203a   if return_obj :
+000032e0: 200d 0a20 2020 2020 2020 2023 2063 7265   ..        # cre
+000032f0: 6174 6520 6120 6d65 7461 7479 7065 206f  ate a metatype o
+00003300: 6620 6d69 7874 7572 6520 6f62 6a65 6374  f mixture object
+00003310: 2063 6c61 7373 2061 6e64 200d 0a20 2020   class and ..   
+00003320: 2020 2020 2023 2077 7261 7070 2074 6865       # wrapp the
+00003330: 2069 6d70 6f72 7461 6e63 6520 6174 7472   importance attr
+00003340: 6962 7574 6573 200d 0a20 2020 2020 2020  ibutes ..       
+00003350: 2074 7279 203a 200d 0a20 2020 2020 2020   try : ..       
+00003360: 2020 2020 206d 7873 5f63 6c61 7373 6573       mxs_classes
+00003370: 5f20 3d20 6e70 2e75 6e69 7175 6520 2879  _ = np.unique (y
+00003380: 5f6d 7873 2920 0d0a 2020 2020 2020 2020  _mxs) ..        
+00003390: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+000033a0: 2020 2020 206d 7873 5f63 6c61 7373 6573       mxs_classes
+000033b0: 5f20 3d20 6e70 2e75 6e69 7175 6520 2879  _ = np.unique (y
+000033c0: 5f6d 7873 2e61 7374 7970 6520 2873 7472  _mxs.astype (str
+000033d0: 2029 2029 200d 0a20 2020 2020 2020 2020   ) ) ..         
+000033e0: 2020 200d 0a20 2020 2020 2020 204d 5853     ..        MXS
+000033f0: 5f61 7474 7269 6275 7465 7320 3d20 6469  _attributes = di
+00003400: 6374 2028 0d0a 2020 2020 2020 2020 2020  ct (..          
+00003410: 2020 6d78 735f 636c 6173 7365 735f 203d    mxs_classes_ =
+00003420: 206d 7873 5f63 6c61 7373 6573 5f2c 200d   mxs_classes_, .
+00003430: 0a20 2020 2020 2020 2020 2020 206d 7873  .            mxs
+00003440: 5f6c 6162 656c 735f 3d20 795f 6d78 7320  _labels_= y_mxs 
+00003450: 2c20 200d 0a20 2020 2020 2020 2020 2020  ,  ..           
+00003460: 2023 206d 7873 5f6d 6170 5f63 6c61 7373   # mxs_map_class
+00003470: 6573 5f3d 206d 7873 5f6d 6170 5f63 6c61  es_= mxs_map_cla
+00003480: 7373 6573 5f2c 200d 0a20 2020 2020 2020  sses_, ..       
+00003490: 2020 2020 206d 7873 5f67 726f 7570 5f63       mxs_group_c
+000034a0: 6c61 7373 6573 5f3d 6772 6f75 705f 636c  lasses_=group_cl
+000034b0: 6173 7365 735f 202c 0d0a 2020 2020 2020  asses_ ,..      
+000034c0: 2020 2020 2020 6d78 735f 7369 6d69 6c61        mxs_simila
+000034d0: 725f 6c61 6265 6c73 5f3d 2073 696d 696c  r_labels_= simil
+000034e0: 6172 5f6c 6162 656c 732c 200d 0a20 2020  ar_labels, ..   
+000034f0: 2020 2020 2020 2020 206d 7873 5f73 696d           mxs_sim
+00003500: 696c 6172 6974 795f 3d20 7369 6d5f 6772  ilarity_= sim_gr
+00003510: 6f75 7073 2c20 200d 0a20 2020 2020 2020  oups,  ..       
+00003520: 2020 2020 206d 7873 5f67 726f 7570 5f6c       mxs_group_l
+00003530: 6162 656c 735f 3d20 6772 6f75 705f 6c61  abels_= group_la
+00003540: 6265 6c73 0d0a 2020 2020 2020 2020 2020  bels..          
+00003550: 2020 2920 200d 0a20 2020 2020 2020 200d    )  ..        .
+00003560: 0a20 2020 2020 2020 204d 5853 203d 2042  .        MXS = B
+00003570: 6f78 7370 6163 6528 2a2a 4d58 535f 6174  oxspace(**MXS_at
+00003580: 7472 6962 7574 6573 290d 0a20 2020 2020  tributes)..     
+00003590: 2020 200d 0a20 2020 2072 6574 7572 6e20     ..    return 
+000035a0: 4d58 5320 0d0a 0d0a 6465 6620 7072 6564  MXS ....def pred
+000035b0: 6963 745f 4e47 415f 6c61 6265 6c73 2820  ict_NGA_labels( 
+000035c0: 0d0a 2020 2020 2020 2020 582c 202f 202c  ..        X, / ,
+000035d0: 206e 5f63 6c75 7374 6572 7320 2c20 7261   n_clusters , ra
+000035e0: 6e64 6f6d 5f73 7461 7465 203d 3020 2c20  ndom_state =0 , 
+000035f0: 6b65 6570 5f6c 6162 656c 5f30 203d 2046  keep_label_0 = F
+00003600: 616c 7365 2c20 0d0a 2020 2020 2020 2020  alse, ..        
+00003610: 6e5f 696e 6974 3d22 6175 746f 222c 7265  n_init="auto",re
+00003620: 7475 726e 5f63 6c75 7374 6572 5f63 656e  turn_cluster_cen
+00003630: 7465 7273 203d 4661 6c73 652c 2020 2a2a  ters =False,  **
+00003640: 6b77 7320 0d0a 2020 2020 2020 2020 293a  kws ..        ):
+00003650: 200d 0a20 2020 2022 2222 0d0a 2020 2020   ..    """..    
+00003660: 5072 6564 6963 7420 7468 6520 4e61 6976  Predict the Naiv
+00003670: 6520 4772 6f75 7020 6f66 2041 7175 6966  e Group of Aquif
+00003680: 6572 2028 4e47 4129 206c 6162 656c 732e  er (NGA) labels.
+00003690: 200d 0a20 2020 200d 0a20 2020 2050 6172   ..    ..    Par
+000036a0: 616d 6574 6572 730d 0a20 2020 202d 2d2d  ameters..    ---
+000036b0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2058 203a  -------..    X :
+000036c0: 207b 6172 7261 792d 6c69 6b65 2c20 7370   {array-like, sp
+000036d0: 6172 7365 206d 6174 7269 787d 206f 6620  arse matrix} of 
+000036e0: 7368 6170 6520 286e 5f73 616d 706c 6573  shape (n_samples
+000036f0: 2c20 6e5f 6665 6174 7572 6573 290d 0a20  , n_features).. 
+00003700: 2020 2020 2020 2054 7261 696e 696e 6720         Training 
+00003710: 696e 7374 616e 6365 7320 746f 2063 6c75  instances to clu
+00003720: 7374 6572 2e20 4974 206d 7573 7420 6265  ster. It must be
+00003730: 206e 6f74 6564 2074 6861 7420 7468 6520   noted that the 
+00003740: 6461 7461 0d0a 2020 2020 2020 2020 7769  data..        wi
+00003750: 6c6c 2062 6520 636f 6e76 6572 7465 6420  ll be converted 
+00003760: 746f 2043 206f 7264 6572 696e 672c 2077  to C ordering, w
+00003770: 6869 6368 2077 696c 6c20 6361 7573 6520  hich will cause 
+00003780: 6120 6d65 6d6f 7279 0d0a 2020 2020 2020  a memory..      
+00003790: 2020 636f 7079 2069 6620 7468 6520 6769    copy if the gi
+000037a0: 7665 6e20 6461 7461 2069 7320 6e6f 7420  ven data is not 
+000037b0: 432d 636f 6e74 6967 756f 7573 2e0d 0a20  C-contiguous... 
+000037c0: 2020 2020 2020 2049 6620 6120 7370 6172         If a spar
+000037d0: 7365 206d 6174 7269 7820 6973 2070 6173  se matrix is pas
+000037e0: 7365 642c 2061 2063 6f70 7920 7769 6c6c  sed, a copy will
+000037f0: 2062 6520 6d61 6465 2069 6620 6974 2773   be made if it's
+00003800: 206e 6f74 2069 6e0d 0a20 2020 2020 2020   not in..       
+00003810: 2043 5352 2066 6f72 6d61 742e 0d0a 2020   CSR format...  
+00003820: 2020 6e5f 636c 7573 7465 7273 203a 2069    n_clusters : i
+00003830: 6e74 2c20 6465 6661 756c 743d 380d 0a20  nt, default=8.. 
+00003840: 2020 2020 2020 2054 6865 206e 756d 6265         The numbe
+00003850: 7220 6f66 2063 6c75 7374 6572 7320 746f  r of clusters to
+00003860: 2066 6f72 6d20 6173 2077 656c 6c20 6173   form as well as
+00003870: 2074 6865 206e 756d 6265 7220 6f66 0d0a   the number of..
+00003880: 2020 2020 2020 2020 6365 6e74 726f 6964          centroid
+00003890: 7320 746f 2067 656e 6572 6174 652e 0d0a  s to generate...
+000038a0: 0d0a 2020 2020 7261 6e64 6f6d 5f73 7461  ..    random_sta
+000038b0: 7465 203a 2069 6e74 2c20 5261 6e64 6f6d  te : int, Random
+000038c0: 5374 6174 6520 696e 7374 616e 6365 206f  State instance o
+000038d0: 7220 4e6f 6e65 2c20 6465 6661 756c 743d  r None, default=
+000038e0: 3432 0d0a 2020 2020 2020 2020 4465 7465  42..        Dete
+000038f0: 726d 696e 6573 2072 616e 646f 6d20 6e75  rmines random nu
+00003900: 6d62 6572 2067 656e 6572 6174 696f 6e20  mber generation 
+00003910: 666f 7220 6365 6e74 726f 6964 2069 6e69  for centroid ini
+00003920: 7469 616c 697a 6174 696f 6e2e 2055 7365  tialization. Use
+00003930: 0d0a 2020 2020 2020 2020 616e 2069 6e74  ..        an int
+00003940: 2074 6f20 6d61 6b65 2074 6865 2072 616e   to make the ran
+00003950: 646f 6d6e 6573 7320 6465 7465 726d 696e  domness determin
+00003960: 6973 7469 632e 0d0a 2020 200d 0a20 2020  istic...   ..   
+00003970: 206b 6565 705f 6c61 6265 6c5f 303a 2062   keep_label_0: b
+00003980: 6f6f 6c2c 2064 6566 6175 6c74 3d46 616c  ool, default=Fal
+00003990: 7365 0d0a 2020 2020 2020 2020 5468 6520  se..        The 
+000039a0: 7072 6564 6963 7469 6f6e 2061 6c72 6561  prediction alrea
+000039b0: 6479 2069 6e63 6c75 6465 7320 7468 6520  dy includes the 
+000039c0: 6c61 6265 6c20 302e 2048 6f77 6576 6572  label 0. However
+000039d0: 2c20 696e 636c 7564 696e 6720 3020 696e  , including 0 in
+000039e0: 200d 0a20 2020 2020 2020 2074 6865 2070   ..        the p
+000039f0: 7265 6469 6374 6564 206c 6162 656c 2072  redicted label r
+00003a00: 6566 6572 7320 746f 2027 6b3d 3027 2069  efers to 'k=0' i
+00003a10: 2e65 2e20 7065 726d 6561 6269 6c69 7479  .e. permeability
+00003a20: 2063 6f65 6666 6963 6965 6e74 200d 0a20   coefficient .. 
+00003a30: 2020 2020 2020 2065 7175 616c 7320 746f         equals to
+00003a40: 2030 2c20 7768 6963 6820 6973 206e 6f74   0, which is not
+00003a50: 2054 7275 6520 696e 2070 7269 6e63 6970   True in princip
+00003a60: 6c65 2c20 6265 6361 7573 6520 616c 6c20  le, because all 
+00003a70: 726f 636b 7320 2068 6176 6520 0d0a 2020  rocks  have ..  
+00003a80: 2020 2020 2020 6120 7065 726d 6561 6269        a permeabi
+00003a90: 6c69 7479 2063 6f65 6666 6963 6965 6e74  lity coefficient
+00003aa0: 2027 6b27 2e20 4865 7265 2077 6520 636f   'k'. Here we co
+00003ab0: 6e73 6964 6572 6564 2027 6b3d 3027 2061  nsidered 'k=0' a
+00003ac0: 7320 616e 2075 6e64 6566 696e 6564 200d  s an undefined .
+00003ad0: 0a20 2020 2020 2020 2070 6572 6d65 6162  .        permeab
+00003ae0: 696c 6974 7920 636f 6566 6669 6369 656e  ility coefficien
+00003af0: 742e 2054 6865 7265 666f 7265 2c20 2730  t. Therefore, '0
+00003b00: 2720 2c20 6361 6e20 6265 2065 7863 6c75  ' , can be exclu
+00003b10: 6465 2073 696e 6365 2c20 6974 2063 616e  de since, it can
+00003b20: 200d 0a20 2020 2020 2020 2061 6c73 6f20   ..        also 
+00003b30: 636f 6e73 6964 6572 6564 2061 7320 6120  considered as a 
+00003b40: 6d69 7373 696e 6720 276b 272d 7661 6c75  missing 'k'-valu
+00003b50: 652e 2049 6620 7072 6564 6963 7465 6420  e. If predicted 
+00003b60: 2730 2720 6973 2069 6e20 7468 6520 7461  '0' is in the ta
+00003b70: 7267 6574 200d 0a20 2020 2020 2020 2069  rget ..        i
+00003b80: 7420 7368 6f75 6c64 206d 6561 6e20 6120  t should mean a 
+00003b90: 6d69 7373 696e 6720 276b 272d 7661 6c75  missing 'k'-valu
+00003ba0: 6520 7261 7468 6572 2074 6861 6e20 6265  e rather than be
+00003bb0: 696e 6720 6120 636f 6e63 7265 7465 206c  ing a concrete l
+00003bc0: 6162 656c 2e20 200d 0a20 2020 2020 2020  abel.  ..       
+00003bd0: 2054 6865 7265 666f 7265 2c20 746f 2061   Therefore, to a
+00003be0: 766f 6964 2061 6e79 2063 6f6e 6675 7369  void any confusi
+00003bf0: 6f6e 2c20 2730 2720 6973 2061 6c74 6572  on, '0' is alter
+00003c00: 6564 2074 6f20 2731 2720 736f 2074 6865  ed to '1' so the
+00003c10: 2076 616c 7565 200d 0a20 2020 2020 2020   value ..       
+00003c20: 2060 2b31 6020 6973 2075 7365 6420 746f   `+1` is used to
+00003c30: 206d 6f76 6520 666f 7277 6172 6420 616c   move forward al
+00003c40: 6c20 636c 6173 7320 6c61 6265 6c73 2074  l class labels t
+00003c50: 6865 7265 6279 2065 7863 6c75 6469 6e67  hereby excluding
+00003c60: 200d 0a20 2020 2020 2020 2074 6865 2027   ..        the '
+00003c70: 3027 206c 6162 656c 2e20 546f 2066 6f72  0' label. To for
+00003c80: 6365 2069 6e63 6c75 6465 2030 2069 6e20  ce include 0 in 
+00003c90: 7468 6520 6c61 6265 6c2c 2073 6574 2060  the label, set `
+00003ca0: 6b65 6570 5f6c 6162 656c 5f30 6020 0d0a  keep_label_0` ..
+00003cb0: 2020 2020 2020 2020 746f 2060 6054 7275          to ``Tru
+00003cc0: 6560 602e 200d 0a20 2020 2020 2020 200d  e``. ..        .
+00003cd0: 0a20 2020 206e 5f69 6e69 7420 3a20 2761  .    n_init : 'a
+00003ce0: 7574 6f27 206f 7220 696e 742c 2064 6566  uto' or int, def
+00003cf0: 6175 6c74 3d31 300d 0a20 2020 2020 2020  ault=10..       
+00003d00: 204e 756d 6265 7220 6f66 2074 696d 6573   Number of times
+00003d10: 2074 6865 206b 2d6d 6561 6e73 2061 6c67   the k-means alg
+00003d20: 6f72 6974 686d 2069 7320 7275 6e20 7769  orithm is run wi
+00003d30: 7468 2064 6966 6665 7265 6e74 2063 656e  th different cen
+00003d40: 7472 6f69 640d 0a20 2020 2020 2020 2073  troid..        s
+00003d50: 6565 6473 2e20 5468 6520 6669 6e61 6c20  eeds. The final 
+00003d60: 7265 7375 6c74 7320 6973 2074 6865 2062  results is the b
+00003d70: 6573 7420 6f75 7470 7574 206f 6620 606e  est output of `n
+00003d80: 5f69 6e69 7460 2063 6f6e 7365 6375 7469  _init` consecuti
+00003d90: 7665 2072 756e 730d 0a20 2020 2020 2020  ve runs..       
+00003da0: 2069 6e20 7465 726d 7320 6f66 2069 6e65   in terms of ine
+00003db0: 7274 6961 2e20 5365 7665 7261 6c20 7275  rtia. Several ru
+00003dc0: 6e73 2061 7265 2072 6563 6f6d 6d65 6e64  ns are recommend
+00003dd0: 6564 2066 6f72 2073 7061 7273 650d 0a20  ed for sparse.. 
+00003de0: 2020 2020 2020 2068 6967 682d 6469 6d65         high-dime
+00003df0: 6e73 696f 6e61 6c20 7072 6f62 6c65 6d73  nsional problems
+00003e00: 2028 7365 6520 3a72 6566 3a60 6b6d 6561   (see :ref:`kmea
+00003e10: 6e73 5f73 7061 7273 655f 6869 6768 5f64  ns_sparse_high_d
+00003e20: 696d 6029 2e0d 0a20 2020 200d 0a20 2020  im`)...    ..   
+00003e30: 2020 2020 2057 6865 6e20 606e 5f69 6e69       When `n_ini
+00003e40: 743d 2761 7574 6f27 602c 2074 6865 206e  t='auto'`, the n
+00003e50: 756d 6265 7220 6f66 2072 756e 7320 7769  umber of runs wi
+00003e60: 6c6c 2062 6520 3130 2069 6620 7573 696e  ll be 10 if usin
+00003e70: 670d 0a20 2020 2020 2020 2060 696e 6974  g..        `init
+00003e80: 3d27 7261 6e64 6f6d 2760 2c20 616e 6420  ='random'`, and 
+00003e90: 3120 6966 2075 7369 6e67 2060 696e 6974  1 if using `init
+00003ea0: 3d27 6b6d 6561 6e73 2b2b 2760 2e0d 0a20  ='kmeans++'`... 
+00003eb0: 2020 200d 0a20 2020 2020 2020 202e 2e20     ..        .. 
+00003ec0: 7665 7273 696f 6e61 6464 6564 3a3a 2030  versionadded:: 0
+00003ed0: 2e32 2e30 200d 0a20 2020 2020 2020 2020  .2.0 ..         
+00003ee0: 2020 4164 6465 6420 2761 7574 6f27 206f    Added 'auto' o
+00003ef0: 7074 696f 6e20 666f 7220 606e 5f69 6e69  ption for `n_ini
+00003f00: 7460 2e0d 0a20 2020 200d 0a20 2020 2072  t`...    ..    r
+00003f10: 6574 7572 6e5f 636c 7573 7465 725f 6365  eturn_cluster_ce
+00003f20: 6e74 6572 733a 2062 6f6f 6c2c 2064 6566  nters: bool, def
+00003f30: 6175 6c74 3d46 616c 7365 2c20 0d0a 2020  ault=False, ..  
+00003f40: 2020 2020 2020 6578 706f 7274 2074 6865        export the
+00003f50: 2061 7272 6179 206f 6620 636c 7573 7465   array of cluste
+00003f60: 7273 2063 656e 7465 7273 2069 6620 6060  rs centers if ``
+00003f70: 5472 7565 6060 2e20 0d0a 2020 2020 6b77  True``. ..    kw
+00003f80: 733a 2064 6963 742c 200d 0a20 2020 2020  s: dict, ..     
+00003f90: 2020 2041 6464 6974 696f 6e61 6c20 6b65     Additional ke
+00003fa0: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
+00003fb0: 7061 7373 6564 2074 6f20 3a63 6c61 7373  passed to :class
+00003fc0: 3a60 736b 6c65 6172 6e2e 636c 7573 7465  :`sklearn.cluste
+00003fd0: 7273 2e4b 4d65 616e 7360 2e0d 0a20 2020  rs.KMeans`...   
+00003fe0: 2020 2020 2020 0d0a 2020 2020 5265 7475        ..    Retu
+00003ff0: 726e 7320 0d0a 2020 2020 2d2d 2d2d 2d2d  rns ..    ------
+00004000: 2d2d 2d0d 0a20 2020 204e 4741 3a20 6172  ---..    NGA: ar
+00004010: 7261 795f 6c69 6b65 206f 6620 2073 6861  ray_like of  sha
+00004020: 7065 2028 6e5f 7361 6d70 6c65 732c 206e  pe (n_samples, n
+00004030: 5f66 6561 7475 7265 7329 0d0a 2020 2020  _features)..    
+00004040: 2020 2020 5072 6564 6963 7465 6420 4e47      Predicted NG
+00004050: 4120 6c61 6265 6c73 2e20 0d0a 2020 2020  A labels. ..    
+00004060: 2820 4e47 4120 2c20 636c 7573 7465 725f  ( NGA , cluster_
+00004070: 6365 6e74 6572 7329 203a 2054 7570 6c65  centers) : Tuple
+00004080: 206f 6620 6172 7261 792d 6c69 6b65 2c20   of array-like, 
+00004090: 0d0a 2020 2020 2020 204d 4741 2061 6e64  ..       MGA and
+000040a0: 2063 6c75 7374 6572 7320 6365 6e74 6572   clusters center
+000040b0: 7320 6966 2060 6072 6574 7572 6e5f 636c  s if ``return_cl
+000040c0: 7573 7465 725f 6365 6e74 6572 7360 2069  uster_centers` i
+000040d0: 7320 0d0a 2020 2020 2020 2073 6574 2074  s ..       set t
+000040e0: 6f20 6060 5472 7565 6060 2e20 0d0a 2020  o ``True``. ..  
+000040f0: 2020 2222 220d 0a20 2020 2066 726f 6d20    """..    from 
+00004100: 2e2e 6578 6c69 622e 736b 6c65 6172 6e20  ..exlib.sklearn 
+00004110: 696d 706f 7274 204b 4d65 616e 7320 0d0a  import KMeans ..
+00004120: 2020 2020 2378 7878 7878 7878 7878 7878      #xxxxxxxxxxx
 00004130: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-00004140: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-00004150: 0d0a 2020 2020 6b6f 3d20 4b4d 6561 6e73  ..    ko= KMeans
-00004160: 286e 5f63 6c75 7374 6572 733d 206e 5f63  (n_clusters= n_c
-00004170: 6c75 7374 6572 732c 2072 616e 646f 6d5f  lusters, random_
-00004180: 7374 6174 6520 3d20 7261 6e64 6f6d 5f73  state = random_s
-00004190: 7461 7465 202c 200d 0a20 2020 2020 2020  tate , ..       
-000041a0: 2020 2020 2020 2020 2020 2069 6e69 743d             init=
-000041b0: 2272 616e 646f 6d22 2c20 6e5f 696e 6974  "random", n_init
-000041c0: 3d6e 5f69 6e69 7420 2c20 2a2a 6b77 730d  =n_init , **kws.
-000041d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000041e0: 2020 2029 0d0a 2020 2020 4e47 413d 6b6f     )..    NGA=ko
-000041f0: 2e66 6974 5f70 7265 6469 6374 2858 290d  .fit_predict(X).
-00004200: 0a20 2020 2069 6620 6e6f 7420 6b65 6570  .    if not keep
-00004210: 5f6c 6162 656c 5f30 3a0d 0a20 2020 2020  _label_0:..     
-00004220: 2020 2069 6620 3020 696e 206c 6973 7428     if 0 in list(
-00004230: 6e70 2e75 6e69 7175 6520 284e 4741 2929  np.unique (NGA))
-00004240: 3a0d 0a20 2020 2020 2020 2020 2020 204e  :..            N
-00004250: 4741 202b 3d31 200d 0a20 2020 2020 2020  GA +=1 ..       
-00004260: 2020 2020 200d 0a20 2020 2072 6574 7572       ..    retur
-00004270: 6e20 2820 4e47 4120 2c20 6b6f 2e63 6c75  n ( NGA , ko.clu
-00004280: 7374 6572 5f63 656e 7465 7273 5f20 2920  ster_centers_ ) 
-00004290: 6966 2072 6574 7572 6e5f 636c 7573 7465  if return_cluste
-000042a0: 725f 6365 6e74 6572 7320 656c 7365 204e  r_centers else N
-000042b0: 4741 200d 0a0d 0a0d 0a64 6566 2066 696e  GA ......def fin
-000042c0: 645f 6171 7569 6665 725f 6772 6f75 7073  d_aquifer_groups
-000042d0: 2028 0d0a 2020 2020 2020 2020 6172 725f   (..        arr_
-000042e0: 6b2c 202f 2c20 6172 725f 6171 3d4e 6f6e  k, /, arr_aq=Non
-000042f0: 652c 206b 6e61 6d65 203d 4e6f 6e65 2c20  e, kname =None, 
-00004300: 6171 6e61 6d65 3d4e 6f6e 652c 2073 7562  aqname=None, sub
-00004310: 6a65 6374 6976 6974 7920 3d46 616c 7365  jectivity =False
-00004320: 2c20 200d 0a20 2020 2020 2020 2020 6465  ,  ..         de
-00004330: 6661 756c 745f 6172 723d 204e 6f6e 652c  fault_arr= None,
-00004340: 206b 6565 705f 6c61 6265 6c5f 3020 3d20   keep_label_0 = 
-00004350: 4661 6c73 652c 2020 6d65 7468 6f64 203d  False,  method =
-00004360: 276e 6169 7665 272c 200d 0a20 2029 2d3e  'naive', ..  )->
-00004370: 275f 4772 6f75 7027 3a20 0d0a 2020 2020  '_Group': ..    
-00004380: 6d73 6720 3d20 2822 7b7d 2063 616e 6e6f  msg = ("{} canno
-00004390: 7420 6265 204e 6f6e 6520 7768 656e 2061  t be None when a
-000043a0: 2064 6174 6166 7261 6d65 2069 7320 6769   dataframe is gi
-000043b0: 7665 6e2e 2229 0d0a 2020 2020 6420 3d20  ven.")..    d = 
-000043c0: 636f 7079 2e64 6565 7063 6f70 7928 6172  copy.deepcopy(ar
-000043d0: 725f 6b29 0d0a 2020 2020 6966 2068 6173  r_k)..    if has
-000043e0: 6174 7472 2028 642c 2027 5f5f 6172 7261  attr (d, '__arra
-000043f0: 795f 5f27 2920 616e 6420 6861 7361 7474  y__') and hasatt
-00004400: 7220 2864 2c20 2763 6f6c 756d 6e73 2729  r (d, 'columns')
-00004410: 3a20 0d0a 2020 2020 2020 2020 6966 2061  : ..        if a
-00004420: 7272 5f61 7120 6973 204e 6f6e 6520 2061  rr_aq is None  a
-00004430: 6e64 2061 716e 616d 6520 6973 204e 6f6e  nd aqname is Non
-00004440: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
-00004450: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00004460: 7220 286d 7367 2e66 6f72 6d61 7428 2247  r (msg.format("G
-00004470: 726f 7570 206f 6620 6171 7569 6665 7220  roup of aquifer 
-00004480: 636f 6c75 6d6e 2028 2761 716e 616d 6527  column ('aqname'
-00004490: 2922 2929 0d0a 2020 2020 2020 2020 6966  )"))..        if
-000044a0: 206b 6e61 6d65 2069 7320 4e6f 6e65 3a20   kname is None: 
-000044b0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-000044c0: 6973 6520 5479 7065 4572 726f 7220 286d  ise TypeError (m
-000044d0: 7367 2e66 6f72 6d61 7428 2250 6572 6d65  sg.format("Perme
-000044e0: 6162 696c 6974 7920 636f 6566 6669 6369  ability coeffici
-000044f0: 656e 7420 636f 6c75 6d6e 2028 276b 6e61  ent column ('kna
-00004500: 6d65 2729 2229 290d 0a20 2020 2020 2020  me')"))..       
-00004510: 2020 2020 200d 0a20 2020 2020 2020 2061       ..        a
-00004520: 7272 5f61 7120 3d20 645b 6171 6e61 6d65  rr_aq = d[aqname
-00004530: 205d 203b 2061 7272 5f6b 203d 2064 5b6b   ] ; arr_k = d[k
-00004540: 6e61 6d65 5d0d 0a20 2020 2020 2020 200d  name]..        .
-00004550: 0a20 2020 2069 6620 6172 725f 6171 2069  .    if arr_aq i
-00004560: 7320 4e6f 6e65 2061 6e64 206e 6f74 2073  s None and not s
-00004570: 7562 6a65 6374 6976 6974 793a 200d 0a20  ubjectivity: .. 
-00004580: 2020 2020 2020 206d 7367 203d 2822 496e         msg =("In
-00004590: 2070 7269 6e63 6970 6c65 2c20 6d69 7373   principle, miss
-000045a0: 696e 6720 6171 7569 6665 7220 6172 7261  ing aquifer arra
-000045b0: 7920 6973 206e 6f74 2061 6c6c 6f77 6564  y is not allowed
-000045c0: 2e20 5475 726e 206f 6e20 220d 0a20 2020  . Turn on "..   
-000045d0: 2020 2020 2020 2020 2020 2022 2773 7562             "'sub
-000045e0: 6a65 6374 6976 6974 7927 2069 6e73 7465  jectivity' inste
-000045f0: 6164 2e20 4d61 6b65 2073 7572 652c 2079  ad. Make sure, y
-00004600: 6f75 206b 6e6f 7720 7768 6174 2079 6f75  ou know what you
-00004610: 2069 6e74 656e 6420 746f 220d 0a20 2020   intend to"..   
-00004620: 2020 2020 2020 2020 2020 2022 2073 6f6c             " sol
-00004630: 7665 2077 6865 6e20 7475 726e 696e 6720  ve when turning 
-00004640: 2773 7562 6a65 6374 6976 6974 7927 2074  'subjectivity' t
-00004650: 6f20 2754 7275 6527 2e20 5468 6973 206d  o 'True'. This m
-00004660: 6967 6874 206c 6561 6422 0d0a 2020 2020  ight lead"..    
-00004670: 2020 2020 2020 2020 2020 2220 746f 2062            " to b
-00004680: 7265 616b 696e 6720 636f 6465 206f 7220  reaking code or 
-00004690: 756e 6578 7065 6374 6564 2072 6573 756c  unexpected resul
-000046a0: 7473 2e20 5573 6520 6174 2079 6f75 7220  ts. Use at your 
-000046b0: 6f77 6e20 7269 736b 2e22 2029 0d0a 2020  own risk." )..  
-000046c0: 2020 2020 2020 7261 6973 6520 4171 7569        raise Aqui
-000046d0: 6665 7247 726f 7570 4572 726f 7220 286d  ferGroupError (m
-000046e0: 7367 290d 0a20 2020 2069 6620 7375 626a  sg)..    if subj
-000046f0: 6563 7469 7669 7479 3a20 0d0a 2020 2020  ectivity: ..    
-00004700: 2020 2020 6966 2061 7272 5f61 7120 6973      if arr_aq is
-00004710: 206e 6f74 204e 6f6e 653a 200d 0a20 2020   not None: ..   
-00004720: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
-00004730: 732e 7761 726e 2028 224e 6f20 6e65 6564  s.warn ("No need
-00004740: 2074 6f20 7365 7420 7375 626a 6563 7469   to set subjecti
-00004750: 7669 7479 2074 6f20 2754 7275 6527 2077  vity to 'True' w
-00004760: 6869 6c65 2074 6865 2022 0d0a 2020 2020  hile the "..    
+00004140: 7878 7878 7878 7878 7878 7878 0d0a 2020  xxxxxxxxxxxx..  
+00004150: 2020 6b6f 3d20 4b4d 6561 6e73 286e 5f63    ko= KMeans(n_c
+00004160: 6c75 7374 6572 733d 206e 5f63 6c75 7374  lusters= n_clust
+00004170: 6572 732c 2072 616e 646f 6d5f 7374 6174  ers, random_stat
+00004180: 6520 3d20 7261 6e64 6f6d 5f73 7461 7465  e = random_state
+00004190: 202c 200d 0a20 2020 2020 2020 2020 2020   , ..           
+000041a0: 2020 2020 2020 2069 6e69 743d 2272 616e         init="ran
+000041b0: 646f 6d22 2c20 6e5f 696e 6974 3d6e 5f69  dom", n_init=n_i
+000041c0: 6e69 7420 2c20 2a2a 6b77 730d 0a20 2020  nit , **kws..   
+000041d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000041e0: 0d0a 2020 2020 4e47 413d 6b6f 2e66 6974  ..    NGA=ko.fit
+000041f0: 5f70 7265 6469 6374 2858 290d 0a20 2020  _predict(X)..   
+00004200: 2069 6620 6e6f 7420 6b65 6570 5f6c 6162   if not keep_lab
+00004210: 656c 5f30 3a0d 0a20 2020 2020 2020 2069  el_0:..        i
+00004220: 6620 3020 696e 206c 6973 7428 6e70 2e75  f 0 in list(np.u
+00004230: 6e69 7175 6520 284e 4741 2929 3a0d 0a20  nique (NGA)):.. 
+00004240: 2020 2020 2020 2020 2020 204e 4741 202b             NGA +
+00004250: 3d31 200d 0a20 2020 2020 2020 2020 2020  =1 ..           
+00004260: 200d 0a20 2020 2072 6574 7572 6e20 2820   ..    return ( 
+00004270: 4e47 4120 2c20 6b6f 2e63 6c75 7374 6572  NGA , ko.cluster
+00004280: 5f63 656e 7465 7273 5f20 2920 6966 2072  _centers_ ) if r
+00004290: 6574 7572 6e5f 636c 7573 7465 725f 6365  eturn_cluster_ce
+000042a0: 6e74 6572 7320 656c 7365 204e 4741 200d  nters else NGA .
+000042b0: 0a0d 0a0d 0a64 6566 2066 696e 645f 6171  .....def find_aq
+000042c0: 7569 6665 725f 6772 6f75 7073 2028 0d0a  uifer_groups (..
+000042d0: 2020 2020 2020 2020 6172 725f 6b2c 202f          arr_k, /
+000042e0: 2c20 6172 725f 6171 3d4e 6f6e 652c 206b  , arr_aq=None, k
+000042f0: 6e61 6d65 203d 4e6f 6e65 2c20 6171 6e61  name =None, aqna
+00004300: 6d65 3d4e 6f6e 652c 2073 7562 6a65 6374  me=None, subject
+00004310: 6976 6974 7920 3d46 616c 7365 2c20 200d  ivity =False,  .
+00004320: 0a20 2020 2020 2020 2020 6465 6661 756c  .         defaul
+00004330: 745f 6172 723d 204e 6f6e 652c 206b 6565  t_arr= None, kee
+00004340: 705f 6c61 6265 6c5f 3020 3d20 4661 6c73  p_label_0 = Fals
+00004350: 652c 2020 6d65 7468 6f64 203d 276e 6169  e,  method ='nai
+00004360: 7665 272c 200d 0a20 2029 2d3e 275f 4772  ve', ..  )->'_Gr
+00004370: 6f75 7027 3a20 0d0a 2020 2020 6d73 6720  oup': ..    msg 
+00004380: 3d20 2822 7b7d 2063 616e 6e6f 7420 6265  = ("{} cannot be
+00004390: 204e 6f6e 6520 7768 656e 2061 2064 6174   None when a dat
+000043a0: 6166 7261 6d65 2069 7320 6769 7665 6e2e  aframe is given.
+000043b0: 2229 0d0a 2020 2020 6420 3d20 636f 7079  ")..    d = copy
+000043c0: 2e64 6565 7063 6f70 7928 6172 725f 6b29  .deepcopy(arr_k)
+000043d0: 0d0a 2020 2020 6966 2068 6173 6174 7472  ..    if hasattr
+000043e0: 2028 642c 2027 5f5f 6172 7261 795f 5f27   (d, '__array__'
+000043f0: 2920 616e 6420 6861 7361 7474 7220 2864  ) and hasattr (d
+00004400: 2c20 2763 6f6c 756d 6e73 2729 3a20 0d0a  , 'columns'): ..
+00004410: 2020 2020 2020 2020 6966 2061 7272 5f61          if arr_a
+00004420: 7120 6973 204e 6f6e 6520 2061 6e64 2061  q is None  and a
+00004430: 716e 616d 6520 6973 204e 6f6e 6520 3a20  qname is None : 
+00004440: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+00004450: 6973 6520 5479 7065 4572 726f 7220 286d  ise TypeError (m
+00004460: 7367 2e66 6f72 6d61 7428 2247 726f 7570  sg.format("Group
+00004470: 206f 6620 6171 7569 6665 7220 636f 6c75   of aquifer colu
+00004480: 6d6e 2028 2761 716e 616d 6527 2922 2929  mn ('aqname')"))
+00004490: 0d0a 2020 2020 2020 2020 6966 206b 6e61  ..        if kna
+000044a0: 6d65 2069 7320 4e6f 6e65 3a20 0d0a 2020  me is None: ..  
+000044b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000044c0: 5479 7065 4572 726f 7220 286d 7367 2e66  TypeError (msg.f
+000044d0: 6f72 6d61 7428 2250 6572 6d65 6162 696c  ormat("Permeabil
+000044e0: 6974 7920 636f 6566 6669 6369 656e 7420  ity coefficient 
+000044f0: 636f 6c75 6d6e 2028 276b 6e61 6d65 2729  column ('kname')
+00004500: 2229 290d 0a20 2020 2020 2020 2020 2020  "))..           
+00004510: 200d 0a20 2020 2020 2020 2061 7272 5f61   ..        arr_a
+00004520: 7120 3d20 645b 6171 6e61 6d65 205d 203b  q = d[aqname ] ;
+00004530: 2061 7272 5f6b 203d 2064 5b6b 6e61 6d65   arr_k = d[kname
+00004540: 5d0d 0a20 2020 2020 2020 200d 0a20 2020  ]..        ..   
+00004550: 2069 6620 6172 725f 6171 2069 7320 4e6f   if arr_aq is No
+00004560: 6e65 2061 6e64 206e 6f74 2073 7562 6a65  ne and not subje
+00004570: 6374 6976 6974 793a 200d 0a20 2020 2020  ctivity: ..     
+00004580: 2020 206d 7367 203d 2822 496e 2070 7269     msg =("In pri
+00004590: 6e63 6970 6c65 2c20 6d69 7373 696e 6720  nciple, missing 
+000045a0: 6171 7569 6665 7220 6172 7261 7920 6973  aquifer array is
+000045b0: 206e 6f74 2061 6c6c 6f77 6564 2e20 5475   not allowed. Tu
+000045c0: 726e 206f 6e20 220d 0a20 2020 2020 2020  rn on "..       
+000045d0: 2020 2020 2020 2022 2773 7562 6a65 6374         "'subject
+000045e0: 6976 6974 7927 2069 6e73 7465 6164 2e20  ivity' instead. 
+000045f0: 4d61 6b65 2073 7572 652c 2079 6f75 206b  Make sure, you k
+00004600: 6e6f 7720 7768 6174 2079 6f75 2069 6e74  now what you int
+00004610: 656e 6420 746f 220d 0a20 2020 2020 2020  end to"..       
+00004620: 2020 2020 2020 2022 2073 6f6c 7665 2077         " solve w
+00004630: 6865 6e20 7475 726e 696e 6720 2773 7562  hen turning 'sub
+00004640: 6a65 6374 6976 6974 7927 2074 6f20 2754  jectivity' to 'T
+00004650: 7275 6527 2e20 5468 6973 206d 6967 6874  rue'. This might
+00004660: 206c 6561 6422 0d0a 2020 2020 2020 2020   lead"..        
+00004670: 2020 2020 2020 2220 746f 2062 7265 616b        " to break
+00004680: 696e 6720 636f 6465 206f 7220 756e 6578  ing code or unex
+00004690: 7065 6374 6564 2072 6573 756c 7473 2e20  pected results. 
+000046a0: 5573 6520 6174 2079 6f75 7220 6f77 6e20  Use at your own 
+000046b0: 7269 736b 2e22 2029 0d0a 2020 2020 2020  risk." )..      
+000046c0: 2020 7261 6973 6520 4171 7569 6665 7247    raise AquiferG
+000046d0: 726f 7570 4572 726f 7220 286d 7367 290d  roupError (msg).
+000046e0: 0a20 2020 2069 6620 7375 626a 6563 7469  .    if subjecti
+000046f0: 7669 7479 3a20 0d0a 2020 2020 2020 2020  vity: ..        
+00004700: 6966 2061 7272 5f61 7120 6973 206e 6f74  if arr_aq is not
+00004710: 204e 6f6e 653a 200d 0a20 2020 2020 2020   None: ..       
+00004720: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00004730: 726e 2028 224e 6f20 6e65 6564 2074 6f20  rn ("No need to 
+00004740: 7365 7420 7375 626a 6563 7469 7669 7479  set subjectivity
+00004750: 2074 6f20 2754 7275 6527 2077 6869 6c65   to 'True' while
+00004760: 2074 6865 2022 0d0a 2020 2020 2020 2020   the "..        
 00004770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004780: 2020 2020 2020 2022 6172 7261 7920 6f66         "array of
-00004790: 2074 6865 2067 726f 7570 206f 6620 6171   the group of aq
-000047a0: 7569 6665 7220 2761 7272 615f 6171 2720  uifer 'arra_aq' 
-000047b0: 6973 2070 726f 7669 6465 642e 2229 0d0a  is provided.")..
-000047c0: 2020 2020 2020 2020 6966 2064 6566 6175          if defau
-000047d0: 6c74 5f61 7272 2069 7320 4e6f 6e65 3a20  lt_arr is None: 
-000047e0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-000047f0: 6973 6520 5479 7065 4572 726f 7220 2822  ise TypeError ("
-00004800: 4465 6661 756c 7420 6172 7261 7920 2764  Default array 'd
-00004810: 6566 6175 6c74 5f61 7272 2720 6d75 7374  efault_arr' must
-00004820: 206e 6f74 2062 6520 4e6f 6e65 2e22 0d0a   not be None."..
+00004780: 2020 2022 6172 7261 7920 6f66 2074 6865     "array of the
+00004790: 2067 726f 7570 206f 6620 6171 7569 6665   group of aquife
+000047a0: 7220 2761 7272 615f 6171 2720 6973 2070  r 'arra_aq' is p
+000047b0: 726f 7669 6465 642e 2229 0d0a 2020 2020  rovided.")..    
+000047c0: 2020 2020 6966 2064 6566 6175 6c74 5f61      if default_a
+000047d0: 7272 2069 7320 4e6f 6e65 3a20 0d0a 2020  rr is None: ..  
+000047e0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000047f0: 5479 7065 4572 726f 7220 2822 4465 6661  TypeError ("Defa
+00004800: 756c 7420 6172 7261 7920 2764 6566 6175  ult array 'defau
+00004810: 6c74 5f61 7272 2720 6d75 7374 206e 6f74  lt_arr' must not
+00004820: 2062 6520 4e6f 6e65 2e22 0d0a 2020 2020   be None."..    
 00004830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004840: 2020 2020 2020 2020 2020 2020 2022 416e               "An
-00004850: 2061 6c74 6572 6e61 7469 7665 6c79 2061   alternatively a
-00004860: 7272 6179 2069 7320 7573 6564 2066 6f72  rray is used for
-00004870: 2074 6865 220d 0a20 2020 2020 2020 2020   the"..         
+00004840: 2020 2020 2020 2020 2022 416e 2061 6c74           "An alt
+00004850: 6572 6e61 7469 7665 6c79 2061 7272 6179  ernatively array
+00004860: 2069 7320 7573 6564 2066 6f72 2074 6865   is used for the
+00004870: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
 00004880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004890: 2020 2020 2273 7562 6a65 6374 6976 6974      "subjectivit
-000048a0: 7920 6361 7365 2e20 5468 6520 6465 6661  y case. The defa
-000048b0: 756c 7420 6172 7261 7920 6973 2075 7365  ult array is use
-000048c0: 6422 0d0a 2020 2020 2020 2020 2020 2020  d"..            
-000048d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000048e0: 2022 2074 6f20 7375 6273 7469 7475 7465   " to substitute
-000048f0: 2074 6865 2061 7175 6966 6572 2067 726f   the aquifer gro
-00004900: 7570 732e 2229 0d0a 2020 2020 2020 2020  ups.")..        
-00004910: 6172 725f 6171 203d 2064 6566 6175 6c74  arr_aq = default
-00004920: 5f61 7272 200d 0a20 2020 2020 2020 200d  _arr ..        .
-00004930: 0a20 2020 2023 2063 6865 636b 2063 6f6e  .    # check con
-00004940: 7369 7374 656e 6379 200d 0a20 2020 205f  sistency ..    _
-00004950: 6368 6563 6b5f 636f 6e73 6973 7465 6e63  check_consistenc
-00004960: 795f 7369 7a65 2861 7272 5f61 712c 2061  y_size(arr_aq, a
-00004970: 7272 5f6b 290d 0a20 2020 2069 6620 6e6f  rr_k)..    if no
-00004980: 7420 616c 6c20 285b 205f 6973 5f61 7272  t all ([ _is_arr
-00004990: 6179 6c69 6b65 5f31 6428 6172 725f 6171  aylike_1d(arr_aq
-000049a0: 292c 205f 6973 5f61 7272 6179 6c69 6b65  ), _is_arraylike
-000049b0: 5f31 6428 6172 725f 6b29 5d29 3a0d 0a20  _1d(arr_k)]):.. 
-000049c0: 2020 2020 2020 2072 6169 7365 2041 7175         raise Aqu
-000049d0: 6966 6572 4772 6f75 7045 7272 6f72 2028  iferGroupError (
-000049e0: 0d0a 2020 2020 2020 2020 2020 2020 2245  ..            "E
-000049f0: 7870 6563 7473 206f 6e65 2d64 696d 656e  xpects one-dimen
-00004a00: 7369 6f6e 616c 2061 7272 6179 7320 666f  sional arrays fo
-00004a10: 7220 276b 2720 616e 6420 6171 7569 6665  r 'k' and aquife
-00004a20: 7220 6772 6f75 702e 2229 0d0a 2020 2020  r group.")..    
-00004a30: 0d0a 2020 2020 2320 6368 6563 6b20 6172  ..    # check ar
-00004a40: 7261 7973 200d 0a20 2020 2061 7272 5f6b  rays ..    arr_k
-00004a50: 203d 2063 6865 636b 5f79 2028 0d0a 2020   = check_y (..  
-00004a60: 2020 2020 2020 6172 725f 6b2c 200d 0a20        arr_k, .. 
-00004a70: 2020 2020 2020 2061 6c6c 6f77 5f6e 616e         allow_nan
-00004a80: 3d20 5472 7565 2c20 0d0a 2020 2020 2020  = True, ..      
-00004a90: 2020 746f 5f66 7261 6d65 203d 5472 7565    to_frame =True
-00004aa0: 2c20 0d0a 2020 2020 2020 2020 696e 7075  , ..        inpu
-00004ab0: 745f 6e61 6d65 3d22 4172 7261 7920 6f66  t_name="Array of
-00004ac0: 2050 6572 6d65 6162 696c 6974 7920 636f   Permeability co
-00004ad0: 6566 6669 6369 656e 7420 276b 2722 2c0d  efficient 'k'",.
-00004ae0: 0a20 2020 2020 2020 2029 2020 0d0a 0d0a  .        )  ....
-00004af0: 2020 2020 6966 206e 702e 6e61 6e20 696e      if np.nan in
-00004b00: 206c 6973 7428 6172 725f 6171 293a 200d   list(arr_aq): .
-00004b10: 0a20 2020 2020 2020 2072 6169 7365 2054  .        raise T
-00004b20: 7970 6545 7272 6f72 2028 224d 6973 7369  ypeError ("Missi
-00004b30: 6e67 2076 616c 7565 2873 2920 6973 2f61  ng value(s) is/a
-00004b40: 7265 206e 6f74 2061 6c6c 6f77 6564 2069  re not allowed i
-00004b50: 6e20 6772 6f75 7020 6f66 2022 0d0a 2020  n group of "..  
+00004890: 2273 7562 6a65 6374 6976 6974 7920 6361  "subjectivity ca
+000048a0: 7365 2e20 5468 6520 6465 6661 756c 7420  se. The default 
+000048b0: 6172 7261 7920 6973 2075 7365 6422 0d0a  array is used"..
+000048c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000048d0: 2020 2020 2020 2020 2020 2020 2022 2074               " t
+000048e0: 6f20 7375 6273 7469 7475 7465 2074 6865  o substitute the
+000048f0: 2061 7175 6966 6572 2067 726f 7570 732e   aquifer groups.
+00004900: 2229 0d0a 2020 2020 2020 2020 6172 725f  ")..        arr_
+00004910: 6171 203d 2064 6566 6175 6c74 5f61 7272  aq = default_arr
+00004920: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00004930: 2023 2063 6865 636b 2063 6f6e 7369 7374   # check consist
+00004940: 656e 6379 200d 0a20 2020 205f 6368 6563  ency ..    _chec
+00004950: 6b5f 636f 6e73 6973 7465 6e63 795f 7369  k_consistency_si
+00004960: 7a65 2861 7272 5f61 712c 2061 7272 5f6b  ze(arr_aq, arr_k
+00004970: 290d 0a20 2020 2069 6620 6e6f 7420 616c  )..    if not al
+00004980: 6c20 285b 205f 6973 5f61 7272 6179 6c69  l ([ _is_arrayli
+00004990: 6b65 5f31 6428 6172 725f 6171 292c 205f  ke_1d(arr_aq), _
+000049a0: 6973 5f61 7272 6179 6c69 6b65 5f31 6428  is_arraylike_1d(
+000049b0: 6172 725f 6b29 5d29 3a0d 0a20 2020 2020  arr_k)]):..     
+000049c0: 2020 2072 6169 7365 2041 7175 6966 6572     raise Aquifer
+000049d0: 4772 6f75 7045 7272 6f72 2028 0d0a 2020  GroupError (..  
+000049e0: 2020 2020 2020 2020 2020 2245 7870 6563            "Expec
+000049f0: 7473 206f 6e65 2d64 696d 656e 7369 6f6e  ts one-dimension
+00004a00: 616c 2061 7272 6179 7320 666f 7220 276b  al arrays for 'k
+00004a10: 2720 616e 6420 6171 7569 6665 7220 6772  ' and aquifer gr
+00004a20: 6f75 702e 2229 0d0a 2020 2020 0d0a 2020  oup.")..    ..  
+00004a30: 2020 2320 6368 6563 6b20 6172 7261 7973    # check arrays
+00004a40: 200d 0a20 2020 2061 7272 5f6b 203d 2063   ..    arr_k = c
+00004a50: 6865 636b 5f79 2028 0d0a 2020 2020 2020  heck_y (..      
+00004a60: 2020 6172 725f 6b2c 200d 0a20 2020 2020    arr_k, ..     
+00004a70: 2020 2061 6c6c 6f77 5f6e 616e 3d20 5472     allow_nan= Tr
+00004a80: 7565 2c20 0d0a 2020 2020 2020 2020 746f  ue, ..        to
+00004a90: 5f66 7261 6d65 203d 5472 7565 2c20 0d0a  _frame =True, ..
+00004aa0: 2020 2020 2020 2020 696e 7075 745f 6e61          input_na
+00004ab0: 6d65 3d22 4172 7261 7920 6f66 2050 6572  me="Array of Per
+00004ac0: 6d65 6162 696c 6974 7920 636f 6566 6669  meability coeffi
+00004ad0: 6369 656e 7420 276b 2722 2c0d 0a20 2020  cient 'k'",..   
+00004ae0: 2020 2020 2029 2020 0d0a 0d0a 2020 2020       )  ....    
+00004af0: 6966 206e 702e 6e61 6e20 696e 206c 6973  if np.nan in lis
+00004b00: 7428 6172 725f 6171 293a 200d 0a20 2020  t(arr_aq): ..   
+00004b10: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00004b20: 7272 6f72 2028 224d 6973 7369 6e67 2076  rror ("Missing v
+00004b30: 616c 7565 2873 2920 6973 2f61 7265 206e  alue(s) is/are n
+00004b40: 6f74 2061 6c6c 6f77 6564 2069 6e20 6772  ot allowed in gr
+00004b50: 6f75 7020 6f66 2022 0d0a 2020 2020 2020  oup of "..      
 00004b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004b70: 2020 2020 2020 2022 2061 7175 6966 6572         " aquifer
-00004b80: 2e20 506c 6561 7365 2069 6d70 7574 6520  . Please impute 
-00004b90: 7468 6520 6461 7461 2066 6972 7374 2e22  the data first."
-00004ba0: 290d 0a20 2020 2023 2066 6f72 2063 6f6e  )..    # for con
-00004bb0: 7369 7374 656e 6379 2072 6563 6865 636b  sistency recheck
-00004bc0: 200d 0a20 2020 2061 7272 5f61 7120 3d20   ..    arr_aq = 
-00004bd0: 6368 6563 6b5f 7920 280d 0a20 2020 2020  check_y (..     
-00004be0: 2020 2061 7272 5f61 712c 200d 0a20 2020     arr_aq, ..   
-00004bf0: 2020 2020 2074 6f5f 6672 616d 6520 3d20       to_frame = 
-00004c00: 5472 7565 2c20 0d0a 2020 2020 2020 2020  True, ..        
-00004c10: 616c 6c6f 775f 6e61 6e3d 2046 616c 7365  allow_nan= False
-00004c20: 2c20 0d0a 2020 2020 2020 2020 696e 7075  , ..        inpu
-00004c30: 745f 6e61 6d65 203d 2241 7272 6179 206f  t_name ="Array o
-00004c40: 6620 6171 7569 6665 7220 6772 6f75 7020  f aquifer group 
-00004c50: 2761 7272 5f61 7127 220d 0a20 2020 2020  'arr_aq'"..     
-00004c60: 2020 2029 0d0a 2020 2020 0d0a 2020 2020     )..    ..    
-00004c70: 6172 725f 6b5f 7661 6c69 6420 2c20 6172  arr_k_valid , ar
-00004c80: 725f 6171 5f76 616c 6964 203d 205f 6765  r_aq_valid = _ge
-00004c90: 745f 795f 6672 6f6d 5f76 616c 6964 5f69  t_y_from_valid_i
-00004ca0: 6e64 6578 6573 280d 0a20 2020 2020 2020  ndexes(..       
-00004cb0: 2061 7272 5f6b 2c20 6172 725f 6171 2c20   arr_k, arr_aq, 
-00004cc0: 696e 636c 7564 655f 6c61 6265 6c5f 303d  include_label_0=
-00004cd0: 206b 6565 705f 6c61 6265 6c5f 3020 2029   keep_label_0  )
-00004ce0: 0d0a 2020 2020 0d0a 2020 2020 6c61 6265  ..    ..    labe
-00004cf0: 6c73 202c 2063 6f75 6e74 7320 3d20 6e70  ls , counts = np
-00004d00: 2e75 6e69 7175 6520 2861 7272 5f6b 5f76  .unique (arr_k_v
-00004d10: 616c 6964 202c 2072 6574 7572 6e5f 636f  alid , return_co
-00004d20: 756e 7473 3d20 5472 7565 2920 0d0a 2020  unts= True) ..  
-00004d30: 2020 6c61 6265 6c73 5f72 6174 6520 3d20    labels_rate = 
-00004d40: 636f 756e 7473 202f 2073 756d 2863 6f75  counts / sum(cou
-00004d50: 6e74 7320 290d 0a20 2020 2064 6963 745f  nts )..    dict_
-00004d60: 6c61 6265 6c73 5f72 6174 6520 3d20 7b20  labels_rate = { 
-00004d70: 6b3a 2076 2066 6f72 206b 202c 2076 2069  k: v for k , v i
-00004d80: 6e20 7a69 7020 2820 6c61 6265 6c73 2c20  n zip ( labels, 
-00004d90: 6c61 6265 6c73 5f72 6174 6520 297d 200d  labels_rate )} .
-00004da0: 0a20 2020 200d 0a20 2020 2067 726f 7570  .    ..    group
-00004db0: 7320 3d20 6465 6661 756c 7464 6963 7428  s = defaultdict(
-00004dc0: 6c69 7374 2920 200d 0a20 2020 2066 6f72  list)  ..    for
-00004dd0: 206c 6162 656c 2069 6e20 736f 7274 6564   label in sorted
-00004de0: 2028 6c61 6265 6c73 2920 3a20 0d0a 2020   (labels) : ..  
-00004df0: 2020 2020 2020 6720 3d20 6c61 6265 6c5f        g = label_
-00004e00: 696d 706f 7274 616e 6365 280d 0a20 2020  importance(..   
-00004e10: 2020 2020 2020 2020 206c 6162 656c 2c20           label, 
-00004e20: 6172 725f 6b3d 6172 725f 6b5f 7661 6c69  arr_k=arr_k_vali
-00004e30: 6420 2c20 6172 725f 6171 3d20 6172 725f  d , arr_aq= arr_
-00004e40: 6171 5f76 616c 6964 2c20 6d65 7468 6f64  aq_valid, method
-00004e50: 203d 6d65 7468 6f64 2029 0d0a 2020 2020   =method )..    
-00004e60: 2020 2020 6772 6f75 7073 5b6c 6162 656c      groups[label
-00004e70: 5d2e 6170 7065 6e64 2028 6469 6374 5f6c  ].append (dict_l
-00004e80: 6162 656c 735f 7261 7465 2e67 6574 286c  abels_rate.get(l
-00004e90: 6162 656c 2929 0d0a 2020 2020 2020 2020  abel))..        
-00004ea0: 6772 6f75 7073 5b6c 6162 656c 5d2e 6170  groups[label].ap
-00004eb0: 7065 6e64 2867 290d 0a20 2020 2020 2020  pend(g)..       
-00004ec0: 200d 0a20 2020 2072 6574 7572 6e20 5f47   ..    return _G
-00004ed0: 726f 7570 2867 726f 7570 7329 0d0a 0d0a  roup(groups)....
-00004ee0: 6669 6e64 5f61 7175 6966 6572 5f67 726f  find_aquifer_gro
-00004ef0: 7570 732e 5f5f 646f 635f 5f3d 2222 225c  ups.__doc__="""\
-00004f00: 0d0a 4669 7420 7468 6520 6772 6f75 7020  ..Fit the group 
-00004f10: 6f66 2061 7175 6966 6572 2061 6e64 2066  of aquifer and f
-00004f20: 696e 6420 7468 6520 7265 7072 6573 656e  ind the represen
-00004f30: 7461 7469 7665 206f 6620 6561 6368 2074  tative of each t
-00004f40: 7275 6520 6c61 6265 6c20 696e 200d 0a61  rue label in ..a
-00004f50: 7272 6179 2027 6b27 2069 6e20 7468 6520  rray 'k' in the 
-00004f60: 6171 7569 6665 7220 6772 6f75 7020 6172  aquifer group ar
-00004f70: 7261 792e 200d 0a0d 0a54 6865 2069 6465  ray. ....The ide
-00004f80: 6120 636f 6e73 6973 7473 2074 6f20 6669  a consists to fi
-00004f90: 6e64 2074 6865 2063 6f72 7265 7370 6f6e  nd the correspon
-00004fa0: 6469 6e67 2061 7175 6966 6572 2067 726f  ding aquifer gro
-00004fb0: 7570 2077 6869 6368 2066 6974 7320 7468  up which fits th
-00004fc0: 6520 6d6f 7374 200d 0a74 6865 2074 7275  e most ..the tru
-00004fd0: 6520 6c61 6265 6c20 2758 2720 696e 2027  e label 'X' in '
-00004fe0: 795f 7472 7565 272e 200d 0a0d 0a27 6172  y_true'. ....'ar
-00004ff0: 725f 6b27 2061 6e64 2027 6172 725f 6171  r_k' and 'arr_aq
-00005000: 2720 6d75 7374 2063 6f6e 7461 696e 2061  ' must contain a
-00005010: 2063 6c61 7373 206c 6162 656c 2c20 6e6f   class label, no
-00005020: 7420 636f 6e74 696e 7565 2076 616c 7565  t continue value
-00005030: 732e 200d 0a0d 0a50 6172 616d 6574 6572  s. ....Parameter
-00005040: 7320 0d0a 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  s ..-----------.
-00005050: 0a61 7272 5f6b 3a20 6172 7261 795f 6c69  .arr_k: array_li
-00005060: 6b65 2c20 7061 6e64 6173 2073 6572 6965  ke, pandas serie
-00005070: 7320 6f72 2064 6174 6166 7261 6d65 200d  s or dataframe .
-00005080: 0a20 2020 2061 7272 6179 6c69 6b65 2074  .    arraylike t
-00005090: 6861 7420 636f 6e74 6169 6e73 2074 6865  hat contains the
-000050a0: 2070 6572 6d65 6162 696c 6974 7920 636f   permeability co
-000050b0: 6566 6669 6369 656e 7473 2027 6b27 2e20  efficients 'k'. 
-000050c0: 4966 2061 2064 6174 6166 7261 6d65 200d  If a dataframe .
-000050d0: 0a20 2020 2069 7320 7375 7070 6c69 6564  .    is supplied
-000050e0: 2c20 7468 6520 7065 726d 6561 6269 746c  , the permeabitl
-000050f0: 6974 7920 636f 6566 6669 6369 656e 7420  ity coefficient 
-00005100: 636f 6c75 6d6e 206e 616d 6520 276b 6e61  column name 'kna
-00005110: 6d65 2720 6d75 7374 2062 6520 0d0a 2020  me' must be ..  
-00005120: 2020 7370 6563 6966 6965 642e 200d 0a61    specified. ..a
-00005130: 7272 5f61 713a 2061 7272 6179 2d6c 696b  rr_aq: array-lik
-00005140: 6520 2c20 7061 6e64 6173 2073 6572 6965  e , pandas serie
-00005150: 7320 6f72 2064 6174 6166 7261 6d65 200d  s or dataframe .
-00005160: 0a20 2020 2061 7272 6179 2d6c 696b 6520  .    array-like 
-00005170: 7468 6174 2063 6f6e 7461 696e 7320 7468  that contains th
-00005180: 6520 6171 7569 6665 7220 6772 6f75 7073  e aquifer groups
-00005190: 2e20 4966 204e 414e 2076 616c 7565 7320  . If NAN values 
-000051a0: 6578 6973 7473 2069 6e20 7468 6520 0d0a  exists in the ..
-000051b0: 2020 2020 6171 7569 6665 7220 6772 6f75      aquifer grou
-000051c0: 7073 2c20 6974 2069 7320 7375 6767 6573  ps, it is sugges
-000051d0: 7465 6420 746f 2069 6d70 7574 6564 2076  ted to imputed v
-000051e0: 616c 7565 7320 6265 666f 7265 2066 6565  alues before fee
-000051f0: 6469 696e 6720 746f 200d 0a20 2020 2074  diing to ..    t
-00005200: 6865 2061 6c67 6f72 6974 686d 732e 204d  he algorithms. M
-00005210: 6973 7369 6e67 2076 616c 7565 7320 6172  issing values ar
-00005220: 6520 6e6f 7420 616c 6c6f 7765 642e 2049  e not allowed. I
-00005230: 6620 6461 7461 6672 616d 6520 6973 2073  f dataframe is s
-00005240: 7570 706c 6965 642c 0d0a 2020 2020 7468  upplied,..    th
-00005250: 6520 6171 7569 6665 7220 6772 6f75 7020  e aquifer group 
-00005260: 636f 6c75 6d6e 206e 616d 6520 2761 716e  column name 'aqn
-00005270: 616d 6527 206d 7573 7420 6265 2073 7065  ame' must be spe
-00005280: 6369 6669 6564 2e20 0d0a 0d0a 7b70 6172  cified. ....{par
-00005290: 616d 732e 636f 7265 2e6b 6e61 6d65 7d0d  ams.core.kname}.
-000052a0: 0a0d 0a61 716e 616d 653a 2073 7472 2c20  ...aqname: str, 
-000052b0: 6f70 7469 6f6e 616c 2c20 0d0a 2020 2020  optional, ..    
-000052c0: 4e61 6d65 206f 6620 6171 7569 6665 7220  Name of aquifer 
-000052d0: 6772 6f75 7020 636f 6c75 6d6e 732e 2060  group columns. `
-000052e0: 6171 6e61 6d65 6020 616c 6c6f 7773 2074  aqname` allows t
-000052f0: 6f20 7265 7472 6965 7665 2074 6865 200d  o retrieve the .
-00005300: 0a20 2020 2061 7175 6966 6572 2067 726f  .    aquifer gro
-00005310: 7570 2060 6172 725f 6171 6020 7661 6c75  up `arr_aq` valu
-00005320: 6520 696e 2020 6120 7370 6563 6966 6963  e in  a specific
-00005330: 2064 6174 6166 7261 6d65 2e20 436f 6d6d   dataframe. Comm
-00005340: 6f6e 6c79 0d0a 2020 2060 6171 6e61 6d65  only..   `aqname
-00005350: 6020 6e65 6564 7320 746f 2062 6520 7375  ` needs to be su
-00005360: 7070 6c69 6564 2077 6865 6e20 6120 6461  pplied when a da
-00005370: 7461 6672 616d 6520 6973 2070 6173 7365  taframe is passe
-00005380: 6420 6173 2061 2070 6f73 6974 696f 6e61  d as a positiona
-00005390: 6c20 0d0a 2020 2020 6f72 206b 6579 776f  l ..    or keywo
-000053a0: 7264 2061 7267 756d 656e 742e 200d 0a20  rd argument. .. 
-000053b0: 2020 200d 0a73 7562 6a65 6374 6976 6974     ..subjectivit
-000053c0: 793a 2062 6f6f 6c2c 2064 6566 6175 6c74  y: bool, default
-000053d0: 3d46 616c 7365 0d0a 2020 2020 436f 6e73  =False..    Cons
-000053e0: 6964 6572 7320 6561 6368 2063 6c61 7373  iders each class
-000053f0: 206c 6162 656c 2061 7320 6120 6e61 6976   label as a naiv
-00005400: 6520 6772 6f75 7020 6f66 2061 7175 6966  e group of aquif
-00005410: 6572 2e20 5375 626a 6563 7469 7669 7479  er. Subjectivity
-00005420: 200d 0a20 2020 206f 6363 7572 7320 7768   ..    occurs wh
-00005430: 656e 2061 2067 726f 7570 206f 6620 6171  en a group of aq
-00005440: 7569 6665 7220 6973 206e 6f74 2066 6f75  uifer is not fou
-00005450: 6e64 2069 6e20 7468 6520 6461 7461 2e20  nd in the data. 
-00005460: 5468 6572 6566 6f72 652c 2065 6163 6820  Therefore, each 
-00005470: 0d0a 2020 2020 636c 6173 7320 6c61 6265  ..    class labe
-00005480: 6c20 6973 2063 6f6e 7369 6465 7265 6420  l is considered 
-00005490: 6173 2061 206e 6169 7665 2067 726f 7570  as a naive group
-000054a0: 206f 6620 6171 7569 6665 722e 2049 7420   of aquifer. It 
-000054b0: 6973 2073 7472 6f6e 676c 7920 0d0a 2020  is strongly ..  
-000054c0: 2020 7265 636f 6d6d 656e 6465 6420 746f    recommended to
-000054d0: 2070 726f 7669 6465 2061 2064 6566 6175   provide a defau
-000054e0: 6c74 2067 726f 7570 2070 6173 7365 7320  lt group passes 
-000054f0: 746f 2070 6172 616d 6574 6572 2060 6465  to parameter `de
-00005500: 6661 756c 745f 6172 7260 200d 0a20 2020  fault_arr` ..   
-00005510: 2074 6f20 7375 6273 7469 7475 7465 2074   to substitute t
-00005520: 6865 2067 726f 7570 206f 6620 6171 7569  he group of aqui
-00005530: 6665 7273 2066 6f72 206d 6f72 6520 7072  fers for more pr
-00005540: 6174 6963 616c 2072 6561 736f 6e2e 2046  atical reason. F
-00005550: 6f72 2069 6e73 7461 6e63 650d 0a20 2020  or instance..   
-00005560: 2069 7420 6361 6e20 6265 2074 6865 206c   it can be the l
-00005570: 6179 6572 2063 6f6c 6c65 6374 6564 2061  ayer collected a
-00005580: 7420 6120 7370 6563 6966 6963 2064 6570  t a specific dep
-00005590: 7468 206c 696b 6520 7468 6520 2773 7472  th like the 'str
-000055a0: 6174 6127 200d 0a20 2020 2063 6f6c 756d  ata' ..    colum
-000055b0: 6e73 2e20 0d0a 2020 2020 0d0a 6465 6661  ns. ..    ..defa
-000055c0: 756c 745f 6172 723a 2061 7272 6179 2d6c  ult_arr: array-l
-000055d0: 696b 652c 2070 642e 5365 7269 6573 200d  ike, pd.Series .
-000055e0: 0a20 2020 4172 7261 7920 7573 6564 2061  .   Array used a
-000055f0: 7320 6465 6661 756c 7420 746f 2073 7562  s default to sub
-00005600: 7369 7475 7465 2074 6865 2067 726f 7570  situte the group
-00005610: 206f 6620 6171 7175 6966 6572 2069 6620   of aqquifer if 
-00005620: 7468 6520 6c61 7474 6572 200d 0a20 2020  the latter ..   
-00005630: 6973 206d 6973 7369 6e67 2e20 5468 6973  is missing. This
-00005640: 2069 7320 616e 2068 6575 7269 7374 6963   is an heuristic
-00005650: 206f 7074 696f 6e20 6265 6361 7573 6520   option because 
-00005660: 6974 206d 6967 6874 206c 6561 6420 746f  it might lead to
-00005670: 2062 7265 616b 696e 6720 0d0a 2020 2063   breaking ..   c
-00005680: 6f64 6520 6f72 2069 6e76 616c 6964 2072  ode or invalid r
-00005690: 6573 756c 7473 2e0d 0a20 2020 0d0a 6b65  esults...   ..ke
-000056a0: 6570 5f6c 6162 656c 5f30 3a20 626f 6f6c  ep_label_0: bool
-000056b0: 2c20 6465 6661 756c 743d 4661 6c73 650d  , default=False.
-000056c0: 0a20 2020 2054 6865 2070 7265 6469 6374  .    The predict
-000056d0: 696f 6e20 616c 7265 6164 7920 696e 636c  ion already incl
-000056e0: 7564 6520 7468 6520 6c61 6265 6c20 302e  ude the label 0.
-000056f0: 2048 6f77 6576 6572 2c20 696e 636c 7564   However, includ
-00005700: 696e 6720 3020 696e 200d 0a20 2020 2074  ing 0 in ..    t
-00005710: 6865 2070 7265 6469 6374 6564 206c 6162  he predicted lab
-00005720: 656c 2072 6566 6572 7320 746f 2027 6b3d  el refers to 'k=
-00005730: 3027 2069 2e65 2e20 2070 6572 6d65 6162  0' i.e.  permeab
-00005740: 696c 6974 7920 636f 6566 6669 6369 656e  ility coefficien
-00005750: 7420 0d0a 2020 2020 6571 7561 6c73 2074  t ..    equals t
-00005760: 6f20 302c 2077 6869 6368 2069 7320 6e6f  o 0, which is no
-00005770: 7420 5472 7565 2069 6e20 7072 696e 6369  t True in princi
-00005780: 706c 652c 2062 6563 6175 7365 2061 6c6c  ple, because all
-00005790: 2072 6f63 6b73 2020 6861 7665 200d 0a20   rocks  have .. 
-000057a0: 2020 2061 2070 6572 6d65 6162 696c 6974     a permeabilit
-000057b0: 7920 636f 6566 6669 6369 656e 7420 276b  y coefficient 'k
-000057c0: 272e 2048 6572 6520 7765 2063 6f6e 7369  '. Here we consi
-000057d0: 6465 7265 6420 276b 3d30 2720 6173 2061  dered 'k=0' as a
-000057e0: 6e20 756e 6465 6669 6e65 6420 0d0a 2020  n undefined ..  
-000057f0: 2020 7065 726d 6561 6269 6c69 7479 2063    permeability c
-00005800: 6f65 6666 6963 6965 6e74 2e20 5468 6572  oefficient. Ther
-00005810: 6566 6f72 652c 2027 3027 202c 2063 616e  efore, '0' , can
-00005820: 2062 6520 6578 636c 7564 6520 7369 6e63   be exclude sinc
-00005830: 652c 2069 7420 6361 6e20 0d0a 2020 2020  e, it can ..    
-00005840: 616c 736f 2063 6f6e 7369 6465 7265 6420  also considered 
-00005850: 6173 2061 206d 6973 7369 6e67 2027 6b27  as a missing 'k'
-00005860: 2d76 616c 7565 2e20 4966 2070 7265 6469  -value. If predi
-00005870: 6374 6564 2027 3027 2069 7320 696e 2074  cted '0' is in t
-00005880: 6865 2074 6172 6765 7420 0d0a 2020 2020  he target ..    
-00005890: 6974 2073 686f 756c 6420 6d65 616e 2061  it should mean a
-000058a0: 206d 6973 7369 6e67 2027 6b27 2d76 616c   missing 'k'-val
-000058b0: 7565 2072 6174 6865 7220 7468 616e 2062  ue rather than b
-000058c0: 6569 6e67 2061 2063 6f6e 6372 6574 6520  eing a concrete 
-000058d0: 6c61 6265 6c2e 2020 0d0a 2020 2020 5468  label.  ..    Th
-000058e0: 6572 6566 6f72 652c 2074 6f20 6176 6f69  erefore, to avoi
-000058f0: 6420 616e 7920 636f 6e66 7573 696f 6e2c  d any confusion,
-00005900: 2027 3027 2069 7320 616c 7465 7265 6420   '0' is altered 
-00005910: 746f 2027 3127 2073 6f20 7468 6520 7661  to '1' so the va
-00005920: 6c75 6520 0d0a 2020 2020 602b 3160 2069  lue ..    `+1` i
-00005930: 7320 7573 6564 2074 6f20 6d6f 7665 2066  s used to move f
-00005940: 6f72 7761 7264 2061 6c6c 2063 6c61 7373  orward all class
-00005950: 206c 6162 656c 7320 7468 6572 6562 7920   labels thereby 
-00005960: 6578 636c 7564 696e 6720 0d0a 2020 2020  excluding ..    
-00005970: 7468 6520 2730 2720 6c61 6265 6c2e 2054  the '0' label. T
-00005980: 6f20 666f 7263 6520 696e 636c 7564 6520  o force include 
-00005990: 3020 696e 2074 6865 206c 6162 656c 2c20  0 in the label, 
-000059a0: 7365 7420 606b 6565 705f 6c61 6265 6c5f  set `keep_label_
-000059b0: 3060 200d 0a20 2020 2074 6f20 6060 5472  0` ..    to ``Tr
-000059c0: 7565 6060 2e20 0d0a 2020 2020 2020 2020  ue``. ..        
-000059d0: 0d0a 6d65 7468 6f64 3a20 7374 7220 5b27  ..method: str ['
-000059e0: 6e61 6976 6527 2c20 2773 7472 6963 7427  naive', 'strict'
-000059f0: 5d2c 2064 6566 6175 6c74 3d27 6e61 6976  ], default='naiv
-00005a00: 6527 0d0a 2020 2020 5468 6520 6b69 6e64  e'..    The kind
-00005a10: 206f 6620 7374 7261 7465 6779 2074 6f20   of strategy to 
-00005a20: 636f 6d70 7574 6520 7468 6520 7265 7072  compute the repr
-00005a30: 6573 656e 7461 7469 7669 7479 206f 6620  esentativity of 
-00005a40: 6120 6c61 6265 6c20 0d0a 2020 2020 696e  a label ..    in
-00005a50: 2074 6865 2070 7265 6469 6374 6564 2061   the predicted a
-00005a60: 7272 6179 2027 6172 7261 795f 6171 272e  rray 'array_aq'.
-00005a70: 2049 7420 6361 6e20 616c 736f 2062 6520   It can also be 
-00005a80: 2773 7472 6963 7427 2e20 496e 6465 6564  'strict'. Indeed
-00005a90: 3a0d 0a20 2020 200d 0a20 2020 202d 2060  :..    ..    - `
-00005aa0: 606e 6169 7665 6060 2063 6f6d 7075 7465  `naive`` compute
-00005ab0: 7320 7468 6520 696d 706f 7274 616e 6365  s the importance
-00005ac0: 206f 6620 7468 6520 6c61 6265 6c20 6279   of the label by
-00005ad0: 2074 6865 206e 756d 6265 7220 6f66 2069   the number of i
-00005ae0: 7473 0d0a 2020 2020 2020 2020 6f63 6375  ts..        occu
-00005af0: 7265 6e63 6520 666f 7220 7468 6973 2073  rence for this s
-00005b00: 7065 6369 6669 6320 6c61 6265 6c20 696e  pecific label in
-00005b10: 2074 6865 2061 7272 6179 2027 6b27 2e20   the array 'k'. 
-00005b20: 4974 2064 6f65 7320 6e6f 7420 0d0a 2020  It does not ..  
-00005b30: 2020 2020 2020 7461 6b65 2069 6e74 6f20        take into 
-00005b40: 6163 636f 756e 7420 6f66 2074 6865 206f  account of the o
-00005b50: 6363 7572 656e 6365 206f 6620 6f74 6865  ccurence of othe
-00005b60: 7220 6578 6973 7469 6e67 206c 6162 656c  r existing label
-00005b70: 732e 2054 6869 7320 0d0a 2020 2020 2020  s. This ..      
-00005b80: 2020 6973 2075 7365 6675 6c6c 2066 6f72    is usefull for
-00005b90: 2075 6e62 616c 616e 6365 6420 636c 6173   unbalanced clas
-00005ba0: 7320 6c61 6265 6c73 2069 6e20 6061 7272  s labels in `arr
-00005bb0: 5f6b 602e 0d0a 2020 2020 2d20 6060 7374  _k`...    - ``st
-00005bc0: 7269 6374 6060 2063 6f6d 7075 7465 7320  rict`` computes 
-00005bd0: 7468 6520 696d 706f 7274 616e 6365 206f  the importance o
-00005be0: 6620 7468 6520 6c61 6265 6c20 6279 2074  f the label by t
-00005bf0: 6865 206e 756d 6265 7220 6f66 200d 0a20  he number of .. 
-00005c00: 2020 2020 2020 206f 6363 7572 656e 6365         occurence
-00005c10: 2069 6e20 7468 6520 7768 6f6c 6520 7661   in the whole va
-00005c20: 6c69 6420 6061 7272 5f6b 6020 692e 652e  lid `arr_k` i.e.
-00005c30: 2075 6e64 6572 2074 6865 2074 6f74 616c   under the total
-00005c40: 206f 6620 0d0a 2020 2020 2020 2020 6f63   of ..        oc
-00005c50: 6375 7265 6e63 6520 6f66 2061 6c6c 2074  curence of all t
-00005c60: 6865 206c 6162 656c 7320 7468 6174 2065  he labels that e
-00005c70: 7869 7374 2069 6e20 7468 6520 7768 6f6c  xist in the whol
-00005c80: 6520 2761 7272 615f 6171 272e 200d 0a20  e 'arra_aq'. .. 
-00005c90: 2020 2020 2020 2054 6869 7320 6361 6e20         This can 
-00005ca0: 6769 7665 2061 2073 7569 7461 626c 6520  give a suitable 
-00005cb0: 616e 6179 6c73 6520 7265 7375 6c74 7320  anaylse results 
-00005cc0: 6966 2074 6865 2064 6174 6120 6973 206e  if the data is n
-00005cd0: 6f74 200d 0a20 2020 2020 2020 2075 6e62  ot ..        unb
-00005ce0: 616c 616e 6365 6420 666f 7220 6561 6368  alanced for each
-00005cf0: 206c 6162 656c 7320 696e 2060 6172 725f   labels in `arr_
-00005d00: 6b60 2e0d 0a20 2020 2020 2020 200d 0a52  k`...        ..R
-00005d10: 6574 7572 6e73 0d0a 2d2d 2d2d 2d2d 2d0d  eturns..-------.
-00005d20: 0a5f 4772 6f75 703a 203a 636c 6173 733a  ._Group: :class:
-00005d30: 607e 2e62 6f78 2e5f 4772 6f75 7060 2063  `~.box._Group` c
-00005d40: 6c61 7373 206f 626a 6563 7420 0d0a 2020  lass object ..  
-00005d50: 2020 5573 6520 6174 7472 6962 7574 6520    Use attribute 
-00005d60: 602e 6772 6f75 7073 6020 746f 2066 696e  `.groups` to fin
-00005d70: 6420 7468 6520 6772 6f75 7020 7661 6c75  d the group valu
-00005d80: 6573 2e20 0d0a 0d0a 4578 616d 706c 6573  es. ....Examples
-00005d90: 0d0a 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2831  ..----------..(1
-00005da0: 2920 5573 6520 7468 6520 7265 616c 2061  ) Use the real a
-00005db0: 7175 6966 6572 2067 726f 7570 2063 6f6c  quifer group col
-00005dc0: 6c65 6374 6564 2069 6e20 7468 6520 6172  lected in the ar
-00005dd0: 6561 200d 0a0d 0a3e 3e3e 2066 726f 6d20  ea ....>>> from 
-00005de0: 7761 7465 782e 7574 696c 7320 696d 706f  watex.utils impo
-00005df0: 7274 206e 6169 7665 5f69 6d70 7574 6572  rt naive_imputer
-00005e00: 2c20 7265 6164 5f64 6174 612c 2072 6573  , read_data, res
-00005e10: 6861 7065 200d 0a3e 3e3e 2066 726f 6d20  hape ..>>> from 
-00005e20: 7761 7465 782e 6461 7461 7365 7473 2069  watex.datasets i
-00005e30: 6d70 6f72 7420 6c6f 6164 5f68 6c6f 6773  mport load_hlogs
-00005e40: 200d 0a3e 3e3e 2066 726f 6d20 7761 7465   ..>>> from wate
-00005e50: 782e 7574 696c 732e 6879 6472 6f75 7469  x.utils.hydrouti
-00005e60: 6c73 2069 6d70 6f72 7420 636c 6173 7369  ls import classi
-00005e70: 6679 5f6b 2c20 6669 6e64 5f61 7175 6966  fy_k, find_aquif
-00005e80: 6572 5f67 726f 7570 7320 0d0a 3e3e 3e20  er_groups ..>>> 
-00005e90: 623d 206c 6f61 645f 686c 6f67 7320 2829  b= load_hlogs ()
-00005ea0: 2023 6a75 7374 2074 616b 696e 6720 7468   #just taking th
-00005eb0: 6520 7461 7267 6574 206e 616d 6573 0d0a  e target names..
-00005ec0: 3e3e 3e20 6461 7461 203d 2072 6561 645f  >>> data = read_
-00005ed0: 6461 7461 2028 2764 6174 612f 626f 7265  data ('data/bore
-00005ee0: 686f 6c65 732f 6866 2e63 7376 2729 2023  holes/hf.csv') #
-00005ef0: 2072 6561 6420 636f 6d70 6c65 7465 2064   read complete d
-00005f00: 6174 610d 0a3e 3e3e 2079 203d 2064 6174  ata..>>> y = dat
-00005f10: 6120 5b62 2e74 6172 6765 745f 6e61 6d65  a [b.target_name
-00005f20: 735d 0d0a 3e3e 3e20 2320 696d 7075 7465  s]..>>> # impute
-00005f30: 2074 6865 206d 6973 7369 6e67 2076 616c   the missing val
-00005f40: 7565 7320 666f 756e 6420 696e 2061 7175  ues found in aqu
-00005f50: 6966 6572 2067 726f 7570 2063 6f6c 756d  ifer group colum
-00005f60: 6e73 0d0a 3e3e 3e20 2320 7265 7368 6170  ns..>>> # reshap
-00005f70: 6520 3164 2061 7272 6179 2061 6c6f 6e67  e 1d array along
-00005f80: 2061 7869 7320 3020 666f 7220 696d 7075   axis 0 for impu
-00005f90: 7461 7469 6f6e 200d 0a3e 3e3e 2061 6772  tation ..>>> agr
-00005fa0: 6f75 705f 696d 7075 7465 6420 3d20 6e61  oup_imputed = na
-00005fb0: 6976 655f 696d 7075 7465 7220 2820 7265  ive_imputer ( re
-00005fc0: 7368 6170 6520 2879 2e61 7175 6966 6572  shape (y.aquifer
-00005fd0: 5f67 726f 7570 2c20 6178 6973 203d 3020  _group, axis =0 
-00005fe0: 2920 2c20 0d0a 2e2e 2e20 2020 2020 2020  ) , .....       
+00004b70: 2020 2022 2061 7175 6966 6572 2e20 506c     " aquifer. Pl
+00004b80: 6561 7365 2069 6d70 7574 6520 7468 6520  ease impute the 
+00004b90: 6461 7461 2066 6972 7374 2e22 290d 0a20  data first.").. 
+00004ba0: 2020 2023 2066 6f72 2063 6f6e 7369 7374     # for consist
+00004bb0: 656e 6379 2072 6563 6865 636b 200d 0a20  ency recheck .. 
+00004bc0: 2020 2061 7272 5f61 7120 3d20 6368 6563     arr_aq = chec
+00004bd0: 6b5f 7920 280d 0a20 2020 2020 2020 2061  k_y (..        a
+00004be0: 7272 5f61 712c 200d 0a20 2020 2020 2020  rr_aq, ..       
+00004bf0: 2074 6f5f 6672 616d 6520 3d20 5472 7565   to_frame = True
+00004c00: 2c20 0d0a 2020 2020 2020 2020 616c 6c6f  , ..        allo
+00004c10: 775f 6e61 6e3d 2046 616c 7365 2c20 0d0a  w_nan= False, ..
+00004c20: 2020 2020 2020 2020 696e 7075 745f 6e61          input_na
+00004c30: 6d65 203d 2241 7272 6179 206f 6620 6171  me ="Array of aq
+00004c40: 7569 6665 7220 6772 6f75 7020 2761 7272  uifer group 'arr
+00004c50: 5f61 7127 220d 0a20 2020 2020 2020 2029  _aq'"..        )
+00004c60: 0d0a 2020 2020 0d0a 2020 2020 6172 725f  ..    ..    arr_
+00004c70: 6b5f 7661 6c69 6420 2c20 6172 725f 6171  k_valid , arr_aq
+00004c80: 5f76 616c 6964 203d 205f 6765 745f 795f  _valid = _get_y_
+00004c90: 6672 6f6d 5f76 616c 6964 5f69 6e64 6578  from_valid_index
+00004ca0: 6573 280d 0a20 2020 2020 2020 2061 7272  es(..        arr
+00004cb0: 5f6b 2c20 6172 725f 6171 2c20 696e 636c  _k, arr_aq, incl
+00004cc0: 7564 655f 6c61 6265 6c5f 303d 206b 6565  ude_label_0= kee
+00004cd0: 705f 6c61 6265 6c5f 3020 2029 0d0a 2020  p_label_0  )..  
+00004ce0: 2020 0d0a 2020 2020 6c61 6265 6c73 202c    ..    labels ,
+00004cf0: 2063 6f75 6e74 7320 3d20 6e70 2e75 6e69   counts = np.uni
+00004d00: 7175 6520 2861 7272 5f6b 5f76 616c 6964  que (arr_k_valid
+00004d10: 202c 2072 6574 7572 6e5f 636f 756e 7473   , return_counts
+00004d20: 3d20 5472 7565 2920 0d0a 2020 2020 6c61  = True) ..    la
+00004d30: 6265 6c73 5f72 6174 6520 3d20 636f 756e  bels_rate = coun
+00004d40: 7473 202f 2073 756d 2863 6f75 6e74 7320  ts / sum(counts 
+00004d50: 290d 0a20 2020 2064 6963 745f 6c61 6265  )..    dict_labe
+00004d60: 6c73 5f72 6174 6520 3d20 7b20 6b3a 2076  ls_rate = { k: v
+00004d70: 2066 6f72 206b 202c 2076 2069 6e20 7a69   for k , v in zi
+00004d80: 7020 2820 6c61 6265 6c73 2c20 6c61 6265  p ( labels, labe
+00004d90: 6c73 5f72 6174 6520 297d 200d 0a20 2020  ls_rate )} ..   
+00004da0: 200d 0a20 2020 2067 726f 7570 7320 3d20   ..    groups = 
+00004db0: 6465 6661 756c 7464 6963 7428 6c69 7374  defaultdict(list
+00004dc0: 2920 200d 0a20 2020 2066 6f72 206c 6162  )  ..    for lab
+00004dd0: 656c 2069 6e20 736f 7274 6564 2028 6c61  el in sorted (la
+00004de0: 6265 6c73 2920 3a20 0d0a 2020 2020 2020  bels) : ..      
+00004df0: 2020 6720 3d20 6c61 6265 6c5f 696d 706f    g = label_impo
+00004e00: 7274 616e 6365 280d 0a20 2020 2020 2020  rtance(..       
+00004e10: 2020 2020 206c 6162 656c 2c20 6172 725f       label, arr_
+00004e20: 6b3d 6172 725f 6b5f 7661 6c69 6420 2c20  k=arr_k_valid , 
+00004e30: 6172 725f 6171 3d20 6172 725f 6171 5f76  arr_aq= arr_aq_v
+00004e40: 616c 6964 2c20 6d65 7468 6f64 203d 6d65  alid, method =me
+00004e50: 7468 6f64 2029 0d0a 2020 2020 2020 2020  thod )..        
+00004e60: 6772 6f75 7073 5b6c 6162 656c 5d2e 6170  groups[label].ap
+00004e70: 7065 6e64 2028 6469 6374 5f6c 6162 656c  pend (dict_label
+00004e80: 735f 7261 7465 2e67 6574 286c 6162 656c  s_rate.get(label
+00004e90: 2929 0d0a 2020 2020 2020 2020 6772 6f75  ))..        grou
+00004ea0: 7073 5b6c 6162 656c 5d2e 6170 7065 6e64  ps[label].append
+00004eb0: 2867 290d 0a20 2020 2020 2020 200d 0a20  (g)..        .. 
+00004ec0: 2020 2072 6574 7572 6e20 5f47 726f 7570     return _Group
+00004ed0: 2867 726f 7570 7329 0d0a 0d0a 6669 6e64  (groups)....find
+00004ee0: 5f61 7175 6966 6572 5f67 726f 7570 732e  _aquifer_groups.
+00004ef0: 5f5f 646f 635f 5f3d 2222 225c 0d0a 4669  __doc__="""\..Fi
+00004f00: 7420 7468 6520 6772 6f75 7020 6f66 2061  t the group of a
+00004f10: 7175 6966 6572 2061 6e64 2066 696e 6420  quifer and find 
+00004f20: 7468 6520 7265 7072 6573 656e 7461 7469  the representati
+00004f30: 7665 206f 6620 6561 6368 2074 7275 6520  ve of each true 
+00004f40: 6c61 6265 6c20 696e 200d 0a61 7272 6179  label in ..array
+00004f50: 2027 6b27 2069 6e20 7468 6520 6171 7569   'k' in the aqui
+00004f60: 6665 7220 6772 6f75 7020 6172 7261 792e  fer group array.
+00004f70: 200d 0a0d 0a54 6865 2069 6465 6120 636f   ....The idea co
+00004f80: 6e73 6973 7473 2074 6f20 6669 6e64 2074  nsists to find t
+00004f90: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
+00004fa0: 2061 7175 6966 6572 2067 726f 7570 2077   aquifer group w
+00004fb0: 6869 6368 2066 6974 7320 7468 6520 6d6f  hich fits the mo
+00004fc0: 7374 200d 0a74 6865 2074 7275 6520 6c61  st ..the true la
+00004fd0: 6265 6c20 2758 2720 696e 2027 795f 7472  bel 'X' in 'y_tr
+00004fe0: 7565 272e 200d 0a0d 0a27 6172 725f 6b27  ue'. ....'arr_k'
+00004ff0: 2061 6e64 2027 6172 725f 6171 2720 6d75   and 'arr_aq' mu
+00005000: 7374 2063 6f6e 7461 696e 2061 2063 6c61  st contain a cla
+00005010: 7373 206c 6162 656c 2c20 6e6f 7420 636f  ss label, not co
+00005020: 6e74 696e 7565 2076 616c 7565 732e 200d  ntinue values. .
+00005030: 0a0d 0a50 6172 616d 6574 6572 7320 0d0a  ...Parameters ..
+00005040: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a61 7272  -----------..arr
+00005050: 5f6b 3a20 6172 7261 795f 6c69 6b65 2c20  _k: array_like, 
+00005060: 7061 6e64 6173 2073 6572 6965 7320 6f72  pandas series or
+00005070: 2064 6174 6166 7261 6d65 200d 0a20 2020   dataframe ..   
+00005080: 2061 7272 6179 6c69 6b65 2074 6861 7420   arraylike that 
+00005090: 636f 6e74 6169 6e73 2074 6865 2070 6572  contains the per
+000050a0: 6d65 6162 696c 6974 7920 636f 6566 6669  meability coeffi
+000050b0: 6369 656e 7473 2027 6b27 2e20 4966 2061  cients 'k'. If a
+000050c0: 2064 6174 6166 7261 6d65 200d 0a20 2020   dataframe ..   
+000050d0: 2069 7320 7375 7070 6c69 6564 2c20 7468   is supplied, th
+000050e0: 6520 7065 726d 6561 6269 746c 6974 7920  e permeabitlity 
+000050f0: 636f 6566 6669 6369 656e 7420 636f 6c75  coefficient colu
+00005100: 6d6e 206e 616d 6520 276b 6e61 6d65 2720  mn name 'kname' 
+00005110: 6d75 7374 2062 6520 0d0a 2020 2020 7370  must be ..    sp
+00005120: 6563 6966 6965 642e 200d 0a61 7272 5f61  ecified. ..arr_a
+00005130: 713a 2061 7272 6179 2d6c 696b 6520 2c20  q: array-like , 
+00005140: 7061 6e64 6173 2073 6572 6965 7320 6f72  pandas series or
+00005150: 2064 6174 6166 7261 6d65 200d 0a20 2020   dataframe ..   
+00005160: 2061 7272 6179 2d6c 696b 6520 7468 6174   array-like that
+00005170: 2063 6f6e 7461 696e 7320 7468 6520 6171   contains the aq
+00005180: 7569 6665 7220 6772 6f75 7073 2e20 4966  uifer groups. If
+00005190: 204e 414e 2076 616c 7565 7320 6578 6973   NAN values exis
+000051a0: 7473 2069 6e20 7468 6520 0d0a 2020 2020  ts in the ..    
+000051b0: 6171 7569 6665 7220 6772 6f75 7073 2c20  aquifer groups, 
+000051c0: 6974 2069 7320 7375 6767 6573 7465 6420  it is suggested 
+000051d0: 746f 2069 6d70 7574 6564 2076 616c 7565  to imputed value
+000051e0: 7320 6265 666f 7265 2066 6565 6469 696e  s before feediin
+000051f0: 6720 746f 200d 0a20 2020 2074 6865 2061  g to ..    the a
+00005200: 6c67 6f72 6974 686d 732e 204d 6973 7369  lgorithms. Missi
+00005210: 6e67 2076 616c 7565 7320 6172 6520 6e6f  ng values are no
+00005220: 7420 616c 6c6f 7765 642e 2049 6620 6461  t allowed. If da
+00005230: 7461 6672 616d 6520 6973 2073 7570 706c  taframe is suppl
+00005240: 6965 642c 0d0a 2020 2020 7468 6520 6171  ied,..    the aq
+00005250: 7569 6665 7220 6772 6f75 7020 636f 6c75  uifer group colu
+00005260: 6d6e 206e 616d 6520 2761 716e 616d 6527  mn name 'aqname'
+00005270: 206d 7573 7420 6265 2073 7065 6369 6669   must be specifi
+00005280: 6564 2e20 0d0a 0d0a 7b70 6172 616d 732e  ed. ....{params.
+00005290: 636f 7265 2e6b 6e61 6d65 7d0d 0a0d 0a61  core.kname}....a
+000052a0: 716e 616d 653a 2073 7472 2c20 6f70 7469  qname: str, opti
+000052b0: 6f6e 616c 2c20 0d0a 2020 2020 4e61 6d65  onal, ..    Name
+000052c0: 206f 6620 6171 7569 6665 7220 6772 6f75   of aquifer grou
+000052d0: 7020 636f 6c75 6d6e 732e 2060 6171 6e61  p columns. `aqna
+000052e0: 6d65 6020 616c 6c6f 7773 2074 6f20 7265  me` allows to re
+000052f0: 7472 6965 7665 2074 6865 200d 0a20 2020  trieve the ..   
+00005300: 2061 7175 6966 6572 2067 726f 7570 2060   aquifer group `
+00005310: 6172 725f 6171 6020 7661 6c75 6520 696e  arr_aq` value in
+00005320: 2020 6120 7370 6563 6966 6963 2064 6174    a specific dat
+00005330: 6166 7261 6d65 2e20 436f 6d6d 6f6e 6c79  aframe. Commonly
+00005340: 0d0a 2020 2060 6171 6e61 6d65 6020 6e65  ..   `aqname` ne
+00005350: 6564 7320 746f 2062 6520 7375 7070 6c69  eds to be suppli
+00005360: 6564 2077 6865 6e20 6120 6461 7461 6672  ed when a datafr
+00005370: 616d 6520 6973 2070 6173 7365 6420 6173  ame is passed as
+00005380: 2061 2070 6f73 6974 696f 6e61 6c20 0d0a   a positional ..
+00005390: 2020 2020 6f72 206b 6579 776f 7264 2061      or keyword a
+000053a0: 7267 756d 656e 742e 200d 0a20 2020 200d  rgument. ..    .
+000053b0: 0a73 7562 6a65 6374 6976 6974 793a 2062  .subjectivity: b
+000053c0: 6f6f 6c2c 2064 6566 6175 6c74 3d46 616c  ool, default=Fal
+000053d0: 7365 0d0a 2020 2020 436f 6e73 6964 6572  se..    Consider
+000053e0: 7320 6561 6368 2063 6c61 7373 206c 6162  s each class lab
+000053f0: 656c 2061 7320 6120 6e61 6976 6520 6772  el as a naive gr
+00005400: 6f75 7020 6f66 2061 7175 6966 6572 2e20  oup of aquifer. 
+00005410: 5375 626a 6563 7469 7669 7479 200d 0a20  Subjectivity .. 
+00005420: 2020 206f 6363 7572 7320 7768 656e 2061     occurs when a
+00005430: 2067 726f 7570 206f 6620 6171 7569 6665   group of aquife
+00005440: 7220 6973 206e 6f74 2066 6f75 6e64 2069  r is not found i
+00005450: 6e20 7468 6520 6461 7461 2e20 5468 6572  n the data. Ther
+00005460: 6566 6f72 652c 2065 6163 6820 0d0a 2020  efore, each ..  
+00005470: 2020 636c 6173 7320 6c61 6265 6c20 6973    class label is
+00005480: 2063 6f6e 7369 6465 7265 6420 6173 2061   considered as a
+00005490: 206e 6169 7665 2067 726f 7570 206f 6620   naive group of 
+000054a0: 6171 7569 6665 722e 2049 7420 6973 2073  aquifer. It is s
+000054b0: 7472 6f6e 676c 7920 0d0a 2020 2020 7265  trongly ..    re
+000054c0: 636f 6d6d 656e 6465 6420 746f 2070 726f  commended to pro
+000054d0: 7669 6465 2061 2064 6566 6175 6c74 2067  vide a default g
+000054e0: 726f 7570 2070 6173 7365 7320 746f 2070  roup passes to p
+000054f0: 6172 616d 6574 6572 2060 6465 6661 756c  arameter `defaul
+00005500: 745f 6172 7260 200d 0a20 2020 2074 6f20  t_arr` ..    to 
+00005510: 7375 6273 7469 7475 7465 2074 6865 2067  substitute the g
+00005520: 726f 7570 206f 6620 6171 7569 6665 7273  roup of aquifers
+00005530: 2066 6f72 206d 6f72 6520 7072 6174 6963   for more pratic
+00005540: 616c 2072 6561 736f 6e2e 2046 6f72 2069  al reason. For i
+00005550: 6e73 7461 6e63 650d 0a20 2020 2069 7420  nstance..    it 
+00005560: 6361 6e20 6265 2074 6865 206c 6179 6572  can be the layer
+00005570: 2063 6f6c 6c65 6374 6564 2061 7420 6120   collected at a 
+00005580: 7370 6563 6966 6963 2064 6570 7468 206c  specific depth l
+00005590: 696b 6520 7468 6520 2773 7472 6174 6127  ike the 'strata'
+000055a0: 200d 0a20 2020 2063 6f6c 756d 6e73 2e20   ..    columns. 
+000055b0: 0d0a 2020 2020 0d0a 6465 6661 756c 745f  ..    ..default_
+000055c0: 6172 723a 2061 7272 6179 2d6c 696b 652c  arr: array-like,
+000055d0: 2070 642e 5365 7269 6573 200d 0a20 2020   pd.Series ..   
+000055e0: 4172 7261 7920 7573 6564 2061 7320 6465  Array used as de
+000055f0: 6661 756c 7420 746f 2073 7562 7369 7475  fault to subsitu
+00005600: 7465 2074 6865 2067 726f 7570 206f 6620  te the group of 
+00005610: 6171 7175 6966 6572 2069 6620 7468 6520  aqquifer if the 
+00005620: 6c61 7474 6572 200d 0a20 2020 6973 206d  latter ..   is m
+00005630: 6973 7369 6e67 2e20 5468 6973 2069 7320  issing. This is 
+00005640: 616e 2068 6575 7269 7374 6963 206f 7074  an heuristic opt
+00005650: 696f 6e20 6265 6361 7573 6520 6974 206d  ion because it m
+00005660: 6967 6874 206c 6561 6420 746f 2062 7265  ight lead to bre
+00005670: 616b 696e 6720 0d0a 2020 2063 6f64 6520  aking ..   code 
+00005680: 6f72 2069 6e76 616c 6964 2072 6573 756c  or invalid resul
+00005690: 7473 2e0d 0a20 2020 0d0a 6b65 6570 5f6c  ts...   ..keep_l
+000056a0: 6162 656c 5f30 3a20 626f 6f6c 2c20 6465  abel_0: bool, de
+000056b0: 6661 756c 743d 4661 6c73 650d 0a20 2020  fault=False..   
+000056c0: 2054 6865 2070 7265 6469 6374 696f 6e20   The prediction 
+000056d0: 616c 7265 6164 7920 696e 636c 7564 6520  already include 
+000056e0: 7468 6520 6c61 6265 6c20 302e 2048 6f77  the label 0. How
+000056f0: 6576 6572 2c20 696e 636c 7564 696e 6720  ever, including 
+00005700: 3020 696e 200d 0a20 2020 2074 6865 2070  0 in ..    the p
+00005710: 7265 6469 6374 6564 206c 6162 656c 2072  redicted label r
+00005720: 6566 6572 7320 746f 2027 6b3d 3027 2069  efers to 'k=0' i
+00005730: 2e65 2e20 2070 6572 6d65 6162 696c 6974  .e.  permeabilit
+00005740: 7920 636f 6566 6669 6369 656e 7420 0d0a  y coefficient ..
+00005750: 2020 2020 6571 7561 6c73 2074 6f20 302c      equals to 0,
+00005760: 2077 6869 6368 2069 7320 6e6f 7420 5472   which is not Tr
+00005770: 7565 2069 6e20 7072 696e 6369 706c 652c  ue in principle,
+00005780: 2062 6563 6175 7365 2061 6c6c 2072 6f63   because all roc
+00005790: 6b73 2020 6861 7665 200d 0a20 2020 2061  ks  have ..    a
+000057a0: 2070 6572 6d65 6162 696c 6974 7920 636f   permeability co
+000057b0: 6566 6669 6369 656e 7420 276b 272e 2048  efficient 'k'. H
+000057c0: 6572 6520 7765 2063 6f6e 7369 6465 7265  ere we considere
+000057d0: 6420 276b 3d30 2720 6173 2061 6e20 756e  d 'k=0' as an un
+000057e0: 6465 6669 6e65 6420 0d0a 2020 2020 7065  defined ..    pe
+000057f0: 726d 6561 6269 6c69 7479 2063 6f65 6666  rmeability coeff
+00005800: 6963 6965 6e74 2e20 5468 6572 6566 6f72  icient. Therefor
+00005810: 652c 2027 3027 202c 2063 616e 2062 6520  e, '0' , can be 
+00005820: 6578 636c 7564 6520 7369 6e63 652c 2069  exclude since, i
+00005830: 7420 6361 6e20 0d0a 2020 2020 616c 736f  t can ..    also
+00005840: 2063 6f6e 7369 6465 7265 6420 6173 2061   considered as a
+00005850: 206d 6973 7369 6e67 2027 6b27 2d76 616c   missing 'k'-val
+00005860: 7565 2e20 4966 2070 7265 6469 6374 6564  ue. If predicted
+00005870: 2027 3027 2069 7320 696e 2074 6865 2074   '0' is in the t
+00005880: 6172 6765 7420 0d0a 2020 2020 6974 2073  arget ..    it s
+00005890: 686f 756c 6420 6d65 616e 2061 206d 6973  hould mean a mis
+000058a0: 7369 6e67 2027 6b27 2d76 616c 7565 2072  sing 'k'-value r
+000058b0: 6174 6865 7220 7468 616e 2062 6569 6e67  ather than being
+000058c0: 2061 2063 6f6e 6372 6574 6520 6c61 6265   a concrete labe
+000058d0: 6c2e 2020 0d0a 2020 2020 5468 6572 6566  l.  ..    Theref
+000058e0: 6f72 652c 2074 6f20 6176 6f69 6420 616e  ore, to avoid an
+000058f0: 7920 636f 6e66 7573 696f 6e2c 2027 3027  y confusion, '0'
+00005900: 2069 7320 616c 7465 7265 6420 746f 2027   is altered to '
+00005910: 3127 2073 6f20 7468 6520 7661 6c75 6520  1' so the value 
+00005920: 0d0a 2020 2020 602b 3160 2069 7320 7573  ..    `+1` is us
+00005930: 6564 2074 6f20 6d6f 7665 2066 6f72 7761  ed to move forwa
+00005940: 7264 2061 6c6c 2063 6c61 7373 206c 6162  rd all class lab
+00005950: 656c 7320 7468 6572 6562 7920 6578 636c  els thereby excl
+00005960: 7564 696e 6720 0d0a 2020 2020 7468 6520  uding ..    the 
+00005970: 2730 2720 6c61 6265 6c2e 2054 6f20 666f  '0' label. To fo
+00005980: 7263 6520 696e 636c 7564 6520 3020 696e  rce include 0 in
+00005990: 2074 6865 206c 6162 656c 2c20 7365 7420   the label, set 
+000059a0: 606b 6565 705f 6c61 6265 6c5f 3060 200d  `keep_label_0` .
+000059b0: 0a20 2020 2074 6f20 6060 5472 7565 6060  .    to ``True``
+000059c0: 2e20 0d0a 2020 2020 2020 2020 0d0a 6d65  . ..        ..me
+000059d0: 7468 6f64 3a20 7374 7220 5b27 6e61 6976  thod: str ['naiv
+000059e0: 6527 2c20 2773 7472 6963 7427 5d2c 2064  e', 'strict'], d
+000059f0: 6566 6175 6c74 3d27 6e61 6976 6527 0d0a  efault='naive'..
+00005a00: 2020 2020 5468 6520 6b69 6e64 206f 6620      The kind of 
+00005a10: 7374 7261 7465 6779 2074 6f20 636f 6d70  strategy to comp
+00005a20: 7574 6520 7468 6520 7265 7072 6573 656e  ute the represen
+00005a30: 7461 7469 7669 7479 206f 6620 6120 6c61  tativity of a la
+00005a40: 6265 6c20 0d0a 2020 2020 696e 2074 6865  bel ..    in the
+00005a50: 2070 7265 6469 6374 6564 2061 7272 6179   predicted array
+00005a60: 2027 6172 7261 795f 6171 272e 2049 7420   'array_aq'. It 
+00005a70: 6361 6e20 616c 736f 2062 6520 2773 7472  can also be 'str
+00005a80: 6963 7427 2e20 496e 6465 6564 3a0d 0a20  ict'. Indeed:.. 
+00005a90: 2020 200d 0a20 2020 202d 2060 606e 6169     ..    - ``nai
+00005aa0: 7665 6060 2063 6f6d 7075 7465 7320 7468  ve`` computes th
+00005ab0: 6520 696d 706f 7274 616e 6365 206f 6620  e importance of 
+00005ac0: 7468 6520 6c61 6265 6c20 6279 2074 6865  the label by the
+00005ad0: 206e 756d 6265 7220 6f66 2069 7473 0d0a   number of its..
+00005ae0: 2020 2020 2020 2020 6f63 6375 7265 6e63          occurenc
+00005af0: 6520 666f 7220 7468 6973 2073 7065 6369  e for this speci
+00005b00: 6669 6320 6c61 6265 6c20 696e 2074 6865  fic label in the
+00005b10: 2061 7272 6179 2027 6b27 2e20 4974 2064   array 'k'. It d
+00005b20: 6f65 7320 6e6f 7420 0d0a 2020 2020 2020  oes not ..      
+00005b30: 2020 7461 6b65 2069 6e74 6f20 6163 636f    take into acco
+00005b40: 756e 7420 6f66 2074 6865 206f 6363 7572  unt of the occur
+00005b50: 656e 6365 206f 6620 6f74 6865 7220 6578  ence of other ex
+00005b60: 6973 7469 6e67 206c 6162 656c 732e 2054  isting labels. T
+00005b70: 6869 7320 0d0a 2020 2020 2020 2020 6973  his ..        is
+00005b80: 2075 7365 6675 6c6c 2066 6f72 2075 6e62   usefull for unb
+00005b90: 616c 616e 6365 6420 636c 6173 7320 6c61  alanced class la
+00005ba0: 6265 6c73 2069 6e20 6061 7272 5f6b 602e  bels in `arr_k`.
+00005bb0: 0d0a 2020 2020 2d20 6060 7374 7269 6374  ..    - ``strict
+00005bc0: 6060 2063 6f6d 7075 7465 7320 7468 6520  `` computes the 
+00005bd0: 696d 706f 7274 616e 6365 206f 6620 7468  importance of th
+00005be0: 6520 6c61 6265 6c20 6279 2074 6865 206e  e label by the n
+00005bf0: 756d 6265 7220 6f66 200d 0a20 2020 2020  umber of ..     
+00005c00: 2020 206f 6363 7572 656e 6365 2069 6e20     occurence in 
+00005c10: 7468 6520 7768 6f6c 6520 7661 6c69 6420  the whole valid 
+00005c20: 6061 7272 5f6b 6020 692e 652e 2075 6e64  `arr_k` i.e. und
+00005c30: 6572 2074 6865 2074 6f74 616c 206f 6620  er the total of 
+00005c40: 0d0a 2020 2020 2020 2020 6f63 6375 7265  ..        occure
+00005c50: 6e63 6520 6f66 2061 6c6c 2074 6865 206c  nce of all the l
+00005c60: 6162 656c 7320 7468 6174 2065 7869 7374  abels that exist
+00005c70: 2069 6e20 7468 6520 7768 6f6c 6520 2761   in the whole 'a
+00005c80: 7272 615f 6171 272e 200d 0a20 2020 2020  rra_aq'. ..     
+00005c90: 2020 2054 6869 7320 6361 6e20 6769 7665     This can give
+00005ca0: 2061 2073 7569 7461 626c 6520 616e 6179   a suitable anay
+00005cb0: 6c73 6520 7265 7375 6c74 7320 6966 2074  lse results if t
+00005cc0: 6865 2064 6174 6120 6973 206e 6f74 200d  he data is not .
+00005cd0: 0a20 2020 2020 2020 2075 6e62 616c 616e  .        unbalan
+00005ce0: 6365 6420 666f 7220 6561 6368 206c 6162  ced for each lab
+00005cf0: 656c 7320 696e 2060 6172 725f 6b60 2e0d  els in `arr_k`..
+00005d00: 0a20 2020 2020 2020 200d 0a52 6574 7572  .        ..Retur
+00005d10: 6e73 0d0a 2d2d 2d2d 2d2d 2d0d 0a5f 4772  ns..-------.._Gr
+00005d20: 6f75 703a 203a 636c 6173 733a 607e 2e62  oup: :class:`~.b
+00005d30: 6f78 2e5f 4772 6f75 7060 2063 6c61 7373  ox._Group` class
+00005d40: 206f 626a 6563 7420 0d0a 2020 2020 5573   object ..    Us
+00005d50: 6520 6174 7472 6962 7574 6520 602e 6772  e attribute `.gr
+00005d60: 6f75 7073 6020 746f 2066 696e 6420 7468  oups` to find th
+00005d70: 6520 6772 6f75 7020 7661 6c75 6573 2e20  e group values. 
+00005d80: 0d0a 0d0a 4578 616d 706c 6573 0d0a 2d2d  ....Examples..--
+00005d90: 2d2d 2d2d 2d2d 2d2d 0d0a 2831 2920 5573  --------..(1) Us
+00005da0: 6520 7468 6520 7265 616c 2061 7175 6966  e the real aquif
+00005db0: 6572 2067 726f 7570 2063 6f6c 6c65 6374  er group collect
+00005dc0: 6564 2069 6e20 7468 6520 6172 6561 200d  ed in the area .
+00005dd0: 0a0d 0a3e 3e3e 2066 726f 6d20 7761 7465  ...>>> from wate
+00005de0: 782e 7574 696c 7320 696d 706f 7274 206e  x.utils import n
+00005df0: 6169 7665 5f69 6d70 7574 6572 2c20 7265  aive_imputer, re
+00005e00: 6164 5f64 6174 612c 2072 6573 6861 7065  ad_data, reshape
+00005e10: 200d 0a3e 3e3e 2066 726f 6d20 7761 7465   ..>>> from wate
+00005e20: 782e 6461 7461 7365 7473 2069 6d70 6f72  x.datasets impor
+00005e30: 7420 6c6f 6164 5f68 6c6f 6773 200d 0a3e  t load_hlogs ..>
+00005e40: 3e3e 2066 726f 6d20 7761 7465 782e 7574  >> from watex.ut
+00005e50: 696c 732e 6879 6472 6f75 7469 6c73 2069  ils.hydroutils i
+00005e60: 6d70 6f72 7420 636c 6173 7369 6679 5f6b  mport classify_k
+00005e70: 2c20 6669 6e64 5f61 7175 6966 6572 5f67  , find_aquifer_g
+00005e80: 726f 7570 7320 0d0a 3e3e 3e20 623d 206c  roups ..>>> b= l
+00005e90: 6f61 645f 686c 6f67 7320 2829 2023 6a75  oad_hlogs () #ju
+00005ea0: 7374 2074 616b 696e 6720 7468 6520 7461  st taking the ta
+00005eb0: 7267 6574 206e 616d 6573 0d0a 3e3e 3e20  rget names..>>> 
+00005ec0: 6461 7461 203d 2072 6561 645f 6461 7461  data = read_data
+00005ed0: 2028 2764 6174 612f 626f 7265 686f 6c65   ('data/borehole
+00005ee0: 732f 6866 2e63 7376 2729 2023 2072 6561  s/hf.csv') # rea
+00005ef0: 6420 636f 6d70 6c65 7465 2064 6174 610d  d complete data.
+00005f00: 0a3e 3e3e 2079 203d 2064 6174 6120 5b62  .>>> y = data [b
+00005f10: 2e74 6172 6765 745f 6e61 6d65 735d 0d0a  .target_names]..
+00005f20: 3e3e 3e20 2320 696d 7075 7465 2074 6865  >>> # impute the
+00005f30: 206d 6973 7369 6e67 2076 616c 7565 7320   missing values 
+00005f40: 666f 756e 6420 696e 2061 7175 6966 6572  found in aquifer
+00005f50: 2067 726f 7570 2063 6f6c 756d 6e73 0d0a   group columns..
+00005f60: 3e3e 3e20 2320 7265 7368 6170 6520 3164  >>> # reshape 1d
+00005f70: 2061 7272 6179 2061 6c6f 6e67 2061 7869   array along axi
+00005f80: 7320 3020 666f 7220 696d 7075 7461 7469  s 0 for imputati
+00005f90: 6f6e 200d 0a3e 3e3e 2061 6772 6f75 705f  on ..>>> agroup_
+00005fa0: 696d 7075 7465 6420 3d20 6e61 6976 655f  imputed = naive_
+00005fb0: 696d 7075 7465 7220 2820 7265 7368 6170  imputer ( reshap
+00005fc0: 6520 2879 2e61 7175 6966 6572 5f67 726f  e (y.aquifer_gro
+00005fd0: 7570 2c20 6178 6973 203d 3020 2920 2c20  up, axis =0 ) , 
+00005fe0: 0d0a 2e2e 2e20 2020 2020 2020 2020 2020  .....           
 00005ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006000: 2020 2020 2020 2020 2020 2020 2073 7472               str
-00006010: 6174 6567 7920 3d27 6d6f 7374 5f66 7265  ategy ='most_fre
-00006020: 7175 656e 7427 2920 0d0a 3e3e 3e20 2320  quent') ..>>> # 
-00006030: 7265 7368 6170 6520 6261 636b 2074 6f20  reshape back to 
-00006040: 6172 7261 795f 6c69 6b65 2031 6420 0d0a  array_like 1d ..
-00006050: 3e3e 3e20 792e 6171 7569 6665 725f 6772  >>> y.aquifer_gr
-00006060: 6f75 7020 3d72 6573 6861 7065 2028 6167  oup =reshape (ag
-00006070: 726f 7570 5f69 6d70 7574 6564 2920 0d0a  roup_imputed) ..
-00006080: 3e3e 3e20 2320 6361 7465 676f 7269 7a65  >>> # categorize
-00006090: 2074 6865 2027 6b27 2063 6f6e 7469 6e6f   the 'k' contino
-000060a0: 7573 2076 616c 7565 2069 6e20 2779 2e6b  us value in 'y.k
-000060b0: 2720 7573 696e 6720 7468 6520 6465 6661  ' using the defa
-000060c0: 756c 7420 0d0a 3e3e 3e20 2320 276b 2720  ult ..>>> # 'k' 
-000060d0: 6d61 7070 696e 6720 6675 6e63 200d 0a3e  mapping func ..>
-000060e0: 3e3e 2079 2e6b 203d 2063 6c61 7373 6966  >> y.k = classif
-000060f0: 795f 6b20 2879 2e6b 202c 2064 6566 6175  y_k (y.k , defau
-00006100: 6c74 5f66 756e 6320 3d54 7275 6529 0d0a  lt_func =True)..
-00006110: 3e3e 3e20 2320 6765 7420 7468 6520 6772  >>> # get the gr
-00006120: 6f75 7020 6f62 6a0d 0a3e 3e3e 2067 726f  oup obj..>>> gro
-00006130: 7570 5f6f 626a 203d 2066 696e 645f 6171  up_obj = find_aq
-00006140: 7569 6665 725f 6772 6f75 7073 2879 2e6b  uifer_groups(y.k
-00006150: 2c20 792e 6171 7569 6665 725f 6772 6f75  , y.aquifer_grou
-00006160: 7029 200d 0a3e 3e3e 2067 726f 7570 5f6f  p) ..>>> group_o
-00006170: 626a 200d 0a5f 4772 6f75 7028 4c61 6265  bj .._Group(Labe
-00006180: 6c3d 5b27 2031 2027 2c20 0d0a 2020 2020  l=[' 1 ', ..    
-00006190: 2020 2020 2020 2020 2050 7265 706f 6e64           Prepond
-000061a0: 6572 616e 6365 2820 7261 7465 203d 2027  erance( rate = '
-000061b0: 3533 2e31 3431 2020 2527 2c20 0d0a 2020  53.141  %', ..  
+00006000: 2020 2020 2020 2020 2073 7472 6174 6567           strateg
+00006010: 7920 3d27 6d6f 7374 5f66 7265 7175 656e  y ='most_frequen
+00006020: 7427 2920 0d0a 3e3e 3e20 2320 7265 7368  t') ..>>> # resh
+00006030: 6170 6520 6261 636b 2074 6f20 6172 7261  ape back to arra
+00006040: 795f 6c69 6b65 2031 6420 0d0a 3e3e 3e20  y_like 1d ..>>> 
+00006050: 792e 6171 7569 6665 725f 6772 6f75 7020  y.aquifer_group 
+00006060: 3d72 6573 6861 7065 2028 6167 726f 7570  =reshape (agroup
+00006070: 5f69 6d70 7574 6564 2920 0d0a 3e3e 3e20  _imputed) ..>>> 
+00006080: 2320 6361 7465 676f 7269 7a65 2074 6865  # categorize the
+00006090: 2027 6b27 2063 6f6e 7469 6e6f 7573 2076   'k' continous v
+000060a0: 616c 7565 2069 6e20 2779 2e6b 2720 7573  alue in 'y.k' us
+000060b0: 696e 6720 7468 6520 6465 6661 756c 7420  ing the default 
+000060c0: 0d0a 3e3e 3e20 2320 276b 2720 6d61 7070  ..>>> # 'k' mapp
+000060d0: 696e 6720 6675 6e63 200d 0a3e 3e3e 2079  ing func ..>>> y
+000060e0: 2e6b 203d 2063 6c61 7373 6966 795f 6b20  .k = classify_k 
+000060f0: 2879 2e6b 202c 2064 6566 6175 6c74 5f66  (y.k , default_f
+00006100: 756e 6320 3d54 7275 6529 0d0a 3e3e 3e20  unc =True)..>>> 
+00006110: 2320 6765 7420 7468 6520 6772 6f75 7020  # get the group 
+00006120: 6f62 6a0d 0a3e 3e3e 2067 726f 7570 5f6f  obj..>>> group_o
+00006130: 626a 203d 2066 696e 645f 6171 7569 6665  bj = find_aquife
+00006140: 725f 6772 6f75 7073 2879 2e6b 2c20 792e  r_groups(y.k, y.
+00006150: 6171 7569 6665 725f 6772 6f75 7029 200d  aquifer_group) .
+00006160: 0a3e 3e3e 2067 726f 7570 5f6f 626a 200d  .>>> group_obj .
+00006170: 0a5f 4772 6f75 7028 4c61 6265 6c3d 5b27  ._Group(Label=['
+00006180: 2031 2027 2c20 0d0a 2020 2020 2020 2020   1 ', ..        
+00006190: 2020 2020 2050 7265 706f 6e64 6572 616e       Preponderan
+000061a0: 6365 2820 7261 7465 203d 2027 3533 2e31  ce( rate = '53.1
+000061b0: 3431 2020 2527 2c20 0d0a 2020 2020 2020  41  %', ..      
 000061c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000061d0: 2020 2020 2020 2020 205b 2827 4772 6f75           [('Grou
-000061e0: 7073 272c 207b 7b27 5627 3a20 302e 3332  ps', {{'V': 0.32
-000061f0: 2c20 2749 5627 3a20 302e 3236 362c 2027  , 'IV': 0.266, '
-00006200: 4949 273a 2030 2e32 3336 2c20 0d0a 2020  II': 0.236, ..  
+000061d0: 2020 2020 205b 2827 4772 6f75 7073 272c       [('Groups',
+000061e0: 207b 7b27 5627 3a20 302e 3332 2c20 2749   {{'V': 0.32, 'I
+000061f0: 5627 3a20 302e 3236 362c 2027 4949 273a  V': 0.266, 'II':
+00006200: 2030 2e32 3336 2c20 0d0a 2020 2020 2020   0.236, ..      
 00006210: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00006220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006230: 2020 2020 2020 2749 4949 273a 2030 2e31        'III': 0.1
-00006240: 3538 2c20 2749 5626 5627 3a20 302e 3031  58, 'IV&V': 0.01
-00006250: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00006230: 2020 2749 4949 273a 2030 2e31 3538 2c20    'III': 0.158, 
+00006240: 2749 5626 5627 3a20 302e 3031 2c20 0d0a  'IV&V': 0.01, ..
+00006250: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00006260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006270: 2020 2020 2020 2020 2020 2020 2749 4926              'II&
-00006280: 4949 4927 3a20 302e 3030 352c 2027 4949  III': 0.005, 'II
-00006290: 4926 4956 273a 2030 2e30 3035 7d7d 292c  I&IV': 0.005}}),
-000062a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000062b0: 2020 2020 2020 2020 2020 2020 2020 2827                ('
-000062c0: 5265 7072 6573 656e 7461 7469 7669 7479  Representativity
-000062d0: 272c 2028 2027 5627 2c20 302e 3332 2929  ', ( 'V', 0.32))
-000062e0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000062f0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-00006300: 2753 696d 696c 6172 6974 7927 2c20 2756  'Similarity', 'V
-00006310: 2729 5d29 5d2c 0d0a 2020 2020 2020 2020  ')])],..        
-00006320: 4c61 6265 6c3d 5b27 2032 2027 2c20 0d0a  Label=[' 2 ', ..
-00006330: 2020 2020 2020 2020 2020 2020 2020 5072                Pr
-00006340: 6570 6f6e 6465 7261 6e63 6528 2072 6174  eponderance( rat
-00006350: 6520 3d20 2720 3139 2e31 3120 2025 272c  e = ' 19.11  %',
-00006360: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00006370: 2020 2020 2020 2020 2020 2020 2020 5b28                [(
-00006380: 2747 726f 7570 7327 2c20 7b7b 2749 4949  'Groups', {{'III
-00006390: 273a 2030 2e32 3734 2c20 2749 4927 3a20  ': 0.274, 'II': 
-000063a0: 302e 3236 2c20 2756 273a 2030 2e32 362c  0.26, 'V': 0.26,
-000063b0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00006270: 2020 2020 2020 2020 2749 4926 4949 4927          'II&III'
+00006280: 3a20 302e 3030 352c 2027 4949 4926 4956  : 0.005, 'III&IV
+00006290: 273a 2030 2e30 3035 7d7d 292c 0d0a 2020  ': 0.005}}),..  
+000062a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000062b0: 2020 2020 2020 2020 2020 2827 5265 7072            ('Repr
+000062c0: 6573 656e 7461 7469 7669 7479 272c 2028  esentativity', (
+000062d0: 2027 5627 2c20 302e 3332 2929 2c0d 0a20   'V', 0.32)),.. 
+000062e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000062f0: 2020 2020 2020 2020 2020 2028 2753 696d             ('Sim
+00006300: 696c 6172 6974 7927 2c20 2756 2729 5d29  ilarity', 'V')])
+00006310: 5d2c 0d0a 2020 2020 2020 2020 4c61 6265  ],..        Labe
+00006320: 6c3d 5b27 2032 2027 2c20 0d0a 2020 2020  l=[' 2 ', ..    
+00006330: 2020 2020 2020 2020 2020 5072 6570 6f6e            Prepon
+00006340: 6465 7261 6e63 6528 2072 6174 6520 3d20  derance( rate = 
+00006350: 2720 3139 2e31 3120 2025 272c 200d 0a20  ' 19.11  %', .. 
+00006360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006370: 2020 2020 2020 2020 2020 5b28 2747 726f            [('Gro
+00006380: 7570 7327 2c20 7b7b 2749 4949 273a 2030  ups', {{'III': 0
+00006390: 2e32 3734 2c20 2749 4927 3a20 302e 3236  .274, 'II': 0.26
+000063a0: 2c20 2756 273a 2030 2e32 362c 200d 0a20  , 'V': 0.26, .. 
+000063b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000063c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000063d0: 2020 2020 2020 2020 2020 2027 4956 273a             'IV':
-000063e0: 2030 2e31 3738 2c20 2749 4949 2649 5627   0.178, 'III&IV'
-000063f0: 3a20 302e 3032 377d 7d29 2c0d 0a20 2020  : 0.027}}),..   
+000063d0: 2020 2020 2020 2027 4956 273a 2030 2e31         'IV': 0.1
+000063e0: 3738 2c20 2749 4949 2649 5627 3a20 302e  78, 'III&IV': 0.
+000063f0: 3032 377d 7d29 2c0d 0a20 2020 2020 2020  027}}),..       
 00006400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006410: 2020 2020 2020 2020 2028 2752 6570 7265           ('Repre
-00006420: 7365 6e74 6174 6976 6974 7927 2c20 2820  sentativity', ( 
-00006430: 2749 4949 272c 2030 2e32 3729 292c 0d0a  'III', 0.27)),..
+00006410: 2020 2020 2028 2752 6570 7265 7365 6e74       ('Represent
+00006420: 6174 6976 6974 7927 2c20 2820 2749 4949  ativity', ( 'III
+00006430: 272c 2030 2e32 3729 292c 0d0a 2020 2020  ', 0.27)),..    
 00006440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006450: 2020 2020 2020 2020 2020 2020 2827 5369              ('Si
-00006460: 6d69 6c61 7269 7479 272c 2027 4949 4927  milarity', 'III'
-00006470: 295d 295d 2c0d 0a20 2020 2020 2020 204c  )])],..        L
-00006480: 6162 656c 3d5b 2720 3320 272c 200d 0a20  abel=[' 3 ', .. 
-00006490: 2020 2020 2020 2020 2020 2020 2050 7265               Pre
-000064a0: 706f 6e64 6572 616e 6365 2820 7261 7465  ponderance( rate
-000064b0: 203d 2027 3237 2e37 3439 2020 2527 2c20   = '27.749  %', 
-000064c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000064d0: 2020 2020 2020 2020 2020 2020 205b 2827               [('
-000064e0: 4772 6f75 7073 272c 207b 7b27 5627 3a20  Groups', {{'V': 
-000064f0: 302e 3434 332c 2027 4956 273a 2030 2e33  0.443, 'IV': 0.3
-00006500: 3131 2c20 2749 4949 273a 2030 2e32 3435  11, 'III': 0.245
-00006510: 7d7d 292c 0d0a 2020 2020 2020 2020 2020  }}),..          
-00006520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006530: 2020 2827 5265 7072 6573 656e 7461 7469    ('Representati
-00006540: 7669 7479 272c 2028 2027 5627 2c20 302e  vity', ( 'V', 0.
-00006550: 3434 2929 2c0d 0a20 2020 2020 2020 2020  44)),..         
-00006560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006570: 2020 2028 2753 696d 696c 6172 6974 7927     ('Similarity'
-00006580: 2c20 2756 2729 5d29 5d2c 0d0a 2020 2020  , 'V')])],..    
-00006590: 2020 2020 2020 2020 2029 0d0a 2832 2920           )..(2) 
-000065a0: 5573 6520 7468 6520 7375 626a 6563 7469  Use the subjecti
-000065b0: 7669 7479 2061 6e64 2073 6574 2074 6865  vity and set the
-000065c0: 2073 7472 6174 6120 636f 6c75 6d6e 7320   strata columns 
-000065d0: 6173 2064 6566 6175 6c74 2061 7272 6179  as default array
-000065e0: 200d 0a0d 0a3e 3e3e 2066 696e 645f 6171   ....>>> find_aq
-000065f0: 7569 6665 725f 6772 6f75 7073 2879 2e6b  uifer_groups(y.k
-00006600: 2c20 7375 626a 6563 7469 7669 7479 3d54  , subjectivity=T
-00006610: 7275 652c 2064 6566 6175 6c74 5f61 7272  rue, default_arr
-00006620: 3d20 582e 7374 7261 7461 5f6e 616d 6520  = X.strata_name 
-00006630: 2920 0d0a 5f47 726f 7570 284c 6162 656c  ) .._Group(Label
-00006640: 3d5b 2720 3120 272c 200d 0a20 2020 2020  =[' 1 ', ..     
-00006650: 2020 2020 2020 2020 5072 6570 6f6e 6465          Preponde
-00006660: 7261 6e63 6528 2072 6174 6520 3d20 2735  rance( rate = '5
-00006670: 332e 3134 3120 2025 272c 200d 0a20 2020  3.141  %', ..   
+00006450: 2020 2020 2020 2020 2827 5369 6d69 6c61          ('Simila
+00006460: 7269 7479 272c 2027 4949 4927 295d 295d  rity', 'III')])]
+00006470: 2c0d 0a20 2020 2020 2020 204c 6162 656c  ,..        Label
+00006480: 3d5b 2720 3320 272c 200d 0a20 2020 2020  =[' 3 ', ..     
+00006490: 2020 2020 2020 2020 2050 7265 706f 6e64           Prepond
+000064a0: 6572 616e 6365 2820 7261 7465 203d 2027  erance( rate = '
+000064b0: 3237 2e37 3439 2020 2527 2c20 0d0a 2020  27.749  %', ..  
+000064c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000064d0: 2020 2020 2020 2020 205b 2827 4772 6f75           [('Grou
+000064e0: 7073 272c 207b 7b27 5627 3a20 302e 3434  ps', {{'V': 0.44
+000064f0: 332c 2027 4956 273a 2030 2e33 3131 2c20  3, 'IV': 0.311, 
+00006500: 2749 4949 273a 2030 2e32 3435 7d7d 292c  'III': 0.245}}),
+00006510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00006520: 2020 2020 2020 2020 2020 2020 2020 2827                ('
+00006530: 5265 7072 6573 656e 7461 7469 7669 7479  Representativity
+00006540: 272c 2028 2027 5627 2c20 302e 3434 2929  ', ( 'V', 0.44))
+00006550: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00006560: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00006570: 2753 696d 696c 6172 6974 7927 2c20 2756  'Similarity', 'V
+00006580: 2729 5d29 5d2c 0d0a 2020 2020 2020 2020  ')])],..        
+00006590: 2020 2020 2029 0d0a 2832 2920 5573 6520       )..(2) Use 
+000065a0: 7468 6520 7375 626a 6563 7469 7669 7479  the subjectivity
+000065b0: 2061 6e64 2073 6574 2074 6865 2073 7472   and set the str
+000065c0: 6174 6120 636f 6c75 6d6e 7320 6173 2064  ata columns as d
+000065d0: 6566 6175 6c74 2061 7272 6179 200d 0a0d  efault array ...
+000065e0: 0a3e 3e3e 2066 696e 645f 6171 7569 6665  .>>> find_aquife
+000065f0: 725f 6772 6f75 7073 2879 2e6b 2c20 7375  r_groups(y.k, su
+00006600: 626a 6563 7469 7669 7479 3d54 7275 652c  bjectivity=True,
+00006610: 2064 6566 6175 6c74 5f61 7272 3d20 582e   default_arr= X.
+00006620: 7374 7261 7461 5f6e 616d 6520 2920 0d0a  strata_name ) ..
+00006630: 5f47 726f 7570 284c 6162 656c 3d5b 2720  _Group(Label=[' 
+00006640: 3120 272c 200d 0a20 2020 2020 2020 2020  1 ', ..         
+00006650: 2020 2020 5072 6570 6f6e 6465 7261 6e63      Preponderanc
+00006660: 6528 2072 6174 6520 3d20 2735 332e 3134  e( rate = '53.14
+00006670: 3120 2025 272c 200d 0a20 2020 2020 2020  1  %', ..       
 00006680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006690: 2020 2020 2020 2020 5b28 2747 726f 7570          [('Group
-000066a0: 7327 2c20 7b7b 2773 696c 7473 746f 6e65  s', {{'siltstone
-000066b0: 273a 2030 2e33 352c 2027 636f 616c 273a  ': 0.35, 'coal':
-000066c0: 2030 2e32 3237 2c20 0d0a 2020 2020 2020   0.227, ..      
+00006690: 2020 2020 5b28 2747 726f 7570 7327 2c20      [('Groups', 
+000066a0: 7b7b 2773 696c 7473 746f 6e65 273a 2030  {{'siltstone': 0
+000066b0: 2e33 352c 2027 636f 616c 273a 2030 2e32  .35, 'coal': 0.2
+000066c0: 3237 2c20 0d0a 2020 2020 2020 2020 2020  27, ..          
 000066d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000066e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000066f0: 2020 2766 696e 652d 6772 6169 6e65 6420    'fine-grained 
-00006700: 7361 6e64 7374 6f6e 6527 3a20 302e 3135  sandstone': 0.15
-00006710: 382c 200d 0a20 2020 2020 2020 2020 2020  8, ..           
+000066e0: 2020 2020 2020 2020 2020 2020 2020 2766                'f
+000066f0: 696e 652d 6772 6169 6e65 6420 7361 6e64  ine-grained sand
+00006700: 7374 6f6e 6527 3a20 302e 3135 382c 200d  stone': 0.158, .
+00006710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00006720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006730: 2020 2020 2020 2020 2020 2020 2027 6d65               'me
-00006740: 6469 756d 2d67 7261 696e 6564 2073 616e  dium-grained san
-00006750: 6473 746f 6e65 273a 2030 2e30 3934 2c20  dstone': 0.094, 
-00006760: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00006730: 2020 2020 2020 2020 2027 6d65 6469 756d           'medium
+00006740: 2d67 7261 696e 6564 2073 616e 6473 746f  -grained sandsto
+00006750: 6e65 273a 2030 2e30 3934 2c20 0d0a 2020  ne': 0.094, ..  
+00006760: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00006770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006780: 2020 2020 2020 2020 2020 276d 7564 7374            'mudst
-00006790: 6f6e 6527 3a20 302e 3037 392c 200d 0a20  one': 0.079, .. 
+00006780: 2020 2020 2020 276d 7564 7374 6f6e 6527        'mudstone'
+00006790: 3a20 302e 3037 392c 200d 0a20 2020 2020  : 0.079, ..     
 000067a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000067b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000067c0: 2020 2020 2020 2027 6361 7262 6f6e 6163         'carbonac
-000067d0: 656f 7573 206d 7564 7374 6f6e 6527 3a20  eous mudstone': 
-000067e0: 302e 3035 342c 200d 0a20 2020 2020 2020  0.054, ..       
+000067c0: 2020 2027 6361 7262 6f6e 6163 656f 7573     'carbonaceous
+000067d0: 206d 7564 7374 6f6e 6527 3a20 302e 3035   mudstone': 0.05
+000067e0: 342c 200d 0a20 2020 2020 2020 2020 2020  4, ..           
 000067f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006810: 2027 636f 6172 7365 2d67 7261 696e 6564   'coarse-grained
-00006820: 2073 616e 6473 746f 6e65 273a 2030 2e30   sandstone': 0.0
-00006830: 332c 200d 0a20 2020 2020 2020 2020 2020  3, ..           
+00006800: 2020 2020 2020 2020 2020 2020 2027 636f               'co
+00006810: 6172 7365 2d67 7261 696e 6564 2073 616e  arse-grained san
+00006820: 6473 746f 6e65 273a 2030 2e30 332c 200d  dstone': 0.03, .
+00006830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00006840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006850: 2020 2020 2020 2020 2020 2020 2027 636f               'co
-00006860: 6172 7365 273a 2030 2e30 317d 7d29 2c0d  arse': 0.01}}),.
-00006870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006880: 2020 2020 2020 2020 2020 2020 2028 2752               ('R
-00006890: 6570 7265 7365 6e74 6174 6976 6974 7927  epresentativity'
-000068a0: 2c20 2820 2773 696c 7473 746f 6e65 272c  , ( 'siltstone',
-000068b0: 2030 2e33 3529 292c 0d0a 2020 2020 2020   0.35)),..      
+00006850: 2020 2020 2020 2020 2027 636f 6172 7365           'coarse
+00006860: 273a 2030 2e30 317d 7d29 2c0d 0a20 2020  ': 0.01}}),..   
+00006870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006880: 2020 2020 2020 2020 2028 2752 6570 7265           ('Repre
+00006890: 7365 6e74 6174 6976 6974 7927 2c20 2820  sentativity', ( 
+000068a0: 2773 696c 7473 746f 6e65 272c 2030 2e33  'siltstone', 0.3
+000068b0: 3529 292c 0d0a 2020 2020 2020 2020 2020  5)),..          
 000068c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000068d0: 2020 2020 2020 2827 5369 6d69 6c61 7269        ('Similari
-000068e0: 7479 272c 2027 7369 6c74 7374 6f6e 6527  ty', 'siltstone'
-000068f0: 295d 295d 2c0d 0a20 2020 2020 2020 204c  )])],..        L
-00006900: 6162 656c 3d5b 2720 3220 272c 200d 0a20  abel=[' 2 ', .. 
-00006910: 2020 2020 2020 2020 2020 2020 2050 7265               Pre
-00006920: 706f 6e64 6572 616e 6365 2820 7261 7465  ponderance( rate
-00006930: 203d 2027 2031 392e 3131 2020 2527 2c20   = ' 19.11  %', 
-00006940: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00006950: 2020 2020 2020 2020 2020 2020 205b 2827               [('
-00006960: 4772 6f75 7073 272c 207b 7b27 6d75 6473  Groups', {{'muds
-00006970: 746f 6e65 273a 2030 2e32 3838 2c20 2773  tone': 0.288, 's
-00006980: 696c 7473 746f 6e65 273a 2030 2e32 3035  iltstone': 0.205
-00006990: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+000068d0: 2020 2827 5369 6d69 6c61 7269 7479 272c    ('Similarity',
+000068e0: 2027 7369 6c74 7374 6f6e 6527 295d 295d   'siltstone')])]
+000068f0: 2c0d 0a20 2020 2020 2020 204c 6162 656c  ,..        Label
+00006900: 3d5b 2720 3220 272c 200d 0a20 2020 2020  =[' 2 ', ..     
+00006910: 2020 2020 2020 2020 2050 7265 706f 6e64           Prepond
+00006920: 6572 616e 6365 2820 7261 7465 203d 2027  erance( rate = '
+00006930: 2031 392e 3131 2020 2527 2c20 0d0a 2020   19.11  %', ..  
+00006940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006950: 2020 2020 2020 2020 205b 2827 4772 6f75           [('Grou
+00006960: 7073 272c 207b 7b27 6d75 6473 746f 6e65  ps', {{'mudstone
+00006970: 273a 2030 2e32 3838 2c20 2773 696c 7473  ': 0.288, 'silts
+00006980: 746f 6e65 273a 2030 2e32 3035 2c20 0d0a  tone': 0.205, ..
+00006990: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000069a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000069b0: 2020 2020 2020 2020 2020 2020 2763 6f61              'coa
-000069c0: 6c27 3a20 302e 3139 322c 200d 0a20 2020  l': 0.192, ..   
+000069b0: 2020 2020 2020 2020 2763 6f61 6c27 3a20          'coal': 
+000069c0: 302e 3139 322c 200d 0a20 2020 2020 2020  0.192, ..       
 000069d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000069e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000069f0: 2020 2020 2027 636f 6172 7365 2d67 7261       'coarse-gra
-00006a00: 696e 6564 2073 616e 6473 746f 6e65 273a  ined sandstone':
-00006a10: 2030 2e31 3337 2c20 0d0a 2020 2020 2020   0.137, ..      
+000069f0: 2027 636f 6172 7365 2d67 7261 696e 6564   'coarse-grained
+00006a00: 2073 616e 6473 746f 6e65 273a 2030 2e31   sandstone': 0.1
+00006a10: 3337 2c20 0d0a 2020 2020 2020 2020 2020  37, ..          
 00006a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006a40: 2020 2766 696e 652d 6772 6169 6e65 6420    'fine-grained 
-00006a50: 7361 6e64 7374 6f6e 6527 3a20 302e 3133  sandstone': 0.13
-00006a60: 372c 200d 0a20 2020 2020 2020 2020 2020  7, ..           
+00006a30: 2020 2020 2020 2020 2020 2020 2020 2766                'f
+00006a40: 696e 652d 6772 6169 6e65 6420 7361 6e64  ine-grained sand
+00006a50: 7374 6f6e 6527 3a20 302e 3133 372c 200d  stone': 0.137, .
+00006a60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00006a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006a80: 2020 2020 2020 2020 2020 2020 2027 6361               'ca
-00006a90: 7262 6f6e 6163 656f 7573 206d 7564 7374  rbonaceous mudst
-00006aa0: 6f6e 6527 3a20 302e 3032 372c 200d 0a20  one': 0.027, .. 
+00006a80: 2020 2020 2020 2020 2027 6361 7262 6f6e           'carbon
+00006a90: 6163 656f 7573 206d 7564 7374 6f6e 6527  aceous mudstone'
+00006aa0: 3a20 302e 3032 372c 200d 0a20 2020 2020  : 0.027, ..     
 00006ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00006ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ad0: 2020 2020 2020 2027 6d65 6469 756d 2d67         'medium-g
-00006ae0: 7261 696e 6564 2073 616e 6473 746f 6e65  rained sandstone
-00006af0: 273a 2030 2e30 3134 7d7d 292c 0d0a 2020  ': 0.014}}),..  
+00006ad0: 2020 2027 6d65 6469 756d 2d67 7261 696e     'medium-grain
+00006ae0: 6564 2073 616e 6473 746f 6e65 273a 2030  ed sandstone': 0
+00006af0: 2e30 3134 7d7d 292c 0d0a 2020 2020 2020  .014}}),..      
 00006b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006b10: 2020 2020 2020 2020 2020 2827 5265 7072            ('Repr
-00006b20: 6573 656e 7461 7469 7669 7479 272c 2028  esentativity', (
-00006b30: 2027 6d75 6473 746f 6e65 272c 2030 2e32   'mudstone', 0.2
-00006b40: 3929 292c 0d0a 2020 2020 2020 2020 2020  9)),..          
-00006b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006b60: 2020 2827 5369 6d69 6c61 7269 7479 272c    ('Similarity',
-00006b70: 2027 6d75 6473 746f 6e65 2729 5d29 5d2c   'mudstone')])],
-00006b80: 0d0a 2020 2020 2020 2020 4c61 6265 6c3d  ..        Label=
-00006b90: 5b27 2033 2027 2c20 0d0a 2020 2020 2020  [' 3 ', ..      
-00006ba0: 2020 2020 2020 2020 5072 6570 6f6e 6465          Preponde
-00006bb0: 7261 6e63 6528 2072 6174 6520 3d20 2732  rance( rate = '2
-00006bc0: 372e 3734 3920 2025 272c 200d 0a20 2020  7.749  %', ..   
+00006b10: 2020 2020 2020 2827 5265 7072 6573 656e        ('Represen
+00006b20: 7461 7469 7669 7479 272c 2028 2027 6d75  tativity', ( 'mu
+00006b30: 6473 746f 6e65 272c 2030 2e32 3929 292c  dstone', 0.29)),
+00006b40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00006b50: 2020 2020 2020 2020 2020 2020 2020 2827                ('
+00006b60: 5369 6d69 6c61 7269 7479 272c 2027 6d75  Similarity', 'mu
+00006b70: 6473 746f 6e65 2729 5d29 5d2c 0d0a 2020  dstone')])],..  
+00006b80: 2020 2020 2020 4c61 6265 6c3d 5b27 2033        Label=[' 3
+00006b90: 2027 2c20 0d0a 2020 2020 2020 2020 2020   ', ..          
+00006ba0: 2020 2020 5072 6570 6f6e 6465 7261 6e63      Preponderanc
+00006bb0: 6528 2072 6174 6520 3d20 2732 372e 3734  e( rate = '27.74
+00006bc0: 3920 2025 272c 200d 0a20 2020 2020 2020  9  %', ..       
 00006bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006be0: 2020 2020 2020 2020 5b28 2747 726f 7570          [('Group
-00006bf0: 7327 2c20 7b7b 276d 7564 7374 6f6e 6527  s', {{'mudstone'
-00006c00: 3a20 302e 3234 352c 2027 636f 616c 273a  : 0.245, 'coal':
-00006c10: 2030 2e32 3236 2c20 0d0a 2020 2020 2020   0.226, ..      
+00006be0: 2020 2020 5b28 2747 726f 7570 7327 2c20      [('Groups', 
+00006bf0: 7b7b 276d 7564 7374 6f6e 6527 3a20 302e  {{'mudstone': 0.
+00006c00: 3234 352c 2027 636f 616c 273a 2030 2e32  245, 'coal': 0.2
+00006c10: 3236 2c20 0d0a 2020 2020 2020 2020 2020  26, ..          
 00006c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c40: 2020 2773 696c 7473 746f 6e65 273a 2030    'siltstone': 0
-00006c50: 2e32 3137 2c20 0d0a 2020 2020 2020 2020  .217, ..        
+00006c30: 2020 2020 2020 2020 2020 2020 2020 2773                's
+00006c40: 696c 7473 746f 6e65 273a 2030 2e32 3137  iltstone': 0.217
+00006c50: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
 00006c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c80: 2766 696e 652d 6772 6169 6e65 6420 7361  'fine-grained sa
-00006c90: 6e64 7374 6f6e 6527 3a20 302e 3132 332c  ndstone': 0.123,
-00006ca0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00006c70: 2020 2020 2020 2020 2020 2020 2766 696e              'fin
+00006c80: 652d 6772 6169 6e65 6420 7361 6e64 7374  e-grained sandst
+00006c90: 6f6e 6527 3a20 302e 3132 332c 200d 0a20  one': 0.123, .. 
+00006ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00006cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006cc0: 2020 2020 2020 2020 2020 2027 6361 7262             'carb
-00006cd0: 6f6e 6163 656f 7573 206d 7564 7374 6f6e  onaceous mudston
-00006ce0: 6527 3a20 302e 3036 362c 200d 0a20 2020  e': 0.066, ..   
+00006cc0: 2020 2020 2020 2027 6361 7262 6f6e 6163         'carbonac
+00006cd0: 656f 7573 206d 7564 7374 6f6e 6527 3a20  eous mudstone': 
+00006ce0: 302e 3036 362c 200d 0a20 2020 2020 2020  0.066, ..       
 00006cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00006d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006d10: 2020 2020 2027 6d65 6469 756d 2d67 7261       'medium-gra
-00006d20: 696e 6564 2073 616e 6473 746f 6e65 273a  ined sandstone':
-00006d30: 2030 2e30 3636 2c20 0d0a 2020 2020 2020   0.066, ..      
+00006d10: 2027 6d65 6469 756d 2d67 7261 696e 6564   'medium-grained
+00006d20: 2073 616e 6473 746f 6e65 273a 2030 2e30   sandstone': 0.0
+00006d30: 3636 2c20 0d0a 2020 2020 2020 2020 2020  66, ..          
 00006d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006d60: 2020 2763 6f61 7273 652d 6772 6169 6e65    'coarse-graine
-00006d70: 6420 7361 6e64 7374 6f6e 6527 3a20 302e  d sandstone': 0.
-00006d80: 3035 377d 7d29 2c0d 0a20 2020 2020 2020  057}}),..       
+00006d50: 2020 2020 2020 2020 2020 2020 2020 2763                'c
+00006d60: 6f61 7273 652d 6772 6169 6e65 6420 7361  oarse-grained sa
+00006d70: 6e64 7374 6f6e 6527 3a20 302e 3035 377d  ndstone': 0.057}
+00006d80: 7d29 2c0d 0a20 2020 2020 2020 2020 2020  }),..           
 00006d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006da0: 2020 2020 2028 2752 6570 7265 7365 6e74       ('Represent
-00006db0: 6174 6976 6974 7927 2c20 2820 276d 7564  ativity', ( 'mud
-00006dc0: 7374 6f6e 6527 2c20 302e 3234 2929 2c0d  stone', 0.24)),.
-00006dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006de0: 2020 2020 2020 2020 2020 2020 2028 2753               ('S
-00006df0: 696d 696c 6172 6974 7927 2c20 276d 7564  imilarity', 'mud
-00006e00: 7374 6f6e 6527 295d 295d 2c0d 0a20 2020  stone')])],..   
-00006e10: 2020 2020 2020 2020 2020 290d 0a22 2222            ).."""
-00006e20: 2e66 6f72 6d61 7428 7061 7261 6d73 3d5f  .format(params=_
-00006e30: 7061 7261 6d5f 646f 6373 0d0a 290d 0a20  param_docs..).. 
-00006e40: 2020 200d 0a64 6566 206c 6162 656c 5f69     ..def label_i
-00006e50: 6d70 6f72 7461 6e63 6520 280d 0a20 2020  mportance (..   
-00006e60: 206c 6162 656c 3a20 696e 742c 200d 0a20   label: int, .. 
-00006e70: 2020 2061 7272 5f6b 3a20 4172 7261 794c     arr_k: ArrayL
-00006e80: 696b 6520 2c20 0d0a 2020 2020 6172 725f  ike , ..    arr_
-00006e90: 6171 3a41 7272 6179 4c69 6b65 2c20 0d0a  aq:ArrayLike, ..
-00006ea0: 2020 2020 2a2c 200d 0a20 2020 206d 6574      *, ..    met
-00006eb0: 686f 643a 7374 723d 276e 6169 7665 2720  hod:str='naive' 
-00006ec0: 0d0a 2020 2020 292d 3e64 6963 743a 0d0a  ..    )->dict:..
-00006ed0: 2020 2020 2222 2243 6f6d 7075 7465 2074      """Compute t
-00006ee0: 6865 2073 636f 7265 2066 6f72 2074 6865  he score for the
-00006ef0: 206c 6162 656c 2061 6e64 2069 7473 2072   label and its r
-00006f00: 6570 7265 7365 6e74 6174 6976 6974 7920  epresentativity 
-00006f10: 696e 2074 6865 2076 616c 6964 200d 0a20  in the valid .. 
-00006f20: 2020 2061 7272 6179 2027 6172 725f 6b27     array 'arr_k'
-00006f30: 200d 0a20 2020 200d 0a20 2020 2050 6172   ..    ..    Par
-00006f40: 616d 6574 6572 7320 0d0a 2020 2020 2d2d  ameters ..    --
-00006f50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
-00006f60: 206c 6162 656c 3a20 696e 742c 206f 7220   label: int, or 
-00006f70: 7374 7269 6e67 2020 0d0a 2020 2020 2020  string  ..      
-00006f80: 2020 636c 6173 7320 6c61 6265 6c20 6672    class label fr
-00006f90: 6f6d 2074 6865 2074 7275 6520 6c61 6265  om the true labe
-00006fa0: 6c73 2061 7272 6179 206f 6620 2070 6572  ls array of  per
-00006fb0: 6d65 6162 696c 6974 7920 636f 6566 6669  meability coeffi
-00006fc0: 6369 656e 7420 276b 272e 0d0a 2020 2020  cient 'k'...    
-00006fd0: 2020 2020 4966 2073 7472 696e 672c 2062      If string, b
-00006fe0: 6520 7375 7265 2074 6f20 636f 6e76 6572  e sure to conver
-00006ff0: 7420 7468 6520 6172 7261 7920 746f 2068  t the array to h
-00007000: 6f6c 6420 7468 6520 6474 7970 6520 7374  old the dtype st
-00007010: 722e 2049 7420 6973 200d 0a20 2020 2020  r. It is ..     
-00007020: 2020 2072 6563 6f6d 6d6e 656e 6465 6420     recommnended 
-00007030: 746f 2070 726f 7669 6465 2064 6174 6120  to provide data 
-00007040: 7769 7468 206e 6f20 4e61 4e20 746f 2068  with no NaN to h
-00007050: 6176 6520 6675 6c6c 2063 6f6e 7472 6f6c  ave full control
-00007060: 2074 6865 200d 0a20 2020 2020 2020 206f   the ..        o
-00007070: 6363 7572 656e 6365 2072 6573 756c 7473  ccurence results
-00007080: 2e20 0d0a 0d0a 2020 2020 6172 725f 6b3a  . ....    arr_k:
-00007090: 2061 7272 6179 2d6c 696b 6520 3164 200d   array-like 1d .
-000070a0: 0a20 2020 2020 2020 2054 7275 6520 6c61  .        True la
-000070b0: 6265 6c73 206f 6620 6172 7261 7920 636f  bels of array co
-000070c0: 6e74 6169 6e69 6e67 2074 6865 2070 6572  ntaining the per
-000070d0: 6d65 6162 696c 6974 7920 636f 6566 6669  meability coeffi
-000070e0: 6369 656e 7420 276b 272e 0d0a 0d0a 2020  cient 'k'.....  
-000070f0: 2020 6172 725f 6171 3a20 6172 7261 795f    arr_aq: array_
-00007100: 6c69 6b65 2031 6420 0d0a 2020 2020 2020  like 1d ..      
-00007110: 2020 5472 7565 206c 6162 656c 7320 6f66    True labels of
-00007120: 2074 6865 2067 726f 7570 7320 6f66 2061   the groups of a
-00007130: 7175 6966 6572 7320 6f72 2070 7265 6469  quifers or predi
-00007140: 6374 6564 206e 6169 7665 2067 726f 7570  cted naive group
-00007150: 206f 6620 0d0a 2020 2020 2020 2020 2061   of ..         a
-00007160: 7175 6966 6572 2028 4e47 4120 6c61 6265  quifer (NGA labe
-00007170: 6c73 292e 2053 6565 203a 6675 6e63 3a60  ls). See :func:`
-00007180: 7e2e 7072 6564 6963 745f 4e47 415f 6c61  ~.predict_NGA_la
-00007190: 6265 6c73 602e 0d0a 2020 2020 2020 2020  bels`...        
-000071a0: 200d 0a20 2020 206d 6574 686f 643a 2073   ..    method: s
-000071b0: 7472 205b 276e 6169 7665 272c 2027 7374  tr ['naive', 'st
-000071c0: 7269 6374 275d 2c20 6465 6661 756c 743d  rict'], default=
-000071d0: 276e 6169 7665 270d 0a20 2020 2020 2020  'naive'..       
-000071e0: 2054 6865 206b 696e 6420 6f66 2073 7472   The kind of str
-000071f0: 6174 6567 7920 746f 2063 6f6d 7075 7465  ategy to compute
-00007200: 2074 6865 2072 6570 7265 7365 6e74 6174   the representat
-00007210: 6976 6974 7920 6f66 2061 206c 6162 656c  ivity of a label
-00007220: 200d 0a20 2020 2020 2020 2069 6e20 7468   ..        in th
-00007230: 6520 7072 6564 6963 7465 6420 6172 7261  e predicted arra
-00007240: 7920 2761 7272 6179 5f61 7127 2e20 4974  y 'array_aq'. It
-00007250: 2063 616e 2061 6c73 6f20 6265 2027 7374   can also be 'st
-00007260: 7269 6374 272e 2049 6e64 6565 643a 0d0a  rict'. Indeed:..
-00007270: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00007280: 2020 2d20 276e 6169 7665 2720 636f 6d70    - 'naive' comp
-00007290: 7574 6573 2074 6865 2069 6d70 6f72 7461  utes the importa
-000072a0: 6e63 6520 6f66 2074 6865 206c 6162 656c  nce of the label
-000072b0: 2062 7920 7468 6520 6e75 6d62 6572 206f   by the number o
-000072c0: 6620 6974 730d 0a20 2020 2020 2020 2020  f its..         
-000072d0: 2020 206f 6363 7572 656e 6365 2066 6f72     occurence for
-000072e0: 2074 6869 7320 7370 6563 6966 6963 206c   this specific l
-000072f0: 6162 656c 2069 6e20 7468 6520 6172 7261  abel in the arra
-00007300: 7920 276b 272e 2049 7420 646f 6573 206e  y 'k'. It does n
-00007310: 6f74 200d 0a20 2020 2020 2020 2020 2020  ot ..           
-00007320: 2074 616b 6520 696e 746f 2061 6363 6f75   take into accou
-00007330: 6e74 206f 6620 7468 6520 6f63 6375 7265  nt of the occure
-00007340: 6e63 6520 6f66 206f 7468 6572 2065 7869  nce of other exi
-00007350: 7374 696e 6720 6c61 6265 6c73 2e20 5468  sting labels. Th
-00007360: 6973 200d 0a20 2020 2020 2020 2020 2020  is ..           
-00007370: 2069 7320 7573 6566 756c 6c20 666f 7220   is usefull for 
-00007380: 756e 6261 6c61 6e63 6564 2063 6c61 7373  unbalanced class
-00007390: 206c 6162 656c 7320 696e 2027 6172 725f   labels in 'arr_
-000073a0: 6b27 0d0a 2020 2020 2020 2020 2d20 2773  k'..        - 's
-000073b0: 7472 6963 7427 2063 6f6d 7075 7465 7320  trict' computes 
-000073c0: 7468 6520 696d 706f 7274 616e 6365 206f  the importance o
-000073d0: 6620 7468 6520 6c61 6265 6c20 6279 2074  f the label by t
-000073e0: 6865 206e 756d 6265 7220 6f66 200d 0a20  he number of .. 
-000073f0: 2020 2020 2020 2020 2020 206f 6363 7572             occur
-00007400: 656e 6365 2069 6e20 7468 6520 7768 6f6c  ence in the whol
-00007410: 6520 7661 6c69 6420 2761 7272 5f6b 2720  e valid 'arr_k' 
-00007420: 692e 652e 2075 6e64 6572 2074 6865 2074  i.e. under the t
-00007430: 6f74 616c 206f 6620 0d0a 2020 2020 2020  otal of ..      
-00007440: 2020 2020 2020 6f63 6375 7265 6e63 6520        occurence 
-00007450: 6f66 2061 6c6c 2074 6865 206c 6162 656c  of all the label
-00007460: 7320 7468 6174 2065 7869 7374 2069 6e20  s that exist in 
-00007470: 7468 6520 7768 6f6c 6520 2761 7272 615f  the whole 'arra_
-00007480: 6171 272e 200d 0a20 2020 2020 2020 2020  aq'. ..         
-00007490: 2020 2054 6869 7320 6361 6e20 6769 7665     This can give
-000074a0: 2061 2073 7569 7461 626c 6520 616e 6179   a suitable anay
-000074b0: 6c73 6520 7265 7375 6c74 7320 6966 2074  lse results if t
-000074c0: 6865 2064 6174 6120 6973 206e 6f74 200d  he data is not .
-000074d0: 0a20 2020 2020 2020 2020 2020 2075 6e62  .            unb
-000074e0: 616c 616e 6365 6420 666f 7220 6561 6368  alanced for each
-000074f0: 206c 6162 656c 7320 696e 2027 6172 725f   labels in 'arr_
-00007500: 6b27 2e0d 0a20 2020 2020 2020 200d 0a20  k'...        .. 
-00007510: 2020 2052 6574 7572 6e73 200d 0a20 2020     Returns ..   
-00007520: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020   -----------..  
-00007530: 2020 6c61 6265 6c5f 6469 6374 5f67 726f    label_dict_gro
-00007540: 7570 5f72 6174 653a 2064 6963 742c 200d  up_rate: dict, .
-00007550: 0a20 2020 2020 2020 2044 6963 7469 6f6e  .        Diction
-00007560: 6e61 7279 206f 6620 7468 6520 6c61 6265  nary of the labe
-00007570: 6c20 616e 6420 6974 7320 2072 6174 6520  l and its  rate 
-00007580: 6f66 206f 6363 7572 656e 6365 2069 6e20  of occurence in 
-00007590: 7468 6520 6061 7272 5f61 7160 2e20 0d0a  the `arr_aq`. ..
-000075a0: 2020 2020 2020 2020 5468 7573 2065 6163          Thus eac
-000075b0: 6820 6772 6f75 7020 696e 2060 6172 725f  h group in `arr_
-000075c0: 6171 6020 6861 7320 6974 7320 7261 7465  aq` has its rate
-000075d0: 206f 6620 7265 7072 6573 656e 7461 7469   of representati
-000075e0: 7669 7479 206f 6620 7468 6520 0d0a 2020  vity of the ..  
-000075f0: 2020 2020 2020 6c61 6265 6c20 696e 2060        label in `
-00007600: 6172 725f 6b60 2e0d 0a20 2020 2020 2020  arr_k`...       
-00007610: 200d 0a20 2020 2045 7861 6d70 6c65 7320   ..    Examples 
-00007620: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
-00007630: 2d0d 0a20 2020 203e 3e3e 2066 726f 6d20  -..    >>> from 
-00007640: 7761 7465 782e 6461 7461 7365 7473 2069  watex.datasets i
-00007650: 6d70 6f72 7420 6c6f 6164 5f68 6c6f 6773  mport load_hlogs
-00007660: 0d0a 2020 2020 3e3e 3e20 6672 6f6d 2077  ..    >>> from w
-00007670: 6174 6578 2e75 7469 6c73 2e68 7964 726f  atex.utils.hydro
-00007680: 7574 696c 7320 696d 706f 7274 206c 6162  utils import lab
-00007690: 656c 5f69 6d70 6f72 7461 6e63 652c 2063  el_importance, c
-000076a0: 6c61 7373 6966 795f 6b20 0d0a 2020 2020  lassify_k ..    
-000076b0: 3e3e 3e20 6172 7261 795f 6b20 3d20 6c6f  >>> array_k = lo
-000076c0: 6164 5f68 6c6f 6773 2829 2e66 7261 6d65  ad_hlogs().frame
-000076d0: 2e6b 200d 0a20 2020 203e 3e3e 2023 2063  .k ..    >>> # c
-000076e0: 6174 6567 6f72 697a 6520 6b5f 6c61 6265  ategorize k_labe
-000076f0: 6c73 2075 7369 6e67 2064 6566 6175 6c74  ls using default
-00007700: 2063 6174 6567 6f72 697a 6174 696f 6e20   categorization 
-00007710: 0d0a 2020 2020 3e3e 3e20 6172 7261 795f  ..    >>> array_
-00007720: 6b20 3d20 636c 6173 7369 6679 5f6b 2028  k = classify_k (
-00007730: 6172 7261 795f 6b2c 2064 6566 6175 6c74  array_k, default
-00007740: 5f66 756e 6320 3d54 7275 6520 290d 0a20  _func =True ).. 
-00007750: 2020 203e 3e3e 2023 2066 6f72 2074 6865     >>> # for the
-00007760: 2064 656d 6f2c 2077 6520 7573 6564 2074   demo, we used t
-00007770: 6865 2067 726f 7570 206f 6620 6171 7569  he group of aqui
-00007780: 6665 7273 2068 6f77 6576 6572 2069 6e20  fers however in 
-00007790: 0d0a 2020 2020 3e3e 3e20 2320 7072 6174  ..    >>> # prat
-000077a0: 6963 652c 204e 4741 2073 686f 756c 6420  ice, NGA should 
-000077b0: 2062 6520 7072 6564 6963 6564 206c 6162   be prediced lab
-000077c0: 656c 7320 696e 7374 6561 642e 200d 0a20  els instead. .. 
-000077d0: 2020 203e 3e3e 2061 7272 6179 5f61 7120     >>> array_aq 
-000077e0: 3d20 6c6f 6164 5f68 6c6f 6773 2829 2e66  = load_hlogs().f
-000077f0: 7261 6d65 2e61 7175 6966 6572 5f67 726f  rame.aquifer_gro
-00007800: 7570 2020 0d0a 2020 2020 3e3e 3e20 2320  up  ..    >>> # 
-00007810: 6765 7420 7468 6520 6c61 6265 6c73 2065  get the labels e
-00007820: 7863 6570 7420 4e61 4e20 0d0a 2020 2020  xcept NaN ..    
-00007830: 3e3e 3e20 6e70 2e75 6e69 7175 6520 2861  >>> np.unique (a
-00007840: 7272 6179 5f6b 2920 2320 6769 7665 2074  rray_k) # give t
-00007850: 6865 206b 206c 6162 656c 2069 6e20 6461  he k label in da
-00007860: 7461 3b20 6865 7265 206f 6e6c 7920 6b3d  ta; here only k=
-00007870: 3220 6973 2061 7661 696c 6162 6c65 0d0a  2 is available..
-00007880: 2020 2020 6172 7261 7928 5b20 322e 2c20      array([ 2., 
-00007890: 6e61 6e5d 290d 0a20 2020 203e 3e3e 2023  nan])..    >>> #
-000078a0: 2063 6f6d 7075 7465 2074 6865 2072 6570   compute the rep
-000078b0: 7265 7365 6e74 6174 6976 6974 7920 6f66  resentativity of
-000078c0: 206c 6162 656c 203d 2732 2720 2820 666f   label ='2' ( fo
-000078d0: 7220 6b3d 3129 200d 0a20 2020 203e 3e3e  r k=1) ..    >>>
-000078e0: 206c 6162 656c 5f69 6d70 6f72 7461 6e63   label_importanc
-000078f0: 6528 6c61 6265 6c20 3d20 322c 2061 7272  e(label = 2, arr
-00007900: 5f6b 3d20 6172 7261 795f 6b2c 2061 7272  _k= array_k, arr
-00007910: 5f61 713d 2061 7272 6179 5f61 7120 290d  _aq= array_aq ).
-00007920: 0a20 2020 207b 2720 4949 2027 3a20 312e  .    {' II ': 1.
-00007930: 307d 0d0a 2020 2020 3e3e 3e20 2320 6c65  0}..    >>> # le
-00007940: 7420 7461 6b65 2074 6865 2065 7861 6d70  t take the examp
-00007950: 6c65 206f 6620 3131 2062 6f72 6568 6f6c  le of 11 borehol
-00007960: 6573 2c20 6e6f 7465 2074 6861 7420 7468  es, note that th
-00007970: 6520 2768 662e 6373 7627 0d0a 2020 2020  e 'hf.csv'..    
-00007980: 3e3e 3e20 2320 6461 7461 2075 7365 2066  >>> # data use f
-00007990: 6f72 2064 656d 6f20 6973 206e 6f74 2020  or demo is not  
-000079a0: 6e6f 7420 6176 6169 6261 6c65 2069 6e20  not avaibale in 
-000079b0: 7468 6520 7061 636b 6167 6520 666f 7220  the package for 
-000079c0: 636f 6e66 6964 656e 6379 200d 0a20 2020  confidency ..   
-000079d0: 203e 3e3e 2023 206a 7573 7420 7573 6520   >>> # just use 
-000079e0: 666f 7220 6465 6d6f 6e73 7472 6174 696f  for demonstratio
-000079f0: 6e20 0d0a 2020 2020 3e3e 3e20 6672 6f6d  n ..    >>> from
-00007a00: 2077 6174 6578 2e75 7469 6c73 2069 6d70   watex.utils imp
-00007a10: 6f72 7420 7265 6164 5f64 6174 6120 0d0a  ort read_data ..
-00007a20: 2020 2020 3e3e 3e20 6364 6174 6120 3d20      >>> cdata = 
-00007a30: 7265 6164 5f64 6174 6120 2827 6461 7461  read_data ('data
-00007a40: 2f62 6f72 6568 6f6c 6573 2f68 662e 6373  /boreholes/hf.cs
-00007a50: 7627 2920 0d0a 2020 2020 3e3e 3e20 6172  v') ..    >>> ar
-00007a60: 7261 795f 6b20 3d20 6364 6174 612e 6b20  ray_k = cdata.k 
-00007a70: 3b20 6172 7261 795f 6171 3d20 6364 6174  ; array_aq= cdat
-00007a80: 612e 6171 7569 6665 725f 6772 6f75 7020  a.aquifer_group 
-00007a90: 0d0a 2020 2020 3e3e 3e20 6e70 2e75 6e69  ..    >>> np.uni
-00007aa0: 7175 6520 2861 7272 6179 5f6b 2920 2320  que (array_k) # 
-00007ab0: 6769 7665 2074 6865 206c 6162 656c 7320  give the labels 
-00007ac0: 696e 206b 0d0a 2020 2020 6172 7261 7928  in k..    array(
-00007ad0: 5b20 312e 2c20 2032 2e2c 2020 332e 2c20  [ 1.,  2.,  3., 
-00007ae0: 6e61 6e5d 290d 0a20 2020 203e 3e3e 2061  nan])..    >>> a
-00007af0: 7272 6179 5f6b 203d 2063 6c61 7373 6966  rray_k = classif
-00007b00: 795f 6b28 6172 7261 795f 6b2c 2064 6566  y_k(array_k, def
-00007b10: 6175 6c74 5f66 756e 6320 3d54 7275 6529  ault_func =True)
-00007b20: 0d0a 2020 2020 3e3e 3e20 2320 7769 6c6c  ..    >>> # will
-00007b30: 2063 6f6d 7075 7465 2074 6865 2072 6570   compute the rep
-00007b40: 7265 7365 6e74 6174 6976 6974 7920 6f66  resentativity of
-00007b50: 2065 6163 6820 6c61 6265 6c20 2075 7369   each label  usi
-00007b60: 6e67 2074 6865 200d 0a20 2020 203e 3e3e  ng the ..    >>>
-00007b70: 2023 2074 6865 206d 6574 686f 6420 2773   # the method 's
-00007b80: 7472 6963 7427 0d0a 2020 2020 3e3e 3e20  trict'..    >>> 
-00007b90: 666f 7220 6c61 6265 6c20 696e 205b 312c  for label in [1,
-00007ba0: 2032 2c20 335d 3a20 0d0a 2020 2020 2020   2, 3]: ..      
-00007bb0: 2020 2020 2020 723d 6c61 6265 6c5f 696d        r=label_im
-00007bc0: 706f 7274 616e 6365 286c 6162 656c 202c  portance(label ,
-00007bd0: 2061 7272 6179 5f6b 2c20 6172 7261 795f   array_k, array_
-00007be0: 6171 202c 200d 0a20 2020 2020 2020 2020  aq , ..         
+00006da0: 2028 2752 6570 7265 7365 6e74 6174 6976   ('Representativ
+00006db0: 6974 7927 2c20 2820 276d 7564 7374 6f6e  ity', ( 'mudston
+00006dc0: 6527 2c20 302e 3234 2929 2c0d 0a20 2020  e', 0.24)),..   
+00006dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006de0: 2020 2020 2020 2020 2028 2753 696d 696c           ('Simil
+00006df0: 6172 6974 7927 2c20 276d 7564 7374 6f6e  arity', 'mudston
+00006e00: 6527 295d 295d 2c0d 0a20 2020 2020 2020  e')])],..       
+00006e10: 2020 2020 2020 290d 0a22 2222 2e66 6f72        )..""".for
+00006e20: 6d61 7428 7061 7261 6d73 3d5f 7061 7261  mat(params=_para
+00006e30: 6d5f 646f 6373 0d0a 290d 0a20 2020 200d  m_docs..)..    .
+00006e40: 0a64 6566 206c 6162 656c 5f69 6d70 6f72  .def label_impor
+00006e50: 7461 6e63 6520 280d 0a20 2020 206c 6162  tance (..    lab
+00006e60: 656c 3a20 696e 742c 200d 0a20 2020 2061  el: int, ..    a
+00006e70: 7272 5f6b 3a20 4172 7261 794c 696b 6520  rr_k: ArrayLike 
+00006e80: 2c20 0d0a 2020 2020 6172 725f 6171 3a41  , ..    arr_aq:A
+00006e90: 7272 6179 4c69 6b65 2c20 0d0a 2020 2020  rrayLike, ..    
+00006ea0: 2a2c 200d 0a20 2020 206d 6574 686f 643a  *, ..    method:
+00006eb0: 7374 723d 276e 6169 7665 2720 0d0a 2020  str='naive' ..  
+00006ec0: 2020 292d 3e64 6963 743a 0d0a 2020 2020    )->dict:..    
+00006ed0: 2222 2243 6f6d 7075 7465 2074 6865 2073  """Compute the s
+00006ee0: 636f 7265 2066 6f72 2074 6865 206c 6162  core for the lab
+00006ef0: 656c 2061 6e64 2069 7473 2072 6570 7265  el and its repre
+00006f00: 7365 6e74 6174 6976 6974 7920 696e 2074  sentativity in t
+00006f10: 6865 2076 616c 6964 200d 0a20 2020 2061  he valid ..    a
+00006f20: 7272 6179 2027 6172 725f 6b27 200d 0a20  rray 'arr_k' .. 
+00006f30: 2020 200d 0a20 2020 2050 6172 616d 6574     ..    Paramet
+00006f40: 6572 7320 0d0a 2020 2020 2d2d 2d2d 2d2d  ers ..    ------
+00006f50: 2d2d 2d2d 2d2d 2d0d 0a20 2020 206c 6162  -------..    lab
+00006f60: 656c 3a20 696e 742c 206f 7220 7374 7269  el: int, or stri
+00006f70: 6e67 2020 0d0a 2020 2020 2020 2020 636c  ng  ..        cl
+00006f80: 6173 7320 6c61 6265 6c20 6672 6f6d 2074  ass label from t
+00006f90: 6865 2074 7275 6520 6c61 6265 6c73 2061  he true labels a
+00006fa0: 7272 6179 206f 6620 2070 6572 6d65 6162  rray of  permeab
+00006fb0: 696c 6974 7920 636f 6566 6669 6369 656e  ility coefficien
+00006fc0: 7420 276b 272e 0d0a 2020 2020 2020 2020  t 'k'...        
+00006fd0: 4966 2073 7472 696e 672c 2062 6520 7375  If string, be su
+00006fe0: 7265 2074 6f20 636f 6e76 6572 7420 7468  re to convert th
+00006ff0: 6520 6172 7261 7920 746f 2068 6f6c 6420  e array to hold 
+00007000: 7468 6520 6474 7970 6520 7374 722e 2049  the dtype str. I
+00007010: 7420 6973 200d 0a20 2020 2020 2020 2072  t is ..        r
+00007020: 6563 6f6d 6d6e 656e 6465 6420 746f 2070  ecommnended to p
+00007030: 726f 7669 6465 2064 6174 6120 7769 7468  rovide data with
+00007040: 206e 6f20 4e61 4e20 746f 2068 6176 6520   no NaN to have 
+00007050: 6675 6c6c 2063 6f6e 7472 6f6c 2074 6865  full control the
+00007060: 200d 0a20 2020 2020 2020 206f 6363 7572   ..        occur
+00007070: 656e 6365 2072 6573 756c 7473 2e20 0d0a  ence results. ..
+00007080: 0d0a 2020 2020 6172 725f 6b3a 2061 7272  ..    arr_k: arr
+00007090: 6179 2d6c 696b 6520 3164 200d 0a20 2020  ay-like 1d ..   
+000070a0: 2020 2020 2054 7275 6520 6c61 6265 6c73       True labels
+000070b0: 206f 6620 6172 7261 7920 636f 6e74 6169   of array contai
+000070c0: 6e69 6e67 2074 6865 2070 6572 6d65 6162  ning the permeab
+000070d0: 696c 6974 7920 636f 6566 6669 6369 656e  ility coefficien
+000070e0: 7420 276b 272e 0d0a 0d0a 2020 2020 6172  t 'k'.....    ar
+000070f0: 725f 6171 3a20 6172 7261 795f 6c69 6b65  r_aq: array_like
+00007100: 2031 6420 0d0a 2020 2020 2020 2020 5472   1d ..        Tr
+00007110: 7565 206c 6162 656c 7320 6f66 2074 6865  ue labels of the
+00007120: 2067 726f 7570 7320 6f66 2061 7175 6966   groups of aquif
+00007130: 6572 7320 6f72 2070 7265 6469 6374 6564  ers or predicted
+00007140: 206e 6169 7665 2067 726f 7570 206f 6620   naive group of 
+00007150: 0d0a 2020 2020 2020 2020 2061 7175 6966  ..         aquif
+00007160: 6572 2028 4e47 4120 6c61 6265 6c73 292e  er (NGA labels).
+00007170: 2053 6565 203a 6675 6e63 3a60 7e2e 7072   See :func:`~.pr
+00007180: 6564 6963 745f 4e47 415f 6c61 6265 6c73  edict_NGA_labels
+00007190: 602e 0d0a 2020 2020 2020 2020 200d 0a20  `...         .. 
+000071a0: 2020 206d 6574 686f 643a 2073 7472 205b     method: str [
+000071b0: 276e 6169 7665 272c 2027 7374 7269 6374  'naive', 'strict
+000071c0: 275d 2c20 6465 6661 756c 743d 276e 6169  '], default='nai
+000071d0: 7665 270d 0a20 2020 2020 2020 2054 6865  ve'..        The
+000071e0: 206b 696e 6420 6f66 2073 7472 6174 6567   kind of strateg
+000071f0: 7920 746f 2063 6f6d 7075 7465 2074 6865  y to compute the
+00007200: 2072 6570 7265 7365 6e74 6174 6976 6974   representativit
+00007210: 7920 6f66 2061 206c 6162 656c 200d 0a20  y of a label .. 
+00007220: 2020 2020 2020 2069 6e20 7468 6520 7072         in the pr
+00007230: 6564 6963 7465 6420 6172 7261 7920 2761  edicted array 'a
+00007240: 7272 6179 5f61 7127 2e20 4974 2063 616e  rray_aq'. It can
+00007250: 2061 6c73 6f20 6265 2027 7374 7269 6374   also be 'strict
+00007260: 272e 2049 6e64 6565 643a 0d0a 2020 2020  '. Indeed:..    
+00007270: 2020 2020 0d0a 2020 2020 2020 2020 2d20      ..        - 
+00007280: 276e 6169 7665 2720 636f 6d70 7574 6573  'naive' computes
+00007290: 2074 6865 2069 6d70 6f72 7461 6e63 6520   the importance 
+000072a0: 6f66 2074 6865 206c 6162 656c 2062 7920  of the label by 
+000072b0: 7468 6520 6e75 6d62 6572 206f 6620 6974  the number of it
+000072c0: 730d 0a20 2020 2020 2020 2020 2020 206f  s..            o
+000072d0: 6363 7572 656e 6365 2066 6f72 2074 6869  ccurence for thi
+000072e0: 7320 7370 6563 6966 6963 206c 6162 656c  s specific label
+000072f0: 2069 6e20 7468 6520 6172 7261 7920 276b   in the array 'k
+00007300: 272e 2049 7420 646f 6573 206e 6f74 200d  '. It does not .
+00007310: 0a20 2020 2020 2020 2020 2020 2074 616b  .            tak
+00007320: 6520 696e 746f 2061 6363 6f75 6e74 206f  e into account o
+00007330: 6620 7468 6520 6f63 6375 7265 6e63 6520  f the occurence 
+00007340: 6f66 206f 7468 6572 2065 7869 7374 696e  of other existin
+00007350: 6720 6c61 6265 6c73 2e20 5468 6973 200d  g labels. This .
+00007360: 0a20 2020 2020 2020 2020 2020 2069 7320  .            is 
+00007370: 7573 6566 756c 6c20 666f 7220 756e 6261  usefull for unba
+00007380: 6c61 6e63 6564 2063 6c61 7373 206c 6162  lanced class lab
+00007390: 656c 7320 696e 2027 6172 725f 6b27 0d0a  els in 'arr_k'..
+000073a0: 2020 2020 2020 2020 2d20 2773 7472 6963          - 'stric
+000073b0: 7427 2063 6f6d 7075 7465 7320 7468 6520  t' computes the 
+000073c0: 696d 706f 7274 616e 6365 206f 6620 7468  importance of th
+000073d0: 6520 6c61 6265 6c20 6279 2074 6865 206e  e label by the n
+000073e0: 756d 6265 7220 6f66 200d 0a20 2020 2020  umber of ..     
+000073f0: 2020 2020 2020 206f 6363 7572 656e 6365         occurence
+00007400: 2069 6e20 7468 6520 7768 6f6c 6520 7661   in the whole va
+00007410: 6c69 6420 2761 7272 5f6b 2720 692e 652e  lid 'arr_k' i.e.
+00007420: 2075 6e64 6572 2074 6865 2074 6f74 616c   under the total
+00007430: 206f 6620 0d0a 2020 2020 2020 2020 2020   of ..          
+00007440: 2020 6f63 6375 7265 6e63 6520 6f66 2061    occurence of a
+00007450: 6c6c 2074 6865 206c 6162 656c 7320 7468  ll the labels th
+00007460: 6174 2065 7869 7374 2069 6e20 7468 6520  at exist in the 
+00007470: 7768 6f6c 6520 2761 7272 615f 6171 272e  whole 'arra_aq'.
+00007480: 200d 0a20 2020 2020 2020 2020 2020 2054   ..            T
+00007490: 6869 7320 6361 6e20 6769 7665 2061 2073  his can give a s
+000074a0: 7569 7461 626c 6520 616e 6179 6c73 6520  uitable anaylse 
+000074b0: 7265 7375 6c74 7320 6966 2074 6865 2064  results if the d
+000074c0: 6174 6120 6973 206e 6f74 200d 0a20 2020  ata is not ..   
+000074d0: 2020 2020 2020 2020 2075 6e62 616c 616e           unbalan
+000074e0: 6365 6420 666f 7220 6561 6368 206c 6162  ced for each lab
+000074f0: 656c 7320 696e 2027 6172 725f 6b27 2e0d  els in 'arr_k'..
+00007500: 0a20 2020 2020 2020 200d 0a20 2020 2052  .        ..    R
+00007510: 6574 7572 6e73 200d 0a20 2020 202d 2d2d  eturns ..    ---
+00007520: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 6c61  --------..    la
+00007530: 6265 6c5f 6469 6374 5f67 726f 7570 5f72  bel_dict_group_r
+00007540: 6174 653a 2064 6963 742c 200d 0a20 2020  ate: dict, ..   
+00007550: 2020 2020 2044 6963 7469 6f6e 6e61 7279       Dictionnary
+00007560: 206f 6620 7468 6520 6c61 6265 6c20 616e   of the label an
+00007570: 6420 6974 7320 2072 6174 6520 6f66 206f  d its  rate of o
+00007580: 6363 7572 656e 6365 2069 6e20 7468 6520  ccurence in the 
+00007590: 6061 7272 5f61 7160 2e20 0d0a 2020 2020  `arr_aq`. ..    
+000075a0: 2020 2020 5468 7573 2065 6163 6820 6772      Thus each gr
+000075b0: 6f75 7020 696e 2060 6172 725f 6171 6020  oup in `arr_aq` 
+000075c0: 6861 7320 6974 7320 7261 7465 206f 6620  has its rate of 
+000075d0: 7265 7072 6573 656e 7461 7469 7669 7479  representativity
+000075e0: 206f 6620 7468 6520 0d0a 2020 2020 2020   of the ..      
+000075f0: 2020 6c61 6265 6c20 696e 2060 6172 725f    label in `arr_
+00007600: 6b60 2e0d 0a20 2020 2020 2020 200d 0a20  k`...        .. 
+00007610: 2020 2045 7861 6d70 6c65 7320 0d0a 2020     Examples ..  
+00007620: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20    -----------.. 
+00007630: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
+00007640: 782e 6461 7461 7365 7473 2069 6d70 6f72  x.datasets impor
+00007650: 7420 6c6f 6164 5f68 6c6f 6773 0d0a 2020  t load_hlogs..  
+00007660: 2020 3e3e 3e20 6672 6f6d 2077 6174 6578    >>> from watex
+00007670: 2e75 7469 6c73 2e68 7964 726f 7574 696c  .utils.hydroutil
+00007680: 7320 696d 706f 7274 206c 6162 656c 5f69  s import label_i
+00007690: 6d70 6f72 7461 6e63 652c 2063 6c61 7373  mportance, class
+000076a0: 6966 795f 6b20 0d0a 2020 2020 3e3e 3e20  ify_k ..    >>> 
+000076b0: 6172 7261 795f 6b20 3d20 6c6f 6164 5f68  array_k = load_h
+000076c0: 6c6f 6773 2829 2e66 7261 6d65 2e6b 200d  logs().frame.k .
+000076d0: 0a20 2020 203e 3e3e 2023 2063 6174 6567  .    >>> # categ
+000076e0: 6f72 697a 6520 6b5f 6c61 6265 6c73 2075  orize k_labels u
+000076f0: 7369 6e67 2064 6566 6175 6c74 2063 6174  sing default cat
+00007700: 6567 6f72 697a 6174 696f 6e20 0d0a 2020  egorization ..  
+00007710: 2020 3e3e 3e20 6172 7261 795f 6b20 3d20    >>> array_k = 
+00007720: 636c 6173 7369 6679 5f6b 2028 6172 7261  classify_k (arra
+00007730: 795f 6b2c 2064 6566 6175 6c74 5f66 756e  y_k, default_fun
+00007740: 6320 3d54 7275 6520 290d 0a20 2020 203e  c =True )..    >
+00007750: 3e3e 2023 2066 6f72 2074 6865 2064 656d  >> # for the dem
+00007760: 6f2c 2077 6520 7573 6564 2074 6865 2067  o, we used the g
+00007770: 726f 7570 206f 6620 6171 7569 6665 7273  roup of aquifers
+00007780: 2068 6f77 6576 6572 2069 6e20 0d0a 2020   however in ..  
+00007790: 2020 3e3e 3e20 2320 7072 6174 6963 652c    >>> # pratice,
+000077a0: 204e 4741 2073 686f 756c 6420 2062 6520   NGA should  be 
+000077b0: 7072 6564 6963 6564 206c 6162 656c 7320  prediced labels 
+000077c0: 696e 7374 6561 642e 200d 0a20 2020 203e  instead. ..    >
+000077d0: 3e3e 2061 7272 6179 5f61 7120 3d20 6c6f  >> array_aq = lo
+000077e0: 6164 5f68 6c6f 6773 2829 2e66 7261 6d65  ad_hlogs().frame
+000077f0: 2e61 7175 6966 6572 5f67 726f 7570 2020  .aquifer_group  
+00007800: 0d0a 2020 2020 3e3e 3e20 2320 6765 7420  ..    >>> # get 
+00007810: 7468 6520 6c61 6265 6c73 2065 7863 6570  the labels excep
+00007820: 7420 4e61 4e20 0d0a 2020 2020 3e3e 3e20  t NaN ..    >>> 
+00007830: 6e70 2e75 6e69 7175 6520 2861 7272 6179  np.unique (array
+00007840: 5f6b 2920 2320 6769 7665 2074 6865 206b  _k) # give the k
+00007850: 206c 6162 656c 2069 6e20 6461 7461 3b20   label in data; 
+00007860: 6865 7265 206f 6e6c 7920 6b3d 3220 6973  here only k=2 is
+00007870: 2061 7661 696c 6162 6c65 0d0a 2020 2020   available..    
+00007880: 6172 7261 7928 5b20 322e 2c20 6e61 6e5d  array([ 2., nan]
+00007890: 290d 0a20 2020 203e 3e3e 2023 2063 6f6d  )..    >>> # com
+000078a0: 7075 7465 2074 6865 2072 6570 7265 7365  pute the represe
+000078b0: 6e74 6174 6976 6974 7920 6f66 206c 6162  ntativity of lab
+000078c0: 656c 203d 2732 2720 2820 666f 7220 6b3d  el ='2' ( for k=
+000078d0: 3129 200d 0a20 2020 203e 3e3e 206c 6162  1) ..    >>> lab
+000078e0: 656c 5f69 6d70 6f72 7461 6e63 6528 6c61  el_importance(la
+000078f0: 6265 6c20 3d20 322c 2061 7272 5f6b 3d20  bel = 2, arr_k= 
+00007900: 6172 7261 795f 6b2c 2061 7272 5f61 713d  array_k, arr_aq=
+00007910: 2061 7272 6179 5f61 7120 290d 0a20 2020   array_aq )..   
+00007920: 207b 2720 4949 2027 3a20 312e 307d 0d0a   {' II ': 1.0}..
+00007930: 2020 2020 3e3e 3e20 2320 6c65 7420 7461      >>> # let ta
+00007940: 6b65 2074 6865 2065 7861 6d70 6c65 206f  ke the example o
+00007950: 6620 3131 2062 6f72 6568 6f6c 6573 2c20  f 11 boreholes, 
+00007960: 6e6f 7465 2074 6861 7420 7468 6520 2768  note that the 'h
+00007970: 662e 6373 7627 0d0a 2020 2020 3e3e 3e20  f.csv'..    >>> 
+00007980: 2320 6461 7461 2075 7365 2066 6f72 2064  # data use for d
+00007990: 656d 6f20 6973 206e 6f74 2020 6e6f 7420  emo is not  not 
+000079a0: 6176 6169 6261 6c65 2069 6e20 7468 6520  avaibale in the 
+000079b0: 7061 636b 6167 6520 666f 7220 636f 6e66  package for conf
+000079c0: 6964 656e 6379 200d 0a20 2020 203e 3e3e  idency ..    >>>
+000079d0: 2023 206a 7573 7420 7573 6520 666f 7220   # just use for 
+000079e0: 6465 6d6f 6e73 7472 6174 696f 6e20 0d0a  demonstration ..
+000079f0: 2020 2020 3e3e 3e20 6672 6f6d 2077 6174      >>> from wat
+00007a00: 6578 2e75 7469 6c73 2069 6d70 6f72 7420  ex.utils import 
+00007a10: 7265 6164 5f64 6174 6120 0d0a 2020 2020  read_data ..    
+00007a20: 3e3e 3e20 6364 6174 6120 3d20 7265 6164  >>> cdata = read
+00007a30: 5f64 6174 6120 2827 6461 7461 2f62 6f72  _data ('data/bor
+00007a40: 6568 6f6c 6573 2f68 662e 6373 7627 2920  eholes/hf.csv') 
+00007a50: 0d0a 2020 2020 3e3e 3e20 6172 7261 795f  ..    >>> array_
+00007a60: 6b20 3d20 6364 6174 612e 6b20 3b20 6172  k = cdata.k ; ar
+00007a70: 7261 795f 6171 3d20 6364 6174 612e 6171  ray_aq= cdata.aq
+00007a80: 7569 6665 725f 6772 6f75 7020 0d0a 2020  uifer_group ..  
+00007a90: 2020 3e3e 3e20 6e70 2e75 6e69 7175 6520    >>> np.unique 
+00007aa0: 2861 7272 6179 5f6b 2920 2320 6769 7665  (array_k) # give
+00007ab0: 2074 6865 206c 6162 656c 7320 696e 206b   the labels in k
+00007ac0: 0d0a 2020 2020 6172 7261 7928 5b20 312e  ..    array([ 1.
+00007ad0: 2c20 2032 2e2c 2020 332e 2c20 6e61 6e5d  ,  2.,  3., nan]
+00007ae0: 290d 0a20 2020 203e 3e3e 2061 7272 6179  )..    >>> array
+00007af0: 5f6b 203d 2063 6c61 7373 6966 795f 6b28  _k = classify_k(
+00007b00: 6172 7261 795f 6b2c 2064 6566 6175 6c74  array_k, default
+00007b10: 5f66 756e 6320 3d54 7275 6529 0d0a 2020  _func =True)..  
+00007b20: 2020 3e3e 3e20 2320 7769 6c6c 2063 6f6d    >>> # will com
+00007b30: 7075 7465 2074 6865 2072 6570 7265 7365  pute the represe
+00007b40: 6e74 6174 6976 6974 7920 6f66 2065 6163  ntativity of eac
+00007b50: 6820 6c61 6265 6c20 2075 7369 6e67 2074  h label  using t
+00007b60: 6865 200d 0a20 2020 203e 3e3e 2023 2074  he ..    >>> # t
+00007b70: 6865 206d 6574 686f 6420 2773 7472 6963  he method 'stric
+00007b80: 7427 0d0a 2020 2020 3e3e 3e20 666f 7220  t'..    >>> for 
+00007b90: 6c61 6265 6c20 696e 205b 312c 2032 2c20  label in [1, 2, 
+00007ba0: 335d 3a20 0d0a 2020 2020 2020 2020 2020  3]: ..          
+00007bb0: 2020 723d 6c61 6265 6c5f 696d 706f 7274    r=label_import
+00007bc0: 616e 6365 286c 6162 656c 202c 2061 7272  ance(label , arr
+00007bd0: 6179 5f6b 2c20 6172 7261 795f 6171 202c  ay_k, array_aq ,
+00007be0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
 00007bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007c00: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-00007c10: 7468 6f64 203d 2773 7472 6963 7427 2920  thod ='strict') 
-00007c20: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-00007c30: 696e 7428 226c 6162 656c 206b 203d 222c  int("label k =",
-00007c40: 206c 6162 656c 2c20 273a 5c6e 2720 2c20   label, ':\n' , 
-00007c50: 7229 0d0a 2020 2020 6c61 6265 6c20 6b20  r)..    label k 
-00007c60: 3d20 3120 3a0d 0a20 2020 2020 7b27 5627  = 1 :..     {'V'
-00007c70: 3a20 302e 3137 2c20 2749 5627 3a20 302e  : 0.17, 'IV': 0.
-00007c80: 3134 312c 2027 4949 273a 2030 2e31 3236  141, 'II': 0.126
-00007c90: 2c20 2749 4949 273a 2030 2e30 3834 2c20  , 'III': 0.084, 
-00007ca0: 2749 5626 5627 3a20 302e 3030 352c 200d  'IV&V': 0.005, .
-00007cb0: 0a20 2020 2020 2027 4949 2649 4949 273a  .      'II&III':
-00007cc0: 2030 2e30 3033 2c20 2749 4949 2649 5627   0.003, 'III&IV'
-00007cd0: 3a20 302e 3030 337d 0d0a 2020 2020 6c61  : 0.003}..    la
-00007ce0: 6265 6c20 6b20 3d20 3220 3a0d 0a20 2020  bel k = 2 :..   
-00007cf0: 2020 7b27 4949 4927 3a20 302e 3035 322c    {'III': 0.052,
-00007d00: 2027 4949 273a 2030 2e30 352c 2027 5627   'II': 0.05, 'V'
-00007d10: 3a20 302e 3035 2c20 2749 5627 3a20 302e  : 0.05, 'IV': 0.
-00007d20: 3033 342c 2027 4949 4926 4956 273a 2030  034, 'III&IV': 0
-00007d30: 2e30 3035 7d0d 0a20 2020 206c 6162 656c  .005}..    label
-00007d40: 206b 203d 2033 203a 0d0a 2020 2020 207b   k = 3 :..     {
-00007d50: 2756 273a 2030 2e31 3233 2c20 2749 5627  'V': 0.123, 'IV'
-00007d60: 3a20 302e 3038 362c 2027 4949 4927 3a20  : 0.086, 'III': 
-00007d70: 302e 3036 387d 0d0a 2020 2020 3e3e 3e20  0.068}..    >>> 
-00007d80: 2320 2a2a 636f 6d6d 656e 7473 3a20 0d0a  # **comments: ..
-00007d90: 2020 2020 2020 2020 2320 6c61 6265 6c20          # label 
-00007da0: 6b3d 3120 6973 2031 3725 2069 6d70 6f72  k=1 is 17% impor
-00007db0: 7461 6e63 6520 666f 7220 6772 6f75 7020  tance for group 
-00007dc0: 562c 2031 322e 3325 2066 6f72 2067 726f  V, 12.3% for gro
-00007dd0: 7570 2049 4920 7768 6572 6561 730d 0a20  up II whereas.. 
-00007de0: 2020 2020 2020 2023 206c 6162 656c 206b         # label k
-00007df0: 3d32 2068 6173 2061 2077 6561 6b20 7261  =2 has a weak ra
-00007e00: 7465 2069 6e20 7468 6520 7768 6f6c 6520  te in the whole 
-00007e10: 6461 7461 7365 7420 7e3d 302e 3139 2520  dataset ~=0.19% 
-00007e20: 666f 7220 616c 6c20 6772 6f75 7073 0d0a  for all groups..
-00007e30: 2020 2020 2020 2020 2320 7468 6520 6d6f          # the mo
-00007e40: 7374 2064 6f6d 696e 6174 6520 6c61 6265  st dominate labe
-00007e50: 6c73 2061 7265 206b 3d31 2061 6e64 206b  ls are k=1 and k
-00007e60: 3d33 2077 6974 6820 3533 2e31 3425 2061  =3 with 53.14% a
-00007e70: 6e64 2032 372e 3734 2025 200d 0a20 2020  nd 27.74 % ..   
-00007e80: 2020 2020 2023 2072 6573 7065 6374 6976       # respectiv
-00007e90: 656c 7920 696e 2074 6865 2064 6174 6173  ely in the datas
-00007ea0: 6574 2e20 0d0a 2020 2020 2020 2020 2320  et. ..        # 
-00007eb0: 4966 2074 6872 6573 686f 6c64 206f 6620  If threshold of 
-00007ec0: 7265 7072 6573 656e 7461 7469 7669 7479  representativity
-00007ed0: 2069 7320 7365 7420 746f 2035 3025 202c   is set to 50% ,
-00007ee0: 206e 6f6e 6520 6f66 2074 6865 2074 7275   none of the tru
-00007ef0: 6520 0d0a 2020 2020 2020 2020 2320 6c61  e ..        # la
-00007f00: 6265 6c20 6b20 7769 6c6c 2066 6974 2061  bel k will fit a
-00007f10: 6e79 2061 7175 6966 6572 2067 726f 7570  ny aquifer group
-00007f20: 2073 696e 6365 2074 6865 206d 6178 2072   since the max r
-00007f30: 6570 7265 7365 6e74 6174 6976 6974 7920  epresentativity 
-00007f40: 0d0a 2020 2020 2020 2020 2320 7363 6f72  ..        # scor
-00007f50: 6520 6973 2031 3725 2061 6e64 2069 7320  e is 17% and is 
-00007f60: 666f 7220 7468 6520 6772 6f75 7020 5620  for the group V 
-00007f70: 6573 7065 6369 616c 6c79 2066 6f72 206b  especially for k
-00007f80: 3d31 2e20 0d0a 2020 2020 2222 2220 0d0a  =1. ..    """ ..
-00007f90: 2020 2020 6172 725f 6b20 3d20 6368 6563      arr_k = chec
-00007fa0: 6b5f 7920 280d 0a20 2020 2020 2020 2061  k_y (..        a
-00007fb0: 7272 5f6b 2c20 0d0a 2020 2020 2020 2020  rr_k, ..        
-00007fc0: 616c 6c6f 775f 6e61 6e3d 5472 7565 202c  allow_nan=True ,
-00007fd0: 200d 0a20 2020 2020 2020 2069 6e70 7574   ..        input
-00007fe0: 5f6e 616d 653d 2241 7272 6179 2027 6172  _name="Array 'ar
-00007ff0: 725f 6b27 222c 0d0a 2020 2020 2020 2020  r_k'",..        
-00008000: 2920 200d 0a20 2020 2061 7272 5f61 7120  )  ..    arr_aq 
-00008010: 3d20 6368 6563 6b5f 7928 0d0a 2020 2020  = check_y(..    
-00008020: 2020 2020 6172 725f 6171 2c20 0d0a 2020      arr_aq, ..  
-00008030: 2020 2020 2020 696e 7075 745f 6e61 6d65        input_name
-00008040: 3d22 4172 7261 7920 2761 7272 5f61 7127  ="Array 'arr_aq'
-00008050: 222c 200d 0a20 2020 2020 2020 2029 0d0a  ", ..        )..
-00008060: 2020 2020 0d0a 2020 2020 5f63 6865 636b      ..    _check
-00008070: 5f63 6f6e 7369 7374 656e 6379 5f73 697a  _consistency_siz
-00008080: 6528 6172 725f 6b2c 2061 7272 5f61 7129  e(arr_k, arr_aq)
-00008090: 0d0a 0d0a 2020 2020 6173 7365 7274 2073  ....    assert s
-000080a0: 7472 286d 6574 686f 6429 2e6c 6f77 6572  tr(method).lower
-000080b0: 2829 2e73 7472 6970 2829 2020 696e 207b  ().strip()  in {
-000080c0: 226e 6169 7665 222c 2022 7374 7269 6374  "naive", "strict
-000080d0: 227d 2c20 280d 0a20 2020 2020 2020 2066  "}, (..        f
-000080e0: 2253 7570 706f 7274 7320 6f6e 6c79 2027  "Supports only '
-000080f0: 6e61 6976 6527 206f 7220 2773 7472 6963  naive' or 'stric
-00008100: 7427 2e20 476f 7420 7b6d 6574 686f 6421  t'. Got {method!
-00008110: 727d 2229 0d0a 2020 2020 6d65 7468 6f64  r}")..    method
-00008120: 203d 7374 7228 6d65 7468 6f64 292e 6c6f   =str(method).lo
-00008130: 7765 7228 292e 7374 7269 7028 2920 0d0a  wer().strip() ..
-00008140: 2020 2020 2320 6966 204e 614e 2065 7869      # if NaN exi
-00008150: 7374 7320 6765 7420 7468 6520 6e6f 6e5f  sts get the non_
-00008160: 7661 6c69 6420 6b20 0d0a 2020 2020 6966  valid k ..    if
-00008170: 206e 702e 6973 6e61 6e28 6172 725f 6b29   np.isnan(arr_k)
-00008180: 2e61 6e79 2829 203a 200d 0a20 2020 2020  .any() : ..     
-00008190: 2020 206e 6f74 5f6e 616e 5f69 6e64 6963     not_nan_indic
-000081a0: 6573 202c 203d 206e 702e 7768 6572 6520  es , = np.where 
-000081b0: 287e 6e70 2e69 736e 616e 2861 7272 5f6b  (~np.isnan(arr_k
-000081c0: 2929 0d0a 2020 2020 2020 2020 6172 725f  ))..        arr_
-000081d0: 6171 203d 2061 7272 5f61 715b 6e6f 745f  aq = arr_aq[not_
-000081e0: 6e61 6e5f 696e 6469 6365 735d 200d 0a20  nan_indices] .. 
-000081f0: 2020 2020 2020 2061 7272 5f6b 203d 2061         arr_k = a
-00008200: 7272 5f6b 205b 6e6f 745f 6e61 6e5f 696e  rr_k [not_nan_in
-00008210: 6469 6365 735d 200d 0a20 2020 2020 2020  dices] ..       
-00008220: 200d 0a20 2020 2069 6620 6e6f 7420 5f69   ..    if not _i
-00008230: 735f 6e75 6d65 7269 635f 6474 7970 6528  s_numeric_dtype(
-00008240: 6172 725f 6b29 3a0d 0a20 2020 2020 2020  arr_k):..       
-00008250: 2023 2074 6865 7265 666f 7265 2063 6f6e   # therefore con
-00008260: 7665 7274 2061 7272 6179 5f61 7120 746f  vert array_aq to
-00008270: 6f20 746f 2064 7479 7065 2073 7472 696e  o to dtype strin
-00008280: 6720 0d0a 2020 2020 2020 2020 6172 725f  g ..        arr_
-00008290: 6171 203d 2074 6f5f 6474 7970 655f 7374  aq = to_dtype_st
-000082a0: 7228 2061 7272 5f61 7120 2c20 7265 7475  r( arr_aq , retu
-000082b0: 726e 5f76 616c 7565 733d 2054 7275 6520  rn_values= True 
-000082c0: 2920 0d0a 2020 2020 2020 2020 6c61 6265  ) ..        labe
-000082d0: 6c20 3d73 7472 2028 6c61 6265 6c29 2023  l =str (label) #
-000082e0: 2066 6f72 2063 6f6e 7369 7374 656e 6379   for consistency
-000082f0: 200d 0a20 2020 2020 2020 2023 2074 6869   ..        # thi
-00008300: 7320 6973 2075 7365 6675 6c6c 2077 6865  s is usefull whe
-00008310: 6e20 7573 696e 6720 6e70 2e75 6e69 7175  n using np.uniqu
-00008320: 6520 7369 6e63 6520 0d0a 2020 2020 2020  e since ..      
-00008330: 2020 2320 6e75 6d65 7269 6320 6461 7461    # numeric data
-00008340: 2063 616e 6e6f 7420 6265 2063 6f65 7263   cannot be coerc
-00008350: 6564 2020 7769 7468 2073 7472 696e 6720  ed  with string 
-00008360: 6474 7970 6520 0d0a 2020 2020 6966 206c  dtype ..    if l
-00008370: 6162 656c 206e 6f74 2069 6e20 286e 702e  abel not in (np.
-00008380: 756e 6971 7565 2028 6172 725f 6b29 293a  unique (arr_k)):
-00008390: 200d 0a20 2020 2020 2020 2072 6169 7365   ..        raise
-000083a0: 2056 616c 7565 4572 726f 7220 2866 224d   ValueError (f"M
-000083b0: 6973 7369 6e67 2027 7b6c 6162 656c 7d27  issing '{label}'
-000083c0: 2069 6e20 6172 7261 792e 207b 6c61 6265   in array. {labe
-000083d0: 6c21 727d 206d 7573 7420 6265 220d 0a20  l!r} must be".. 
+00007c00: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00007c10: 203d 2773 7472 6963 7427 2920 0d0a 2020   ='strict') ..  
+00007c20: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00007c30: 226c 6162 656c 206b 203d 222c 206c 6162  "label k =", lab
+00007c40: 656c 2c20 273a 5c6e 2720 2c20 7229 0d0a  el, ':\n' , r)..
+00007c50: 2020 2020 6c61 6265 6c20 6b20 3d20 3120      label k = 1 
+00007c60: 3a0d 0a20 2020 2020 7b27 5627 3a20 302e  :..     {'V': 0.
+00007c70: 3137 2c20 2749 5627 3a20 302e 3134 312c  17, 'IV': 0.141,
+00007c80: 2027 4949 273a 2030 2e31 3236 2c20 2749   'II': 0.126, 'I
+00007c90: 4949 273a 2030 2e30 3834 2c20 2749 5626  II': 0.084, 'IV&
+00007ca0: 5627 3a20 302e 3030 352c 200d 0a20 2020  V': 0.005, ..   
+00007cb0: 2020 2027 4949 2649 4949 273a 2030 2e30     'II&III': 0.0
+00007cc0: 3033 2c20 2749 4949 2649 5627 3a20 302e  03, 'III&IV': 0.
+00007cd0: 3030 337d 0d0a 2020 2020 6c61 6265 6c20  003}..    label 
+00007ce0: 6b20 3d20 3220 3a0d 0a20 2020 2020 7b27  k = 2 :..     {'
+00007cf0: 4949 4927 3a20 302e 3035 322c 2027 4949  III': 0.052, 'II
+00007d00: 273a 2030 2e30 352c 2027 5627 3a20 302e  ': 0.05, 'V': 0.
+00007d10: 3035 2c20 2749 5627 3a20 302e 3033 342c  05, 'IV': 0.034,
+00007d20: 2027 4949 4926 4956 273a 2030 2e30 3035   'III&IV': 0.005
+00007d30: 7d0d 0a20 2020 206c 6162 656c 206b 203d  }..    label k =
+00007d40: 2033 203a 0d0a 2020 2020 207b 2756 273a   3 :..     {'V':
+00007d50: 2030 2e31 3233 2c20 2749 5627 3a20 302e   0.123, 'IV': 0.
+00007d60: 3038 362c 2027 4949 4927 3a20 302e 3036  086, 'III': 0.06
+00007d70: 387d 0d0a 2020 2020 3e3e 3e20 2320 2a2a  8}..    >>> # **
+00007d80: 636f 6d6d 656e 7473 3a20 0d0a 2020 2020  comments: ..    
+00007d90: 2020 2020 2320 6c61 6265 6c20 6b3d 3120      # label k=1 
+00007da0: 6973 2031 3725 2069 6d70 6f72 7461 6e63  is 17% importanc
+00007db0: 6520 666f 7220 6772 6f75 7020 562c 2031  e for group V, 1
+00007dc0: 322e 3325 2066 6f72 2067 726f 7570 2049  2.3% for group I
+00007dd0: 4920 7768 6572 6561 730d 0a20 2020 2020  I whereas..     
+00007de0: 2020 2023 206c 6162 656c 206b 3d32 2068     # label k=2 h
+00007df0: 6173 2061 2077 6561 6b20 7261 7465 2069  as a weak rate i
+00007e00: 6e20 7468 6520 7768 6f6c 6520 6461 7461  n the whole data
+00007e10: 7365 7420 7e3d 302e 3139 2520 666f 7220  set ~=0.19% for 
+00007e20: 616c 6c20 6772 6f75 7073 0d0a 2020 2020  all groups..    
+00007e30: 2020 2020 2320 7468 6520 6d6f 7374 2064      # the most d
+00007e40: 6f6d 696e 6174 6520 6c61 6265 6c73 2061  ominate labels a
+00007e50: 7265 206b 3d31 2061 6e64 206b 3d33 2077  re k=1 and k=3 w
+00007e60: 6974 6820 3533 2e31 3425 2061 6e64 2032  ith 53.14% and 2
+00007e70: 372e 3734 2025 200d 0a20 2020 2020 2020  7.74 % ..       
+00007e80: 2023 2072 6573 7065 6374 6976 656c 7920   # respectively 
+00007e90: 696e 2074 6865 2064 6174 6173 6574 2e20  in the dataset. 
+00007ea0: 0d0a 2020 2020 2020 2020 2320 4966 2074  ..        # If t
+00007eb0: 6872 6573 686f 6c64 206f 6620 7265 7072  hreshold of repr
+00007ec0: 6573 656e 7461 7469 7669 7479 2069 7320  esentativity is 
+00007ed0: 7365 7420 746f 2035 3025 202c 206e 6f6e  set to 50% , non
+00007ee0: 6520 6f66 2074 6865 2074 7275 6520 0d0a  e of the true ..
+00007ef0: 2020 2020 2020 2020 2320 6c61 6265 6c20          # label 
+00007f00: 6b20 7769 6c6c 2066 6974 2061 6e79 2061  k will fit any a
+00007f10: 7175 6966 6572 2067 726f 7570 2073 696e  quifer group sin
+00007f20: 6365 2074 6865 206d 6178 2072 6570 7265  ce the max repre
+00007f30: 7365 6e74 6174 6976 6974 7920 0d0a 2020  sentativity ..  
+00007f40: 2020 2020 2020 2320 7363 6f72 6520 6973        # score is
+00007f50: 2031 3725 2061 6e64 2069 7320 666f 7220   17% and is for 
+00007f60: 7468 6520 6772 6f75 7020 5620 6573 7065  the group V espe
+00007f70: 6369 616c 6c79 2066 6f72 206b 3d31 2e20  cially for k=1. 
+00007f80: 0d0a 2020 2020 2222 2220 0d0a 2020 2020  ..    """ ..    
+00007f90: 6172 725f 6b20 3d20 6368 6563 6b5f 7920  arr_k = check_y 
+00007fa0: 280d 0a20 2020 2020 2020 2061 7272 5f6b  (..        arr_k
+00007fb0: 2c20 0d0a 2020 2020 2020 2020 616c 6c6f  , ..        allo
+00007fc0: 775f 6e61 6e3d 5472 7565 202c 200d 0a20  w_nan=True , .. 
+00007fd0: 2020 2020 2020 2069 6e70 7574 5f6e 616d         input_nam
+00007fe0: 653d 2241 7272 6179 2027 6172 725f 6b27  e="Array 'arr_k'
+00007ff0: 222c 0d0a 2020 2020 2020 2020 2920 200d  ",..        )  .
+00008000: 0a20 2020 2061 7272 5f61 7120 3d20 6368  .    arr_aq = ch
+00008010: 6563 6b5f 7928 0d0a 2020 2020 2020 2020  eck_y(..        
+00008020: 6172 725f 6171 2c20 0d0a 2020 2020 2020  arr_aq, ..      
+00008030: 2020 696e 7075 745f 6e61 6d65 3d22 4172    input_name="Ar
+00008040: 7261 7920 2761 7272 5f61 7127 222c 200d  ray 'arr_aq'", .
+00008050: 0a20 2020 2020 2020 2029 0d0a 2020 2020  .        )..    
+00008060: 0d0a 2020 2020 5f63 6865 636b 5f63 6f6e  ..    _check_con
+00008070: 7369 7374 656e 6379 5f73 697a 6528 6172  sistency_size(ar
+00008080: 725f 6b2c 2061 7272 5f61 7129 0d0a 0d0a  r_k, arr_aq)....
+00008090: 2020 2020 6173 7365 7274 2073 7472 286d      assert str(m
+000080a0: 6574 686f 6429 2e6c 6f77 6572 2829 2e73  ethod).lower().s
+000080b0: 7472 6970 2829 2020 696e 207b 226e 6169  trip()  in {"nai
+000080c0: 7665 222c 2022 7374 7269 6374 227d 2c20  ve", "strict"}, 
+000080d0: 280d 0a20 2020 2020 2020 2066 2253 7570  (..        f"Sup
+000080e0: 706f 7274 7320 6f6e 6c79 2027 6e61 6976  ports only 'naiv
+000080f0: 6527 206f 7220 2773 7472 6963 7427 2e20  e' or 'strict'. 
+00008100: 476f 7420 7b6d 6574 686f 6421 727d 2229  Got {method!r}")
+00008110: 0d0a 2020 2020 6d65 7468 6f64 203d 7374  ..    method =st
+00008120: 7228 6d65 7468 6f64 292e 6c6f 7765 7228  r(method).lower(
+00008130: 292e 7374 7269 7028 2920 0d0a 2020 2020  ).strip() ..    
+00008140: 2320 6966 204e 614e 2065 7869 7374 7320  # if NaN exists 
+00008150: 6765 7420 7468 6520 6e6f 6e5f 7661 6c69  get the non_vali
+00008160: 6420 6b20 0d0a 2020 2020 6966 206e 702e  d k ..    if np.
+00008170: 6973 6e61 6e28 6172 725f 6b29 2e61 6e79  isnan(arr_k).any
+00008180: 2829 203a 200d 0a20 2020 2020 2020 206e  () : ..        n
+00008190: 6f74 5f6e 616e 5f69 6e64 6963 6573 202c  ot_nan_indices ,
+000081a0: 203d 206e 702e 7768 6572 6520 287e 6e70   = np.where (~np
+000081b0: 2e69 736e 616e 2861 7272 5f6b 2929 0d0a  .isnan(arr_k))..
+000081c0: 2020 2020 2020 2020 6172 725f 6171 203d          arr_aq =
+000081d0: 2061 7272 5f61 715b 6e6f 745f 6e61 6e5f   arr_aq[not_nan_
+000081e0: 696e 6469 6365 735d 200d 0a20 2020 2020  indices] ..     
+000081f0: 2020 2061 7272 5f6b 203d 2061 7272 5f6b     arr_k = arr_k
+00008200: 205b 6e6f 745f 6e61 6e5f 696e 6469 6365   [not_nan_indice
+00008210: 735d 200d 0a20 2020 2020 2020 200d 0a20  s] ..        .. 
+00008220: 2020 2069 6620 6e6f 7420 5f69 735f 6e75     if not _is_nu
+00008230: 6d65 7269 635f 6474 7970 6528 6172 725f  meric_dtype(arr_
+00008240: 6b29 3a0d 0a20 2020 2020 2020 2023 2074  k):..        # t
+00008250: 6865 7265 666f 7265 2063 6f6e 7665 7274  herefore convert
+00008260: 2061 7272 6179 5f61 7120 746f 6f20 746f   array_aq too to
+00008270: 2064 7479 7065 2073 7472 696e 6720 0d0a   dtype string ..
+00008280: 2020 2020 2020 2020 6172 725f 6171 203d          arr_aq =
+00008290: 2074 6f5f 6474 7970 655f 7374 7228 2061   to_dtype_str( a
+000082a0: 7272 5f61 7120 2c20 7265 7475 726e 5f76  rr_aq , return_v
+000082b0: 616c 7565 733d 2054 7275 6520 2920 0d0a  alues= True ) ..
+000082c0: 2020 2020 2020 2020 6c61 6265 6c20 3d73          label =s
+000082d0: 7472 2028 6c61 6265 6c29 2023 2066 6f72  tr (label) # for
+000082e0: 2063 6f6e 7369 7374 656e 6379 200d 0a20   consistency .. 
+000082f0: 2020 2020 2020 2023 2074 6869 7320 6973         # this is
+00008300: 2075 7365 6675 6c6c 2077 6865 6e20 7573   usefull when us
+00008310: 696e 6720 6e70 2e75 6e69 7175 6520 7369  ing np.unique si
+00008320: 6e63 6520 0d0a 2020 2020 2020 2020 2320  nce ..        # 
+00008330: 6e75 6d65 7269 6320 6461 7461 2063 616e  numeric data can
+00008340: 6e6f 7420 6265 2063 6f65 7263 6564 2020  not be coerced  
+00008350: 7769 7468 2073 7472 696e 6720 6474 7970  with string dtyp
+00008360: 6520 0d0a 2020 2020 6966 206c 6162 656c  e ..    if label
+00008370: 206e 6f74 2069 6e20 286e 702e 756e 6971   not in (np.uniq
+00008380: 7565 2028 6172 725f 6b29 293a 200d 0a20  ue (arr_k)): .. 
+00008390: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000083a0: 7565 4572 726f 7220 2866 224d 6973 7369  ueError (f"Missi
+000083b0: 6e67 2027 7b6c 6162 656c 7d27 2069 6e20  ng '{label}' in 
+000083c0: 6172 7261 792e 207b 6c61 6265 6c21 727d  array. {label!r}
+000083d0: 206d 7573 7420 6265 220d 0a20 2020 2020   must be"..     
 000083e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000083f0: 2020 2020 2020 2020 2022 2061 206c 6162           " a lab
-00008400: 656c 2069 6e63 6c75 6465 6420 696e 2027  el included in '
-00008410: 6172 725f 6b27 2e20 5661 6c69 6420 6c61  arr_k'. Valid la
-00008420: 6265 6c73 2061 7265 3a22 0d0a 2020 2020  bels are:"..    
+000083f0: 2020 2020 2022 2061 206c 6162 656c 2069       " a label i
+00008400: 6e63 6c75 6465 6420 696e 2027 6172 725f  ncluded in 'arr_
+00008410: 6b27 2e20 5661 6c69 6420 6c61 6265 6c73  k'. Valid labels
+00008420: 2061 7265 3a22 0d0a 2020 2020 2020 2020   are:"..        
 00008430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008440: 2020 2020 2020 6622 207b 6c69 7374 286e        f" {list(n
-00008450: 702e 756e 6971 7565 2028 6172 725f 6b29  p.unique (arr_k)
-00008460: 297d 220d 0a20 2020 2020 2020 2020 2020  )}"..           
-00008470: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00008480: 0d0a 2020 2020 2320 696e 6469 6365 7320  ..    # indices 
-00008490: 7768 6572 6520 6c61 6265 6c20 6b20 6578  where label k ex
-000084a0: 6973 7473 2069 6e20 6172 725f 6b20 0d0a  ists in arr_k ..
-000084b0: 2020 2020 696e 6465 782c 203d 206e 702e      index, = np.
-000084c0: 7768 6572 6520 2861 7272 5f6b 203d 3d6c  where (arr_k ==l
-000084d0: 6162 656c 2029 0d0a 2020 2020 2320 6669  abel )..    # fi
-000084e0: 6e64 2069 7473 2063 6f72 7265 7370 6f6e  nd its correspon
-000084f0: 6469 6e67 2076 616c 7565 2066 726f 6d20  ding value from 
-00008500: 696e 6469 6365 7320 696e 2067 726f 7570  indices in group
-00008510: 7320 6172 725f 6171 0d0a 2020 2020 6c61  s arr_aq..    la
-00008520: 6265 6c5f 696e 5f61 7272 5f71 203d 2061  bel_in_arr_q = a
-00008530: 7272 5f61 715b 696e 6465 7820 5d0d 0a20  rr_aq[index ].. 
-00008540: 2020 2023 2063 6f75 6e74 2074 6865 206c     # count the l
-00008550: 6162 656c 7320 7468 6174 2066 6974 7320  abels that fits 
-00008560: 6c61 6265 6c20 6b20 696e 2061 7272 5f6b  label k in arr_k
-00008570: 0d0a 2020 2020 6c61 6265 6c5f 6772 6f75  ..    label_grou
-00008580: 7020 2c20 6772 6f75 705f 636f 756e 7473  p , group_counts
-00008590: 203d 206e 702e 756e 6971 7565 2028 0d0a   = np.unique (..
-000085a0: 2020 2020 2020 2020 6c61 6265 6c5f 696e          label_in
-000085b0: 5f61 7272 5f71 2c20 7265 7475 726e 5f63  _arr_q, return_c
-000085c0: 6f75 6e74 733d 5472 7565 2029 200d 0a20  ounts=True ) .. 
-000085d0: 2020 2023 2063 6f6d 7075 7465 2072 6174     # compute rat
-000085e0: 696f 2c20 636f 6d70 6172 6520 746f 2069  io, compare to i
-000085f0: 7473 2069 6d70 6f72 7461 6e63 6520 0d0a  ts importance ..
-00008600: 2020 2020 2320 696e 2074 6865 2077 686f      # in the who
-00008610: 6c65 2076 616c 6964 2061 7272 6179 5f4b  le valid array_K
-00008620: 0d0a 2020 2020 746f 7420 3d20 7375 6d28  ..    tot = sum(
-00008630: 6772 6f75 705f 636f 756e 7473 2920 6966  group_counts) if
-00008640: 206d 6574 686f 6420 3d3d 276e 6169 7665   method =='naive
-00008650: 2720 656c 7365 206c 656e 2861 7272 5f6b  ' else len(arr_k
-00008660: 2920 0d0a 2020 2020 6c61 6265 6c5f 6469  ) ..    label_di
-00008670: 6374 5f67 726f 7570 5f72 6174 6520 3d20  ct_group_rate = 
-00008680: 7b20 6b3a 2072 6f75 6e64 2028 762c 2033  { k: round (v, 3
-00008690: 2920 666f 7220 6b20 2c20 7620 696e 207a  ) for k , v in z
-000086a0: 6970 2028 0d0a 2020 2020 2020 2020 6c61  ip (..        la
-000086b0: 6265 6c5f 6772 6f75 702c 2067 726f 7570  bel_group, group
-000086c0: 5f63 6f75 6e74 732f 746f 7429 0d0a 2020  _counts/tot)..  
-000086d0: 2020 2020 2020 7d20 0d0a 2020 2020 2320        } ..    # 
-000086e0: 736f 7274 0d0a 2020 2020 6c61 6265 6c5f  sort..    label_
-000086f0: 6469 6374 5f67 726f 7570 5f72 6174 6520  dict_group_rate 
-00008700: 3d20 6469 6374 2820 736f 7274 6564 2028  = dict( sorted (
-00008710: 0d0a 2020 2020 2020 2020 6c61 6265 6c5f  ..        label_
-00008720: 6469 6374 5f67 726f 7570 5f72 6174 652e  dict_group_rate.
-00008730: 6974 656d 7328 2920 2c0d 0a20 2020 2020  items() ,..     
-00008740: 2020 206b 6579 3d6c 616d 6264 6120 783a     key=lambda x:
-00008750: 785b 315d 2c20 7265 7665 7273 6520 3d54  x[1], reverse =T
-00008760: 7275 6520 290d 0a20 2020 2020 2020 2029  rue )..        )
-00008770: 200d 0a20 2020 200d 0a20 2020 2072 6574   ..    ..    ret
-00008780: 7572 6e20 6c61 6265 6c5f 6469 6374 5f67  urn label_dict_g
-00008790: 726f 7570 5f72 6174 650d 0a20 0d0a 0d0a  roup_rate.. ....
-000087a0: 6465 6620 6669 6e64 5f73 696d 696c 6172  def find_similar
-000087b0: 5f6c 6162 656c 7320 2820 0d0a 2020 2020  _labels ( ..    
-000087c0: 795f 7472 7565 2c20 0d0a 2020 2020 795f  y_true, ..    y_
-000087d0: 7072 6564 2c20 200d 0a20 2020 202a 2c20  pred,  ..    *, 
-000087e0: 0d0a 2020 2020 6361 7465 676f 7269 7a65  ..    categorize
-000087f0: 5f6b 3a62 6f6f 6c3d 4661 6c73 652c 200d  _k:bool=False, .
-00008800: 0a20 2020 2074 6872 6573 686f 6c64 3a20  .    threshold: 
-00008810: 666c 6f61 743d 4e6f 6e65 2c20 0d0a 2020  float=None, ..  
-00008820: 2020 6675 6e63 3a20 6361 6c6c 6162 6c65    func: callable
-00008830: 3d4e 6f6e 652c 200d 0a20 2020 206b 6565  =None, ..    kee
-00008840: 705f 6c61 6265 6c5f 3020 3a62 6f6f 6c3d  p_label_0 :bool=
-00008850: 4661 6c73 652c 200d 0a20 2020 206d 6574  False, ..    met
-00008860: 686f 643a 7374 723d 276e 6169 7665 272c  hod:str='naive',
-00008870: 200d 0a20 2020 2072 6574 7572 6e5f 6772   ..    return_gr
-00008880: 6f75 7073 3a62 6f6f 6c3d 4661 6c73 652c  oups:bool=False,
-00008890: 200d 0a20 2020 202a 2a6b 7764 0d0a 2020   ..    **kwd..  
-000088a0: 2020 2020 2020 293a 0d0a 2020 2020 2222        ):..    ""
-000088b0: 2246 696e 6420 7369 6d69 6c61 7269 7469  "Find similariti
-000088c0: 6573 2062 6574 7765 656e 2079 5f74 7275  es between y_tru
-000088d0: 6520 616e 6420 795f 7072 6564 2061 6e64  e and y_pred and
-000088e0: 2072 6574 7572 6e73 2072 6174 6520 0d0a   returns rate ..
-000088f0: 2020 2020 0d0a 2020 2020 5061 7261 6d65      ..    Parame
-00008900: 7465 7273 200d 0a20 2020 202d 2d2d 2d2d  ters ..    -----
-00008910: 2d2d 2d2d 2d2d 0d0a 2020 2020 795f 7472  ------..    y_tr
-00008920: 7565 3a20 6172 7261 792d 6c69 6b65 2031  ue: array-like 1
-00008930: 6420 6f72 2070 616e 6461 732e 5365 7269  d or pandas.Seri
-00008940: 6573 200d 0a20 2020 2020 2020 2041 7272  es ..        Arr
-00008950: 6179 2063 6f6e 7461 696e 696e 6720 7468  ay containing th
-00008960: 6520 7472 7565 206c 6162 656c 7320 6f66  e true labels of
-00008970: 2027 6b27 200d 0a20 2020 2079 5f70 7265   'k' ..    y_pre
-00008980: 643a 2061 7272 6179 5f6c 696b 652c 206f  d: array_like, o
-00008990: 7220 7061 6e64 6173 2e53 6572 6965 730d  r pandas.Series.
-000089a0: 0a20 2020 2020 2020 2061 7272 6179 2063  .        array c
-000089b0: 6f6e 7461 696e 696e 6720 7468 6520 7072  ontaining the pr
-000089c0: 6564 6963 7465 6420 6e61 6976 6520 6772  edicted naive gr
-000089d0: 6f75 7020 6f66 2061 7175 6966 6572 7320  oup of aquifers 
-000089e0: 284e 4741 2920 200d 0a20 2020 2020 2020  (NGA)  ..       
-000089f0: 200d 0a20 2020 2063 6174 6567 6f72 697a   ..    categoriz
-00008a00: 655f 6b3a 2062 6f6f 6c2c 200d 0a20 2020  e_k: bool, ..   
-00008a10: 2020 2020 2049 6620 7365 7420 746f 2060       If set to `
-00008a20: 6054 7275 6560 602c 2075 7365 7220 6e65  `True``, user ne
-00008a30: 6564 7320 746f 2070 726f 7669 6465 2061  eds to provide a
-00008a40: 2066 756e 6374 696f 6e20 6075 6675 6e63   function `ufunc
-00008a50: 6020 746f 206d 6170 200d 0a20 2020 2020  ` to map ..     
-00008a60: 2020 206f 7220 6361 7465 676f 7269 7a65     or categorize
-00008a70: 2074 6865 2070 6572 6d65 6162 696c 6974   the permeabilit
-00008a80: 7920 636f 6566 6669 6369 656e 7420 276b  y coefficient 'k
-00008a90: 2720 696e 746f 2061 6e20 696e 7465 6765  ' into an intege
-00008aa0: 7220 0d0a 2020 2020 2020 2020 6c61 6265  r ..        labe
-00008ab0: 6c73 2e20 0d0a 2020 2020 2020 2020 0d0a  ls. ..        ..
-00008ac0: 2020 2020 6675 6e63 3a20 6361 6c6c 6162      func: callab
-00008ad0: 6c65 200d 0a20 2020 2020 2020 4675 6e63  le ..       Func
-00008ae0: 7469 6f6e 2074 6f20 7370 6563 6966 6963  tion to specific
-00008af0: 616c 6c79 206d 6170 2074 6865 2070 6572  ally map the per
-00008b00: 6d65 6162 696c 6974 7920 636f 6566 6669  meability coeffi
-00008b10: 6369 656e 7420 636f 6c75 6d6e 200d 0a20  cient column .. 
-00008b20: 2020 2020 2020 696e 2074 6865 2064 6174        in the dat
-00008b30: 6166 7261 6d65 206f 6620 7365 7269 652e  aframe of serie.
-00008b40: 2049 6620 6e6f 7420 6769 7665 6e2c 2074   If not given, t
-00008b50: 6865 2064 6566 6175 6c74 2066 756e 6374  he default funct
-00008b60: 696f 6e20 6361 6e20 6265 200d 0a20 2020  ion can be ..   
-00008b70: 2020 2020 656e 6162 6c65 6420 696e 7374      enabled inst
-00008b80: 6561 6420 6672 6f6d 2070 6172 616d 2060  ead from param `
-00008b90: 6465 6661 756c 745f 6675 6e63 602e 2020  default_func`.  
-00008ba0: 2020 200d 0a20 2020 2020 2020 200d 0a20     ..        .. 
-00008bb0: 2020 2074 6872 6573 686f 6c64 3a20 666c     threshold: fl
-00008bc0: 6f61 742c 2064 6566 6175 6c74 3d4e 6f6e  oat, default=Non
-00008bd0: 6520 0d0a 2020 2020 2020 2020 5468 6520  e ..        The 
-00008be0: 7468 7265 7368 6f6c 6420 6672 6f6d 2077  threshold from w
-00008bf0: 6869 6368 2c20 6c61 6265 6c20 696e 2027  hich, label in '
-00008c00: 795f 7472 7565 2720 6361 6e20 6265 2063  y_true' can be c
-00008c10: 6f6e 7369 6465 7265 6420 200d 0a20 2020  onsidered  ..   
-00008c20: 2020 2020 2073 696d 696c 6172 2074 6861       similar tha
-00008c30: 6e20 7468 6520 6f6e 6520 696e 204e 4741  n the one in NGA
-00008c40: 206c 6162 656c 7320 2779 5f70 7265 6427   labels 'y_pred'
-00008c50: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
-00008c60: 2027 4e6f 6e65 2720 7768 6963 6820 0d0a   'None' which ..
-00008c70: 2020 2020 2020 2020 6d65 616e 7320 6e6f          means no
-00008c80: 6e65 2072 756c 6520 6973 2063 6f6e 7369  ne rule is consi
-00008c90: 6465 7265 6420 616e 6420 7468 6520 6869  dered and the hi
-00008ca0: 6768 2070 7265 706f 6e64 6572 656e 6365  gh preponderence
-00008cb0: 206f 7220 6f63 6375 7265 6e63 6520 0d0a   or occurence ..
-00008cc0: 2020 2020 2020 2020 696e 2074 6865 2064          in the d
-00008cd0: 6174 6120 636f 6d70 6172 6564 2074 6f20  ata compared to 
-00008ce0: 6f74 6865 7220 6c61 6265 6c73 2069 7320  other labels is 
-00008cf0: 636f 6e73 6964 6572 6564 2061 7320 7468  considered as th
-00008d00: 6520 6d6f 7374 200d 0a20 2020 2020 2020  e most ..       
-00008d10: 2072 6570 7265 7365 6e74 6174 6976 6520   representative 
-00008d20: 2061 6e64 2073 696d 696c 6172 2e20 5365   and similar. Se
-00008d30: 7474 696e 6720 7468 6520 7275 6c65 2069  tting the rule i
-00008d40: 6e73 7465 6164 2062 7920 6669 7869 6e67  nstead by fixing
-00008d50: 200d 0a20 2020 2020 2020 2074 6865 2074   ..        the t
-00008d60: 6872 6573 686f 6c64 2069 7320 7265 636f  hreshold is reco
-00008d70: 6d6d 656e 6465 6420 6573 7065 6369 616c  mmended especial
-00008d80: 6c79 2069 6e20 6120 6875 6765 2064 6174  ly in a huge dat
-00008d90: 6173 6574 2e0d 0a20 2020 2020 2020 200d  aset...        .
-00008da0: 0a20 2020 206b 6565 705f 6c61 6265 6c5f  .    keep_label_
-00008db0: 303a 2062 6f6f 6c2c 2064 6566 6175 6c74  0: bool, default
-00008dc0: 3d30 0d0a 2020 2020 2020 2020 466f 7263  =0..        Forc
-00008dd0: 6520 696e 636c 7564 696e 6720 3020 696e  e including 0 in
-00008de0: 2074 6865 2070 7265 6469 6374 6564 206c   the predicted l
-00008df0: 6162 656c 2069 6620 2060 696e 636c 7564  abel if  `includ
-00008e00: 655f 6c61 6265 6c5f 3060 2069 7320 7365  e_label_0` is se
-00008e10: 7420 0d0a 2020 2020 2020 2020 746f 2060  t ..        to `
-00008e20: 6054 7275 6560 602e 204d 6f73 746c 7920  `True``. Mostly 
-00008e30: 6c61 6265 6c20 2730 2720 7265 6665 7273  label '0' refers
-00008e40: 2074 6f20 276b 3d30 2720 692e 652e 206e   to 'k=0' i.e. n
-00008e50: 6f20 7065 726d 6561 6269 6c69 7479 200d  o permeability .
-00008e60: 0a20 2020 2020 2020 2063 6f65 6666 6963  .        coeffic
-00008e70: 6965 6e74 2065 7175 616c 7320 746f 2030  ient equals to 0
-00008e80: 2c20 7768 6963 6820 6973 206e 6f74 2054  , which is not T
-00008e90: 7275 6520 696e 2070 7269 6e63 6970 6c65  rue in principle
-00008ea0: 2c20 6265 6361 7573 6520 616c 6c20 726f  , because all ro
-00008eb0: 636b 7320 200d 0a20 2020 2020 2020 2068  cks  ..        h
-00008ec0: 6176 6520 6120 7065 726d 6561 6269 6c69  ave a permeabili
-00008ed0: 7479 2063 6f65 6666 6963 6965 6e74 2027  ty coefficient '
-00008ee0: 6b27 2e20 4865 7265 2077 6520 636f 6e73  k'. Here we cons
-00008ef0: 6964 6572 6564 2027 6b3d 3027 2061 7320  idered 'k=0' as 
-00008f00: 616e 2075 6e64 6566 696e 6564 200d 0a20  an undefined .. 
-00008f10: 2020 2020 2020 2070 6572 6d65 6162 696c         permeabil
-00008f20: 6974 7920 636f 6566 6669 6369 656e 742e  ity coefficient.
-00008f30: 2054 6865 7265 666f 7265 2c20 2730 2720   Therefore, '0' 
-00008f40: 2c20 6361 6e20 6265 2065 7863 6c75 6465  , can be exclude
-00008f50: 2073 696e 6365 2c20 6974 2063 616e 200d   since, it can .
-00008f60: 0a20 2020 2020 2020 2061 6c73 6f20 636f  .        also co
-00008f70: 6e73 6964 6572 6564 2061 7320 6120 6d69  nsidered as a mi
-00008f80: 7373 696e 6720 276b 272d 7661 6c75 652e  ssing 'k'-value.
-00008f90: 2049 6620 7072 6564 6963 7465 6420 2730   If predicted '0
-00008fa0: 2720 6973 2069 6e20 7468 6520 7461 7267  ' is in the targ
-00008fb0: 6574 200d 0a20 2020 2020 2020 2069 7420  et ..        it 
-00008fc0: 7368 6f75 6c64 206d 6561 6e20 6120 6d69  should mean a mi
-00008fd0: 7373 696e 6720 276b 272d 7661 6c75 6520  ssing 'k'-value 
-00008fe0: 7261 7468 6572 2074 6861 6e20 6265 696e  rather than bein
-00008ff0: 6720 6120 636f 6e63 7265 7465 206c 6162  g a concrete lab
-00009000: 656c 2e20 200d 0a20 2020 2020 2020 2054  el.  ..        T
-00009010: 6865 7265 666f 7265 2c20 746f 2061 766f  herefore, to avo
-00009020: 6964 2061 6e79 2063 6f6e 6675 7369 6f6e  id any confusion
-00009030: 2c20 2730 2720 6973 2072 656d 6f76 6564  , '0' is removed
-00009040: 2062 7920 6465 6661 756c 7420 696e 2074   by default in t
-00009050: 6865 2027 6b27 0d0a 2020 2020 2020 2020  he 'k'..        
-00009060: 6361 7465 676f 7269 7a61 7469 6f6e 2e20  categorization. 
-00009070: 486f 7765 7665 722c 2077 6865 6e20 7468  However, when th
-00009080: 6520 7072 6564 6963 7469 6f6e 2027 795f  e prediction 'y_
-00009090: 7072 6564 2720 6973 206d 6164 6520 6672  pred' is made fr
-000090a0: 6f6d 2074 6865 200d 0a20 2020 2020 2020  om the ..       
-000090b0: 2074 6865 2075 6e73 7570 6572 7669 7369   the unsupervisi
-000090c0: 6e67 206d 6574 686f 642c 2074 6865 2070  ng method, the p
-000090d0: 7265 6469 6374 696f 6e20 2730 2720 7374  rediction '0' st
-000090e0: 7261 6967 7468 666f 7277 6172 646c 7920  raigthforwardly 
-000090f0: 696e 636c 7564 6573 0d0a 2020 2020 2020  includes..      
-00009100: 2020 2027 3027 2069 2e65 2027 6b3d 3027     '0' i.e 'k=0'
-00009110: 2061 7320 6120 6669 7273 7420 636c 6173   as a first clas
-00009120: 732e 2053 6f20 7468 6520 7661 6c75 6520  s. So the value 
-00009130: 602b 3160 2069 7320 7573 6564 2074 6f20  `+1` is used to 
-00009140: 6d6f 7665 2066 6f72 7761 7264 200d 0a20  move forward .. 
-00009150: 2020 2020 2020 2061 6c6c 2063 6c61 7373         all class
-00009160: 206c 6162 656c 7320 7468 6572 6562 7920   labels thereby 
-00009170: 6578 636c 7564 696e 6720 7468 6520 2730  excluding the '0
-00009180: 2720 6c61 6265 6c2e 2054 6f20 666f 7263  ' label. To forc
-00009190: 6520 696e 636c 7564 6520 3020 0d0a 2020  e include 0 ..  
-000091a0: 2020 2020 2020 696e 2074 6865 206c 6162        in the lab
-000091b0: 656c 2c20 7365 7420 6069 6e63 6c75 6465  el, set `include
-000091c0: 5f6c 6162 656c 5f30 6020 746f 2060 6054  _label_0` to ``T
-000091d0: 7275 6560 602e 200d 0a20 2020 2020 2020  rue``. ..       
-000091e0: 200d 0a20 2020 206d 6574 686f 643a 2073   ..    method: s
-000091f0: 7472 205b 276e 6169 7665 272c 2027 7374  tr ['naive', 'st
-00009200: 7269 6374 275d 2c20 6465 6661 756c 743d  rict'], default=
-00009210: 276e 6169 7665 270d 0a20 2020 2020 2020  'naive'..       
-00009220: 2054 6865 206b 696e 6420 6f66 2073 7472   The kind of str
-00009230: 6174 6567 7920 746f 2063 6f6d 7075 7465  ategy to compute
-00009240: 2074 6865 2072 6570 7265 7365 6e74 6174   the representat
-00009250: 6976 6974 7920 6f66 2061 206c 6162 656c  ivity of a label
-00009260: 200d 0a20 2020 2020 2020 2069 6e20 7468   ..        in th
-00009270: 6520 7072 6564 6963 7465 6420 6172 7261  e predicted arra
-00009280: 7920 2779 5f70 7265 6427 2e20 4974 2063  y 'y_pred'. It c
-00009290: 616e 2061 6c73 6f20 6265 2027 7374 7269  an also be 'stri
-000092a0: 6374 272e 2049 6e64 6565 643a 0d0a 2020  ct'. Indeed:..  
-000092b0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000092c0: 2d20 6060 6e61 6976 6560 6020 636f 6d70  - ``naive`` comp
-000092d0: 7574 6573 2074 6865 2069 6d70 6f72 7461  utes the importa
-000092e0: 6e63 6520 6f66 2074 6865 206c 6162 656c  nce of the label
-000092f0: 2062 7920 7468 6520 6e75 6d62 6572 206f   by the number o
-00009300: 6620 6974 730d 0a20 2020 2020 2020 2020  f its..         
-00009310: 2020 206f 6363 7572 656e 6365 2066 6f72     occurence for
-00009320: 2074 6869 7320 7370 6563 6966 6963 206c   this specific l
-00009330: 6162 656c 2069 6e20 7468 6520 6172 7261  abel in the arra
-00009340: 7920 2779 5f74 7275 6527 2e20 4974 2064  y 'y_true'. It d
-00009350: 6f65 7320 6e6f 7420 0d0a 2020 2020 2020  oes not ..      
-00009360: 2020 2020 2020 7461 6b65 2069 6e74 6f20        take into 
-00009370: 6163 636f 756e 7420 6f66 2074 6865 206f  account of the o
-00009380: 6363 7572 656e 6365 206f 6620 6f74 6865  ccurence of othe
-00009390: 7220 6578 6973 7469 6e67 206c 6162 656c  r existing label
-000093a0: 732e 2054 6869 7320 0d0a 2020 2020 2020  s. This ..      
-000093b0: 2020 2020 2020 6973 2075 7365 6675 6c6c        is usefull
-000093c0: 2066 6f72 2075 6e62 616c 616e 6365 6420   for unbalanced 
-000093d0: 636c 6173 7320 6c61 6265 6c73 2069 6e20  class labels in 
-000093e0: 6079 5f74 7275 6560 2e0d 0a20 2020 2020  `y_true`...     
-000093f0: 2020 202d 2060 6073 7472 6963 7460 6020     - ``strict`` 
-00009400: 636f 6d70 7574 6573 2074 6865 2069 6d70  computes the imp
-00009410: 6f72 7461 6e63 6520 6f66 2074 6865 206c  ortance of the l
-00009420: 6162 656c 2062 7920 7468 6520 6e75 6d62  abel by the numb
-00009430: 6572 206f 6620 0d0a 2020 2020 2020 2020  er of ..        
-00009440: 2020 2020 6f63 6375 7265 6e63 6520 696e      occurence in
-00009450: 2074 6865 2077 686f 6c65 2076 616c 6964   the whole valid
-00009460: 2060 795f 7472 7565 6020 692e 652e 2075   `y_true` i.e. u
-00009470: 6e64 6572 2074 6865 2074 6f74 616c 206f  nder the total o
-00009480: 6620 0d0a 2020 2020 2020 2020 2020 2020  f ..            
-00009490: 6f63 6375 7265 6e63 6520 6f66 2061 6c6c  occurence of all
-000094a0: 2074 6865 206c 6162 656c 7320 7468 6174   the labels that
-000094b0: 2065 7869 7374 2069 6e20 7468 6520 7768   exist in the wh
-000094c0: 6f6c 6520 2761 7272 615f 6171 272e 200d  ole 'arra_aq'. .
-000094d0: 0a20 2020 2020 2020 2020 2020 2054 6869  .            Thi
-000094e0: 7320 6361 6e20 6769 7665 2061 2073 7569  s can give a sui
-000094f0: 7461 626c 6520 616e 6179 6c73 6520 7265  table anaylse re
-00009500: 7375 6c74 7320 6966 2074 6865 2064 6174  sults if the dat
-00009510: 6120 6973 206e 6f74 200d 0a20 2020 2020  a is not ..     
-00009520: 2020 2020 2020 2075 6e62 616c 616e 6365         unbalance
-00009530: 6420 666f 7220 6561 6368 206c 6162 656c  d for each label
-00009540: 7320 696e 2060 795f 7072 6564 602e 0d0a  s in `y_pred`...
-00009550: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00009560: 2020 7265 7475 726e 5f67 726f 7570 733a    return_groups:
-00009570: 2062 6f6f 6c2c 2064 6566 6175 6c74 3d46   bool, default=F
-00009580: 616c 7365 200d 0a20 2020 2020 2020 2052  alse ..        R
-00009590: 6574 7572 6e73 206c 6162 656c 2067 726f  eturns label gro
-000095a0: 7570 7320 616e 6420 7468 6569 7220 7661  ups and their va
-000095b0: 6c75 6573 2063 6f75 6e74 7320 696e 2074  lues counts in t
-000095c0: 6865 2070 7265 6469 6374 6564 200d 0a20  he predicted .. 
-000095d0: 2020 2020 2020 206c 6162 656c 7320 6079         labels `y
-000095e0: 5f70 7265 6460 2020 7768 6572 6520 276b  _pred`  where 'k
-000095f0: 2720 7661 6c75 6573 2061 7265 206e 6f74  ' values are not
-00009600: 206d 6973 7369 6e67 2e20 0d0a 2020 2020   missing. ..    
-00009610: 0d0a 2020 2020 5265 7475 726e 7320 0d0a  ..    Returns ..
-00009620: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d20 0d0a      --------- ..
-00009630: 2020 2020 672e 7369 6d69 6c61 7269 7479      g.similarity
-00009640: 203a 2054 7570 6c65 206f 6620 206c 6162   : Tuple of  lab
-00009650: 656c 7320 666f 756e 6420 7468 6174 2061  els found that a
-00009660: 7265 2063 6f6e 7369 6465 7265 6420 7369  re considered si
-00009670: 6d69 6c61 7220 696e 200d 0a20 2020 2020  milar in ..     
-00009680: 2020 2070 7265 6469 6374 6564 206c 6162     predicted lab
-00009690: 656c 732e 200d 0a20 2020 2067 2e67 726f  els. ..    g.gro
-000096a0: 7570 3a20 5475 706c 6520 6f66 2067 726f  up: Tuple of gro
-000096b0: 7570 2074 6861 7420 6861 7665 2074 6865  up that have the
-000096c0: 6972 2073 696d 696c 6172 6974 7920 696e  ir similarity in
-000096d0: 2074 6865 2074 7275 6520 6c61 6265 6c73   the true labels
-000096e0: 200d 0a20 2020 200d 0a20 2020 2045 7861   ..    ..    Exa
-000096f0: 6d70 6c65 200d 0a20 2020 202d 2d2d 2d2d  mple ..    -----
-00009700: 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e 2066  -----..    >>> f
-00009710: 726f 6d20 7761 7465 782e 7574 696c 7320  rom watex.utils 
-00009720: 696d 706f 7274 2072 6561 645f 6461 7461  import read_data
-00009730: 200d 0a20 2020 203e 3e3e 2066 726f 6d20   ..    >>> from 
-00009740: 7761 7465 782e 7574 696c 732e 6879 6472  watex.utils.hydr
-00009750: 6f75 7469 6c73 2069 6d70 6f72 7420 6669  outils import fi
-00009760: 6e64 5f73 696d 696c 6172 5f6c 6162 656c  nd_similar_label
-00009770: 732c 2063 6c61 7373 6966 795f 6b0d 0a20  s, classify_k.. 
-00009780: 2020 203e 3e3e 2064 6174 6120 3d20 7265     >>> data = re
-00009790: 6164 5f64 6174 6120 2827 6461 7461 2f62  ad_data ('data/b
-000097a0: 6f72 6568 6f6c 6573 2f68 662e 6373 7627  oreholes/hf.csv'
-000097b0: 290d 0a20 2020 203e 3e3e 2079 6d61 7020  )..    >>> ymap 
-000097c0: 3d20 636c 6173 7369 6679 5f6b 2864 6174  = classify_k(dat
-000097d0: 612e 6b20 2c20 6465 6661 756c 745f 6675  a.k , default_fu
-000097e0: 6e63 203d 5472 7565 2920 0d0a 2020 2020  nc =True) ..    
-000097f0: 3e3e 3e20 2320 4e6f 7465 2074 6861 7420  >>> # Note that 
-00009800: 666f 7220 7468 6520 6465 6d6f 2077 6520  for the demo we 
-00009810: 7573 6520 7468 6520 6772 6f75 7020 6f66  use the group of
-00009820: 2061 7175 6966 6572 2063 6f6c 756d 6e73   aquifer columns
-00009830: 2c20 686f 7765 7665 720d 0a20 2020 203e  , however..    >
-00009840: 3e3e 2023 2069 6e20 7072 6174 6963 616c  >> # in pratical
-00009850: 2065 7861 6d70 6c65 2c20 795f 7072 6564   example, y_pred
-00009860: 206d 7573 7420 6265 2061 2070 7265 6469   must be a predi
-00009870: 6374 6564 204e 4741 206c 6162 656c 732e  cted NGA labels.
-00009880: 2054 6869 7320 0d0a 2020 2020 3e3e 3e20   This ..    >>> 
-00009890: 2320 6973 2070 6f73 7369 626c 6520 7573  # is possible us
-000098a0: 696e 6720 7468 6520 6675 6e63 7469 6f6e  ing the function
-000098b0: 203c 7072 6564 6963 745f 4e47 415f 6c61   <predict_NGA_la
-000098c0: 6265 6c73 3e20 0d0a 2020 2020 3e3e 3e20  bels> ..    >>> 
-000098d0: 7369 6d20 3d20 6669 6e64 5f73 696d 696c  sim = find_simil
-000098e0: 6172 5f6c 6162 656c 7328 795f 7472 7565  ar_labels(y_true
-000098f0: 3d20 796d 6170 2c20 795f 7072 6564 3d64  = ymap, y_pred=d
-00009900: 6174 612e 6171 7569 6665 725f 6772 6f75  ata.aquifer_grou
-00009910: 7029 0d0a 2020 2020 3e3e 3e20 7369 6d20  p)..    >>> sim 
-00009920: 0d0a 2020 2020 2e2e 2e20 2828 312c 2027  ..    ... ((1, '
-00009930: 5627 292c 2028 322c 2027 4949 4927 292c  V'), (2, 'III'),
-00009940: 2028 332c 2027 5627 2929 0d0a 2020 2020   (3, 'V'))..    
-00009950: 3e3e 3e20 6772 6f75 703d 2066 696e 645f  >>> group= find_
-00009960: 7369 6d69 6c61 725f 6c61 6265 6c73 2879  similar_labels(y
-00009970: 6d61 702c 2064 6174 612e 6171 7569 6665  map, data.aquife
-00009980: 725f 6772 6f75 702c 2072 6574 7572 6e5f  r_group, return_
-00009990: 6772 6f75 7073 3d54 7275 6529 200d 0a20  groups=True) .. 
-000099a0: 2020 203e 3e3e 2067 726f 7570 200d 0a20     >>> group .. 
-000099b0: 2020 202e 2e2e 2028 2831 2c0d 0a20 2020     ... ((1,..   
-000099c0: 2020 207b 2756 273a 2030 2e31 372c 0d0a     {'V': 0.17,..
-000099d0: 2020 2020 2020 2027 4956 273a 2030 2e31         'IV': 0.1
-000099e0: 3431 2c0d 0a20 2020 2020 2020 2749 4927  41,..       'II'
-000099f0: 3a20 302e 3132 362c 0d0a 2020 2020 2020  : 0.126,..      
-00009a00: 2027 4949 4927 3a20 302e 3038 342c 0d0a   'III': 0.084,..
-00009a10: 2020 2020 2020 2027 4956 2656 273a 2030         'IV&V': 0
-00009a20: 2e30 3035 2c0d 0a20 2020 2020 2020 2749  .005,..       'I
-00009a30: 4926 4949 4927 3a20 302e 3030 332c 0d0a  I&III': 0.003,..
-00009a40: 2020 2020 2020 2027 4949 4926 4956 273a         'III&IV':
-00009a50: 2030 2e30 3033 7d29 2c0d 0a20 2020 2020   0.003}),..     
-00009a60: 2832 2c20 7b27 4949 4927 3a20 302e 3035  (2, {'III': 0.05
-00009a70: 322c 2027 4949 273a 2030 2e30 352c 2027  2, 'II': 0.05, '
-00009a80: 5627 3a20 302e 3035 2c20 2749 5627 3a20  V': 0.05, 'IV': 
-00009a90: 302e 3033 342c 2027 4949 4926 4956 273a  0.034, 'III&IV':
-00009aa0: 2030 2e30 3035 7d29 2c0d 0a20 2020 2020   0.005}),..     
-00009ab0: 2833 2c20 7b27 5627 3a20 302e 3132 332c  (3, {'V': 0.123,
-00009ac0: 2027 4956 273a 2030 2e30 3836 2c20 2749   'IV': 0.086, 'I
-00009ad0: 4949 273a 2030 2e30 3638 7d29 290d 0a20  II': 0.068})).. 
-00009ae0: 2020 203e 3e3e 2066 696e 645f 7369 6d69     >>> find_simi
-00009af0: 6c61 725f 6c61 6265 6c73 2879 5f74 7275  lar_labels(y_tru
-00009b00: 653d 2079 6d61 702c 2079 5f70 7265 643d  e= ymap, y_pred=
-00009b10: 6461 7461 2e61 7175 6966 6572 5f67 726f  data.aquifer_gro
-00009b20: 7570 2c0d 0a20 2020 2020 2020 2020 2020  up,..           
+00008440: 2020 6622 207b 6c69 7374 286e 702e 756e    f" {list(np.un
+00008450: 6971 7565 2028 6172 725f 6b29 297d 220d  ique (arr_k))}".
+00008460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008470: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00008480: 2020 2320 696e 6469 6365 7320 7768 6572    # indices wher
+00008490: 6520 6c61 6265 6c20 6b20 6578 6973 7473  e label k exists
+000084a0: 2069 6e20 6172 725f 6b20 0d0a 2020 2020   in arr_k ..    
+000084b0: 696e 6465 782c 203d 206e 702e 7768 6572  index, = np.wher
+000084c0: 6520 2861 7272 5f6b 203d 3d6c 6162 656c  e (arr_k ==label
+000084d0: 2029 0d0a 2020 2020 2320 6669 6e64 2069   )..    # find i
+000084e0: 7473 2063 6f72 7265 7370 6f6e 6469 6e67  ts corresponding
+000084f0: 2076 616c 7565 2066 726f 6d20 696e 6469   value from indi
+00008500: 6365 7320 696e 2067 726f 7570 7320 6172  ces in groups ar
+00008510: 725f 6171 0d0a 2020 2020 6c61 6265 6c5f  r_aq..    label_
+00008520: 696e 5f61 7272 5f71 203d 2061 7272 5f61  in_arr_q = arr_a
+00008530: 715b 696e 6465 7820 5d0d 0a20 2020 2023  q[index ]..    #
+00008540: 2063 6f75 6e74 2074 6865 206c 6162 656c   count the label
+00008550: 7320 7468 6174 2066 6974 7320 6c61 6265  s that fits labe
+00008560: 6c20 6b20 696e 2061 7272 5f6b 0d0a 2020  l k in arr_k..  
+00008570: 2020 6c61 6265 6c5f 6772 6f75 7020 2c20    label_group , 
+00008580: 6772 6f75 705f 636f 756e 7473 203d 206e  group_counts = n
+00008590: 702e 756e 6971 7565 2028 0d0a 2020 2020  p.unique (..    
+000085a0: 2020 2020 6c61 6265 6c5f 696e 5f61 7272      label_in_arr
+000085b0: 5f71 2c20 7265 7475 726e 5f63 6f75 6e74  _q, return_count
+000085c0: 733d 5472 7565 2029 200d 0a20 2020 2023  s=True ) ..    #
+000085d0: 2063 6f6d 7075 7465 2072 6174 696f 2c20   compute ratio, 
+000085e0: 636f 6d70 6172 6520 746f 2069 7473 2069  compare to its i
+000085f0: 6d70 6f72 7461 6e63 6520 0d0a 2020 2020  mportance ..    
+00008600: 2320 696e 2074 6865 2077 686f 6c65 2076  # in the whole v
+00008610: 616c 6964 2061 7272 6179 5f4b 0d0a 2020  alid array_K..  
+00008620: 2020 746f 7420 3d20 7375 6d28 6772 6f75    tot = sum(grou
+00008630: 705f 636f 756e 7473 2920 6966 206d 6574  p_counts) if met
+00008640: 686f 6420 3d3d 276e 6169 7665 2720 656c  hod =='naive' el
+00008650: 7365 206c 656e 2861 7272 5f6b 2920 0d0a  se len(arr_k) ..
+00008660: 2020 2020 6c61 6265 6c5f 6469 6374 5f67      label_dict_g
+00008670: 726f 7570 5f72 6174 6520 3d20 7b20 6b3a  roup_rate = { k:
+00008680: 2072 6f75 6e64 2028 762c 2033 2920 666f   round (v, 3) fo
+00008690: 7220 6b20 2c20 7620 696e 207a 6970 2028  r k , v in zip (
+000086a0: 0d0a 2020 2020 2020 2020 6c61 6265 6c5f  ..        label_
+000086b0: 6772 6f75 702c 2067 726f 7570 5f63 6f75  group, group_cou
+000086c0: 6e74 732f 746f 7429 0d0a 2020 2020 2020  nts/tot)..      
+000086d0: 2020 7d20 0d0a 2020 2020 2320 736f 7274    } ..    # sort
+000086e0: 0d0a 2020 2020 6c61 6265 6c5f 6469 6374  ..    label_dict
+000086f0: 5f67 726f 7570 5f72 6174 6520 3d20 6469  _group_rate = di
+00008700: 6374 2820 736f 7274 6564 2028 0d0a 2020  ct( sorted (..  
+00008710: 2020 2020 2020 6c61 6265 6c5f 6469 6374        label_dict
+00008720: 5f67 726f 7570 5f72 6174 652e 6974 656d  _group_rate.item
+00008730: 7328 2920 2c0d 0a20 2020 2020 2020 206b  s() ,..        k
+00008740: 6579 3d6c 616d 6264 6120 783a 785b 315d  ey=lambda x:x[1]
+00008750: 2c20 7265 7665 7273 6520 3d54 7275 6520  , reverse =True 
+00008760: 290d 0a20 2020 2020 2020 2029 200d 0a20  )..        ) .. 
+00008770: 2020 200d 0a20 2020 2072 6574 7572 6e20     ..    return 
+00008780: 6c61 6265 6c5f 6469 6374 5f67 726f 7570  label_dict_group
+00008790: 5f72 6174 650d 0a20 0d0a 0d0a 6465 6620  _rate.. ....def 
+000087a0: 6669 6e64 5f73 696d 696c 6172 5f6c 6162  find_similar_lab
+000087b0: 656c 7320 2820 0d0a 2020 2020 795f 7472  els ( ..    y_tr
+000087c0: 7565 2c20 0d0a 2020 2020 795f 7072 6564  ue, ..    y_pred
+000087d0: 2c20 200d 0a20 2020 202a 2c20 0d0a 2020  ,  ..    *, ..  
+000087e0: 2020 6361 7465 676f 7269 7a65 5f6b 3a62    categorize_k:b
+000087f0: 6f6f 6c3d 4661 6c73 652c 200d 0a20 2020  ool=False, ..   
+00008800: 2074 6872 6573 686f 6c64 3a20 666c 6f61   threshold: floa
+00008810: 743d 4e6f 6e65 2c20 0d0a 2020 2020 6675  t=None, ..    fu
+00008820: 6e63 3a20 6361 6c6c 6162 6c65 3d4e 6f6e  nc: callable=Non
+00008830: 652c 200d 0a20 2020 206b 6565 705f 6c61  e, ..    keep_la
+00008840: 6265 6c5f 3020 3a62 6f6f 6c3d 4661 6c73  bel_0 :bool=Fals
+00008850: 652c 200d 0a20 2020 206d 6574 686f 643a  e, ..    method:
+00008860: 7374 723d 276e 6169 7665 272c 200d 0a20  str='naive', .. 
+00008870: 2020 2072 6574 7572 6e5f 6772 6f75 7073     return_groups
+00008880: 3a62 6f6f 6c3d 4661 6c73 652c 200d 0a20  :bool=False, .. 
+00008890: 2020 202a 2a6b 7764 0d0a 2020 2020 2020     **kwd..      
+000088a0: 2020 293a 0d0a 2020 2020 2222 2246 696e    ):..    """Fin
+000088b0: 6420 7369 6d69 6c61 7269 7469 6573 2062  d similarities b
+000088c0: 6574 7765 656e 2079 5f74 7275 6520 616e  etween y_true an
+000088d0: 6420 795f 7072 6564 2061 6e64 2072 6574  d y_pred and ret
+000088e0: 7572 6e73 2072 6174 6520 0d0a 2020 2020  urns rate ..    
+000088f0: 0d0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00008900: 200d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d   ..    ---------
+00008910: 2d2d 0d0a 2020 2020 795f 7472 7565 3a20  --..    y_true: 
+00008920: 6172 7261 792d 6c69 6b65 2031 6420 6f72  array-like 1d or
+00008930: 2070 616e 6461 732e 5365 7269 6573 200d   pandas.Series .
+00008940: 0a20 2020 2020 2020 2041 7272 6179 2063  .        Array c
+00008950: 6f6e 7461 696e 696e 6720 7468 6520 7472  ontaining the tr
+00008960: 7565 206c 6162 656c 7320 6f66 2027 6b27  ue labels of 'k'
+00008970: 200d 0a20 2020 2079 5f70 7265 643a 2061   ..    y_pred: a
+00008980: 7272 6179 5f6c 696b 652c 206f 7220 7061  rray_like, or pa
+00008990: 6e64 6173 2e53 6572 6965 730d 0a20 2020  ndas.Series..   
+000089a0: 2020 2020 2061 7272 6179 2063 6f6e 7461       array conta
+000089b0: 696e 696e 6720 7468 6520 7072 6564 6963  ining the predic
+000089c0: 7465 6420 6e61 6976 6520 6772 6f75 7020  ted naive group 
+000089d0: 6f66 2061 7175 6966 6572 7320 284e 4741  of aquifers (NGA
+000089e0: 2920 200d 0a20 2020 2020 2020 200d 0a20  )  ..        .. 
+000089f0: 2020 2063 6174 6567 6f72 697a 655f 6b3a     categorize_k:
+00008a00: 2062 6f6f 6c2c 200d 0a20 2020 2020 2020   bool, ..       
+00008a10: 2049 6620 7365 7420 746f 2060 6054 7275   If set to ``Tru
+00008a20: 6560 602c 2075 7365 7220 6e65 6564 7320  e``, user needs 
+00008a30: 746f 2070 726f 7669 6465 2061 2066 756e  to provide a fun
+00008a40: 6374 696f 6e20 6075 6675 6e63 6020 746f  ction `ufunc` to
+00008a50: 206d 6170 200d 0a20 2020 2020 2020 206f   map ..        o
+00008a60: 7220 6361 7465 676f 7269 7a65 2074 6865  r categorize the
+00008a70: 2070 6572 6d65 6162 696c 6974 7920 636f   permeability co
+00008a80: 6566 6669 6369 656e 7420 276b 2720 696e  efficient 'k' in
+00008a90: 746f 2061 6e20 696e 7465 6765 7220 0d0a  to an integer ..
+00008aa0: 2020 2020 2020 2020 6c61 6265 6c73 2e20          labels. 
+00008ab0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00008ac0: 6675 6e63 3a20 6361 6c6c 6162 6c65 200d  func: callable .
+00008ad0: 0a20 2020 2020 2020 4675 6e63 7469 6f6e  .       Function
+00008ae0: 2074 6f20 7370 6563 6966 6963 616c 6c79   to specifically
+00008af0: 206d 6170 2074 6865 2070 6572 6d65 6162   map the permeab
+00008b00: 696c 6974 7920 636f 6566 6669 6369 656e  ility coefficien
+00008b10: 7420 636f 6c75 6d6e 200d 0a20 2020 2020  t column ..     
+00008b20: 2020 696e 2074 6865 2064 6174 6166 7261    in the datafra
+00008b30: 6d65 206f 6620 7365 7269 652e 2049 6620  me of serie. If 
+00008b40: 6e6f 7420 6769 7665 6e2c 2074 6865 2064  not given, the d
+00008b50: 6566 6175 6c74 2066 756e 6374 696f 6e20  efault function 
+00008b60: 6361 6e20 6265 200d 0a20 2020 2020 2020  can be ..       
+00008b70: 656e 6162 6c65 6420 696e 7374 6561 6420  enabled instead 
+00008b80: 6672 6f6d 2070 6172 616d 2060 6465 6661  from param `defa
+00008b90: 756c 745f 6675 6e63 602e 2020 2020 200d  ult_func`.     .
+00008ba0: 0a20 2020 2020 2020 200d 0a20 2020 2074  .        ..    t
+00008bb0: 6872 6573 686f 6c64 3a20 666c 6f61 742c  hreshold: float,
+00008bc0: 2064 6566 6175 6c74 3d4e 6f6e 6520 0d0a   default=None ..
+00008bd0: 2020 2020 2020 2020 5468 6520 7468 7265          The thre
+00008be0: 7368 6f6c 6420 6672 6f6d 2077 6869 6368  shold from which
+00008bf0: 2c20 6c61 6265 6c20 696e 2027 795f 7472  , label in 'y_tr
+00008c00: 7565 2720 6361 6e20 6265 2063 6f6e 7369  ue' can be consi
+00008c10: 6465 7265 6420 200d 0a20 2020 2020 2020  dered  ..       
+00008c20: 2073 696d 696c 6172 2074 6861 6e20 7468   similar than th
+00008c30: 6520 6f6e 6520 696e 204e 4741 206c 6162  e one in NGA lab
+00008c40: 656c 7320 2779 5f70 7265 6427 2e20 5468  els 'y_pred'. Th
+00008c50: 6520 6465 6661 756c 7420 6973 2027 4e6f  e default is 'No
+00008c60: 6e65 2720 7768 6963 6820 0d0a 2020 2020  ne' which ..    
+00008c70: 2020 2020 6d65 616e 7320 6e6f 6e65 2072      means none r
+00008c80: 756c 6520 6973 2063 6f6e 7369 6465 7265  ule is considere
+00008c90: 6420 616e 6420 7468 6520 6869 6768 2070  d and the high p
+00008ca0: 7265 706f 6e64 6572 656e 6365 206f 7220  reponderence or 
+00008cb0: 6f63 6375 7265 6e63 6520 0d0a 2020 2020  occurence ..    
+00008cc0: 2020 2020 696e 2074 6865 2064 6174 6120      in the data 
+00008cd0: 636f 6d70 6172 6564 2074 6f20 6f74 6865  compared to othe
+00008ce0: 7220 6c61 6265 6c73 2069 7320 636f 6e73  r labels is cons
+00008cf0: 6964 6572 6564 2061 7320 7468 6520 6d6f  idered as the mo
+00008d00: 7374 200d 0a20 2020 2020 2020 2072 6570  st ..        rep
+00008d10: 7265 7365 6e74 6174 6976 6520 2061 6e64  resentative  and
+00008d20: 2073 696d 696c 6172 2e20 5365 7474 696e   similar. Settin
+00008d30: 6720 7468 6520 7275 6c65 2069 6e73 7465  g the rule inste
+00008d40: 6164 2062 7920 6669 7869 6e67 200d 0a20  ad by fixing .. 
+00008d50: 2020 2020 2020 2074 6865 2074 6872 6573         the thres
+00008d60: 686f 6c64 2069 7320 7265 636f 6d6d 656e  hold is recommen
+00008d70: 6465 6420 6573 7065 6369 616c 6c79 2069  ded especially i
+00008d80: 6e20 6120 6875 6765 2064 6174 6173 6574  n a huge dataset
+00008d90: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
+00008da0: 206b 6565 705f 6c61 6265 6c5f 303a 2062   keep_label_0: b
+00008db0: 6f6f 6c2c 2064 6566 6175 6c74 3d30 0d0a  ool, default=0..
+00008dc0: 2020 2020 2020 2020 466f 7263 6520 696e          Force in
+00008dd0: 636c 7564 696e 6720 3020 696e 2074 6865  cluding 0 in the
+00008de0: 2070 7265 6469 6374 6564 206c 6162 656c   predicted label
+00008df0: 2069 6620 2060 696e 636c 7564 655f 6c61   if  `include_la
+00008e00: 6265 6c5f 3060 2069 7320 7365 7420 0d0a  bel_0` is set ..
+00008e10: 2020 2020 2020 2020 746f 2060 6054 7275          to ``Tru
+00008e20: 6560 602e 204d 6f73 746c 7920 6c61 6265  e``. Mostly labe
+00008e30: 6c20 2730 2720 7265 6665 7273 2074 6f20  l '0' refers to 
+00008e40: 276b 3d30 2720 692e 652e 206e 6f20 7065  'k=0' i.e. no pe
+00008e50: 726d 6561 6269 6c69 7479 200d 0a20 2020  rmeability ..   
+00008e60: 2020 2020 2063 6f65 6666 6963 6965 6e74       coefficient
+00008e70: 2065 7175 616c 7320 746f 2030 2c20 7768   equals to 0, wh
+00008e80: 6963 6820 6973 206e 6f74 2054 7275 6520  ich is not True 
+00008e90: 696e 2070 7269 6e63 6970 6c65 2c20 6265  in principle, be
+00008ea0: 6361 7573 6520 616c 6c20 726f 636b 7320  cause all rocks 
+00008eb0: 200d 0a20 2020 2020 2020 2068 6176 6520   ..        have 
+00008ec0: 6120 7065 726d 6561 6269 6c69 7479 2063  a permeability c
+00008ed0: 6f65 6666 6963 6965 6e74 2027 6b27 2e20  oefficient 'k'. 
+00008ee0: 4865 7265 2077 6520 636f 6e73 6964 6572  Here we consider
+00008ef0: 6564 2027 6b3d 3027 2061 7320 616e 2075  ed 'k=0' as an u
+00008f00: 6e64 6566 696e 6564 200d 0a20 2020 2020  ndefined ..     
+00008f10: 2020 2070 6572 6d65 6162 696c 6974 7920     permeability 
+00008f20: 636f 6566 6669 6369 656e 742e 2054 6865  coefficient. The
+00008f30: 7265 666f 7265 2c20 2730 2720 2c20 6361  refore, '0' , ca
+00008f40: 6e20 6265 2065 7863 6c75 6465 2073 696e  n be exclude sin
+00008f50: 6365 2c20 6974 2063 616e 200d 0a20 2020  ce, it can ..   
+00008f60: 2020 2020 2061 6c73 6f20 636f 6e73 6964       also consid
+00008f70: 6572 6564 2061 7320 6120 6d69 7373 696e  ered as a missin
+00008f80: 6720 276b 272d 7661 6c75 652e 2049 6620  g 'k'-value. If 
+00008f90: 7072 6564 6963 7465 6420 2730 2720 6973  predicted '0' is
+00008fa0: 2069 6e20 7468 6520 7461 7267 6574 200d   in the target .
+00008fb0: 0a20 2020 2020 2020 2069 7420 7368 6f75  .        it shou
+00008fc0: 6c64 206d 6561 6e20 6120 6d69 7373 696e  ld mean a missin
+00008fd0: 6720 276b 272d 7661 6c75 6520 7261 7468  g 'k'-value rath
+00008fe0: 6572 2074 6861 6e20 6265 696e 6720 6120  er than being a 
+00008ff0: 636f 6e63 7265 7465 206c 6162 656c 2e20  concrete label. 
+00009000: 200d 0a20 2020 2020 2020 2054 6865 7265   ..        There
+00009010: 666f 7265 2c20 746f 2061 766f 6964 2061  fore, to avoid a
+00009020: 6e79 2063 6f6e 6675 7369 6f6e 2c20 2730  ny confusion, '0
+00009030: 2720 6973 2072 656d 6f76 6564 2062 7920  ' is removed by 
+00009040: 6465 6661 756c 7420 696e 2074 6865 2027  default in the '
+00009050: 6b27 0d0a 2020 2020 2020 2020 6361 7465  k'..        cate
+00009060: 676f 7269 7a61 7469 6f6e 2e20 486f 7765  gorization. Howe
+00009070: 7665 722c 2077 6865 6e20 7468 6520 7072  ver, when the pr
+00009080: 6564 6963 7469 6f6e 2027 795f 7072 6564  ediction 'y_pred
+00009090: 2720 6973 206d 6164 6520 6672 6f6d 2074  ' is made from t
+000090a0: 6865 200d 0a20 2020 2020 2020 2074 6865  he ..        the
+000090b0: 2075 6e73 7570 6572 7669 7369 6e67 206d   unsupervising m
+000090c0: 6574 686f 642c 2074 6865 2070 7265 6469  ethod, the predi
+000090d0: 6374 696f 6e20 2730 2720 7374 7261 6967  ction '0' straig
+000090e0: 7468 666f 7277 6172 646c 7920 696e 636c  thforwardly incl
+000090f0: 7564 6573 0d0a 2020 2020 2020 2020 2027  udes..         '
+00009100: 3027 2069 2e65 2027 6b3d 3027 2061 7320  0' i.e 'k=0' as 
+00009110: 6120 6669 7273 7420 636c 6173 732e 2053  a first class. S
+00009120: 6f20 7468 6520 7661 6c75 6520 602b 3160  o the value `+1`
+00009130: 2069 7320 7573 6564 2074 6f20 6d6f 7665   is used to move
+00009140: 2066 6f72 7761 7264 200d 0a20 2020 2020   forward ..     
+00009150: 2020 2061 6c6c 2063 6c61 7373 206c 6162     all class lab
+00009160: 656c 7320 7468 6572 6562 7920 6578 636c  els thereby excl
+00009170: 7564 696e 6720 7468 6520 2730 2720 6c61  uding the '0' la
+00009180: 6265 6c2e 2054 6f20 666f 7263 6520 696e  bel. To force in
+00009190: 636c 7564 6520 3020 0d0a 2020 2020 2020  clude 0 ..      
+000091a0: 2020 696e 2074 6865 206c 6162 656c 2c20    in the label, 
+000091b0: 7365 7420 6069 6e63 6c75 6465 5f6c 6162  set `include_lab
+000091c0: 656c 5f30 6020 746f 2060 6054 7275 6560  el_0` to ``True`
+000091d0: 602e 200d 0a20 2020 2020 2020 200d 0a20  `. ..        .. 
+000091e0: 2020 206d 6574 686f 643a 2073 7472 205b     method: str [
+000091f0: 276e 6169 7665 272c 2027 7374 7269 6374  'naive', 'strict
+00009200: 275d 2c20 6465 6661 756c 743d 276e 6169  '], default='nai
+00009210: 7665 270d 0a20 2020 2020 2020 2054 6865  ve'..        The
+00009220: 206b 696e 6420 6f66 2073 7472 6174 6567   kind of strateg
+00009230: 7920 746f 2063 6f6d 7075 7465 2074 6865  y to compute the
+00009240: 2072 6570 7265 7365 6e74 6174 6976 6974   representativit
+00009250: 7920 6f66 2061 206c 6162 656c 200d 0a20  y of a label .. 
+00009260: 2020 2020 2020 2069 6e20 7468 6520 7072         in the pr
+00009270: 6564 6963 7465 6420 6172 7261 7920 2779  edicted array 'y
+00009280: 5f70 7265 6427 2e20 4974 2063 616e 2061  _pred'. It can a
+00009290: 6c73 6f20 6265 2027 7374 7269 6374 272e  lso be 'strict'.
+000092a0: 2049 6e64 6565 643a 0d0a 2020 2020 2020   Indeed:..      
+000092b0: 2020 0d0a 2020 2020 2020 2020 2d20 6060    ..        - ``
+000092c0: 6e61 6976 6560 6020 636f 6d70 7574 6573  naive`` computes
+000092d0: 2074 6865 2069 6d70 6f72 7461 6e63 6520   the importance 
+000092e0: 6f66 2074 6865 206c 6162 656c 2062 7920  of the label by 
+000092f0: 7468 6520 6e75 6d62 6572 206f 6620 6974  the number of it
+00009300: 730d 0a20 2020 2020 2020 2020 2020 206f  s..            o
+00009310: 6363 7572 656e 6365 2066 6f72 2074 6869  ccurence for thi
+00009320: 7320 7370 6563 6966 6963 206c 6162 656c  s specific label
+00009330: 2069 6e20 7468 6520 6172 7261 7920 2779   in the array 'y
+00009340: 5f74 7275 6527 2e20 4974 2064 6f65 7320  _true'. It does 
+00009350: 6e6f 7420 0d0a 2020 2020 2020 2020 2020  not ..          
+00009360: 2020 7461 6b65 2069 6e74 6f20 6163 636f    take into acco
+00009370: 756e 7420 6f66 2074 6865 206f 6363 7572  unt of the occur
+00009380: 656e 6365 206f 6620 6f74 6865 7220 6578  ence of other ex
+00009390: 6973 7469 6e67 206c 6162 656c 732e 2054  isting labels. T
+000093a0: 6869 7320 0d0a 2020 2020 2020 2020 2020  his ..          
+000093b0: 2020 6973 2075 7365 6675 6c6c 2066 6f72    is usefull for
+000093c0: 2075 6e62 616c 616e 6365 6420 636c 6173   unbalanced clas
+000093d0: 7320 6c61 6265 6c73 2069 6e20 6079 5f74  s labels in `y_t
+000093e0: 7275 6560 2e0d 0a20 2020 2020 2020 202d  rue`...        -
+000093f0: 2060 6073 7472 6963 7460 6020 636f 6d70   ``strict`` comp
+00009400: 7574 6573 2074 6865 2069 6d70 6f72 7461  utes the importa
+00009410: 6e63 6520 6f66 2074 6865 206c 6162 656c  nce of the label
+00009420: 2062 7920 7468 6520 6e75 6d62 6572 206f   by the number o
+00009430: 6620 0d0a 2020 2020 2020 2020 2020 2020  f ..            
+00009440: 6f63 6375 7265 6e63 6520 696e 2074 6865  occurence in the
+00009450: 2077 686f 6c65 2076 616c 6964 2060 795f   whole valid `y_
+00009460: 7472 7565 6020 692e 652e 2075 6e64 6572  true` i.e. under
+00009470: 2074 6865 2074 6f74 616c 206f 6620 0d0a   the total of ..
+00009480: 2020 2020 2020 2020 2020 2020 6f63 6375              occu
+00009490: 7265 6e63 6520 6f66 2061 6c6c 2074 6865  rence of all the
+000094a0: 206c 6162 656c 7320 7468 6174 2065 7869   labels that exi
+000094b0: 7374 2069 6e20 7468 6520 7768 6f6c 6520  st in the whole 
+000094c0: 2761 7272 615f 6171 272e 200d 0a20 2020  'arra_aq'. ..   
+000094d0: 2020 2020 2020 2020 2054 6869 7320 6361           This ca
+000094e0: 6e20 6769 7665 2061 2073 7569 7461 626c  n give a suitabl
+000094f0: 6520 616e 6179 6c73 6520 7265 7375 6c74  e anaylse result
+00009500: 7320 6966 2074 6865 2064 6174 6120 6973  s if the data is
+00009510: 206e 6f74 200d 0a20 2020 2020 2020 2020   not ..         
+00009520: 2020 2075 6e62 616c 616e 6365 6420 666f     unbalanced fo
+00009530: 7220 6561 6368 206c 6162 656c 7320 696e  r each labels in
+00009540: 2060 795f 7072 6564 602e 0d0a 2020 2020   `y_pred`...    
+00009550: 2020 2020 2020 2020 0d0a 2020 2020 7265          ..    re
+00009560: 7475 726e 5f67 726f 7570 733a 2062 6f6f  turn_groups: boo
+00009570: 6c2c 2064 6566 6175 6c74 3d46 616c 7365  l, default=False
+00009580: 200d 0a20 2020 2020 2020 2052 6574 7572   ..        Retur
+00009590: 6e73 206c 6162 656c 2067 726f 7570 7320  ns label groups 
+000095a0: 616e 6420 7468 6569 7220 7661 6c75 6573  and their values
+000095b0: 2063 6f75 6e74 7320 696e 2074 6865 2070   counts in the p
+000095c0: 7265 6469 6374 6564 200d 0a20 2020 2020  redicted ..     
+000095d0: 2020 206c 6162 656c 7320 6079 5f70 7265     labels `y_pre
+000095e0: 6460 2020 7768 6572 6520 276b 2720 7661  d`  where 'k' va
+000095f0: 6c75 6573 2061 7265 206e 6f74 206d 6973  lues are not mis
+00009600: 7369 6e67 2e20 0d0a 2020 2020 0d0a 2020  sing. ..    ..  
+00009610: 2020 5265 7475 726e 7320 0d0a 2020 2020    Returns ..    
+00009620: 2d2d 2d2d 2d2d 2d2d 2d20 0d0a 2020 2020  --------- ..    
+00009630: 672e 7369 6d69 6c61 7269 7479 203a 2054  g.similarity : T
+00009640: 7570 6c65 206f 6620 206c 6162 656c 7320  uple of  labels 
+00009650: 666f 756e 6420 7468 6174 2061 7265 2063  found that are c
+00009660: 6f6e 7369 6465 7265 6420 7369 6d69 6c61  onsidered simila
+00009670: 7220 696e 200d 0a20 2020 2020 2020 2070  r in ..        p
+00009680: 7265 6469 6374 6564 206c 6162 656c 732e  redicted labels.
+00009690: 200d 0a20 2020 2067 2e67 726f 7570 3a20   ..    g.group: 
+000096a0: 5475 706c 6520 6f66 2067 726f 7570 2074  Tuple of group t
+000096b0: 6861 7420 6861 7665 2074 6865 6972 2073  hat have their s
+000096c0: 696d 696c 6172 6974 7920 696e 2074 6865  imilarity in the
+000096d0: 2074 7275 6520 6c61 6265 6c73 200d 0a20   true labels .. 
+000096e0: 2020 200d 0a20 2020 2045 7861 6d70 6c65     ..    Example
+000096f0: 200d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d   ..    ---------
+00009700: 2d0d 0a20 2020 203e 3e3e 2066 726f 6d20  -..    >>> from 
+00009710: 7761 7465 782e 7574 696c 7320 696d 706f  watex.utils impo
+00009720: 7274 2072 6561 645f 6461 7461 200d 0a20  rt read_data .. 
+00009730: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
+00009740: 782e 7574 696c 732e 6879 6472 6f75 7469  x.utils.hydrouti
+00009750: 6c73 2069 6d70 6f72 7420 6669 6e64 5f73  ls import find_s
+00009760: 696d 696c 6172 5f6c 6162 656c 732c 2063  imilar_labels, c
+00009770: 6c61 7373 6966 795f 6b0d 0a20 2020 203e  lassify_k..    >
+00009780: 3e3e 2064 6174 6120 3d20 7265 6164 5f64  >> data = read_d
+00009790: 6174 6120 2827 6461 7461 2f62 6f72 6568  ata ('data/boreh
+000097a0: 6f6c 6573 2f68 662e 6373 7627 290d 0a20  oles/hf.csv').. 
+000097b0: 2020 203e 3e3e 2079 6d61 7020 3d20 636c     >>> ymap = cl
+000097c0: 6173 7369 6679 5f6b 2864 6174 612e 6b20  assify_k(data.k 
+000097d0: 2c20 6465 6661 756c 745f 6675 6e63 203d  , default_func =
+000097e0: 5472 7565 2920 0d0a 2020 2020 3e3e 3e20  True) ..    >>> 
+000097f0: 2320 4e6f 7465 2074 6861 7420 666f 7220  # Note that for 
+00009800: 7468 6520 6465 6d6f 2077 6520 7573 6520  the demo we use 
+00009810: 7468 6520 6772 6f75 7020 6f66 2061 7175  the group of aqu
+00009820: 6966 6572 2063 6f6c 756d 6e73 2c20 686f  ifer columns, ho
+00009830: 7765 7665 720d 0a20 2020 203e 3e3e 2023  wever..    >>> #
+00009840: 2069 6e20 7072 6174 6963 616c 2065 7861   in pratical exa
+00009850: 6d70 6c65 2c20 795f 7072 6564 206d 7573  mple, y_pred mus
+00009860: 7420 6265 2061 2070 7265 6469 6374 6564  t be a predicted
+00009870: 204e 4741 206c 6162 656c 732e 2054 6869   NGA labels. Thi
+00009880: 7320 0d0a 2020 2020 3e3e 3e20 2320 6973  s ..    >>> # is
+00009890: 2070 6f73 7369 626c 6520 7573 696e 6720   possible using 
+000098a0: 7468 6520 6675 6e63 7469 6f6e 203c 7072  the function <pr
+000098b0: 6564 6963 745f 4e47 415f 6c61 6265 6c73  edict_NGA_labels
+000098c0: 3e20 0d0a 2020 2020 3e3e 3e20 7369 6d20  > ..    >>> sim 
+000098d0: 3d20 6669 6e64 5f73 696d 696c 6172 5f6c  = find_similar_l
+000098e0: 6162 656c 7328 795f 7472 7565 3d20 796d  abels(y_true= ym
+000098f0: 6170 2c20 795f 7072 6564 3d64 6174 612e  ap, y_pred=data.
+00009900: 6171 7569 6665 725f 6772 6f75 7029 0d0a  aquifer_group)..
+00009910: 2020 2020 3e3e 3e20 7369 6d20 0d0a 2020      >>> sim ..  
+00009920: 2020 2e2e 2e20 2828 312c 2027 5627 292c    ... ((1, 'V'),
+00009930: 2028 322c 2027 4949 4927 292c 2028 332c   (2, 'III'), (3,
+00009940: 2027 5627 2929 0d0a 2020 2020 3e3e 3e20   'V'))..    >>> 
+00009950: 6772 6f75 703d 2066 696e 645f 7369 6d69  group= find_simi
+00009960: 6c61 725f 6c61 6265 6c73 2879 6d61 702c  lar_labels(ymap,
+00009970: 2064 6174 612e 6171 7569 6665 725f 6772   data.aquifer_gr
+00009980: 6f75 702c 2072 6574 7572 6e5f 6772 6f75  oup, return_grou
+00009990: 7073 3d54 7275 6529 200d 0a20 2020 203e  ps=True) ..    >
+000099a0: 3e3e 2067 726f 7570 200d 0a20 2020 202e  >> group ..    .
+000099b0: 2e2e 2028 2831 2c0d 0a20 2020 2020 207b  .. ((1,..      {
+000099c0: 2756 273a 2030 2e31 372c 0d0a 2020 2020  'V': 0.17,..    
+000099d0: 2020 2027 4956 273a 2030 2e31 3431 2c0d     'IV': 0.141,.
+000099e0: 0a20 2020 2020 2020 2749 4927 3a20 302e  .       'II': 0.
+000099f0: 3132 362c 0d0a 2020 2020 2020 2027 4949  126,..       'II
+00009a00: 4927 3a20 302e 3038 342c 0d0a 2020 2020  I': 0.084,..    
+00009a10: 2020 2027 4956 2656 273a 2030 2e30 3035     'IV&V': 0.005
+00009a20: 2c0d 0a20 2020 2020 2020 2749 4926 4949  ,..       'II&II
+00009a30: 4927 3a20 302e 3030 332c 0d0a 2020 2020  I': 0.003,..    
+00009a40: 2020 2027 4949 4926 4956 273a 2030 2e30     'III&IV': 0.0
+00009a50: 3033 7d29 2c0d 0a20 2020 2020 2832 2c20  03}),..     (2, 
+00009a60: 7b27 4949 4927 3a20 302e 3035 322c 2027  {'III': 0.052, '
+00009a70: 4949 273a 2030 2e30 352c 2027 5627 3a20  II': 0.05, 'V': 
+00009a80: 302e 3035 2c20 2749 5627 3a20 302e 3033  0.05, 'IV': 0.03
+00009a90: 342c 2027 4949 4926 4956 273a 2030 2e30  4, 'III&IV': 0.0
+00009aa0: 3035 7d29 2c0d 0a20 2020 2020 2833 2c20  05}),..     (3, 
+00009ab0: 7b27 5627 3a20 302e 3132 332c 2027 4956  {'V': 0.123, 'IV
+00009ac0: 273a 2030 2e30 3836 2c20 2749 4949 273a  ': 0.086, 'III':
+00009ad0: 2030 2e30 3638 7d29 290d 0a20 2020 203e   0.068}))..    >
+00009ae0: 3e3e 2066 696e 645f 7369 6d69 6c61 725f  >> find_similar_
+00009af0: 6c61 6265 6c73 2879 5f74 7275 653d 2079  labels(y_true= y
+00009b00: 6d61 702c 2079 5f70 7265 643d 6461 7461  map, y_pred=data
+00009b10: 2e61 7175 6966 6572 5f67 726f 7570 2c0d  .aquifer_group,.
+00009b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00009b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b40: 2020 2020 2020 2074 6872 6573 686f 6c64         threshold
-00009b50: 203d 2030 2e31 3529 200d 0a20 2020 202e   = 0.15) ..    .
-00009b60: 2e2e 205b 2831 2c20 2756 2729 5d0d 0a20  .. [(1, 'V')].. 
-00009b70: 2020 200d 0a20 2020 2022 2222 0d0a 2020     ..    """..  
-00009b80: 2020 5b20 205f 6173 7365 7274 5f61 6c6c    [  _assert_all
-00009b90: 5f74 7970 6573 286f 2c20 7064 2e53 6572  _types(o, pd.Ser
-00009ba0: 6965 732c 206e 702e 6e64 6172 7261 792c  ies, np.ndarray,
-00009bb0: 206f 626a 6e61 6d65 203d 206c 6162 2920   objname = lab) 
-00009bc0: 0d0a 2020 2020 2020 2020 2066 6f72 206c  ..         for l
-00009bd0: 6162 2c20 6f20 2069 6e20 7a69 7020 280d  ab, o  in zip (.
-00009be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009bf0: 2020 5b22 2779 5f74 7275 6527 2874 7275    ["'y_true'(tru
-00009c00: 6520 6c61 6265 6c73 2922 2c20 2227 795f  e labels)", "'y_
-00009c10: 7072 6564 2027 2820 7072 6564 6963 7465  pred '( predicte
-00009c20: 6420 6c61 6265 6c73 2029 2722 5d2c 200d  d labels )'"], .
-00009c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009c40: 2020 5b79 5f74 7275 652c 2079 5f70 7265    [y_true, y_pre
-00009c50: 645d 2920 0d0a 2020 2020 5d0d 0a0d 0a20  d]) ..    ].... 
-00009c60: 2020 205f 6368 6563 6b5f 636f 6e73 6973     _check_consis
-00009c70: 7465 6e63 795f 7369 7a65 2879 5f74 7275  tency_size(y_tru
-00009c80: 652c 2079 5f70 7265 6429 200d 0a20 2020  e, y_pred) ..   
-00009c90: 2069 6620 6e6f 7420 616c 6c20 285b 205f   if not all ([ _
-00009ca0: 6973 5f61 7272 6179 6c69 6b65 5f31 6428  is_arraylike_1d(
-00009cb0: 6172 2029 2066 6f72 2061 7220 696e 2028  ar ) for ar in (
-00009cc0: 795f 7472 7565 2c20 795f 7072 6564 2029  y_true, y_pred )
-00009cd0: 5d20 2920 3a0d 0a20 2020 2020 2020 2072  ] ) :..        r
-00009ce0: 6169 7365 2054 7970 6545 7272 6f72 2028  aise TypeError (
-00009cf0: 2254 7275 6520 616e 6420 7072 6564 6963  "True and predic
-00009d00: 7465 6420 6c61 6265 6c73 2073 7570 706f  ted labels suppo
-00009d10: 7274 7320 6f6e 6c79 2022 0d0a 2020 2020  rts only "..    
+00009b40: 2020 2074 6872 6573 686f 6c64 203d 2030     threshold = 0
+00009b50: 2e31 3529 200d 0a20 2020 202e 2e2e 205b  .15) ..    ... [
+00009b60: 2831 2c20 2756 2729 5d0d 0a20 2020 200d  (1, 'V')]..    .
+00009b70: 0a20 2020 2022 2222 0d0a 2020 2020 5b20  .    """..    [ 
+00009b80: 205f 6173 7365 7274 5f61 6c6c 5f74 7970   _assert_all_typ
+00009b90: 6573 286f 2c20 7064 2e53 6572 6965 732c  es(o, pd.Series,
+00009ba0: 206e 702e 6e64 6172 7261 792c 206f 626a   np.ndarray, obj
+00009bb0: 6e61 6d65 203d 206c 6162 2920 0d0a 2020  name = lab) ..  
+00009bc0: 2020 2020 2020 2066 6f72 206c 6162 2c20         for lab, 
+00009bd0: 6f20 2069 6e20 7a69 7020 280d 0a20 2020  o  in zip (..   
+00009be0: 2020 2020 2020 2020 2020 2020 2020 5b22                ["
+00009bf0: 2779 5f74 7275 6527 2874 7275 6520 6c61  'y_true'(true la
+00009c00: 6265 6c73 2922 2c20 2227 795f 7072 6564  bels)", "'y_pred
+00009c10: 2027 2820 7072 6564 6963 7465 6420 6c61   '( predicted la
+00009c20: 6265 6c73 2029 2722 5d2c 200d 0a20 2020  bels )'"], ..   
+00009c30: 2020 2020 2020 2020 2020 2020 2020 5b79                [y
+00009c40: 5f74 7275 652c 2079 5f70 7265 645d 2920  _true, y_pred]) 
+00009c50: 0d0a 2020 2020 5d0d 0a0d 0a20 2020 205f  ..    ]....    _
+00009c60: 6368 6563 6b5f 636f 6e73 6973 7465 6e63  check_consistenc
+00009c70: 795f 7369 7a65 2879 5f74 7275 652c 2079  y_size(y_true, y
+00009c80: 5f70 7265 6429 200d 0a20 2020 2069 6620  _pred) ..    if 
+00009c90: 6e6f 7420 616c 6c20 285b 205f 6973 5f61  not all ([ _is_a
+00009ca0: 7272 6179 6c69 6b65 5f31 6428 6172 2029  rraylike_1d(ar )
+00009cb0: 2066 6f72 2061 7220 696e 2028 795f 7472   for ar in (y_tr
+00009cc0: 7565 2c20 795f 7072 6564 2029 5d20 2920  ue, y_pred )] ) 
+00009cd0: 3a0d 0a20 2020 2020 2020 2072 6169 7365  :..        raise
+00009ce0: 2054 7970 6545 7272 6f72 2028 2254 7275   TypeError ("Tru
+00009cf0: 6520 616e 6420 7072 6564 6963 7465 6420  e and predicted 
+00009d00: 6c61 6265 6c73 2073 7570 706f 7274 7320  labels supports 
+00009d10: 6f6e 6c79 2022 0d0a 2020 2020 2020 2020  only "..        
 00009d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d30: 2020 2020 2022 6f6e 652d 6469 6d65 6e73       "one-dimens
-00009d40: 696f 6e61 6c20 6172 7261 792e 2229 0d0a  ional array.")..
-00009d50: 2020 2020 2320 6368 6563 6b20 6172 7261      # check arra
-00009d60: 7973 2066 6f72 2063 6f6e 7369 7374 656e  ys for consisten
-00009d70: 6379 0d0a 2020 2020 795f 7472 7565 203d  cy..    y_true =
-00009d80: 2063 6865 636b 5f79 2028 0d0a 2020 2020   check_y (..    
-00009d90: 2020 2020 795f 7472 7565 2c20 0d0a 2020      y_true, ..  
-00009da0: 2020 2020 2020 616c 6c6f 775f 6e61 6e3d        allow_nan=
-00009db0: 2054 7275 652c 200d 0a20 2020 2020 2020   True, ..       
-00009dc0: 2074 6f5f 6672 616d 6520 3d54 7275 652c   to_frame =True,
-00009dd0: 200d 0a20 2020 2020 2020 2069 6e70 7574   ..        input
-00009de0: 5f6e 616d 653d 2279 5f74 7275 6522 2c0d  _name="y_true",.
-00009df0: 0a20 2020 2020 2020 2029 2020 0d0a 0d0a  .        )  ....
-00009e00: 2020 2020 795f 7072 6564 203d 2063 6865      y_pred = che
-00009e10: 636b 5f79 2028 0d0a 2020 2020 2020 2020  ck_y (..        
-00009e20: 795f 7072 6564 2c20 0d0a 2020 2020 2020  y_pred, ..      
-00009e30: 2020 746f 5f66 7261 6d65 203d 2054 7275    to_frame = Tru
-00009e40: 652c 200d 0a20 2020 2020 2020 2061 6c6c  e, ..        all
-00009e50: 6f77 5f6e 616e 3d20 4661 6c73 652c 200d  ow_nan= False, .
-00009e60: 0a20 2020 2020 2020 2069 6e70 7574 5f6e  .        input_n
-00009e70: 616d 6520 3d22 4e47 4120 6c61 6265 6c73  ame ="NGA labels
-00009e80: 220d 0a20 2020 2020 2020 2029 0d0a 2020  "..        )..  
-00009e90: 2020 2020 2020 0d0a 2020 2020 6966 2063        ..    if c
-00009ea0: 6174 6567 6f72 697a 655f 6b20 3a20 0d0a  ategorize_k : ..
-00009eb0: 2020 2020 2020 2020 2363 6174 6567 6f72          #categor
-00009ec0: 697a 6520 6b20 6966 2066 756e 6320 6973  ize k if func is
-00009ed0: 2067 6976 656e 2e0d 0a20 2020 2020 2020   given...       
-00009ee0: 2079 5f74 7275 6520 3d20 636c 6173 7369   y_true = classi
-00009ef0: 6679 5f6b 2820 795f 7472 7565 202c 2020  fy_k( y_true ,  
-00009f00: 6675 6e63 3d20 6675 6e63 202c 2020 2a2a  func= func ,  **
-00009f10: 6b77 6429 0d0a 2020 2020 6720 3d20 6669  kwd)..    g = fi
-00009f20: 6e64 5f61 7175 6966 6572 5f67 726f 7570  nd_aquifer_group
-00009f30: 7328 795f 7472 7565 2c20 6172 725f 6171  s(y_true, arr_aq
-00009f40: 3d20 795f 7072 6564 2c6b 6565 705f 6c61  = y_pred,keep_la
-00009f50: 6265 6c5f 303d 206b 6565 705f 6c61 6265  bel_0= keep_labe
-00009f60: 6c5f 302c 0d0a 2020 2020 2020 2020 2020  l_0,..          
-00009f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f80: 2020 6d65 7468 6f64 3d20 6d65 7468 6f64    method= method
-00009f90: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00009fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009fb0: 2920 0d0a 2020 2020 2320 4665 7463 6820  ) ..    # Fetch 
-00009fc0: 7369 6d69 6c61 7269 7479 2061 6363 6f72  similarity accor
-00009fd0: 6469 6e67 2074 6f20 7468 6520 2074 6872  ding to the  thr
-00009fe0: 6573 686f 6c64 200d 0a20 2020 2073 696d  eshold ..    sim
-00009ff0: 6720 3d20 7475 706c 6520 285f 7369 6d69  g = tuple (_simi
-0000a000: 6c61 7269 7479 5f72 756c 6573 2028 206c  larity_rules ( l
-0000a010: 6973 7428 672e 6772 6f75 7073 292c 2074  ist(g.groups), t
-0000a020: 6872 6573 686f 6c64 203d 2074 6872 6573  hreshold = thres
-0000a030: 686f 6c64 2029 0d0a 2020 2020 2020 2020  hold )..        
-0000a040: 2020 2020 2020 2020 2020 2920 0d0a 2020            ) ..  
-0000a050: 2020 7369 6d69 6c61 7269 7469 6573 203d    similarities =
-0000a060: 205b 5d20 6966 206c 656e 2873 696d 6729   [] if len(simg)
-0000a070: 3d3d 3020 656c 7365 205b 0d0a 2020 2020  ==0 else [..    
-0000a080: 2020 2020 286c 6162 656c 2c20 6c69 7374      (label, list
-0000a090: 2876 616c 7565 295b 305d 2920 666f 7220  (value)[0]) for 
-0000a0a0: 6c61 6265 6c2c 2076 616c 7565 2020 696e  label, value  in
-0000a0b0: 2073 696d 6720 5d0d 0a0d 0a20 2020 2072   simg ]....    r
-0000a0c0: 6574 7572 6e20 7369 6d69 6c61 7269 7469  eturn similariti
-0000a0d0: 6573 2020 6966 206e 6f74 2072 6574 7572  es  if not retur
-0000a0e0: 6e5f 6772 6f75 7073 2065 6c73 6520 7475  n_groups else tu
-0000a0f0: 706c 6520 2867 2e67 726f 7570 7320 290d  ple (g.groups ).
-0000a100: 0a0d 0a64 6566 205f 7369 6d69 6c61 7269  ...def _similari
-0000a110: 7479 5f72 756c 6573 2028 6c67 2c20 2074  ty_rules (lg,  t
-0000a120: 6872 6573 686f 6c64 203d 2e35 2029 3a0d  hreshold =.5 ):.
-0000a130: 0a20 2020 2022 2222 2043 6f6e 7369 6465  .    """ Conside
-0000a140: 7273 2074 776f 206c 6162 656c 7320 7369  rs two labels si
-0000a150: 6d69 6c61 7220 6672 6f6d 2074 6865 2074  milar from the t
-0000a160: 6872 6573 686f 6c64 2076 616c 7565 2e20  hreshold value. 
-0000a170: 0d0a 2020 2020 0d0a 2020 2020 3a70 6172  ..    ..    :par
-0000a180: 616d 206c 673a 2064 6963 742c 200d 0a20  am lg: dict, .. 
-0000a190: 2020 2020 2020 2064 6963 7469 6f6e 6e61         dictionna
-0000a1a0: 7279 206f 6620 2074 7570 6c65 2070 6169  ry of  tuple pai
-0000a1b0: 7220 2874 7275 655f 6c61 6265 6c2c 2064  r (true_label, d
-0000a1c0: 6963 7420 6f66 2067 726f 7570 206f 6363  ict of group occ
-0000a1d0: 7572 656e 6365 2920 0d0a 2020 2020 3a70  urence) ..    :p
-0000a1e0: 6172 616d 2074 6872 6573 686f 6c64 3a20  aram threshold: 
-0000a1f0: 666c 6f61 742c 2064 6566 6175 6c74 203d  float, default =
-0000a200: 2e32 3520 0d0a 2020 2020 2020 2020 5468  .25 ..        Th
-0000a210: 6520 7468 7265 7368 6f6c 6420 746f 2063  e threshold to c
-0000a220: 6f6e 7369 6465 7220 7477 6f20 6c61 6265  onsider two labe
-0000a230: 6c20 7369 6d69 6c61 7220 6672 6f6d 2074  l similar from t
-0000a240: 6865 2072 6174 6520 6f66 200d 0a20 2020  he rate of ..   
-0000a250: 2020 2020 2074 6865 6972 206f 6363 7572       their occur
-0000a260: 656e 6365 732e 200d 0a20 2020 203a 7265  ences. ..    :re
-0000a270: 7475 726e 3a20 0d0a 2020 2020 2020 2020  turn: ..        
-0000a280: 2d20 4120 6765 6e65 7261 746f 7220 6f62  - A generator ob
-0000a290: 6a65 6374 2066 726f 6d20 3a66 756e 633a  ject from :func:
-0000a2a0: 605f 7369 6d69 6c61 7269 7479 5f72 756c  `_similarity_rul
-0000a2b0: 6573 600d 0a20 2020 2020 2020 200d 0a20  es`..        .. 
-0000a2c0: 2020 203a 6578 616d 706c 653a 0d0a 2020     :example:..  
-0000a2d0: 2020 3e3e 3e20 6672 6f6d 2077 6174 6578    >>> from watex
-0000a2e0: 2e75 7469 6c73 2e68 7964 726f 7574 696c  .utils.hydroutil
-0000a2f0: 7320 696d 706f 7274 205f 7369 6d69 6c61  s import _simila
-0000a300: 7269 7479 5f72 756c 6573 200d 0a20 2020  rity_rules ..   
-0000a310: 203e 3e3e 2067 726f 7570 7320 3d20 2828   >>> groups = ((
-0000a320: 312c 7b27 5627 3a20 302e 3332 2c27 4956  1,{'V': 0.32,'IV
-0000a330: 273a 2030 2e32 3636 2c27 4949 273a 2030  ': 0.266,'II': 0
-0000a340: 2e32 3336 2c27 4949 4927 3a20 302e 3135  .236,'III': 0.15
-0000a350: 382c 0d0a 2020 2020 2020 2027 4956 2656  8,..       'IV&V
-0000a360: 273a 2030 2e30 312c 2749 4926 4949 4927  ': 0.01,'II&III'
-0000a370: 3a20 302e 3030 352c 2749 4949 2649 5627  : 0.005,'III&IV'
-0000a380: 3a20 302e 3030 357d 292c 0d0a 2020 2020  : 0.005}),..    
-0000a390: 2028 322c 207b 2749 4949 273a 2030 2e32   (2, {'III': 0.2
-0000a3a0: 3734 2c20 2749 4927 3a20 302e 3236 2c20  74, 'II': 0.26, 
-0000a3b0: 2756 273a 2030 2e32 362c 2027 4956 273a  'V': 0.26, 'IV':
-0000a3c0: 2030 2e31 3738 2c20 2749 4949 2649 5627   0.178, 'III&IV'
-0000a3d0: 3a20 302e 3032 377d 292c 0d0a 2020 2020  : 0.027}),..    
-0000a3e0: 2028 332c 207b 2756 273a 2030 2e34 3433   (3, {'V': 0.443
-0000a3f0: 2c20 2749 5627 3a20 302e 3331 312c 2027  , 'IV': 0.311, '
-0000a400: 4949 4927 3a20 302e 3234 357d 2929 0d0a  III': 0.245}))..
-0000a410: 2020 2020 3e3e 3e20 5f73 696d 696c 6172      >>> _similar
-0000a420: 6974 795f 7275 6c65 7320 2867 726f 7570  ity_rules (group
-0000a430: 7320 2c20 7468 7265 7368 6f6c 6420 3d20  s , threshold = 
-0000a440: 2e34 2029 0d0a 2020 2020 2e2e 2e20 203c  .4 )..    ...  <
-0000a450: 6765 6e65 7261 746f 7220 6f62 6a65 6374  generator object
-0000a460: 205f 7369 6d69 6c61 7269 7479 5f72 756c   _similarity_rul
-0000a470: 6573 2e3c 6c6f 6361 6c73 3e2e 3c67 656e  es.<locals>.<gen
-0000a480: 6578 7072 3e20 6174 2030 7830 3030 3030  expr> at 0x00000
-0000a490: 3235 3534 3438 4234 4241 303e 0d0a 2020  255448B4BA0>..  
-0000a4a0: 2020 3e3e 3e20 7475 706c 6520 285f 7369    >>> tuple (_si
-0000a4b0: 6d69 6c61 7269 7479 5f72 756c 6573 2028  milarity_rules (
-0000a4c0: 6772 6f75 7073 202c 2074 6872 6573 686f  groups , thresho
-0000a4d0: 6c64 203d 202e 3420 2929 0d0a 2020 2020  ld = .4 ))..    
-0000a4e0: 2e2e 2e20 2828 332c 207b 2756 273a 2030  ... ((3, {'V': 0
-0000a4f0: 2e34 3433 2c20 2749 5627 3a20 302e 3331  .443, 'IV': 0.31
-0000a500: 312c 2027 4949 4927 3a20 302e 3234 357d  1, 'III': 0.245}
-0000a510: 292c 290d 0a20 2020 2020 2020 200d 0a20  ),)..        .. 
-0000a520: 2020 2022 2222 0d0a 2020 200d 0a20 2020     """..   ..   
-0000a530: 2074 6872 6573 686f 6c64 203d 2074 6872   threshold = thr
-0000a540: 6573 686f 6c64 206f 7220 2e30 0d0a 2020  eshold or .0..  
-0000a550: 2020 6966 2069 7369 6e73 7461 6e63 6520    if isinstance 
-0000a560: 2874 6872 6573 686f 6c64 2c20 7374 7229  (threshold, str)
-0000a570: 3a20 0d0a 2020 2020 2020 2020 7472 7920  : ..        try 
-0000a580: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0000a590: 7468 7265 7368 6f6c 6420 3d20 666c 6f61  threshold = floa
-0000a5a0: 7428 7468 7265 7368 6f6c 642e 7265 706c  t(threshold.repl
-0000a5b0: 6163 6528 2225 222c 2027 2729 0d0a 2020  ace("%", '')..  
+00009d30: 2022 6f6e 652d 6469 6d65 6e73 696f 6e61   "one-dimensiona
+00009d40: 6c20 6172 7261 792e 2229 0d0a 2020 2020  l array.")..    
+00009d50: 2320 6368 6563 6b20 6172 7261 7973 2066  # check arrays f
+00009d60: 6f72 2063 6f6e 7369 7374 656e 6379 0d0a  or consistency..
+00009d70: 2020 2020 795f 7472 7565 203d 2063 6865      y_true = che
+00009d80: 636b 5f79 2028 0d0a 2020 2020 2020 2020  ck_y (..        
+00009d90: 795f 7472 7565 2c20 0d0a 2020 2020 2020  y_true, ..      
+00009da0: 2020 616c 6c6f 775f 6e61 6e3d 2054 7275    allow_nan= Tru
+00009db0: 652c 200d 0a20 2020 2020 2020 2074 6f5f  e, ..        to_
+00009dc0: 6672 616d 6520 3d54 7275 652c 200d 0a20  frame =True, .. 
+00009dd0: 2020 2020 2020 2069 6e70 7574 5f6e 616d         input_nam
+00009de0: 653d 2279 5f74 7275 6522 2c0d 0a20 2020  e="y_true",..   
+00009df0: 2020 2020 2029 2020 0d0a 0d0a 2020 2020       )  ....    
+00009e00: 795f 7072 6564 203d 2063 6865 636b 5f79  y_pred = check_y
+00009e10: 2028 0d0a 2020 2020 2020 2020 795f 7072   (..        y_pr
+00009e20: 6564 2c20 0d0a 2020 2020 2020 2020 746f  ed, ..        to
+00009e30: 5f66 7261 6d65 203d 2054 7275 652c 200d  _frame = True, .
+00009e40: 0a20 2020 2020 2020 2061 6c6c 6f77 5f6e  .        allow_n
+00009e50: 616e 3d20 4661 6c73 652c 200d 0a20 2020  an= False, ..   
+00009e60: 2020 2020 2069 6e70 7574 5f6e 616d 6520       input_name 
+00009e70: 3d22 4e47 4120 6c61 6265 6c73 220d 0a20  ="NGA labels".. 
+00009e80: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+00009e90: 2020 0d0a 2020 2020 6966 2063 6174 6567    ..    if categ
+00009ea0: 6f72 697a 655f 6b20 3a20 0d0a 2020 2020  orize_k : ..    
+00009eb0: 2020 2020 2363 6174 6567 6f72 697a 6520      #categorize 
+00009ec0: 6b20 6966 2066 756e 6320 6973 2067 6976  k if func is giv
+00009ed0: 656e 2e0d 0a20 2020 2020 2020 2079 5f74  en...        y_t
+00009ee0: 7275 6520 3d20 636c 6173 7369 6679 5f6b  rue = classify_k
+00009ef0: 2820 795f 7472 7565 202c 2020 6675 6e63  ( y_true ,  func
+00009f00: 3d20 6675 6e63 202c 2020 2a2a 6b77 6429  = func ,  **kwd)
+00009f10: 0d0a 2020 2020 6720 3d20 6669 6e64 5f61  ..    g = find_a
+00009f20: 7175 6966 6572 5f67 726f 7570 7328 795f  quifer_groups(y_
+00009f30: 7472 7565 2c20 6172 725f 6171 3d20 795f  true, arr_aq= y_
+00009f40: 7072 6564 2c6b 6565 705f 6c61 6265 6c5f  pred,keep_label_
+00009f50: 303d 206b 6565 705f 6c61 6265 6c5f 302c  0= keep_label_0,
+00009f60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009f70: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00009f80: 7468 6f64 3d20 6d65 7468 6f64 2c20 0d0a  thod= method, ..
+00009f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009fa0: 2020 2020 2020 2020 2020 2020 2920 0d0a              ) ..
+00009fb0: 2020 2020 2320 4665 7463 6820 7369 6d69      # Fetch simi
+00009fc0: 6c61 7269 7479 2061 6363 6f72 6469 6e67  larity according
+00009fd0: 2074 6f20 7468 6520 2074 6872 6573 686f   to the  thresho
+00009fe0: 6c64 200d 0a20 2020 2073 696d 6720 3d20  ld ..    simg = 
+00009ff0: 7475 706c 6520 285f 7369 6d69 6c61 7269  tuple (_similari
+0000a000: 7479 5f72 756c 6573 2028 206c 6973 7428  ty_rules ( list(
+0000a010: 672e 6772 6f75 7073 292c 2074 6872 6573  g.groups), thres
+0000a020: 686f 6c64 203d 2074 6872 6573 686f 6c64  hold = threshold
+0000a030: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+0000a040: 2020 2020 2020 2920 0d0a 2020 2020 7369        ) ..    si
+0000a050: 6d69 6c61 7269 7469 6573 203d 205b 5d20  milarities = [] 
+0000a060: 6966 206c 656e 2873 696d 6729 3d3d 3020  if len(simg)==0 
+0000a070: 656c 7365 205b 0d0a 2020 2020 2020 2020  else [..        
+0000a080: 286c 6162 656c 2c20 6c69 7374 2876 616c  (label, list(val
+0000a090: 7565 295b 305d 2920 666f 7220 6c61 6265  ue)[0]) for labe
+0000a0a0: 6c2c 2076 616c 7565 2020 696e 2073 696d  l, value  in sim
+0000a0b0: 6720 5d0d 0a0d 0a20 2020 2072 6574 7572  g ]....    retur
+0000a0c0: 6e20 7369 6d69 6c61 7269 7469 6573 2020  n similarities  
+0000a0d0: 6966 206e 6f74 2072 6574 7572 6e5f 6772  if not return_gr
+0000a0e0: 6f75 7073 2065 6c73 6520 7475 706c 6520  oups else tuple 
+0000a0f0: 2867 2e67 726f 7570 7320 290d 0a0d 0a64  (g.groups )....d
+0000a100: 6566 205f 7369 6d69 6c61 7269 7479 5f72  ef _similarity_r
+0000a110: 756c 6573 2028 6c67 2c20 2074 6872 6573  ules (lg,  thres
+0000a120: 686f 6c64 203d 2e35 2029 3a0d 0a20 2020  hold =.5 ):..   
+0000a130: 2022 2222 2043 6f6e 7369 6465 7273 2074   """ Considers t
+0000a140: 776f 206c 6162 656c 7320 7369 6d69 6c61  wo labels simila
+0000a150: 7220 6672 6f6d 2074 6865 2074 6872 6573  r from the thres
+0000a160: 686f 6c64 2076 616c 7565 2e20 0d0a 2020  hold value. ..  
+0000a170: 2020 0d0a 2020 2020 3a70 6172 616d 206c    ..    :param l
+0000a180: 673a 2064 6963 742c 200d 0a20 2020 2020  g: dict, ..     
+0000a190: 2020 2064 6963 7469 6f6e 6e61 7279 206f     dictionnary o
+0000a1a0: 6620 2074 7570 6c65 2070 6169 7220 2874  f  tuple pair (t
+0000a1b0: 7275 655f 6c61 6265 6c2c 2064 6963 7420  rue_label, dict 
+0000a1c0: 6f66 2067 726f 7570 206f 6363 7572 656e  of group occuren
+0000a1d0: 6365 2920 0d0a 2020 2020 3a70 6172 616d  ce) ..    :param
+0000a1e0: 2074 6872 6573 686f 6c64 3a20 666c 6f61   threshold: floa
+0000a1f0: 742c 2064 6566 6175 6c74 203d 2e32 3520  t, default =.25 
+0000a200: 0d0a 2020 2020 2020 2020 5468 6520 7468  ..        The th
+0000a210: 7265 7368 6f6c 6420 746f 2063 6f6e 7369  reshold to consi
+0000a220: 6465 7220 7477 6f20 6c61 6265 6c20 7369  der two label si
+0000a230: 6d69 6c61 7220 6672 6f6d 2074 6865 2072  milar from the r
+0000a240: 6174 6520 6f66 200d 0a20 2020 2020 2020  ate of ..       
+0000a250: 2074 6865 6972 206f 6363 7572 656e 6365   their occurence
+0000a260: 732e 200d 0a20 2020 203a 7265 7475 726e  s. ..    :return
+0000a270: 3a20 0d0a 2020 2020 2020 2020 2d20 4120  : ..        - A 
+0000a280: 6765 6e65 7261 746f 7220 6f62 6a65 6374  generator object
+0000a290: 2066 726f 6d20 3a66 756e 633a 605f 7369   from :func:`_si
+0000a2a0: 6d69 6c61 7269 7479 5f72 756c 6573 600d  milarity_rules`.
+0000a2b0: 0a20 2020 2020 2020 200d 0a20 2020 203a  .        ..    :
+0000a2c0: 6578 616d 706c 653a 0d0a 2020 2020 3e3e  example:..    >>
+0000a2d0: 3e20 6672 6f6d 2077 6174 6578 2e75 7469  > from watex.uti
+0000a2e0: 6c73 2e68 7964 726f 7574 696c 7320 696d  ls.hydroutils im
+0000a2f0: 706f 7274 205f 7369 6d69 6c61 7269 7479  port _similarity
+0000a300: 5f72 756c 6573 200d 0a20 2020 203e 3e3e  _rules ..    >>>
+0000a310: 2067 726f 7570 7320 3d20 2828 312c 7b27   groups = ((1,{'
+0000a320: 5627 3a20 302e 3332 2c27 4956 273a 2030  V': 0.32,'IV': 0
+0000a330: 2e32 3636 2c27 4949 273a 2030 2e32 3336  .266,'II': 0.236
+0000a340: 2c27 4949 4927 3a20 302e 3135 382c 0d0a  ,'III': 0.158,..
+0000a350: 2020 2020 2020 2027 4956 2656 273a 2030         'IV&V': 0
+0000a360: 2e30 312c 2749 4926 4949 4927 3a20 302e  .01,'II&III': 0.
+0000a370: 3030 352c 2749 4949 2649 5627 3a20 302e  005,'III&IV': 0.
+0000a380: 3030 357d 292c 0d0a 2020 2020 2028 322c  005}),..     (2,
+0000a390: 207b 2749 4949 273a 2030 2e32 3734 2c20   {'III': 0.274, 
+0000a3a0: 2749 4927 3a20 302e 3236 2c20 2756 273a  'II': 0.26, 'V':
+0000a3b0: 2030 2e32 362c 2027 4956 273a 2030 2e31   0.26, 'IV': 0.1
+0000a3c0: 3738 2c20 2749 4949 2649 5627 3a20 302e  78, 'III&IV': 0.
+0000a3d0: 3032 377d 292c 0d0a 2020 2020 2028 332c  027}),..     (3,
+0000a3e0: 207b 2756 273a 2030 2e34 3433 2c20 2749   {'V': 0.443, 'I
+0000a3f0: 5627 3a20 302e 3331 312c 2027 4949 4927  V': 0.311, 'III'
+0000a400: 3a20 302e 3234 357d 2929 0d0a 2020 2020  : 0.245}))..    
+0000a410: 3e3e 3e20 5f73 696d 696c 6172 6974 795f  >>> _similarity_
+0000a420: 7275 6c65 7320 2867 726f 7570 7320 2c20  rules (groups , 
+0000a430: 7468 7265 7368 6f6c 6420 3d20 2e34 2029  threshold = .4 )
+0000a440: 0d0a 2020 2020 2e2e 2e20 203c 6765 6e65  ..    ...  <gene
+0000a450: 7261 746f 7220 6f62 6a65 6374 205f 7369  rator object _si
+0000a460: 6d69 6c61 7269 7479 5f72 756c 6573 2e3c  milarity_rules.<
+0000a470: 6c6f 6361 6c73 3e2e 3c67 656e 6578 7072  locals>.<genexpr
+0000a480: 3e20 6174 2030 7830 3030 3030 3235 3534  > at 0x000002554
+0000a490: 3438 4234 4241 303e 0d0a 2020 2020 3e3e  48B4BA0>..    >>
+0000a4a0: 3e20 7475 706c 6520 285f 7369 6d69 6c61  > tuple (_simila
+0000a4b0: 7269 7479 5f72 756c 6573 2028 6772 6f75  rity_rules (grou
+0000a4c0: 7073 202c 2074 6872 6573 686f 6c64 203d  ps , threshold =
+0000a4d0: 202e 3420 2929 0d0a 2020 2020 2e2e 2e20   .4 ))..    ... 
+0000a4e0: 2828 332c 207b 2756 273a 2030 2e34 3433  ((3, {'V': 0.443
+0000a4f0: 2c20 2749 5627 3a20 302e 3331 312c 2027  , 'IV': 0.311, '
+0000a500: 4949 4927 3a20 302e 3234 357d 292c 290d  III': 0.245}),).
+0000a510: 0a20 2020 2020 2020 200d 0a20 2020 2022  .        ..    "
+0000a520: 2222 0d0a 2020 200d 0a20 2020 2074 6872  ""..   ..    thr
+0000a530: 6573 686f 6c64 203d 2074 6872 6573 686f  eshold = thresho
+0000a540: 6c64 206f 7220 2e30 0d0a 2020 2020 6966  ld or .0..    if
+0000a550: 2069 7369 6e73 7461 6e63 6520 2874 6872   isinstance (thr
+0000a560: 6573 686f 6c64 2c20 7374 7229 3a20 0d0a  eshold, str): ..
+0000a570: 2020 2020 2020 2020 7472 7920 3a20 0d0a          try : ..
+0000a580: 2020 2020 2020 2020 2020 2020 7468 7265              thre
+0000a590: 7368 6f6c 6420 3d20 666c 6f61 7428 7468  shold = float(th
+0000a5a0: 7265 7368 6f6c 642e 7265 706c 6163 6528  reshold.replace(
+0000a5b0: 2225 222c 2027 2729 0d0a 2020 2020 2020  "%", '')..      
 0000a5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a5d0: 2020 2020 2020 2020 2020 2020 292f 3165              )/1e
-0000a5e0: 3220 6966 2027 2527 2069 6e20 7468 7265  2 if '%' in thre
-0000a5f0: 7368 6f6c 6420 656c 7365 2074 6872 6573  shold else thres
-0000a600: 686f 6c64 200d 0a20 2020 2020 2020 2065  hold ..        e
-0000a610: 7863 6570 743a 200d 0a20 2020 2020 2020  xcept: ..       
-0000a620: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0000a630: 7272 6f72 2028 2254 6872 6573 686f 6c64  rror ("Threshold
-0000a640: 206d 7573 7420 6265 2061 206e 756d 6265   must be a numbe
-0000a650: 7220 6265 7477 6565 6e20 3020 616e 6420  r between 0 and 
-0000a660: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-0000a670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a680: 6622 312c 2067 6f74 3a20 7b74 7970 6528  f"1, got: {type(
-0000a690: 7468 7265 7368 6f6c 6429 2e5f 5f6e 616d  threshold).__nam
-0000a6a0: 655f 5f21 727d 2229 0d0a 2020 2020 2320  e__!r}")..    # 
-0000a6b0: 7468 6520 6764 6963 7420 6973 2061 6c72  the gdict is alr
-0000a6c0: 6561 6479 2073 6f72 7465 6420 0d0a 2020  eady sorted ..  
-0000a6d0: 2020 7468 7265 7368 6f6c 6420 3d20 666c    threshold = fl
-0000a6e0: 6f61 7428 0d0a 2020 2020 2020 2020 5f61  oat(..        _a
-0000a6f0: 7373 6572 745f 616c 6c5f 7479 7065 7328  ssert_all_types(
-0000a700: 7468 7265 7368 6f6c 642c 2069 6e74 2c20  threshold, int, 
-0000a710: 666c 6f61 742c 206f 626a 6e61 6d65 3d22  float, objname="
-0000a720: 5468 7265 7368 6f6c 6422 2029 290d 0a20  Threshold" )).. 
-0000a730: 2020 200d 0a20 2020 2069 6620 7468 7265     ..    if thre
-0000a740: 7368 6f6c 6420 3c20 302e 206f 7220 7468  shold < 0. or th
-0000a750: 7265 7368 6f6c 6420 3e20 313a 200d 0a20  reshold > 1: .. 
-0000a760: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000a770: 7565 4572 726f 7220 2822 5468 7265 7368  ueError ("Thresh
-0000a780: 6f6c 6420 6578 7065 6374 7320 6120 7661  old expects a va
-0000a790: 6c75 6520 7261 6e67 6564 2062 6574 7765  lue ranged betwe
-0000a7a0: 656e 2030 2061 6e64 2031 2c22 0d0a 2020  en 0 and 1,"..  
+0000a5d0: 2020 2020 2020 2020 292f 3165 3220 6966          )/1e2 if
+0000a5e0: 2027 2527 2069 6e20 7468 7265 7368 6f6c   '%' in threshol
+0000a5f0: 6420 656c 7365 2074 6872 6573 686f 6c64  d else threshold
+0000a600: 200d 0a20 2020 2020 2020 2065 7863 6570   ..        excep
+0000a610: 743a 200d 0a20 2020 2020 2020 2020 2020  t: ..           
+0000a620: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+0000a630: 2028 2254 6872 6573 686f 6c64 206d 7573   ("Threshold mus
+0000a640: 7420 6265 2061 206e 756d 6265 7220 6265  t be a number be
+0000a650: 7477 6565 6e20 3020 616e 6420 220d 0a20  tween 0 and ".. 
+0000a660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a670: 2020 2020 2020 2020 2020 2020 6622 312c              f"1,
+0000a680: 2067 6f74 3a20 7b74 7970 6528 7468 7265   got: {type(thre
+0000a690: 7368 6f6c 6429 2e5f 5f6e 616d 655f 5f21  shold).__name__!
+0000a6a0: 727d 2229 0d0a 2020 2020 2320 7468 6520  r}")..    # the 
+0000a6b0: 6764 6963 7420 6973 2061 6c72 6561 6479  gdict is already
+0000a6c0: 2073 6f72 7465 6420 0d0a 2020 2020 7468   sorted ..    th
+0000a6d0: 7265 7368 6f6c 6420 3d20 666c 6f61 7428  reshold = float(
+0000a6e0: 0d0a 2020 2020 2020 2020 5f61 7373 6572  ..        _asser
+0000a6f0: 745f 616c 6c5f 7479 7065 7328 7468 7265  t_all_types(thre
+0000a700: 7368 6f6c 642c 2069 6e74 2c20 666c 6f61  shold, int, floa
+0000a710: 742c 206f 626a 6e61 6d65 3d22 5468 7265  t, objname="Thre
+0000a720: 7368 6f6c 6422 2029 290d 0a20 2020 200d  shold" ))..    .
+0000a730: 0a20 2020 2069 6620 7468 7265 7368 6f6c  .    if threshol
+0000a740: 6420 3c20 302e 206f 7220 7468 7265 7368  d < 0. or thresh
+0000a750: 6f6c 6420 3e20 313a 200d 0a20 2020 2020  old > 1: ..     
+0000a760: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0000a770: 726f 7220 2822 5468 7265 7368 6f6c 6420  ror ("Threshold 
+0000a780: 6578 7065 6374 7320 6120 7661 6c75 6520  expects a value 
+0000a790: 7261 6e67 6564 2062 6574 7765 656e 2030  ranged between 0
+0000a7a0: 2061 6e64 2031 2c22 0d0a 2020 2020 2020   and 1,"..      
 0000a7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a7c0: 2020 2020 2020 2020 6622 2067 6f74 3a20          f" got: 
-0000a7d0: 7b74 6872 6573 686f 6c64 7d22 290d 0a20  {threshold}").. 
-0000a7e0: 2020 2066 6f72 206b 202c 2067 2069 6e20     for k , g in 
-0000a7f0: 6c67 3a0d 0a20 2020 2020 2020 2069 6620  lg:..        if 
-0000a800: 672e 6765 7420 286c 6973 7428 6729 5b30  g.get (list(g)[0
-0000a810: 5d29 203e 3d20 7468 7265 7368 6f6c 6420  ]) >= threshold 
-0000a820: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0000a830: 7969 656c 6420 286b 2c20 6720 290d 0a20  yield (k, g ).. 
-0000a840: 2020 2020 200d 0a64 6566 205f 6765 745f       ..def _get_
-0000a850: 795f 6672 6f6d 5f76 616c 6964 5f69 6e64  y_from_valid_ind
-0000a860: 6578 6573 2028 0d0a 2020 2020 2020 2020  exes (..        
-0000a870: 795f 7472 7565 2c20 795f 7072 6564 203d  y_true, y_pred =
-0000a880: 4e6f 6e65 202c 202a 2c20 2069 6e63 6c75  None , *,  inclu
-0000a890: 6465 5f6c 6162 656c 5f30 203d 2046 616c  de_label_0 = Fal
-0000a8a0: 7365 202c 2072 6570 6c61 6365 5f6e 616e  se , replace_nan
-0000a8b0: 203d 2046 616c 7365 200d 0a20 2020 2020   = False ..     
-0000a8c0: 2020 2029 3a20 0d0a 2020 2020 2222 2246     ): ..    """F
-0000a8d0: 726f 6d20 7661 6c69 6420 696e 6469 6365  rom valid indice
-0000a8e0: 7320 696e 2074 7275 6520 6c61 6265 6c73  s in true labels
-0000a8f0: 2027 795f 7472 7565 272c 2067 6574 2074   'y_true', get t
-0000a900: 6865 2076 616c 6964 200d 0a20 2020 2076  he valid ..    v
-0000a910: 616c 6964 2079 2061 7272 6179 2061 7320  alid y array as 
-0000a920: 6173 2070 6f73 7369 626c 6520 7468 6520  as possible the 
-0000a930: 7661 6c75 6520 6174 2074 6865 2076 616c  value at the val
-0000a940: 6964 2069 6e64 6963 6573 2066 726f 6d20  id indices from 
-0000a950: 2779 5f74 7275 6527 200d 0a20 2020 2069  'y_true' ..    i
-0000a960: 6e20 7072 6564 6963 7465 6420 6c61 6265  n predicted labe
-0000a970: 6c73 2720 0d0a 2020 2020 3a70 6172 616d  ls' ..    :param
-0000a980: 2079 5f74 7275 653a 2031 642d 2061 7272   y_true: 1d- arr
-0000a990: 6179 2d6c 696b 6520 0d0a 2020 2020 2020  ay-like ..      
-0000a9a0: 2020 6172 7261 7920 636f 6d70 6f73 696e    array composin
-0000a9b0: 6720 6f66 2074 7275 6520 6c61 6265 6c73  g of true labels
-0000a9c0: 200d 0a20 2020 203a 7061 7261 6d20 795f   ..    :param y_
-0000a9d0: 7072 6564 3a20 3164 2061 7272 6179 2d6c  pred: 1d array-l
-0000a9e0: 696b 650d 0a20 2020 2020 2020 2061 7272  ike..        arr
-0000a9f0: 6179 2063 6f6d 706f 7369 6e67 206f 6620  ay composing of 
-0000aa00: 7072 6564 6963 7465 6420 6c61 6265 6c73  predicted labels
-0000aa10: 200d 0a20 2020 203a 7061 7261 6d20 696e   ..    :param in
-0000aa20: 636c 7564 655f 6c61 6265 6c5f 303a 2062  clude_label_0: b
-0000aa30: 6f6f 6c2c 2064 6566 6175 6c74 3d46 616c  ool, default=Fal
-0000aa40: 7365 200d 0a20 2020 2020 2020 206b 6565  se ..        kee
-0000aa50: 7020 3020 6f66 2074 6865 2070 7265 6469  p 0 of the predi
-0000aa60: 6374 6564 206c 6162 656c 2061 7320 6120  cted label as a 
-0000aa70: 7061 7274 6963 756c 6172 2063 6c61 7373  particular class
-0000aa80: 206c 6162 656c 2e20 0d0a 0d0a 2020 2020   label. ....    
-0000aa90: 3a72 6574 7572 6e73 3a20 2028 795f 7472  :returns:  (y_tr
-0000aaa0: 7565 207c 2079 7072 6564 2920 6172 7261  ue | ypred) arra
-0000aab0: 792d 6c69 6b65 2031 640d 0a20 2020 2020  y-like 1d..     
-0000aac0: 2020 2d20 795f 7472 7565 3a20 7265 7475    - y_true: retu
-0000aad0: 726e 7320 6172 7261 7920 6f66 2076 616c  rns array of val
-0000aae0: 6964 2069 6e64 6963 6573 206f 6e6c 7920  id indices only 
-0000aaf0: 6966 2027 795f 7072 6564 2720 6973 2060  if 'y_pred' is `
-0000ab00: 604e 6f6e 6560 600d 0a20 2020 2020 2020  `None``..       
-0000ab10: 2d79 5f70 7265 643a 2072 6574 7572 6e73  -y_pred: returns
-0000ab20: 2061 7272 6179 206f 6620 7661 6c69 6420   array of valid 
-0000ab30: 696e 6469 6365 7320 676f 7420 6672 6f6d  indices got from
-0000ab40: 2074 7275 6520 6c61 6265 6c73 2027 795f   true labels 'y_
-0000ab50: 7472 7565 270d 0a20 2020 2020 2020 0d0a  true'..       ..
-0000ab60: 2020 2020 3a65 7861 6d70 6c65 3a20 0d0a      :example: ..
-0000ab70: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-0000ab80: 7274 206e 756d 7079 2061 7320 6e70 200d  rt numpy as np .
-0000ab90: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-0000aba0: 6d20 7761 7465 782e 7574 696c 732e 6879  m watex.utils.hy
-0000abb0: 6472 6f75 7469 6c73 2069 6d70 6f72 7420  droutils import 
-0000abc0: 5f67 6574 5f79 5f66 726f 6d5f 7661 6c69  _get_y_from_vali
-0000abd0: 645f 696e 6465 7865 7320 0d0a 2020 2020  d_indexes ..    
-0000abe0: 2020 2020 3e3e 3e20 795f 7472 7565 203d      >>> y_true =
-0000abf0: 206e 702e 6172 7261 7920 285b 206e 702e   np.array ([ np.
-0000ac00: 6e61 6e2c 2031 2c20 312c 2032 2c20 332c  nan, 1, 1, 2, 3,
-0000ac10: 2032 2c20 332c 2031 2c20 332c 206e 702e   2, 3, 1, 3, np.
-0000ac20: 6e61 6e5d 290d 0a20 2020 2020 2020 203e  nan])..        >
-0000ac30: 3e3e 2079 5f70 7265 6420 3d20 6e70 2e61  >> y_pred = np.a
-0000ac40: 7272 6179 2028 5b30 2c20 302c 2030 2c20  rray ([0, 0, 0, 
-0000ac50: 312c 2032 2c20 322c 2034 2c20 352c 2031  1, 2, 2, 4, 5, 1
-0000ac60: 2c20 345d 290d 0a20 2020 2020 2020 203e  , 4])..        >
-0000ac70: 3e3e 2023 2066 6f72 2069 6e63 6c75 6420  >> # for includ 
-0000ac80: 6c61 6265 6c20 6973 2073 6574 2074 6f20  label is set to 
-0000ac90: 2746 616c 7365 270d 0a20 2020 2020 2020  'False'..       
-0000aca0: 203e 3e3e 2079 742c 2079 7020 3d5f 6765   >>> yt, yp =_ge
-0000acb0: 745f 795f 6672 6f6d 5f76 616c 6964 5f69  t_y_from_valid_i
-0000acc0: 6e64 6578 6573 2028 795f 7472 7565 2c20  ndexes (y_true, 
-0000acd0: 795f 7072 6564 290d 0a20 2020 2020 2020  y_pred)..       
-0000ace0: 203e 3e3e 2079 7420 200d 0a20 2020 2020   >>> yt  ..     
-0000acf0: 2020 202e 2e2e 2061 7272 6179 285b 312c     ... array([1,
-0000ad00: 2031 2c20 322c 2033 2c20 322c 2033 2c20   1, 2, 3, 2, 3, 
-0000ad10: 312c 2033 5d29 2023 2072 656d 6f76 6520  1, 3]) # remove 
-0000ad20: 696e 6465 7865 7320 7768 6572 6520 4e61  indexes where Na
-0000ad30: 4e20 7661 6c75 6573 200d 0a20 2020 2020  N values ..     
-0000ad40: 2020 203e 3e3e 2079 7020 200d 0a20 2020     >>> yp  ..   
-0000ad50: 2020 2020 202e 2e2e 2061 7272 6179 285b       ... array([
-0000ad60: 312c 2031 2c20 322c 2033 2c20 332c 2035  1, 1, 2, 3, 3, 5
-0000ad70: 2c20 362c 2032 5d29 0d0a 2020 2020 2020  , 6, 2])..      
-0000ad80: 2020 3e3e 3e20 2320 696e 636c 7564 6520    >>> # include 
-0000ad90: 6c61 6265 6c20 746f 2054 7275 6520 0d0a  label to True ..
-0000ada0: 2020 2020 2020 2020 3e3e 3e20 7974 2c20          >>> yt, 
-0000adb0: 7970 203d 5f67 6574 5f79 5f66 726f 6d5f  yp =_get_y_from_
-0000adc0: 7661 6c69 645f 696e 6465 7865 7320 2879  valid_indexes (y
-0000add0: 5f74 7275 652c 2079 5f70 7265 6429 0d0a  _true, y_pred)..
-0000ade0: 2020 2020 2020 2020 3e3e 3e20 7970 200d          >>> yp .
-0000adf0: 0a20 2020 2020 2020 202e 2e2e 2061 7272  .        ... arr
-0000ae00: 6179 285b 302c 2030 2c20 312c 2032 2c20  ay([0, 0, 1, 2, 
-0000ae10: 322c 2034 2c20 352c 2031 5d29 0d0a 2020  2, 4, 5, 1])..  
-0000ae20: 2020 2020 2020 0d0a 2020 2020 2222 220d        ..    """.
-0000ae30: 0a20 2020 206d 7367 203d 2822 7b7d 2073  .    msg =("{} s
-0000ae40: 7570 706f 7274 7320 6f6e 6c79 206f 6e65  upports only one
-0000ae50: 2d64 696d 656e 7369 6f6e 616c 2061 7272  -dimensional arr
-0000ae60: 6179 2229 0d0a 2020 2020 0d0a 2020 2020  ay")..    ..    
-0000ae70: 6966 206e 6f74 205f 6973 5f61 7272 6179  if not _is_array
-0000ae80: 6c69 6b65 5f31 6428 795f 7472 7565 2920  like_1d(y_true) 
-0000ae90: 3a20 0d0a 2020 2020 2020 2020 7261 6973  : ..        rais
-0000aea0: 6520 5479 7065 4572 726f 7220 286d 7367  e TypeError (msg
-0000aeb0: 2e66 6f72 6d61 7420 2822 5472 7565 206c  .format ("True l
-0000aec0: 6162 656c 7320 2779 5f74 7275 6527 2229  abels 'y_true'")
-0000aed0: 290d 0a20 2020 200d 0a20 2020 2069 6620  )..    ..    if 
-0000aee0: 795f 7072 6564 2069 7320 6e6f 7420 4e6f  y_pred is not No
-0000aef0: 6e65 3a20 0d0a 2020 2020 2020 2020 5f63  ne: ..        _c
-0000af00: 6865 636b 5f63 6f6e 7369 7374 656e 6379  heck_consistency
-0000af10: 5f73 697a 6528 795f 7472 7565 2c20 795f  _size(y_true, y_
-0000af20: 7072 6564 2920 0d0a 2020 2020 2020 2020  pred) ..        
-0000af30: 6966 206e 6f74 205f 6973 5f61 7272 6179  if not _is_array
-0000af40: 6c69 6b65 5f31 6428 795f 7072 6564 2920  like_1d(y_pred) 
-0000af50: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-0000af60: 6169 7365 2054 7970 6545 7272 6f72 2028  aise TypeError (
-0000af70: 6d73 672e 666f 726d 6174 2822 5072 6564  msg.format("Pred
-0000af80: 6963 7465 6420 6c61 6265 6c73 2027 795f  icted labels 'y_
-0000af90: 7072 6564 2722 2929 0d0a 2020 2020 2020  pred'"))..      
-0000afa0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000afb0: 2323 204f 6e6c 7920 7265 706c 6163 6520  ## Only replace 
-0000afc0: 4e61 4e20 696e 2079 5f70 7265 6420 6172  NaN in y_pred ar
-0000afd0: 7261 7920 6966 2074 6865 7265 200d 0a20  ray if there .. 
-0000afe0: 2020 2020 2020 2023 2069 7320 6e6f 2063         # is no c
-0000aff0: 6865 6170 6572 2c20 6865 7572 6973 7469  heaper, heuristi
-0000b000: 6320 6f70 7469 6f6e 2e20 2020 200d 0a20  c option.    .. 
-0000b010: 2020 2020 2020 2069 6620 6861 7361 7474         if hasatt
-0000b020: 7228 795f 7072 6564 2c20 276e 616d 6527  r(y_pred, 'name'
-0000b030: 2920 616e 6420 6973 696e 7374 616e 6365  ) and isinstance
-0000b040: 2028 795f 7072 6564 2c20 7064 2e53 6572   (y_pred, pd.Ser
-0000b050: 6965 7329 3a20 0d0a 2020 2020 2020 2020  ies): ..        
-0000b060: 2020 2020 795f 7072 6564 203d 2079 5f70      y_pred = y_p
-0000b070: 7265 642e 7661 6c75 6573 200d 0a20 2020  red.values ..   
-0000b080: 2020 2020 0d0a 2020 2020 696e 6469 6365      ..    indice
-0000b090: 732c 2020 3d20 206e 702e 7768 6572 6520  s,  =  np.where 
-0000b0a0: 287e 6e70 2e69 736e 616e 2028 795f 7472  (~np.isnan (y_tr
-0000b0b0: 7565 2029 2920 0d0a 2020 2020 795f 7472  ue )) ..    y_tr
-0000b0c0: 7565 3d20 795f 7472 7565 205b 2069 6e64  ue= y_true [ ind
-0000b0d0: 6963 6573 205d 0d0a 2020 2020 795f 7472  ices ]..    y_tr
-0000b0e0: 7565 3d20 6e70 2e61 7272 6179 2028 795f  ue= np.array (y_
-0000b0f0: 7472 7565 292e 6173 7479 7065 2028 6e70  true).astype (np
-0000b100: 2e69 6e74 3332 2920 0d0a 2020 2020 0d0a  .int32) ..    ..
-0000b110: 2020 2020 6966 2079 5f70 7265 6420 6973      if y_pred is
-0000b120: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-0000b130: 2020 2020 6966 2028 2030 206e 6f74 2069      if ( 0 not i
-0000b140: 6e20 6c69 7374 286e 702e 756e 6971 7565  n list(np.unique
-0000b150: 2028 795f 7072 6564 2929 293a 200d 0a20   (y_pred))): .. 
-0000b160: 2020 2020 2020 2020 2020 2069 6620 696e             if in
-0000b170: 636c 7564 655f 6c61 6265 6c5f 3020 3a20  clude_label_0 : 
-0000b180: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000b190: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-0000b1a0: 2227 3027 206c 6162 656c 2064 6f65 7320  "'0' label does 
-0000b1b0: 6e6f 7420 6578 6973 7420 220d 0a20 2020  not exist "..   
+0000a7c0: 2020 2020 6622 2067 6f74 3a20 7b74 6872      f" got: {thr
+0000a7d0: 6573 686f 6c64 7d22 290d 0a20 2020 2066  eshold}")..    f
+0000a7e0: 6f72 206b 202c 2067 2069 6e20 6c67 3a0d  or k , g in lg:.
+0000a7f0: 0a20 2020 2020 2020 2069 6620 672e 6765  .        if g.ge
+0000a800: 7420 286c 6973 7428 6729 5b30 5d29 203e  t (list(g)[0]) >
+0000a810: 3d20 7468 7265 7368 6f6c 6420 3a20 0d0a  = threshold : ..
+0000a820: 2020 2020 2020 2020 2020 2020 7969 656c              yiel
+0000a830: 6420 286b 2c20 6720 290d 0a20 2020 2020  d (k, g )..     
+0000a840: 200d 0a64 6566 205f 6765 745f 795f 6672   ..def _get_y_fr
+0000a850: 6f6d 5f76 616c 6964 5f69 6e64 6578 6573  om_valid_indexes
+0000a860: 2028 0d0a 2020 2020 2020 2020 795f 7472   (..        y_tr
+0000a870: 7565 2c20 795f 7072 6564 203d 4e6f 6e65  ue, y_pred =None
+0000a880: 202c 202a 2c20 2069 6e63 6c75 6465 5f6c   , *,  include_l
+0000a890: 6162 656c 5f30 203d 2046 616c 7365 202c  abel_0 = False ,
+0000a8a0: 2072 6570 6c61 6365 5f6e 616e 203d 2046   replace_nan = F
+0000a8b0: 616c 7365 200d 0a20 2020 2020 2020 2029  alse ..        )
+0000a8c0: 3a20 0d0a 2020 2020 2222 2246 726f 6d20  : ..    """From 
+0000a8d0: 7661 6c69 6420 696e 6469 6365 7320 696e  valid indices in
+0000a8e0: 2074 7275 6520 6c61 6265 6c73 2027 795f   true labels 'y_
+0000a8f0: 7472 7565 272c 2067 6574 2074 6865 2076  true', get the v
+0000a900: 616c 6964 200d 0a20 2020 2076 616c 6964  alid ..    valid
+0000a910: 2079 2061 7272 6179 2061 7320 6173 2070   y array as as p
+0000a920: 6f73 7369 626c 6520 7468 6520 7661 6c75  ossible the valu
+0000a930: 6520 6174 2074 6865 2076 616c 6964 2069  e at the valid i
+0000a940: 6e64 6963 6573 2066 726f 6d20 2779 5f74  ndices from 'y_t
+0000a950: 7275 6527 200d 0a20 2020 2069 6e20 7072  rue' ..    in pr
+0000a960: 6564 6963 7465 6420 6c61 6265 6c73 2720  edicted labels' 
+0000a970: 0d0a 2020 2020 3a70 6172 616d 2079 5f74  ..    :param y_t
+0000a980: 7275 653a 2031 642d 2061 7272 6179 2d6c  rue: 1d- array-l
+0000a990: 696b 6520 0d0a 2020 2020 2020 2020 6172  ike ..        ar
+0000a9a0: 7261 7920 636f 6d70 6f73 696e 6720 6f66  ray composing of
+0000a9b0: 2074 7275 6520 6c61 6265 6c73 200d 0a20   true labels .. 
+0000a9c0: 2020 203a 7061 7261 6d20 795f 7072 6564     :param y_pred
+0000a9d0: 3a20 3164 2061 7272 6179 2d6c 696b 650d  : 1d array-like.
+0000a9e0: 0a20 2020 2020 2020 2061 7272 6179 2063  .        array c
+0000a9f0: 6f6d 706f 7369 6e67 206f 6620 7072 6564  omposing of pred
+0000aa00: 6963 7465 6420 6c61 6265 6c73 200d 0a20  icted labels .. 
+0000aa10: 2020 203a 7061 7261 6d20 696e 636c 7564     :param includ
+0000aa20: 655f 6c61 6265 6c5f 303a 2062 6f6f 6c2c  e_label_0: bool,
+0000aa30: 2064 6566 6175 6c74 3d46 616c 7365 200d   default=False .
+0000aa40: 0a20 2020 2020 2020 206b 6565 7020 3020  .        keep 0 
+0000aa50: 6f66 2074 6865 2070 7265 6469 6374 6564  of the predicted
+0000aa60: 206c 6162 656c 2061 7320 6120 7061 7274   label as a part
+0000aa70: 6963 756c 6172 2063 6c61 7373 206c 6162  icular class lab
+0000aa80: 656c 2e20 0d0a 0d0a 2020 2020 3a72 6574  el. ....    :ret
+0000aa90: 7572 6e73 3a20 2028 795f 7472 7565 207c  urns:  (y_true |
+0000aaa0: 2079 7072 6564 2920 6172 7261 792d 6c69   ypred) array-li
+0000aab0: 6b65 2031 640d 0a20 2020 2020 2020 2d20  ke 1d..       - 
+0000aac0: 795f 7472 7565 3a20 7265 7475 726e 7320  y_true: returns 
+0000aad0: 6172 7261 7920 6f66 2076 616c 6964 2069  array of valid i
+0000aae0: 6e64 6963 6573 206f 6e6c 7920 6966 2027  ndices only if '
+0000aaf0: 795f 7072 6564 2720 6973 2060 604e 6f6e  y_pred' is ``Non
+0000ab00: 6560 600d 0a20 2020 2020 2020 2d79 5f70  e``..       -y_p
+0000ab10: 7265 643a 2072 6574 7572 6e73 2061 7272  red: returns arr
+0000ab20: 6179 206f 6620 7661 6c69 6420 696e 6469  ay of valid indi
+0000ab30: 6365 7320 676f 7420 6672 6f6d 2074 7275  ces got from tru
+0000ab40: 6520 6c61 6265 6c73 2027 795f 7472 7565  e labels 'y_true
+0000ab50: 270d 0a20 2020 2020 2020 0d0a 2020 2020  '..       ..    
+0000ab60: 3a65 7861 6d70 6c65 3a20 0d0a 2020 2020  :example: ..    
+0000ab70: 2020 2020 3e3e 3e20 696d 706f 7274 206e      >>> import n
+0000ab80: 756d 7079 2061 7320 6e70 200d 0a20 2020  umpy as np ..   
+0000ab90: 2020 2020 203e 3e3e 2066 726f 6d20 7761       >>> from wa
+0000aba0: 7465 782e 7574 696c 732e 6879 6472 6f75  tex.utils.hydrou
+0000abb0: 7469 6c73 2069 6d70 6f72 7420 5f67 6574  tils import _get
+0000abc0: 5f79 5f66 726f 6d5f 7661 6c69 645f 696e  _y_from_valid_in
+0000abd0: 6465 7865 7320 0d0a 2020 2020 2020 2020  dexes ..        
+0000abe0: 3e3e 3e20 795f 7472 7565 203d 206e 702e  >>> y_true = np.
+0000abf0: 6172 7261 7920 285b 206e 702e 6e61 6e2c  array ([ np.nan,
+0000ac00: 2031 2c20 312c 2032 2c20 332c 2032 2c20   1, 1, 2, 3, 2, 
+0000ac10: 332c 2031 2c20 332c 206e 702e 6e61 6e5d  3, 1, 3, np.nan]
+0000ac20: 290d 0a20 2020 2020 2020 203e 3e3e 2079  )..        >>> y
+0000ac30: 5f70 7265 6420 3d20 6e70 2e61 7272 6179  _pred = np.array
+0000ac40: 2028 5b30 2c20 302c 2030 2c20 312c 2032   ([0, 0, 0, 1, 2
+0000ac50: 2c20 322c 2034 2c20 352c 2031 2c20 345d  , 2, 4, 5, 1, 4]
+0000ac60: 290d 0a20 2020 2020 2020 203e 3e3e 2023  )..        >>> #
+0000ac70: 2066 6f72 2069 6e63 6c75 6420 6c61 6265   for includ labe
+0000ac80: 6c20 6973 2073 6574 2074 6f20 2746 616c  l is set to 'Fal
+0000ac90: 7365 270d 0a20 2020 2020 2020 203e 3e3e  se'..        >>>
+0000aca0: 2079 742c 2079 7020 3d5f 6765 745f 795f   yt, yp =_get_y_
+0000acb0: 6672 6f6d 5f76 616c 6964 5f69 6e64 6578  from_valid_index
+0000acc0: 6573 2028 795f 7472 7565 2c20 795f 7072  es (y_true, y_pr
+0000acd0: 6564 290d 0a20 2020 2020 2020 203e 3e3e  ed)..        >>>
+0000ace0: 2079 7420 200d 0a20 2020 2020 2020 202e   yt  ..        .
+0000acf0: 2e2e 2061 7272 6179 285b 312c 2031 2c20  .. array([1, 1, 
+0000ad00: 322c 2033 2c20 322c 2033 2c20 312c 2033  2, 3, 2, 3, 1, 3
+0000ad10: 5d29 2023 2072 656d 6f76 6520 696e 6465  ]) # remove inde
+0000ad20: 7865 7320 7768 6572 6520 4e61 4e20 7661  xes where NaN va
+0000ad30: 6c75 6573 200d 0a20 2020 2020 2020 203e  lues ..        >
+0000ad40: 3e3e 2079 7020 200d 0a20 2020 2020 2020  >> yp  ..       
+0000ad50: 202e 2e2e 2061 7272 6179 285b 312c 2031   ... array([1, 1
+0000ad60: 2c20 322c 2033 2c20 332c 2035 2c20 362c  , 2, 3, 3, 5, 6,
+0000ad70: 2032 5d29 0d0a 2020 2020 2020 2020 3e3e   2])..        >>
+0000ad80: 3e20 2320 696e 636c 7564 6520 6c61 6265  > # include labe
+0000ad90: 6c20 746f 2054 7275 6520 0d0a 2020 2020  l to True ..    
+0000ada0: 2020 2020 3e3e 3e20 7974 2c20 7970 203d      >>> yt, yp =
+0000adb0: 5f67 6574 5f79 5f66 726f 6d5f 7661 6c69  _get_y_from_vali
+0000adc0: 645f 696e 6465 7865 7320 2879 5f74 7275  d_indexes (y_tru
+0000add0: 652c 2079 5f70 7265 6429 0d0a 2020 2020  e, y_pred)..    
+0000ade0: 2020 2020 3e3e 3e20 7970 200d 0a20 2020      >>> yp ..   
+0000adf0: 2020 2020 202e 2e2e 2061 7272 6179 285b       ... array([
+0000ae00: 302c 2030 2c20 312c 2032 2c20 322c 2034  0, 0, 1, 2, 2, 4
+0000ae10: 2c20 352c 2031 5d29 0d0a 2020 2020 2020  , 5, 1])..      
+0000ae20: 2020 0d0a 2020 2020 2222 220d 0a20 2020    ..    """..   
+0000ae30: 206d 7367 203d 2822 7b7d 2073 7570 706f   msg =("{} suppo
+0000ae40: 7274 7320 6f6e 6c79 206f 6e65 2d64 696d  rts only one-dim
+0000ae50: 656e 7369 6f6e 616c 2061 7272 6179 2229  ensional array")
+0000ae60: 0d0a 2020 2020 0d0a 2020 2020 6966 206e  ..    ..    if n
+0000ae70: 6f74 205f 6973 5f61 7272 6179 6c69 6b65  ot _is_arraylike
+0000ae80: 5f31 6428 795f 7472 7565 2920 3a20 0d0a  _1d(y_true) : ..
+0000ae90: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+0000aea0: 7065 4572 726f 7220 286d 7367 2e66 6f72  peError (msg.for
+0000aeb0: 6d61 7420 2822 5472 7565 206c 6162 656c  mat ("True label
+0000aec0: 7320 2779 5f74 7275 6527 2229 290d 0a20  s 'y_true'")).. 
+0000aed0: 2020 200d 0a20 2020 2069 6620 795f 7072     ..    if y_pr
+0000aee0: 6564 2069 7320 6e6f 7420 4e6f 6e65 3a20  ed is not None: 
+0000aef0: 0d0a 2020 2020 2020 2020 5f63 6865 636b  ..        _check
+0000af00: 5f63 6f6e 7369 7374 656e 6379 5f73 697a  _consistency_siz
+0000af10: 6528 795f 7472 7565 2c20 795f 7072 6564  e(y_true, y_pred
+0000af20: 2920 0d0a 2020 2020 2020 2020 6966 206e  ) ..        if n
+0000af30: 6f74 205f 6973 5f61 7272 6179 6c69 6b65  ot _is_arraylike
+0000af40: 5f31 6428 795f 7072 6564 2920 3a0d 0a20  _1d(y_pred) :.. 
+0000af50: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000af60: 2054 7970 6545 7272 6f72 2028 6d73 672e   TypeError (msg.
+0000af70: 666f 726d 6174 2822 5072 6564 6963 7465  format("Predicte
+0000af80: 6420 6c61 6265 6c73 2027 795f 7072 6564  d labels 'y_pred
+0000af90: 2722 2929 0d0a 2020 2020 2020 2020 2020  '"))..          
+0000afa0: 2020 0d0a 2020 2020 2020 2020 2323 204f    ..        ## O
+0000afb0: 6e6c 7920 7265 706c 6163 6520 4e61 4e20  nly replace NaN 
+0000afc0: 696e 2079 5f70 7265 6420 6172 7261 7920  in y_pred array 
+0000afd0: 6966 2074 6865 7265 200d 0a20 2020 2020  if there ..     
+0000afe0: 2020 2023 2069 7320 6e6f 2063 6865 6170     # is no cheap
+0000aff0: 6572 2c20 6865 7572 6973 7469 6320 6f70  er, heuristic op
+0000b000: 7469 6f6e 2e20 2020 200d 0a20 2020 2020  tion.    ..     
+0000b010: 2020 2069 6620 6861 7361 7474 7228 795f     if hasattr(y_
+0000b020: 7072 6564 2c20 276e 616d 6527 2920 616e  pred, 'name') an
+0000b030: 6420 6973 696e 7374 616e 6365 2028 795f  d isinstance (y_
+0000b040: 7072 6564 2c20 7064 2e53 6572 6965 7329  pred, pd.Series)
+0000b050: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0000b060: 795f 7072 6564 203d 2079 5f70 7265 642e  y_pred = y_pred.
+0000b070: 7661 6c75 6573 200d 0a20 2020 2020 2020  values ..       
+0000b080: 0d0a 2020 2020 696e 6469 6365 732c 2020  ..    indices,  
+0000b090: 3d20 206e 702e 7768 6572 6520 287e 6e70  =  np.where (~np
+0000b0a0: 2e69 736e 616e 2028 795f 7472 7565 2029  .isnan (y_true )
+0000b0b0: 2920 0d0a 2020 2020 795f 7472 7565 3d20  ) ..    y_true= 
+0000b0c0: 795f 7472 7565 205b 2069 6e64 6963 6573  y_true [ indices
+0000b0d0: 205d 0d0a 2020 2020 795f 7472 7565 3d20   ]..    y_true= 
+0000b0e0: 6e70 2e61 7272 6179 2028 795f 7472 7565  np.array (y_true
+0000b0f0: 292e 6173 7479 7065 2028 6e70 2e69 6e74  ).astype (np.int
+0000b100: 3332 2920 0d0a 2020 2020 0d0a 2020 2020  32) ..    ..    
+0000b110: 6966 2079 5f70 7265 6420 6973 206e 6f74  if y_pred is not
+0000b120: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+0000b130: 6966 2028 2030 206e 6f74 2069 6e20 6c69  if ( 0 not in li
+0000b140: 7374 286e 702e 756e 6971 7565 2028 795f  st(np.unique (y_
+0000b150: 7072 6564 2929 293a 200d 0a20 2020 2020  pred))): ..     
+0000b160: 2020 2020 2020 2069 6620 696e 636c 7564         if includ
+0000b170: 655f 6c61 6265 6c5f 3020 3a20 0d0a 2020  e_label_0 : ..  
+0000b180: 2020 2020 2020 2020 2020 2020 2020 7761                wa
+0000b190: 726e 696e 6773 2e77 6172 6e28 2227 3027  rnings.warn("'0'
+0000b1a0: 206c 6162 656c 2064 6f65 7320 6e6f 7420   label does not 
+0000b1b0: 6578 6973 7420 220d 0a20 2020 2020 2020  exist "..       
 0000b1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b1d0: 2020 2020 2020 2020 2020 2022 696e 2074             "in t
-0000b1e0: 6865 2070 7265 6469 6374 6564 206c 6162  he predicted lab
-0000b1f0: 656c 732e 2229 0d0a 2020 2020 2020 2020  els.")..        
-0000b200: 2020 2020 696e 636c 7564 655f 6c61 6265      include_labe
-0000b210: 6c5f 3020 3d54 7275 6520 0d0a 2020 2020  l_0 =True ..    
-0000b220: 2020 2020 795f 7072 6564 3d20 795f 7072      y_pred= y_pr
-0000b230: 6564 5b69 6e64 6963 6573 205d 2069 6620  ed[indices ] if 
-0000b240: 696e 636c 7564 655f 6c61 6265 6c5f 3020  include_label_0 
-0000b250: 656c 7365 205c 0d0a 2020 2020 2020 2020  else \..        
-0000b260: 2020 2020 795f 7072 6564 5b69 6e64 6963      y_pred[indic
-0000b270: 6573 205d 202b 2031 0d0a 2020 2020 0d0a  es ] + 1..    ..
-0000b280: 2020 2020 7265 7475 726e 2020 795f 7472      return  y_tr
-0000b290: 7565 2069 6620 795f 7072 6564 2069 7320  ue if y_pred is 
-0000b2a0: 4e6f 6e65 2065 6c73 6520 2879 5f74 7275  None else (y_tru
-0000b2b0: 652c 2079 5f70 7265 6420 290d 0a20 200d  e, y_pred )..  .
-0000b2c0: 0a23 5858 5854 4f44 4f20 7465 726d 696e  .#XXXTODO termin
-0000b2d0: 6174 6520 7468 6520 6c61 6265 6c20 7363  ate the label sc
-0000b2e0: 6f72 6520 0d0a 2320 636f 6d70 7574 6174  ore ..# computat
-0000b2f0: 696f 6e20 616e 6420 6d6f 7665 2069 7420  ion and move it 
-0000b300: 696e 206d 6574 7269 6320 6d6f 6475 6c65  in metric module
-0000b310: 2020 2020 0d0a 6465 6620 6c61 6265 6c5f      ..def label_
-0000b320: 7363 6f72 6520 2879 5f74 7275 6520 2c20  score (y_true , 
-0000b330: 795f 7072 6564 202c 206d 6574 7269 6320  y_pred , metric 
-0000b340: 3d22 6163 6375 7261 6379 5f73 636f 7265  ="accuracy_score
-0000b350: 2220 293a 0d0a 2020 2020 2222 2220 436f  " ):..    """ Co
-0000b360: 6d70 7574 6520 7468 6520 7363 6f72 6520  mpute the score 
-0000b370: 6f66 2065 6163 6820 7472 7565 206c 6162  of each true lab
-0000b380: 656c 2061 6e64 2069 7473 2073 696d 696c  el and its simil
-0000b390: 6172 6974 7920 696e 200d 0a20 2020 2074  arity in ..    t
-0000b3a0: 6865 2070 7265 6469 6374 6564 206c 6162  he predicted lab
-0000b3b0: 656c 2027 795f 7072 6564 2720 0d0a 2020  el 'y_pred' ..  
-0000b3c0: 2020 2222 220d 0a20 2020 2073 636f 7265    """..    score
-0000b3d0: 7320 3d64 6963 7420 2829 0d0a 2020 2020  s =dict ()..    
-0000b3e0: 666f 7220 6c61 6265 6c20 696e 206c 6973  for label in lis
-0000b3f0: 7428 6e70 2e75 6e69 7175 6520 2879 5f74  t(np.unique (y_t
-0000b400: 7275 6529 2029 3a20 0d0a 2020 2020 2020  rue) ): ..      
-0000b410: 2020 696e 6465 7865 732c 203d 206e 702e    indexes, = np.
-0000b420: 7768 6572 6520 2879 5f74 7275 6520 3d3d  where (y_true ==
-0000b430: 6c61 6265 6c20 2920 0d0a 2020 2020 2020  label ) ..      
-0000b440: 2020 7970 203d 2079 5f70 7265 645b 696e    yp = y_pred[in
-0000b450: 6465 7865 735d 0d0a 2020 2020 2020 2020  dexes]..        
-0000b460: 7363 6f72 6520 3d20 6d65 7472 6963 2028  score = metric (
-0000b470: 795f 7472 7565 205b 696e 6465 7865 735d  y_true [indexes]
-0000b480: 202c 2079 7020 2920 0d0a 2020 2020 2020   , yp ) ..      
-0000b490: 2020 7363 6f72 6573 5b6c 6162 656c 5d20    scores[label] 
-0000b4a0: 3d20 7363 6f72 6520 200d 0a20 2020 2020  = score  ..     
-0000b4b0: 2020 200d 0a20 2020 2072 6574 7572 6e20     ..    return 
-0000b4c0: 7363 6f72 6573 200d 0a20 0d0a 6465 6620  scores .. ..def 
-0000b4d0: 7365 6c65 6374 5f62 6173 655f 7374 7261  select_base_stra
-0000b4e0: 7475 6d20 280d 0a20 2020 2064 3a20 5365  tum (..    d: Se
-0000b4f0: 7269 6573 207c 2041 7272 6179 4c69 6b65  ries | ArrayLike
-0000b500: 207c 2044 6174 6146 7261 6d65 202c 200d   | DataFrame , .
-0000b510: 0a20 2020 202f 2c20 0d0a 2020 2020 736e  .    /, ..    sn
-0000b520: 616d 653a 7374 7220 3d20 4e6f 6e65 2c20  ame:str = None, 
-0000b530: 0d0a 2020 2020 7374 7261 7475 6d3a 7374  ..    stratum:st
-0000b540: 723d 204e 6f6e 652c 0d0a 2020 2020 7265  r= None,..    re
-0000b550: 7475 726e 5f72 6174 653a 626f 6f6c 3d46  turn_rate:bool=F
-0000b560: 616c 7365 2c20 0d0a 2020 2020 7265 7475  alse, ..    retu
-0000b570: 726e 5f63 6f75 6e74 733a 626f 6f6c 3d20  rn_counts:bool= 
-0000b580: 4661 6c73 652c 200d 0a20 2020 2029 3a0d  False, ..    ):.
-0000b590: 0a20 2020 2022 2222 2053 656c 6563 7473  .    """ Selects
-0000b5a0: 2062 6173 6520 7374 7261 7475 6d20 6672   base stratum fr
-0000b5b0: 6f6d 2074 6865 2074 6865 2073 7472 6174  om the the strat
-0000b5c0: 6120 636f 6c75 6d6e 2069 6e20 7468 6520  a column in the 
-0000b5d0: 6c6f 6767 696e 6720 6461 7461 2e20 0d0a  logging data. ..
-0000b5e0: 2020 2020 0d0a 2020 2020 4669 6e64 2074      ..    Find t
-0000b5f0: 6865 206d 6f73 7420 7265 6375 7272 656e  he most recurren
-0000b600: 7420 7374 7261 7475 6d20 696e 2074 6865  t stratum in the
-0000b610: 2064 6174 6120 616e 6420 636f 6d70 7574   data and comput
-0000b620: 6520 7468 6520 7261 7465 206f 6620 0d0a  e the rate of ..
-0000b630: 2020 2020 6f63 6375 7272 656e 6365 2e20      occurrence. 
-0000b640: 0d0a 2020 2020 0d0a 2020 2020 5061 7261  ..    ..    Para
-0000b650: 6d65 7465 7273 200d 0a20 2020 202d 2d2d  meters ..    ---
-0000b660: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2064  ---------..    d
-0000b670: 3a20 6172 7261 792d 6c69 6b65 2031 4420  : array-like 1D 
-0000b680: 2c20 7061 6e64 6173 2e53 6572 6965 7320  , pandas.Series 
-0000b690: 6f72 2044 6174 6146 7261 6d65 0d0a 2020  or DataFrame..  
-0000b6a0: 2020 2020 2020 5661 6c69 6420 6461 7461        Valid data
-0000b6b0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-0000b6c0: 7374 7261 7461 2e20 4966 2064 6174 6166  strata. If dataf
-0000b6d0: 7261 6d65 2069 7320 7061 7373 6564 2c20  rame is passed, 
-0000b6e0: 2773 6e61 6d65 2720 6973 200d 0a20 2020  'sname' is ..   
-0000b6f0: 2020 2020 206e 6565 6465 6420 746f 2066       needed to f
-0000b700: 6574 6368 2073 7472 6174 6120 7661 6c75  etch strata valu
-0000b710: 6573 2e20 0d0a 2020 2020 736e 616d 653a  es. ..    sname:
-0000b720: 2073 7472 2c20 6f70 7469 6f6e 616c 200d   str, optional .
-0000b730: 0a20 2020 2020 2020 204e 616d 6520 6f66  .        Name of
-0000b740: 2063 6f6c 756d 6e20 696e 2074 6865 2064   column in the d
-0000b750: 6174 6166 7261 6d65 2074 6861 7420 636f  ataframe that co
-0000b760: 6e74 6169 6e73 2074 6865 2073 7472 6174  ntains the strat
-0000b770: 6120 7661 6c75 6573 2e20 0d0a 2020 2020  a values. ..    
-0000b780: 2020 2020 446f 6e74 2063 6f6e 6675 7365      Dont confuse
-0000b790: 2027 736e 616d 6527 2077 6974 6820 2773   'sname' with 's
-0000b7a0: 7472 6174 756d 2720 7768 6963 6820 6973  tratum' which is
-0000b7b0: 2074 6865 206e 616d 6520 6f66 2074 6865   the name of the
-0000b7c0: 2076 616c 6964 200d 0a20 2020 2020 2020   valid ..       
-0000b7d0: 206c 6179 6572 2f72 6f63 6b20 696e 2074   layer/rock in t
-0000b7e0: 6865 2061 7272 6179 2f53 6572 6965 7320  he array/Series 
-0000b7f0: 6f66 2073 7472 6174 612e 200d 0a20 2020  of strata. ..   
-0000b800: 2073 7472 6174 756d 3a20 7374 722c 206f   stratum: str, o
-0000b810: 7074 696f 6e61 6c20 0d0a 2020 2020 2020  ptional ..      
-0000b820: 2020 4e61 6d65 206f 6620 7468 6520 6261    Name of the ba
-0000b830: 7365 2073 7472 6174 756d 2e20 4d75 7374  se stratum. Must
-0000b840: 2062 6520 7365 6c66 2063 6f6e 7461 696e   be self contain
-0000b850: 2061 7320 616e 2069 7465 6d20 6f66 2074   as an item of t
-0000b860: 6865 200d 0a20 2020 2020 2020 2073 7472  he ..        str
-0000b870: 6174 6120 6461 7461 2e20 4e6f 7465 2074  ata data. Note t
-0000b880: 6861 7420 6966 2060 7374 7261 7475 6d60  hat if `stratum`
-0000b890: 2069 7320 7061 7373 6564 2c20 7468 6520   is passed, the 
-0000b8a0: 6175 746f 2d64 6574 6563 7469 6f6e 206f  auto-detection o
-0000b8b0: 6620 0d0a 2020 2020 2020 2020 6261 7365  f ..        base
-0000b8c0: 2073 7472 6174 756d 2069 7320 6e6f 7420   stratum is not 
-0000b8d0: 7472 6967 6765 7265 642e 2049 7420 7265  triggered. It re
-0000b8e0: 7475 726e 7320 7468 6520 7361 6d65 2073  turns the same s
-0000b8f0: 7472 6174 756d 202c 2068 6f77 6576 6572  tratum , however
-0000b900: 0d0a 2020 2020 2020 2020 6974 2063 616e  ..        it can
-0000b910: 2067 6976 6573 2074 6865 2072 6174 6520   gives the rate 
-0000b920: 616e 6420 6f63 6375 7265 6e63 6520 6f66  and occurence of
-0000b930: 2074 6869 7320 7374 7261 7475 6d20 6966   this stratum if
-0000b940: 2060 7265 7475 726e 5f72 6174 6560 200d   `return_rate` .
-0000b950: 0a20 2020 2020 2020 206f 7220 6072 6574  .        or `ret
-0000b960: 7572 6e5f 636f 756e 7473 6020 6973 2073  urn_counts` is s
-0000b970: 6574 2074 6f20 6060 5472 7565 6060 2e20  et to ``True``. 
-0000b980: 0d0a 2020 2020 7265 7475 726e 5f72 6174  ..    return_rat
-0000b990: 653a 2062 6f6f 6c2c 6465 6661 756c 743d  e: bool,default=
-0000b9a0: 4661 6c73 652c 200d 0a20 2020 2020 2020  False, ..       
-0000b9b0: 2052 6574 7572 6e73 2074 6865 2072 6174   Returns the rat
-0000b9c0: 6520 6f66 206f 6363 7572 656e 6365 206f  e of occurence o
-0000b9d0: 6620 7468 6520 6261 7365 2073 7472 6174  f the base strat
-0000b9e0: 756d 2069 6e20 7468 6520 6461 7461 2e20  um in the data. 
-0000b9f0: 0d0a 2020 2020 7265 7475 726e 5f63 6f75  ..    return_cou
-0000ba00: 6e74 733a 2062 6f6f 6c2c 2064 6566 6175  nts: bool, defau
-0000ba10: 6c74 3d46 616c 7365 2c20 0d0a 2020 2020  lt=False, ..    
-0000ba20: 2020 2020 5265 7475 726e 7320 6561 6368      Returns each
-0000ba30: 2073 7472 6174 756d 206e 616d 6520 616e   stratum name an
-0000ba40: 6420 7468 6520 6f63 6375 7265 6e63 6573  d the occurences
-0000ba50: 2028 636f 756e 7429 2069 6e20 7468 6520   (count) in the 
-0000ba60: 6461 7461 2e20 0d0a 2020 2020 0d0a 2020  data. ..    ..  
-0000ba70: 2020 5265 7475 726e 7320 0d0a 2020 2020    Returns ..    
-0000ba80: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2062  ---------..    b
-0000ba90: 733a 2073 7472 200d 0a20 2020 2020 2020  s: str ..       
-0000baa0: 2062 6173 6520 7374 7261 7475 6d20 2c20   base stratum , 
-0000bab0: 7365 6c66 2063 6f6e 7461 696e 2069 6e20  self contain in 
-0000bac0: 7468 6520 6461 7461 200d 0a20 2020 2072  the data ..    r
-0000bad0: 3a20 666c 6f61 7420 0d0a 2020 2020 2020  : float ..      
-0000bae0: 2020 7261 7465 206f 6620 6f63 6375 7265    rate of occure
-0000baf0: 6e63 6520 696e 2062 6173 6520 7374 7261  nce in base stra
-0000bb00: 7475 6d20 696e 2074 6865 2064 6174 6120  tum in the data 
-0000bb10: 0d0a 2020 2020 633a 2074 7570 6c65 2028  ..    c: tuple (
-0000bb20: 7374 722c 2069 6e74 290d 0a20 2020 2020  str, int)..     
-0000bb30: 2020 2054 7570 6c65 206f 6620 6561 6368     Tuple of each
-0000bb40: 2073 7472 6174 756d 2077 6869 7468 2074   stratum whith t
-0000bb50: 6865 6972 206f 6363 7572 7265 6e63 6520  heir occurrence 
-0000bb60: 696e 2074 6865 2064 6174 612e 200d 0a20  in the data. .. 
-0000bb70: 2020 2020 2020 200d 0a20 2020 2045 7861         ..    Exa
-0000bb80: 6d70 6c65 200d 0a20 2020 202d 2d2d 2d2d  mple ..    -----
-0000bb90: 2d2d 2d0d 0a20 2020 203e 3e3e 2066 726f  ---..    >>> fro
-0000bba0: 6d20 7761 7465 782e 6461 7461 7365 7473  m watex.datasets
-0000bbb0: 2069 6d70 6f72 7420 6c6f 6164 5f68 6c6f   import load_hlo
-0000bbc0: 6773 200d 0a20 2020 203e 3e3e 2066 726f  gs ..    >>> fro
-0000bbd0: 6d20 7761 7465 782e 7574 696c 732e 6879  m watex.utils.hy
-0000bbe0: 6472 6f75 7469 6c73 2069 6d70 6f72 7420  droutils import 
-0000bbf0: 7365 6c65 6374 5f62 6173 655f 7374 7261  select_base_stra
-0000bc00: 7475 6d20 0d0a 2020 2020 3e3e 3e20 6461  tum ..    >>> da
-0000bc10: 7461 203d 206c 6f61 645f 686c 6f67 7328  ta = load_hlogs(
-0000bc20: 292e 6672 616d 6520 2320 6765 7420 6f6e  ).frame # get on
-0000bc30: 6c79 2074 6865 2066 7261 6d65 200d 0a20  ly the frame .. 
-0000bc40: 2020 203e 3e3e 2073 656c 6563 745f 6261     >>> select_ba
-0000bc50: 7365 5f73 7472 6174 756d 2864 6174 612c  se_stratum(data,
-0000bc60: 2073 6e61 6d65 203d 2773 7472 6174 615f   sname ='strata_
-0000bc70: 6e61 6d65 2729 0d0a 2020 2020 2e2e 2e20  name')..    ... 
-0000bc80: 2773 696c 7473 746f 6e65 270d 0a20 2020  'siltstone'..   
-0000bc90: 203e 3e3e 2073 656c 6563 745f 6261 7365   >>> select_base
-0000bca0: 5f73 7472 6174 756d 2864 6174 612c 2073  _stratum(data, s
-0000bcb0: 6e61 6d65 203d 2773 7472 6174 615f 6e61  name ='strata_na
-0000bcc0: 6d65 272c 2072 6574 7572 6e5f 7261 7465  me', return_rate
-0000bcd0: 203d 5472 7565 290d 0a20 2020 202e 2e2e   =True)..    ...
-0000bce0: 2030 2e32 3837 3239 3238 3137 3637 3935   0.2872928176795
-0000bcf0: 3538 0d0a 2020 2020 3e3e 3e20 7365 6c65  58..    >>> sele
-0000bd00: 6374 5f62 6173 655f 7374 7261 7475 6d28  ct_base_stratum(
-0000bd10: 6461 7461 2c20 736e 616d 6520 3d27 7374  data, sname ='st
-0000bd20: 7261 7461 5f6e 616d 6527 2c20 7265 7475  rata_name', retu
-0000bd30: 726e 5f63 6f75 6e74 733d 5472 7565 290d  rn_counts=True).
-0000bd40: 0a20 2020 202e 2e2e 205b 2827 7369 6c74  .    ... [('silt
-0000bd50: 7374 6f6e 6527 2c20 3532 292c 0d0a 2020  stone', 52),..  
-0000bd60: 2020 2020 2020 2028 2766 696e 652d 6772         ('fine-gr
-0000bd70: 6169 6e65 6420 7361 6e64 7374 6f6e 6527  ained sandstone'
-0000bd80: 2c20 3430 292c 0d0a 2020 2020 2020 2020  , 40),..        
-0000bd90: 2028 276d 7564 7374 6f6e 6527 2c20 3337   ('mudstone', 37
-0000bda0: 292c 0d0a 2020 2020 2020 2020 2028 2763  ),..         ('c
-0000bdb0: 6f61 6c27 2c20 3234 292c 0d0a 2020 2020  oal', 24),..    
-0000bdc0: 2020 2020 2028 2743 6f61 7273 652d 6772       ('Coarse-gr
-0000bdd0: 6169 6e65 6420 7361 6e64 7374 6f6e 6527  ained sandstone'
-0000bde0: 2c20 3135 292c 0d0a 2020 2020 2020 2020  , 15),..        
-0000bdf0: 2028 2763 6172 626f 6e61 6365 6f75 7320   ('carbonaceous 
-0000be00: 6d75 6473 746f 6e65 272c 2039 292c 0d0a  mudstone', 9),..
-0000be10: 2020 2020 2020 2020 2028 276d 6564 6975           ('mediu
-0000be20: 6d2d 6772 6169 6e65 6420 7361 6e64 7374  m-grained sandst
-0000be30: 6f6e 6527 2c20 3229 2c0d 0a20 2020 2020  one', 2),..     
-0000be40: 2020 2020 2827 746f 7073 6f69 6c27 2c20      ('topsoil', 
-0000be50: 3129 2c0d 0a20 2020 2020 2020 2020 2827  1),..         ('
-0000be60: 6772 6176 656c 206c 6179 6572 272c 2031  gravel layer', 1
-0000be70: 295d 0d0a 2020 2020 2222 220d 0a20 2020  )]..    """..   
-0000be80: 205f 6173 7365 7274 5f61 6c6c 5f74 7970   _assert_all_typ
-0000be90: 6573 2864 2c20 7064 2e44 6174 6146 7261  es(d, pd.DataFra
-0000bea0: 6d65 2c20 7064 2e53 6572 6965 732c 206e  me, pd.Series, n
-0000beb0: 702e 6e64 6172 7261 7920 290d 0a20 2020  p.ndarray )..   
-0000bec0: 200d 0a20 2020 2069 6620 6861 7361 7474   ..    if hasatt
-0000bed0: 7228 642c 2027 636f 6c75 6d6e 7327 293a  r(d, 'columns'):
-0000bee0: 200d 0a20 2020 2020 2020 2069 6620 736e   ..        if sn
-0000bef0: 616d 6520 6973 204e 6f6e 6520 3a0d 0a20  ame is None :.. 
-0000bf00: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000bf10: 2054 7970 6545 7272 6f72 2028 2227 736e   TypeError ("'sn
-0000bf20: 616d 6527 2028 2073 7472 6174 6120 636f  ame' ( strata co
-0000bf30: 6c75 6d6e 206e 616d 6520 2920 2063 616e  lumn name )  can
-0000bf40: 206e 6f74 2062 6520 220d 0a20 2020 2020   not be "..     
+0000b1d0: 2020 2020 2020 2022 696e 2074 6865 2070         "in the p
+0000b1e0: 7265 6469 6374 6564 206c 6162 656c 732e  redicted labels.
+0000b1f0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+0000b200: 696e 636c 7564 655f 6c61 6265 6c5f 3020  include_label_0 
+0000b210: 3d54 7275 6520 0d0a 2020 2020 2020 2020  =True ..        
+0000b220: 795f 7072 6564 3d20 795f 7072 6564 5b69  y_pred= y_pred[i
+0000b230: 6e64 6963 6573 205d 2069 6620 696e 636c  ndices ] if incl
+0000b240: 7564 655f 6c61 6265 6c5f 3020 656c 7365  ude_label_0 else
+0000b250: 205c 0d0a 2020 2020 2020 2020 2020 2020   \..            
+0000b260: 795f 7072 6564 5b69 6e64 6963 6573 205d  y_pred[indices ]
+0000b270: 202b 2031 0d0a 2020 2020 0d0a 2020 2020   + 1..    ..    
+0000b280: 7265 7475 726e 2020 795f 7472 7565 2069  return  y_true i
+0000b290: 6620 795f 7072 6564 2069 7320 4e6f 6e65  f y_pred is None
+0000b2a0: 2065 6c73 6520 2879 5f74 7275 652c 2079   else (y_true, y
+0000b2b0: 5f70 7265 6420 290d 0a20 200d 0a23 5858  _pred )..  ..#XX
+0000b2c0: 5854 4f44 4f20 7465 726d 696e 6174 6520  XTODO terminate 
+0000b2d0: 7468 6520 6c61 6265 6c20 7363 6f72 6520  the label score 
+0000b2e0: 0d0a 2320 636f 6d70 7574 6174 696f 6e20  ..# computation 
+0000b2f0: 616e 6420 6d6f 7665 2069 7420 696e 206d  and move it in m
+0000b300: 6574 7269 6320 6d6f 6475 6c65 2020 2020  etric module    
+0000b310: 0d0a 6465 6620 6c61 6265 6c5f 7363 6f72  ..def label_scor
+0000b320: 6520 2879 5f74 7275 6520 2c20 795f 7072  e (y_true , y_pr
+0000b330: 6564 202c 206d 6574 7269 6320 3d22 6163  ed , metric ="ac
+0000b340: 6375 7261 6379 5f73 636f 7265 2220 293a  curacy_score" ):
+0000b350: 0d0a 2020 2020 2222 2220 436f 6d70 7574  ..    """ Comput
+0000b360: 6520 7468 6520 7363 6f72 6520 6f66 2065  e the score of e
+0000b370: 6163 6820 7472 7565 206c 6162 656c 2061  ach true label a
+0000b380: 6e64 2069 7473 2073 696d 696c 6172 6974  nd its similarit
+0000b390: 7920 696e 200d 0a20 2020 2074 6865 2070  y in ..    the p
+0000b3a0: 7265 6469 6374 6564 206c 6162 656c 2027  redicted label '
+0000b3b0: 795f 7072 6564 2720 0d0a 2020 2020 2222  y_pred' ..    ""
+0000b3c0: 220d 0a20 2020 2073 636f 7265 7320 3d64  "..    scores =d
+0000b3d0: 6963 7420 2829 0d0a 2020 2020 666f 7220  ict ()..    for 
+0000b3e0: 6c61 6265 6c20 696e 206c 6973 7428 6e70  label in list(np
+0000b3f0: 2e75 6e69 7175 6520 2879 5f74 7275 6529  .unique (y_true)
+0000b400: 2029 3a20 0d0a 2020 2020 2020 2020 696e   ): ..        in
+0000b410: 6465 7865 732c 203d 206e 702e 7768 6572  dexes, = np.wher
+0000b420: 6520 2879 5f74 7275 6520 3d3d 6c61 6265  e (y_true ==labe
+0000b430: 6c20 2920 0d0a 2020 2020 2020 2020 7970  l ) ..        yp
+0000b440: 203d 2079 5f70 7265 645b 696e 6465 7865   = y_pred[indexe
+0000b450: 735d 0d0a 2020 2020 2020 2020 7363 6f72  s]..        scor
+0000b460: 6520 3d20 6d65 7472 6963 2028 795f 7472  e = metric (y_tr
+0000b470: 7565 205b 696e 6465 7865 735d 202c 2079  ue [indexes] , y
+0000b480: 7020 2920 0d0a 2020 2020 2020 2020 7363  p ) ..        sc
+0000b490: 6f72 6573 5b6c 6162 656c 5d20 3d20 7363  ores[label] = sc
+0000b4a0: 6f72 6520 200d 0a20 2020 2020 2020 200d  ore  ..        .
+0000b4b0: 0a20 2020 2072 6574 7572 6e20 7363 6f72  .    return scor
+0000b4c0: 6573 200d 0a20 0d0a 6465 6620 7365 6c65  es .. ..def sele
+0000b4d0: 6374 5f62 6173 655f 7374 7261 7475 6d20  ct_base_stratum 
+0000b4e0: 280d 0a20 2020 2064 3a20 5365 7269 6573  (..    d: Series
+0000b4f0: 207c 2041 7272 6179 4c69 6b65 207c 2044   | ArrayLike | D
+0000b500: 6174 6146 7261 6d65 202c 200d 0a20 2020  ataFrame , ..   
+0000b510: 202f 2c20 0d0a 2020 2020 736e 616d 653a   /, ..    sname:
+0000b520: 7374 7220 3d20 4e6f 6e65 2c20 0d0a 2020  str = None, ..  
+0000b530: 2020 7374 7261 7475 6d3a 7374 723d 204e    stratum:str= N
+0000b540: 6f6e 652c 0d0a 2020 2020 7265 7475 726e  one,..    return
+0000b550: 5f72 6174 653a 626f 6f6c 3d46 616c 7365  _rate:bool=False
+0000b560: 2c20 0d0a 2020 2020 7265 7475 726e 5f63  , ..    return_c
+0000b570: 6f75 6e74 733a 626f 6f6c 3d20 4661 6c73  ounts:bool= Fals
+0000b580: 652c 200d 0a20 2020 2029 3a0d 0a20 2020  e, ..    ):..   
+0000b590: 2022 2222 2053 656c 6563 7473 2062 6173   """ Selects bas
+0000b5a0: 6520 7374 7261 7475 6d20 6672 6f6d 2074  e stratum from t
+0000b5b0: 6865 2074 6865 2073 7472 6174 6120 636f  he the strata co
+0000b5c0: 6c75 6d6e 2069 6e20 7468 6520 6c6f 6767  lumn in the logg
+0000b5d0: 696e 6720 6461 7461 2e20 0d0a 2020 2020  ing data. ..    
+0000b5e0: 0d0a 2020 2020 4669 6e64 2074 6865 206d  ..    Find the m
+0000b5f0: 6f73 7420 7265 6375 7272 656e 7420 7374  ost recurrent st
+0000b600: 7261 7475 6d20 696e 2074 6865 2064 6174  ratum in the dat
+0000b610: 6120 616e 6420 636f 6d70 7574 6520 7468  a and compute th
+0000b620: 6520 7261 7465 206f 6620 0d0a 2020 2020  e rate of ..    
+0000b630: 6f63 6375 7272 656e 6365 2e20 0d0a 2020  occurrence. ..  
+0000b640: 2020 0d0a 2020 2020 5061 7261 6d65 7465    ..    Paramete
+0000b650: 7273 200d 0a20 2020 202d 2d2d 2d2d 2d2d  rs ..    -------
+0000b660: 2d2d 2d2d 2d0d 0a20 2020 2064 3a20 6172  -----..    d: ar
+0000b670: 7261 792d 6c69 6b65 2031 4420 2c20 7061  ray-like 1D , pa
+0000b680: 6e64 6173 2e53 6572 6965 7320 6f72 2044  ndas.Series or D
+0000b690: 6174 6146 7261 6d65 0d0a 2020 2020 2020  ataFrame..      
+0000b6a0: 2020 5661 6c69 6420 6461 7461 2063 6f6e    Valid data con
+0000b6b0: 7461 696e 696e 6720 7468 6520 7374 7261  taining the stra
+0000b6c0: 7461 2e20 4966 2064 6174 6166 7261 6d65  ta. If dataframe
+0000b6d0: 2069 7320 7061 7373 6564 2c20 2773 6e61   is passed, 'sna
+0000b6e0: 6d65 2720 6973 200d 0a20 2020 2020 2020  me' is ..       
+0000b6f0: 206e 6565 6465 6420 746f 2066 6574 6368   needed to fetch
+0000b700: 2073 7472 6174 6120 7661 6c75 6573 2e20   strata values. 
+0000b710: 0d0a 2020 2020 736e 616d 653a 2073 7472  ..    sname: str
+0000b720: 2c20 6f70 7469 6f6e 616c 200d 0a20 2020  , optional ..   
+0000b730: 2020 2020 204e 616d 6520 6f66 2063 6f6c       Name of col
+0000b740: 756d 6e20 696e 2074 6865 2064 6174 6166  umn in the dataf
+0000b750: 7261 6d65 2074 6861 7420 636f 6e74 6169  rame that contai
+0000b760: 6e73 2074 6865 2073 7472 6174 6120 7661  ns the strata va
+0000b770: 6c75 6573 2e20 0d0a 2020 2020 2020 2020  lues. ..        
+0000b780: 446f 6e74 2063 6f6e 6675 7365 2027 736e  Dont confuse 'sn
+0000b790: 616d 6527 2077 6974 6820 2773 7472 6174  ame' with 'strat
+0000b7a0: 756d 2720 7768 6963 6820 6973 2074 6865  um' which is the
+0000b7b0: 206e 616d 6520 6f66 2074 6865 2076 616c   name of the val
+0000b7c0: 6964 200d 0a20 2020 2020 2020 206c 6179  id ..        lay
+0000b7d0: 6572 2f72 6f63 6b20 696e 2074 6865 2061  er/rock in the a
+0000b7e0: 7272 6179 2f53 6572 6965 7320 6f66 2073  rray/Series of s
+0000b7f0: 7472 6174 612e 200d 0a20 2020 2073 7472  trata. ..    str
+0000b800: 6174 756d 3a20 7374 722c 206f 7074 696f  atum: str, optio
+0000b810: 6e61 6c20 0d0a 2020 2020 2020 2020 4e61  nal ..        Na
+0000b820: 6d65 206f 6620 7468 6520 6261 7365 2073  me of the base s
+0000b830: 7472 6174 756d 2e20 4d75 7374 2062 6520  tratum. Must be 
+0000b840: 7365 6c66 2063 6f6e 7461 696e 2061 7320  self contain as 
+0000b850: 616e 2069 7465 6d20 6f66 2074 6865 200d  an item of the .
+0000b860: 0a20 2020 2020 2020 2073 7472 6174 6120  .        strata 
+0000b870: 6461 7461 2e20 4e6f 7465 2074 6861 7420  data. Note that 
+0000b880: 6966 2060 7374 7261 7475 6d60 2069 7320  if `stratum` is 
+0000b890: 7061 7373 6564 2c20 7468 6520 6175 746f  passed, the auto
+0000b8a0: 2d64 6574 6563 7469 6f6e 206f 6620 0d0a  -detection of ..
+0000b8b0: 2020 2020 2020 2020 6261 7365 2073 7472          base str
+0000b8c0: 6174 756d 2069 7320 6e6f 7420 7472 6967  atum is not trig
+0000b8d0: 6765 7265 642e 2049 7420 7265 7475 726e  gered. It return
+0000b8e0: 7320 7468 6520 7361 6d65 2073 7472 6174  s the same strat
+0000b8f0: 756d 202c 2068 6f77 6576 6572 0d0a 2020  um , however..  
+0000b900: 2020 2020 2020 6974 2063 616e 2067 6976        it can giv
+0000b910: 6573 2074 6865 2072 6174 6520 616e 6420  es the rate and 
+0000b920: 6f63 6375 7265 6e63 6520 6f66 2074 6869  occurence of thi
+0000b930: 7320 7374 7261 7475 6d20 6966 2060 7265  s stratum if `re
+0000b940: 7475 726e 5f72 6174 6560 200d 0a20 2020  turn_rate` ..   
+0000b950: 2020 2020 206f 7220 6072 6574 7572 6e5f       or `return_
+0000b960: 636f 756e 7473 6020 6973 2073 6574 2074  counts` is set t
+0000b970: 6f20 6060 5472 7565 6060 2e20 0d0a 2020  o ``True``. ..  
+0000b980: 2020 7265 7475 726e 5f72 6174 653a 2062    return_rate: b
+0000b990: 6f6f 6c2c 6465 6661 756c 743d 4661 6c73  ool,default=Fals
+0000b9a0: 652c 200d 0a20 2020 2020 2020 2052 6574  e, ..        Ret
+0000b9b0: 7572 6e73 2074 6865 2072 6174 6520 6f66  urns the rate of
+0000b9c0: 206f 6363 7572 656e 6365 206f 6620 7468   occurence of th
+0000b9d0: 6520 6261 7365 2073 7472 6174 756d 2069  e base stratum i
+0000b9e0: 6e20 7468 6520 6461 7461 2e20 0d0a 2020  n the data. ..  
+0000b9f0: 2020 7265 7475 726e 5f63 6f75 6e74 733a    return_counts:
+0000ba00: 2062 6f6f 6c2c 2064 6566 6175 6c74 3d46   bool, default=F
+0000ba10: 616c 7365 2c20 0d0a 2020 2020 2020 2020  alse, ..        
+0000ba20: 5265 7475 726e 7320 6561 6368 2073 7472  Returns each str
+0000ba30: 6174 756d 206e 616d 6520 616e 6420 7468  atum name and th
+0000ba40: 6520 6f63 6375 7265 6e63 6573 2028 636f  e occurences (co
+0000ba50: 756e 7429 2069 6e20 7468 6520 6461 7461  unt) in the data
+0000ba60: 2e20 0d0a 2020 2020 0d0a 2020 2020 5265  . ..    ..    Re
+0000ba70: 7475 726e 7320 0d0a 2020 2020 2d2d 2d2d  turns ..    ----
+0000ba80: 2d2d 2d2d 2d0d 0a20 2020 2062 733a 2073  -----..    bs: s
+0000ba90: 7472 200d 0a20 2020 2020 2020 2062 6173  tr ..        bas
+0000baa0: 6520 7374 7261 7475 6d20 2c20 7365 6c66  e stratum , self
+0000bab0: 2063 6f6e 7461 696e 2069 6e20 7468 6520   contain in the 
+0000bac0: 6461 7461 200d 0a20 2020 2072 3a20 666c  data ..    r: fl
+0000bad0: 6f61 7420 0d0a 2020 2020 2020 2020 7261  oat ..        ra
+0000bae0: 7465 206f 6620 6f63 6375 7265 6e63 6520  te of occurence 
+0000baf0: 696e 2062 6173 6520 7374 7261 7475 6d20  in base stratum 
+0000bb00: 696e 2074 6865 2064 6174 6120 0d0a 2020  in the data ..  
+0000bb10: 2020 633a 2074 7570 6c65 2028 7374 722c    c: tuple (str,
+0000bb20: 2069 6e74 290d 0a20 2020 2020 2020 2054   int)..        T
+0000bb30: 7570 6c65 206f 6620 6561 6368 2073 7472  uple of each str
+0000bb40: 6174 756d 2077 6869 7468 2074 6865 6972  atum whith their
+0000bb50: 206f 6363 7572 7265 6e63 6520 696e 2074   occurrence in t
+0000bb60: 6865 2064 6174 612e 200d 0a20 2020 2020  he data. ..     
+0000bb70: 2020 200d 0a20 2020 2045 7861 6d70 6c65     ..    Example
+0000bb80: 200d 0a20 2020 202d 2d2d 2d2d 2d2d 2d0d   ..    --------.
+0000bb90: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
+0000bba0: 7465 782e 6461 7461 7365 7473 2069 6d70  tex.datasets imp
+0000bbb0: 6f72 7420 6c6f 6164 5f68 6c6f 6773 200d  ort load_hlogs .
+0000bbc0: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
+0000bbd0: 7465 782e 7574 696c 732e 6879 6472 6f75  tex.utils.hydrou
+0000bbe0: 7469 6c73 2069 6d70 6f72 7420 7365 6c65  tils import sele
+0000bbf0: 6374 5f62 6173 655f 7374 7261 7475 6d20  ct_base_stratum 
+0000bc00: 0d0a 2020 2020 3e3e 3e20 6461 7461 203d  ..    >>> data =
+0000bc10: 206c 6f61 645f 686c 6f67 7328 292e 6672   load_hlogs().fr
+0000bc20: 616d 6520 2320 6765 7420 6f6e 6c79 2074  ame # get only t
+0000bc30: 6865 2066 7261 6d65 200d 0a20 2020 203e  he frame ..    >
+0000bc40: 3e3e 2073 656c 6563 745f 6261 7365 5f73  >> select_base_s
+0000bc50: 7472 6174 756d 2864 6174 612c 2073 6e61  tratum(data, sna
+0000bc60: 6d65 203d 2773 7472 6174 615f 6e61 6d65  me ='strata_name
+0000bc70: 2729 0d0a 2020 2020 2e2e 2e20 2773 696c  ')..    ... 'sil
+0000bc80: 7473 746f 6e65 270d 0a20 2020 203e 3e3e  tstone'..    >>>
+0000bc90: 2073 656c 6563 745f 6261 7365 5f73 7472   select_base_str
+0000bca0: 6174 756d 2864 6174 612c 2073 6e61 6d65  atum(data, sname
+0000bcb0: 203d 2773 7472 6174 615f 6e61 6d65 272c   ='strata_name',
+0000bcc0: 2072 6574 7572 6e5f 7261 7465 203d 5472   return_rate =Tr
+0000bcd0: 7565 290d 0a20 2020 202e 2e2e 2030 2e32  ue)..    ... 0.2
+0000bce0: 3837 3239 3238 3137 3637 3935 3538 0d0a  87292817679558..
+0000bcf0: 2020 2020 3e3e 3e20 7365 6c65 6374 5f62      >>> select_b
+0000bd00: 6173 655f 7374 7261 7475 6d28 6461 7461  ase_stratum(data
+0000bd10: 2c20 736e 616d 6520 3d27 7374 7261 7461  , sname ='strata
+0000bd20: 5f6e 616d 6527 2c20 7265 7475 726e 5f63  _name', return_c
+0000bd30: 6f75 6e74 733d 5472 7565 290d 0a20 2020  ounts=True)..   
+0000bd40: 202e 2e2e 205b 2827 7369 6c74 7374 6f6e   ... [('siltston
+0000bd50: 6527 2c20 3532 292c 0d0a 2020 2020 2020  e', 52),..      
+0000bd60: 2020 2028 2766 696e 652d 6772 6169 6e65     ('fine-graine
+0000bd70: 6420 7361 6e64 7374 6f6e 6527 2c20 3430  d sandstone', 40
+0000bd80: 292c 0d0a 2020 2020 2020 2020 2028 276d  ),..         ('m
+0000bd90: 7564 7374 6f6e 6527 2c20 3337 292c 0d0a  udstone', 37),..
+0000bda0: 2020 2020 2020 2020 2028 2763 6f61 6c27           ('coal'
+0000bdb0: 2c20 3234 292c 0d0a 2020 2020 2020 2020  , 24),..        
+0000bdc0: 2028 2743 6f61 7273 652d 6772 6169 6e65   ('Coarse-graine
+0000bdd0: 6420 7361 6e64 7374 6f6e 6527 2c20 3135  d sandstone', 15
+0000bde0: 292c 0d0a 2020 2020 2020 2020 2028 2763  ),..         ('c
+0000bdf0: 6172 626f 6e61 6365 6f75 7320 6d75 6473  arbonaceous muds
+0000be00: 746f 6e65 272c 2039 292c 0d0a 2020 2020  tone', 9),..    
+0000be10: 2020 2020 2028 276d 6564 6975 6d2d 6772       ('medium-gr
+0000be20: 6169 6e65 6420 7361 6e64 7374 6f6e 6527  ained sandstone'
+0000be30: 2c20 3229 2c0d 0a20 2020 2020 2020 2020  , 2),..         
+0000be40: 2827 746f 7073 6f69 6c27 2c20 3129 2c0d  ('topsoil', 1),.
+0000be50: 0a20 2020 2020 2020 2020 2827 6772 6176  .         ('grav
+0000be60: 656c 206c 6179 6572 272c 2031 295d 0d0a  el layer', 1)]..
+0000be70: 2020 2020 2222 220d 0a20 2020 205f 6173      """..    _as
+0000be80: 7365 7274 5f61 6c6c 5f74 7970 6573 2864  sert_all_types(d
+0000be90: 2c20 7064 2e44 6174 6146 7261 6d65 2c20  , pd.DataFrame, 
+0000bea0: 7064 2e53 6572 6965 732c 206e 702e 6e64  pd.Series, np.nd
+0000beb0: 6172 7261 7920 290d 0a20 2020 200d 0a20  array )..    .. 
+0000bec0: 2020 2069 6620 6861 7361 7474 7228 642c     if hasattr(d,
+0000bed0: 2027 636f 6c75 6d6e 7327 293a 200d 0a20   'columns'): .. 
+0000bee0: 2020 2020 2020 2069 6620 736e 616d 6520         if sname 
+0000bef0: 6973 204e 6f6e 6520 3a0d 0a20 2020 2020  is None :..     
+0000bf00: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+0000bf10: 6545 7272 6f72 2028 2227 736e 616d 6527  eError ("'sname'
+0000bf20: 2028 2073 7472 6174 6120 636f 6c75 6d6e   ( strata column
+0000bf30: 206e 616d 6520 2920 2063 616e 206e 6f74   name )  can not
+0000bf40: 2062 6520 220d 0a20 2020 2020 2020 2020   be "..         
 0000bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bf60: 2020 2020 2020 2020 2022 4e6f 6e65 2077           "None w
-0000bf70: 6865 6e20 6120 6461 7461 6672 616d 6520  hen a dataframe 
-0000bf80: 6973 2070 6173 7365 642e 2229 0d0a 2020  is passed.")..  
-0000bf90: 2020 2020 2020 736e 3d20 636f 7079 2e64        sn= copy.d
-0000bfa0: 6565 7063 6f70 7928 736e 616d 6529 0d0a  eepcopy(sname)..
-0000bfb0: 2020 2020 2020 2020 736e 616d 6520 3d20          sname = 
-0000bfc0: 5f61 7373 6572 745f 616c 6c5f 7479 7065  _assert_all_type
-0000bfd0: 7328 736e 616d 652c 2073 7472 2c20 6f62  s(sname, str, ob
-0000bfe0: 6a6e 616d 6520 3d27 4e61 6d65 206f 6620  jname ='Name of 
-0000bff0: 7374 7261 7475 6d20 636f 6c75 6d6e 2729  stratum column')
-0000c000: 200d 0a20 2020 2020 2020 2073 6e61 6d65   ..        sname
-0000c010: 203d 2069 735f 696e 5f69 6628 642e 636f   = is_in_if(d.co
-0000c020: 6c75 6d6e 732c 2073 6e61 6d65 2c20 6572  lumns, sname, er
-0000c030: 726f 7220 3d27 6967 6e6f 7265 2729 0d0a  ror ='ignore')..
-0000c040: 2020 2020 2020 2020 6966 2073 6e61 6d65          if sname
-0000c050: 2069 7320 4e6f 6e65 3a20 0d0a 2020 2020   is None: ..    
-0000c060: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0000c070: 6c75 6545 7272 6f72 2028 2066 224e 616d  lueError ( f"Nam
-0000c080: 6520 7b73 6e21 727d 2069 7320 6e6f 7420  e {sn!r} is not 
-0000c090: 6120 7661 6c69 6420 636f 6c75 6d6e 2073  a valid column s
-0000c0a0: 7472 6174 6120 6e61 6d65 2e22 0d0a 2020  trata name."..  
+0000bf60: 2020 2020 2022 4e6f 6e65 2077 6865 6e20       "None when 
+0000bf70: 6120 6461 7461 6672 616d 6520 6973 2070  a dataframe is p
+0000bf80: 6173 7365 642e 2229 0d0a 2020 2020 2020  assed.")..      
+0000bf90: 2020 736e 3d20 636f 7079 2e64 6565 7063    sn= copy.deepc
+0000bfa0: 6f70 7928 736e 616d 6529 0d0a 2020 2020  opy(sname)..    
+0000bfb0: 2020 2020 736e 616d 6520 3d20 5f61 7373      sname = _ass
+0000bfc0: 6572 745f 616c 6c5f 7479 7065 7328 736e  ert_all_types(sn
+0000bfd0: 616d 652c 2073 7472 2c20 6f62 6a6e 616d  ame, str, objnam
+0000bfe0: 6520 3d27 4e61 6d65 206f 6620 7374 7261  e ='Name of stra
+0000bff0: 7475 6d20 636f 6c75 6d6e 2729 200d 0a20  tum column') .. 
+0000c000: 2020 2020 2020 2073 6e61 6d65 203d 2069         sname = i
+0000c010: 735f 696e 5f69 6628 642e 636f 6c75 6d6e  s_in_if(d.column
+0000c020: 732c 2073 6e61 6d65 2c20 6572 726f 7220  s, sname, error 
+0000c030: 3d27 6967 6e6f 7265 2729 0d0a 2020 2020  ='ignore')..    
+0000c040: 2020 2020 6966 2073 6e61 6d65 2069 7320      if sname is 
+0000c050: 4e6f 6e65 3a20 0d0a 2020 2020 2020 2020  None: ..        
+0000c060: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000c070: 7272 6f72 2028 2066 224e 616d 6520 7b73  rror ( f"Name {s
+0000c080: 6e21 727d 2069 7320 6e6f 7420 6120 7661  n!r} is not a va
+0000c090: 6c69 6420 636f 6c75 6d6e 2073 7472 6174  lid column strat
+0000c0a0: 6120 6e61 6d65 2e22 0d0a 2020 2020 2020  a name."..      
 0000c0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c0c0: 2020 2020 2020 2020 2020 2020 2220 506c              " Pl
-0000c0d0: 6561 7365 2c20 6368 6563 6b20 796f 7572  ease, check your
-0000c0e0: 2064 6174 612e 2229 200d 0a20 2020 2020   data.") ..     
-0000c0f0: 2020 2073 6e61 6d65 203d 736e 616d 6520     sname =sname 
-0000c100: 5b30 5d20 6966 2069 7369 6e73 7461 6e63  [0] if isinstanc
-0000c110: 6528 736e 616d 652c 206c 6973 7429 2065  e(sname, list) e
-0000c120: 6c73 6520 736e 616d 6520 0d0a 2020 2020  lse sname ..    
-0000c130: 2020 2020 7364 6174 6120 3d20 645b 736e      sdata = d[sn
-0000c140: 616d 6520 5d20 2020 200d 0a0d 0a20 2020  ame ]    ....   
-0000c150: 2065 6c69 6620 6861 7361 7474 7220 2864   elif hasattr (d
-0000c160: 2c20 275f 5f61 7272 6179 5f5f 2729 2061  , '__array__') a
-0000c170: 6e64 206e 6f74 2068 6173 6174 7472 2028  nd not hasattr (
-0000c180: 642c 2027 6e61 6d65 2729 3a0d 0a20 2020  d, 'name'):..   
-0000c190: 2020 2020 2069 6620 6e6f 7420 5f69 735f       if not _is_
-0000c1a0: 6172 7261 796c 696b 655f 3164 2864 293a  arraylike_1d(d):
-0000c1b0: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-0000c1c0: 6169 7365 2053 7472 6174 6145 7272 6f72  aise StrataError
-0000c1d0: 2822 5374 7261 7461 2064 6174 6120 7375  ("Strata data su
-0000c1e0: 7070 6f72 7473 206f 6e6c 7920 6f6e 652d  pports only one-
-0000c1f0: 6469 6d65 6e73 696f 6e61 6c20 6172 7261  dimensional arra
-0000c200: 792e 220d 0a20 2020 2020 2020 2020 2020  y."..           
-0000c210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c220: 2020 290d 0a20 2020 2020 2020 2073 6461    )..        sda
-0000c230: 7461 203d 2064 0d0a 2020 2020 2020 2020  ta = d..        
-0000c240: 0d0a 2020 2020 6966 2073 7472 6174 756d  ..    if stratum
-0000c250: 2069 7320 6e6f 7420 4e6f 6e65 3a20 0d0a   is not None: ..
-0000c260: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-0000c270: 7472 6174 756d 2069 6e20 7365 7420 2873  tratum in set (s
-0000c280: 6461 7461 293a 0d0a 2020 2020 2020 2020  data):..        
-0000c290: 2020 2020 6f75 743d 206c 6973 7469 6e67      out= listing
-0000c2a0: 5f69 7465 6d73 5f66 6f72 6d61 7428 7365  _items_format(se
-0000c2b0: 7428 7364 6174 6129 2c20 6265 6769 6e74  t(sdata), begint
-0000c2c0: 6578 7420 3d20 2773 7472 6174 6127 2c20  ext = 'strata', 
-0000c2d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000c0c0: 2020 2020 2020 2020 2220 506c 6561 7365          " Please
+0000c0d0: 2c20 6368 6563 6b20 796f 7572 2064 6174  , check your dat
+0000c0e0: 612e 2229 200d 0a20 2020 2020 2020 2073  a.") ..        s
+0000c0f0: 6e61 6d65 203d 736e 616d 6520 5b30 5d20  name =sname [0] 
+0000c100: 6966 2069 7369 6e73 7461 6e63 6528 736e  if isinstance(sn
+0000c110: 616d 652c 206c 6973 7429 2065 6c73 6520  ame, list) else 
+0000c120: 736e 616d 6520 0d0a 2020 2020 2020 2020  sname ..        
+0000c130: 7364 6174 6120 3d20 645b 736e 616d 6520  sdata = d[sname 
+0000c140: 5d20 2020 200d 0a0d 0a20 2020 2065 6c69  ]    ....    eli
+0000c150: 6620 6861 7361 7474 7220 2864 2c20 275f  f hasattr (d, '_
+0000c160: 5f61 7272 6179 5f5f 2729 2061 6e64 206e  _array__') and n
+0000c170: 6f74 2068 6173 6174 7472 2028 642c 2027  ot hasattr (d, '
+0000c180: 6e61 6d65 2729 3a0d 0a20 2020 2020 2020  name'):..       
+0000c190: 2069 6620 6e6f 7420 5f69 735f 6172 7261   if not _is_arra
+0000c1a0: 796c 696b 655f 3164 2864 293a 200d 0a20  ylike_1d(d): .. 
+0000c1b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000c1c0: 2053 7472 6174 6145 7272 6f72 2822 5374   StrataError("St
+0000c1d0: 7261 7461 2064 6174 6120 7375 7070 6f72  rata data suppor
+0000c1e0: 7473 206f 6e6c 7920 6f6e 652d 6469 6d65  ts only one-dime
+0000c1f0: 6e73 696f 6e61 6c20 6172 7261 792e 220d  nsional array.".
+0000c200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c210: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+0000c220: 0a20 2020 2020 2020 2073 6461 7461 203d  .        sdata =
+0000c230: 2064 0d0a 2020 2020 2020 2020 0d0a 2020   d..        ..  
+0000c240: 2020 6966 2073 7472 6174 756d 2069 7320    if stratum is 
+0000c250: 6e6f 7420 4e6f 6e65 3a20 0d0a 2020 2020  not None: ..    
+0000c260: 2020 2020 6966 206e 6f74 2073 7472 6174      if not strat
+0000c270: 756d 2069 6e20 7365 7420 2873 6461 7461  um in set (sdata
+0000c280: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0000c290: 6f75 743d 206c 6973 7469 6e67 5f69 7465  out= listing_ite
+0000c2a0: 6d73 5f66 6f72 6d61 7428 7365 7428 7364  ms_format(set(sd
+0000c2b0: 6174 6129 2c20 6265 6769 6e74 6578 7420  ata), begintext 
+0000c2c0: 3d20 2773 7472 6174 6127 2c20 0d0a 2020  = 'strata', ..  
+0000c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000c2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c2f0: 2020 2020 2020 2020 7665 7262 6f73 6520          verbose 
-0000c300: 3d20 4661 6c73 6520 290d 0a20 2020 2020  = False )..     
-0000c310: 2020 2020 2020 2072 6169 7365 2053 7472         raise Str
-0000c320: 6174 6145 7272 6f72 2028 6622 5374 7261  ataError (f"Stra
-0000c330: 7475 6d20 7b73 7472 6174 756d 2172 7d20  tum {stratum!r} 
-0000c340: 6e6f 7420 666f 756e 6420 696e 2074 6865  not found in the
-0000c350: 2064 6174 612e 220d 0a20 2020 2020 2020   data."..       
+0000c2f0: 2020 2020 7665 7262 6f73 6520 3d20 4661      verbose = Fa
+0000c300: 6c73 6520 290d 0a20 2020 2020 2020 2020  lse )..         
+0000c310: 2020 2072 6169 7365 2053 7472 6174 6145     raise StrataE
+0000c320: 7272 6f72 2028 6622 5374 7261 7475 6d20  rror (f"Stratum 
+0000c330: 7b73 7472 6174 756d 2172 7d20 6e6f 7420  {stratum!r} not 
+0000c340: 666f 756e 6420 696e 2074 6865 2064 6174  found in the dat
+0000c350: 612e 220d 0a20 2020 2020 2020 2020 2020  a."..           
 0000c360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c370: 2020 2020 2020 2066 2220 4578 7065 6374         f" Expect
-0000c380: 7320 7b6f 7574 7d22 290d 0a20 2020 2023  s {out}")..    #
-0000c390: 636f 6d70 7574 6520 7468 6520 6f63 6375  compute the occu
-0000c3a0: 7265 6e63 6520 6f66 2074 6865 2073 7472  rence of the str
-0000c3b0: 6174 756d 2069 6e20 7468 6520 6461 7461  atum in the data
-0000c3c0: 3a20 0d0a 2020 2020 6273 2c20 2072 202c  : ..    bs,  r ,
-0000c3d0: 2063 2020 3d20 5f67 6574 5f73 5f6f 6363   c  = _get_s_occ
-0000c3e0: 7572 656e 6365 2873 6461 7461 202c 2073  urence(sdata , s
-0000c3f0: 7472 6174 756d 2029 0d0a 2020 2020 2020  tratum )..      
-0000c400: 2020 0d0a 2020 2020 7265 7475 726e 2028    ..    return (
-0000c410: 2028 2072 202c 2063 2029 2020 6966 2028   ( r , c )  if (
-0000c420: 2072 6574 7572 6e5f 7261 7465 2061 6e64   return_rate and
-0000c430: 2072 6574 7572 6e5f 636f 756e 7473 2920   return_counts) 
-0000c440: 656c 7365 2020 2820 0d0a 2020 2020 2020  else  ( ..      
-0000c450: 2020 2020 2020 7220 6966 2072 6574 7572        r if retur
-0000c460: 6e5f 7261 7465 2065 6c73 6520 6320 2920  n_rate else c ) 
-0000c470: 6966 2072 6574 7572 6e5f 7261 7465 206f  if return_rate o
-0000c480: 7220 7265 7475 726e 5f63 6f75 6e74 7320  r return_counts 
-0000c490: 656c 7365 2062 7320 0d0a 2020 2020 2020  else bs ..      
-0000c4a0: 2020 2020 2020 2920 0d0a 0d0a 6465 6620        ) ....def 
-0000c4b0: 5f67 6574 5f73 5f6f 6363 7572 656e 6365  _get_s_occurence
-0000c4c0: 2028 0d0a 2020 2020 2020 2020 7364 2c20   (..        sd, 
-0000c4d0: 2f2c 2020 6273 203d 204e 6f6e 6520 2c20  /,  bs = None , 
-0000c4e0: 7265 7665 7273 653d 2054 7275 652c 206b  reverse= True, k
-0000c4f0: 6579 203d 2031 2c20 0d0a 2020 2020 2020  ey = 1, ..      
-0000c500: 2020 2920 2d3e 2054 7570 6c65 205b 7374    ) -> Tuple [st
-0000c510: 722c 2066 6c6f 6174 2c20 4c69 7374 205d  r, float, List ]
-0000c520: 3a20 0d0a 2020 2020 2222 2220 5265 7475  : ..    """ Retu
-0000c530: 726e 7320 7468 6520 6f63 6375 7265 6e63  rns the occurenc
-0000c540: 6520 6f66 2074 6865 206f 626a 6563 7420  e of the object 
-0000c550: 696e 2074 6865 2064 6174 612e 200d 0a20  in the data. .. 
-0000c560: 2020 203a 7061 7261 6d20 7364 3a20 6172     :param sd: ar
-0000c570: 7261 792d 6c69 6b65 2031 6420 6f66 2020  ray-like 1d of  
-0000c580: 6461 7461 200d 0a20 2020 203a 7061 7261  data ..    :para
-0000c590: 6d20 6273 3a20 7374 7220 2d20 6261 7365  m bs: str - base
-0000c5a0: 206e 616d 6520 6f66 2074 6865 206f 626a   name of the obj
-0000c5b0: 6563 742e 2049 6620 2762 7327 2069 6620  ect. If 'bs' if 
-0000c5c0: 6769 7665 6e20 7468 6520 6175 746f 200d  given the auto .
-0000c5d0: 0a20 2020 2020 2020 2073 6561 7263 6820  .        search 
-0000c5e0: 2077 696c 6c20 6e6f 7420 6265 2075 7365   will not be use
-0000c5f0: 642e 200d 0a20 2020 203a 7061 7261 6d20  d. ..    :param 
-0000c600: 6b65 793a 2069 6e74 2c20 6465 6661 756c  key: int, defaul
-0000c610: 743d 3120 0d0a 2020 2020 2020 2020 6b65  t=1 ..        ke
-0000c620: 7920 6f66 206f 7264 6572 6564 2073 6f72  y of ordered sor
-0000c630: 7465 6420 6469 6374 2e20 4d75 7374 2062  ted dict. Must b
-0000c640: 6520 6569 7468 6572 207b 302c 2031 7d3a  e either {0, 1}:
-0000c650: 2060 3060 2066 6f72 206b 6579 200d 0a20   `0` for key .. 
-0000c660: 2020 2020 2020 206f 7264 6572 6564 2073         ordered s
-0000c670: 6561 7263 6720 7768 696c 6520 6031 6020  earcg while `1` 
-0000c680: 6973 2066 6f72 2076 616c 7565 2073 6561  is for value sea
-0000c690: 7263 682e 200d 0a20 2020 203a 7061 7261  rch. ..    :para
-0000c6a0: 6d20 7265 7665 7273 653a 2062 6f6f 6c2c  m reverse: bool,
-0000c6b0: 2072 6576 6572 7365 206f 7264 6572 6564   reverse ordered
-0000c6c0: 2064 6963 7469 6f6e 6e61 7279 0d0a 2020   dictionnary..  
-0000c6d0: 2020 3a72 6574 7572 6e73 3a20 6273 2c20    :returns: bs, 
-0000c6e0: 722c 2063 0d0a 2020 2020 2020 2020 7265  r, c..        re
-0000c6f0: 7475 726e 2074 6865 2062 6173 6520 6f62  turn the base ob
-0000c700: 6a65 6374 2c20 7261 7465 206f 7220 636f  ject, rate or co
-0000c710: 756e 7473 2e0d 0a20 2020 2022 2222 0d0a  unts...    """..
-0000c720: 2020 2020 2320 736f 7274 6564 2073 7472      # sorted str
-0000c730: 6174 6120 696e 2061 7363 656e 6469 6e67  ata in ascending
-0000c740: 206f 6363 7572 656e 6365 200d 0a20 2020   occurence ..   
-0000c750: 2073 3d64 6963 7420 2820 436f 756e 7465   s=dict ( Counte
-0000c760: 7228 7364 2029 2029 200d 0a20 2020 2073  r(sd ) ) ..    s
-0000c770: 6d20 3d20 6469 6374 2028 0d0a 2020 2020  m = dict (..    
-0000c780: 2020 2020 736f 7274 6564 2028 732e 6974      sorted (s.it
-0000c790: 656d 7320 2829 202c 206b 6579 3d20 6c61  ems () , key= la
-0000c7a0: 6d62 6461 2078 3a78 5b6b 6579 5d2c 2072  mbda x:x[key], r
-0000c7b0: 6576 6572 7365 203d 7265 7665 7273 6520  everse =reverse 
-0000c7c0: 290d 0a20 2020 2020 2020 2029 0d0a 2020  )..        )..  
-0000c7d0: 2020 6273 203d 206c 6973 7428 736d 2920    bs = list(sm) 
-0000c7e0: 5b30 5d20 2069 6620 6273 2069 7320 4e6f  [0]  if bs is No
-0000c7f0: 6e65 2065 6c73 6520 6273 200d 0a20 2020  ne else bs ..   
-0000c800: 2072 3d20 736d 5b62 735d 202f 2073 756d   r= sm[bs] / sum
-0000c810: 2028 736d 2e76 616c 7565 7320 2829 2920   (sm.values ()) 
-0000c820: 2320 7261 7469 6f0d 0a20 2020 2063 203d  # ratio..    c =
-0000c830: 206c 6973 7428 7a69 7020 2873 6d2e 6b65   list(zip (sm.ke
-0000c840: 7973 2829 2c20 736d 2e76 616c 7565 7320  ys(), sm.values 
-0000c850: 2829 2929 200d 0a20 2020 200d 0a20 2020  ())) ..    ..   
-0000c860: 2072 6574 7572 6e20 2062 732c 2020 7220   return  bs,  r 
-0000c870: 2c20 630d 0a0d 0a20 2020 2020 2020 2020  , c....         
-0000c880: 2020 200d 0a64 6566 2067 6574 5f63 6f6d     ..def get_com
-0000c890: 7072 6573 7365 645f 7665 6374 6f72 280d  pressed_vector(.
-0000c8a0: 0a20 2020 2064 2c20 2f2c 200d 0a20 2020  .    d, /, ..   
-0000c8b0: 2073 6e61 6d65 2c20 200d 0a20 2020 2073   sname,  ..    s
-0000c8c0: 7472 6174 756d 203d 4e6f 6e65 202c 200d  tratum =None , .
-0000c8d0: 0a20 2020 2073 7472 6174 6567 7920 3d22  .    strategy ="
-0000c8e0: 6176 6572 6167 6522 2c20 0d0a 2020 2020  average", ..    
-0000c8f0: 6173 5f66 7261 6d65 203d 2046 616c 7365  as_frame = False
-0000c900: 2c20 0d0a 2020 2020 7261 6e64 6f6d 5f73  , ..    random_s
-0000c910: 7461 7465 203d 204e 6f6e 652c 200d 0a20  tate = None, .. 
-0000c920: 2020 2029 2d3e 2053 6572 6965 7320 3a0d     )-> Series :.
-0000c930: 0a20 2020 2022 2222 2043 6f6d 7072 6573  .    """ Compres
-0000c940: 7365 7320 6261 7365 2073 7472 6174 756d  ses base stratum
-0000c950: 2064 6174 6120 696e 746f 2061 2073 696e   data into a sin
-0000c960: 6775 6c61 7220 7665 6374 6f72 2063 6f6d  gular vector com
-0000c970: 706f 7365 6420 6f66 2061 6c6c 200d 0a20  posed of all .. 
-0000c980: 2020 2066 6561 7475 7265 206e 616d 6573     feature names
-0000c990: 2069 6e20 7468 6520 7461 7267 6574 7465   in the targette
-0000c9a0: 6420 6461 7461 2060 6460 2e20 0d0a 2020  d data `d`. ..  
-0000c9b0: 2020 0d0a 2020 2020 5061 7261 6d65 7465    ..    Paramete
-0000c9c0: 7273 200d 0a20 2020 202d 2d2d 2d2d 2d2d  rs ..    -------
-0000c9d0: 2d2d 2d2d 2d0d 0a20 2020 2064 3a20 7061  -----..    d: pa
-0000c9e0: 6e64 6173 2044 6174 6146 7261 6d65 0d0a  ndas DataFrame..
-0000c9f0: 2020 2020 2020 2020 5661 6c69 6420 6461          Valid da
-0000ca00: 7461 2063 6f6e 7461 696e 696e 6720 7468  ta containing th
-0000ca10: 6520 7374 7261 7461 2e20 4966 2064 6174  e strata. If dat
-0000ca20: 6166 7261 6d65 2069 7320 7061 7373 6564  aframe is passed
-0000ca30: 2c20 2773 6e61 6d65 2720 6973 200d 0a20  , 'sname' is .. 
-0000ca40: 2020 2020 2020 206e 6565 6465 6420 746f         needed to
-0000ca50: 2066 6574 6368 2073 7472 6174 6120 7661   fetch strata va
-0000ca60: 6c75 6573 2e20 0d0a 2020 2020 736e 616d  lues. ..    snam
-0000ca70: 653a 2073 7472 2c20 6f70 7469 6f6e 616c  e: str, optional
-0000ca80: 200d 0a20 2020 2020 2020 204e 616d 6520   ..        Name 
-0000ca90: 6f66 2063 6f6c 756d 6e20 696e 2074 6865  of column in the
-0000caa0: 2064 6174 6166 7261 6d65 2074 6861 7420   dataframe that 
-0000cab0: 636f 6e74 6169 6e73 2074 6865 2073 7472  contains the str
-0000cac0: 6174 6120 7661 6c75 6573 2e20 0d0a 2020  ata values. ..  
-0000cad0: 2020 2020 2020 446f 6e74 2063 6f6e 6675        Dont confu
-0000cae0: 7365 2027 736e 616d 6527 2077 6974 6820  se 'sname' with 
-0000caf0: 2773 7472 6174 756d 2720 7768 6963 6820  'stratum' which 
-0000cb00: 6973 2074 6865 206e 616d 6520 6f66 2074  is the name of t
-0000cb10: 6865 2076 616c 6964 200d 0a20 2020 2020  he valid ..     
-0000cb20: 2020 206c 6179 6572 2f72 6f63 6b20 696e     layer/rock in
-0000cb30: 2074 6865 2061 7272 6179 2f53 6572 6965   the array/Serie
-0000cb40: 7320 6f66 2073 7472 6174 612e 200d 0a20  s of strata. .. 
-0000cb50: 2020 2073 7472 6174 756d 3a20 7374 722c     stratum: str,
-0000cb60: 206f 7074 696f 6e61 6c20 0d0a 2020 2020   optional ..    
-0000cb70: 2020 2020 4e61 6d65 206f 6620 7468 6520      Name of the 
-0000cb80: 6261 7365 2073 7472 6174 756d 2e20 4d75  base stratum. Mu
-0000cb90: 7374 2062 6520 7365 6c66 2063 6f6e 7461  st be self conta
-0000cba0: 696e 2061 7320 616e 2069 7465 6d20 6f66  in as an item of
-0000cbb0: 2074 6865 200d 0a20 2020 2020 2020 2073   the ..        s
-0000cbc0: 7472 6174 6120 6461 7461 2e20 4e6f 7465  trata data. Note
-0000cbd0: 2074 6861 7420 6966 2060 7374 7261 7475   that if `stratu
-0000cbe0: 6d60 2069 7320 7061 7373 6564 2c20 7468  m` is passed, th
-0000cbf0: 6520 6175 746f 2d64 6574 6563 7469 6f6e  e auto-detection
-0000cc00: 206f 6620 0d0a 2020 2020 2020 2020 6261   of ..        ba
-0000cc10: 7365 2073 7472 6174 756d 2069 7320 6e6f  se stratum is no
-0000cc20: 7420 7472 6967 6765 7265 642e 2049 7420  t triggered. It 
-0000cc30: 7265 7475 726e 7320 7468 6520 7361 6d65  returns the same
-0000cc40: 2073 7472 6174 756d 202c 2068 6f77 6576   stratum , howev
-0000cc50: 6572 0d0a 2020 2020 2020 2020 6974 2063  er..        it c
-0000cc60: 616e 2067 6976 6573 2074 6865 2072 6174  an gives the rat
-0000cc70: 6520 616e 6420 6f63 6375 7265 6e63 6520  e and occurence 
-0000cc80: 6f66 2074 6869 7320 7374 7261 7475 6d20  of this stratum 
-0000cc90: 6966 2060 7265 7475 726e 5f72 6174 6560  if `return_rate`
-0000cca0: 200d 0a20 2020 2020 2020 206f 7220 6072   ..        or `r
-0000ccb0: 6574 7572 6e5f 636f 756e 7473 6020 6973  eturn_counts` is
-0000ccc0: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
-0000ccd0: 2e20 0d0a 2020 2020 0d0a 2020 2020 7374  . ..    ..    st
-0000cce0: 7261 7465 6779 3a20 7374 7220 2c20 6465  rategy: str , de
-0000ccf0: 6661 756c 743d 2761 7665 7261 6765 2720  fault='average' 
-0000cd00: 6f72 2027 6d65 616e 272c 200d 0a20 2020  or 'mean', ..   
-0000cd10: 2020 2020 2073 7472 6174 6567 7920 7573       strategy us
-0000cd20: 6564 2074 6f20 7365 6c65 6374 206f 7220  ed to select or 
-0000cd30: 636f 6d70 7574 6520 7468 6520 6e75 6d65  compute the nume
-0000cd40: 7269 6361 6c20 6461 7461 2069 6e74 6f20  rical data into 
-0000cd50: 6120 0d0a 2020 2020 2020 2020 7369 6e67  a ..        sing
-0000cd60: 756c 6172 2073 6572 6965 732e 2049 7420  ular series. It 
-0000cd70: 6361 6e20 6265 205b 276e 6169 7665 275d  can be ['naive']
-0000cd80: 2e20 496e 2074 6861 7420 6361 7365 202c  . In that case ,
-0000cd90: 2061 2073 696e 676c 6520 7365 7269 6520   a single serie 
-0000cda0: 0d0a 2020 2020 2020 2020 6966 2072 616e  ..        if ran
-0000cdb0: 646f 6d6c 7920 7069 636b 6564 2075 7020  domly picked up 
-0000cdc0: 696e 746f 2074 6865 2062 6173 6520 7374  into the base st
-0000cdd0: 7261 7461 2064 6174 612e 0d0a 2020 2020  rata data...    
-0000cde0: 6173 5f66 7261 6d65 3a20 626f 6f6c 2c20  as_frame: bool, 
-0000cdf0: 6465 6661 756c 743d 2746 616c 7365 270d  default='False'.
-0000ce00: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0000ce10: 2063 6f6d 7072 6573 7365 6420 7665 6374   compressed vect
-0000ce20: 6f72 2069 6e74 6f20 6120 6461 7461 6672  or into a datafr
-0000ce30: 616d 6520 7261 7468 6572 2074 6861 7420  ame rather that 
-0000ce40: 6b65 6570 696e 6720 696e 200d 0a20 2020  keeping in ..   
-0000ce50: 2020 2020 2073 6572 6965 732e 200d 0a20       series. .. 
-0000ce60: 2020 2072 616e 646f 6d5f 7374 6174 653a     random_state:
-0000ce70: 2069 6e74 2c20 6f70 7469 6f6e 616c 2c20   int, optional, 
-0000ce80: 0d0a 2020 2020 2020 2020 5374 6174 6520  ..        State 
-0000ce90: 666f 7220 7261 6e64 6f6d 6c79 2073 656c  for randomly sel
-0000cea0: 6563 7465 6420 6120 636f 6d70 7265 7373  ected a compress
-0000ceb0: 6564 2076 6563 746f 7220 7768 656e 2060  ed vector when `
-0000cec0: 606e 6169 7665 6060 2069 7320 0d0a 2020  `naive`` is ..  
-0000ced0: 2020 2020 2020 7061 7373 6564 2061 7320        passed as 
-0000cee0: 7374 7261 7465 6779 2e0d 0a20 2020 200d  strategy...    .
-0000cef0: 0a20 2020 2052 6574 7572 6e73 200d 0a20  .    Returns .. 
-0000cf00: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
-0000cf10: 206d 733a 2070 616e 6461 7320 7365 7269   ms: pandas seri
-0000cf20: 6573 2f64 6174 6166 7261 6d65 200d 0a20  es/dataframe .. 
-0000cf30: 2020 2020 2020 2072 6574 7572 6e73 2061         returns a
-0000cf40: 2063 6f6d 7072 6573 7365 6420 7665 6374   compressed vect
-0000cf50: 6f72 2069 6e20 7061 6e64 6173 2073 6572  or in pandas ser
-0000cf60: 6965 7320 636f 6d70 6f73 6520 6f66 2061  ies compose of a
-0000cf70: 6c6c 2066 6561 7475 7265 732e 200d 0a20  ll features. .. 
-0000cf80: 2020 2020 2020 204e 6f74 6520 2c20 7468         Note , th
-0000cf90: 6520 7665 6374 6f72 2068 6572 6520 646f  e vector here do
-0000cfa0: 6573 206e 6f74 2072 6566 6572 2061 7320  es not refer as 
-0000cfb0: 6d61 7468 2076 6563 746f 7220 636f 6d70  math vector comp
-0000cfc0: 6f73 6520 6f66 200d 0a20 2020 2020 2020  ose of ..       
-0000cfd0: 206e 756d 6572 6963 616c 2076 616c 7565   numerical value
-0000cfe0: 7320 6f6e 6c79 2e20 4120 636f 6d70 7265  s only. A compre
-0000cff0: 7373 6564 2076 6563 746f 7220 6865 7265  ssed vector here
-0000d000: 2069 7320 6120 7365 7269 6573 2074 6861   is a series tha
-0000d010: 7420 6973 200d 0a20 2020 2020 2020 2074  t is ..        t
-0000d020: 6865 2072 6573 756c 7420 6f66 2061 7665  he result of ave
-0000d030: 7261 6769 6e67 2074 6865 206e 756d 6572  raging the numer
-0000d040: 6963 616c 2066 6561 7475 7265 7320 6f66  ical features of
-0000d050: 2074 6865 2062 6173 6520 7374 7261 7475   the base stratu
-0000d060: 6d20 616e 6420 0d0a 2020 2020 2020 2020  m and ..        
-0000d070: 696e 636c 7569 6e67 2069 7473 2063 6f72  incluing its cor
-0000d080: 7265 7370 6f6e 6469 6e67 2063 6174 6567  responding categ
-0000d090: 6f72 6963 616c 2076 616c 7565 732e 204e  orical values. N
-0000d0a0: 6f74 6520 7468 6572 652c 2074 6865 2020  ote there, the  
-0000d0b0: 606d 7360 0d0a 2020 2020 2020 2020 6361  `ms`..        ca
-0000d0c0: 6e20 636f 6e74 6169 6e20 6361 7465 676f  n contain catego
-0000d0d0: 7269 6361 6c20 7661 6c75 6573 2061 6e64  rical values and
-0000d0e0: 2068 6173 2074 6865 2073 616d 6520 6e75   has the same nu
-0000d0f0: 6d62 6572 2061 6e64 2066 6561 7475 7265  mber and feature
-0000d100: 7320 6173 200d 0a20 2020 2020 2020 2074  s as ..        t
-0000d110: 6865 206f 7269 6769 6e61 6c20 6672 616d  he original fram
-0000d120: 6520 6064 602e 200d 0a20 2020 200d 0a20  e `d`. ..    .. 
-0000d130: 2020 2045 7861 6d70 6c65 0d0a 2020 2020     Example..    
-0000d140: 2d2d 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e  -------..    >>>
-0000d150: 2066 726f 6d20 7761 7465 782e 6461 7461   from watex.data
-0000d160: 7365 7473 2069 6d70 6f72 7420 6c6f 6164  sets import load
-0000d170: 5f68 6c6f 6773 200d 0a20 2020 203e 3e3e  _hlogs ..    >>>
-0000d180: 2066 726f 6d20 7761 7465 782e 7574 696c   from watex.util
-0000d190: 732e 6879 6472 6f75 7469 6c73 2069 6d70  s.hydroutils imp
-0000d1a0: 6f72 7420 6765 745f 636f 6d70 7265 7373  ort get_compress
-0000d1b0: 6564 5f76 6563 746f 7220 0d0a 2020 2020  ed_vector ..    
-0000d1c0: 3e3e 3e20 6461 7461 203d 206c 6f61 645f  >>> data = load_
-0000d1d0: 686c 6f67 7328 292e 6672 616d 6520 2320  hlogs().frame # 
-0000d1e0: 6765 7420 6f6e 6c79 2074 6865 2066 7261  get only the fra
-0000d1f0: 6d65 2020 0d0a 2020 2020 3e3e 3e20 6765  me  ..    >>> ge
-0000d200: 745f 636f 6d70 7265 7373 6564 5f76 6563  t_compressed_vec
-0000d210: 746f 7220 2864 6174 612c 2073 6e61 6d65  tor (data, sname
-0000d220: 3d27 7374 7261 7461 5f6e 616d 6527 295b  ='strata_name')[
-0000d230: 3a34 5d0d 0a20 2020 202e 2e2e 2068 6f6c  :4]..    ... hol
-0000d240: 655f 6e75 6d62 6572 2020 2020 2020 2020  e_number        
-0000d250: 2020 2048 3530 320d 0a20 2020 2020 2020     H502..       
-0000d260: 2073 7472 6174 615f 6e61 6d65 2020 2020   strata_name    
-0000d270: 2020 7369 6c74 7374 6f6e 650d 0a20 2020    siltstone..   
-0000d280: 2020 2020 2061 7175 6966 6572 5f67 726f       aquifer_gro
-0000d290: 7570 2020 2020 2020 2020 2020 2049 490d  up           II.
-0000d2a0: 0a20 2020 2020 2020 2070 756d 7069 6e67  .        pumping
-0000d2b0: 5f6c 6576 656c 2020 2020 2020 205a 4653  _level       ZFS
-0000d2c0: 4149 490d 0a20 2020 2020 2020 2064 7479  AII..        dty
-0000d2d0: 7065 3a20 6f62 6a65 6374 0d0a 2020 2020  pe: object..    
-0000d2e0: 3e3e 3e20 6765 745f 636f 6d70 7265 7373  >>> get_compress
-0000d2f0: 6564 5f76 6563 746f 7220 2864 6174 612c  ed_vector (data,
-0000d300: 2073 6e61 6d65 3d27 7374 7261 7461 5f6e   sname='strata_n
-0000d310: 616d 6527 2c20 6173 5f66 7261 6d65 3d54  ame', as_frame=T
-0000d320: 7275 6520 290d 0a20 2020 202e 2e2e 2020  rue )..    ...  
-0000d330: 2068 6f6c 655f 6e75 6d62 6572 2073 7472   hole_number str
-0000d340: 6174 615f 6e61 6d65 2061 7175 6966 6572  ata_name aquifer
-0000d350: 5f67 726f 7570 2020 2e2e 2e20 2020 2020  _group  ...     
-0000d360: 2020 2072 2020 2020 2072 7020 7265 6d61     r     rp rema
-0000d370: 726b 0d0a 2020 2020 2020 2020 3020 2020  rk..        0   
-0000d380: 2020 2020 2048 3530 3220 2020 7369 6c74       H502   silt
-0000d390: 7374 6f6e 6520 2020 2020 2020 2020 2020  stone           
-0000d3a0: 2049 4920 202e 2e2e 2020 3431 2e37 3037   II  ...  41.707
-0000d3b0: 3520 2035 392e 3233 2020 2020 4e61 4e0d  5  59.23    NaN.
-0000d3c0: 0a20 2020 2020 2020 205b 3120 726f 7773  .        [1 rows
-0000d3d0: 2078 2032 3320 636f 6c75 6d6e 735d 0d0a   x 23 columns]..
-0000d3e0: 2020 2020 3e3e 3e20 6765 745f 636f 6d70      >>> get_comp
-0000d3f0: 7265 7373 6564 5f76 6563 746f 7220 2864  ressed_vector (d
-0000d400: 6174 612c 2073 6e61 6d65 3d27 7374 7261  ata, sname='stra
-0000d410: 7461 5f6e 616d 6527 2c20 7374 7261 7465  ta_name', strate
-0000d420: 6779 3d27 6e61 6976 6527 290d 0a20 2020  gy='naive')..   
-0000d430: 202e 2e2e 2068 6f6c 655f 6e75 6d62 6572   ... hole_number
-0000d440: 2020 2020 2020 2020 2020 4835 3032 0d0a            H502..
-0000d450: 2020 2020 2020 2020 6465 7074 685f 746f          depth_to
-0000d460: 7020 2020 2020 2020 2020 2033 3739 2e31  p          379.1
-0000d470: 350d 0a20 2020 2020 2020 2064 6570 7468  5..        depth
-0000d480: 5f62 6f74 746f 6d20 2020 2020 2020 2033  _bottom        3
-0000d490: 3739 2e37 0d0a 2020 2020 2020 2020 7374  79.7..        st
-0000d4a0: 7261 7461 5f6e 616d 6520 2020 2020 7369  rata_name     si
-0000d4b0: 6c74 7374 6f6e 650d 0a20 2020 2020 2020  ltstone..       
-0000d4c0: 204e 616d 653a 2033 392c 2064 7479 7065   Name: 39, dtype
-0000d4d0: 3a20 6f62 6a65 6374 0d0a 2020 2020 2222  : object..    ""
-0000d4e0: 220d 0a20 2020 205f 6173 7365 7274 5f61  "..    _assert_a
-0000d4f0: 6c6c 5f74 7970 6573 2864 2c20 7064 2e44  ll_types(d, pd.D
-0000d500: 6174 6146 7261 6d65 2c20 6f62 6a6e 616d  ataFrame, objnam
-0000d510: 6520 3d20 2244 6174 6120 666f 7220 7361  e = "Data for sa
-0000d520: 6d70 6c65 7320 636f 6d70 7265 7373 696e  mples compressin
-0000d530: 6722 290d 0a0d 0a20 2020 2064 3d20 6368  g")....    d= ch
-0000d540: 6563 6b5f 6172 7261 7928 0d0a 2020 2020  eck_array(..    
-0000d550: 2020 2020 642c 200d 0a20 2020 2020 2020      d, ..       
-0000d560: 2066 6f72 6365 5f61 6c6c 5f66 696e 6974   force_all_finit
-0000d570: 653d 2261 6c6c 6f77 2d6e 616e 222c 200d  e="allow-nan", .
-0000d580: 0a20 2020 2020 2020 2064 7479 7065 203d  .        dtype =
-0000d590: 6f62 6a65 6374 2c20 0d0a 2020 2020 2020  object, ..      
-0000d5a0: 2020 696e 7075 745f 6e61 6d65 3d22 4461    input_name="Da
-0000d5b0: 7461 2066 6f72 2073 7175 6565 7a69 6e67  ta for squeezing
-0000d5c0: 222c 0d0a 2020 2020 2020 2020 746f 5f66  ",..        to_f
-0000d5d0: 7261 6d65 203d 5472 7565 2c20 0d0a 2020  rame =True, ..  
-0000d5e0: 2020 2020 2020 290d 0a20 2020 2073 6e61        )..    sna
-0000d5f0: 6d65 203d 205f 6173 7365 7274 5f61 6c6c  me = _assert_all
-0000d600: 5f74 7970 6573 2873 6e61 6d65 2c20 7374  _types(sname, st
-0000d610: 7220 2c20 2227 736e 616d 6527 2028 2073  r , "'sname' ( s
-0000d620: 7472 6174 6120 636f 6c75 6d6e 206e 616d  trata column nam
-0000d630: 6520 2922 290d 0a20 2020 200d 0a20 2020  e )")..    ..   
-0000d640: 2061 7373 6572 7420 7374 7261 7465 6779   assert strategy
-0000d650: 2069 6e20 7b27 6d65 616e 272c 2027 6176   in {'mean', 'av
-0000d660: 6572 6167 6527 2c20 276e 6169 7665 277d  erage', 'naive'}
-0000d670: 2c20 2253 7570 706f 7274 7320 6f6e 6c79  , "Supports only
-0000d680: 2073 7472 6174 6567 7920 225c 0d0a 2020   strategy "\..  
-0000d690: 2020 2020 2020 6622 276d 6561 6e27 2c20        f"'mean', 
-0000d6a0: 2761 7665 7261 6765 2720 6f72 2027 6e61  'average' or 'na
-0000d6b0: 6976 6527 3b20 676f 7420 7b73 7472 6174  ive'; got {strat
-0000d6c0: 6567 7921 727d 220d 0a20 2020 2069 6620  egy!r}"..    if 
-0000d6d0: 7374 7261 7475 6d20 6973 204e 6f6e 653a  stratum is None:
-0000d6e0: 200d 0a20 2020 2020 2020 2073 7472 6174   ..        strat
-0000d6f0: 756d 203d 2073 656c 6563 745f 6261 7365  um = select_base
-0000d700: 5f73 7472 6174 756d 2864 2c20 736e 616d  _stratum(d, snam
-0000d710: 653d 2073 6e61 6d65 2c20 7374 7261 7475  e= sname, stratu
-0000d720: 6d3d 2073 7472 6174 756d 2029 0d0a 2020  m= stratum )..  
-0000d730: 2020 7374 7261 7475 6d20 3d20 5f61 7373    stratum = _ass
-0000d740: 6572 745f 616c 6c5f 7479 7065 7328 7374  ert_all_types(st
-0000d750: 7261 7475 6d2c 2073 7472 202c 206f 626a  ratum, str , obj
-0000d760: 6e61 6d65 203d 2027 4261 7365 2073 7472  name = 'Base str
-0000d770: 6174 756d 2027 290d 0a20 2020 2023 6772  atum ')..    #gr
-0000d780: 6f75 7020 7920 616e 6420 6765 7420 6f6e  oup y and get on
-0000d790: 6c79 2074 6865 2062 6173 6520 7374 7261  ly the base stra
-0000d7a0: 7475 6d20 6461 7461 200d 0a20 2020 2070  tum data ..    p
-0000d7b0: 6965 6365 7320 3d20 6469 6374 286c 6973  ieces = dict(lis
-0000d7c0: 7428 642e 6772 6f75 7062 7920 2873 6e61  t(d.groupby (sna
-0000d7d0: 6d65 2929 2920 0d0a 2020 2020 6273 5f64  me))) ..    bs_d
-0000d7e0: 2020 3d20 7064 2e44 6174 6146 7261 6d65    = pd.DataFrame
-0000d7f0: 2820 7069 6563 6573 205b 2073 7472 6174  ( pieces [ strat
-0000d800: 756d 205d 2920 0d0a 2020 2020 2320 6765  um ]) ..    # ge
-0000d810: 7420 7468 6520 6e75 6d65 7269 6361 6c20  t the numerical 
-0000d820: 6665 6174 7572 6573 206f 6e6c 7920 6265  features only be
-0000d830: 666f 7265 2020 6170 706c 7969 6e67 206f  fore  applying o
-0000d840: 7065 7261 7469 6f6e 200d 0a20 2020 205f  peration ..    _
-0000d850: 2c20 6e75 6d66 202c 2063 6174 6620 203d  , numf , catf  =
-0000d860: 2074 6f5f 6e75 6d65 7269 635f 6474 7970   to_numeric_dtyp
-0000d870: 6573 2862 735f 6420 2c20 7265 7475 726e  es(bs_d , return
-0000d880: 5f66 6561 7475 7265 5f74 7970 6573 3d20  _feature_types= 
-0000d890: 5472 7565 2029 0d0a 2020 2020 0d0a 2020  True )..    ..  
-0000d8a0: 2020 6966 2073 7472 6174 6567 7920 2069    if strategy  i
-0000d8b0: 6e20 2827 6d65 616e 272c 2027 6176 6572  n ('mean', 'aver
-0000d8c0: 6167 6527 2920 3a0d 0a20 2020 2020 2020  age') :..       
-0000d8d0: 2023 7878 7878 7878 7878 7878 7878 7878   #xxxxxxxxxxxxxx
-0000d8e0: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0000d8f0: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0000d900: 7878 0d0a 2020 2020 2020 2020 6672 6f6d  xx..        from
-0000d910: 202e 2e65 786c 6962 2e73 6b6c 6561 726e   ..exlib.sklearn
-0000d920: 2069 6d70 6f72 7420 5369 6d70 6c65 496d   import SimpleIm
-0000d930: 7075 7465 7220 0d0a 2020 2020 2020 2020  puter ..        
-0000d940: 2378 7878 7878 7878 7878 7878 7878 7878  #xxxxxxxxxxxxxxx
-0000d950: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0000d960: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0000d970: 780d 0a20 2020 2020 2020 206d 7320 3d20  x..        ms = 
-0000d980: 6273 5f64 5b20 6e75 6d66 205d 2e6d 6561  bs_d[ numf ].mea
-0000d990: 6e28 2920 0d0a 2020 2020 2020 2020 6966  n() ..        if
-0000d9a0: 206c 656e 2863 6174 6629 213d 303a 0d0a   len(catf)!=0:..
-0000d9b0: 2020 2020 2020 2020 2020 2020 2320 496d              # Im
-0000d9c0: 7075 7465 2064 6174 6120 616e 6420 6669  pute data and fi
-0000d9d0: 6c6c 2074 6865 2067 6170 2069 6620 6578  ll the gap if ex
-0000d9e0: 6973 7473 0d0a 2020 2020 2020 2020 2020  ists..          
-0000d9f0: 2020 2320 2062 7920 7468 6520 6d6f 7374    #  by the most
-0000da00: 2066 7265 7175 656e 7420 6361 7465 676f   frequent catego
-0000da10: 7269 616c 2066 6561 7475 7265 732e 0d0a  rial features...
-0000da20: 2020 2020 2020 2020 2020 2020 7369 6d20              sim 
-0000da30: 3d20 5369 6d70 6c65 496d 7075 7465 7228  = SimpleImputer(
-0000da40: 7374 7261 7465 6779 203d 2027 6d6f 7374  strategy = 'most
-0000da50: 5f66 7265 7175 656e 7427 2920 0d0a 2020  _frequent') ..  
-0000da60: 2020 2020 2020 2020 2020 7874 203d 2073            xt = s
-0000da70: 696d 2e66 6974 5f74 7261 6e73 666f 726d  im.fit_transform
-0000da80: 2862 735f 645b 6361 7466 5d29 200d 0a20  (bs_d[catf]) .. 
-0000da90: 2020 2020 2020 2020 2020 2062 735f 6463             bs_dc
-0000daa0: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-0000dab0: 7874 202c 2063 6f6c 756d 6e73 203d 2073  xt , columns = s
-0000dac0: 696d 2e66 6561 7475 7265 5f6e 616d 6573  im.feature_names
-0000dad0: 5f69 6e5f 2029 200d 0a20 2020 2020 2020  _in_ ) ..       
-0000dae0: 2020 2020 2023 2067 6574 206f 6e6c 7920       # get only 
-0000daf0: 7369 6e67 6c65 2076 616c 7565 206f 6620  single value of 
-0000db00: 7468 6520 6669 7273 7420 726f 7720 0d0a  the first row ..
-0000db10: 2020 2020 2020 2020 2020 2020 6273 5f69              bs_i
-0000db20: 6e69 7420 3d20 6273 5f64 6320 2e69 6c6f  nit = bs_dc .ilo
-0000db30: 6320 5b30 202c 203a 205d 200d 0a20 2020  c [0 , : ] ..   
-0000db40: 2020 2020 2020 2020 2023 6d73 2e72 6573           #ms.res
-0000db50: 6574 5f69 6e64 6578 2028 696e 706c 6163  et_index (inplac
-0000db60: 6520 3d54 7275 6520 2920 0d0a 2020 2020  e =True ) ..    
-0000db70: 2020 2020 2020 2020 6d73 203d 2070 642e          ms = pd.
-0000db80: 636f 6e63 6174 2028 205b 2062 735f 696e  concat ( [ bs_in
-0000db90: 6974 2c20 6d73 2020 5d2c 2061 7869 7320  it, ms  ], axis 
-0000dba0: 3d20 3020 2920 0d0a 2020 2020 656c 6966  = 0 ) ..    elif
-0000dbb0: 2073 7472 6174 6567 7920 3d3d 276e 6169   strategy =='nai
-0000dbc0: 7665 273a 0d0a 2020 2020 2020 2020 7261  ve':..        ra
-0000dbd0: 6e64 6f6d 5f73 7461 7465 3d20 7261 6e64  ndom_state= rand
-0000dbe0: 6f6d 5f73 7461 7465 206f 7220 3432 200d  om_state or 42 .
-0000dbf0: 0a20 2020 2020 2020 2023 2072 616e 646f  .        # rando
-0000dc00: 6d6c 7920 7069 636b 2075 7020 6f6e 6520  mly pick up one 
-0000dc10: 696e 6465 7820 0d0a 2020 2020 2020 2020  index ..        
-0000dc20: 7261 6e64 203d 206e 702e 7261 6e64 6f6d  rand = np.random
-0000dc30: 2e52 616e 646f 6d53 7461 7465 2028 7261  .RandomState (ra
-0000dc40: 6e64 6f6d 5f73 7461 7465 2029 0d0a 2020  ndom_state )..  
-0000dc50: 2020 2020 2020 2320 6966 2075 7365 2073        # if use s
-0000dc60: 616d 706c 6520 2c20 2d3e 2072 6574 7572  ample , -> retur
-0000dc70: 6e20 6120 6c69 7374 2061 6e64 206d 7573  n a list and mus
-0000dc80: 7420 0d0a 2020 2020 2020 2020 2320 7370  t ..        # sp
-0000dc90: 6563 6966 7920 7468 6520 6b20 6e75 6d62  ecify the k numb
-0000dca0: 6572 206f 6620 7365 7175 656e 6365 202c  er of sequence ,
-0000dcb0: 200d 0a20 2020 2020 2020 2023 2077 6869   ..        # whi
-0000dcc0: 6c65 2068 6572 6520 2c20 6f6e 6c79 2061  le here , only a
-0000dcd0: 2073 696e 676c 6520 6973 2069 7320 6578   single is is ex
-0000dce0: 7065 6374 6564 3a20 6c69 6b65 200d 0a20  pected: like .. 
-0000dcf0: 2020 2020 2020 2023 2072 616e 646f 6d2e         # random.
-0000dd00: 7361 6d70 6c65 2028 6c69 7374 2872 616e  sample (list(ran
-0000dd10: 642e 7065 726d 7574 6174 696f 6e20 2858  d.permutation (X
-0000dd20: 302e 696e 6465 7820 2929 202c 2031 2029  0.index )) , 1 )
-0000dd30: 0d0a 2020 2020 2020 2020 6978 203d 2072  ..        ix = r
-0000dd40: 616e 646f 6d2e 6368 6f69 6365 2028 7261  andom.choice (ra
-0000dd50: 6e64 2e70 6572 6d75 7461 7469 6f6e 2028  nd.permutation (
-0000dd60: 6273 5f64 2e69 6e64 6578 2029 2920 0d0a  bs_d.index )) ..
-0000dd70: 2020 2020 2020 2020 6d73 203d 2062 735f          ms = bs_
-0000dd80: 642e 6c6f 6320 5b69 7820 5d20 0d0a 2020  d.loc [ix ] ..  
-0000dd90: 2020 2020 2020 0d0a 2020 2020 7265 7475        ..    retu
-0000dda0: 726e 2020 6d73 2020 6966 206e 6f74 2061  rn  ms  if not a
-0000ddb0: 735f 6672 616d 6520 2065 6c73 6520 7064  s_frame  else pd
-0000ddc0: 2e44 6174 6146 7261 6d65 280d 0a20 2020  .DataFrame(..   
-0000ddd0: 2020 2020 2064 6963 7428 6d73 2920 2c20       dict(ms) , 
-0000dde0: 696e 6465 7820 3d20 7261 6e67 6520 2831  index = range (1
-0000ddf0: 2929 0d0a 0d0a 6465 6620 5f61 7373 6572  ))....def _asser
-0000de00: 745f 7265 6475 6365 5f69 6e64 6578 6573  t_reduce_indexes
-0000de10: 2028 2a69 7873 2029 203a 200d 0a20 2020   (*ixs ) : ..   
-0000de20: 2022 2222 2041 7373 6572 7420 7265 6475   """ Assert redu
-0000de30: 6369 6e67 2069 6e64 6578 696e 6720 616e  cing indexing an
-0000de40: 6420 7265 7475 726e 2061 206c 6973 7420  d return a list 
-0000de50: 6f66 2076 616c 6964 7320 696e 6465 7865  of valids indexe
-0000de60: 7320 6069 7873 6022 2222 0d0a 2020 2020  s `ixs`"""..    
-0000de70: 6978 7320 3d20 6c69 7374 2869 7873 2029  ixs = list(ixs )
-0000de80: 0d0a 2020 2020 666f 7220 6969 2c20 6978  ..    for ii, ix
-0000de90: 2069 6e20 656e 756d 6572 6174 6520 2869   in enumerate (i
-0000dea0: 7873 293a 200d 0a20 2020 2020 2020 2069  xs): ..        i
-0000deb0: 6620 6e6f 7420 6973 5f69 7465 7261 626c  f not is_iterabl
-0000dec0: 6528 2069 7829 203a 200d 0a20 2020 2020  e( ix) : ..     
-0000ded0: 2020 2020 2020 2072 6169 7365 2049 6e64         raise Ind
-0000dee0: 6578 4572 726f 7220 2822 4578 7065 6374  exError ("Expect
-0000def0: 7320 6120 7061 6972 2074 7570 6c65 206f  s a pair tuple o
-0000df00: 7220 6c69 7374 2069 2e65 2e5b 7374 6172  r list i.e.[star
-0000df10: 742c 2073 746f 705d 2722 0d0a 2020 2020  t, stop]'"..    
-0000df20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000df30: 2020 2020 2020 2020 2020 6622 2066 6f72            f" for
-0000df40: 2072 6564 7563 696e 6720 696e 6465 7869   reducing indexi
-0000df50: 6e67 3b20 676f 7420 7b69 787d 2229 200d  ng; got {ix}") .
-0000df60: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-0000df70: 6978 2920 213d 3220 3a20 0d0a 2020 2020  ix) !=2 : ..    
-0000df80: 2020 2020 2020 2020 7261 6973 6520 496e          raise In
-0000df90: 6465 7845 7272 6f72 2866 2249 6e64 6578  dexError(f"Index
-0000dfa0: 206d 7573 7420 6265 2061 2070 6169 7220   must be a pair 
-0000dfb0: 5b73 7461 7274 2c20 746f 705d 3a20 676f  [start, top]: go
-0000dfc0: 7420 7b69 787d 2229 0d0a 2020 2020 2020  t {ix}")..      
-0000dfd0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-0000dfe0: 2020 2020 6978 203d 205b 696e 7420 2869      ix = [int (i
-0000dff0: 2920 666f 7220 6920 696e 2069 7820 5d0d  ) for i in ix ].
-0000e000: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-0000e010: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0000e020: 7261 6973 6520 496e 6465 7845 7272 6f72  raise IndexError
-0000e030: 2822 496e 6465 7820 7368 6f75 6c64 2062  ("Index should b
-0000e040: 6520 6120 7061 6972 2074 7570 6c65 2f6c  e a pair tuple/l
-0000e050: 6973 7420 6f66 2069 6e74 6567 6572 733b  ist of integers;
-0000e060: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-0000e070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e080: 6622 2063 6865 636b 207b 6978 7d22 290d  f" check {ix}").
-0000e090: 0a20 2020 2020 2020 2065 6c73 653a 2069  .        else: i
-0000e0a0: 7873 5b69 695d 203d 2069 7820 0d0a 2020  xs[ii] = ix ..  
-0000e0b0: 2020 2020 2020 0d0a 2020 2020 7265 7475        ..    retu
-0000e0c0: 726e 2069 7873 200d 0a0d 0a64 6566 2067  rn ixs ....def g
-0000e0d0: 6574 5f73 6563 7469 6f6e 735f 6672 6f6d  et_sections_from
-0000e0e0: 5f64 6570 7468 2020 287a 2c20 7a5f 7261  _depth  (z, z_ra
-0000e0f0: 6e67 652c 2072 6574 7572 6e5f 696e 6465  nge, return_inde
-0000e100: 7820 3d46 616c 7365 2029 203a 0d0a 2020  x =False ) :..  
-0000e110: 2020 2222 2220 4765 7473 2061 7175 6966    """ Gets aquif
-0000e120: 6572 2073 6563 7469 6f6e 7320 2827 7570  er sections ('up
-0000e130: 7065 7227 2c20 276c 6f77 6572 2729 2069  per', 'lower') i
-0000e140: 6e20 6461 7461 2027 7a27 2066 726f 6d20  n data 'z' from 
-0000e150: 7468 6520 0d0a 2020 2020 6465 7074 6820  the ..    depth 
-0000e160: 7261 6e67 652e 0d0a 2020 2020 0d0a 2020  range...    ..  
-0000e170: 2020 5468 6973 206d 6967 6874 2062 6520    This might be 
-0000e180: 7573 6566 756c 6c20 746f 2063 6f6d 7075  usefull to compu
-0000e190: 7465 2074 6865 2074 6869 636b 6e65 7373  te the thickness
-0000e1a0: 206f 6620 7468 6520 6171 7569 6665 722e   of the aquifer.
-0000e1b0: 200d 0a20 2020 200d 0a20 2020 2050 6172   ..    ..    Par
-0000e1c0: 616d 6574 6572 7320 0d0a 2020 2020 2d2d  ameters ..    --
-0000e1d0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 7a3a  --------..    z:
-0000e1e0: 2061 7272 6179 2d6c 696b 6520 3164 206f   array-like 1d o
-0000e1f0: 7220 7064 2e53 6572 6965 7320 0d0a 2020  r pd.Series ..  
-0000e200: 2020 2020 2020 4172 7261 7920 6f72 2070        Array or p
-0000e210: 616e 6461 7320 7365 7269 6573 2063 6f6e  andas series con
-0000e220: 7461 6e69 6e67 2074 6865 2064 6570 7468  taning the depth
-0000e230: 2076 616c 7565 7320 0d0a 2020 2020 7a5f   values ..    z_
-0000e240: 7261 6e67 653a 2074 7570 6c65 2028 666c  range: tuple (fl
-0000e250: 6f61 7429 2c20 0d0a 2020 2020 2020 2020  oat), ..        
-0000e260: 5365 6374 696f 6e20 5b27 7570 7065 7227  Section ['upper'
-0000e270: 2c20 276c 6f77 6572 275d 206f 6620 7468  , 'lower'] of th
-0000e280: 6520 6171 7569 6665 7220 6174 2064 6966  e aquifer at dif
-0000e290: 6665 726e 7420 6465 7074 682e 0d0a 2020  fernt depth...  
-0000e2a0: 2020 2020 2020 5468 6520 7261 6e67 6520        The range 
-0000e2b0: 6f66 2074 6865 2064 6570 7468 206d 7573  of the depth mus
-0000e2c0: 7420 6120 7061 6972 2076 616c 7565 7320  t a pair values 
-0000e2d0: 616e 6420 2063 6f75 6c64 206e 6f74 2062  and  could not b
-0000e2e0: 650d 0a20 2020 2020 2020 2020 6772 6561  e..         grea
-0000e2f0: 7465 7220 7468 616e 2074 6865 206d 6178  ter than the max
-0000e300: 696d 756d 2064 6570 7468 206f 6620 7468  imum depth of th
-0000e310: 6520 7765 6c6c 2e20 0d0a 2020 2020 7265  e well. ..    re
-0000e320: 7475 726e 5f69 6e64 6578 3a20 626f 6f6c  turn_index: bool
-0000e330: 2c20 6465 6661 756c 743d 4661 6c73 6520  , default=False 
-0000e340: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000e350: 7320 7468 6520 696e 6469 6365 7320 6f66  s the indices of
-0000e360: 2074 6865 2073 6563 7469 6f6e 7320 5b27   the sections ['
-0000e370: 7570 7065 7227 2c20 276c 6f77 6572 275d  upper', 'lower']
-0000e380: 200d 0a20 2020 2020 2020 206f 6620 7468   ..        of th
-0000e390: 6520 6171 7569 6665 7220 616e 6420 6e6f  e aquifer and no
-0000e3a0: 6e2d 7661 6c69 6420 7365 6374 696f 6e73  n-valid sections
-0000e3b0: 2074 6f6f 2e20 0d0a 2020 2020 2020 2020   too. ..        
-0000e3c0: 0d0a 2020 2020 5265 7475 726e 7320 0d0a  ..    Returns ..
-0000e3d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-0000e3e0: 2020 2020 7365 6374 696f 6e73 3a20 5475      sections: Tu
-0000e3f0: 706c 6520 2866 6c6f 6174 2c20 666c 6f61  ple (float, floa
-0000e400: 7429 0d0a 2020 2020 2020 2052 6561 6c20  t)..       Real 
-0000e410: 7661 6c75 6573 206f 6620 7468 6520 2075  values of the  u
-0000e420: 7070 6572 2061 6e64 206c 6f77 6572 2073  pper and lower s
-0000e430: 6563 7469 6f6e 7320 6f66 2074 6865 2061  ections of the a
-0000e440: 7175 6966 6572 2e20 0d0a 2020 2020 4966  quifer. ..    If
-0000e450: 2060 6072 6574 7572 6e5f 696e 6465 7860   ``return_index`
-0000e460: 6020 6973 2027 5472 7565 272c 2066 756e  ` is 'True', fun
-0000e470: 6374 696f 6e20 7265 7475 726e 733a 200d  ction returns: .
-0000e480: 0a20 2020 2020 2028 7570 6978 2c20 6c6f  .      (upix, lo
-0000e490: 7769 7829 3a20 5475 706c 6520 2869 6e74  wix): Tuple (int
-0000e4a0: 2c20 696e 7420 290d 0a20 2020 2020 2020  , int )..       
-0000e4b0: 2020 2069 6e64 6963 6573 206f 6620 7570     indices of up
-0000e4c0: 7065 7220 616e 6420 6c6f 7765 7220 7365  per and lower se
-0000e4d0: 6374 696f 6e73 2069 6e20 7468 6520 6465  ctions in the de
-0000e4e0: 7074 6820 6172 7261 7920 607a 600d 0a20  pth array `z`.. 
-0000e4f0: 2020 2020 2028 696e 7669 7829 3a20 6c69       (invix): li
-0000e500: 7374 206f 6620 5475 706c 6520 2869 6e74  st of Tuple (int
-0000e510: 2c20 696e 7429 200d 0a20 2020 2020 2020  , int) ..       
-0000e520: 2020 206c 6973 7420 6f66 2069 6e64 6963     list of indic
-0000e530: 6573 206f 6620 696e 7661 6c69 6420 7365  es of invalid se
-0000e540: 6374 696f 6e73 0d0a 2020 2020 2020 2020  ctions..        
-0000e550: 2020 0d0a 2020 2020 4578 616d 706c 650d    ..    Example.
-0000e560: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20  .    --------.. 
-0000e570: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
-0000e580: 782e 6461 7461 7365 7473 2069 6d70 6f72  x.datasets impor
-0000e590: 7420 6c6f 6164 5f68 6c6f 6773 200d 0a20  t load_hlogs .. 
-0000e5a0: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
-0000e5b0: 782e 7574 696c 732e 6879 6472 6f75 7469  x.utils.hydrouti
-0000e5c0: 6c73 2069 6d70 6f72 7420 6765 745f 7365  ls import get_se
-0000e5d0: 6374 696f 6e73 5f66 726f 6d5f 6465 7074  ctions_from_dept
-0000e5e0: 680d 0a20 2020 203e 3e3e 2064 6174 613d  h..    >>> data=
-0000e5f0: 206c 6f61 645f 686c 6f67 7328 292e 6672   load_hlogs().fr
-0000e600: 616d 6520 200d 0a20 2020 203e 3e3e 2023  ame  ..    >>> #
-0000e610: 2067 6574 2072 6561 6c20 7365 6374 696f   get real sectio
-0000e620: 6e73 2066 726f 6d20 6465 7074 6820 3136  ns from depth 16
-0000e630: 2e32 3520 746f 2031 3235 2e38 3320 6d0d  .25 to 125.83 m.
-0000e640: 0a20 2020 203e 3e3e 2067 6574 5f73 6563  .    >>> get_sec
-0000e650: 7469 6f6e 735f 6672 6f6d 5f64 6570 7468  tions_from_depth
-0000e660: 2028 2064 6174 612e 6465 7074 685f 746f   ( data.depth_to
-0000e670: 702c 2028 2031 362e 3235 2c20 3132 352e  p, ( 16.25, 125.
-0000e680: 3833 2929 0d0a 2020 2020 2e2e 2e20 2028  83))..    ...  (
-0000e690: 3232 2e34 362c 2031 3238 2e32 3329 0d0a  22.46, 128.23)..
-0000e6a0: 2020 2020 3e3e 3e20 2320 6171 7569 6665      >>> # aquife
-0000e6b0: 7220 6465 7074 6820 6672 6f6d 2031 362e  r depth from 16.
-0000e6c0: 3235 206d 2074 6f20 7468 6520 656e 6420  25 m to the end 
-0000e6d0: 0d0a 2020 2020 3e3e 3e20 6765 745f 7365  ..    >>> get_se
-0000e6e0: 6374 696f 6e73 5f66 726f 6d5f 6465 7074  ctions_from_dept
-0000e6f0: 6820 2820 6461 7461 2e64 6570 7468 5f74  h ( data.depth_t
-0000e700: 6f70 2c20 2820 3136 2e32 352c 2929 0d0a  op, ( 16.25,))..
-0000e710: 2020 2020 2e2e 2e20 2832 322e 3436 2c20      ... (22.46, 
-0000e720: 3639 332e 3337 290d 0a20 2020 203e 3e3e  693.37)..    >>>
-0000e730: 2067 6574 5f73 6563 7469 6f6e 735f 6672   get_sections_fr
-0000e740: 6f6d 5f64 6570 7468 2028 2064 6174 612e  om_depth ( data.
-0000e750: 6465 7074 685f 746f 702c 2028 2031 362e  depth_top, ( 16.
-0000e760: 3235 2c20 3132 352e 3833 292c 0d0a 2020  25, 125.83),..  
-0000e770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e780: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000e790: 6574 7572 6e5f 696e 6465 7820 3d54 7275  eturn_index =Tru
-0000e7a0: 6520 290d 0a20 2020 202e 2e2e 2028 2833  e )..    ... ((3
-0000e7b0: 2c20 3131 292c 205b 2830 2c20 3329 2c20  , 11), [(0, 3), 
-0000e7c0: 2831 312c 2031 3830 295d 290d 0a20 2020  (11, 180)])..   
-0000e7d0: 203e 3e3e 2067 6574 5f73 6563 7469 6f6e   >>> get_section
-0000e7e0: 735f 6672 6f6d 5f64 6570 7468 2028 2064  s_from_depth ( d
-0000e7f0: 6174 612e 6465 7074 685f 746f 702c 2028  ata.depth_top, (
-0000e800: 2031 362e 3235 2c29 2c20 0d0a 2020 2020   16.25,), ..    
-0000e810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e820: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0000e830: 7572 6e5f 696e 6465 7820 3d54 7275 6520  urn_index =True 
-0000e840: 290d 0a20 2020 202e 2e2e 2028 2833 2c20  )..    ... ((3, 
-0000e850: 3138 3129 2c20 5b28 302c 2033 295d 290d  181), [(0, 3)]).
-0000e860: 0a20 0d0a 2020 2020 2222 220d 0a20 2020  . ..    """..   
-0000e870: 207a 203d 205f 6173 7365 7274 5f61 6c6c   z = _assert_all
-0000e880: 5f74 7970 6573 287a 2c20 7064 2e53 6572  _types(z, pd.Ser
-0000e890: 6965 732c 206e 702e 6e64 6172 7261 7920  ies, np.ndarray 
-0000e8a0: 2c20 2244 6570 7468 2229 0d0a 2020 2020  , "Depth")..    
-0000e8b0: 6966 206e 6f74 205f 6973 5f61 7272 6179  if not _is_array
-0000e8c0: 6c69 6b65 5f31 6420 287a 2920 3a20 0d0a  like_1d (z) : ..
-0000e8d0: 2020 2020 2020 2020 7261 6973 6520 4465          raise De
-0000e8e0: 7074 6845 7272 6f72 2820 2244 6570 7468  pthError( "Depth
-0000e8f0: 2065 7870 6563 7473 206f 6e65 2d64 696d   expects one-dim
-0000e900: 656e 7369 6f6e 616c 2061 7272 6179 2e22  ensional array."
-0000e910: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-0000e920: 2023 2063 6865 636b 2064 6570 7468 207a   # check depth z
-0000e930: 2061 7272 6179 200d 0a20 2020 207a 3d20   array ..    z= 
-0000e940: 6368 6563 6b5f 7920 280d 0a20 2020 2020  check_y (..     
-0000e950: 2020 207a 2c20 0d0a 2020 2020 2020 2020     z, ..        
-0000e960: 696e 7075 745f 6e61 6d65 3d20 2241 7272  input_name= "Arr
-0000e970: 6179 206f 6620 6465 7074 6820 277a 2722  ay of depth 'z'"
-0000e980: 2c20 0d0a 2020 2020 2020 2020 746f 5f66  , ..        to_f
-0000e990: 7261 6d65 203d 5472 7565 2c20 0d0a 2020  rame =True, ..  
-0000e9a0: 2020 2020 2020 290d 0a20 2020 2069 6620        )..    if 
-0000e9b0: 6e6f 7420 6973 5f69 7465 7261 626c 6528  not is_iterable(
-0000e9c0: 7a5f 7261 6e67 6529 3a20 0d0a 2020 2020  z_range): ..    
-0000e9d0: 2020 2020 7265 7475 726e 2054 7970 6545      return TypeE
-0000e9e0: 7272 6f72 2028 2244 6570 7468 2072 616e  rror ("Depth ran
-0000e9f0: 6765 206d 7573 7420 6265 2061 6e20 6974  ge must be an it
-0000ea00: 6572 6162 6c65 206f 626a 6563 742c 220d  erable object,".
-0000ea10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ea20: 2020 2020 2020 2020 2020 2066 2220 6e6f             f" no
-0000ea30: 7420 7b74 7970 6520 287a 5f72 616e 6765  t {type (z_range
-0000ea40: 292e 5f5f 6e61 6d65 5f5f 2172 7d22 290d  ).__name__!r}").
-0000ea50: 0a20 2020 207a 5f72 616e 6765 3d20 736f  .    z_range= so
-0000ea60: 7274 6564 2028 206c 6973 7428 7a5f 7261  rted ( list(z_ra
-0000ea70: 6e67 6520 2920 2920 0d0a 2020 2020 6966  nge ) ) ..    if
-0000ea80: 206d 6178 287a 5f72 616e 6765 2029 203e   max(z_range ) >
-0000ea90: 206d 6178 287a 293a 200d 0a20 2020 2020   max(z): ..     
-0000eaa0: 2020 2072 6169 7365 2044 6570 7468 4572     raise DepthEr
-0000eab0: 726f 7228 2244 6570 7468 2076 616c 7565  ror("Depth value
-0000eac0: 2063 616e 6e6f 7420 6265 2067 7265 6174   cannot be great
-0000ead0: 6572 2074 6861 6e20 7468 6520 6d61 7869  er than the maxi
-0000eae0: 6d75 6d20 220d 0a20 2020 2020 2020 2020  mum "..         
-0000eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb00: 6622 6465 7074 6820 696e 2074 6865 2077  f"depth in the w
-0000eb10: 656c 6c3d 207b 6d61 7828 7a29 7d3b 2067  ell= {max(z)}; g
-0000eb20: 6f74 207b 6d61 7828 7a5f 7261 6e67 6529  ot {max(z_range)
-0000eb30: 7d22 290d 0a20 2020 2069 6620 6c65 6e28  }")..    if len(
-0000eb40: 7a5f 7261 6e67 6529 3d3d 313a 200d 0a20  z_range)==1: .. 
-0000eb50: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-0000eb60: 7761 726e 2822 5369 6e67 6c65 2076 616c  warn("Single val
-0000eb70: 7565 2069 7320 7061 7373 6564 2e20 5265  ue is passed. Re
-0000eb80: 6d65 6d62 6572 2c20 6974 206d 6179 2063  member, it may c
-0000eb90: 6f72 7265 7370 6f6e 6420 220d 0a20 2020  orrespond "..   
-0000eba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ebb0: 2020 2022 746f 2074 6865 2064 6570 7468     "to the depth
-0000ebc0: 2076 616c 7565 206f 6620 7468 6520 7570   value of the up
-0000ebd0: 7065 7220 7365 6374 696f 6e20 7468 696e  per section thin
-0000ebe0: 2074 6865 2065 6e64 2e22 290d 0a20 2020   the end.")..   
-0000ebf0: 2020 2020 207a 5f72 616e 6765 203d 207a       z_range = z
-0000ec00: 5f72 616e 6765 202b 205b 6d61 7820 287a  _range + [max (z
-0000ec10: 2029 5d0d 0a20 2020 2065 6c69 6620 6c65   )]..    elif le
-0000ec20: 6e28 7a5f 7261 6e67 6529 203e 2032 3a20  n(z_range) > 2: 
-0000ec30: 0d0a 2020 2020 2020 2020 7261 6973 6520  ..        raise 
-0000ec40: 4465 7074 6845 7272 6f72 2820 2254 6f6f  DepthError( "Too
-0000ec50: 206d 616e 7920 7661 6c75 6573 2066 6f72   many values for
-0000ec60: 2074 6865 2064 6570 7468 2073 6563 7469   the depth secti
-0000ec70: 6f6e 2072 616e 6765 2e22 0d0a 2020 2020  on range."..    
-0000ec80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec90: 2020 2020 2022 4578 7065 6374 7320 6120       "Expects a 
-0000eca0: 7061 6972 2076 616c 7565 7320 5b20 7570  pair values [ up
-0000ecb0: 7065 722c 206c 6f77 6572 5d20 7365 6374  per, lower] sect
-0000ecc0: 696f 6e73 2e22 0d0a 2020 2020 2020 2020  ions."..        
-0000ecd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ece0: 2029 0d0a 2020 2020 2320 6765 7420 7468   )..    # get th
-0000ecf0: 6520 696e 6469 6365 7320 6672 6f6d 2064  e indices from d
-0000ed00: 6570 7468 200d 0a20 2020 2075 7069 7820  epth ..    upix 
-0000ed10: 203d 206e 702e 6172 676d 696e 2020 2820   = np.argmin  ( 
-0000ed20: 6e70 2e61 6273 2028 200d 0a20 2020 2020  np.abs ( ..     
-0000ed30: 2020 2028 6e70 2e61 7272 6179 287a 2920     (np.array(z) 
-0000ed40: 2d20 7a5f 7261 6e67 6520 5b30 5d20 2920  - z_range [0] ) 
-0000ed50: 2920 2920 0d0a 2020 2020 6c6f 7769 7820  ) ) ..    lowix 
-0000ed60: 3d20 6e70 2e61 7267 6d69 6e20 2028 206e  = np.argmin  ( n
-0000ed70: 702e 6162 7320 280d 0a20 2020 2020 2020  p.abs (..       
-0000ed80: 2028 6e70 2e61 7272 6179 287a 2920 2d20   (np.array(z) - 
-0000ed90: 7a5f 7261 6e67 6520 5b2d 315d 2029 2029  z_range [-1] ) )
-0000eda0: 2029 200d 0a20 2020 2023 2066 6f72 2063   ) ..    # for c
-0000edb0: 6f6e 7369 7374 656e 6379 202c 2072 6573  onsistency , res
-0000edc0: 6574 5f7a 7261 6e67 6520 7769 7468 200d  et_zrange with .
-0000edd0: 0a20 2020 2023 2074 7275 6520 7661 6c75  .    # true valu
-0000ede0: 6573 2066 726f 6d20 6465 7074 6820 7a20  es from depth z 
-0000edf0: 0d0a 2020 2020 7365 6374 696f 6e73 203d  ..    sections =
-0000ee00: 2028 207a 205b 7570 6978 205d 2c20 7a5b   ( z [upix ], z[
-0000ee10: 6c6f 7769 7820 5d20 2920 200d 0a20 2020  lowix ] )  ..   
-0000ee20: 207a 5f72 616e 6765 203d 2020 6e70 2e61   z_range =  np.a
-0000ee30: 7272 6179 2028 2028 2075 7069 7820 2c20  rray ( ( upix , 
-0000ee40: 6c6f 7769 7820 2920 2c20 6474 7970 6520  lowix ) , dtype 
-0000ee50: 3d20 6e70 2e69 6e74 3332 2029 200d 0a0d  = np.int32 ) ...
-0000ee60: 0a20 2020 2023 2063 6f6d 7075 7465 2074  .    # compute t
-0000ee70: 6865 2064 6966 6665 7265 6e63 6520 6265  he difference be
-0000ee80: 7477 6565 6e20 6164 6a61 6365 6e74 2064  tween adjacent d
-0000ee90: 6570 7468 730d 0a20 2020 2064 6966 6620  epths..    diff 
-0000eea0: 3d20 6e70 2e64 6966 6620 287a 2920 0d0a  = np.diff (z) ..
-0000eeb0: 2020 2020 2320 7768 656e 2064 6570 7468      # when depth
-0000eec0: 200d 0a20 2020 2069 6620 7365 7420 2873   ..    if set (s
-0000eed0: 6563 7469 6f6e 7320 293d 3d31 3a20 0d0a  ections )==1: ..
-0000eee0: 2020 2020 2020 2020 7261 6973 6520 4465          raise De
-0000eef0: 7074 6845 7272 6f72 2822 5570 7065 7220  pthError("Upper 
-0000ef00: 616e 6420 6c6f 7765 7220 7365 6374 696f  and lower sectio
-0000ef10: 6e73 206d 7573 7420 6861 7665 2064 6966  ns must have dif
-0000ef20: 6665 7265 6e74 2064 6570 7468 732e 2229  ferent depths.")
-0000ef30: 0d0a 2020 2020 0d0a 2020 2020 6966 2028  ..    ..    if (
-0000ef40: 2066 6c6f 6174 2820 6e70 2e64 6966 6620   float( np.diff 
-0000ef50: 2873 6563 7469 6f6e 7329 2920 3c3d 6469  (sections)) <=di
-0000ef60: 6666 2e6d 696e 2829 2029 3a20 0d0a 2020  ff.min() ): ..  
-0000ef70: 2020 2020 2020 2320 7468 6963 6b6e 6573        # thicknes
-0000ef80: 7320 746f 2070 6173 7320 746f 2061 6e6f  s to pass to ano
-0000ef90: 7468 6572 206c 6179 6572 7320 0d0a 2020  ther layers ..  
-0000efa0: 2020 2020 2020 7261 6973 6520 4465 7074        raise Dept
-0000efb0: 6845 7272 6f72 2866 2244 6570 7468 207b  hError(f"Depth {
-0000efc0: 7a5f 7261 6e67 657d 2061 7265 2074 6f6f  z_range} are too
-0000efd0: 2063 6c6f 7365 2074 6861 7420 7072 6f62   close that prob
-0000efe0: 6162 6c79 2022 0d0a 2020 2020 2020 2020  ably "..        
-0000eff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f000: 2022 6669 6775 7265 206f 7574 2074 6865   "figure out the
-0000f010: 2073 616d 6520 6c61 7965 722e 2044 6966   same layer. Dif
-0000f020: 6665 7265 6e63 6520 6265 7477 6565 6e20  ference between 
-0000f030: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-0000f040: 2020 2020 2020 2020 2020 2020 2261 646a              "adj
-0000f050: 6163 656e 7420 6465 7074 6873 206d 7573  acent depths mus
-0000f060: 7420 6265 2067 7265 6174 6572 2074 6861  t be greater tha
-0000f070: 6e22 0d0a 2020 2020 2020 2020 2020 2020  n"..            
-0000f080: 2020 2020 2020 2020 2020 2020 6622 207b              f" {
-0000f090: 726f 756e 6420 2820 666c 6f61 7428 6469  round ( float(di
-0000f0a0: 6666 2e6d 696e 2829 292c 2032 2920 7d22  ff.min()), 2) }"
-0000f0b0: 290d 0a20 2020 2023 206e 6f74 2067 6574  )..    # not get
-0000f0c0: 2074 6865 2069 6e64 6578 2066 726f 6d20   the index from 
-0000f0d0: 6e6f 6e20 7661 6c69 6420 6461 7461 0d0a  non valid data..
-0000f0e0: 2020 2020 2320 2b31 2066 6f72 2050 7974      # +1 for Pyt
-0000f0f0: 686f 6e20 696e 6465 7869 6e67 0d0a 2020  hon indexing..  
-0000f100: 2020 696e 7669 7820 3d20 5f67 6574 5f69    invix = _get_i
-0000f110: 6e76 616c 6964 5f69 6e64 6578 6573 2028  nvalid_indexes (
-0000f120: 7a2c 207a 5f72 616e 6765 2029 0d0a 2020  z, z_range )..  
-0000f130: 2020 0d0a 2020 2020 7265 7475 726e 2020    ..    return  
-0000f140: 7365 6374 696f 6e73 2069 6620 6e6f 7420  sections if not 
-0000f150: 2072 6574 7572 6e5f 696e 6465 7820 656c   return_index el
-0000f160: 7365 2028 200d 0a20 2020 2020 2020 2028  se ( ..        (
-0000f170: 2075 7069 7820 2c20 6c6f 7769 7820 2b20   upix , lowix + 
-0000f180: 3120 292c 2020 696e 7669 7820 2920 0d0a  1 ),  invix ) ..
-0000f190: 0d0a 0d0a 6465 6620 6765 745f 756e 6971  ....def get_uniq
-0000f1a0: 7565 5f73 6563 7469 6f6e 2028 0d0a 2020  ue_section (..  
-0000f1b0: 2020 2020 2020 2a64 6174 612c 207a 6e61        *data, zna
-0000f1c0: 6d65 2c20 6b6e 616d 652c 2020 7265 7475  me, kname,  retu
-0000f1d0: 726e 5f69 6e64 6578 3d46 616c 7365 2c20  rn_index=False, 
-0000f1e0: 7265 7475 726e 5f64 6174 6120 3d46 616c  return_data =Fal
-0000f1f0: 7365 2c20 0d0a 2020 2020 2020 2020 6572  se, ..        er
-0000f200: 726f 723d 2772 6169 7365 272c 202a 2a6b  ror='raise', **k
-0000f210: 7773 2029 203a 200d 0a0d 0a20 2020 2073  ws ) : ....    s
-0000f220: 6563 742c 2064 6174 203d 2067 6574 5f61  ect, dat = get_a
-0000f230: 7175 6966 6572 5f73 6563 7469 6f6e 7328  quifer_sections(
-0000f240: 2a64 6174 612c 207a 6e61 6d65 3d7a 6e61  *data, zname=zna
-0000f250: 6d65 2c20 6b6e 616d 653d 6b6e 616d 652c  me, kname=kname,
-0000f260: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000f270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f280: 2020 2020 7265 7475 726e 5f69 6e64 6578      return_index
-0000f290: 203d 7265 7475 726e 5f69 6e64 6578 2c20   =return_index, 
-0000f2a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f2c0: 2020 2072 6574 7572 6e5f 6461 7461 3d20     return_data= 
-0000f2d0: 5472 7565 2c0d 0a20 2020 2020 2020 2020  True,..         
-0000f2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f2f0: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
-0000f300: 6572 726f 7220 2c20 2a2a 6b77 7329 0d0a  error , **kws)..
-0000f310: 2020 2020 7365 6374 203d 206e 702e 6172      sect = np.ar
-0000f320: 7261 7920 286c 6973 7428 6974 6572 746f  ray (list(iterto
-0000f330: 6f6c 732e 6368 6169 6e28 2a73 6563 7429  ols.chain(*sect)
-0000f340: 2929 0d0a 2020 2020 7369 203d 206e 702e  ))..    si = np.
-0000f350: 6172 7261 7920 285b 7365 6374 2e6d 696e  array ([sect.min
-0000f360: 2829 2c20 7365 6374 2e6d 6178 2829 5d2c  (), sect.max()],
-0000f370: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000f380: 2020 2020 2020 6474 7970 6520 3d20 6e70        dtype = np
-0000f390: 2e69 6e74 3332 2069 6620 7265 7475 726e  .int32 if return
-0000f3a0: 5f69 6e64 6578 2065 6c73 6520 6e70 2e66  _index else np.f
-0000f3b0: 6c6f 6174 3332 2029 0d0a 2020 2020 7265  loat32 )..    re
-0000f3c0: 7475 726e 2073 6920 6966 206e 6f74 2072  turn si if not r
-0000f3d0: 6574 7572 6e5f 6461 7461 2065 6c73 6520  eturn_data else 
-0000f3e0: 2028 2073 692c 2064 6174 2029 200d 0a0d   ( si, dat ) ...
-0000f3f0: 0a67 6574 5f75 6e69 7175 655f 7365 6374  .get_unique_sect
-0000f400: 696f 6e2e 5f5f 646f 635f 5f3d 2222 225c  ion.__doc__="""\
-0000f410: 0d0a 4765 7420 7468 6520 7365 6374 696f  ..Get the sectio
-0000f420: 6e20 746f 2063 6f6e 7369 6465 7220 756e  n to consider un
-0000f430: 6971 7565 2069 6e20 6d75 6c74 6970 6c65  ique in multiple
-0000f440: 2061 7175 6966 6572 732e 200d 0a0d 0a54   aquifers. ....T
-0000f450: 6865 2075 6e69 7175 6520 7365 6374 696f  he unique sectio
-0000f460: 6e20 2775 7070 6572 2720 616e 6420 276c  n 'upper' and 'l
-0000f470: 6f77 6572 2720 6973 2074 6865 2076 616c  ower' is the val
-0000f480: 6964 2072 616e 6765 206f 6620 7468 6520  id range of the 
-0000f490: 7768 6f6c 6520 0d0a 7365 6374 696f 6e73  whole ..sections
-0000f4a0: 206f 6620 6561 6368 2061 7175 6966 6572   of each aquifer
-0000f4b0: 732e 2049 7420 6973 2020 636f 6e73 6964  s. It is  consid
-0000f4c0: 6572 6564 2061 7320 2074 6865 206d 6169  ered as  the mai
-0000f4d0: 6e20 7661 6c69 6420 7365 6374 696f 6e20  n valid section 
-0000f4e0: 0d0a 6672 6f6d 2077 6869 6368 2064 6174  ..from which dat
-0000f4f0: 6120 6361 6e20 6e6f 7420 6265 2063 6f6d  a can not be com
-0000f500: 7072 6573 7365 6420 616e 6420 6e6f 7420  pressed and not 
-0000f510: 616c 7465 7265 642e 2046 6f72 2069 6e73  altered. For ins
-0000f520: 7461 6e63 652c 2020 0d0a 7468 6520 7573  tance,  ..the us
-0000f530: 6520 6f66 2069 6e64 6578 6573 2069 7320  e of indexes is 
-0000f540: 206e 6563 6573 7361 7279 2074 6f20 7368   necessary to sh
-0000f550: 7275 6e6b 2074 6865 2064 6174 6120 6578  runk the data ex
-0000f560: 6365 7074 2074 6869 7320 7661 6c69 6420  cept this valid 
-0000f570: 0d0a 7365 6374 696f 6e2e 204d 6f73 6c79  ..section. Mosly
-0000f580: 2074 6865 2064 6174 6120 6672 6f6d 2074   the data from t
-0000f590: 6865 2073 6563 7469 6f6e 2069 7320 636f  he section is co
-0000f5a0: 6e73 6964 6572 6564 2074 6865 2076 616c  nsidered the val
-0000f5b0: 6964 2064 6174 6120 6173 2074 6865 200d  id data as the .
-0000f5c0: 0a70 7265 6469 6374 6f72 2058 722e 204f  .predictor Xr. O
-0000f5d0: 7574 206f 6620 7468 6520 7261 6e67 6520  ut of the range 
-0000f5e0: 6f66 2061 7175 6966 6572 7320 6563 7469  of aquifers ecti
-0000f5f0: 6f6e 2c20 6461 7461 2063 616e 2062 6520  on, data can be 
-0000f600: 6469 7363 6172 6465 6420 6f72 200d 0a63  discarded or ..c
-0000f610: 6f6d 7072 6573 7365 6420 746f 2074 6f70  ompressed to top
-0000f620: 2058 722e 200d 0a0d 0a52 6574 7572 6e73   Xr. ....Returns
-0000f630: 2076 616c 6964 2073 6563 7469 6f6e 2069   valid section i
-0000f640: 6e64 6578 6573 2069 6620 2772 6574 7572  ndexes if 'retur
-0000f650: 6e5f 696e 6465 7827 2069 7320 7365 7420  n_index' is set 
-0000f660: 746f 2060 6054 7275 6560 602e 2020 2020  to ``True``.    
-0000f670: 0d0a 2020 2020 0d0a 5061 7261 6d65 7465  ..    ..Paramete
-0000f680: 7273 0d0a 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  rs..-----------.
-0000f690: 0a64 3a20 6c69 7374 206f 6620 7061 6e64  .d: list of pand
-0000f6a0: 6173 2064 6174 6166 7261 6d65 200d 0a20  as dataframe .. 
-0000f6b0: 2020 2044 6174 6120 7468 6174 2063 6f6e     Data that con
-0000f6c0: 7461 696e 7320 6d61 696e 6c79 2074 6865  tains mainly the
-0000f6d0: 2061 7175 6966 6572 2076 616c 7565 732e   aquifer values.
-0000f6e0: 2049 7420 6e65 6564 7320 746f 2073 7065   It needs to spe
-0000f6f0: 6369 6679 2074 6865 200d 0a20 2020 206e  cify the ..    n
-0000f700: 616d 6520 6f66 2074 6865 2064 6570 7468  ame of the depth
-0000f710: 2063 6f6c 756d 6e20 607a 6e61 6d65 6020   column `zname` 
-0000f720: 6173 2077 656c 6c20 6173 2074 6865 206e  as well as the n
-0000f730: 616d 6520 6f66 2070 6572 6d65 6162 696c  ame of permeabil
-0000f740: 6979 200d 0a20 2020 2060 6b6e 616d 6560  iy ..    `kname`
-0000f750: 2063 6f6c 756d 6e2e 2020 0d0a 7b70 6172   column.  ..{par
-0000f760: 616d 732e 636f 7265 2e7a 6e61 6d65 7d0d  ams.core.zname}.
-0000f770: 0a7b 7061 7261 6d73 2e63 6f72 652e 6b6e  .{params.core.kn
-0000f780: 616d 657d 0d0a 7b70 6172 616d 732e 636f  ame}..{params.co
-0000f790: 7265 2e7a 7d0d 0a0d 0a72 6574 7572 6e5f  re.z}....return_
-0000f7a0: 696e 6465 783a 2062 6f6f 6c2c 2064 6566  index: bool, def
-0000f7b0: 6175 6c74 203d 4661 6c73 6520 2c20 0d0a  ault =False , ..
-0000f7c0: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
-0000f7d0: 706f 7369 7469 6f6e 7320 2869 6e64 6578  positions (index
-0000f7e0: 6573 2920 6f66 2074 6865 2075 7070 6572  es) of the upper
-0000f7f0: 2061 6e64 206c 6f77 6572 2073 6563 7469   and lower secti
-0000f800: 6f6e 7320 6f66 2074 6865 0d0a 2020 2020  ons of the..    
-0000f810: 7368 616c 6c6f 7765 7220 2061 6e64 2064  shallower  and d
-0000f820: 6565 7020 6171 7569 6665 7273 2066 6f75  eep aquifers fou
-0000f830: 6e64 2069 6e20 7468 6520 7768 6f6c 6520  nd in the whole 
-0000f840: 2064 6174 6166 7261 6d65 732e 0d0a 7265   dataframes...re
-0000f850: 7475 726e 5f64 6174 613a 2062 6f6f 6c2c  turn_data: bool,
-0000f860: 2064 6566 6175 6c74 3d46 616c 7365 2c20   default=False, 
-0000f870: 0d0a 2020 2020 5265 7475 726e 2076 616c  ..    Return val
-0000f880: 6964 2064 6174 612e 2049 7420 6973 2075  id data. It is u
-0000f890: 7365 6675 6c6c 2077 6865 6e20 2765 7272  sefull when 'err
-0000f8a0: 6f72 2720 6973 2073 6574 2074 6f20 2769  or' is set to 'i
-0000f8b0: 676e 6f72 6527 0d0a 2020 2020 746f 2063  gnore'..    to c
-0000f8c0: 6f6c 6c65 6374 2074 6865 2076 616c 6964  ollect the valid
-0000f8d0: 2064 6174 612e 200d 0a65 7272 6f72 3a20   data. ..error: 
-0000f8e0: 7374 722c 2064 6566 6175 6c74 3d27 7261  str, default='ra
-0000f8f0: 6973 6527 200d 0a20 2020 2052 6169 7365  ise' ..    Raise
-0000f900: 2065 7272 6f72 7320 6966 2074 726f 7562   errors if troub
-0000f910: 6c65 206f 6363 7572 7320 7768 656e 2063  le occurs when c
-0000f920: 6f6d 7075 7469 6e67 2074 6865 2073 6563  omputing the sec
-0000f930: 7469 6f6e 206f 6620 6561 6368 2061 7175  tion of each aqu
-0000f940: 6966 6572 2e20 0d0a 2020 2020 4966 2027  ifer. ..    If '
-0000f950: 6967 6e6f 7265 272c 2061 2055 7365 7257  ignore', a UserW
-0000f960: 6172 6e69 6e67 2069 7320 6469 7370 6c61  arning is displa
-0000f970: 7965 6420 7768 656e 2069 6e76 616c 6964  yed when invalid
-0000f980: 2064 6174 6120 6973 2066 6f75 6e64 2e20   data is found. 
-0000f990: 416e 7920 0d0a 2020 2020 6f74 6865 7220  Any ..    other 
-0000f9a0: 7661 6c75 6520 6f66 2060 6572 726f 7260  value of `error`
-0000f9b0: 2077 696c 6c20 7365 7420 6572 726f 7220   will set error 
-0000f9c0: 746f 2060 7261 6973 6560 2e20 0d0a 6b77  to `raise`. ..kw
-0000f9d0: 733a 2064 6963 742c 200d 0a20 2020 2041  s: dict, ..    A
-0000f9e0: 6464 6974 696f 6e61 6c20 6b65 7977 6f72  dditional keywor
-0000f9f0: 6473 2061 7267 756d 656e 7473 2070 6173  ds arguments pas
-0000fa00: 7365 6420 2074 6f20 200d 0a20 2020 203a  sed  to  ..    :
-0000fa10: 6675 6e63 3a60 7e77 6174 6578 2e75 7469  func:`~watex.uti
-0000fa20: 6c73 2e68 7964 726f 7574 696c 732e 6765  ls.hydroutils.ge
-0000fa30: 745f 6171 7569 6665 725f 7365 6374 696f  t_aquifer_sectio
-0000fa40: 6e73 602e 0d0a 2020 2020 0d0a 5265 7475  ns`...    ..Retu
-0000fa50: 726e 7320 0d0a 2d2d 2d2d 2d2d 2d2d 0d0a  rns ..--------..
-0000fa60: 7570 2c20 6c6f 7720 3a6c 6973 7420 6f66  up, low :list of
-0000fa70: 2075 7070 6572 2061 6e64 206c 6f77 6572   upper and lower
-0000fa80: 2073 6563 7469 6f6e 2076 616c 7565 7320   section values 
-0000fa90: 6f66 2061 7175 6966 6572 2e0d 0a20 2020  of aquifer...   
-0000faa0: 202d 2028 7570 6978 2c20 6c6f 7769 7820   - (upix, lowix 
-0000fab0: 293a 2054 7570 6c65 206f 6620 696e 6465  ): Tuple of inde
-0000fac0: 7865 7320 6f66 206c 6f77 6572 2061 6e64  xes of lower and
-0000fad0: 2075 7070 6572 2073 6563 7469 6f6e 7320   upper sections 
-0000fae0: 200d 0a20 2020 202d 2028 7570 2c20 6c6f   ..    - (up, lo
-0000faf0: 7729 3a20 5475 706c 6520 6f66 2061 7175  w): Tuple of aqu
-0000fb00: 6966 6572 2073 6563 7469 6f6e 7320 2875  ifer sections (u
-0000fb10: 7070 6572 2061 6e64 206c 6f77 6572 2920  pper and lower) 
-0000fb20: 200d 0a20 2020 202d 2028 7570 6978 2c20   ..    - (upix, 
-0000fb30: 6c6f 7769 7829 2c20 2875 702c 206c 6f77  lowix), (up, low
-0000fb40: 2920 3a20 706f 7369 7469 6f6e 7320 616e  ) : positions an
-0000fb50: 6420 7365 6374 696f 6e73 2076 616c 7565  d sections value
-0000fb60: 7320 6f66 2061 7175 6966 6572 7320 0d0a  s of aquifers ..
-0000fb70: 2020 2020 2020 2020 6966 2060 7265 7475          if `retu
-0000fb80: 726e 5f69 6e64 6578 6020 616e 6420 7265  rn_index` and re
-0000fb90: 7475 726e 5f73 6563 7469 6f6e 7360 2061  turn_sections` a
-0000fba0: 7265 2060 6054 7275 6560 602e 2020 0d0a  re ``True``.  ..
-0000fbb0: 0d0a 5365 6520 416c 736f 200d 0a2d 2d2d  ..See Also ..---
-0000fbc0: 2d2d 2d2d 2d2d 2d0d 0a77 6174 6578 2e75  -------..watex.u
-0000fbd0: 7469 6c73 2e68 7964 726f 7574 696c 732e  tils.hydroutils.
-0000fbe0: 6765 745f 6171 7569 6665 725f 7365 6374  get_aquifer_sect
-0000fbf0: 696f 6e3a 2063 6f6d 7075 7465 2073 696e  ion: compute sin
-0000fc00: 676c 6520 7365 6374 696f 6e0d 0a0d 0a77  gle section....w
-0000fc10: 6174 6578 2e75 7469 6c73 2e68 7964 726f  atex.utils.hydro
-0000fc20: 7574 696c 732e 6765 745f 6171 7569 6665  utils.get_aquife
-0000fc30: 725f 7365 6374 696f 6e73 3a20 636f 6d70  r_sections: comp
-0000fc40: 7574 6520 6d75 6c74 6970 6c65 2073 6563  ute multiple sec
-0000fc50: 7469 6f6e 7320 0d0a 200d 0a0d 0a45 7861  tions .. ....Exa
-0000fc60: 6d70 6c65 0d0a 2d2d 2d2d 2d2d 2d20 2020  mple..-------   
-0000fc70: 0d0a 3e3e 3e20 6672 6f6d 2077 6174 6578  ..>>> from watex
-0000fc80: 2e64 6174 6173 6574 7320 696d 706f 7274  .datasets import
-0000fc90: 206c 6f61 645f 686c 6f67 7320 0d0a 3e3e   load_hlogs ..>>
-0000fca0: 3e20 6461 7461 203d 206c 6f61 645f 686c  > data = load_hl
-0000fcb0: 6f67 7320 2829 2e66 7261 6d65 200d 0a3e  ogs ().frame ..>
-0000fcc0: 3e3e 2067 6574 5f75 6e69 7175 655f 7365  >> get_unique_se
-0000fcd0: 6374 696f 6e20 2864 6174 612e 636f 7079  ction (data.copy
-0000fce0: 2829 202c 207a 6e61 6d65 203d 2764 6570  () , zname ='dep
-0000fcf0: 7468 272c 206b 6e61 6d65 203d 276b 272c  th', kname ='k',
-0000fd00: 2029 200d 0a2e 2e2e 2061 7272 6179 285b   ) ..... array([
-0000fd10: 3139 372e 3132 2c20 3336 392e 3731 5d2c  197.12, 369.71],
-0000fd20: 2064 7479 7065 3d66 6c6f 6174 3332 290d   dtype=float32).
-0000fd30: 0a3e 3e3e 2067 6574 5f75 6e69 7175 655f  .>>> get_unique_
-0000fd40: 7365 6374 696f 6e73 2028 6461 7461 2e63  sections (data.c
-0000fd50: 6f70 7928 2920 2c20 7a6e 616d 6520 3d27  opy() , zname ='
-0000fd60: 6465 7074 6827 2c20 6b6e 616d 6520 3d27  depth', kname ='
-0000fd70: 6b27 2c20 0d0a 2020 2020 2020 2020 2020  k', ..          
-0000fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fd90: 2020 2020 2020 7265 7475 726e 5f69 6e64        return_ind
-0000fda0: 6578 203d 5472 7565 290d 0a2e 2e2e 2061  ex =True)..... a
-0000fdb0: 7272 6179 285b 3136 2c20 3239 5d29 0d0a  rray([16, 29])..
-0000fdc0: 0d0a 2222 222e 666f 726d 6174 280d 0a20  ..""".format(.. 
-0000fdd0: 2020 2070 6172 616d 733d 5f70 6172 616d     params=_param
-0000fde0: 5f64 6f63 732c 0d0a 2020 2020 290d 0a20  _docs,..    ).. 
-0000fdf0: 2020 200d 0a64 6566 2067 6574 5f61 7175     ..def get_aqu
-0000fe00: 6966 6572 5f73 6563 7469 6f6e 7320 280d  ifer_sections (.
-0000fe10: 0a20 2020 202a 6461 7461 202c 2020 0d0a  .    *data ,  ..
-0000fe20: 2020 2020 7a6e 616d 652c 200d 0a20 2020      zname, ..   
-0000fe30: 206b 6e61 6d65 2c20 0d0a 2020 2020 7265   kname, ..    re
-0000fe40: 7475 726e 5f69 6e64 6578 203d 4661 6c73  turn_index =Fals
-0000fe50: 652c 200d 0a20 2020 2072 6574 7572 6e5f  e, ..    return_
-0000fe60: 6461 7461 3d46 616c 7365 2c0d 0a20 2020  data=False,..   
-0000fe70: 2065 7272 6f72 203d 2027 6967 6e6f 7265   error = 'ignore
-0000fe80: 272c 2020 0d0a 2020 2020 2a2a 6b77 7320  ',  ..    **kws 
-0000fe90: 0d0a 2020 2020 293a 200d 0a0d 0a20 2020  ..    ): ....   
-0000fea0: 2065 7272 6f72 7320 3d20 5b5d 0d0a 2020   errors = []..  
-0000feb0: 2020 6973 5f76 616c 6964 5f64 6673 203d    is_valid_dfs =
-0000fec0: 205b 5d20 3b20 6973 5f6e 6f74 5f76 616c   [] ; is_not_val
-0000fed0: 6964 203d 5b5d 0d0a 2020 2020 7365 6374  id =[]..    sect
-0000fee0: 696f 6e5f 696e 6465 7865 7320 2c73 6563  ion_indexes ,sec
-0000fef0: 7469 6f6e 7320 3d5b 5d20 2c20 5b5d 0d0a  tions =[] , []..
-0000ff00: 2020 2020 0d0a 2020 2020 6572 726f 7220      ..    error 
-0000ff10: 3d27 7261 6973 6527 2069 6620 6572 726f  ='raise' if erro
-0000ff20: 7220 213d 2769 676e 6f72 6527 2065 6c73  r !='ignore' els
-0000ff30: 6520 2769 676e 6f72 6527 0d0a 0d0a 2020  e 'ignore'....  
-0000ff40: 2020 666f 7220 6969 2c20 6466 2069 6e20    for ii, df in 
-0000ff50: 656e 756d 6572 6174 6520 2820 6461 7461  enumerate ( data
-0000ff60: 2920 3a20 0d0a 2020 2020 2020 2020 7472  ) : ..        tr
-0000ff70: 7920 3a20 0d0a 2020 2020 2020 2020 2020  y : ..          
-0000ff80: 2020 6978 2c20 7365 6320 3d20 6765 745f    ix, sec = get_
-0000ff90: 6171 7569 6665 725f 7365 6374 696f 6e28  aquifer_section(
-0000ffa0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000ffb0: 2020 6466 202c 200d 0a20 2020 2020 2020    df , ..       
-0000ffc0: 2020 2020 2020 2020 207a 6e61 6d65 203d           zname =
-0000ffd0: 207a 6e61 6d65 202c 200d 0a20 2020 2020   zname , ..     
-0000ffe0: 2020 2020 2020 2020 2020 206b 6e61 6d65             kname
-0000fff0: 203d 206b 6e61 6d65 202c 200d 0a20 2020   = kname , ..   
-00010000: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00010010: 7572 6e5f 696e 6465 783d 2054 7275 652c  urn_index= True,
-00010020: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00010030: 2020 2072 6574 7572 6e5f 7365 6374 696f     return_sectio
-00010040: 6e73 3d54 7275 652c 200d 0a20 2020 2020  ns=True, ..     
-00010050: 2020 2020 2020 2020 2020 202a 2a6b 7773             **kws
-00010060: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010070: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
-00010080: 2069 735f 7661 6c69 645f 6466 7320 2e61   is_valid_dfs .a
-00010090: 7070 656e 6420 2864 6620 290d 0a20 2020  ppend (df )..   
-000100a0: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
-000100b0: 7074 696f 6e20 6173 2065 7272 203a 0d0a  ption as err :..
-000100c0: 2020 2020 2020 2020 2020 2020 2320 6966              # if
-000100d0: 2065 7272 6f72 203d 3d27 7261 6973 6527   error =='raise'
-000100e0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-000100f0: 2020 2020 2072 6169 7365 2065 7272 0d0a       raise err..
-00010100: 2020 2020 2020 2020 2020 2020 6572 726f              erro
-00010110: 7273 2e61 7070 656e 6428 7374 7228 6572  rs.append(str(er
-00010120: 7229 290d 0a20 2020 2020 2020 2020 2020  r))..           
-00010130: 2069 735f 6e6f 745f 7661 6c69 642e 6170   is_not_valid.ap
-00010140: 7065 6e64 2028 6969 202b 2031 2029 0d0a  pend (ii + 1 )..
-00010150: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-00010160: 696e 7565 200d 0a20 2020 2020 2020 2073  inue ..        s
-00010170: 6563 7469 6f6e 5f69 6e64 6578 6573 2e61  ection_indexes.a
-00010180: 7070 656e 6428 6978 293b 2073 6563 7469  ppend(ix); secti
-00010190: 6f6e 732e 6170 7065 6e64 2873 6563 2029  ons.append(sec )
-000101a0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-000101b0: 6966 206c 656e 2869 735f 6e6f 745f 7661  if len(is_not_va
-000101c0: 6c69 6429 213d 3020 3a20 0d0a 2020 2020  lid)!=0 : ..    
-000101d0: 2020 2020 7665 7262 203d 2066 227b 2773      verb = f"{'s
-000101e0: 2720 6966 206c 656e 2869 735f 6e6f 745f  ' if len(is_not_
-000101f0: 7661 6c69 6429 3e31 2065 6c73 6527 277d  valid)>1 else''}
-00010200: 220d 0a20 2020 2020 2020 206d 7367 203d  "..        msg =
-00010210: 2022 556e 7375 7070 6f72 7473 2064 6174   "Unsupports dat
-00010220: 6120 6174 2070 6f73 6974 696f 6e7b 307d  a at position{0}
-00010230: 207b 317d 2e22 2e66 6f72 6d61 7428 2076   {1}.".format( v
-00010240: 6572 622c 200d 0a20 2020 2020 2020 2020  erb, ..         
-00010250: 2020 2020 736d 6172 745f 666f 726d 6174      smart_format
-00010260: 2869 735f 6e6f 745f 7661 6c69 6429 290d  (is_not_valid)).
-00010270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010280: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00010290: 6966 2065 7272 6f72 203d 3d27 7261 6973  if error =='rais
-000102a0: 6527 3a0d 0a20 2020 2020 2020 2020 2020  e':..           
-000102b0: 2067 6574 7220 3d20 2822 5365 6374 696f   getr = ("Sectio
-000102c0: 6e73 222c 2022 636f 6d70 7574 6564 2220  ns", "computed" 
-000102d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000102e0: 2020 2020 2020 2020 2920 2069 6620 6e6f          )  if no
-000102f0: 7420 7265 7475 726e 5f69 6e64 6578 2065  t return_index e
-00010300: 6c73 6520 2028 2249 6e64 6963 6573 222c  lse  ("Indices",
-00010310: 2022 6f62 7461 696e 6564 2220 290d 0a20   "obtained" ).. 
-00010320: 2020 2020 2020 2020 2020 2062 7465 7874             btext
-00010330: 203d 2022 5c6e 5265 6173 6f6e 7b7d 222e   = "\nReason{}".
-00010340: 666f 726d 6174 2876 6572 6229 0d0a 2020  format(verb)..  
-00010350: 2020 2020 2020 2020 2020 656e 7465 7874            entext
-00010360: 203d 2022 7b30 7d20 6361 6e6e 6f74 2062   = "{0} cannot b
-00010370: 6520 7b31 7d2e 2050 6c65 6173 6520 6368  e {1}. Please ch
-00010380: 6563 6b20 796f 7572 2064 6174 612e 222e  eck your data.".
-00010390: 666f 726d 6174 2028 200d 0a20 2020 2020  format ( ..     
-000103a0: 2020 2020 2020 2020 2020 2067 6574 725b             getr[
-000103b0: 305d 2c20 6765 7472 5b2d 315d 290d 0a20  0], getr[-1]).. 
-000103c0: 2020 2020 2020 2020 2020 206d 6573 7320             mess 
-000103d0: 3d20 6d73 6720 2b20 206c 6973 7469 6e67  = msg +  listing
-000103e0: 5f69 7465 6d73 5f66 6f72 6d61 7428 0d0a  _items_format(..
-000103f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010400: 6572 726f 7273 2c20 6265 6769 6e74 6578  errors, begintex
-00010410: 743d 6274 6578 742c 2065 6e64 7465 7874  t=btext, endtext
-00010420: 3d65 6e74 6578 7420 2c20 7665 7262 6f73  =entext , verbos
-00010430: 6520 3d46 616c 7365 2029 0d0a 2020 2020  e =False )..    
-00010440: 2020 2020 2020 2020 7261 6973 6520 4461          raise Da
-00010450: 7461 7365 7445 7272 6f72 286d 6573 7329  tasetError(mess)
-00010460: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
-00010470: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
-00010480: 732e 7761 726e 286d 7367 202b 2022 2044  s.warn(msg + " D
-00010490: 6174 6120 7b7d 2064 6973 6361 7264 6564  ata {} discarded
-000104a0: 2e22 2e66 6f72 6d61 7428 200d 0a20 2020  .".format( ..   
-000104b0: 2020 2020 2020 2020 2022 6973 2220 6966           "is" if
-000104c0: 206c 656e 2869 735f 6e6f 745f 7661 6c69   len(is_not_vali
-000104d0: 6429 3c32 2065 6c73 6520 2261 7265 2229  d)<2 else "are")
-000104e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000104f0: 2020 2020 2020 2020 2920 2020 2020 2020          )       
-00010500: 200d 0a20 2020 2072 3d20 7365 6374 696f   ..    r= sectio
-00010510: 6e5f 696e 6465 7865 7320 6966 2072 6574  n_indexes if ret
-00010520: 7572 6e5f 696e 6465 7820 656c 7365 2073  urn_index else s
-00010530: 6563 7469 6f6e 7320 0d0a 2020 2020 0d0a  ections ..    ..
-00010540: 2020 2020 7265 7475 726e 2020 7220 2069      return  r  i
-00010550: 6620 6e6f 7420 7265 7475 726e 5f64 6174  f not return_dat
-00010560: 6120 656c 7365 2028 2072 202c 2069 735f  a else ( r , is_
-00010570: 7661 6c69 645f 6466 7329 200d 0a0d 0a67  valid_dfs) ....g
-00010580: 6574 5f61 7175 6966 6572 5f73 6563 7469  et_aquifer_secti
-00010590: 6f6e 732e 5f5f 646f 635f 5f3d 2222 225c  ons.__doc__="""\
-000105a0: 0d0a 4765 7420 7468 6520 7365 6374 696f  ..Get the sectio
-000105b0: 6e20 6f66 2065 6163 6820 6171 7569 6665  n of each aquife
-000105c0: 7220 666f 726d 206d 756c 7469 706c 6520  r form multiple 
-000105d0: 6461 7461 6672 616d 6573 2e20 0d0a 200d  dataframes. .. .
-000105e0: 0a54 6865 2075 6e69 7175 6520 7365 6374  .The unique sect
-000105f0: 696f 6e20 2775 7070 6572 2720 616e 6420  ion 'upper' and 
-00010600: 276c 6f77 6572 2720 6973 2074 6865 2076  'lower' is the v
-00010610: 616c 6964 2072 616e 6765 206f 6620 7468  alid range of th
-00010620: 6520 7768 6f6c 6520 0d0a 6461 7461 2074  e whole ..data t
-00010630: 6f20 636f 6e73 6964 6572 2061 7320 6120  o consider as a 
-00010640: 2076 616c 6964 2064 6174 612e 200d 0a54   valid data. ..T
-00010650: 6865 2075 7365 206f 6620 7468 6520 696e  he use of the in
-00010660: 6465 7820 6973 2020 6e65 6365 7373 6172  dex is  necessar
-00010670: 7920 746f 2073 6872 756e 6b20 7468 6520  y to shrunk the 
-00010680: 6461 7461 206f 6620 7468 6520 7768 6f6c  data of the whol
-00010690: 6520 0d0a 626f 7265 686f 6c65 732e 204d  e ..boreholes. M
-000106a0: 6f73 6c79 2074 6865 2064 6174 6120 6672  osly the data fr
-000106b0: 6f6d 2074 6865 2073 6563 7469 6f6e 2069  om the section i
-000106c0: 7320 636f 6e73 6964 6564 2074 6865 2076  s consided the v
-000106d0: 616c 6964 2064 6174 6120 6173 2074 6865  alid data as the
-000106e0: 200d 0a70 7265 6469 6374 6f72 2058 722e   ..predictor Xr.
-000106f0: 204f 7574 206f 6620 7468 6520 7261 6e67   Out of the rang
-00010700: 6520 6f66 2061 7175 6966 6572 7320 6563  e of aquifers ec
-00010710: 7469 6f6e 2c20 6461 7461 2063 616e 2062  tion, data can b
-00010720: 6520 6469 7363 6172 6465 6420 6f72 200d  e discarded or .
-00010730: 0a63 6f6d 7072 6573 7365 6420 746f 2074  .compressed to t
-00010740: 6f70 2058 722e 200d 0a0d 0a52 6574 7572  op Xr. ....Retur
-00010750: 6e73 2076 616c 6964 2073 6563 7469 6f6e  ns valid section
-00010760: 2069 6e64 6578 6573 2069 6620 2772 6574   indexes if 'ret
-00010770: 7572 6e5f 696e 6465 7827 2069 7320 7365  urn_index' is se
-00010780: 7420 746f 2060 6054 7275 6560 602e 2020  t to ``True``.  
-00010790: 2020 0d0a 2020 200d 0a50 6172 616d 6574    ..   ..Paramet
-000107a0: 6572 7320 0d0a 2d2d 2d2d 2d2d 2d2d 2d2d  ers ..----------
-000107b0: 2d2d 200d 0a64 6174 613a 206c 6973 7420  -- ..data: list 
-000107c0: 6f66 2070 616e 6461 7320 6461 7461 6672  of pandas datafr
-000107d0: 616d 6520 0d0a 2020 2020 4461 7461 2074  ame ..    Data t
-000107e0: 6861 7420 636f 6e74 6169 6e73 206d 6169  hat contains mai
-000107f0: 6e6c 7920 7468 6520 6171 7569 6665 7220  nly the aquifer 
-00010800: 7661 6c75 6573 2e20 4974 206e 6565 6473  values. It needs
-00010810: 2074 6f20 7370 6563 6966 7920 7468 6520   to specify the 
-00010820: 0d0a 2020 2020 6e61 6d65 206f 6620 7468  ..    name of th
-00010830: 6520 6465 7074 6820 636f 6c75 6d6e 2060  e depth column `
-00010840: 7a6e 616d 6560 2061 7320 7765 6c6c 2061  zname` as well a
-00010850: 7320 7468 6520 6e61 6d65 206f 6620 7065  s the name of pe
-00010860: 726d 6561 6269 6c69 7920 0d0a 2020 2020  rmeabiliy ..    
-00010870: 606b 6e61 6d65 6020 636f 6c75 6d6e 2e20  `kname` column. 
-00010880: 200d 0a7b 7061 7261 6d73 2e63 6f72 652e   ..{params.core.
-00010890: 7a6e 616d 657d 0d0a 7b70 6172 616d 732e  zname}..{params.
-000108a0: 636f 7265 2e6b 6e61 6d65 7d0d 0a7b 7061  core.kname}..{pa
-000108b0: 7261 6d73 2e63 6f72 652e 7a7d 0d0a 0d0a  rams.core.z}....
-000108c0: 7265 7475 726e 5f69 6e64 6578 3a20 626f  return_index: bo
-000108d0: 6f6c 2c20 6465 6661 756c 7420 3d46 616c  ol, default =Fal
-000108e0: 7365 202c 200d 0a20 2020 2052 6574 7572  se , ..    Retur
-000108f0: 6e73 2074 6865 2070 6f73 6974 696f 6e73  ns the positions
-00010900: 2028 696e 6465 7865 7329 206f 6620 7468   (indexes) of th
-00010910: 6520 7570 7065 7220 616e 6420 6c6f 7765  e upper and lowe
-00010920: 7220 7365 6374 696f 6e73 206f 6620 7468  r sections of th
-00010930: 650d 0a20 2020 6561 6368 2061 7175 6966  e..   each aquif
-00010940: 6572 2066 6f75 6e64 2069 6e20 6561 6368  er found in each
-00010950: 2064 6174 6166 7261 6d65 2e0d 0a0d 0a65   dataframe.....e
-00010960: 7272 6f72 3a20 7374 722c 2064 6566 6175  rror: str, defau
-00010970: 6c74 3d27 6967 6e6f 7265 2720 0d0a 2020  lt='ignore' ..  
-00010980: 2020 5261 6973 6520 6572 726f 7273 2069    Raise errors i
-00010990: 6620 7472 6f75 626c 6520 6f63 6375 7273  f trouble occurs
-000109a0: 2077 6865 6e20 636f 6d70 7574 696e 6720   when computing 
-000109b0: 7468 6520 7365 6374 696f 6e20 6f66 2065  the section of e
-000109c0: 6163 6820 6171 7569 6665 722e 200d 0a20  ach aquifer. .. 
-000109d0: 2020 2049 6620 2769 676e 6f72 6527 2c20     If 'ignore', 
-000109e0: 6120 5573 6572 5761 726e 696e 6720 6973  a UserWarning is
-000109f0: 2064 6973 706c 6179 6564 2069 6620 696e   displayed if in
-00010a00: 7661 6c69 6420 6461 7461 2069 7320 666f  valid data is fo
-00010a10: 756e 642e 2041 6e79 200d 0a20 2020 206f  und. Any ..    o
-00010a20: 7468 6572 2076 616c 7565 206f 6620 6065  ther value of `e
-00010a30: 7272 6f72 6020 7769 6c6c 2073 6574 2065  rror` will set e
-00010a40: 7272 6f72 2074 6f20 6072 6169 7365 602e  rror to `raise`.
-00010a50: 200d 0a72 6574 7572 6e5f 6461 7461 3a20   ..return_data: 
-00010a60: 626f 6f6c 2c20 6465 6661 756c 743d 4661  bool, default=Fa
-00010a70: 6c73 652c 200d 0a20 2020 2052 6574 7572  lse, ..    Retur
-00010a80: 6e20 7661 6c69 6420 6461 7461 2e20 4974  n valid data. It
-00010a90: 2069 7320 7573 6566 756c 6c20 7768 656e   is usefull when
-00010aa0: 2027 6572 726f 7227 2069 7320 7365 7420   'error' is set 
-00010ab0: 746f 2027 6967 6e6f 7265 270d 0a20 2020  to 'ignore'..   
-00010ac0: 2074 6f20 636f 6c6c 6563 7420 7468 6520   to collect the 
-00010ad0: 7661 6c69 6420 6461 7461 2e20 0d0a 2020  valid data. ..  
-00010ae0: 2020 2020 200d 0a6b 7773 3a20 6469 6374       ..kws: dict
-00010af0: 2c20 0d0a 2020 2020 4164 6469 7469 6f6e  , ..    Addition
-00010b00: 616c 206b 6579 776f 7264 7320 6172 6775  al keywords argu
-00010b10: 6d65 6e74 7320 7061 7373 6564 2020 746f  ments passed  to
-00010b20: 2020 0d0a 2020 2020 3a66 756e 633a 607e    ..    :func:`~
-00010b30: 7761 7465 782e 7574 696c 732e 6879 6472  watex.utils.hydr
-00010b40: 6f75 7469 6c73 2e67 6574 5f61 7175 6966  outils.get_aquif
-00010b50: 6572 5f73 6563 7469 6f6e 7360 2e0d 0a20  er_sections`... 
-00010b60: 2020 200d 0a52 6574 7572 6e73 200d 0a2d     ..Returns ..-
-00010b70: 2d2d 2d2d 2d2d 2d0d 0a75 702c 206c 6f77  -------..up, low
-00010b80: 203a 6c69 7374 206f 6620 7570 7065 7220   :list of upper 
-00010b90: 616e 6420 6c6f 7765 7220 7365 6374 696f  and lower sectio
-00010ba0: 6e20 7661 6c75 6573 206f 6620 6171 7569  n values of aqui
-00010bb0: 6665 722e 0d0a 2020 2020 2d20 2875 7069  fer...    - (upi
-00010bc0: 782c 206c 6f77 6978 2029 3a20 5475 706c  x, lowix ): Tupl
-00010bd0: 6520 6f66 2069 6e64 6578 6573 206f 6620  e of indexes of 
-00010be0: 6c6f 7765 7220 616e 6420 7570 7065 7220  lower and upper 
-00010bf0: 7365 6374 696f 6e73 2020 0d0a 2020 2020  sections  ..    
-00010c00: 2d20 2875 702c 206c 6f77 293a 2054 7570  - (up, low): Tup
-00010c10: 6c65 206f 6620 6171 7569 6665 7220 7365  le of aquifer se
-00010c20: 6374 696f 6e73 2028 7570 7065 7220 616e  ctions (upper an
-00010c30: 6420 6c6f 7765 7229 2020 0d0a 2020 2020  d lower)  ..    
-00010c40: 2d20 2875 7069 782c 206c 6f77 6978 292c  - (upix, lowix),
-00010c50: 2028 7570 2c20 6c6f 7729 203a 2070 6f73   (up, low) : pos
-00010c60: 6974 696f 6e73 2061 6e64 2073 6563 7469  itions and secti
-00010c70: 6f6e 7320 7661 6c75 6573 206f 6620 6171  ons values of aq
-00010c80: 7569 6665 7273 200d 0a20 2020 2020 2020  uifers ..       
-00010c90: 2069 6620 6072 6574 7572 6e5f 696e 6465   if `return_inde
-00010ca0: 7860 2061 6e64 2072 6574 7572 6e5f 7365  x` and return_se
-00010cb0: 6374 696f 6e73 6020 6172 6520 6060 5472  ctions` are ``Tr
-00010cc0: 7565 6060 2e20 200d 0a0d 0a53 6565 2041  ue``.  ....See A
-00010cd0: 6c73 6f20 0d0a 2d2d 2d2d 2d2d 2d2d 2d2d  lso ..----------
-00010ce0: 0d0a 7761 7465 782e 7574 696c 732e 6879  ..watex.utils.hy
-00010cf0: 6472 6f75 7469 6c73 2e67 6574 5f61 7175  droutils.get_aqu
-00010d00: 6966 6572 5f73 6563 7469 6f6e 733a 200d  ifer_sections: .
-00010d10: 0a20 2020 2063 6f6d 7075 7465 206d 756c  .    compute mul
-00010d20: 7469 706c 6573 2061 7175 6966 6572 2073  tiples aquifer s
-00010d30: 6563 7469 6f6e 730d 0a0d 0a45 7861 6d70  ections....Examp
-00010d40: 6c65 0d0a 2d2d 2d2d 2d2d 2d20 2020 0d0a  le..-------   ..
-00010d50: 3e3e 3e20 6672 6f6d 2077 6174 6578 2e64  >>> from watex.d
-00010d60: 6174 6173 6574 7320 696d 706f 7274 206c  atasets import l
-00010d70: 6f61 645f 686c 6f67 7320 0d0a 3e3e 3e20  oad_hlogs ..>>> 
-00010d80: 6672 6f6d 2077 6174 6578 2e75 7469 6c73  from watex.utils
-00010d90: 2e68 7964 726f 7574 696c 7320 696d 706f  .hydroutils impo
-00010da0: 7274 2067 6574 5f61 7175 6966 6572 5f73  rt get_aquifer_s
-00010db0: 6563 7469 6f6e 730d 0a3e 3e3e 2064 6174  ections..>>> dat
-00010dc0: 6120 3d20 6c6f 6164 5f68 6c6f 6773 2028  a = load_hlogs (
-00010dd0: 292e 6672 616d 6520 0d0a 3e3e 3e20 6765  ).frame ..>>> ge
-00010de0: 745f 6171 7569 6665 725f 7365 6374 696f  t_aquifer_sectio
-00010df0: 6e73 2028 6461 7461 2c20 6461 7461 202c  ns (data, data ,
-00010e00: 207a 6e61 6d65 203d 2764 6570 7468 272c   zname ='depth',
-00010e10: 206b 6e61 6d65 203d 276b 2720 2920 0d0a   kname ='k' ) ..
-00010e20: 2e2e 2e20 5b5b 3139 372e 3132 2c20 3336  ... [[197.12, 36
-00010e30: 392e 3731 5d2c 205b 3139 372e 3132 2c20  9.71], [197.12, 
-00010e40: 3336 392e 3731 5d5d 0d0a 3e3e 3e20 6765  369.71]]..>>> ge
-00010e50: 745f 6171 7569 6665 725f 7365 6374 696f  t_aquifer_sectio
-00010e60: 6e73 2028 6461 7461 2c20 6461 7461 202c  ns (data, data ,
-00010e70: 207a 6e61 6d65 203d 2764 6570 7468 272c   zname ='depth',
-00010e80: 206b 6e61 6d65 203d 276b 2720 2c20 0d0a   kname ='k' , ..
-00010e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ea0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00010eb0: 6e5f 696e 6465 7820 3d54 7275 6520 2920  n_index =True ) 
-00010ec0: 0d0a 2e2e 2e20 205b 5b31 362c 2032 395d  .....  [[16, 29]
-00010ed0: 2c20 5b31 362c 2032 395d 5d0d 0a0d 0a22  , [16, 29]]...."
-00010ee0: 2222 2e66 6f72 6d61 7428 0d0a 2020 2020  "".format(..    
-00010ef0: 7061 7261 6d73 3d5f 7061 7261 6d5f 646f  params=_param_do
-00010f00: 6373 2c0d 0a20 2020 2029 0d0a 6465 6620  cs,..    )..def 
-00010f10: 5f67 6574 5f69 6e76 616c 6964 5f69 6e64  _get_invalid_ind
-00010f20: 6578 6573 2020 2820 642c 202f 2c20 7661  exes  ( d, /, va
-00010f30: 6c69 645f 696e 6465 7865 732c 2069 6e5f  lid_indexes, in_
-00010f40: 6172 616e 6765 203d 4661 6c73 6520 293a  arange =False ):
-00010f50: 200d 0a20 2020 2022 2222 2047 6574 206e   ..    """ Get n
-00010f60: 6f6e 2076 616c 6964 2069 6e64 6578 6573  on valid indexes
-00010f70: 2066 726f 6d20 7661 6c69 6420 7365 6374   from valid sect
-00010f80: 696f 6e20 696e 6465 7865 7320 0d0a 2020  ion indexes ..  
-00010f90: 2020 0d0a 2020 2020 3a70 6172 616d 2064    ..    :param d
-00010fa0: 3a20 6172 7261 795f 6c69 6b65 2031 6420  : array_like 1d 
-00010fb0: 0d0a 2020 2020 2020 2020 6172 7261 792d  ..        array-
-00010fc0: 6c69 6b65 2064 6174 6120 666f 7220 7265  like data for re
-00010fd0: 636f 7665 7220 7468 6520 7365 6374 696f  cover the sectio
-00010fe0: 6e20 7261 6e67 6520 696e 6465 7865 7320  n range indexes 
-00010ff0: 0d0a 2020 2020 3a70 6172 616d 2073 6563  ..    :param sec
-00011000: 7469 6f6e 5f69 783a 2054 7570 6c65 2028  tion_ix: Tuple (
-00011010: 696e 742c 2069 6e74 2920 0d0a 2020 2020  int, int) ..    
-00011020: 2020 2020 496e 6465 7820 6f66 2075 7070      Index of upp
-00011030: 6572 2061 6e64 206c 6f77 6572 2073 6563  er and lower sec
-00011040: 7469 6f6e 730d 0a20 2020 203a 7061 7261  tions..    :para
-00011050: 6d20 696e 5f61 7261 6e67 653a 2062 6f6f  m in_arange: boo
-00011060: 6c2c 200d 0a20 2020 2020 2020 204c 6973  l, ..        Lis
-00011070: 7420 616c 6c20 696e 6465 7820 7661 6c75  t all index valu
-00011080: 6573 2e20 0d0a 2020 2020 3a72 6574 7572  es. ..    :retur
-00011090: 6e73 3a20 0d0a 2020 2020 2020 2020 696e  ns: ..        in
-000110a0: 7669 783a 204c 6973 7428 5475 706c 6528  vix: List(Tuple(
-000110b0: 696e 7429 290d 0a20 2020 2020 2020 2052  int))..        R
-000110c0: 6574 7572 6e73 2069 6e76 616c 6964 2069  eturns invalid i
-000110d0: 6e64 6578 6573 206f 6e74 6f20 6120 6c69  ndexes onto a li
-000110e0: 7374 200d 0a20 2020 2045 7861 6d70 6c65  st ..    Example
-000110f0: 200d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d   ..    ---------
-00011100: 2d2d 0d0a 2020 2020 3e3e 3e20 6672 6f6d  --..    >>> from
-00011110: 2077 6174 6578 2e75 7469 6c73 2e68 7964   watex.utils.hyd
-00011120: 726f 7574 696c 7320 696d 706f 7274 205f  routils import _
-00011130: 6765 745f 696e 7661 6c69 645f 696e 6465  get_invalid_inde
-00011140: 7865 730d 0a20 2020 203e 3e3e 2069 6d70  xes..    >>> imp
-00011150: 6f72 7420 6e75 6d70 7920 6173 206e 7020  ort numpy as np 
-00011160: 0d0a 2020 2020 3e3e 3e20 6964 7820 3d20  ..    >>> idx = 
-00011170: 6e70 2e61 7261 6e67 6520 2835 3029 200d  np.arange (50) .
-00011180: 0a20 2020 203e 3e3e 205f 6765 745f 696e  .    >>> _get_in
-00011190: 7661 6c69 645f 696e 6465 7865 7320 2869  valid_indexes (i
-000111a0: 6478 202c 2028 332c 2031 3120 2929 0d0a  dx , (3, 11 ))..
-000111b0: 2020 2020 2e2e 2e20 5b28 302c 2033 292c      ... [(0, 3),
-000111c0: 2028 3132 2c20 3530 295d 0d0a 2020 2020   (12, 50)]..    
-000111d0: 0d0a 2020 2020 2222 220d 0a20 2020 2069  ..    """..    i
-000111e0: 6620 696e 5f61 7261 6e67 6520 3a20 0d0a  f in_arange : ..
-000111f0: 2020 2020 2020 2020 7661 6c69 645f 696e          valid_in
-00011200: 6465 7865 7320 3d20 6e70 2e61 7272 6179  dexes = np.array
-00011210: 2028 2020 6c69 7374 2820 0d0a 2020 2020   (  list( ..    
-00011220: 2020 2020 2020 2020 7261 6e67 6520 2820          range ( 
-00011230: 2a20 5b20 2076 616c 6964 5f69 6e64 6578  * [  valid_index
-00011240: 6573 205b 305d 202c 2076 616c 6964 5f69  es [0] , valid_i
-00011250: 6e64 6578 6573 205b 2d31 5d20 2b31 205d  ndexes [-1] +1 ]
-00011260: 2029 2929 2020 0d0a 2020 2020 2020 2020   )))  ..        
-00011270: 6d61 736b 203d 205f 6973 696e 2872 616e  mask = _isin(ran
-00011280: 6765 286c 656e 2864 2929 2c20 7661 6c69  ge(len(d)), vali
-00011290: 645f 696e 6465 7865 732c 2072 6574 7572  d_indexes, retur
-000112a0: 6e5f 6d61 736b 3d54 7275 6520 290d 0a20  n_mask=True ).. 
-000112b0: 2020 2020 2020 2069 6e76 6978 203d 206e         invix = n
-000112c0: 702e 6172 616e 6765 2028 6c65 6e28 6429  p.arange (len(d)
-000112d0: 295b 7e6d 6173 6b20 5d0d 0a20 2020 2065  )[~mask ]..    e
-000112e0: 6c73 6520 3a0d 0a20 2020 2020 2020 2023  lse :..        #
-000112f0: 202b 3120 666f 7220 5079 7468 6f6e 2069   +1 for Python i
-00011300: 6e64 6578 696e 670d 0a20 2020 2020 2020  ndexing..       
-00011310: 2069 6e76 6978 203d 2020 286e 702e 6172   invix =  (np.ar
-00011320: 616e 6765 2028 6c65 6e28 6429 295b 3a76  ange (len(d))[:v
-00011330: 616c 6964 5f69 6e64 6578 6573 205b 305d  alid_indexes [0]
-00011340: 202b 2031 205d 2c0d 0a20 2020 2020 2020   + 1 ],..       
-00011350: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
-00011360: 616e 6765 2028 6c65 6e28 6429 202b 2031  ange (len(d) + 1
-00011370: 2029 5b76 616c 6964 5f69 6e64 6578 6573   )[valid_indexes
-00011380: 5b31 5d2b 3120 3a20 5d29 200d 0a20 2020  [1]+1 : ]) ..   
-00011390: 2020 2020 2069 6e76 6978 3d20 205b 2028       invix=  [ (
-000113a0: 206d 696e 2869 7829 202c 206d 6178 2869   min(ix) , max(i
-000113b0: 7829 2920 2066 6f72 2069 7820 696e 2069  x))  for ix in i
-000113c0: 6e76 6978 2020 6966 2020 2820 0d0a 2020  nvix  if  ( ..  
-000113d0: 2020 2020 2020 2020 2020 6c65 6e28 6978            len(ix
-000113e0: 2029 213d 3020 616e 6420 6c65 6e28 7365   )!=0 and len(se
-000113f0: 7428 6978 2929 3e31 2920 205d 2023 2028  t(ix))>1)  ] # (
-00011400: 3138 312c 2031 3831 2029 0d0a 2020 2020  181, 181 )..    
-00011410: 0d0a 2020 2020 7265 7475 726e 2069 6e76  ..    return inv
-00011420: 6978 200d 0a0d 0a20 2020 200d 0a64 6566  ix ....    ..def
-00011430: 2067 6574 5f78 735f 7872 5f73 706c 6974   get_xs_xr_split
-00011440: 7320 280d 0a20 2020 2064 6174 612c 200d  s (..    data, .
-00011450: 0a20 2020 202f 2c0d 0a20 2020 207a 5f72  .    /,..    z_r
-00011460: 616e 6765 203d 204e 6f6e 652c 200d 0a20  ange = None, .. 
-00011470: 2020 207a 6e61 6d65 203d 204e 6f6e 652c     zname = None,
-00011480: 200d 0a20 2020 2073 6563 7469 6f6e 5f69   ..    section_i
-00011490: 6e64 6578 6573 3a54 7570 6c65 5b69 6e74  ndexes:Tuple[int
-000114a0: 2c20 696e 745d 3d4e 6f6e 652c 200d 0a20  , int]=None, .. 
-000114b0: 2020 2029 2d3e 2054 7570 6c65 205b 4461     )-> Tuple [Da
-000114c0: 7461 4672 616d 6520 5d3a 0d0a 2020 2020  taFrame ]:..    
-000114d0: 2222 2253 706c 6974 2064 6174 6120 696e  """Split data in
-000114e0: 746f 206d 6174 7269 7820 3a6d 6174 683a  to matrix :math:
-000114f0: 6058 5f73 6020 7769 7468 2073 616d 706c  `X_s` with sampl
-00011500: 6520 3a6d 6174 683a 606d 7360 2028 756e  e :math:`ms` (un
-00011510: 7761 6e74 6564 2064 6174 6120 2920 0d0a  wanted data ) ..
-00011520: 2020 2020 616e 6420 3a6d 6174 683a 6058      and :math:`X
-00011530: 5f72 6020 6f66 2073 616d 706c 6573 203a  _r` of samples :
-00011540: 6d61 7468 3a60 6d5f 7260 2820 7661 6c69  math:`m_r`( vali
-00011550: 6420 6171 7569 6665 7220 6461 7461 2029  d aquifer data )
-00011560: 0d0a 2020 2020 0d0a 2020 2020 5061 7261  ..    ..    Para
-00011570: 6d65 7465 7273 200d 0a20 2020 202d 2d2d  meters ..    ---
-00011580: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 6461  --------..    da
-00011590: 7461 3a20 7061 6e64 6173 2064 6174 6166  ta: pandas dataf
-000115a0: 7261 6d65 200d 0a20 2020 2020 2020 2044  rame ..        D
-000115b0: 6174 6166 7261 6d65 2066 6f72 2063 6f6d  ataframe for com
-000115c0: 7072 6573 7369 6e67 2e20 0d0a 2020 2020  pressing. ..    
-000115d0: 7a6e 616d 653a 2073 7472 2c69 6e74 202c  zname: str,int ,
-000115e0: 200d 0a20 2020 2020 2020 2074 6865 206e   ..        the n
-000115f0: 616d 6520 6f66 2064 6570 7468 2063 6f6c  ame of depth col
-00011600: 756d 6e2e 2027 6e61 6d65 2720 6e65 6564  umn. 'name' need
-00011610: 7320 746f 2062 6520 7375 7070 6c69 6564  s to be supplied
-00011620: 200d 0a20 2020 2020 2020 2077 6865 6e20   ..        when 
-00011630: 6073 6563 7469 6f6e 5f69 6e64 6578 6573  `section_indexes
-00011640: 6020 6973 206e 6f74 2070 726f 7669 6465  ` is not provide
-00011650: 642e 200d 0a20 2020 207a 5f72 616e 6765  d. ..    z_range
-00011660: 3a20 7475 706c 6520 2866 6c6f 6174 292c  : tuple (float),
-00011670: 200d 0a20 2020 2020 2020 2053 6563 7469   ..        Secti
-00011680: 6f6e 205b 2775 7070 6572 272c 2027 6c6f  on ['upper', 'lo
-00011690: 7765 7227 5d20 6f66 2074 6865 2061 7175  wer'] of the aqu
-000116a0: 6966 6572 2061 7420 6469 6666 6572 656e  ifer at differen
-000116b0: 7420 6465 7074 682e 0d0a 2020 2020 2020  t depth...      
-000116c0: 2020 5468 6520 7261 6e67 6520 6f66 2074    The range of t
-000116d0: 6865 2064 6570 7468 206d 7573 7420 6120  he depth must a 
-000116e0: 7061 6972 2076 616c 7565 7320 616e 6420  pair values and 
-000116f0: 2063 6f75 6c64 206e 6f74 2062 650d 0a20   could not be.. 
-00011700: 2020 2020 2020 2067 7265 6174 6572 2074         greater t
-00011710: 6861 6e20 7468 6520 6d61 7869 6d75 6d20  han the maximum 
-00011720: 6465 7074 6820 6f66 2074 6865 2077 656c  depth of the wel
-00011730: 6c2e 0d0a 2020 2020 7365 6374 696f 6e5f  l...    section_
-00011740: 696e 6465 7865 733a 2074 7570 6c65 206f  indexes: tuple o
-00011750: 7220 6c69 7374 206f 6620 696e 7420 0d0a  r list of int ..
-00011760: 2020 2020 2020 2020 6c69 7374 206f 6620          list of 
-00011770: 6120 7061 6972 2074 7570 6c65 206f 7220  a pair tuple or 
-00011780: 6c69 7374 206f 6620 696e 7465 6765 7273  list of integers
-00011790: 2e20 4974 2069 7320 6265 2074 6865 2074  . It is be the t
-000117a0: 6865 2076 616c 6964 200d 0a20 2020 2020  he valid ..     
-000117b0: 2020 2073 6563 7469 6f6e 7328 2075 7070     sections( upp
-000117c0: 6572 2061 6e64 206c 6f77 6572 2029 2069  er and lower ) i
-000117d0: 6e64 6578 6573 206f 6620 206f 6620 7468  ndexes of  of th
-000117e0: 6520 6171 7569 6665 722e 2049 6620 0d0a  e aquifer. If ..
-000117f0: 2020 2020 2020 2020 7468 6520 6465 7074          the dept
-00011800: 6820 7261 6e67 6520 607a 5f72 616e 6765  h range `z_range
-00011810: 6020 616e 6420 607a 6e61 6d65 6020 6172  ` and `zname` ar
-00011820: 6520 7375 7070 6c69 6564 2c20 6073 6563  e supplied, `sec
-00011830: 7469 6f6e 5f69 6e64 6578 6573 600d 0a20  tion_indexes`.. 
-00011840: 2020 2020 2020 2063 616e 2062 6520 4e6f         can be No
-00011850: 6e65 2e20 204e 6f74 6520 7468 6174 2074  ne.  Note that t
-00011860: 6865 206c 6173 7420 696e 6469 7820 6973  he last indix is
-00011870: 2063 6f6e 7369 6465 7265 6420 6173 2074   considered as t
-00011880: 6865 206c 6173 7420 0d0a 2020 2020 2020  he last ..      
-00011890: 2020 706f 7369 7469 6f6e 2c20 7468 6520    position, the 
-000118a0: 626f 7474 6f6d 206f 6620 7468 6520 7365  bottom of the se
-000118b0: 6374 696f 6e20 7468 6572 6566 6f72 652c  ction therefore,
-000118c0: 2069 7473 2076 616c 7565 2069 7320 0d0a   its value is ..
-000118d0: 2020 2020 2020 2020 696e 636c 7564 6564          included
-000118e0: 2069 6e20 7468 6520 6461 7461 2e0d 0a20   in the data... 
-000118f0: 2020 2020 2020 200d 0a20 2020 2052 6574         ..    Ret
-00011900: 7572 6e73 0d0a 2020 2020 2d2d 2d2d 2d2d  urns..    ------
-00011910: 2d2d 0d0a 2020 2020 2d20 7873 203a 206c  --..    - xs : l
-00011920: 6973 7420 6f66 2070 616e 6461 7320 6461  ist of pandas da
-00011930: 7461 6672 616d 6520 0d0a 2020 2020 2020  taframe ..      
-00011940: 2020 2d20 7368 7269 6e6b 696e 6720 7061    - shrinking pa
-00011950: 7274 206f 6620 6461 7461 2066 6f72 2063  rt of data for c
-00011960: 6f6d 7072 6573 7369 6e67 2e20 4e6f 7465  ompressing. Note
-00011970: 2074 6861 7420 6974 2069 7320 6f6e 206c   that it is on l
-00011980: 6973 7420 0d0a 2020 2020 2020 2020 6265  ist ..        be
-00011990: 6361 7573 6520 6966 2064 6174 6166 7261  cause if datafra
-000119a0: 6d65 2063 6f72 7265 7370 6f6e 6473 2074  me corresponds t
-000119b0: 6f20 7468 6520 6e6f 6e2d 7661 6c69 6420  o the non-valid 
-000119c0: 6461 7461 6672 616d 6520 7365 6374 696f  dataframe sectio
-000119d0: 6e73 2e20 0d0a 2020 2020 2d20 7872 3a20  ns. ..    - xr: 
-000119e0: 7061 6e64 6173 2064 6174 6166 7261 6d65  pandas dataframe
-000119f0: 2020 0d0a 2020 2020 2020 2020 2d20 7661    ..        - va
-00011a00: 6c69 6420 6461 7461 2072 6566 6c65 6374  lid data reflect
-00011a10: 696e 6720 746f 2074 6865 2061 7175 6966  ing to the aquif
-00011a20: 6572 2070 6172 7420 6f72 2069 6e63 6c75  er part or inclu
-00011a30: 6469 6e67 2074 6865 200d 0a20 2020 2020  ding the ..     
-00011a40: 2020 2061 7175 6966 6572 2064 6174 612e     aquifer data.
-00011a50: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-00011a60: 2045 7861 6d70 6c65 0d0a 2020 2020 2d2d   Example..    --
-00011a70: 2d2d 2d2d 2d2d 0d0a 2020 2020 3e3e 3e20  ------..    >>> 
-00011a80: 6672 6f6d 2077 6174 6578 2e64 6174 6173  from watex.datas
-00011a90: 6574 7320 696d 706f 7274 206c 6f61 645f  ets import load_
-00011aa0: 686c 6f67 7320 0d0a 2020 2020 3e3e 3e20  hlogs ..    >>> 
-00011ab0: 6672 6f6d 2077 6174 6578 2e75 7469 6c73  from watex.utils
-00011ac0: 2e68 7964 726f 7574 696c 7320 696d 706f  .hydroutils impo
-00011ad0: 7274 2067 6574 5f78 735f 7872 5f73 706c  rt get_xs_xr_spl
-00011ae0: 6974 7320 0d0a 2020 2020 3e3e 3e20 6461  its ..    >>> da
-00011af0: 7461 203d 206c 6f61 645f 686c 6f67 7320  ta = load_hlogs 
-00011b00: 2829 2e66 7261 6d65 200d 0a20 2020 203e  ().frame ..    >
-00011b10: 3e3e 2078 732c 2078 7220 3d20 6765 745f  >> xs, xr = get_
-00011b20: 7873 5f78 725f 7370 6c69 7473 2028 6461  xs_xr_splits (da
-00011b30: 7461 2c20 332e 3131 2c20 7365 6374 696f  ta, 3.11, sectio
-00011b40: 6e5f 696e 6465 7865 7320 3d20 2831 372c  n_indexes = (17,
-00011b50: 2032 3020 2920 290d 0a20 2020 2022 2222   20 ) )..    """
-00011b60: 0d0a 2020 2020 7873 2c20 7872 203d 204e  ..    xs, xr = N
-00011b70: 6f6e 652c 204e 6f6e 650d 0a20 2020 200d  one, None..    .
-00011b80: 0a20 2020 2064 6174 613d 2063 6865 636b  .    data= check
-00011b90: 5f61 7272 6179 280d 0a20 2020 2020 2020  _array(..       
-00011ba0: 2064 6174 612c 200d 0a20 2020 2020 2020   data, ..       
-00011bb0: 2066 6f72 6365 5f61 6c6c 5f66 696e 6974   force_all_finit
-00011bc0: 653d 2261 6c6c 6f77 2d6e 616e 222c 200d  e="allow-nan", .
-00011bd0: 0a20 2020 2020 2020 2064 7479 7065 203d  .        dtype =
-00011be0: 6f62 6a65 6374 2c20 0d0a 2020 2020 2020  object, ..      
-00011bf0: 2020 696e 7075 745f 6e61 6d65 3d22 4461    input_name="Da
-00011c00: 7461 2066 6f72 2073 7175 6565 7a69 6e67  ta for squeezing
-00011c10: 222c 0d0a 2020 2020 2020 2020 746f 5f66  ",..        to_f
-00011c20: 7261 6d65 203d 5472 7565 2c20 0d0a 2020  rame =True, ..  
-00011c30: 2020 290d 0a20 2020 200d 0a20 2020 2069    )..    ..    i
-00011c40: 6620 7365 6374 696f 6e5f 696e 6465 7865  f section_indexe
-00011c50: 7320 6973 206e 6f74 204e 6f6e 653a 200d  s is not None: .
-00011c60: 0a20 2020 2020 2020 2073 6563 7469 6f6e  .        section
-00011c70: 5f69 6e64 6578 6573 203d 205f 6173 7365  _indexes = _asse
-00011c80: 7274 5f72 6564 7563 655f 696e 6465 7865  rt_reduce_indexe
-00011c90: 7320 2873 6563 7469 6f6e 5f69 6e64 6578  s (section_index
-00011ca0: 6573 2920 5b30 5d20 0d0a 2020 2020 2020  es) [0] ..      
-00011cb0: 2020 6966 2073 6563 7469 6f6e 5f69 6e64    if section_ind
-00011cc0: 6578 6573 205b 315d 203e 206c 656e 2864  exes [1] > len(d
-00011cd0: 6174 6120 293a 200d 0a20 2020 2020 2020  ata ): ..       
-00011ce0: 2020 2020 2023 2069 6620 696e 6465 7820       # if index 
-00011cf0: 6973 2069 6620 7769 6465 2c74 616b 6520  is if wide,take 
-00011d00: 7468 6520 6669 7273 7420 696e 6465 7820  the first index 
-00011d10: 7468 696e 2074 6865 2065 6e64 200d 0a20  thin the end .. 
-00011d20: 2020 2020 2020 2020 2020 2073 6563 7469             secti
-00011d30: 6f6e 5f69 6e64 6578 6573 203d 205b 7365  on_indexes = [se
-00011d40: 6374 696f 6e5f 696e 6465 7865 735b 305d  ction_indexes[0]
-00011d50: 2c20 6c65 6e28 6461 7461 295d 0d0a 2020  , len(data)]..  
-00011d60: 2020 2020 2020 696e 7661 6c69 645f 696e        invalid_in
-00011d70: 6465 7865 7320 3d20 5f67 6574 5f69 6e76  dexes = _get_inv
-00011d80: 616c 6964 5f69 6e64 6578 6573 280d 0a20  alid_indexes(.. 
-00011d90: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
-00011da0: 616e 6765 2028 6c65 6e28 6461 7461 2929  ange (len(data))
-00011db0: 2c20 7365 6374 696f 6e5f 696e 6465 7865  , section_indexe
-00011dc0: 7329 2020 0d0a 0d0a 2020 2020 2320 7661  s)  ....    # va
-00011dd0: 6c69 6420 7365 6374 696f 6e20 696e 6465  lid section inde
-00011de0: 7820 6f66 2061 7175 6966 6572 0d0a 2020  x of aquifer..  
-00011df0: 2020 656c 6966 207a 5f72 616e 6765 2069    elif z_range i
-00011e00: 7320 6e6f 7420 4e6f 6e65 203a 200d 0a20  s not None : .. 
-00011e10: 2020 2020 2020 207a 203d 2069 735f 7661         z = is_va
-00011e20: 6c69 645f 6465 7074 6820 2864 6174 612c  lid_depth (data,
-00011e30: 207a 6e61 6d65 203d 207a 6e61 6d65 202c   zname = zname ,
-00011e40: 2072 6574 7572 6e5f 7a20 3d20 5472 7565   return_z = True
-00011e50: 290d 0a20 2020 2020 2020 2073 6563 7469  )..        secti
-00011e60: 6f6e 5f69 6e64 6578 6573 2c20 696e 7661  on_indexes, inva
-00011e70: 6c69 645f 696e 6465 7865 7320 3d20 6765  lid_indexes = ge
-00011e80: 745f 7365 6374 696f 6e73 5f66 726f 6d5f  t_sections_from_
-00011e90: 6465 7074 6828 0d0a 2020 2020 2020 2020  depth(..        
-00011ea0: 2020 2020 7a2c 207a 5f72 616e 6765 2c20      z, z_range, 
-00011eb0: 7265 7475 726e 5f69 6e64 6578 3d54 7275  return_index=Tru
-00011ec0: 6520 290d 0a0d 0a20 2020 2023 202b 3120  e )....    # +1 
-00011ed0: 666f 7220 5079 7468 6f6e 2069 6e64 6578  for Python index
-00011ee0: 200d 0a20 2020 2074 7279 203a 200d 0a20   ..    try : .. 
-00011ef0: 2020 2020 2020 2078 7220 3d20 6461 7461         xr = data
-00011f00: 2e69 6c6f 6320 5b72 616e 6765 2028 2a5b  .iloc [range (*[
-00011f10: 7365 6374 696f 6e5f 696e 6465 7865 735b  section_indexes[
-00011f20: 305d 2c20 7365 6374 696f 6e5f 696e 6465  0], section_inde
-00011f30: 7865 735b 2d31 5d20 2b31 5d29 5d0d 0a20  xes[-1] +1])].. 
-00011f40: 2020 2065 7863 6570 7420 496e 6465 7845     except IndexE
-00011f50: 7272 6f72 203a 200d 0a20 2020 2020 2020  rror : ..       
-00011f60: 2023 2062 7265 616b 202b 3120 6f66 2050   # break +1 of P
-00011f70: 7974 686f 6e20 696e 6465 7820 616e 6420  ython index and 
-00011f80: 7461 6b65 2069 6e64 6578 2074 6869 6e20  take index thin 
-00011f90: 7468 6520 656e 642e 200d 0a20 2020 2020  the end. ..     
-00011fa0: 2020 2078 7220 3d20 6461 7461 2e69 6c6f     xr = data.ilo
-00011fb0: 6320 5b72 616e 6765 2028 2a5b 7365 6374  c [range (*[sect
-00011fc0: 696f 6e5f 696e 6465 7865 735b 305d 2c20  ion_indexes[0], 
-00011fd0: 7365 6374 696f 6e5f 696e 6465 7865 735b  section_indexes[
-00011fe0: 2d31 5d5d 295d 0d0a 2020 2020 6578 6365  -1]])]..    exce
-00011ff0: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
-00012000: 6572 7220 3a0d 0a20 2020 2020 2020 2072  err :..        r
-00012010: 6169 7365 2065 7272 200d 0a20 2020 2069  aise err ..    i
-00012020: 6e76 616c 6964 5f69 6e64 6578 6573 203d  nvalid_indexes =
-00012030: 205f 6173 7365 7274 5f72 6564 7563 655f   _assert_reduce_
-00012040: 696e 6465 7865 7328 2a69 6e76 616c 6964  indexes(*invalid
-00012050: 5f69 6e64 6578 6573 2029 0d0a 2020 2020  _indexes )..    
-00012060: 6d61 785f 6978 203d 206d 6178 2028 6c69  max_ix = max (li
-00012070: 7374 2869 7465 7274 6f6f 6c73 2e63 6861  st(itertools.cha
-00012080: 696e 282a 696e 7661 6c69 645f 696e 6465  in(*invalid_inde
-00012090: 7865 7329 2929 0d0a 2020 2020 0d0a 2020  xes)))..    ..  
-000120a0: 2020 6966 2020 6d61 785f 6978 203e 206c    if  max_ix > l
-000120b0: 656e 2864 6174 6129 203a 0d0a 2020 2020  en(data) :..    
-000120c0: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
-000120d0: 7272 6f72 2866 2257 726f 6e67 2069 6e64  rror(f"Wrong ind
-000120e0: 6578 2120 496e 6465 7820 7b6d 6178 5f69  ex! Index {max_i
-000120f0: 787d 2069 7320 6f75 7420 6f66 2072 616e  x} is out of ran
-00012100: 6765 2022 0d0a 2020 2020 2020 2020 2020  ge "..          
-00012110: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00012120: 226f 6620 6461 7461 2077 6974 6820 6c65  "of data with le
-00012130: 6e67 7468 203d 207b 6c65 6e28 6461 7461  ngth = {len(data
-00012140: 297d 2229 0d0a 200d 0a20 2020 2078 7320  )}").. ..    xs 
-00012150: 3d20 5b20 6461 7461 2e69 6c6f 635b 2072  = [ data.iloc[ r
-00012160: 616e 6765 2028 2a20 696e 6429 5d20 666f  ange (* ind)] fo
-00012170: 7220 696e 6420 696e 2069 6e76 616c 6964  r ind in invalid
-00012180: 5f69 6e64 6578 6573 5d0d 0a0d 0a20 2020  _indexes]....   
-00012190: 2072 6574 7572 6e20 7873 2c20 7872 200d   return xs, xr .
-000121a0: 0a0d 0a64 6566 2072 6564 7563 655f 7361  ...def reduce_sa
-000121b0: 6d70 6c65 7320 280d 0a20 2020 202a 6461  mples (..    *da
-000121c0: 7461 202c 200d 0a20 2020 2073 6e61 6d65  ta , ..    sname
-000121d0: 2c20 0d0a 2020 2020 7a6e 616d 653d 4e6f  , ..    zname=No
-000121e0: 6e65 2c20 0d0a 2020 2020 6b6e 616d 653d  ne, ..    kname=
-000121f0: 204e 6f6e 652c 0d0a 2020 2020 7365 6374   None,..    sect
-00012200: 696f 6e5f 696e 6465 7865 733d 4e6f 6e65  ion_indexes=None
-00012210: 2c20 200d 0a20 2020 2065 7272 6f72 3d27  ,  ..    error='
-00012220: 7261 6973 6527 2c20 0d0a 2020 2020 7374  raise', ..    st
-00012230: 7261 7465 6779 3d20 2761 7665 7261 6765  rategy= 'average
-00012240: 272c 2020 0d0a 2020 2020 7665 7269 6679  ',  ..    verify
-00012250: 5f69 6e74 6567 7269 7479 3d46 616c 7365  _integrity=False
-00012260: 2c20 0d0a 2020 2020 6967 6e6f 7265 5f69  , ..    ignore_i
-00012270: 6e64 6578 3d46 616c 7365 2c20 0d0a 2020  ndex=False, ..  
-00012280: 2020 2a2a 6b77 730d 0a20 2020 2029 2d3e    **kws..    )->
-00012290: 4c69 7374 5b44 6174 6146 7261 6d65 5d20  List[DataFrame] 
-000122a0: 3a20 0d0a 2020 2020 0d0a 2020 2020 6d73  : ..    ..    ms
-000122b0: 6720 3d20 2822 2753 6f66 7427 206d 6f64  g = ("'Soft' mod
-000122c0: 6520 6973 2074 7269 6767 6572 6564 2066  e is triggered f
-000122d0: 6f72 2073 616d 706c 6573 2072 6564 7563  or samples reduc
-000122e0: 696e 672e 220d 0a20 2020 2020 2020 2020  ing."..         
-000122f0: 2020 2220 7b30 7d20 6e75 6d62 6572 7b31    " {0} number{1
-00012300: 7d20 6f66 2064 6174 6120 7061 7373 6564  } of data passed
-00012310: 2061 7265 206e 6f74 2076 616c 6964 2e22   are not valid."
-00012320: 0d0a 2020 2020 2020 2020 2020 2022 2052  ..           " R
-00012330: 656d 656d 6265 7220 7468 6174 2064 6174  emember that dat
-00012340: 6120 6d75 7374 2063 6f6e 7461 696e 2074  a must contain t
-00012350: 6865 2027 6465 7074 6827 2061 6e64 220d  he 'depth' and".
-00012360: 0a20 2020 2020 2020 2020 2020 2220 6171  .           " aq
-00012370: 7569 6665 7220 7661 6c75 6573 2e20 5368  uifer values. Sh
-00012380: 6f75 6c64 2062 6520 6469 7363 6172 6465  ould be discarde
-00012390: 6420 6475 7269 6e67 2074 6865 220d 0a20  d during the".. 
-000123a0: 2020 2020 2020 2020 2020 2220 636f 6d70            " comp
-000123b0: 7574 696e 6720 6f66 2061 7175 6966 6572  uting of aquifer
-000123c0: 2073 6563 7469 6f6e 732e 2054 6869 7320   sections. This 
-000123d0: 6d69 6768 7420 6c65 6164 2074 6f22 0d0a  might lead to"..
-000123e0: 2020 2020 2020 2020 2020 2022 2062 7265             " bre
-000123f0: 616b 696e 6720 636f 6465 206f 7220 696e  aking code or in
-00012400: 7661 6c69 6420 7265 7375 6c74 732e 2055  valid results. U
-00012410: 7365 2061 7420 796f 7572 206f 776e 2022  se at your own "
-00012420: 0d0a 2020 2020 2020 2020 2020 2022 2072  ..           " r
-00012430: 6973 6b2e 2220 0d0a 2020 2020 2020 2020  isk." ..        
-00012440: 290d 0a0d 0a20 2020 2064 6630 203d 2063  )....    df0 = c
-00012450: 6f70 792e 6465 6570 636f 7079 2864 6174  opy.deepcopy(dat
-00012460: 6129 2023 206d 616b 6520 6120 636f 7079  a) # make a copy
-00012470: 206f 6620 6672 616d 6520 0d0a 2020 2020   of frame ..    
-00012480: 6466 7320 3d20 5f76 616c 6964 6174 655f  dfs = _validate_
-00012490: 7361 6d70 6c65 7328 202a 6466 3020 2920  samples( *df0 ) 
-000124a0: 200d 0a20 2020 200d 0a20 2020 2064 6673   ..    ..    dfs
-000124b0: 3d5b 6466 2e72 6573 6574 5f69 6e64 6578  =[df.reset_index
-000124c0: 2829 2066 6f72 2064 6620 696e 2064 6673  () for df in dfs
-000124d0: 5d20 2320 7265 7365 7420 696e 6465 7820  ] # reset index 
-000124e0: 0d0a 2020 2020 2320 6765 7420 7468 6520  ..    # get the 
-000124f0: 6171 7569 6665 7220 7365 6374 696f 6e73  aquifer sections
-00012500: 2066 6972 7473 200d 0a20 2020 2069 6620   firts ..    if 
-00012510: 7365 6374 696f 6e5f 696e 6465 7865 7320  section_indexes 
-00012520: 6973 204e 6f6e 653a 200d 0a20 2020 2020  is None: ..     
-00012530: 2020 2073 6563 7469 6f6e 5f69 6e64 6578     section_index
-00012540: 6573 2c20 6466 7320 3d20 6765 745f 756e  es, dfs = get_un
-00012550: 6971 7565 5f73 6563 7469 6f6e 280d 0a20  ique_section(.. 
-00012560: 2020 2020 2020 2020 2020 202a 6466 732c             *dfs,
-00012570: 207a 6e61 6d65 3d7a 6e61 6d65 2c20 6b6e   zname=zname, kn
-00012580: 616d 653d 6b6e 616d 652c 2065 7272 6f72  ame=kname, error
-00012590: 3d20 6572 726f 722c 200d 0a20 2020 2020  = error, ..     
-000125a0: 2020 2020 2020 2072 6574 7572 6e5f 6461         return_da
-000125b0: 7461 203d 5472 7565 2c20 7265 7475 726e  ta =True, return
-000125c0: 5f69 6e64 6578 3d54 7275 6520 0d0a 2020  _index=True ..  
-000125d0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-000125e0: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-000125f0: 6620 6c65 6e28 6466 3029 213d 6c65 6e28  f len(df0)!=len(
-00012600: 6466 7329 3a20 0d0a 2020 2020 2020 2020  dfs): ..        
-00012610: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00012620: 6e20 2820 6d73 672e 666f 726d 6174 286c  n ( msg.format(l
-00012630: 656e 2873 6563 7469 6f6e 5f69 6e64 6578  en(section_index
-00012640: 6573 292c 200d 0a20 2020 2020 2020 2020  es), ..         
-00012650: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00012660: 7322 2069 6620 6c65 6e28 7365 6374 696f  s" if len(sectio
-00012670: 6e5f 696e 6465 7865 7329 3e31 2065 6c73  n_indexes)>1 els
-00012680: 6520 2222 2929 0d0a 2020 2020 2020 2020  e ""))..        
-00012690: 0d0a 2020 2020 5873 2c20 5872 203d 5b5d  ..    Xs, Xr =[]
-000126a0: 2c20 5b5d 0d0a 2020 2020 666f 7220 6466  , []..    for df
-000126b0: 2069 6e20 6466 7320 3a20 0d0a 2020 2020   in dfs : ..    
-000126c0: 2020 2020 7873 2c20 7872 203d 2067 6574      xs, xr = get
-000126d0: 5f78 735f 7872 5f73 706c 6974 7320 2864  _xs_xr_splits (d
-000126e0: 662c 2073 6563 7469 6f6e 5f69 6e64 6578  f, section_index
-000126f0: 6573 3d20 7365 6374 696f 6e5f 696e 6465  es= section_inde
-00012700: 7865 7329 0d0a 2020 2020 2020 2020 5873  xes)..        Xs
-00012710: 2e61 7070 656e 6428 7873 2920 3b20 5872  .append(xs) ; Xr
-00012720: 2e61 7070 656e 6428 7872 290d 0a20 2020  .append(xr)..   
-00012730: 2020 2020 200d 0a20 2020 2064 5f6e 6577       ..    d_new
-00012740: 3d5b 5d0d 0a20 2020 2066 6f72 2020 6466  =[]..    for  df
-00012750: 5f78 7320 2c20 6466 5f78 7220 696e 207a  _xs , df_xr in z
-00012760: 6970 2028 2058 7320 2c20 5872 2029 3a20  ip ( Xs , Xr ): 
-00012770: 0d0a 2020 2020 2020 2020 2320 2320 636f  ..        # # co
-00012780: 6d70 7574 6520 7468 6520 6261 7365 2073  mpute the base s
-00012790: 7472 6174 756d 2066 6f72 200d 0a20 2020  tratum for ..   
-000127a0: 2020 2020 2023 2065 6163 6820 6561 6368       # each each
-000127b0: 2072 6564 7563 6520 7365 6374 696f 6e73   reduce sections
-000127c0: 200d 0a20 2020 2020 2020 2062 6173 6573   ..        bases
-000127d0: 5f73 203d 205b 2073 656c 6563 745f 6261  _s = [ select_ba
-000127e0: 7365 5f73 7472 6174 756d 2864 2c20 736e  se_stratum(d, sn
-000127f0: 616d 653d 736e 616d 6520 290d 0a20 2020  ame=sname )..   
-00012800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012810: 2066 6f72 2069 2c20 6420 696e 2065 6e75   for i, d in enu
-00012820: 6d65 7261 7465 2028 6466 5f78 7329 205d  merate (df_xs) ]
-00012830: 200d 0a20 2020 2020 2020 2023 2072 6564   ..        # red
-00012840: 7563 6520 7361 6d70 6c65 2066 6f72 2065  uce sample for e
-00012850: 6163 6820 696e 7661 6c69 6420 7365 6374  ach invalid sect
-00012860: 696f 6e20 7769 7468 200d 0a20 2020 2020  ion with ..     
-00012870: 2020 2023 206d 6973 7369 6e67 206b 200d     # missing k .
-00012880: 0a20 2020 2020 2020 2063 6f6d 705f 7665  .        comp_ve
-00012890: 6373 203d 205b 2067 6574 5f63 6f6d 7072  cs = [ get_compr
-000128a0: 6573 7365 645f 7665 6374 6f72 2820 642c  essed_vector( d,
-000128b0: 2073 6e61 6d65 3d73 6e61 6d65 202c 2073   sname=sname , s
-000128c0: 7472 6174 756d 203d 2073 742c 2020 0d0a  tratum = st,  ..
-000128d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000128e0: 2020 2020 2061 735f 6672 616d 6520 3d54       as_frame =T
-000128f0: 7275 6520 2c20 7374 7261 7465 6779 3d73  rue , strategy=s
-00012900: 7472 6174 6567 792c 200d 0a20 2020 2020  trategy, ..     
-00012910: 2020 2020 2020 2029 2066 6f72 2069 2c20         ) for i, 
-00012920: 2873 7420 2c20 6429 2020 696e 2065 6e75  (st , d)  in enu
-00012930: 6d65 7261 7465 2028 207a 6970 2028 6261  merate ( zip (ba
-00012940: 7365 735f 7320 2c20 6466 5f78 7329 2920  ses_s , df_xs)) 
-00012950: 205d 0d0a 2020 2020 2020 2020 2320 6765   ]..        # ge
-00012960: 7420 7468 6520 696e 6465 7820 746f 2073  t the index to s
-00012970: 7461 636b 2074 6865 2063 6f6d 7072 6573  tack the compres
-00012980: 6564 2073 616d 706c 6520 7769 7468 200d  ed sample with .
-00012990: 0a20 2020 2020 2020 2023 2074 6865 2076  .        # the v
-000129a0: 616c 6964 2070 6172 7420 6f66 2061 7175  alid part of aqu
-000129b0: 6966 6572 2064 6174 612e 200d 0a20 2020  ifer data. ..   
-000129c0: 2020 2020 2078 735f 696e 6465 7865 7320       xs_indexes 
-000129d0: 3d20 5b28 206d 696e 2820 6466 2e69 6e64  = [( min( df.ind
-000129e0: 6578 292c 206d 6178 2864 662e 696e 6465  ex), max(df.inde
-000129f0: 7829 2920 666f 7220 6466 2069 6e20 6466  x)) for df in df
-00012a00: 5f78 7320 5d0d 0a20 2020 2020 2020 2023  _xs ]..        #
-00012a10: 2063 6f6e 6361 7420 7468 6520 636f 6d70   concat the comp
-00012a20: 7265 7373 2077 6974 6820 7872 200d 0a20  ress with xr .. 
-00012a30: 2020 2020 2020 2064 665f 3d20 5f63 6f6e         df_= _con
-00012a40: 6361 745f 636f 6d70 7265 7373 6564 5f78  cat_compressed_x
-00012a50: 735f 7872 280d 0a20 2020 2020 2020 2020  s_xr(..         
-00012a60: 2020 2078 735f 696e 6465 7865 7320 3d78     xs_indexes =x
-00012a70: 735f 696e 6465 7865 7320 2c78 725f 696e  s_indexes ,xr_in
-00012a80: 6465 7865 7320 3d20 7365 6374 696f 6e5f  dexes = section_
-00012a90: 696e 6465 7865 732c 200d 0a20 2020 2020  indexes, ..     
-00012aa0: 2020 2020 2020 2020 2020 2063 6f6d 7072             compr
-00012ab0: 6573 7365 645f 6672 616d 6573 203d 2063  essed_frames = c
-00012ac0: 6f6d 705f 7665 6373 2c20 0d0a 2020 2020  omp_vecs, ..    
-00012ad0: 2020 2020 2020 2020 2020 2020 7872 3d20              xr= 
-00012ae0: 6466 5f78 7220 290d 0a20 2020 2020 2020  df_xr )..       
-00012af0: 2064 5f6e 6577 2e61 7070 656e 6420 2864   d_new.append (d
-00012b00: 665f 290d 0a0d 0a20 2020 2069 6620 6e6f  f_)....    if no
-00012b10: 7420 6967 6e6f 7265 5f69 6e64 6578 3a20  t ignore_index: 
-00012b20: 0d0a 2020 2020 2020 2020 2320 676f 7420  ..        # got 
-00012b30: 6261 636b 2069 6e69 616c 2064 6174 612e  back inial data.
-00012b40: 200d 0a20 2020 2020 2020 2064 5f6e 6577   ..        d_new
-00012b50: 203d 205b 2064 662e 6472 6f70 2028 2063   = [ df.drop ( c
-00012b60: 6f6c 756d 6e73 203d 2027 696e 6465 7827  olumns = 'index'
-00012b70: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
-00012b80: 2020 2020 2020 6966 2027 696e 6465 7827        if 'index'
-00012b90: 2069 6e20 6466 2e63 6f6c 756d 6e73 2065   in df.columns e
-00012ba0: 6c73 6520 6466 200d 0a20 2020 2020 2020  lse df ..       
-00012bb0: 2020 2020 2020 2020 2020 2066 6f72 2064             for d
-00012bc0: 6620 696e 2064 5f6e 6577 200d 0a20 2020  f in d_new ..   
-00012bd0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00012be0: 0d0a 2020 2020 2320 7665 7269 6679 2069  ..    # verify i
-00012bf0: 6e74 6567 7269 7479 2066 6972 7374 0d0a  ntegrity first..
-00012c00: 2020 2020 2320 6265 666f 7265 2072 6573      # before res
-00012c10: 6574 2069 6e64 6578 200d 0a20 2020 2069  et index ..    i
-00012c20: 6620 7665 7269 6679 5f69 6e74 6567 7269  f verify_integri
-00012c30: 7479 3a20 0d0a 2020 2020 2020 2020 645f  ty: ..        d_
-00012c40: 6e65 7720 3d20 5b20 2064 662e 6472 6f70  new = [  df.drop
-00012c50: 5f64 7570 6c69 6361 7465 7328 7375 6273  _duplicates(subs
-00012c60: 6574 3d4e 6f6e 652c 206b 6565 703d 2766  et=None, keep='f
-00012c70: 6972 7374 272c 2020 0d0a 2020 2020 2020  irst',  ..      
-00012c80: 2020 2020 2020 6967 6e6f 7265 5f69 6e64        ignore_ind
-00012c90: 6578 3d69 676e 6f72 655f 696e 6465 7820  ex=ignore_index 
-00012ca0: 2920 666f 7220 6466 2069 6e20 645f 6e65  ) for df in d_ne
-00012cb0: 7720 5d20 0d0a 2020 2020 2020 2020 0d0a  w ] ..        ..
-00012cc0: 2020 2020 6966 2069 676e 6f72 655f 696e      if ignore_in
-00012cd0: 6465 7820 3a20 0d0a 2020 2020 2020 2020  dex : ..        
-00012ce0: 2320 7265 7365 7420 7468 6520 696e 6465  # reset the inde
-00012cf0: 7820 6f66 2074 6865 206e 6577 2064 6174  x of the new dat
-00012d00: 6120 6672 616d 650d 0a20 2020 2020 2020  a frame..       
-00012d10: 2064 5f6e 6577 203d 205b 6466 2e72 6573   d_new = [df.res
-00012d20: 6574 5f69 6e64 6578 2028 2920 666f 7220  et_index () for 
-00012d30: 6466 2069 6e20 645f 6e65 7720 5d0d 0a20  df in d_new ].. 
-00012d40: 2020 2020 2020 2064 5f6e 6577 203d 205b         d_new = [
-00012d50: 2064 662e 6472 6f70 2028 636f 6c75 6d6e   df.drop (column
-00012d60: 7320 3d20 276c 6576 656c 5f30 2720 6f72  s = 'level_0' or
-00012d70: 2027 696e 6465 7827 2920 6966 0d0a 2020   'index') if..  
-00012d80: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-00012d90: 276c 6576 656c 5f30 2720 6f72 2027 696e  'level_0' or 'in
-00012da0: 6465 7827 2920 2069 6e20 6466 2e63 6f6c  dex')  in df.col
-00012db0: 756d 6e73 2065 6c73 6520 6466 200d 0a20  umns else df .. 
-00012dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012dd0: 666f 7220 6466 2069 6e20 645f 6e65 7720  for df in d_new 
-00012de0: 205d 0d0a 2020 2020 0d0a 2020 2020 7265   ]..    ..    re
-00012df0: 7475 726e 2064 5f6e 6577 200d 0a0d 0a72  turn d_new ....r
-00012e00: 6564 7563 655f 7361 6d70 6c65 732e 5f5f  educe_samples.__
-00012e10: 646f 635f 5f20 3d22 2222 5c0d 0a43 7265  doc__ ="""\..Cre
-00012e20: 6174 6520 6120 6e65 7720 6461 7461 6672  ate a new datafr
-00012e30: 616d 6520 6279 2073 7175 6565 7a69 6e67  ame by squeezing
-00012e40: 2f63 6f6d 7072 6573 7369 6e67 2074 6865  /compressing the
-00012e50: 206e 6f6e 2076 616c 6964 2064 6174 612e   non valid data.
-00012e60: 200d 0a0d 0a54 6865 206d 2d73 616d 706c   ....The m-sampl
-00012e70: 6573 2072 6564 7563 7469 6f6e 2069 7320  es reduction is 
-00012e80: 6e65 6365 7373 6172 7920 666f 7220 7468  necessary for th
-00012e90: 6520 6461 7461 7365 7420 7769 7468 2061  e dataset with a
-00012ea0: 206c 6f74 206f 6620 0d0a 6d69 7373 696e   lot of ..missin
-00012eb0: 6720 6b2d 7661 6c75 6573 2e20 5468 6520  g k-values. The 
-00012ec0: 7465 6368 6e69 7175 6520 6f66 2073 6872  technique of shr
-00012ed0: 696e 6b69 6e67 2074 6865 206e 756d 6265  inking the numbe
-00012ee0: 7220 6f66 206b 3020 e280 9376 616c 7565  r of k0 ...value
-00012ef0: 7320 0d0a 286b 2d6d 6973 7369 6e67 2076  s ..(k-missing v
-00012f00: 616c 7565 7320 2920 7365 656d 7320 6120  alues ) seems a 
-00012f10: 7265 6c65 7661 6e74 2069 6465 612e 2049  relevant idea. I
-00012f20: 7420 636f 6e73 6973 7473 2074 6f20 636f  t consists to co
-00012f30: 6d70 7265 7373 6564 2074 6865 200d 0a76  mpressed the ..v
-00012f40: 616c 7565 7320 6f66 2074 6865 206d 6973  alues of the mis
-00012f50: 7369 6e67 203a 6d61 7468 3a60 6b20 2d76  sing :math:`k -v
-00012f60: 616c 7565 7320 6672 6f6d 2074 6865 2074  alues from the t
-00012f70: 6f70 2028 2064 6570 7468 2065 7175 616c  op ( depth equal
-00012f80: 7320 3020 2920 0d0a 7468 696e 2074 6865  s 0 ) ..thin the
-00012f90: 2075 7070 6572 2073 6563 7469 6f6e 206f   upper section o
-00012fa0: 6620 7468 6520 6669 7273 7420 6171 7569  f the first aqui
-00012fb0: 6665 7220 7769 7468 206c 6f77 6572 2064  fer with lower d
-00012fc0: 6570 7468 2069 6e74 6f20 0d0a 6120 7369  epth into ..a si
-00012fd0: 6e67 6c65 2076 6563 746f 7220 3a6d 6174  ngle vector :mat
-00012fe0: 683a 6078 5f72 6020 7769 7468 2064 696d  h:`x_r` with dim
-00012ff0: 656e 7369 6f6e 2028 31c3 976e 2029 2069  ension (1..n ) i
-00013000: 2e65 2e20 636f 6e74 6169 6e73 200d 0a74  .e. contains ..t
-00013010: 6865 206e 2d66 6561 7475 7265 732e 2020  he n-features.  
-00013020: 0d0a 200d 0a50 6172 616d 6574 6572 7320  .. ..Parameters 
-00013030: 0d0a 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a64  ..-----------..d
-00013040: 6174 613a 206c 6973 7420 6f66 2064 6174  ata: list of dat
-00013050: 6166 7261 6d65 730d 0a20 2020 2044 6174  aframes..    Dat
-00013060: 6120 7468 6174 2063 6f6e 7461 696e 7320  a that contains 
-00013070: 6d61 696e 6c79 2074 6865 2061 7175 6966  mainly the aquif
-00013080: 6572 2076 616c 7565 732e 2049 7420 6d75  er values. It mu
-00013090: 7374 2063 6f6e 7461 696e 7320 7468 6520  st contains the 
-000130a0: 0d0a 2020 2020 6465 7074 6820 7661 6c75  ..    depth valu
-000130b0: 6573 2072 6566 6572 696e 6720 6174 2074  es refering at t
-000130c0: 6865 2063 6f6c 756d 6e5f 6e61 6d65 2070  he column_name p
-000130d0: 6173 7365 6420 6174 2060 7a6e 616d 6560  assed at `zname`
-000130e0: 2020 616e 6420 0d0a 2020 2020 7468 6520    and ..    the 
-000130f0: 7065 726d 6561 6269 6c69 7479 2063 6f65  permeability coe
-00013100: 6666 6963 6965 6e74 2060 6b60 2070 6173  fficient `k` pas
-00013110: 7365 6420 746f 2060 6b6e 616d 6560 202e  sed to `kname` .
-00013120: 2042 6f74 6820 6172 6775 6d65 6e74 206e   Both argument n
-00013130: 6565 6420 0d0a 2020 2020 7420 7375 7070  eed ..    t supp
-00013140: 6c69 6564 2077 6865 6e20 6461 7461 6661  lied when datafa
-00013150: 6d65 2061 7320 7061 7373 6573 2061 7320  me as passes as 
-00013160: 706f 7369 7469 6f6e 616c 2061 7267 756d  positional argum
-00013170: 656e 7473 2e0d 0a20 2020 200d 0a73 6e61  ents...    ..sna
-00013180: 6d65 3a20 7374 722c 206f 7074 696f 6e61  me: str, optiona
-00013190: 6c20 0d0a 2020 2020 4e61 6d65 206f 6620  l ..    Name of 
-000131a0: 636f 6c75 6d6e 2069 6e20 7468 6520 6461  column in the da
-000131b0: 7461 6672 616d 6520 7468 6174 2063 6f6e  taframe that con
-000131c0: 7461 696e 7320 7468 6520 7374 7261 7461  tains the strata
-000131d0: 2076 616c 7565 732e 200d 0a20 2020 2044   values. ..    D
-000131e0: 6f6e 7420 636f 6e66 7573 6520 2773 6e61  ont confuse 'sna
-000131f0: 6d65 2720 7769 7468 2027 7374 7261 7475  me' with 'stratu
-00013200: 6d27 2077 6869 6368 2069 7320 7468 6520  m' which is the 
-00013210: 6e61 6d65 206f 6620 7468 6520 7661 6c69  name of the vali
-00013220: 6420 0d0a 2020 2020 6c61 7965 722f 726f  d ..    layer/ro
-00013230: 636b 2069 6e20 7468 6520 6172 7261 792f  ck in the array/
-00013240: 5365 7269 6573 206f 6620 7374 7261 7461  Series of strata
-00013250: 2e20 0d0a 0d0a 7b70 6172 616d 732e 636f  . ....{params.co
-00013260: 7265 2e7a 6e61 6d65 7d0d 0a7b 7061 7261  re.zname}..{para
-00013270: 6d73 2e63 6f72 652e 6b6e 616d 657d 0d0a  ms.core.kname}..
-00013280: 7b70 6172 616d 732e 636f 7265 2e7a 7d0d  {params.core.z}.
-00013290: 0a0d 0a73 7472 6174 6567 793a 2073 7472  ...strategy: str
-000132a0: 202c 2064 6566 6175 6c74 3d27 6176 6572   , default='aver
-000132b0: 6167 6527 206f 7220 276d 6561 6e27 2c20  age' or 'mean', 
-000132c0: 0d0a 2020 2020 7374 7261 7465 6779 2075  ..    strategy u
-000132d0: 7365 6420 746f 2073 656c 6563 7420 6f72  sed to select or
-000132e0: 2063 6f6d 7075 7465 2074 6865 206e 756d   compute the num
-000132f0: 6572 6963 616c 2064 6174 6120 696e 746f  erical data into
-00013300: 2061 200d 0a20 2020 2073 696e 6775 6c61   a ..    singula
-00013310: 7220 7365 7269 6573 2e20 4974 2063 616e  r series. It can
-00013320: 2062 6520 5b27 6e61 6976 6527 5d2e 2049   be ['naive']. I
-00013330: 6e20 7468 6174 2063 6173 6520 2c20 6120  n that case , a 
-00013340: 7369 6e67 6c65 2073 6572 6965 200d 0a20  single serie .. 
-00013350: 2020 2069 6620 7261 6e64 6f6d 6c79 2070     if randomly p
-00013360: 6963 6b65 6420 7570 2069 6e74 6f20 7468  icked up into th
-00013370: 6520 6261 7365 2073 7472 6174 6120 6461  e base strata da
-00013380: 7461 2e0d 0a20 2020 200d 0a73 6563 7469  ta...    ..secti
-00013390: 6f6e 5f69 6e64 6578 6573 3a20 7475 706c  on_indexes: tupl
-000133a0: 6520 6f72 206c 6973 7420 6f66 2069 6e74  e or list of int
-000133b0: 200d 0a20 2020 206c 6973 7420 6f66 2061   ..    list of a
-000133c0: 2070 6169 7220 7475 706c 6520 6f72 206c   pair tuple or l
-000133d0: 6973 7420 6f66 2069 6e74 6567 6572 732e  ist of integers.
-000133e0: 2049 7420 6973 2062 6520 7468 6520 7468   It is be the th
-000133f0: 6520 7661 6c69 6420 0d0a 2020 2020 7365  e valid ..    se
-00013400: 6374 696f 6e73 2820 7570 7065 7220 616e  ctions( upper an
-00013410: 6420 6c6f 7765 7220 2920 696e 6465 7865  d lower ) indexe
-00013420: 7320 6f66 2020 6f66 2074 6865 2061 7175  s of  of the aqu
-00013430: 6966 6572 2e20 4966 200d 0a20 2020 2074  ifer. If ..    t
-00013440: 6865 2064 6570 7468 2072 616e 6765 2060  he depth range `
-00013450: 7a5f 7261 6e67 6560 2061 6e64 2060 7a6e  z_range` and `zn
-00013460: 616d 6560 2061 7265 2073 7570 706c 6965  ame` are supplie
-00013470: 642c 2060 7365 6374 696f 6e5f 696e 6465  d, `section_inde
-00013480: 7865 7360 0d0a 2020 2020 6361 6e20 6265  xes`..    can be
-00013490: 204e 6f6e 652e 2020 4e6f 7465 2074 6861   None.  Note tha
-000134a0: 7420 7468 6520 6c61 7374 2069 6e64 6978  t the last indix
-000134b0: 2069 7320 636f 6e73 6964 6572 6564 2061   is considered a
-000134c0: 7320 7468 6520 6c61 7374 200d 0a20 2020  s the last ..   
-000134d0: 2070 6f73 6974 696f 6e2c 2074 6865 2062   position, the b
-000134e0: 6f74 746f 6d20 6f66 2074 6865 2073 6563  ottom of the sec
-000134f0: 7469 6f6e 2074 6865 7265 666f 7265 2c20  tion therefore, 
-00013500: 6974 7320 7661 6c75 6520 6973 200d 0a20  its value is .. 
-00013510: 2020 2069 6e63 6c75 6465 6420 696e 2074     included in t
-00013520: 6865 2064 6174 612e 0d0a 2020 2020 2020  he data...      
-00013530: 2020 0d0a 6572 726f 723a 2073 7472 2c20    ..error: str, 
-00013540: 6465 6661 756c 743d 2772 6169 7365 2720  default='raise' 
-00013550: 0d0a 2020 2020 5261 6973 6520 6572 726f  ..    Raise erro
-00013560: 7273 2069 6620 7472 6f75 626c 6520 6f63  rs if trouble oc
-00013570: 6375 7273 2077 6865 6e20 636f 6d70 7574  curs when comput
-00013580: 696e 6720 7468 6520 7365 6374 696f 6e20  ing the section 
-00013590: 6f66 2065 6163 6820 6171 7569 6665 722e  of each aquifer.
-000135a0: 200d 0a20 2020 2049 6620 2769 676e 6f72   ..    If 'ignor
-000135b0: 6527 2c20 6120 5573 6572 5761 726e 696e  e', a UserWarnin
-000135c0: 6720 6973 2064 6973 706c 6179 6564 2077  g is displayed w
-000135d0: 6865 6e20 696e 7661 6c69 6420 6461 7461  hen invalid data
-000135e0: 2069 7320 666f 756e 642e 2041 6e79 200d   is found. Any .
-000135f0: 0a20 2020 206f 7468 6572 2076 616c 7565  .    other value
-00013600: 206f 6620 6065 7272 6f72 6020 7769 6c6c   of `error` will
-00013610: 2073 6574 2065 7272 6f72 2074 6f20 6072   set error to `r
-00013620: 6169 7365 602e 200d 0a0d 0a76 6572 6966  aise`. ....verif
-00013630: 795f 696e 7465 6772 6974 793a 2062 6f6f  y_integrity: boo
-00013640: 6c2c 2064 6566 6175 6c74 3d46 616c 7365  l, default=False
-00013650: 0d0a 2020 2020 4368 6563 6b20 7468 6520  ..    Check the 
-00013660: 6e65 7720 696e 6465 7820 666f 7220 6475  new index for du
-00013670: 706c 6963 6174 6573 2e20 4f74 6865 7277  plicates. Otherw
-00013680: 6973 6520 6465 6665 7220 7468 6520 6368  ise defer the ch
-00013690: 6563 6b20 756e 7469 6c20 0d0a 2020 2020  eck until ..    
-000136a0: 6e65 6365 7373 6172 792e 2053 6574 7469  necessary. Setti
-000136b0: 6e67 2074 6f20 4661 6c73 6520 7769 6c6c  ng to False will
-000136c0: 2069 6d70 726f 7665 2074 6865 2070 6572   improve the per
-000136d0: 666f 726d 616e 6365 206f 6620 0d0a 2020  formance of ..  
-000136e0: 2020 7468 6973 206d 6574 686f 642e 0d0a    this method...
-000136f0: 2020 2020 6966 2027 5472 7565 272c 2072      if 'True', r
-00013700: 656d 6f76 6520 7468 6520 6475 706c 6963  emove the duplic
-00013710: 6174 6520 726f 7773 2066 726f 6d20 6120  ate rows from a 
-00013720: 4461 7461 4672 616d 652e 0d0a 2020 2020  DataFrame...    
-00013730: 0d0a 2020 2020 2020 2020 7375 6273 6574  ..        subset
-00013740: 3a20 4279 2064 6566 6175 6c74 2c20 6966  : By default, if
-00013750: 2074 6865 2072 6f77 7320 6861 7665 2074   the rows have t
-00013760: 6865 2073 616d 6520 7661 6c75 6573 2069  he same values i
-00013770: 6e20 616c 6c20 7468 6520 0d0a 2020 2020  n all the ..    
-00013780: 2020 2020 636f 6c75 6d6e 732c 2074 6865      columns, the
-00013790: 7920 6172 6520 636f 6e73 6964 6572 6564  y are considered
-000137a0: 2064 7570 6c69 6361 7465 732e 2054 6869   duplicates. Thi
-000137b0: 7320 7061 7261 6d65 7465 7220 6973 2075  s parameter is u
-000137c0: 7365 6420 0d0a 2020 2020 2020 2020 746f  sed ..        to
-000137d0: 2073 7065 6369 6679 2074 6865 2063 6f6c   specify the col
-000137e0: 756d 6e73 2074 6861 7420 6f6e 6c79 206e  umns that only n
-000137f0: 6565 6420 746f 2062 6520 636f 6e73 6964  eed to be consid
-00013800: 6572 6564 2066 6f72 200d 0a20 2020 2020  ered for ..     
-00013810: 2020 2069 6465 6e74 6966 7969 6e67 2064     identifying d
-00013820: 7570 6c69 6361 7465 732e 0d0a 2020 2020  uplicates...    
-00013830: 2020 2020 6b65 6570 3a20 4465 7465 726d      keep: Determ
-00013840: 696e 6573 2077 6869 6368 2064 7570 6c69  ines which dupli
-00013850: 6361 7465 7320 2869 6620 616e 7929 2074  cates (if any) t
-00013860: 6f20 6b65 6570 2e20 4974 2074 616b 6573  o keep. It takes
-00013870: 2069 6e70 7574 7320 6173 2c0d 0a20 2020   inputs as,..   
-00013880: 2020 2020 2066 6972 7374 20e2 8093 2044       first ... D
-00013890: 726f 7020 6475 706c 6963 6174 6573 2065  rop duplicates e
-000138a0: 7863 6570 7420 666f 7220 7468 6520 6669  xcept for the fi
-000138b0: 7273 7420 6f63 6375 7272 656e 6365 2e20  rst occurrence. 
-000138c0: 0d0a 2020 2020 2020 2020 5468 6973 2069  ..        This i
-000138d0: 7320 7468 6520 6465 6661 756c 7420 6265  s the default be
-000138e0: 6861 7669 6f72 2e0d 0a20 2020 2020 2020  havior...       
-000138f0: 206c 6173 7420 e280 9320 4472 6f70 2064   last ... Drop d
-00013900: 7570 6c69 6361 7465 7320 6578 6365 7074  uplicates except
-00013910: 2066 6f72 2074 6865 206c 6173 7420 6f63   for the last oc
-00013920: 6375 7272 656e 6365 2e0d 0a20 2020 2020  currence...     
-00013930: 2020 2046 616c 7365 20e2 8093 2044 726f     False ... Dro
-00013940: 7020 616c 6c20 6475 706c 6963 6174 6573  p all duplicates
-00013950: 2e0d 0a20 2020 2020 2020 2069 6e70 6c61  ...        inpla
-00013960: 6365 3a20 4974 2069 7320 7573 6564 2074  ce: It is used t
-00013970: 6f20 7370 6563 6966 7920 7768 6574 6865  o specify whethe
-00013980: 7220 746f 2072 6574 7572 6e20 6120 6e65  r to return a ne
-00013990: 7720 4461 7461 4672 616d 6520 6f72 200d  w DataFrame or .
-000139a0: 0a20 2020 2020 2020 2075 7064 6174 6520  .        update 
-000139b0: 616e 2065 7869 7374 696e 6720 6f6e 652e  an existing one.
-000139c0: 2049 7420 6973 2061 2062 6f6f 6c65 616e   It is a boolean
-000139d0: 2066 6c61 6720 7769 7468 2064 6566 6175   flag with defau
-000139e0: 6c74 2046 616c 7365 2e0d 0a69 676e 6f72  lt False...ignor
-000139f0: 655f 696e 6465 783a 2062 6f6f 6c2c 2064  e_index: bool, d
-00013a00: 6566 6175 6c74 3d46 616c 7365 2c20 0d0a  efault=False, ..
-00013a10: 2020 2020 4974 2069 7320 6120 626f 6f6c      It is a bool
-00013a20: 6561 6e20 666c 6167 2074 6f20 696e 6469  ean flag to indi
-00013a30: 6361 7465 2069 6620 726f 7720 696e 6465  cate if row inde
-00013a40: 7820 7368 6f75 6c64 200d 0a20 2020 2062  x should ..    b
-00013a50: 6520 7265 7365 7420 6166 7465 7220 6472  e reset after dr
-00013a60: 6f70 7069 6e67 2064 7570 6c69 6361 7465  opping duplicate
-00013a70: 2072 6f77 732e 2046 616c 7365 3a20 4974   rows. False: It
-00013a80: 206b 6565 7073 2074 6865 206f 7269 6769   keeps the origi
-00013a90: 6e61 6c20 0d0a 2020 2020 726f 7720 696e  nal ..    row in
-00013aa0: 6465 782e 2054 7275 653a 2049 7420 7265  dex. True: It re
-00013ab0: 7365 7420 7468 6520 696e 6465 782c 2061  set the index, a
-00013ac0: 6e64 2074 6865 2072 6573 756c 7469 6e67  nd the resulting
-00013ad0: 2072 6f77 7320 7769 6c6c 2062 6520 0d0a   rows will be ..
-00013ae0: 2020 2020 6c61 6265 6c65 6420 302c 2031      labeled 0, 1
-00013af0: 2c20 e280 a62c 206e 20e2 8093 2031 2e20  , ..., n ... 1. 
-00013b00: 0d0a 2020 2020 0d0a 5265 7475 726e 7320  ..    ..Returns 
-00013b10: 0d0a 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 6466  ..----------..df
-00013b20: 5f6e 6577 3a20 4c69 7374 206f 6620 7061  _new: List of pa
-00013b30: 6e64 6173 2e64 6174 6166 7261 6d65 730d  ndas.dataframes.
-00013b40: 0a20 2020 206e 6577 2064 6174 6166 7261  .    new datafra
-00013b50: 6d65 7320 7769 7468 2072 6564 7563 696e  mes with reducin
-00013b60: 6720 7361 6d70 6c65 732e 200d 0a20 2020  g samples. ..   
-00013b70: 200d 0a45 7861 6d70 6c65 200d 0a2d 2d2d   ..Example ..---
-00013b80: 2d2d 2d2d 2d0d 0a3e 3e3e 2066 726f 6d20  -----..>>> from 
-00013b90: 7761 7465 782e 6461 7461 7365 7473 2069  watex.datasets i
-00013ba0: 6d70 6f72 7420 6c6f 6164 5f68 6c6f 6773  mport load_hlogs
-00013bb0: 0d0a 3e3e 3e20 6672 6f6d 2077 6174 6578  ..>>> from watex
-00013bc0: 2e75 7469 6c73 2e68 7964 726f 7574 696c  .utils.hydroutil
-00013bd0: 7320 696d 706f 7274 2072 6564 7563 655f  s import reduce_
-00013be0: 7361 6d70 6c65 7320 0d0a 3e3e 3e20 6461  samples ..>>> da
-00013bf0: 7461 203d 206c 6f61 645f 686c 6f67 7320  ta = load_hlogs 
-00013c00: 2829 2e66 7261 6d65 2023 2067 6574 2074  ().frame # get t
-00013c10: 6865 2066 7261 6d65 7320 0d0a 3e3e 3e20  he frames ..>>> 
-00013c20: 2320 6164 6420 6578 706c 6963 6974 6c79  # add explicitly
-00013c30: 2074 6865 2061 7175 6966 6572 2073 6563   the aquifer sec
-00013c40: 7469 6f6e 2069 6e64 6963 6573 200d 0a3e  tion indices ..>
-00013c50: 3e3e 2064 666e 6577 3d20 7265 6475 6365  >> dfnew= reduce
-00013c60: 5f73 616d 706c 6573 2028 6461 7461 2e63  _samples (data.c
-00013c70: 6f70 7928 292c 2073 6e61 6d65 3d27 7374  opy(), sname='st
-00013c80: 7261 7461 5f6e 616d 6527 2c20 0d0a 2020  rata_name', ..  
-00013c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ca0: 2020 2020 2020 2020 2020 2073 6563 7469             secti
-00013cb0: 6f6e 5f69 6e64 6578 6573 203d 2028 3136  on_indexes = (16
-00013cc0: 2c20 3239 2029 2c29 0d0a 3e3e 3e20 6466  , 29 ),)..>>> df
-00013cd0: 6e65 775b 305d 0d0a 2e2e 2e20 2020 2068  new[0].....    h
-00013ce0: 6f6c 655f 6e75 6d62 6572 2020 2020 2020  ole_number      
-00013cf0: 2020 2020 2020 2020 2073 7472 6174 615f           strata_
-00013d00: 6e61 6d65 2020 2020 2072 6f63 6b5f 6e61  name     rock_na
-00013d10: 6d65 2020 2e2e 2e20 2020 2020 2072 2020  me  ...      r  
-00013d20: 2020 2072 7020 2072 656d 6172 6b0d 0a20     rp  remark.. 
-00013d30: 2020 2030 2020 2020 2020 2020 2048 3530     0         H50
-00013d40: 3220 2020 2020 2020 2020 2020 2020 2020  2               
-00013d50: 2020 206d 7564 7374 6f6e 6520 2020 2020     mudstone     
-00013d60: 2020 2020 2020 4a32 7a20 202e 2e2e 2020        J2z  ...  
-00013d70: 2020 4e61 4e20 2020 204e 614e 2020 2020    NaN    NaN    
-00013d80: 204e 614e 0d0a 2020 2020 3136 2020 2020   NaN..    16    
-00013d90: 2020 2020 4835 3032 2020 2020 2020 2020      H502        
-00013da0: 2020 2020 2020 2020 2073 696c 7473 746f           siltsto
-00013db0: 6e65 2020 2020 2020 2020 2020 204e 614e  ne           NaN
-00013dc0: 2020 2e2e 2e20 2033 352e 3734 2020 3539    ...  35.74  59
-00013dd0: 2e32 3320 2020 2020 4e61 4e0d 0a20 2020  .23     NaN..   
-00013de0: 2031 3720 2020 2020 2020 2048 3530 3220   17        H502 
-00013df0: 2020 2066 696e 652d 6772 6169 6e65 6420     fine-grained 
-00013e00: 7361 6e64 7374 6f6e 6520 2020 2020 2020  sandstone       
-00013e10: 2020 2020 4e61 4e20 202e 2e2e 2020 3335      NaN  ...  35
-00013e20: 2e37 3420 2035 392e 3233 2020 2020 204e  .74  59.23     N
-00013e30: 614e 0d0a 2020 2020 3138 2020 2020 2020  aN..    18      
-00013e40: 2020 4835 3032 2020 2020 2020 2020 2020    H502          
-00013e50: 2020 2020 2020 2073 696c 7473 746f 6e65         siltstone
-00013e60: 2020 2020 2020 2020 2020 204e 614e 2020             NaN  
-00013e70: 2e2e 2e20 2033 352e 3734 2020 3539 2e32  ...  35.74  59.2
-00013e80: 3320 2020 2020 4e61 4e0d 0a20 2020 2031  3     NaN..    1
-00013e90: 3920 2020 2020 2020 2048 3530 3220 2020  9        H502   
-00013ea0: 2066 696e 652d 6772 6169 6e65 6420 7361   fine-grained sa
-00013eb0: 6e64 7374 6f6e 6520 2020 2020 2020 2020  ndstone         
-00013ec0: 2020 4e61 4e20 202e 2e2e 2020 3335 2e37    NaN  ...  35.7
-00013ed0: 3420 2035 392e 3233 2020 2020 204e 614e  4  59.23     NaN
-00013ee0: 0d0a 2020 2020 3230 2020 2020 2020 2020  ..    20        
-00013ef0: 4835 3032 2020 2020 2020 2020 2020 2020  H502            
-00013f00: 2020 2020 2020 6d75 6473 746f 6e65 2020        mudstone  
-00013f10: 2020 2020 2020 2020 204e 614e 2020 2e2e           NaN  ..
-00013f20: 2e20 2033 352e 3734 2020 3539 2e32 3320  .  35.74  59.23 
-00013f30: 2020 2020 4e61 4e0d 0a20 2020 2032 3120      NaN..    21 
-00013f40: 2020 2020 2020 2048 3530 3220 2020 2020         H502     
-00013f50: 2020 2020 2020 2020 2020 2020 7369 6c74              silt
-00013f60: 7374 6f6e 6520 2020 2020 2020 2020 2020  stone           
-00013f70: 4e61 4e20 202e 2e2e 2020 3335 2e37 3420  NaN  ...  35.74 
-00013f80: 2035 392e 3233 2020 2020 204e 614e 0d0a   59.23     NaN..
-00013f90: 2020 2020 3232 2020 2020 2020 2020 4835      22        H5
-00013fa0: 3032 2020 2020 6669 6e65 2d67 7261 696e  02    fine-grain
-00013fb0: 6564 2073 616e 6473 746f 6e65 2020 2020  ed sandstone    
-00013fc0: 2020 2020 2020 204e 614e 2020 2e2e 2e20         NaN  ... 
-00013fd0: 2035 392e 3631 2020 3539 2e32 3320 2020   59.61  59.23   
-00013fe0: 2020 4e61 4e0d 0a20 2020 2032 3320 2020    NaN..    23   
-00013ff0: 2020 2020 2048 3530 3220 2020 2020 2020       H502       
-00014000: 2020 2020 2020 2020 2020 7369 6c74 7374            siltst
-00014010: 6f6e 6520 2020 2020 2020 2020 2020 4e61  one           Na
-00014020: 4e20 202e 2e2e 2020 3539 2e36 3120 2035  N  ...  59.61  5
-00014030: 392e 3233 2020 2020 204e 614e 0d0a 2020  9.23     NaN..  
-00014040: 2020 3234 2020 2020 2020 2020 4835 3032    24        H502
-00014050: 2020 2020 6669 6e65 2d67 7261 696e 6564      fine-grained
-00014060: 2073 616e 6473 746f 6e65 2020 2020 2020   sandstone      
-00014070: 2020 2020 204e 614e 2020 2e2e 2e20 2035       NaN  ...  5
-00014080: 392e 3631 2020 3539 2e32 3320 2020 2020  9.61  59.23     
-00014090: 4e61 4e0d 0a20 2020 2032 3520 2020 2020  NaN..    25     
-000140a0: 2020 2048 3530 3220 2043 6f61 7273 652d     H502  Coarse-
-000140b0: 6772 6169 6e65 6420 7361 6e64 7374 6f6e  grained sandston
-000140c0: 6520 2020 2020 2020 2020 2020 4e61 4e20  e           NaN 
-000140d0: 202e 2e2e 2020 3539 2e36 3120 2035 392e   ...  59.61  59.
-000140e0: 3233 2020 2020 204e 614e 0d0a 2020 2020  23     NaN..    
-000140f0: 3236 2020 2020 2020 2020 4835 3032 2020  26        H502  
-00014100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014110: 6d75 6473 746f 6e65 2020 2020 2020 2020  mudstone        
-00014120: 2020 204e 614e 2020 2e2e 2e20 2038 322e     NaN  ...  82.
-00014130: 3333 2020 3539 2e32 3320 2020 2020 4e61  33  59.23     Na
-00014140: 4e0d 0a20 2020 2032 3720 2020 2020 2020  N..    27       
-00014150: 2048 3530 3220 2020 2066 696e 652d 6772   H502    fine-gr
-00014160: 6169 6e65 6420 7361 6e64 7374 6f6e 6520  ained sandstone 
-00014170: 2020 2020 2020 2020 2020 4e61 4e20 202e            NaN  .
-00014180: 2e2e 2020 3832 2e33 3320 2035 392e 3233  ..  82.33  59.23
-00014190: 2020 2020 204e 614e 0d0a 2020 2020 3238       NaN..    28
-000141a0: 2020 2020 2020 2020 4835 3032 2020 436f          H502  Co
-000141b0: 6172 7365 2d67 7261 696e 6564 2073 616e  arse-grained san
-000141c0: 6473 746f 6e65 2020 2020 2020 2020 2020  dstone          
-000141d0: 204a 327a 2020 2e2e 2e20 2038 322e 3333   J2z  ...  82.33
-000141e0: 2020 3539 2e32 3320 2020 2020 4e61 4e0d    59.23     NaN.
-000141f0: 0a20 2020 2032 3920 2020 2020 2020 2048  .    29        H
-00014200: 3530 3220 2020 2020 2020 2020 2020 2020  502             
-00014210: 2020 2020 2020 2020 2063 6f61 6c20 2028           coal  (
-00014220: 4a32 7929 2020 3263 6f61 6c20 202e 2e2e  J2y)  2coal  ...
-00014230: 2020 3832 2e33 3320 2035 392e 3233 2020    82.33  59.23  
-00014240: 2020 204e 614e 0d0a 2020 2020 3020 2020     NaN..    0   
-00014250: 2020 2020 2020 4835 3032 2020 2020 2020        H502      
-00014260: 2020 2020 2020 2020 2020 2073 696c 7473             silts
-00014270: 746f 6e65 2020 2020 2020 2020 2020 204e  tone           N
-00014280: 614e 2020 2e2e 2e20 2020 204e 614e 2020  aN  ...    NaN  
-00014290: 2020 4e61 4e20 2020 2020 4e61 4e0d 0a0d    NaN     NaN...
-000142a0: 0a5b 3136 2072 6f77 7320 7820 3233 2063  .[16 rows x 23 c
-000142b0: 6f6c 756d 6e73 5d0d 0a3e 3e3e 2023 2073  olumns]..>>> # s
-000142c0: 7065 6369 6679 2074 6865 2063 6f6c 756d  pecify the colum
-000142d0: 6e20 6e61 6d65 2061 6e64 206b 6e61 6d65  n name and kname
-000142e0: 2077 6974 686f 7574 2073 6563 7469 6f6e   without section
-000142f0: 2069 6e64 6578 6573 200d 0a3e 3e3e 2064   indexes ..>>> d
-00014300: 666e 6577 3d20 7265 6475 6365 5f73 616d  fnew= reduce_sam
-00014310: 706c 6573 2028 0d0a 2020 2020 6461 7461  ples (..    data
-00014320: 2e63 6f70 7928 292c 2073 6e61 6d65 3d27  .copy(), sname='
-00014330: 7374 7261 7461 5f6e 616d 6527 2c20 6461  strata_name', da
-00014340: 7461 2c20 7a6e 616d 653d 2764 6570 7468  ta, zname='depth
-00014350: 272c 206b 6e61 6d65 3d27 6b27 2c20 0d0a  ', kname='k', ..
-00014360: 2020 2020 6967 6e6f 7265 5f69 6e64 6578      ignore_index
-00014370: 3d20 5472 7565 2029 5b30 5d0d 0a2e 2e2e  = True )[0].....
-00014380: 2064 666e 6577 5b30 5d2e 696e 6465 7820   dfnew[0].index 
-00014390: 2320 696e 6465 7820 6973 2072 6573 6574  # index is reset
-000143a0: 200d 0a2e 2e2e 2052 616e 6765 496e 6465   ..... RangeInde
-000143b0: 7828 7374 6172 743d 302c 2073 746f 703d  x(start=0, stop=
-000143c0: 3136 2c20 7374 6570 3d31 290d 0a0d 0a22  16, step=1)...."
-000143d0: 2222 2e66 6f72 6d61 7428 0d0a 2020 2020  "".format(..    
-000143e0: 7061 7261 6d73 3d5f 7061 7261 6d5f 646f  params=_param_do
-000143f0: 6373 2c0d 0a20 2020 2029 0d0a 2020 2020  cs,..    )..    
-00014400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014410: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-00014420: 6465 6620 5f63 6f6e 6361 745f 636f 6d70  def _concat_comp
-00014430: 7265 7373 6564 5f78 735f 7872 2028 0d0a  ressed_xs_xr (..
-00014440: 2020 2020 2020 2020 7873 5f69 6e64 6578          xs_index
-00014450: 6573 3a4c 6973 745b 696e 745d 2c20 0d0a  es:List[int], ..
-00014460: 2020 2020 2020 2020 7872 5f69 6e64 6578          xr_index
-00014470: 6573 3a20 4c69 7374 5b69 6e74 5d2c 200d  es: List[int], .
-00014480: 0a20 2020 2020 2020 2063 6f6d 7072 6573  .        compres
-00014490: 7365 645f 6672 616d 6573 3a4c 6973 745b  sed_frames:List[
-000144a0: 4461 7461 4672 616d 655d 2c20 0d0a 2020  DataFrame], ..  
-000144b0: 2020 2020 2020 7872 3a44 6174 6146 7261        xr:DataFra
-000144c0: 6d65 2020 293a 0d0a 2020 2020 2222 2220  me  ):..    """ 
-000144d0: 436f 6e63 6174 2074 6865 2063 6f6d 7072  Concat the compr
-000144e0: 6573 7365 6420 6672 616d 6573 2066 726f  essed frames fro
-000144f0: 6d20 6078 7360 2077 6974 6820 7468 6520  m `xs` with the 
-00014500: 7661 6c69 6420 6672 616d 6573 2e0d 0a20  valid frames... 
-00014510: 2020 200d 0a20 2020 2055 7365 2074 6865     ..    Use the
-00014520: 2069 6e64 6578 206f 6620 6469 6666 6572   index of differ
-00014530: 656e 7420 6672 616d 6573 2074 6f20 6d65  ent frames to me
-00014540: 7267 6520 7468 6520 6672 616d 6520 6279  rge the frame by
-00014550: 2072 6573 7065 6374 696e 6720 7468 6520   respecting the 
-00014560: 0d0a 2020 2020 6465 7074 6820 706f 7369  ..    depth posi
-00014570: 7469 6f6e 732e 2046 6f72 2069 6e73 7461  tions. For insta
-00014580: 6e63 652c 2069 6620 7468 6520 7661 6c69  nce, if the vali
-00014590: 6420 7365 6369 6f6e 206f 6620 6171 7569  d secion of aqui
-000145a0: 6665 7220 6973 2066 7261 6d65 6420 0d0a  fer is framed ..
-000145b0: 2020 2020 6265 7477 6565 6e20 7477 6f20      between two 
-000145c0: 696e 7661 6c69 6420 7365 6374 696f 6e73  invalid sections
-000145d0: 2063 6f6d 706f 7365 6420 6f66 206d 6973   composed of mis
-000145e0: 7369 6e67 2027 6b27 2076 616c 7565 732c  sing 'k' values,
-000145f0: 2074 6865 2062 6f74 680d 0a20 2020 2073   the both..    s
-00014600: 6563 7469 6f6e 7320 6172 6520 7368 7261  ections are shra
-00014610: 6e6b 2061 6e64 2074 6865 6972 2063 6f6d  nk and their com
-00014620: 7072 6573 7365 6420 6672 616d 6573 2061  pressed frames a
-00014630: 7265 2061 6c73 6f20 6672 616d 6564 2074  re also framed t
-00014640: 6865 200d 0a20 2020 2073 6563 7469 6f6e  he ..    section
-00014650: 206f 6620 7661 6c69 6420 6461 7461 2e20   of valid data. 
-00014660: 5468 6973 206b 6565 7020 7468 6520 706f  This keep the po
-00014670: 7369 7469 6f6e 206f 6620 7468 6520 0d0a  sition of the ..
-00014680: 2020 2020 6171 7569 6665 7220 696e 7461      aquifer inta
-00014690: 6374 2e20 5468 6973 2069 7320 7573 6566  ct. This is usef
-000146a0: 756c 6c20 666f 7220 7072 6564 6963 7469  ull for predicti
-000146b0: 6f6e 2070 7572 706f 7365 2e20 0d0a 2020  on purpose. ..  
-000146c0: 2020 0d0a 2020 2020 3a70 6172 616d 2078    ..    :param x
-000146d0: 735f 696e 6465 7865 733a 206c 6973 7420  s_indexes: list 
-000146e0: 6f66 2069 6e74 200d 0a20 2020 2020 2020  of int ..       
-000146f0: 2069 6e64 6963 6573 206f 6620 696e 7661   indices of inva
-00014700: 6c69 6420 7365 6374 696f 6e73 200d 0a20  lid sections .. 
-00014710: 2020 203a 7061 7261 6d20 7872 5f69 6e64     :param xr_ind
-00014720: 6578 6573 3a20 6c69 7374 206f 6620 696e  exes: list of in
-00014730: 7420 2c0d 0a20 2020 2020 2020 2069 6e64  t ,..        ind
-00014740: 6963 6573 206f 6620 7661 6c69 6420 7365  ices of valid se
-00014750: 6374 696f 6e20 6f66 2061 7175 6966 6572  ction of aquifer
-00014760: 2e20 7661 6c69 6420 6461 7461 200d 0a20  . valid data .. 
-00014770: 2020 203a 7061 7261 6d20 636f 6d70 7265     :param compre
-00014780: 7373 6564 5f66 7261 6d65 733a 2070 616e  ssed_frames: pan
-00014790: 6461 7320 6461 7461 6672 616d 6520 0d0a  das dataframe ..
-000147a0: 2020 2020 2020 2020 7468 6520 636f 6d70          the comp
-000147b0: 7265 7373 6564 2066 7261 6d65 7320 6672  ressed frames fr
-000147c0: 6f6d 2060 7873 602e 200d 0a20 2020 203a  om `xs`. ..    :
-000147d0: 7061 7261 6d20 7872 3a20 6461 7461 6672  param xr: datafr
-000147e0: 616d 6520 0d0a 2020 2020 2020 2020 7661  ame ..        va
-000147f0: 6c69 6420 6461 7461 2028 2063 6f6e 7461  lid data ( conta
-00014800: 696e 2074 6865 2061 7175 6966 6572 2073  in the aquifer s
-00014810: 6563 7469 6f6e 7320 290d 0a20 2020 2022  ections )..    "
-00014820: 2222 0d0a 2020 2020 706f 7320 3d20 5b20  ""..    pos = [ 
-00014830: 6e70 2e61 7272 6179 286b 292e 6d65 616e  np.array(k).mean
-00014840: 2829 2066 6f72 206b 2069 6e20 7873 5f69  () for k in xs_i
-00014850: 6e64 6578 6573 205d 0d0a 2020 2020 6469  ndexes ]..    di
-00014860: 6373 203d 2064 6963 7420 2820 7a69 7020  cs = dict ( zip 
-00014870: 2820 706f 7320 2c20 636f 6d70 7265 7373  ( pos , compress
-00014880: 6564 5f66 7261 6d65 7329 290d 0a20 2020  ed_frames))..   
-00014890: 200d 0a20 2020 2064 6963 7320 5b6e 702e   ..    dics [np.
-000148a0: 6172 7261 7928 7872 5f69 6e64 6578 6573  array(xr_indexes
-000148b0: 292e 6d65 616e 2829 5d3d 2078 7220 0d0a  ).mean()]= xr ..
-000148c0: 2020 2020 2320 736f 7274 6564 2073 7472      # sorted str
-000148d0: 6174 6120 696e 2061 7363 656e 6469 6e67  ata in ascending
-000148e0: 206f 6363 7572 656e 6365 200d 0a20 2020   occurence ..   
-000148f0: 2073 6d20 3d20 6469 6374 2028 0d0a 2020   sm = dict (..  
-00014900: 2020 2020 2020 736f 7274 6564 2028 6469        sorted (di
-00014910: 6373 2e69 7465 6d73 2028 2920 2c20 6b65  cs.items () , ke
-00014920: 793d 206c 616d 6264 6120 783a 785b 305d  y= lambda x:x[0]
-00014930: 290d 0a20 2020 2020 2020 2029 0d0a 2020  )..        )..  
-00014940: 2020 633d 206c 6973 7428 736d 2e76 616c    c= list(sm.val
-00014950: 7565 7320 2829 290d 0a20 2020 2072 6574  ues ())..    ret
-00014960: 7572 6e20 2070 642e 636f 6e63 6174 2028  urn  pd.concat (
-00014970: 6320 290d 0a0d 0a20 2020 200d 0a64 6566  c )....    ..def
-00014980: 2069 735f 7661 6c69 645f 6465 7074 6820   is_valid_depth 
-00014990: 287a 2c20 2f2c 207a 6e61 6d65 203d 4e6f  (z, /, zname =No
-000149a0: 6e65 202c 2072 6574 7572 6e5f 7a20 3d20  ne , return_z = 
-000149b0: 4661 6c73 6529 3a20 0d0a 2020 2020 2222  False): ..    ""
-000149c0: 2220 4173 7365 7274 2077 6865 7468 6572  " Assert whether
-000149d0: 2064 6570 7468 2069 7320 7661 6c69 6420   depth is valid 
-000149e0: 696e 2064 6174 6166 7261 6d65 206f 6620  in dataframe of 
-000149f0: 7477 6f2d 6469 6d65 6e73 696f 6e61 6c20  two-dimensional 
-00014a00: 0d0a 2020 2020 6172 7261 7920 7061 7373  ..    array pass
-00014a10: 6564 2074 6f20 607a 6020 6172 6775 6d65  ed to `z` argume
-00014a20: 6e74 2e20 0d0a 2020 2020 0d0a 2020 2020  nt. ..    ..    
-00014a30: 5061 7261 6d65 7465 7273 200d 0a20 2020  Parameters ..   
-00014a40: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20   ------------.. 
-00014a50: 2020 207a 3a20 6e64 6172 7261 792c 2070     z: ndarray, p
-00014a60: 616e 6461 7320 7365 7269 6573 206f 7220  andas series or 
-00014a70: 6461 7461 6672 616d 6520 0d0a 2020 2020  dataframe ..    
-00014a80: 2020 2020 4966 2044 6174 6166 7261 6d65      If Dataframe
-00014a90: 2069 7320 6769 7665 6e2c 2027 7a6e 616d   is given, 'znam
-00014aa0: 6527 206d 7573 7420 6265 2073 7570 706c  e' must be suppl
-00014ab0: 6965 6420 746f 2066 6574 6368 206f 7220  ied to fetch or 
-00014ac0: 6173 7365 7274 200d 0a20 2020 2020 2020  assert ..       
-00014ad0: 2074 6865 2064 6570 7468 2065 7869 7374   the depth exist
-00014ae0: 656e 6365 206f 6620 7468 6520 6465 7074  ence of the dept
-00014af0: 6820 696e 2060 7a60 2e20 0d0a 2020 2020  h in `z`. ..    
-00014b00: 7a6e 616d 653a 2073 7472 2c69 6e74 202c  zname: str,int ,
-00014b10: 200d 0a20 2020 2020 2020 2074 6865 206e   ..        the n
-00014b20: 616d 6520 6f66 2064 6570 7468 2063 6f6c  ame of depth col
-00014b30: 756d 6e2e 2027 6e61 6d65 2720 6e65 6564  umn. 'name' need
-00014b40: 7320 746f 2062 6520 7375 7070 6c69 6564  s to be supplied
-00014b50: 2077 6865 6e20 607a 6020 6973 200d 0a20   when `z` is .. 
-00014b60: 2020 2020 2020 2067 6976 656e 2077 6865         given whe
-00014b70: 7265 6173 2069 6e64 6578 2069 7320 6e65  reas index is ne
-00014b80: 6564 6564 2077 6865 6e20 607a 6020 6973  eded when `z` is
-00014b90: 2061 6e20 6e64 6172 7261 7920 7769 7468   an ndarray with
-00014ba0: 2074 776f 200d 0a20 2020 2020 2020 2064   two ..        d
-00014bb0: 696d 656e 7369 6f6e 616c 2e20 0d0a 2020  imensional. ..  
-00014bc0: 2020 2020 2020 0d0a 2020 2020 7265 7475        ..    retu
-00014bd0: 726e 5f58 5f7a 3a20 626f 6f6c 2c20 6465  rn_X_z: bool, de
-00014be0: 6661 756c 7420 3d46 616c 7365 0d0a 2020  fault =False..  
-00014bf0: 2020 2020 2020 7265 7475 726e 7320 7a20        returns z 
-00014c00: 7365 7269 6573 206f 7220 6172 7261 7920  series or array 
-00014c10: 2069 6620 7365 7420 746f 2060 6054 7275   if set to ``Tru
-00014c20: 6560 602e 200d 0a20 2020 200d 0a20 2020  e``. ..    ..   
-00014c30: 2052 6574 7572 6e73 200d 0a20 2020 202d   Returns ..    -
-00014c40: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 7a30  --------..    z0
-00014c50: 2c20 6973 5f7a 3a20 6172 7261 7920 2f62  , is_z: array /b
-00014c60: 6f6f 6c2c 200d 0a20 2020 2020 2020 2041  ool, ..        A
-00014c70: 6e20 6172 7261 792d 6c69 6b65 2031 6420  n array-like 1d 
-00014c80: 6f66 2060 7a60 206f 7220 2754 7275 652f  of `z` or 'True/
-00014c90: 4661 6c73 6527 2077 6865 7468 6572 207a  False' whether z
-00014ca0: 2065 7869 7374 7320 6f72 206e 6f74 2e20   exists or not. 
-00014cb0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00014cc0: 4578 616d 706c 6520 0d0a 2020 2020 2d2d  Example ..    --
-00014cd0: 2d2d 2d2d 2d2d 0d0a 2020 2020 3e3e 3e20  ------..    >>> 
-00014ce0: 6672 6f6d 2077 6174 6578 2e64 6174 6173  from watex.datas
-00014cf0: 6574 7320 696d 706f 7274 206c 6f61 645f  ets import load_
-00014d00: 686c 6f67 7320 0d0a 2020 2020 3e3e 3e20  hlogs ..    >>> 
-00014d10: 6672 6f6d 2077 6174 6578 2e75 7469 6c73  from watex.utils
-00014d20: 2e68 7964 726f 7574 696c 7320 696d 706f  .hydroutils impo
-00014d30: 7274 2069 735f 7661 6c69 645f 6465 7074  rt is_valid_dept
-00014d40: 6820 0d0a 2020 2020 3e3e 3e20 643d 206c  h ..    >>> d= l
-00014d50: 6f61 645f 686c 6f67 7320 2829 200d 0a20  oad_hlogs () .. 
-00014d60: 2020 203e 3e3e 2058 3d20 642e 6672 616d     >>> X= d.fram
-00014d70: 6520 0d0a 2020 2020 3e3e 3e20 6973 5f76  e ..    >>> is_v
-00014d80: 616c 6964 5f64 6570 7468 2858 2c20 7a6e  alid_depth(X, zn
-00014d90: 616d 653d 2764 6570 7468 2729 2023 2069  ame='depth') # i
-00014da0: 7320 6461 7461 6672 616d 6520 2c20 6e65  s dataframe , ne
-00014db0: 6564 2074 6f20 7061 7373 2027 7a6e 616d  ed to pass 'znam
-00014dc0: 6527 0d0a 2020 2020 2e2e 2e20 5472 7565  e'..    ... True
-00014dd0: 0d0a 2020 2020 3e3e 3e20 6973 5f76 616c  ..    >>> is_val
-00014de0: 6964 5f64 6570 7468 2028 582c 207a 6e61  id_depth (X, zna
-00014df0: 6d65 203d 2027 6465 7074 6827 2c20 7265  me = 'depth', re
-00014e00: 7475 726e 5f7a 203d 2054 7275 6529 0d0a  turn_z = True)..
-00014e10: 2020 2020 2e2e 2e20 3020 2020 2020 2020      ... 0       
-00014e20: 2030 2e30 300d 0a20 2020 2020 2020 2031   0.00..        1
-00014e30: 2020 2020 2020 2020 322e 3330 0d0a 2020          2.30..  
-00014e40: 2020 2020 2020 3220 2020 2020 2020 2038        2        8
-00014e50: 2e32 340d 0a20 2020 2020 2020 2033 2020  .24..        3  
-00014e60: 2020 2020 2032 322e 3436 0d0a 2020 2020       22.46..    
-00014e70: 2020 2020 3420 2020 2020 2020 3434 2e37      4       44.7
-00014e80: 360d 0a20 2020 2020 2020 2020 0d0a 2020  6..         ..  
-00014e90: 2020 2020 2020 3137 3620 2020 2036 3734        176    674
-00014ea0: 2e30 320d 0a20 2020 2020 2020 2031 3737  .02..        177
-00014eb0: 2020 2020 3638 302e 3138 0d0a 2020 2020      680.18..    
-00014ec0: 2020 2020 3137 3820 2020 2036 3831 2e36      178    681.6
-00014ed0: 380d 0a20 2020 2020 2020 2031 3739 2020  8..        179  
-00014ee0: 2020 3639 322e 3937 0d0a 2020 2020 2020    692.97..      
-00014ef0: 2020 3138 3020 2020 2036 3933 2e33 370d    180    693.37.
-00014f00: 0a20 2020 2020 2020 204e 616d 653a 2064  .        Name: d
-00014f10: 6570 7468 5f74 6f70 2c20 4c65 6e67 7468  epth_top, Length
-00014f20: 3a20 3138 312c 2064 7479 7065 3a20 666c  : 181, dtype: fl
-00014f30: 6f61 7436 340d 0a20 2020 2022 2222 0d0a  oat64..    """..
-00014f40: 2020 2020 6973 5f7a 203d 5472 7565 200d      is_z =True .
-00014f50: 0a20 2020 207a 203d 205f 6173 7365 7274  .    z = _assert
-00014f60: 5f61 6c6c 5f74 7970 6573 287a 2c20 6e70  _all_types(z, np
-00014f70: 2e6e 6461 7272 6179 202c 2070 642e 5365  .ndarray , pd.Se
-00014f80: 7269 6573 2c20 7064 2e44 6174 6146 7261  ries, pd.DataFra
-00014f90: 6d65 2c20 0d0a 2020 2020 2020 2020 2020  me, ..          
-00014fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014fb0: 6f62 6a6e 616d 6520 3d27 4465 7074 6827  objname ='Depth'
-00014fc0: 2920 0d0a 2020 2020 7a6e 616d 6520 3d20  ) ..    zname = 
-00014fd0: 5f61 7373 6572 745f 616c 6c5f 7479 7065  _assert_all_type
-00014fe0: 7328 7a6e 616d 652c 2073 7472 2c20 6f62  s(zname, str, ob
-00014ff0: 6a6e 616d 6520 3d22 277a 6e61 6d65 220d  jname ="'zname".
-00015000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015010: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00015020: 2069 6620 7a6e 616d 6520 6973 206e 6f74   if zname is not
-00015030: 204e 6f6e 6520 656c 7365 204e 6f6e 6520   None else None 
-00015040: 200d 0a20 2020 2069 6620 6861 7361 7474   ..    if hasatt
-00015050: 7228 7a2c 2027 5f5f 6172 7261 795f 5f27  r(z, '__array__'
-00015060: 2920 616e 6420 6861 7361 7474 7220 287a  ) and hasattr (z
-00015070: 2c20 276e 616d 6527 293a 200d 0a20 2020  , 'name'): ..   
-00015080: 2020 2020 207a 6e61 6d65 203d 207a 2e6e       zname = z.n
-00015090: 616d 6520 0d0a 2020 2020 2020 2020 0d0a  ame ..        ..
-000150a0: 2020 2020 656c 6966 2068 6173 6174 7472      elif hasattr
-000150b0: 2028 7a20 2c27 636f 6c75 6d6e 7327 2029   (z ,'columns' )
-000150c0: 3a20 0d0a 2020 2020 2020 2020 2320 6173  : ..        # as
-000150d0: 7365 7274 2077 6865 7468 6572 2064 6570  sert whether dep
-000150e0: 7468 200d 0a20 2020 2020 2020 2023 206d  th ..        # m
-000150f0: 6170 6520 6120 636f 7079 2074 6f20 6e6f  ape a copy to no
-00015100: 7420 636f 7272 7570 7420 5820 7369 6e63  t corrupt X sinc
-00015110: 6520 7468 6520 6675 6e63 7469 6f6e 200d  e the function .
-00015120: 0a20 2020 2020 2020 2023 2072 656d 6f76  .        # remov
-00015130: 6520 7468 6520 6465 7074 6820 696e 2063  e the depth in c
-00015140: 6f6c 756d 6e73 200d 0a20 2020 2020 2020  olumns ..       
-00015150: 207a 5f63 6f70 7920 3d20 7a2e 636f 7079   z_copy = z.copy
-00015160: 2829 200d 0a20 2020 2020 2020 2069 6620  () ..        if 
-00015170: 7a6e 616d 6520 6973 204e 6f6e 653a 200d  zname is None: .
-00015180: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00015190: 7365 2056 616c 7565 4572 726f 7220 2822  se ValueError ("
-000151a0: 277a 6e61 6d65 2720 2820 4465 7074 6820  'zname' ( Depth 
-000151b0: 636f 6c75 6d6e 206e 616d 6520 2920 6361  column name ) ca
-000151c0: 6e20 6e6f 7420 6265 204e 6f6e 6522 0d0a  n not be None"..
-000151d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000151e0: 2020 2020 2020 2020 2020 2020 2020 2220                " 
-000151f0: 7768 656e 2061 2064 6174 6166 7261 6d65  when a dataframe
-00015200: 2069 7320 6769 7665 6e2e 2229 0d0a 2020   is given.")..  
-00015210: 2020 2020 2020 2320 2d2d 3e20 6465 616c        # --> deal
-00015220: 7320 7769 7468 2064 6570 7468 200d 0a20  s with depth .. 
-00015230: 2020 2020 2020 2023 2069 6e20 7468 6520         # in the 
-00015240: 6361 7365 2064 6570 7468 2069 7320 6769  case depth is gi
-00015250: 7665 6e20 7768 696c 6520 0d0a 2020 2020  ven while ..    
-00015260: 2020 2020 2320 6461 7461 6672 616d 6520      # dataframe 
-00015270: 6973 2067 6976 656e 2e20 0d0a 2020 2020  is given. ..    
-00015280: 2020 2020 2320 6966 207a 2069 7320 6e6f      # if z is no
-00015290: 7420 4e6f 6e65 3a20 0d0a 2020 2020 2020  t None: ..      
-000152a0: 2020 2320 2020 2020 7a6e 616d 6520 3d4e    #     zname =N
-000152b0: 6f6e 6520 2320 7365 7420 4e6f 6e65 200d  one # set None .
-000152c0: 0a20 2020 2020 2020 2069 6620 7a6e 616d  .        if znam
-000152d0: 6520 6973 206e 6f74 204e 6f6e 6520 3a20  e is not None : 
-000152e0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-000152f0: 6572 6173 6564 2074 6865 2064 6570 7468  erased the depth
-00015300: 2061 6e64 206e 616d 650d 0a20 2020 2020   and name..     
-00015310: 2020 2020 2020 2074 7279 3a20 0d0a 2020         try: ..  
-00015320: 2020 2020 2020 2020 2020 2020 2020 5f2c                _,
-00015330: 207a 3020 3d20 6973 5f64 6570 7468 5f69   z0 = is_depth_i
-00015340: 6e28 0d0a 2020 2020 2020 2020 2020 2020  n(..            
-00015350: 2020 2020 7a5f 636f 7079 2c20 6e61 6d65      z_copy, name
-00015360: 203d 207a 6e61 6d65 2c20 6572 726f 7220   = zname, error 
-00015370: 3d20 2772 6169 7365 2729 200d 0a20 2020  = 'raise') ..   
-00015380: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-00015390: 4578 6365 7074 696f 6e20 6173 2065 7272  Exception as err
-000153a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000153b0: 2020 2069 6620 7265 7475 726e 5f7a 3a20     if return_z: 
-000153c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000153d0: 2020 2020 2020 7261 6973 6520 4465 7074        raise Dept
-000153e0: 6845 7272 6f72 2822 4465 7074 6820 6e61  hError("Depth na
-000153f0: 6d65 2027 7a6e 616d 6527 2022 202b 2073  me 'zname' " + s
-00015400: 7472 280d 0a20 2020 2020 2020 2020 2020  tr(..           
-00015410: 2020 2020 2020 2020 2020 2020 2065 7272               err
-00015420: 292e 7265 706c 6163 6520 2827 4527 2c20  ).replace ('E', 
-00015430: 2765 2729 2029 0d0a 2020 2020 2020 2020  'e') )..        
-00015440: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00015450: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00015460: 7365 3a20 6973 5f7a 3d20 4661 6c73 6520  se: is_z= False 
-00015470: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00015480: 2020 200d 0a20 2020 2020 2020 207a 6e61     ..        zna
-00015490: 6d65 3d20 7a30 2e6e 616d 6520 0d0a 2020  me= z0.name ..  
-000154a0: 2020 656c 6966 2068 6173 6174 7472 2028    elif hasattr (
-000154b0: 7a2c 2027 5f5f 6172 7261 795f 5f27 293a  z, '__array__'):
-000154c0: 200d 0a20 2020 2020 2020 2069 6620 6e6f   ..        if no
-000154d0: 7420 5f69 735f 6172 7261 796c 696b 655f  t _is_arraylike_
-000154e0: 3164 2028 7a29 3a20 0d0a 2020 2020 2020  1d (z): ..      
-000154f0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00015500: 6545 7272 6f72 2028 224d 756c 7469 6469  eError ("Multidi
-00015510: 6d65 6e73 696f 6e61 6c20 276b 2720 6172  mensional 'k' ar
-00015520: 7261 7920 6973 206e 6f74 2061 6c6c 6f77  ray is not allow
-00015530: 6564 220d 0a20 2020 2020 2020 2020 2020  ed"..           
-00015540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015550: 2020 2022 2045 7870 6563 7420 6f6e 652d     " Expect one-
-00015560: 6469 6d65 6e73 696f 6e61 6c20 6172 7261  dimensional arra
-00015570: 792e 2229 0d0a 2020 2020 2020 2020 7a30  y.")..        z0
-00015580: 3d20 7064 2e53 6572 6965 7320 287a 2c20  = pd.Series (z, 
-00015590: 6e61 6d65 203d 7a6e 616d 6529 2069 6620  name =zname) if 
-000155a0: 7a6e 616d 6520 6973 206e 6f74 204e 6f6e  zname is not Non
-000155b0: 6520 656c 7365 207a 200d 0a0d 0a20 2020  e else z ....   
-000155c0: 2072 6574 7572 6e20 7a30 2069 6620 7265   return z0 if re
-000155d0: 7475 726e 5f7a 2065 6c73 6520 6973 5f7a  turn_z else is_z
-000155e0: 2020 0d0a 0d0a 6465 6620 6765 745f 6171    ....def get_aq
-000155f0: 7569 6665 725f 7365 6374 696f 6e20 280d  uifer_section (.
-00015600: 0a20 2020 2020 2020 2061 7272 5f6b 2c20  .        arr_k, 
-00015610: 2f2c 207a 6e61 6d65 3d4e 6f6e 652c 206b  /, zname=None, k
-00015620: 6e61 6d65 203d 204e 6f6e 652c 2020 7a3d  name = None,  z=
-00015630: 204e 6f6e 652c 200d 0a20 2020 2020 2020   None, ..       
-00015640: 2072 6574 7572 6e5f 696e 6465 7820 3d20   return_index = 
-00015650: 4661 6c73 652c 2072 6574 7572 6e5f 7365  False, return_se
-00015660: 6374 696f 6e73 203d 2054 7275 6520 0d0a  ctions = True ..
-00015670: 2020 2020 2020 2020 2920 3a20 0d0a 2020          ) : ..  
-00015680: 2020 5f61 7373 6572 745f 616c 6c5f 7479    _assert_all_ty
-00015690: 7065 7328 2061 7272 5f6b 2c20 7064 2e44  pes( arr_k, pd.D
-000156a0: 6174 6146 7261 6d65 2c20 6e70 2e6e 6461  ataFrame, np.nda
-000156b0: 7272 6179 290d 0a20 2020 200d 0a20 2020  rray)..    ..   
-000156c0: 2069 6620 7a20 6973 206e 6f74 204e 6f6e   if z is not Non
-000156d0: 653a 200d 0a20 2020 2020 2020 206d 7320  e: ..        ms 
-000156e0: 3d20 2866 2244 6570 7468 207b 7479 7065  = (f"Depth {type
-000156f0: 287a 292e 5f5f 6e61 6d65 5f5f 7d20 7369  (z).__name__} si
-00015700: 7a65 206d 7573 7420 6265 2063 6f6e 7369  ze must be consi
-00015710: 7374 656e 7420 7769 7468 220d 0a20 2020  stent with"..   
-00015720: 2020 2020 2020 2020 2020 6622 207b 7479            f" {ty
-00015730: 7065 2028 6172 725f 6b29 2e5f 5f6e 616d  pe (arr_k).__nam
-00015740: 655f 5f21 727d 3b67 6f74 207b 6c65 6e28  e__!r};got {len(
-00015750: 7a29 7d20 616e 6420 7b6c 656e 2861 7272  z)} and {len(arr
-00015760: 5f6b 297d 2e22 0d0a 2020 2020 2020 2020  _k)}."..        
-00015770: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
-00015780: 5f61 7373 6572 745f 616c 6c5f 7479 7065  _assert_all_type
-00015790: 7328 7a2c 206e 702e 6e64 6172 7261 792c  s(z, np.ndarray,
-000157a0: 2070 642e 5365 7269 6573 290d 0a20 2020   pd.Series)..   
-000157b0: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-000157c0: 6620 6e6f 7420 5f69 735f 6172 7261 796c  f not _is_arrayl
-000157d0: 696b 655f 3164 287a 293a 200d 0a20 2020  ike_1d(z): ..   
-000157e0: 2020 2020 2020 2020 2072 6169 7365 2044           raise D
-000157f0: 6570 7468 4572 726f 7220 2822 4465 7074  epthError ("Dept
-00015800: 6820 7375 7070 6f72 7473 206f 6e6c 7920  h supports only 
-00015810: 6f6e 652d 6469 6d65 6e73 696f 6e61 6c20  one-dimensional 
-00015820: 6172 7261 792c 220d 0a20 2020 2020 2020  array,"..       
-00015830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015840: 2020 2020 2020 6622 206e 6f74 207b 7479        f" not {ty
-00015850: 7065 287a 292e 5f5f 6e61 6d65 5f5f 2172  pe(z).__name__!r
-00015860: 7d2e 2229 0d0a 2020 2020 2020 2020 2020  }.")..          
-00015870: 2020 2320 6368 6563 6b20 6465 7074 6820    # check depth 
-00015880: 7a20 6172 7261 7920 0d0a 2020 2020 2020  z array ..      
-00015890: 2020 7a3d 2063 6865 636b 5f79 2028 0d0a    z= check_y (..
-000158a0: 2020 2020 2020 2020 2020 2020 7a2c 200d              z, .
-000158b0: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
-000158c0: 7574 5f6e 616d 653d 2022 4172 7261 7920  ut_name= "Array 
-000158d0: 6f66 2064 6570 7468 2027 7a27 222c 200d  of depth 'z'", .
-000158e0: 0a20 2020 2020 2020 2020 2020 2074 6f5f  .            to_
-000158f0: 6672 616d 6520 3d54 7275 652c 200d 0a20  frame =True, .. 
-00015900: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00015910: 2020 2020 2020 6966 206e 6f74 205f 6368        if not _ch
-00015920: 6563 6b5f 636f 6e73 6973 7465 6e63 795f  eck_consistency_
-00015930: 7369 7a65 287a 2c20 6172 725f 6b2c 2065  size(z, arr_k, e
-00015940: 7272 6f72 203d 2769 676e 6f72 6527 293a  rror ='ignore'):
-00015950: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-00015960: 6169 7365 2044 6570 7468 4572 726f 7220  aise DepthError 
-00015970: 286d 7329 0d0a 2020 2020 2020 2020 2020  (ms)..          
-00015980: 2020 2020 2020 0d0a 2020 2020 6966 2028        ..    if (
-00015990: 7a20 6973 204e 6f6e 6520 616e 6420 7a6e  z is None and zn
-000159a0: 616d 6520 6973 206e 6f74 204e 6f6e 6520  ame is not None 
-000159b0: 293a 200d 0a20 2020 2020 2020 207a 203d  ): ..        z =
-000159c0: 2069 735f 7661 6c69 645f 6465 7074 6820   is_valid_depth 
-000159d0: 2820 6172 725f 6b20 2c20 7a6e 616d 6520  ( arr_k , zname 
-000159e0: 3d20 7a6e 616d 6520 2c20 7265 7475 726e  = zname , return
-000159f0: 5f7a 203d 2054 7275 6520 290d 0a20 2020  _z = True )..   
-00015a00: 2020 2020 207a 6e61 6d65 203d 207a 2e6e       zname = z.n
-00015a10: 616d 6520 0d0a 2020 2020 2020 2020 0d0a  ame ..        ..
-00015a20: 2020 2020 656c 6966 2028 207a 2069 7320      elif ( z is 
-00015a30: 4e6f 6e65 2061 6e64 207a 6e61 6d65 2069  None and zname i
-00015a40: 7320 4e6f 6e65 2029 3a20 0d0a 2020 2020  s None ): ..    
-00015a50: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00015a60: 6545 7272 6f72 2028 2245 7870 6563 7473  eError ("Expects
-00015a70: 2061 6e20 6172 7261 7920 6f66 2064 6570   an array of dep
-00015a80: 7468 2027 7a27 206f 7220 2064 6570 7468  th 'z' or  depth
-00015a90: 2063 6f6c 756d 6e22 0d0a 2020 2020 2020   column"..      
-00015aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ab0: 2020 2020 2020 2220 6e61 6d65 2027 7a6e        " name 'zn
-00015ac0: 616d 6527 2069 6e20 7468 6520 6461 7461  ame' in the data
-00015ad0: 6672 616d 652e 2229 2020 2020 0d0a 2020  frame.")    ..  
-00015ae0: 2020 2020 2020 0d0a 2020 2020 6966 2068        ..    if h
-00015af0: 6173 6174 7472 2028 6172 725f 6b20 2c27  asattr (arr_k ,'
-00015b00: 636f 6c75 6d6e 7327 2029 3a0d 0a20 2020  columns' ):..   
-00015b10: 2020 2020 2023 2064 6561 6c20 7769 7468       # deal with
-00015b20: 2061 7272 5f6b 200d 0a20 2020 2020 2020   arr_k ..       
-00015b30: 2069 6620 6b6e 616d 6520 6973 204e 6f6e   if kname is Non
-00015b40: 653a 200d 0a20 2020 2020 2020 2020 2020  e: ..           
-00015b50: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00015b60: 7220 2822 276b 6e61 6d65 2720 2820 5065  r ("'kname' ( Pe
-00015b70: 726d 6561 6269 6c69 7479 2063 6f65 6666  rmeability coeff
-00015b80: 6963 6965 6e74 2029 2063 6f6c 756d 6e20  icient ) column 
-00015b90: 6e61 6d65 220d 0a20 2020 2020 2020 2020  name"..         
-00015ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015bb0: 2020 2020 2022 2063 616e 6e6f 7420 6265       " cannot be
-00015bc0: 204e 6f6e 6520 7768 656e 2061 2064 6174   None when a dat
-00015bd0: 6166 7261 6d65 2069 7320 6769 7665 6e2e  aframe is given.
-00015be0: 2229 200d 0a20 2020 2020 2020 2065 6c73  ") ..        els
-00015bf0: 653a 200d 0a20 2020 2020 2020 2020 2020  e: ..           
-00015c00: 205f 6173 7365 7274 5f61 6c6c 5f74 7970   _assert_all_typ
-00015c10: 6573 286b 6e61 6d65 2c20 7374 7220 2c20  es(kname, str , 
-00015c20: 696e 7420 2c20 666c 6f61 742c 2020 6f62  int , float,  ob
-00015c30: 6a6e 616d 653d 2227 6b6e 616d 6527 2229  jname="'kname'")
-00015c40: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
-00015c50: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00015c60: 7374 616e 6365 2028 6b6e 616d 6520 2c20  stance (kname , 
-00015c70: 2869 6e74 2c20 666c 6f61 7429 293a 200d  (int, float)): .
-00015c80: 0a20 2020 2020 2020 2020 2020 206b 6e61  .            kna
-00015c90: 6d65 203d 2069 6e74 2028 6b6e 616d 6529  me = int (kname)
-00015ca0: 200d 0a20 2020 2020 2020 2020 2020 2069   ..            i
-00015cb0: 6620 6b6e 616d 6520 3e20 6c65 6e28 6172  f kname > len(ar
-00015cc0: 725f 6b2e 636f 6c75 6d6e 7329 3a20 0d0a  r_k.columns): ..
-00015cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ce0: 7261 6973 6520 496e 6465 7845 7272 6f72  raise IndexError
-00015cf0: 2028 6622 276b 6e61 6d65 2720 6174 2069   (f"'kname' at i
-00015d00: 6e64 6578 207b 6b6e 616d 657d 2069 7320  ndex {kname} is 
-00015d10: 6f75 7420 6f66 2074 6865 2022 0d0a 2020  out of the "..  
-00015d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d40: 6622 6461 7461 6672 616d 6520 636f 6c75  f"dataframe colu
-00015d50: 6d6e 2073 697a 653d 7b6c 656e 2861 7272  mn size={len(arr
-00015d60: 5f6b 2e63 6f6c 756d 6e73 297d 2229 0d0a  _k.columns)}")..
-00015d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d80: 0d0a 2020 2020 2020 2020 2020 2020 6b6e  ..            kn
-00015d90: 616d 6520 3d20 6172 725f 6b2e 636f 6c75  ame = arr_k.colu
-00015da0: 6d6e 735b 6b6e 616d 655d 0d0a 2020 2020  mns[kname]..    
-00015db0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00015dc0: 2020 6966 206b 6e61 6d65 206e 6f74 2069    if kname not i
-00015dd0: 6e20 6172 725f 6b2e 636f 6c75 6d6e 733a  n arr_k.columns:
-00015de0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-00015df0: 6973 6520 5661 6c75 6545 7272 6f72 2028  ise ValueError (
-00015e00: 6622 276b 6e61 6d65 2720 7b6b 6e61 6d65  f"'kname' {kname
-00015e10: 2172 7d20 6e6f 7420 666f 756e 6420 696e  !r} not found in
-00015e20: 2064 6174 6166 7261 6d65 2e22 290d 0a20   dataframe.").. 
-00015e30: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00015e40: 2061 7272 5f6b 203d 2061 7272 5f6b 5b6b   arr_k = arr_k[k
-00015e50: 6e61 6d65 5d20 0d0a 2020 2020 2020 2020  name] ..        
-00015e60: 6172 725f 6b3d 2061 7272 5f6b 2e76 616c  arr_k= arr_k.val
-00015e70: 7565 7320 0d0a 2020 2020 2020 2020 0d0a  ues ..        ..
-00015e80: 2020 2020 656c 6966 2068 6173 6174 7472      elif hasattr
-00015e90: 2028 6172 725f 6b2c 2027 5f5f 6172 7261   (arr_k, '__arra
-00015ea0: 795f 5f27 293a 200d 0a20 2020 2020 2020  y__'): ..       
-00015eb0: 2069 6620 6e6f 7420 5f69 735f 6172 7261   if not _is_arra
-00015ec0: 796c 696b 655f 3164 2028 6172 725f 6b29  ylike_1d (arr_k)
-00015ed0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00015ee0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00015ef0: 2028 224d 756c 7469 6469 6d65 6e73 696f   ("Multidimensio
-00015f00: 6e61 6c20 276b 2720 6172 7261 7920 6973  nal 'k' array is
-00015f10: 206e 6f74 2061 6c6c 6f77 6564 220d 0a20   not allowed".. 
-00015f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f30: 2020 2020 2020 2020 2020 2020 2022 2045               " E
-00015f40: 7870 6563 7420 6f6e 652d 6469 6d65 6e73  xpect one-dimens
-00015f50: 696f 6e61 6c20 6172 7261 792e 2229 0d0a  ional array.")..
-00015f60: 0d0a 2020 2020 2320 666f 7220 636f 6e73  ..    # for cons
-00015f70: 6973 7465 6e63 792c 2073 6574 2061 6c6c  istency, set all
-00015f80: 2074 6f20 3164 2061 7272 6179 200d 0a20   to 1d array .. 
-00015f90: 2020 207a 203d 2072 6573 6861 7065 2028     z = reshape (
-00015fa0: 7a29 203b 2061 7272 5f6b 203d 2072 6573  z) ; arr_k = res
-00015fb0: 6861 7065 2028 6172 725f 6b29 0d0a 0d0a  hape (arr_k)....
-00015fc0: 2020 2020 696e 6465 7865 732c 2020 3d20      indexes,  = 
-00015fd0: 6e70 2e77 6865 7265 2028 7e6e 702e 6973  np.where (~np.is
-00015fe0: 6e61 6e20 2861 7272 5f6b 2929 200d 0a20  nan (arr_k)) .. 
-00015ff0: 2020 2069 6620 6861 7361 7474 7220 2869     if hasattr (i
-00016000: 6e64 6578 6573 2c20 275f 5f6c 656e 5f5f  ndexes, '__len__
-00016010: 2729 3a20 0d0a 2020 2020 2020 2020 2320  '): ..        # 
-00016020: 2b31 2066 6f72 2050 7974 686f 6e20 696e  +1 for Python in
-00016030: 6465 7869 6e67 0d0a 2020 2020 2020 2020  dexing..        
-00016040: 696e 6465 7865 7320 3d5b 2069 6e64 6578  indexes =[ index
-00016050: 6573 205b 3020 5d20 2c20 696e 6465 7865  es [0 ] , indexe
-00016060: 7320 5b2d 315d 5d20 0d0a 2020 2020 2020  s [-1]] ..      
-00016070: 2020 0d0a 2020 2020 7365 6374 696f 6e73    ..    sections
-00016080: 203d 207a 5b69 6e64 6578 6573 205d 0d0a   = z[indexes ]..
-00016090: 2020 2020 0d0a 2020 2020 7265 7475 726e      ..    return
-000160a0: 2028 205b 2a20 696e 6465 7865 7320 5d2c   ( [* indexes ],
-000160b0: 205b 2a20 7365 6374 696f 6e73 205d 2920   [* sections ]) 
-000160c0: 2020 6966 2028 200d 0a20 2020 2020 2020    if ( ..       
-000160d0: 2072 6574 7572 6e5f 696e 6465 7820 616e   return_index an
-000160e0: 6420 7265 7475 726e 5f73 6563 7469 6f6e  d return_section
-000160f0: 7320 2920 656c 7365 2020 2820 0d0a 2020  s ) else  ( ..  
-00016100: 2020 2020 2020 2020 2020 5b2a 696e 6465            [*inde
-00016110: 7865 7320 5d20 6966 2072 6574 7572 6e5f  xes ] if return_
-00016120: 696e 6465 7820 656c 7365 2020 5b2a 7365  index else  [*se
-00016130: 6374 696f 6e73 5d29 0d0a 0d0a 6765 745f  ctions])....get_
-00016140: 6171 7569 6665 725f 7365 6374 696f 6e2e  aquifer_section.
-00016150: 5f5f 646f 635f 5f3d 2222 225c 0d0a 4465  __doc__="""\..De
-00016160: 7465 6374 2061 2073 696e 676c 6520 6171  tect a single aq
-00016170: 7569 6665 7220 7365 6374 696f 6e20 2875  uifer section (u
-00016180: 7070 6572 2061 6e64 206c 6f77 6572 2920  pper and lower) 
-00016190: 696e 2064 6570 7468 2e20 200d 0a0d 0a54  in depth.  ....T
-000161a0: 6869 7320 6973 2075 7365 6675 6c20 7472  his is useful tr
-000161b0: 6970 2074 6f20 636f 6d70 7574 6520 7468  ip to compute th
-000161c0: 6520 7468 6963 6b6e 6573 7320 6f66 2074  e thickness of t
-000161d0: 6865 2061 7175 6966 6572 2e0d 0a0d 0a50  he aquifer.....P
-000161e0: 6172 616d 6574 6572 7320 0d0a 2d2d 2d2d  arameters ..----
-000161f0: 2d2d 2d2d 2d2d 2d0d 0a61 7272 5f6b 3a20  -------..arr_k: 
-00016200: 6e64 6172 7261 7920 6f72 2064 6174 6166  ndarray or dataf
-00016210: 7261 6d65 200d 0a20 2020 2044 6174 6120  rame ..    Data 
-00016220: 7468 6174 2063 6f6e 7461 696e 7320 6d61  that contains ma
-00016230: 696e 6c79 2074 6865 2061 7175 6966 6572  inly the aquifer
-00016240: 2076 616c 7565 732e 2049 7420 6361 6e20   values. It can 
-00016250: 616c 736f 2063 6f6e 7461 696e 7320 7468  also contains th
-00016260: 6520 0d0a 2020 2020 6465 7074 6820 7661  e ..    depth va
-00016270: 6c75 6573 2e20 4966 2074 6865 2064 6570  lues. If the dep
-00016280: 7468 2069 7320 696e 636c 7564 6564 2069  th is included i
-00016290: 6e20 7468 6520 6061 7272 5f6b 602c 2060  n the `arr_k`, `
-000162a0: 7a6e 616d 6560 206e 6565 6473 2074 6f20  zname` needs to 
-000162b0: 0d0a 2020 2020 6265 2073 7570 706c 6965  ..    be supplie
-000162c0: 6420 666f 7220 7265 636f 7665 7269 6e67  d for recovering
-000162d0: 2061 6e64 2064 6570 7468 2e20 0d0a 2020   and depth. ..  
-000162e0: 2020 0d0a 7b70 6172 616d 732e 636f 7265    ..{params.core
-000162f0: 2e7a 6e61 6d65 7d0d 0a7b 7061 7261 6d73  .zname}..{params
-00016300: 2e63 6f72 652e 6b6e 616d 657d 0d0a 7b70  .core.kname}..{p
-00016310: 6172 616d 732e 636f 7265 2e7a 7d0d 0a0d  arams.core.z}...
-00016320: 0a72 6574 7572 6e5f 696e 6465 783a 2062  .return_index: b
-00016330: 6f6f 6c2c 2064 6566 6175 6c74 203d 4661  ool, default =Fa
-00016340: 6c73 6520 2c20 0d0a 2020 2020 5265 7475  lse , ..    Retu
-00016350: 726e 7320 7468 6520 706f 7369 7469 6f6e  rns the position
-00016360: 7320 2869 6e64 6578 6573 2920 6f66 2074  s (indexes) of t
-00016370: 6865 2075 7070 6572 2061 6e64 206c 6f77  he upper and low
-00016380: 6572 2073 6563 7469 6f6e 7320 6f66 2074  er sections of t
-00016390: 6865 0d0a 2020 2020 2061 7175 6966 6572  he..     aquifer
-000163a0: 2066 6f75 6e64 2069 6e20 7468 6520 6461   found in the da
-000163b0: 7461 6672 616d 6520 6061 7272 5f6b 602e  taframe `arr_k`.
-000163c0: 200d 0a72 6574 7572 6e5f 7365 6374 696f   ..return_sectio
-000163d0: 6e73 3a20 626f 6f6c 2c20 6465 6661 756c  ns: bool, defaul
-000163e0: 743d 5472 7565 2c20 0d0a 2020 2020 5265  t=True, ..    Re
-000163f0: 7475 726e 7320 7468 6520 7365 6374 696f  turns the sectio
-00016400: 6e73 2028 7570 7065 7220 616e 6420 6c6f  ns (upper and lo
-00016410: 7765 7229 206f 6620 7468 6520 6171 7569  wer) of the aqui
-00016420: 6665 7273 2e20 0d0a 0d0a 5265 7475 726e  fers. ....Return
-00016430: 7320 0d0a 2d2d 2d2d 2d2d 2d2d 0d0a 7570  s ..--------..up
-00016440: 2c20 6c6f 7720 3a6c 6973 7420 6f66 2075  , low :list of u
-00016450: 7070 6572 2061 6e64 206c 6f77 6572 2073  pper and lower s
-00016460: 6563 7469 6f6e 2076 616c 7565 7320 6f66  ection values of
-00016470: 2061 7175 6966 6572 2e0d 0a20 2020 202d   aquifer...    -
-00016480: 2028 7570 6978 2c20 6c6f 7769 7820 293a   (upix, lowix ):
-00016490: 2054 7570 6c65 206f 6620 696e 6465 7865   Tuple of indexe
-000164a0: 7320 6f66 206c 6f77 6572 2061 6e64 2075  s of lower and u
-000164b0: 7070 6572 2073 6563 7469 6f6e 7320 200d  pper sections  .
-000164c0: 0a20 2020 202d 2028 7570 2c20 6c6f 7729  .    - (up, low)
-000164d0: 3a20 5475 706c 6520 6f66 2061 7175 6966  : Tuple of aquif
-000164e0: 6572 2073 6563 7469 6f6e 7320 2875 7070  er sections (upp
-000164f0: 6572 2061 6e64 206c 6f77 6572 2920 200d  er and lower)  .
-00016500: 0a20 2020 202d 2028 7570 6978 2c20 6c6f  .    - (upix, lo
-00016510: 7769 7829 2c20 2875 702c 206c 6f77 2920  wix), (up, low) 
-00016520: 3a20 706f 7369 7469 6f6e 7320 616e 6420  : positions and 
-00016530: 7365 6374 696f 6e73 2076 616c 7565 7320  sections values 
-00016540: 6f66 2061 7175 6966 6572 7320 0d0a 2020  of aquifers ..  
-00016550: 2020 2020 2020 6966 2060 7265 7475 726e        if `return
-00016560: 5f69 6e64 6578 6020 616e 6420 7265 7475  _index` and retu
-00016570: 726e 5f73 6563 7469 6f6e 7360 2061 7265  rn_sections` are
-00016580: 2060 6054 7275 6560 602e 2020 0d0a 0d0a   ``True``.  ....
-00016590: 4578 616d 706c 650d 0a2d 2d2d 2d2d 2d2d  Example..-------
-000165a0: 0d0a 3e3e 3e20 6672 6f6d 2077 6174 6578  ..>>> from watex
-000165b0: 2e64 6174 6173 6574 7320 696d 706f 7274  .datasets import
-000165c0: 206c 6f61 645f 686c 6f67 7320 0d0a 3e3e   load_hlogs ..>>
-000165d0: 3e20 6672 6f6d 2077 6174 6578 2e75 7469  > from watex.uti
-000165e0: 6c73 2e68 7964 726f 7574 696c 7320 696d  ls.hydroutils im
-000165f0: 706f 7274 2067 6574 5f61 7175 6966 6572  port get_aquifer
-00016600: 5f73 6563 7469 6f6e 200d 0a3e 3e3e 2064  _section ..>>> d
-00016610: 6174 6120 3d20 6c6f 6164 5f68 6c6f 6773  ata = load_hlogs
-00016620: 2028 292e 6672 616d 6520 2320 7265 7475   ().frame # retu
-00016630: 726e 2061 6c6c 2064 6174 6120 696e 636c  rn all data incl
-00016640: 7564 696e 6720 7468 6520 2764 6570 7468  uding the 'depth
-00016650: 2720 7661 6c75 6573 200d 0a3e 3e3e 2067  ' values ..>>> g
-00016660: 6574 5f61 7175 6966 6572 5f73 6563 7469  et_aquifer_secti
-00016670: 6f6e 2028 6461 7461 202c 207a 6e61 6d65  on (data , zname
-00016680: 203d 2764 6570 7468 272c 206b 6e61 6d65   ='depth', kname
-00016690: 203d 276b 2729 0d0a 2e2e 2e20 5b31 3937   ='k')..... [197
-000166a0: 2e31 322c 2033 3639 2e37 315d 2023 2073  .12, 369.71] # s
-000166b0: 6563 7469 6f6e 2073 7461 7274 7320 6672  ection starts fr
-000166c0: 6f6d 2031 3937 2e31 3220 2d3e 2033 3639  om 197.12 -> 369
-000166d0: 2e37 3120 6d20 0d0a 3e3e 3e20 6765 745f  .71 m ..>>> get_
-000166e0: 6171 7569 6665 725f 7365 6374 696f 6e20  aquifer_section 
-000166f0: 2864 6174 6120 2c20 7a6e 616d 6520 3d27  (data , zname ='
-00016700: 6465 7074 6827 2c20 6b6e 616d 6520 3d27  depth', kname ='
-00016710: 6b27 2c20 7265 7475 726e 5f69 6e64 6578  k', return_index
-00016720: 3d54 7275 6529 200d 0a2e 2e2e 2028 5b31  =True) ..... ([1
-00016730: 362c 2032 395d 2c20 5b31 3937 2e31 322c  6, 29], [197.12,
-00016740: 2033 3639 2e37 315d 2920 2320 7570 7065   369.71]) # uppe
-00016750: 7220 616e 6420 6c6f 7765 722d 3e20 706f  r and lower-> po
-00016760: 7369 7469 6f6e 2031 3620 616e 6420 3239  sition 16 and 29
-00016770: 2e0d 0a0d 0a0d 0a22 2222 2e66 6f72 6d61  .......""".forma
-00016780: 7428 0d0a 2020 2020 7061 7261 6d73 3d5f  t(..    params=_
-00016790: 7061 7261 6d5f 646f 6373 2c0d 0a20 2020  param_docs,..   
-000167a0: 2029 0d0a 2020 2020 0d0a 6465 6620 5f6b   )..    ..def _k
-000167b0: 7020 286b 2c20 2f2c 2020 6b72 3d20 282e  p (k, /,  kr= (.
-000167c0: 3031 202c 202e 3037 2029 2c20 7374 7269  01 , .07 ), stri
-000167d0: 6e67 203d 2046 616c 7365 2029 203a 0d0a  ng = False ) :..
-000167e0: 2020 2020 2222 2220 4465 6661 756c 7420      """ Default 
-000167f0: 7065 726d 6561 6269 6c69 7479 2027 6b27  permeability 'k'
-00016800: 206d 6170 7069 6e67 2075 7369 6e67 2064   mapping using d
-00016810: 6963 7420 746f 2076 616c 6964 6174 6520  ict to validate 
-00016820: 7468 6520 636f 6e74 696e 7565 200d 0a20  the continue .. 
-00016830: 2020 2076 616c 7565 2027 6b27 200d 0a20     value 'k' .. 
-00016840: 2020 203a 7061 7261 6d20 6b3a 2066 6c6f     :param k: flo
-00016850: 6174 2c20 0d0a 2020 2020 2020 2020 636f  at, ..        co
-00016860: 6e74 696e 7565 2076 616c 7565 206f 6620  ntinue value of 
-00016870: 7468 6520 7065 726d 6561 6269 6c69 7479  the permeability
-00016880: 2063 6f65 6666 6963 6965 6e74 200d 0a20   coefficient .. 
-00016890: 2020 203a 7061 7261 6d20 6b72 3a20 5475     :param kr: Tu
-000168a0: 706c 652c 200d 0a20 2020 2020 2020 2072  ple, ..        r
-000168b0: 616e 6765 206f 6620 7065 726d 6561 6269  ange of permeabi
-000168c0: 6c69 7479 2063 6f65 6666 6963 6965 6e74  lity coefficient
-000168d0: 2074 6f20 6361 7465 676f 7269 7a65 200d   to categorize .
-000168e0: 0a20 2020 203a 7061 7261 6d20 7374 7269  .    :param stri
-000168f0: 6e67 3a20 626f 6f6c 2c20 7374 7220 0d0a  ng: bool, str ..
-00016900: 2020 2020 2020 2020 6c61 6265 6c20 746f          label to
-00016910: 2070 7265 6669 7820 7468 6520 7468 6520   prefix the the 
-00016920: 6361 7465 676f 7269 616c 2076 616c 7565  categorial value
-00016930: 2e20 0d0a 2020 2020 3a72 6574 7572 6e3a  . ..    :return:
-00016940: 2066 6c6f 6174 2f73 7472 202d 206e 6577   float/str - new
-00016950: 2063 6174 6567 6f72 6963 616c 2076 616c   categorical val
-00016960: 7565 202e 200d 0a0d 0a20 2020 2022 2222  ue . ....    """
-00016970: 0d0a 2020 2020 6420 3d20 7b30 3a20 6b20  ..    d = {0: k 
-00016980: 3c3d 3020 2c20 313a 2030 203c 206b 203c  <=0 , 1: 0 < k <
-00016990: 3d20 6b72 5b30 5d2c 2032 3a20 6b72 5b30  = kr[0], 2: kr[0
-000169a0: 5d20 3c20 6b20 3c3d 6b72 5b31 5d2c 2033  ] < k <=kr[1], 3
-000169b0: 3a20 6b20 3e20 6b72 5b31 5d20 0d0a 2020  : k > kr[1] ..  
-000169c0: 2020 2020 2020 207d 0d0a 2020 2020 6c61         }..    la
-000169d0: 6265 6c20 3d20 276b 2720 6966 2073 7472  bel = 'k' if str
-000169e0: 2873 7472 696e 6729 2e6c 6f77 6572 2829  (string).lower()
-000169f0: 3d3d 2774 7275 6527 2065 6c73 6520 7374  =='true' else st
-00016a00: 7228 7374 7269 6e67 2029 0d0a 2020 2020  r(string )..    
-00016a10: 666f 7220 762c 2076 616c 7565 2069 6e20  for v, value in 
-00016a20: 642e 6974 656d 7320 2829 203a 0d0a 2020  d.items () :..  
-00016a30: 2020 2020 2020 6966 2076 616c 7565 3a20        if value: 
-00016a40: 7265 7475 726e 2076 2069 6620 6e6f 7420  return v if not 
-00016a50: 7374 7269 6e67 2065 6c73 6520 2028 200d  string else  ( .
-00016a60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016a70: 206c 6162 656c 202b 2073 7472 2876 2920   label + str(v) 
-00016a80: 6966 206e 6f74 206d 6174 682e 6973 6e61  if not math.isna
-00016a90: 6e20 2876 2920 656c 7365 206e 702e 6e61  n (v) else np.na
-00016aa0: 6e20 2920 0d0a 0d0a 6465 6620 636c 6173  n ) ....def clas
-00016ab0: 7369 6679 5f6b 2028 0d0a 2020 2020 2020  sify_k (..      
-00016ac0: 2020 6f3a 4461 7461 4672 616d 657c 2053    o:DataFrame| S
-00016ad0: 6572 6965 7320 7c20 4172 7261 794c 696b  eries | ArrayLik
-00016ae0: 652c 202f 2c20 2066 756e 633a 2063 616c  e, /,  func: cal
-00016af0: 6c61 626c 657c 463d 204e 6f6e 6520 2c20  lable|F= None , 
-00016b00: 0d0a 2020 2020 2020 2020 6b6e 616d 653a  ..        kname:
-00016b10: 7374 723d 4e6f 6e65 2c20 696e 706c 6163  str=None, inplac
-00016b20: 653a 626f 6f6c 203d 4661 6c73 652c 2073  e:bool =False, s
-00016b30: 7472 696e 673a 7374 7220 3d46 616c 7365  tring:str =False
-00016b40: 2c20 0d0a 2020 2020 2020 2020 6465 6661  , ..        defa
-00016b50: 756c 745f 6675 6e63 3a62 6f6f 6c3d 4661  ult_func:bool=Fa
-00016b60: 6c73 6520 200d 0a20 2020 2020 2020 2029  lse  ..        )
-00016b70: 3a0d 0a20 2020 2022 2222 2043 6174 6567  :..    """ Categ
-00016b80: 6f72 697a 6520 7468 6520 7065 726d 6561  orize the permea
-00016b90: 6269 6c69 7479 2063 6f65 6666 6963 6965  bility coefficie
-00016ba0: 6e74 2027 6b27 0d0a 2020 2020 0d0a 2020  nt 'k'..    ..  
-00016bb0: 2020 4d61 7020 7468 6520 636f 6e74 696e    Map the contin
-00016bc0: 756f 7573 2027 6b27 2069 6e74 6f20 6361  uous 'k' into ca
-00016bd0: 7465 676f 7269 616c 2063 6c61 7373 6573  tegorial classes
-00016be0: 2e20 0d0a 2020 2020 0d0a 2020 2020 5061  . ..    ..    Pa
-00016bf0: 7261 6d65 7465 7273 200d 0a20 2020 202d  rameters ..    -
-00016c00: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 206f  ---------..    o
-00016c10: 3a20 6e64 6172 7261 7920 6f66 2070 642e  : ndarray of pd.
-00016c20: 5365 7269 6573 206f 7220 4461 7461 6672  Series or Datafr
-00016c30: 616d 650d 0a20 2020 2020 2020 2064 6174  ame..        dat
-00016c40: 6120 636f 6e74 6169 6e69 6e67 2074 6865  a containing the
-00016c50: 2070 6572 6d65 6162 696c 6974 7920 636f   permeability co
-00016c60: 6566 6669 6369 656e 7420 6b20 636f 6e74  efficient k cont
-00016c70: 696e 656f 7573 2076 616c 7565 732e 200d  ineous values. .
-00016c80: 0a20 2020 2020 2020 2049 6620 6461 7461  .        If data
-00016c90: 2069 7320 7061 7373 7365 6420 6173 2061   is passsed as a
-00016ca0: 2070 616e 6461 7320 6461 7461 6672 616d   pandas datafram
-00016cb0: 652c 2074 6865 2063 6f6c 756d 6e20 636f  e, the column co
-00016cc0: 6e74 6169 6e69 6e67 2074 6865 200d 0a20  ntaining the .. 
-00016cd0: 2020 2020 2020 206b 2d76 616c 7565 7320         k-values 
-00016ce0: 606b 6e61 6d65 6020 6e65 6564 7320 746f  `kname` needs to
-00016cf0: 2062 6520 7370 6563 6966 6965 642e 200d   be specified. .
-00016d00: 0a20 2020 2066 756e 633a 2063 616c 6c61  .    func: calla
-00016d10: 626c 6520 0d0a 2020 2020 2020 2020 4675  ble ..        Fu
-00016d20: 6e63 7469 6f6e 2074 6f20 7370 6563 6966  nction to specif
-00016d30: 6963 616c 6c79 206d 6170 2074 6865 2070  ically map the p
-00016d40: 6572 6d65 6162 696c 6974 7920 636f 6566  ermeability coef
-00016d50: 6669 6369 656e 7420 636f 6c75 6d6e 200d  ficient column .
-00016d60: 0a20 2020 2020 2020 2069 6e20 7468 6520  .        in the 
-00016d70: 6461 7461 6672 616d 6520 6f66 2073 6572  dataframe of ser
-00016d80: 6965 2e20 4966 206e 6f74 2067 6976 656e  ie. If not given
-00016d90: 2c20 7468 6520 6465 6661 756c 7420 6675  , the default fu
-00016da0: 6e63 7469 6f6e 2063 616e 2062 6520 0d0a  nction can be ..
-00016db0: 2020 2020 2020 2020 656e 6162 6c65 6420          enabled 
-00016dc0: 696e 7374 6561 6420 6672 6f6d 2070 6172  instead from par
-00016dd0: 616d 2060 6465 6661 756c 745f 6675 6e63  am `default_func
-00016de0: 602e 200d 0a20 2020 2069 6e70 6c61 6365  `. ..    inplace
-00016df0: 3a20 626f 6f6c 2c20 6465 6661 756c 743d  : bool, default=
-00016e00: 4661 6c73 6520 0d0a 2020 2020 2020 2020  False ..        
-00016e10: 4d6f 6469 6669 6564 206f 626a 6563 7420  Modified object 
-00016e20: 696e 706c 6163 6520 616e 6420 7265 7475  inplace and retu
-00016e30: 726e 204e 6f6e 6520 0d0a 2020 2020 7374  rn None ..    st
-00016e40: 7269 6e67 3a20 626f 6f6c 2c20 0d0a 2020  ring: bool, ..  
-00016e50: 2020 2020 2020 4966 2073 6574 2074 6f20        If set to 
-00016e60: 2254 7275 6522 2c20 6361 7465 676f 7269  "True", categori
-00016e70: 7a65 6420 6d61 7020 6672 6f6d 2027 6b27  zed map from 'k'
-00016e80: 2020 7368 6f75 6c64 2062 6520 7072 6566    should be pref
-00016e90: 6978 6564 2062 7920 226b 222e 200d 0a20  ixed by "k". .. 
-00016ea0: 2020 2020 2020 2048 6f77 6576 6572 2069         However i
-00016eb0: 7320 7374 7269 6e67 2076 616c 7565 2069  s string value i
-00016ec0: 7320 6769 7665 6e20 2c20 7468 6520 7072  s given , the pr
-00016ed0: 6566 6978 2069 7320 6368 616e 6765 6420  efix is changed 
-00016ee0: 6163 636f 7264 696e 6720 0d0a 2020 2020  according ..    
-00016ef0: 2020 2020 746f 2074 6869 7320 6c61 6265      to this labe
-00016f00: 6c2e 200d 0a20 2020 2064 6566 6175 6c74  l. ..    default
-00016f10: 5f75 6675 6e63 3a20 626f 6f6c 2c20 0d0a  _ufunc: bool, ..
-00016f20: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
-00016f30: 6675 6e63 7469 6f6e 2066 6f72 206d 6170  function for map
-00016f40: 7069 6e67 206b 2069 7320 7365 7474 696e  ping k is settin
-00016f50: 6720 746f 2060 6054 7275 6560 602e 204e  g to ``True``. N
-00016f60: 6f74 6520 7468 6174 2c20 7468 6973 200d  ote that, this .
-00016f70: 0a20 2020 2020 2020 2063 6f75 6c64 2070  .        could p
-00016f80: 726f 6261 626c 7920 6e6f 7420 6669 7474  robably not fitt
-00016f90: 6564 2079 6f75 7220 6f77 6e20 6461 7461  ed your own data
-00016fa0: 2e20 536f 2020 6974 2069 7320 7265 636f  . So  it is reco
-00016fb0: 6d6d 656e 6465 6420 746f 200d 0a20 2020  mmended to ..   
-00016fc0: 2020 2020 2070 726f 7669 6465 2079 6f75       provide you
-00016fd0: 7220 6f77 6e20 6675 6e63 7469 6f6e 2066  r own function f
-00016fe0: 6f72 206d 6170 7069 6e67 2027 6b27 2e20  or mapping 'k'. 
-00016ff0: 486f 7765 7665 7220 7468 6520 6465 6661  However the defa
-00017000: 756c 7420 276b 2720 0d0a 2020 2020 2020  ult 'k' ..      
-00017010: 2020 6d61 7070 696e 6720 6973 2067 6976    mapping is giv
-00017020: 656e 2061 7320 666f 6c6c 6f77 3a20 0d0a  en as follow: ..
-00017030: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00017040: 2020 2020 2020 2d20 6b30 207b 307d 3a20        - k0 {0}: 
-00017050: 6b20 3d20 3020 0d0a 2020 2020 2020 2020  k = 0 ..        
-00017060: 2d20 6b31 207b 317d 3a20 3020 3c20 6b20  - k1 {1}: 0 < k 
-00017070: 3c3d 202e 3031 200d 0a20 2020 2020 2020  <= .01 ..       
-00017080: 202d 206b 3220 7b32 7d3a 202e 3031 203c   - k2 {2}: .01 <
-00017090: 206b 203c 3d20 2e30 3720 0d0a 2020 2020   k <= .07 ..    
-000170a0: 2020 2020 2d20 6b33 207b 337d 3a20 6b3e      - k3 {3}: k>
-000170b0: 202e 3037 200d 0a20 2020 2052 6574 7572   .07 ..    Retur
-000170c0: 6e73 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  ns..    --------
-000170d0: 0d0a 2020 2020 6f3a 204e 6f6e 652c 2020  ..    o: None,  
-000170e0: 6e64 6172 7261 792c 2053 6572 6965 7320  ndarray, Series 
-000170f0: 6f72 2044 6174 6166 7261 6d65 200d 0a20  or Dataframe .. 
-00017100: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
-00017110: 6e65 206f 6e6c 7920 6966 2064 6174 6166  ne only if dataf
-00017120: 7261 6d65 2069 7320 6769 7665 6e20 616e  rame is given an
-00017130: 6420 6069 6e70 6c61 6365 6020 6973 2073  d `inplace` is s
-00017140: 6574 200d 0a20 2020 2020 2020 2074 6f20  et ..        to 
-00017150: 6060 5472 7565 6060 2069 2e65 206d 6f64  ``True`` i.e mod
-00017160: 6966 6965 6420 6f62 6a65 6374 2069 6e70  ified object inp
-00017170: 6c61 6365 2e20 0d0a 2020 2020 2020 2020  lace. ..        
-00017180: 0d0a 2020 2020 4578 616d 706c 6573 200d  ..    Examples .
-00017190: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20  .    --------.. 
-000171a0: 2020 203e 3e3e 2069 6d70 6f72 7420 6e75     >>> import nu
-000171b0: 6d70 7920 6173 206e 7020 0d0a 2020 2020  mpy as np ..    
-000171c0: 3e3e 3e20 6672 6f6d 2077 6174 6578 2e64  >>> from watex.d
-000171d0: 6174 6173 6574 7320 696d 706f 7274 206c  atasets import l
-000171e0: 6f61 645f 686c 6f67 7320 0d0a 2020 2020  oad_hlogs ..    
-000171f0: 3e3e 3e20 6672 6f6d 2077 6174 6578 2e75  >>> from watex.u
-00017200: 7469 6c73 2e68 7964 726f 7574 696c 7320  tils.hydroutils 
-00017210: 696d 706f 7274 2063 6c61 7373 6966 795f  import classify_
-00017220: 6b20 0d0a 2020 2020 3e3e 3e20 5f2c 2079  k ..    >>> _, y
-00017230: 3020 3d20 6c6f 6164 5f68 6c6f 6773 2028  0 = load_hlogs (
-00017240: 6173 5f66 7261 6d65 203d 5472 7565 2920  as_frame =True) 
-00017250: 0d0a 2020 2020 3e3e 3e20 2320 6c65 7420  ..    >>> # let 
-00017260: 7669 7375 616c 697a 6520 666f 7572 206e  visualize four n
-00017270: 6f6e 7a65 726f 7320 7661 6c75 6573 2069  onzeros values i
-00017280: 6e20 7930 200d 0a20 2020 203e 3e3e 2079  n y0 ..    >>> y
-00017290: 302e 6b2e 7661 6c75 6573 205b 207e 6e70  0.k.values [ ~np
-000172a0: 2e69 736e 616e 2028 7930 2e6b 2029 205d  .isnan (y0.k ) ]
-000172b0: 5b3a 345d 0d0a 2020 2020 2e2e 2e20 2061  [:4]..    ...  a
-000172c0: 7272 6179 285b 302e 3035 342c 2030 2e30  rray([0.054, 0.0
-000172d0: 3534 2c20 302e 3035 342c 2030 2e30 3534  54, 0.054, 0.054
-000172e0: 5d29 0d0a 2020 2020 3e3e 3e20 636c 6173  ])..    >>> clas
-000172f0: 7369 6679 5f6b 2028 7930 202c 206b 6e61  sify_k (y0 , kna
-00017300: 6d65 203d 276b 272c 2069 6e70 6c61 6365  me ='k', inplace
-00017310: 203d 5472 7565 2c20 7573 655f 6465 6661   =True, use_defa
-00017320: 756c 745f 6675 6e63 3d54 7275 6520 290d  ult_func=True ).
-00017330: 0a20 2020 203e 3e3e 2023 206c 6574 2073  .    >>> # let s
-00017340: 6565 2061 6761 696e 2074 6865 2073 616d  ee again the sam
-00017350: 6520 666f 7572 2076 616c 7565 2069 6e20  e four value in 
-00017360: 7468 6520 6461 7461 6672 616d 6520 0d0a  the dataframe ..
-00017370: 2020 2020 3e3e 3e20 7930 2e6b 2e76 616c      >>> y0.k.val
-00017380: 7565 7320 5b20 7e6e 702e 6973 6e61 6e20  ues [ ~np.isnan 
-00017390: 2879 302e 6b20 2920 5d5b 3a34 5d0d 0a20  (y0.k ) ][:4].. 
-000173a0: 2020 202e 2e2e 2061 7272 6179 285b 322e     ... array([2.
-000173b0: 2c20 322e 2c20 322e 2c20 322e 5d29 200d  , 2., 2., 2.]) .
-000173c0: 0a20 2020 200d 0a20 2020 2022 2222 0d0a  .    ..    """..
-000173d0: 2020 2020 5f61 7373 6572 745f 616c 6c5f      _assert_all_
-000173e0: 7479 7065 7328 6f2c 2070 642e 5365 7269  types(o, pd.Seri
-000173f0: 6573 2c20 7064 2e44 6174 6146 7261 6d65  es, pd.DataFrame
-00017400: 2c20 6e70 2e6e 6461 7272 6179 290d 0a20  , np.ndarray).. 
-00017410: 2020 200d 0a20 2020 2064 6675 6e63 203d     ..    dfunc =
-00017420: 206c 616d 6264 6120 6b20 3a20 5f6b 7020   lambda k : _kp 
-00017430: 286b 2c20 7374 7269 6e67 203d 2073 7472  (k, string = str
-00017440: 696e 6720 2920 2320 6465 6661 756c 7420  ing ) # default 
-00017450: 0d0a 2020 2020 6675 6e63 203d 2066 756e  ..    func = fun
-00017460: 6320 6f72 2020 2028 2064 6675 6e63 2069  c or   ( dfunc i
-00017470: 6620 6465 6661 756c 745f 6675 6e63 2065  f default_func e
-00017480: 6c73 6520 4e6f 6e65 2029 200d 0a20 2020  lse None ) ..   
-00017490: 2069 6620 6675 6e63 2069 7320 4e6f 6e65   if func is None
-000174a0: 3a20 0d0a 2020 2020 2020 2020 7261 6973  : ..        rais
-000174b0: 6520 5479 7065 4572 726f 7220 2822 2775  e TypeError ("'u
-000174c0: 6675 6e63 2720 6361 6e6e 6f74 2062 6520  func' cannot be 
-000174d0: 4e6f 6e65 2077 6865 6e20 7468 6520 6465  None when the de
-000174e0: 6661 756c 7422 0d0a 2020 2020 2020 2020  fault"..        
-000174f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017500: 2022 2027 6b27 206d 6170 7069 6e67 2066   " 'k' mapping f
-00017510: 756e 6374 696f 6e20 6973 206e 6f74 2074  unction is not t
-00017520: 7269 6767 6572 6564 2e22 290d 0a20 2020  riggered.")..   
-00017530: 206f 6f3d 2063 6f70 792e 6465 6570 636f   oo= copy.deepco
-00017540: 7079 2028 6f20 290d 0a20 2020 2069 6620  py (o )..    if 
-00017550: 6861 7361 7474 7220 286f 2c20 2763 6f6c  hasattr (o, 'col
-00017560: 756d 6e73 2729 3a0d 0a20 2020 2020 2020  umns'):..       
-00017570: 2069 6620 6b6e 616d 6520 6973 204e 6f6e   if kname is Non
-00017580: 653a 200d 0a20 2020 2020 2020 2020 2020  e: ..           
-00017590: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-000175a0: 7220 2822 6b6e 616d 6527 2069 7320 6e6f  r ("kname' is no
-000175b0: 7420 7365 7420 7768 696c 6520 6461 7461  t set while data
-000175c0: 6672 616d 6520 6973 2067 6976 656e 2e20  frame is given. 
-000175d0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-000175e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000175f0: 2022 506c 6561 7365 2073 7065 6369 6679   "Please specify
-00017600: 2074 6865 206e 616d 6520 6f66 2070 6572   the name of per
-00017610: 6d65 6162 696c 6974 7920 636f 6c75 6d6e  meability column
-00017620: 2e22 290d 0a20 2020 2020 2020 2069 735f  .")..        is_
-00017630: 696e 5f69 6628 206f 2c20 6b6e 616d 6520  in_if( o, kname 
-00017640: 290d 0a20 200d 0a20 2020 2020 2020 2069  )..  ..        i
-00017650: 6620 696e 706c 6163 6520 3a20 0d0a 2020  f inplace : ..  
-00017660: 2020 2020 2020 2020 2020 6f5b 6b6e 616d            o[knam
-00017670: 655d 203d 206f 5b6b 6e61 6d65 5d2e 6d61  e] = o[kname].ma
-00017680: 7020 2866 756e 6329 200d 0a20 2020 2020  p (func) ..     
-00017690: 2020 2020 2020 2072 6574 7572 6e20 0d0a         return ..
-000176a0: 2020 2020 2020 2020 6f6f 5b6b 6e61 6d65          oo[kname
-000176b0: 5d20 3d20 6f6f 5b6b 6e61 6d65 5d2e 6d61  ] = oo[kname].ma
-000176c0: 7020 2866 756e 6329 200d 0a20 2020 2020  p (func) ..     
-000176d0: 2020 200d 0a20 2020 2065 6c69 6620 6861     ..    elif ha
-000176e0: 7361 7474 7228 6f2c 2027 6e61 6d65 2729  sattr(o, 'name')
-000176f0: 3a20 0d0a 2020 2020 2020 2020 6f6f 3d20  : ..        oo= 
-00017700: 6f6f 2e6d 6170 2866 756e 6320 2920 0d0a  oo.map(func ) ..
-00017710: 2020 0d0a 2020 2020 656c 6966 2068 6173    ..    elif has
-00017720: 6174 7472 286f 2c20 275f 5f61 7272 6179  attr(o, '__array
-00017730: 5f5f 2729 3a20 0d0a 2020 2020 2020 2020  __'): ..        
-00017740: 6f6f 203d 206e 702e 6172 7261 7920 286c  oo = np.array (l
-00017750: 6973 7428 6d61 7020 2866 756e 632c 206f  ist(map (func, o
-00017760: 2029 2929 0d0a 2020 2020 2020 2020 0d0a   )))..        ..
-00017770: 2020 2020 7265 7475 726e 206f 6f20 0d0a      return oo ..
-00017780: 0d0a 2358 5858 544f 444f 2063 6f6d 7075  ..#XXXTODO compu
-00017790: 7465 2074 2070 6172 616d 6574 6572 7320  te t parameters 
-000177a0: 0d0a 6465 6620 7472 616e 736d 6973 7369  ..def transmissi
-000177b0: 6269 6c69 7479 2028 732c 2064 2c20 7469  bility (s, d, ti
-000177c0: 6d65 2c20 293a 200d 0a20 2020 2022 2222  me, ): ..    """
-000177d0: 5472 616e 736d 6973 7369 6269 6c69 7479  Transmissibility
-000177e0: 2054 2072 6570 7265 7365 6e74 7320 7468   T represents th
-000177f0: 6520 6162 696c 6974 7920 6f66 2061 7175  e ability of aqu
-00017800: 6966 6572 2773 2077 6174 6572 2063 6f6e  ifer's water con
-00017810: 6475 6374 6976 6974 792e 0d0a 2020 2020  ductivity...    
-00017820: 0d0a 2020 2020 4974 2069 7320 7468 6520  ..    It is the 
-00017830: 6e75 6d65 7269 6320 6571 7569 7661 6c65  numeric equivale
-00017840: 6e74 206f 6620 7468 6520 7072 6f64 7563  nt of the produc
-00017850: 7420 6f66 2068 7964 7261 756c 6963 2063  t of hydraulic c
-00017860: 6f6e 6475 6374 6976 6974 7920 7469 6d65  onductivity time
-00017870: 730d 0a20 2020 2061 7175 6966 6572 2773  s..    aquifer's
-00017880: 2074 6869 636b 6e65 7373 2028 5420 3d20   thickness (T = 
-00017890: 4b4d 292c 2077 6869 6368 206d 6561 6e73  KM), which means
-000178a0: 2069 7420 6973 2074 6865 2073 6565 7061   it is the seepa
-000178b0: 6765 2066 6c6f 7720 756e 6465 7220 7468  ge flow under th
-000178c0: 650d 0a20 2020 2063 6f6e 6469 7469 6f6e  e..    condition
-000178d0: 206f 6620 756e 6974 2068 7964 7261 756c   of unit hydraul
-000178e0: 6963 2067 7261 6469 656e 742c 2075 6e69  ic gradient, uni
-000178f0: 7420 7469 6d65 2c20 616e 6420 756e 6974  t time, and unit
-00017900: 2077 6964 7468 0d0a 2020 2020 0d0a 2020   width..    ..  
-00017910: 2020 2222 220d 0a20 2020 202e 2e2e 200d    """..    ... .
-00017920: 0a20 2020 2020 200d 0a64 6566 2063 6865  .      ..def che
-00017930: 636b 5f66 6c6f 775f 6f62 6a65 6374 6976  ck_flow_objectiv
-00017940: 6974 7920 2820 7920 2c2f 2c20 2076 616c  ity ( y ,/,  val
-00017950: 7565 732c 2063 6c61 7373 6573 2020 2920  ues, classes  ) 
-00017960: 3a0d 0a20 2020 2022 2222 2046 756e 6374  :..    """ Funct
-00017970: 696f 6e20 6368 6563 6b73 2074 6865 2066  ion checks the f
-00017980: 6c6f 7720 7261 7465 206f 626a 6563 7469  low rate objecti
-00017990: 7669 7479 0d0a 2020 2020 0d0a 2020 2020  vity..    ..    
-000179a0: 4966 206f 626a 6563 7469 7665 2069 7320  If objective is 
-000179b0: 7365 7420 746f 2060 666c 6f77 6020 692e  set to `flow` i.
-000179c0: 6520 7468 6520 7072 6564 6963 7469 6f6e  e the prediction
-000179d0: 2066 6f63 7573 6573 206f 6e20 7468 6520   focuses on the 
-000179e0: 666c 6f77 0d0a 2020 2020 7261 7465 2c20  flow..    rate, 
-000179f0: 7468 6572 6520 6172 6520 736f 6d65 2063  there are some c
-00017a00: 6f6e 6469 7469 6f6e 7320 7468 6174 2074  onditions that t
-00017a10: 6865 2074 6172 6765 7420 6079 6020 6e65  he target `y` ne
-00017a20: 6564 7320 746f 206d 6565 7420 7768 656e  eds to meet when
-00017a30: 200d 0a20 2020 2076 616c 7565 7320 6172   ..    values ar
-00017a40: 6520 7061 7373 6564 2066 6f72 2063 6c61  e passed for cla
-00017a50: 7373 6573 2063 6174 6567 6f72 697a 6174  sses categorizat
-00017a60: 696f 6e2e 200d 0a20 2020 200d 0a20 2020  ion. ..    ..   
-00017a70: 203a 7061 7261 6d20 7661 6c75 6573 3a20   :param values: 
-00017a80: 6c69 7374 206f 6620 7661 6c75 6573 2074  list of values t
-00017a90: 6f20 656e 636f 6469 6e67 2074 6865 206e  o encoding the n
-00017aa0: 756d 6572 6963 616c 2074 6172 6765 7420  umerical target 
-00017ab0: 6079 602e 200d 0a20 2020 2020 2020 2066  `y`. ..        f
-00017ac0: 6f72 2069 6e73 7461 6e63 6520 6060 7661  or instance ``va
-00017ad0: 6c75 6573 3d5b 302c 2031 2c20 325d 6060  lues=[0, 1, 2]``
-00017ae0: 200d 0a20 2020 203a 7061 7261 6d20 6f62   ..    :param ob
-00017af0: 6a65 6374 6976 653a 2073 7472 2c20 7265  jective: str, re
-00017b00: 6c61 7465 2074 6f20 7468 6520 666c 6f77  late to the flow
-00017b10: 2072 6174 6520 7072 6564 6963 7469 6f6e   rate prediction
-00017b20: 2e20 5365 7420 746f 200d 0a20 2020 2020  . Set to ..     
-00017b30: 2020 2060 604e 6f6e 6560 6020 666f 7220     ``None`` for 
-00017b40: 616e 7920 6f74 6865 7220 7072 6564 6963  any other predic
-00017b50: 7469 6f6e 732e 200d 0a20 2020 203a 7061  tions. ..    :pa
-00017b60: 7261 6d20 7072 6566 6978 3a20 7468 6520  ram prefix: the 
-00017b70: 7072 6566 6978 2074 6f20 6164 6420 746f  prefix to add to
-00017b80: 2074 6865 2063 6c61 7373 206c 6162 656c   the class label
-00017b90: 732e 2046 6f72 2069 6e73 7461 6e63 652c  s. For instance,
-00017ba0: 2069 6620 0d0a 2020 2020 2020 2020 7468   if ..        th
-00017bb0: 6520 6070 7265 6669 7860 2065 7175 616c  e `prefix` equal
-00017bc0: 7320 746f 2060 6046 5260 602c 2063 6c61  s to ``FR``, cla
-00017bd0: 7373 206c 6162 656c 7320 7769 6c6c 2062  ss labels will b
-00017be0: 6563 6f6d 653a 3a20 0d0a 2020 2020 2020  ecome:: ..      
-00017bf0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00017c00: 2020 2020 5b30 2c20 312c 2032 5d20 3d3e      [0, 1, 2] =>
-00017c10: 205b 4652 302c 2046 5231 2c20 4652 325d   [FR0, FR1, FR2]
-00017c20: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00017c30: 2020 2020 3a70 6172 616d 2063 6c61 7373      :param class
-00017c40: 6573 3a20 6c69 7374 206f 6620 636c 6173  es: list of clas
-00017c50: 7365 7320 6e61 6d65 7320 746f 2072 6570  ses names to rep
-00017c60: 6c61 6365 2074 6865 2064 6566 6175 6c74  lace the default
-00017c70: 2060 4652 6020 7468 6174 2069 7320 0d0a   `FR` that is ..
-00017c80: 2020 2020 2020 2020 7573 6564 2074 6f20          used to 
-00017c90: 7370 6563 6966 7920 7468 6520 666c 6f77  specify the flow
-00017ca0: 2072 6174 652e 2046 6f72 2069 6e73 7461   rate. For insta
-00017cb0: 6e63 652c 2069 7420 6361 6e20 6265 3a3a  nce, it can be::
-00017cc0: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
-00017cd0: 0a20 2020 2020 2020 2020 2020 205b 302c  .            [0,
-00017ce0: 2031 2c20 325d 203d 3e20 5b73 6630 2c20   1, 2] => [sf0, 
-00017cf0: 7366 312c 2073 6632 5d0d 0a20 2020 203a  sf1, sf2]..    :
-00017d00: 7265 7475 726e 733a 0d0a 2020 2020 2020  returns:..      
-00017d10: 2020 2879 2c20 636c 6173 7365 7329 3a20    (y, classes): 
-00017d20: 5475 706c 652c 200d 0a20 2020 2020 2020  Tuple, ..       
-00017d30: 202d 2079 3a20 6172 7261 792d 6c69 6b65   - y: array-like
-00017d40: 2031 6420 206f 6620 6361 7465 676f 7269   1d  of categori
-00017d50: 7a65 6420 2060 7960 200d 0a20 2020 2020  zed  `y` ..     
-00017d60: 2020 202d 2063 6c61 7373 6573 3a20 6c69     - classes: li
-00017d70: 7374 206f 6620 666c 6f77 2072 6174 6520  st of flow rate 
-00017d80: 636c 6173 7365 732e 200d 0a20 2020 2022  classes. ..    "
-00017d90: 2222 0d0a 2020 2020 6d73 673d 2028 224f  ""..    msg= ("O
-00017da0: 626a 6563 7469 7665 2069 7320 2766 6c6f  bjective is 'flo
-00017db0: 7727 2077 6865 7265 6173 2074 6865 2074  w' whereas the t
-00017dc0: 6172 6765 7420 7661 6c75 6520 6973 2073  arget value is s
-00017dd0: 6574 2074 6f20 7b30 7d2e 220d 0a20 2020  et to {0}."..   
-00017de0: 2020 2020 2020 2022 2054 6172 6765 7420         " Target 
-00017df0: 6973 2064 6566 6175 6c74 6c79 2065 6e63  is defaultly enc
-00017e00: 6f64 6564 2074 6f20 686f 6c64 2069 6e74  oded to hold int
-00017e10: 6567 6572 7320 7b31 7d2e 2049 6622 0d0a  egers {1}. If"..
-00017e20: 2020 2020 2020 2020 2020 2220 7468 6520            " the 
-00017e30: 6175 746f 2d63 6174 6567 6f72 697a 6174  auto-categorizat
-00017e40: 696f 6e20 646f 6573 206e 6f74 2066 6974  ion does not fit
-00017e50: 2074 6865 2072 6561 6c20 7661 6c75 6573   the real values
-00017e60: 220d 0a20 2020 2020 2020 2020 2022 206f  "..          " o
-00017e70: 6620 666c 6f77 2072 616e 6765 732c 2070  f flow ranges, p
-00017e80: 6c65 6173 6520 7365 7420 7468 6520 7261  lease set the ra
-00017e90: 6e67 6520 6f66 2074 6865 2072 6561 6c20  nge of the real 
-00017ea0: 666c 6f77 2076 616c 7565 7322 0d0a 2020  flow values"..  
-00017eb0: 2020 2020 2020 2020 2220 7669 6120 7061          " via pa
-00017ec0: 7261 6d20 6076 616c 7565 7360 206f 7220  ram `values` or 
-00017ed0: 606c 6162 656c 5f76 616c 7565 7360 2e22  `label_values`."
-00017ee0: 0d0a 2020 2020 2020 2020 2020 2920 0d0a  ..          ) ..
-00017ef0: 2020 2020 793d 6368 6563 6b5f 7928 200d      y=check_y( .
-00017f00: 0a20 2020 2020 2020 2079 2c20 0d0a 2020  .        y, ..  
-00017f10: 2020 2020 2020 696e 7075 745f 6e61 6d65        input_name
-00017f20: 3d22 2046 6c6f 7720 6172 7261 7920 2779  =" Flow array 'y
-00017f30: 2722 2c20 0d0a 2020 2020 2020 2020 746f  '", ..        to
-00017f40: 5f66 7261 6d65 3d54 7275 650d 0a20 2020  _frame=True..   
-00017f50: 2020 2020 2029 0d0a 2020 2020 6966 2076       )..    if v
-00017f60: 616c 7565 7320 6973 204e 6f6e 653a 0d0a  alues is None:..
-00017f70: 2020 2020 2020 2020 6d73 6720 3d20 2822          msg = ("
-00017f80: 4d69 7373 696e 6720 7661 6c75 6573 2066  Missing values f
-00017f90: 6f72 2063 6174 6567 6f72 697a 696e 6720  or categorizing 
-00017fa0: 2779 273b 2074 6865 206e 756d 6265 7220  'y'; the number 
-00017fb0: 6f66 220d 0a20 2020 2020 2020 2020 2020  of"..           
-00017fc0: 2020 2020 2022 206f 6363 7572 656e 6365       " occurence
-00017fd0: 2069 6e20 7468 6520 7461 7267 6574 2069   in the target i
-00017fe0: 7320 6865 6e63 6566 6f72 7468 206e 6f74  s henceforth not
-00017ff0: 2061 6c6c 6f77 6564 2e22 0d0a 2020 2020   allowed."..    
-00018000: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-00018010: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-00018020: 7761 726e 2822 5661 6c75 6573 2061 7265  warn("Values are
-00018030: 206e 6f74 2073 6574 2e20 5468 6520 6e65   not set. The ne
-00018040: 7720 7665 7273 696f 6e20 646f 6573 206e  w version does n
-00018050: 6f74 2220 0d0a 2020 2020 2020 2020 2020  ot" ..          
-00018060: 2020 2020 2020 2020 2020 2020 2220 746f              " to
-00018070: 6c65 7261 7465 2074 6865 206e 756d 6265  lerate the numbe
-00018080: 7220 6f66 206f 6363 7572 7265 6e63 6520  r of occurrence 
-00018090: 746f 2062 6520 7573 6564 2e22 0d0a 2020  to be used."..  
-000180a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000180b0: 2020 2020 2220 5072 6f76 6964 6520 7468      " Provide th
-000180c0: 6520 6c69 7374 206f 6620 666c 6f77 2076  e list of flow v
-000180d0: 616c 7565 7320 696e 7374 6561 642e 222c  alues instead.",
-000180e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000180f0: 2020 2020 2020 2020 4465 7072 6563 6174          Deprecat
-00018100: 696f 6e57 6172 6e69 6e67 2029 0d0a 2020  ionWarning )..  
-00018110: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00018120: 4572 726f 7220 286d 7367 290d 0a20 2020  Error (msg)..   
-00018130: 2020 2020 200d 0a20 2020 2065 6c69 6620       ..    elif 
-00018140: 7661 6c75 6573 2069 7320 6e6f 7420 4e6f  values is not No
-00018150: 6e65 3a20 0d0a 2020 2020 2020 2020 6966  ne: ..        if
-00018160: 2069 7369 6e73 7461 6e63 6528 7661 6c75   isinstance(valu
-00018170: 6573 2c20 2028 696e 742c 2066 6c6f 6174  es,  (int, float
-00018180: 2929 3a20 0d0a 2020 2020 2020 2020 2020  )): ..          
-00018190: 2079 203d 2020 6361 7465 676f 7269 7a65   y =  categorize
-000181a0: 5f74 6172 6765 7428 7920 2c20 6c61 6265  _target(y , labe
-000181b0: 6c73 203d 2069 6e74 2876 616c 7565 7329  ls = int(values)
-000181c0: 2029 0d0a 2020 2020 2020 2020 2020 2077   )..           w
-000181d0: 6172 6e69 6e67 732e 7761 726e 286d 7367  arnings.warn(msg
-000181e0: 2e66 6f72 6d61 7428 7661 6c75 6573 2c20  .format(values, 
-000181f0: 6e70 2e75 6e69 7175 6520 2879 2920 2929  np.unique (y) ))
-00018200: 0d0a 2020 2020 2020 2020 2020 2076 616c  ..           val
-00018210: 7565 7320 3d20 6e70 2e75 6e69 7175 6520  ues = np.unique 
-00018220: 2879 290d 0a20 2020 2020 2020 200d 0a20  (y)..        .. 
-00018230: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-00018240: 7374 616e 6365 2876 616c 7565 732c 2028  stance(values, (
-00018250: 6c69 7374 2c20 7475 706c 652c 206e 702e  list, tuple, np.
-00018260: 6e64 6172 7261 7929 293a 0d0a 2020 2020  ndarray)):..    
-00018270: 2020 2020 2020 2020 7920 3d20 6e70 2e75          y = np.u
-00018280: 6e69 7175 6528 7929 200d 0a20 2020 2020  nique(y) ..     
-00018290: 2020 2020 2020 2069 6620 6c65 6e28 7661         if len(va
-000182a0: 6c75 6573 2921 3d6c 656e 2879 293a 200d  lues)!=len(y): .
-000182b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000182c0: 2077 6172 6e69 6e67 732e 7761 726e 2822   warnings.warn("
-000182d0: 5369 7a65 206f 6620 756e 6971 7565 2069  Size of unique i
-000182e0: 6465 6e74 6966 6965 7220 636c 6173 7320  dentifier class 
-000182f0: 6c61 6265 6c73 220d 0a20 2020 2020 2020  labels"..       
-00018300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018310: 2020 2020 2020 2022 2061 6e64 2074 6865         " and the
-00018320: 2067 6976 656e 2076 616c 7565 7320 6d69   given values mi
-00018330: 6768 7420 6265 2063 6f6e 7369 7374 656e  ght be consisten
-00018340: 742e 220d 0a20 2020 2020 2020 2020 2020  t."..           
-00018350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018360: 2020 2066 2220 4964 656e 6669 6572 2073     f" Idenfier s
-00018370: 697a 6573 203d 207b 6c65 6e28 7929 7d20  izes = {len(y)} 
-00018380: 7768 6572 6561 7320 6769 7665 6e20 220d  whereas given ".
-00018390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000183a0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000183b0: 2220 7661 6c75 6573 206c 656e 6774 6820  " values length 
-000183c0: 6172 6520 3d7b 6c65 6e28 7661 6c75 6573  are ={len(values
-000183d0: 297d 2e20 5769 6c6c 220d 0a20 2020 2020  )}. Will"..     
-000183e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000183f0: 2020 2020 2020 2020 2022 2075 7365 2074           " use t
-00018400: 6865 2075 6e69 7175 6520 6964 656e 7469  he unique identi
-00018410: 6669 6572 206c 6162 656c 7320 696e 7374  fier labels inst
-00018420: 6561 642e 2229 0d0a 2020 2020 2020 2020  ead.")..        
-00018430: 2020 2020 2020 2020 7661 6c75 6573 203d          values =
-00018440: 2079 200d 0a20 2020 2020 2020 2020 2020   y ..           
-00018450: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00018460: 2020 2079 203d 2063 6174 6567 6f72 697a     y = categoriz
-00018470: 655f 666c 6f77 2879 2c20 7661 6c75 6573  e_flow(y, values
-00018480: 2c20 636c 6173 7365 733d 636c 6173 7365  , classes=classe
-00018490: 7320 2029 0d0a 2020 2020 2020 2020 656c  s  )..        el
-000184a0: 7365 203a 200d 0a20 2020 2020 2020 2020  se : ..         
-000184b0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000184c0: 726f 7228 227b 7479 7065 2028 7661 6c75  ror("{type (valu
-000184d0: 6573 292e 5f5f 6e61 6d65 5f5f 2172 7d20  es).__name__!r} 
-000184e0: 6973 206e 6f74 2061 6c6c 6f77 220d 0a20  is not allow".. 
-000184f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018500: 2020 2020 2020 2020 2020 2020 2220 4578              " Ex
-00018510: 7065 6374 2061 206c 6973 7420 6f66 2069  pect a list of i
-00018520: 6e74 6567 6572 732e 2229 0d0a 2020 2020  ntegers.")..    
-00018530: 2020 2020 2020 2020 0d0a 2020 2020 636c          ..    cl
-00018540: 6173 7365 7320 3d20 636c 6173 7365 7320  asses = classes 
-00018550: 6f72 2076 616c 7565 7320 0d0a 2020 2020  or values ..    
-00018560: 7265 7475 726e 2079 2c20 636c 6173 7365  return y, classe
-00018570: 7320 0d0a 200d 0a40 6361 746d 6170 666c  s .. ..@catmapfl
-00018580: 6f77 3228 6361 745f 636c 6173 7365 733d  ow2(cat_classes=
-00018590: 5b27 4652 3027 2c20 2746 5231 272c 2027  ['FR0', 'FR1', '
-000185a0: 4652 3227 2c20 2746 5233 275d 2923 2c20  FR2', 'FR3'])#, 
-000185b0: 2746 5234 275d 2029 0d0a 6465 6620 6361  'FR4'] )..def ca
-000185c0: 7465 676f 7269 7a65 5f66 6c6f 7728 0d0a  tegorize_flow(..
-000185d0: 2020 2020 2020 2020 7461 7267 6574 3a20          target: 
-000185e0: 5365 7269 6573 207c 2041 7272 6179 4c69  Series | ArrayLi
-000185f0: 6b65 5b54 5d20 2c0d 0a20 2020 2020 2020  ke[T] ,..       
-00018600: 2066 6c6f 775f 7661 6c75 6573 3a20 4c69   flow_values: Li
-00018610: 7374 205b 666c 6f61 745d 2c0d 0a20 2020  st [float],..   
-00018620: 2020 2020 202a 2a6b 7761 7267 730d 0a20       **kwargs.. 
-00018630: 2020 2029 202d 3e20 5475 706c 655b 204c     ) -> Tuple[ L
-00018640: 6973 745b 666c 6f61 745d 2c20 542c 204c  ist[float], T, L
-00018650: 6973 745b 7374 725d 5d3a 200d 0a20 2020  ist[str]]: ..   
-00018660: 2022 2222 200d 0a20 2020 2043 6174 6567   """ ..    Categ
-00018670: 6f72 697a 6520 6066 6c6f 7760 2069 6e74  orize `flow` int
-00018680: 6f20 6469 6666 6572 656e 7420 636c 6173  o different clas
-00018690: 7365 732e 2049 6620 7468 6520 6f70 7469  ses. If the opti
-000186a0: 6f6e 616c 0d0a 2020 2020 6066 6c6f 775f  onal..    `flow_
-000186b0: 636c 6173 7365 7360 2020 6172 6775 6d65  classes`  argume
-000186c0: 6e74 2069 7320 6769 7665 6e2c 2069 7420  nt is given, it 
-000186d0: 7368 6f75 6c64 2062 6520 6572 6173 6564  should be erased
-000186e0: 2074 6865 0d0a 2020 2020 6063 6174 5f63   the..    `cat_c
-000186f0: 6c61 7373 6573 6020 6172 6775 6d65 6e74  lasses` argument
-00018700: 206f 6620 6465 636f 726f 7261 746f 7220   of decororator 
-00018710: 6064 6563 6f2e 6361 746d 6170 666c 6f77  `deco.catmapflow
-00018720: 602e 0d0a 2020 2020 0d0a 2020 2020 5061  `...    ..    Pa
-00018730: 7261 6d65 7465 7273 200d 0a20 2020 202d  rameters ..    -
-00018740: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
-00018750: 2074 6172 6765 743a 2061 7272 6179 2d6c   target: array-l
-00018760: 696b 652c 2070 616e 6461 732e 5365 7269  ike, pandas.Seri
-00018770: 6573 2c20 0d0a 2020 2020 2020 2020 466c  es, ..        Fl
-00018780: 6f77 2061 7272 6179 2074 6f20 6265 2063  ow array to be c
-00018790: 6174 6567 6f72 697a 6564 0d0a 2020 2020  ategorized..    
-000187a0: 0d0a 2020 2020 666c 6f77 5f76 616c 7565  ..    flow_value
-000187b0: 733a 206c 6973 7420 6f66 2073 7472 200d  s: list of str .
-000187c0: 0a20 2020 2020 2020 2056 616c 7565 7320  .        Values 
-000187d0: 666f 7220 666c 6f77 2063 6174 6567 6f72  for flow categor
-000187e0: 697a 6174 696f 6e3b 2069 7420 6469 7374  ization; it dist
-000187f0: 7269 6275 7465 7320 7468 6520 666c 6f77  ributes the flow
-00018800: 2076 616c 7565 7320 6173 0d0a 2020 2020   values as..    
-00018810: 2020 2020 6e75 6d65 7269 6361 6c20 7661      numerical va
-00018820: 6c75 6573 2e20 466f 7220 696e 7374 616e  lues. For instan
-00018830: 6365 2063 616e 2062 6520 7261 6e67 6564  ce can be ranged
-00018840: 2061 7320 6120 7475 706c 6520 6f66 2062   as a tuple of b
-00018850: 6f75 6e64 7320 0d0a 2020 2020 2020 2020  ounds ..        
-00018860: 6173 2062 656c 6f77 203a 3a20 0d0a 2020  as below :: ..  
-00018870: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00018880: 666c 6f77 5f76 616c 7565 733d 205b 302e  flow_values= [0.
-00018890: 302c 205b 302e 302c 2033 2e30 5d2c 205b  0, [0.0, 3.0], [
-000188a0: 332e 302c 2036 2e30 5d2c 205b 362e 302c  3.0, 6.0], [6.0,
-000188b0: 2031 302e 305d 2c20 3130 2e30 5d20 2831   10.0], 10.0] (1
-000188c0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-000188d0: 0a20 2020 2020 2020 206f 7220 6974 2063  .        or it c
-000188e0: 616e 2061 6c73 6f20 6163 6365 7074 2074  an also accept t
-000188f0: 6865 206c 6973 7420 6f66 2069 6e74 6567  he list of integ
-00018900: 6572 206c 6162 656c 2069 6465 6e74 6966  er label identif
-00018910: 6965 7273 2061 733a 3a0d 0a20 2020 2020  iers as::..     
-00018920: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00018930: 2020 2020 2066 6c6f 775f 7661 6c75 6573       flow_values
-00018940: 203d 5b30 2e20 2c20 332e 2c20 362e 2c20   =[0. , 3., 6., 
-00018950: 3130 2e5d 2028 3229 0d0a 2020 2020 2020  10.] (2)..      
-00018960: 2020 0d0a 2020 2020 2020 2020 466f 7220    ..        For 
-00018970: 696e 7374 616e 6365 2072 756e 696e 6720  instance runing 
-00018980: 7468 6520 7374 6570 2028 3229 2073 686f  the step (2) sho
-00018990: 7564 2063 6f6e 7665 7274 2074 6865 2066  ud convert the f
-000189a0: 6c6f 7720 7261 7465 2062 6f75 6e64 7320  low rate bounds 
-000189b0: 746f 200d 0a20 2020 2020 2020 2072 6561  to ..        rea
-000189c0: 6368 2074 6865 2073 7465 7020 2831 292e  ch the step (1).
-000189d0: 2054 6865 2061 7272 616e 6765 6d65 6e74   The arrangement
-000189e0: 206f 6620 7468 6520 666c 6f77 2072 6174   of the flow rat
-000189f0: 6520 6f62 6579 7320 736f 6d65 2063 7269  e obeys some cri
-00018a00: 7465 7269 6120 0d0a 2020 2020 2020 2020  teria ..        
-00018a10: 7768 6963 6820 6465 7065 6e64 206f 6620  which depend of 
-00018a20: 7468 6520 7479 7065 7320 6f66 2068 7964  the types of hyd
-00018a30: 7261 756c 6963 2073 7973 7465 6d20 7265  raulic system re
-00018a40: 7175 6972 6564 2061 6363 6f72 6469 6e67  quired according
-00018a50: 2074 6f20 7468 650d 0a20 2020 2020 2020   to the..       
-00018a60: 206e 756d 6265 7220 6f66 2069 6e68 6162   number of inhab
-00018a70: 6974 616e 7473 206c 6976 696e 6720 6f6e  itants living on
-00018a80: 2061 2073 7572 7665 7920 6c6f 6361 6c69   a survey locali
-00018a90: 7479 2f76 696c 6c61 6765 7320 6f72 2074  ty/villages or t
-00018aa0: 6f77 6e2e 0d0a 2020 2020 2020 2020 5468  own...        Th
-00018ab0: 6520 636f 6d6d 6f6e 2072 6571 7565 7374  e common request
-00018ac0: 2066 6c6f 7720 7261 7465 2064 7572 696e   flow rate durin
-00018ad0: 6720 7468 6520 6361 6d70 6169 676e 7320  g the campaigns 
-00018ae0: 666f 7220 6472 696e 6c69 6e67 200d 0a20  for drinling .. 
-00018af0: 2020 2020 2020 2077 6174 6572 2073 7570         water sup
-00018b00: 706c 7920 6361 6e20 6265 2020 6f72 6761  ply can be  orga
-00018b10: 6e69 7a65 6420 6173 2066 6f6c 6c6f 773a  nized as follow:
-00018b20: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
-00018b30: 0a20 2020 2020 2020 2020 2020 2066 6c6f  .            flo
-00018b40: 775f 7661 6c75 6573 203d 5b30 2c20 2031  w_values =[0,  1
-00018b50: 2c20 2033 202c 2031 3020 205d 0d0a 2020  ,  3 , 10  ]..  
-00018b60: 2020 2020 2020 2020 2020 636c 6173 7365            classe
-00018b70: 7320 3d20 5b27 4652 3027 2c20 2746 5231  s = ['FR0', 'FR1
-00018b80: 272c 2027 4652 3227 2c20 2746 5233 275d  ', 'FR2', 'FR3']
-00018b90: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
-00018ba0: 7768 6572 6520 3a0d 0a20 2020 2020 2020  where :..       
-00018bb0: 2020 2020 202d 2060 6046 5230 6060 2065       - ``FR0`` e
-00018bc0: 7175 616c 7320 746f 2076 616c 7565 7320  quals to values 
-00018bd0: 3d30 2020 2d3e 2064 7279 2062 6f72 6568  =0  -> dry boreh
-00018be0: 6f6c 6573 200d 0a20 2020 2020 2020 2020  oles ..         
-00018bf0: 2020 202d 2060 6046 5231 6060 2065 7175     - ``FR1`` equ
-00018c00: 616c 7320 746f 2076 616c 7565 7320 6265  als to values be
-00018c10: 7477 6565 6e20 2030 2d31 2830 3c20 7661  tween  0-1(0< va
-00018c20: 6c75 653c 3d31 2920 666f 7220 5669 6c6c  lue<=1) for Vill
-00018c30: 6167 6520 0d0a 2020 2020 2020 2020 2020  age ..          
-00018c40: 2020 2020 2020 6879 6472 6175 6c69 6320        hydraulic 
-00018c50: 7379 7374 656d 7320 2856 4829 0d0a 2020  systems (VH)..  
-00018c60: 2020 2020 2020 2020 2020 2d20 6060 4652            - ``FR
-00018c70: 3260 6020 6571 7561 6c73 2074 6f20 7661  2`` equals to va
-00018c80: 6c75 6573 2062 6574 7765 656e 2020 312d  lues between  1-
-00018c90: 3120 2831 3c20 7661 6c75 653c 3d33 2920  1 (1< value<=3) 
-00018ca0: 666f 7220 696d 7072 6f76 6564 2020 0d0a  for improved  ..
-00018cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018cc0: 7669 6c6c 6167 6520 6879 6472 6175 6c69  village hydrauli
-00018cd0: 6320 7379 7374 656d 2028 4956 4829 0d0a  c system (IVH)..
-00018ce0: 2020 2020 2020 2020 2020 2020 2d20 6060              - ``
-00018cf0: 4652 3360 6020 6772 6561 7468 6572 2074  FR3`` greather t
-00018d00: 6861 6e20 3320 283e 3329 2066 6f72 2075  han 3 (>3) for u
-00018d10: 7262 616e 2068 7964 7261 756c 6963 2073  rban hydraulic s
-00018d20: 7973 7465 6d20 2855 4829 0d0a 2020 2020  ystem (UH)..    
-00018d30: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00018d40: 2020 2020 2020 5265 6665 7220 746f 205b        Refer to [
-00018d50: 315d 5f20 666f 7220 6d6f 7265 2064 6574  1]_ for more det
-00018d60: 6169 6c73 2e20 0d0a 2020 2020 2020 2020  ails. ..        
-00018d70: 0d0a 2020 2020 636c 6173 7365 733a 206c  ..    classes: l
-00018d80: 6973 7420 6f66 2073 7472 202c 200d 0a20  ist of str , .. 
-00018d90: 2020 2020 2020 206c 6974 6572 616c 206c         literal l
-00018da0: 6162 656c 7320 6f66 2063 6174 6567 6f72  abels of categor
-00018db0: 697a 6564 2066 6c6f 7720 7261 7465 732e  ized flow rates.
-00018dc0: 2049 6620 6769 7665 6e2c 2073 686f 756c   If given, shoul
-00018dd0: 6420 6265 200d 0a20 2020 2020 2020 2063  d be ..        c
-00018de0: 6f6e 7369 7374 656e 7420 7769 7468 2074  onsistent with t
-00018df0: 6865 2073 697a 6520 6f66 2060 666c 6f77  he size of `flow
-00018e00: 5f76 616c 7565 7360 270d 0a20 2020 200d  _values`'..    .
-00018e10: 0a20 2020 2020 2020 200d 0a20 2020 2052  .        ..    R
-00018e20: 6574 7572 6e73 200d 0a20 2020 202d 2d2d  eturns ..    ---
-00018e30: 2d2d 2d2d 2d2d 0d0a 2020 2020 286e 6577  ------..    (new
-00018e40: 5f66 6c6f 775f 7661 6c75 6573 2c20 7461  _flow_values, ta
-00018e50: 7267 6574 2c20 636c 6173 7365 7329 0d0a  rget, classes)..
-00018e60: 2020 2020 2020 2020 2d20 6060 6e65 775f          - ``new_
-00018e70: 666c 6f77 5f76 616c 7565 7360 603a 2049  flow_values``: I
-00018e80: 7465 7261 626c 6520 6f62 6a65 6374 2061  terable object a
-00018e90: 7320 7479 7065 2028 3229 200d 0a20 2020  s type (2) ..   
-00018ea0: 2020 2020 202d 2060 6074 6172 6765 7460       - ``target`
-00018eb0: 603a 2052 6177 2066 6c6f 7720 6974 6572  `: Raw flow iter
-00018ec0: 6162 6c65 206f 626a 6563 7420 746f 2062  able object to b
-00018ed0: 6520 6361 7465 676f 7269 7a65 640d 0a20  e categorized.. 
-00018ee0: 2020 2020 2020 202d 2060 6063 6c61 7373         - ``class
-00018ef0: 6573 6060 3a20 4966 2067 6976 656e 202c  es``: If given ,
-00018f00: 2073 6565 2060 6063 6c61 7373 6573 6060   see ``classes``
-00018f10: 2070 6172 616d 732e 200d 0a20 2020 2020   params. ..     
-00018f20: 2020 2020 2020 200d 0a20 2020 2052 6566         ..    Ref
-00018f30: 6572 656e 6365 7320 0d0a 2020 2020 2d2d  erences ..    --
-00018f40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
-00018f50: 202e 2e20 5b31 5d20 4b6f 7561 6469 6f2c   .. [1] Kouadio,
-00018f60: 204b 2e4c 2e2c 204b 6f75 616d 652c 204c   K.L., Kouame, L
-00018f70: 2e4e 2e2c 2044 7269 7373 612c 2043 2e2c  .N., Drissa, C.,
-00018f80: 204d 692c 2042 2e2c 204b 6f75 616d 656c   Mi, B., Kouamel
-00018f90: 616e 2c20 4b2e 532e 2c20 0d0a 2020 2020  an, K.S., ..    
-00018fa0: 2020 2020 476e 6f6c 6562 612c 2053 2e50      Gnoleba, S.P
-00018fb0: 2e44 2e2c 205a 6861 6e67 2c20 482e 2c20  .D., Zhang, H., 
-00018fc0: 6574 2061 6c2e 2028 3230 3232 2920 4772  et al. (2022) Gr
-00018fd0: 6f75 6e64 7761 7465 7220 466c 6f77 2052  oundwater Flow R
-00018fe0: 6174 6520 0d0a 2020 2020 2020 2020 5072  ate ..        Pr
-00018ff0: 6564 6963 7469 6f6e 2066 726f 6d20 4765  ediction from Ge
-00019000: 6fe2 8090 456c 6563 7472 6963 616c 2046  o...Electrical F
-00019010: 6561 7475 7265 7320 7573 696e 6720 5375  eatures using Su
-00019020: 7070 6f72 7420 5665 6374 6f72 204d 6163  pport Vector Mac
-00019030: 6869 6e65 732e 200d 0a20 2020 2020 2020  hines. ..       
-00019040: 2057 6174 6572 2052 6573 6f75 722e 2052   Water Resour. R
-00019050: 6573 2e20 3a64 6f69 3a60 3130 2e31 3032  es. :doi:`10.102
-00019060: 392f 3230 3231 7772 3033 3136 3233 600d  9/2021wr031623`.
-00019070: 0a20 2020 2020 2020 200d 0a20 2020 202e  .        ..    .
-00019080: 2e20 5b32 5d20 4b72 612c 204b 2e4a 2e2c  . [2] Kra, K.J.,
-00019090: 204b 6f66 6669 2c20 592e 532e 4b2e 2c20   Koffi, Y.S.K., 
-000190a0: 416c 6c61 2c20 4b2e 412e 2026 204b 6f75  Alla, K.A. & Kou
-000190b0: 6164 696f 2c20 412e 462e 2028 3230 3136  adio, A.F. (2016
-000190c0: 2920 5072 6f6a 6574 7320 0d0a 2020 2020  ) Projets ..    
-000190d0: 2020 2020 64e2 8099 c3a9 6d65 7267 656e      d.....mergen
-000190e0: 6365 2070 6f73 742d 6372 6973 6520 6574  ce post-crise et
-000190f0: 2064 6973 7061 7269 74c3 a920 7465 7272   disparit.. terr
-00019100: 6974 6f72 6961 6c65 2065 6e20 43c3 b474  itoriale en C..t
-00019110: 6520 64e2 8099 4976 6f69 7265 2e20 0d0a  e d...Ivoire. ..
-00019120: 2020 2020 2020 2020 4c65 7320 4361 682e          Les Cah.
-00019130: 2064 7520 4345 4c48 544f 2c20 322c 2036   du CELHTO, 2, 6
-00019140: 3038 e280 9336 3234 2e0d 0a20 2020 2020  08...624...     
-00019150: 2020 200d 0a20 2020 2020 2020 200d 0a20     ..        .. 
-00019160: 2020 2022 2222 0d0a 2020 2020 636c 6173     """..    clas
-00019170: 7365 7320 3d20 206b 7761 7267 732e 706f  ses =  kwargs.po
-00019180: 7028 2763 6c61 7373 6573 272c 204e 6f6e  p('classes', Non
-00019190: 6529 0d0a 0d0a 2020 2020 6e65 775f 666c  e)....    new_fl
-000191a0: 6f77 5f76 616c 7565 7320 3d20 5b5d 0d0a  ow_values = []..
-000191b0: 2020 2020 696e 7369 6465 5f69 6e74 6572      inside_inter
-000191c0: 5f66 6c61 673d 2046 616c 7365 0d0a 2020  _flag= False..  
-000191d0: 2020 0d0a 2020 2020 6966 2069 7369 6e73    ..    if isins
-000191e0: 7461 6e63 6528 666c 6f77 5f76 616c 7565  tance(flow_value
-000191f0: 732c 2028 7475 706c 652c 206e 702e 6e64  s, (tuple, np.nd
-00019200: 6172 7261 7929 293a 200d 0a20 2020 2020  array)): ..     
-00019210: 2020 2066 6c6f 775f 7661 6c75 6573 203d     flow_values =
-00019220: 6c69 7374 2866 6c6f 775f 7661 6c75 6573  list(flow_values
-00019230: 290d 0a20 2020 2023 204c 6f6f 7020 616e  )..    # Loop an
-00019240: 6420 6669 6e64 200d 0a20 2020 2066 6f72  d find ..    for
-00019250: 206a 6a2c 205f 6974 6572 2069 6e20 656e   jj, _iter in en
-00019260: 756d 6572 6174 6528 666c 6f77 5f76 616c  umerate(flow_val
-00019270: 7565 7329 203a 200d 0a20 2020 2020 2020  ues) : ..       
-00019280: 2069 6620 6973 696e 7374 616e 6365 285f   if isinstance(_
-00019290: 6974 6572 2c20 286c 6973 742c 2074 7570  iter, (list, tup
-000192a0: 6c65 2c20 6e70 2e6e 6461 7272 6179 2929  le, np.ndarray))
-000192b0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-000192c0: 696e 7369 6465 5f69 6e74 6572 5f66 6c61  inside_inter_fla
-000192d0: 6720 3d20 5472 7565 200d 0a20 2020 2020  g = True ..     
-000192e0: 2020 2020 2020 2066 6c6f 775f 7661 6c75         flow_valu
-000192f0: 6573 5b6a 6a5d 3d20 6c69 7374 285f 6974  es[jj]= list(_it
-00019300: 6572 290d 0a20 0d0a 2020 2020 6966 2069  er).. ..    if i
-00019310: 6e73 6964 655f 696e 7465 725f 666c 6167  nside_inter_flag
-00019320: 3a20 0d0a 2020 2020 2020 2020 6e65 775f  : ..        new_
-00019330: 666c 6f77 5f76 616c 7565 7320 3d66 6c6f  flow_values =flo
-00019340: 775f 7661 6c75 6573 200d 0a20 2020 200d  w_values ..    .
-00019350: 0a20 2020 2069 6620 696e 7369 6465 5f69  .    if inside_i
-00019360: 6e74 6572 5f66 6c61 6720 6973 2046 616c  nter_flag is Fal
-00019370: 7365 3a20 0d0a 2020 2020 2020 2020 666c  se: ..        fl
-00019380: 6f77 5f76 616c 7565 733d 2073 6f72 7465  ow_values= sorte
-00019390: 6428 666c 6f77 5f76 616c 7565 7329 0d0a  d(flow_values)..
-000193a0: 2020 2020 2020 2020 2320 6966 2030 2e20          # if 0. 
-000193b0: 696e 2066 6c6f 775f 7661 6c75 6573 203a  in flow_values :
-000193c0: 200d 0a20 2020 2020 2020 2023 2020 2020   ..        #    
-000193d0: 206e 6577 5f66 6c6f 775f 7661 6c75 6573   new_flow_values
-000193e0: 2e61 7070 656e 6428 302e 2920 0d0a 2020  .append(0.) ..  
-000193f0: 2020 2020 2020 666f 7220 7373 2c20 7661        for ss, va
-00019400: 6c20 696e 2065 6e75 6d65 7261 7465 2866  l in enumerate(f
-00019410: 6c6f 775f 7661 6c75 6573 2920 3a20 0d0a  low_values) : ..
-00019420: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00019430: 7320 3d3d 3020 3a20 0d0a 2020 2020 2020  s ==0 : ..      
-00019440: 2020 2020 2020 2020 2020 2361 7070 656e            #appen
-00019450: 6420 616c 7761 7973 2074 6865 2066 6972  d always the fir
-00019460: 7374 2076 616c 7565 732e 200d 0a20 2020  st values. ..   
-00019470: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
-00019480: 775f 666c 6f77 5f76 616c 7565 732e 6170  w_flow_values.ap
-00019490: 7065 6e64 2876 616c 2920 0d0a 2020 2020  pend(val) ..    
-000194a0: 2020 2020 2020 2020 2320 6966 2076 616c          # if val
-000194b0: 2021 3d30 2e20 3a20 0d0a 2020 2020 2020   !=0. : ..      
-000194c0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-000194d0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000194e0: 7661 6c20 3d3d 666c 6f77 5f76 616c 7565  val ==flow_value
-000194f0: 735b 2d31 5d3a 200d 0a20 2020 2020 2020  s[-1]: ..       
-00019500: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00019510: 5f66 6c6f 775f 7661 6c75 6573 2e61 7070  _flow_values.app
-00019520: 656e 6428 5b66 6c6f 775f 7661 6c75 6573  end([flow_values
-00019530: 5b73 732d 315d 2c20 7661 6c5d 290d 0a20  [ss-1], val]).. 
-00019540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019550: 2020 206e 6577 5f66 6c6f 775f 7661 6c75     new_flow_valu
-00019560: 6573 2e61 7070 656e 6428 7661 6c29 0d0a  es.append(val)..
-00019570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019580: 656c 7365 3a20 0d0a 2020 2020 2020 2020  else: ..        
-00019590: 2020 2020 2020 2020 2020 206e 6577 5f66             new_f
-000195a0: 6c6f 775f 7661 6c75 6573 2e61 7070 656e  low_values.appen
-000195b0: 6428 5b66 6c6f 775f 7661 6c75 6573 5b73  d([flow_values[s
-000195c0: 732d 315d 2c20 7661 6c5d 290d 0a20 0d0a  s-1], val]).. ..
-000195d0: 2020 2020 7265 7475 726e 206e 6577 5f66      return new_f
-000195e0: 6c6f 775f 7661 6c75 6573 2c20 7461 7267  low_values, targ
-000195f0: 6574 2c20 636c 6173 7365 7320 2020 2020  et, classes     
-00019600: 2020 200d 0a0d 0a40 7772 6974 6566 2872     ....@writef(r
-00019610: 6561 736f 6e3d 2777 7269 7465 272c 2066  eason='write', f
-00019620: 726f 6d5f 3d27 6466 2729 0d0a 6465 6620  rom_='df')..def 
-00019630: 6578 706f 7274 6466 2028 0d0a 2020 2020  exportdf (..    
-00019640: 6466 203a 2044 6174 6146 7261 6d65 203d  df : DataFrame =
-00019650: 4e6f 6e65 2c0d 0a20 2020 2072 6566 6f75  None,..    refou
-00019660: 743a 204f 7074 696f 6e61 6c20 5b73 7472  t: Optional [str
-00019670: 5d20 3d4e 6f6e 652c 200d 0a20 2020 2074  ] =None, ..    t
-00019680: 6f3a 204f 7074 696f 6e61 6c20 5b73 7472  o: Optional [str
-00019690: 5d20 3d4e 6f6e 652c 200d 0a20 2020 2073  ] =None, ..    s
-000196a0: 6176 6570 6174 683a 4f70 7469 6f6e 616c  avepath:Optional
-000196b0: 205b 7374 725d 203d 4e6f 6e65 2c0d 0a20   [str] =None,.. 
-000196c0: 2020 206d 6f64 6e61 6d65 3a20 7374 7220     modname: str 
-000196d0: 203d 275f 7765 7870 6f72 7465 645f 272c   ='_wexported_',
-000196e0: 200d 0a20 2020 2072 6573 6574 5f69 6e64   ..    reset_ind
-000196f0: 6578 3a20 626f 6f6c 203d 5472 7565 0d0a  ex: bool =True..
-00019700: 2920 2d3e 2054 7570 6c65 205b 4461 7461  ) -> Tuple [Data
-00019710: 4672 616d 652c 2055 6e69 6f6e 5b73 7472  Frame, Union[str
-00019720: 2c20 7374 725d 2c20 626f 6f6c 205d 3a20  , str], bool ]: 
-00019730: 0d0a 2020 2020 2222 2220 0d0a 2020 2020  ..    """ ..    
-00019740: 4578 706f 7274 2064 6174 6166 7261 6d65  Export dataframe
-00019750: 2060 6064 6660 6020 2074 6f20 6072 6566   ``df``  to `ref
-00019760: 6f75 7460 2066 696c 6573 2e20 0d0a 2020  out` files. ..  
-00019770: 2020 0d0a 2020 2020 6072 6566 6f75 7460    ..    `refout`
-00019780: 2066 696c 6520 6361 6e20 6265 2045 7863   file can be Exc
-00019790: 656c 6c20 7368 6565 7420 6669 6c65 206f  ell sheet file o
-000197a0: 7220 272e 6a73 6f6e 2720 6669 6c65 2e20  r '.json' file. 
-000197b0: 546f 2067 6574 206d 6f72 6520 6465 7461  To get more deta
-000197c0: 696c 7320 0d0a 2020 2020 6162 6f75 7420  ils ..    about 
-000197d0: 7468 6520 6077 7269 7465 6660 2064 6563  the `writef` dec
-000197e0: 6f72 6174 6f72 202c 2073 6565 203a 646f  orator , see :do
-000197f0: 633a 6077 6174 6578 2e75 7469 6c73 2e64  c:`watex.utils.d
-00019800: 6563 6f72 6174 6f72 2e77 7269 7465 6660  ecorator.writef`
-00019810: 2e20 0d0a 2020 2020 0d0a 2020 2020 3a70  . ..    ..    :p
-00019820: 6172 616d 2072 6566 6f75 743a 200d 0a20  aram refout: .. 
-00019830: 2020 2020 2020 204f 7574 7075 7420 6669         Output fi
-00019840: 6c65 6e61 6d65 2e20 4966 206e 6f74 2067  lename. If not g
-00019850: 6976 656e 2077 696c 6c20 6265 2063 7265  iven will be cre
-00019860: 6174 6564 2072 6566 6572 696e 6720 746f  ated refering to
-00019870: 2074 6865 200d 0a20 2020 2020 2020 2065   the ..        e
-00019880: 7870 6f72 7465 6420 6461 7465 2e20 0d0a  xported date. ..
-00019890: 2020 2020 2020 2020 0d0a 2020 2020 3a70          ..    :p
-000198a0: 6172 616d 2074 6f3a 2045 7870 6f72 7420  aram to: Export 
-000198b0: 7479 7065 3b20 4361 6e20 6265 2060 2e78  type; Can be `.x
-000198c0: 6c73 7860 202c 2060 2e63 7376 602c 2060  lsx` , `.csv`, `
-000198d0: 2e6a 736f 6e60 2061 6e64 2065 6c73 652e  .json` and else.
-000198e0: 0d0a 2020 2020 2020 200d 0a20 2020 203a  ..       ..    :
-000198f0: 7061 7261 6d20 7361 7665 7061 7468 3a20  param savepath: 
-00019900: 0d0a 2020 2020 2020 2020 5061 7468 2074  ..        Path t
-00019910: 6f20 7361 7665 2074 6865 2060 7265 666f  o save the `refo
-00019920: 7574 6020 6669 6c65 6e61 6d65 2e20 4966  ut` filename. If
-00019930: 206e 6f74 2067 6976 656e 0d0a 2020 2020   not given..    
-00019940: 2020 2020 7769 6c6c 2062 6520 6372 6561      will be crea
-00019950: 7465 642e 0d0a 2020 2020 3a70 6172 616d  ted...    :param
-00019960: 206d 6f64 6e61 6d65 3a20 466f 6c64 6572   modname: Folder
-00019970: 2074 6f20 686f 6c64 2074 6865 2060 7265   to hold the `re
-00019980: 666f 7574 6020 6669 6c65 2e20 4368 616e  fout` file. Chan
-00019990: 6765 2069 7420 6163 636f 7264 696e 676c  ge it accordingl
-000199a0: 792e 0d0a 2020 2020 2020 2020 0d0a 2020  y...        ..  
-000199b0: 2020 3a72 6574 7572 6e73 3a20 0d0a 2020    :returns: ..  
-000199c0: 2020 2020 2020 2d20 6064 665f 603a 206e        - `df_`: n
-000199d0: 6577 2064 6174 6166 7261 6d65 2074 6f20  ew dataframe to 
-000199e0: 6265 2065 7870 6f72 7465 642e 200d 0a20  be exported. .. 
-000199f0: 2020 2020 2020 200d 0a20 2020 2022 2222         ..    """
-00019a00: 0d0a 2020 2020 6966 2064 6620 6973 204e  ..    if df is N
-00019a10: 6f6e 6520 3a0d 0a20 2020 2020 2020 2077  one :..        w
-00019a20: 6172 6e69 6e67 732e 7761 726e 280d 0a20  arnings.warn(.. 
-00019a30: 2020 2020 2020 2020 2020 2027 4f6e 6365             'Once
-00019a40: 2060 6064 6660 6020 6172 6775 6d65 6e74   ``df`` argument
-00019a50: 7320 696e 2064 6563 6f72 6174 6f72 203a  s in decorator :
-00019a60: 6063 6c61 7373 3a7e 6465 636f 7261 746f  `class:~decorato
-00019a70: 722e 7772 6974 6566 6027 0d0a 2020 2020  r.writef`'..    
-00019a80: 2020 2020 2020 2020 2720 6973 2073 656c          ' is sel
-00019a90: 6563 7465 642e 2054 6865 206d 6169 6e20  ected. The main 
-00019aa0: 7479 7065 206f 6620 6669 6c65 2072 6561  type of file rea
-00019ab0: 6479 2074 6f20 6265 2077 7269 7474 656e  dy to be written
-00019ac0: 204d 5553 5420 6265 2027 0d0a 2020 2020   MUST be '..    
-00019ad0: 2020 2020 2020 2020 2761 2070 642e 4461          'a pd.Da
-00019ae0: 7461 4672 616d 6520 666f 726d 6174 2e20  taFrame format. 
-00019af0: 4966 206e 6f74 2061 6e20 6572 726f 7220  If not an error 
-00019b00: 7261 6973 6573 2e20 506c 6561 7365 2072  raises. Please r
-00019b10: 6566 6572 2074 6f20 270d 0a20 2020 2020  efer to '..     
-00019b20: 2020 2020 2020 2027 3a64 6f63 3a60 7e2e         ':doc:`~.
-00019b30: 7574 696c 732e 6465 636f 7261 746f 722e  utils.decorator.
-00019b40: 7772 6974 6566 6020 666f 7220 6d6f 7265  writef` for more
-00019b50: 2064 6574 6169 6c73 2e27 290d 0a20 2020   details.')..   
-00019b60: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
-00019b70: 6169 7365 2046 696c 6548 616e 646c 696e  aise FileHandlin
-00019b80: 6745 7272 6f72 280d 0a20 2020 2020 2020  gError(..       
-00019b90: 2020 2020 2027 4e6f 2064 6174 6166 7261       'No datafra
-00019ba0: 6d65 2064 6574 6563 7465 642e 2050 6c65  me detected. Ple
-00019bb0: 6173 6520 7072 6f76 6964 6564 2079 6f75  ase provided you
-00019bc0: 7220 6461 7461 4672 616d 652e 2729 0d0a  r dataFrame.')..
-00019bd0: 0d0a 2020 2020 6466 5f20 3d64 662e 636f  ..    df_ =df.co
-00019be0: 7079 2864 6565 703d 5472 7565 290d 0a20  py(deep=True).. 
-00019bf0: 2020 2069 6620 7265 7365 745f 696e 6465     if reset_inde
-00019c00: 7820 6973 2054 7275 6520 3a20 0d0a 2020  x is True : ..  
-00019c10: 2020 2020 2020 6466 5f2e 7265 7365 745f        df_.reset_
-00019c20: 696e 6465 7828 696e 706c 6163 6520 3d54  index(inplace =T
-00019c30: 7275 6529 0d0a 2020 2020 6966 2073 6176  rue)..    if sav
-00019c40: 6570 6174 6820 6973 204e 6f6e 6520 3a0d  epath is None :.
-00019c50: 0a20 2020 2020 2020 2073 6176 6570 6174  .        savepat
-00019c60: 6820 3d20 7361 7665 7061 7468 5f28 6d6f  h = savepath_(mo
-00019c70: 646e 616d 6529 0d0a 2020 2020 2020 2020  dname)..        
-00019c80: 0d0a 2020 2020 7265 7475 726e 2064 665f  ..    return df_
-00019c90: 2c20 746f 2c20 2072 6566 6f75 742c 2073  , to,  refout, s
-00019ca0: 6176 6570 6174 682c 2072 6573 6574 5f69  avepath, reset_i
-00019cb0: 6e64 6578 2020 200d 0a0d 0a64 6566 2063  ndex   ....def c
-00019cc0: 6174 6567 6f72 697a 655f 7461 7267 6574  ategorize_target
-00019cd0: 280d 0a20 2020 2020 2020 2061 7272 203a  (..        arr :
-00019ce0: 4172 7261 794c 696b 6520 7c53 6572 6965  ArrayLike |Serie
-00019cf0: 7320 2c20 2f2c 200d 0a20 2020 2020 2020  s , /, ..       
-00019d00: 2066 756e 633a 2046 203d 204e 6f6e 652c   func: F = None,
-00019d10: 2020 0d0a 2020 2020 2020 2020 6c61 6265    ..        labe
-00019d20: 6c73 3a20 696e 7420 7c20 4c69 7374 5b69  ls: int | List[i
-00019d30: 6e74 5d20 3d20 4e6f 6e65 2c20 0d0a 2020  nt] = None, ..  
-00019d40: 2020 2020 2020 7265 6e61 6d65 5f6c 6162        rename_lab
-00019d50: 656c 733a 204f 7074 696f 6e61 6c5b 7374  els: Optional[st
-00019d60: 725d 203d 204e 6f6e 652c 200d 0a20 2020  r] = None, ..   
-00019d70: 2020 2020 2063 6f65 7263 653a 626f 6f6c       coerce:bool
-00019d80: 3d46 616c 7365 2c0d 0a20 2020 2020 2020  =False,..       
-00019d90: 206f 7264 6572 3a73 7472 3d27 7374 7269   order:str='stri
-00019da0: 6374 272c 0d0a 2020 2020 2020 2020 293a  ct',..        ):
-00019db0: 200d 0a20 2020 2022 2222 2043 6174 6567   ..    """ Categ
-00019dc0: 6f72 697a 6520 6172 7261 7920 746f 2068  orize array to h
-00019dd0: 6f6c 6420 7468 6520 6769 7665 6e20 6964  old the given id
-00019de0: 656e 7469 6669 6572 206c 6162 656c 732e  entifier labels.
-00019df0: 200d 0a20 2020 200d 0a20 2020 2043 6c61   ..    ..    Cla
-00019e00: 7373 6966 6965 7220 6e75 6d65 7269 6361  ssifier numerica
-00019e10: 6c20 7661 6c75 6573 2061 6363 6f72 6469  l values accordi
-00019e20: 6e67 2074 6f20 7468 6520 6769 7665 6e20  ng to the given 
-00019e30: 6c61 6265 6c20 7661 6c75 6573 2e20 4c61  label values. La
-00019e40: 6265 6c73 200d 0a20 2020 2061 7265 2061  bels ..    are a
-00019e50: 206c 6973 7420 6f66 2069 6e74 6567 6572   list of integer
-00019e60: 7320 7768 6572 6520 6561 6368 2069 6e74  s where each int
-00019e70: 6567 6572 2069 7320 6120 6772 6f75 7020  eger is a group 
-00019e80: 6f66 2075 6e69 7175 6520 6964 656e 7469  of unique identi
-00019e90: 6669 6572 2020 0d0a 2020 2020 6f66 2061  fier  ..    of a
-00019ea0: 2073 616d 706c 6520 696e 2074 6865 2064   sample in the d
-00019eb0: 6174 6173 6574 2e20 0d0a 2020 2020 0d0a  ataset. ..    ..
-00019ec0: 2020 2020 5061 7261 6d65 7465 7273 200d      Parameters .
-00019ed0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
-00019ee0: 0d0a 2020 2020 6172 723a 2061 7272 6179  ..    arr: array
-00019ef0: 2d6c 696b 6520 7c70 616e 6461 732e 5365  -like |pandas.Se
-00019f00: 7269 6573 200d 0a20 2020 2020 2020 2061  ries ..        a
-00019f10: 7272 6179 206f 7220 7365 7269 6573 2063  rray or series c
-00019f20: 6f6e 7461 696e 696e 6720 6e75 6d65 7269  ontaining numeri
-00019f30: 6361 6c20 7661 6c75 6573 2e20 4966 2061  cal values. If a
-00019f40: 206e 6f6e 2d6e 756d 6572 6963 616c 2076   non-numerical v
-00019f50: 616c 7565 7320 0d0a 2020 2020 2020 2020  alues ..        
-00019f60: 6973 2067 6976 656e 202c 2061 6e20 6572  is given , an er
-00019f70: 726f 7273 2077 696c 6c20 7261 6973 6573  rors will raises
-00019f80: 2e20 0d0a 2020 2020 6675 6e63 3a20 4361  . ..    func: Ca
-00019f90: 6c6c 6162 6c65 2c20 0d0a 2020 2020 2020  llable, ..      
-00019fa0: 2020 4675 6e63 7469 6f6e 2074 6f20 6361    Function to ca
-00019fb0: 7465 676f 7269 7a65 2074 6865 2074 6172  tegorize the tar
-00019fc0: 6765 7420 792e 2020 0d0a 2020 2020 6c61  get y.  ..    la
-00019fd0: 6265 6c73 3a20 696e 742c 206c 6973 7420  bels: int, list 
-00019fe0: 6f66 2069 6e74 2c20 0d0a 2020 2020 2020  of int, ..      
-00019ff0: 2020 6966 2061 6e20 696e 7465 6765 7220    if an integer 
-0001a000: 7661 6c75 6520 6973 2067 6976 656e 2c20  value is given, 
-0001a010: 6974 2073 686f 756c 6420 6265 2063 6f6e  it should be con
-0001a020: 7369 6465 7265 6420 6173 2074 6865 206e  sidered as the n
-0001a030: 756d 6265 7220 0d0a 2020 2020 2020 2020  umber ..        
-0001a040: 6f66 2063 6174 6567 6f72 7920 746f 2073  of category to s
-0001a050: 706c 6974 2027 7927 2e20 466f 7220 696e  plit 'y'. For in
-0001a060: 7374 616e 6365 2060 606c 6162 656c 3d33  stance ``label=3
-0001a070: 6060 2061 6e64 2061 7070 6c69 6564 206f  `` and applied o
-0001a080: 6e20 0d0a 2020 2020 2020 2020 7468 6520  n ..        the 
-0001a090: 6669 7273 7420 7465 6e20 6e75 6d62 6572  first ten number
-0001a0a0: 2c20 7468 6520 6c61 6265 6c73 2076 616c  , the labels val
-0001a0b0: 7565 7320 7368 6f75 6c64 2062 6520 6060  ues should be ``
-0001a0c0: 5b30 2c20 312c 2032 5d60 602e 200d 0a20  [0, 1, 2]``. .. 
-0001a0d0: 2020 2020 2020 2049 6620 6c61 6265 6c73         If labels
-0001a0e0: 2061 7265 2067 6976 656e 2061 7320 6120   are given as a 
-0001a0f0: 6c69 7374 2c20 6974 656d 7320 6d75 7374  list, items must
-0001a100: 2062 6520 7365 6c66 2d63 6f6e 7461 696e   be self-contain
-0001a110: 2069 6e20 7468 6520 0d0a 2020 2020 2020   in the ..      
-0001a120: 2020 7461 7267 6574 2027 7927 2e0d 0a20    target 'y'... 
-0001a130: 2020 2072 656e 616d 655f 6c61 6265 6c73     rename_labels
-0001a140: 3a20 6c69 7374 206f 6620 7374 723b 200d  : list of str; .
-0001a150: 0a20 2020 2020 2020 206c 6973 7420 6f66  .        list of
-0001a160: 2073 7472 696e 6720 6f72 2076 616c 7565   string or value
-0001a170: 7320 746f 2072 6570 6c61 6365 2074 6865  s to replace the
-0001a180: 206c 6162 656c 2069 6e74 6567 6572 2069   label integer i
-0001a190: 6465 6e74 6966 6965 722e 200d 0a20 2020  dentifier. ..   
-0001a1a0: 2063 6f65 7263 653a 2062 6f6f 6c2c 2064   coerce: bool, d
-0001a1b0: 6566 6175 6c74 203d 4661 6c73 652c 200d  efault =False, .
-0001a1c0: 0a20 2020 2020 2020 2066 6f72 6365 2074  .        force t
-0001a1d0: 6865 206e 6577 206c 6162 656c 206e 616d  he new label nam
-0001a1e0: 6573 2070 6173 7365 6420 746f 2060 7265  es passed to `re
-0001a1f0: 6e61 6d65 5f6c 6162 656c 7360 2074 6f20  name_labels` to 
-0001a200: 6170 7065 6172 2069 6e20 7468 6520 0d0a  appear in the ..
-0001a210: 2020 2020 2020 2020 7461 7267 6574 2069          target i
-0001a220: 6e63 6c75 6469 6e67 206f 7220 6e6f 7420  ncluding or not 
-0001a230: 736f 6d65 2069 6e74 6567 6572 2069 6465  some integer ide
-0001a240: 6e74 6966 6965 7220 636c 6173 7320 6c61  ntifier class la
-0001a250: 6265 6c2e 2049 6620 0d0a 2020 2020 2020  bel. If ..      
-0001a260: 2020 6063 6f65 7263 6560 2069 7320 6060    `coerce` is ``
-0001a270: 5472 7565 6060 2c20 7468 6520 7461 7267  True``, the targ
-0001a280: 6574 2061 7272 6179 2068 6f6c 6473 2074  et array holds t
-0001a290: 6865 2064 7479 7065 206f 6620 6e65 775f  he dtype of new_
-0001a2a0: 6172 7261 792e 200d 0a0d 0a20 2020 2052  array. ....    R
-0001a2b0: 6574 7572 6e0d 0a20 2020 202d 2d2d 2d2d  eturn..    -----
-0001a2c0: 2d2d 2d0d 0a20 2020 2061 7272 3a20 4172  ---..    arr: Ar
-0001a2d0: 7261 796c 696b 6520 7c70 616e 6461 732e  raylike |pandas.
-0001a2e0: 5365 7269 6573 0d0a 2020 2020 2020 2020  Series..        
-0001a2f0: 5468 6520 6361 7465 676f 7279 2061 7272  The category arr
-0001a300: 6179 2077 6974 6820 756e 6971 7565 2069  ay with unique i
-0001a310: 6465 6e74 6966 6572 206c 6162 656c 7320  dentifer labels 
-0001a320: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001a330: 4578 616d 706c 6573 200d 0a20 2020 202d  Examples ..    -
-0001a340: 2d2d 2d2d 2d2d 2d0d 0a0d 0a20 2020 203e  -------....    >
-0001a350: 3e3e 2066 726f 6d20 7761 7465 782e 7574  >> from watex.ut
-0001a360: 696c 732e 6d6c 7574 696c 7320 696d 706f  ils.mlutils impo
-0001a370: 7274 2063 6174 7461 7267 6574 200d 0a20  rt cattarget .. 
-0001a380: 2020 203e 3e3e 2064 6566 2062 696e 6675     >>> def binfu
-0001a390: 6e63 2876 293a 200d 0a20 2020 2020 2020  nc(v): ..       
-0001a3a0: 2020 2020 2069 6620 7620 3c20 3320 3a20       if v < 3 : 
-0001a3b0: 7265 7475 726e 2030 200d 0a20 2020 2020  return 0 ..     
-0001a3c0: 2020 2020 2020 2065 6c73 6520 3a20 7265         else : re
-0001a3d0: 7475 726e 2031 200d 0a20 2020 203e 3e3e  turn 1 ..    >>>
-0001a3e0: 2061 7272 203d 206e 702e 6172 616e 6765   arr = np.arange
-0001a3f0: 2028 3130 2029 0d0a 2020 2020 3e3e 3e20   (10 )..    >>> 
-0001a400: 6172 7220 0d0a 2020 2020 2e2e 2e20 6172  arr ..    ... ar
-0001a410: 7261 7928 5b30 2c20 312c 2032 2c20 332c  ray([0, 1, 2, 3,
-0001a420: 2034 2c20 352c 2036 2c20 372c 2038 2c20   4, 5, 6, 7, 8, 
-0001a430: 395d 290d 0a20 2020 203e 3e3e 2074 6172  9])..    >>> tar
-0001a440: 6765 7420 3d20 6361 7474 6172 6765 7428  get = cattarget(
-0001a450: 6172 722c 2066 756e 6320 3d62 696e 6675  arr, func =binfu
-0001a460: 6e63 290d 0a20 2020 202e 2e2e 2061 7272  nc)..    ... arr
-0001a470: 6179 285b 302c 2030 2c20 302c 2031 2c20  ay([0, 0, 0, 1, 
-0001a480: 312c 2031 2c20 312c 2031 2c20 312c 2031  1, 1, 1, 1, 1, 1
-0001a490: 5d2c 2064 7479 7065 3d69 6e74 3634 290d  ], dtype=int64).
-0001a4a0: 0a20 2020 203e 3e3e 2063 6174 7461 7267  .    >>> cattarg
-0001a4b0: 6574 2861 7272 2c20 6c61 6265 6c73 203d  et(arr, labels =
-0001a4c0: 3320 290d 0a20 2020 202e 2e2e 2061 7272  3 )..    ... arr
-0001a4d0: 6179 285b 302c 2030 2c20 302c 2031 2c20  ay([0, 0, 0, 1, 
-0001a4e0: 312c 2031 2c20 322c 2032 2c20 322c 2032  1, 1, 2, 2, 2, 2
-0001a4f0: 5d29 0d0a 2020 2020 3e3e 3e20 6172 7261  ])..    >>> arra
-0001a500: 7928 5b32 2c20 322c 2032 2c20 322c 2031  y([2, 2, 2, 2, 1
-0001a510: 2c20 312c 2031 2c20 302c 2030 2c20 305d  , 1, 1, 0, 0, 0]
-0001a520: 2920 0d0a 2020 2020 3e3e 3e20 6361 7474  ) ..    >>> catt
-0001a530: 6172 6765 7428 6172 722c 206c 6162 656c  arget(arr, label
-0001a540: 7320 3d33 202c 206f 7264 6572 203d 4e6f  s =3 , order =No
-0001a550: 6e65 2029 0d0a 2020 2020 2e2e 2e20 6172  ne )..    ... ar
-0001a560: 7261 7928 5b30 2c20 302c 2030 2c20 302c  ray([0, 0, 0, 0,
-0001a570: 2031 2c20 312c 2031 2c20 322c 2032 2c20   1, 1, 1, 2, 2, 
-0001a580: 325d 290d 0a20 2020 203e 3e3e 2063 6174  2])..    >>> cat
-0001a590: 7461 7267 6574 2861 7272 5b3a 3a2d 315d  target(arr[::-1]
-0001a5a0: 2c20 6c61 6265 6c73 203d 3320 2c20 6f72  , labels =3 , or
-0001a5b0: 6465 7220 3d4e 6f6e 6520 290d 0a20 2020  der =None )..   
-0001a5c0: 202e 2e2e 2061 7272 6179 285b 302c 2030   ... array([0, 0
-0001a5d0: 2c20 302c 2031 2c20 312c 2031 2c20 322c  , 0, 1, 1, 1, 2,
-0001a5e0: 2032 2c20 322c 2032 5d29 2023 2072 6576   2, 2, 2]) # rev
-0001a5f0: 6572 7365 2064 6f65 7320 6e6f 7420 6368  erse does not ch
-0001a600: 616e 6765 0d0a 2020 2020 3e3e 3e20 6361  ange..    >>> ca
-0001a610: 7474 6172 6765 7428 6172 722c 206c 6162  ttarget(arr, lab
-0001a620: 656c 7320 3d5b 3020 2c20 322c 2020 345d  els =[0 , 2,  4]
-0001a630: 2020 290d 0a20 2020 202e 2e2e 2061 7272    )..    ... arr
-0001a640: 6179 285b 302c 2030 2c20 302c 2032 2c20  ay([0, 0, 0, 2, 
-0001a650: 322c 2034 2c20 342c 2034 2c20 342c 2034  2, 4, 4, 4, 4, 4
-0001a660: 5d29 0d0a 0d0a 2020 2020 2222 220d 0a20  ])....    """.. 
-0001a670: 2020 2061 7272 203d 205f 6173 7365 7274     arr = _assert
-0001a680: 5f61 6c6c 5f74 7970 6573 2861 7272 2c20  _all_types(arr, 
-0001a690: 6e70 2e6e 6461 7272 6179 2c20 7064 2e53  np.ndarray, pd.S
-0001a6a0: 6572 6965 7329 200d 0a20 2020 2069 735f  eries) ..    is_
-0001a6b0: 6172 7220 3d46 616c 7365 200d 0a20 2020  arr =False ..   
-0001a6c0: 2069 6620 6973 696e 7374 616e 6365 2028   if isinstance (
-0001a6d0: 6172 722c 206e 702e 6e64 6172 7261 7920  arr, np.ndarray 
-0001a6e0: 2920 3a0d 0a20 2020 2020 2020 2061 7272  ) :..        arr
-0001a6f0: 203d 2070 642e 5365 7269 6573 2028 6172   = pd.Series (ar
-0001a700: 7220 202c 206e 616d 6520 3d20 276e 6f6e  r  , name = 'non
-0001a710: 6527 2920 0d0a 2020 2020 2020 2020 6973  e') ..        is
-0001a720: 5f61 7272 203d 5472 7565 200d 0a20 2020  _arr =True ..   
-0001a730: 2020 2020 200d 0a20 2020 2069 6620 6675       ..    if fu
-0001a740: 6e63 2069 7320 6e6f 7420 4e6f 6e65 3a20  nc is not None: 
-0001a750: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0001a760: 2020 696e 7370 6563 742e 6973 6675 6e63    inspect.isfunc
-0001a770: 7469 6f6e 2028 6675 6e63 293a 200d 0a20  tion (func): .. 
-0001a780: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001a790: 2054 7970 6545 7272 6f72 2028 0d0a 2020   TypeError (..  
-0001a7a0: 2020 2020 2020 2020 2020 2020 2020 6627                f'
-0001a7b0: 4578 7065 6374 2061 2066 756e 6374 696f  Expect a functio
-0001a7c0: 6e20 6275 7420 676f 7420 7b74 7970 6528  n but got {type(
-0001a7d0: 6675 6e63 292e 5f5f 6e61 6d65 5f5f 2172  func).__name__!r
-0001a7e0: 7d27 290d 0a20 2020 2020 2020 2020 2020  }')..           
-0001a7f0: 200d 0a20 2020 2020 2020 2061 7272 3d20   ..        arr= 
-0001a800: 6172 722e 6170 706c 7920 2866 756e 6320  arr.apply (func 
-0001a810: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-0001a820: 2020 2020 2072 6574 7572 6e20 2061 7272       return  arr
-0001a830: 2e76 616c 7565 7320 2069 6620 6973 5f61  .values  if is_a
-0001a840: 7272 2065 6c73 6520 6172 7220 2020 0d0a  rr else arr   ..
-0001a850: 2020 2020 0d0a 2020 2020 6e61 6d65 203d      ..    name =
-0001a860: 2061 7272 2e6e 616d 6520 0d0a 2020 2020   arr.name ..    
-0001a870: 6172 7220 3d20 6172 722e 7661 6c75 6573  arr = arr.values
-0001a880: 200d 0a0d 0a20 2020 2069 6620 6c61 6265   ....    if labe
-0001a890: 6c73 2069 7320 6e6f 7420 4e6f 6e65 3a20  ls is not None: 
-0001a8a0: 0d0a 2020 2020 2020 2020 6172 7220 3d20  ..        arr = 
-0001a8b0: 5f63 6174 7461 7267 6574 2028 6172 7220  _cattarget (arr 
-0001a8c0: 2c20 6c61 6265 6c73 2c20 6f72 6465 7220  , labels, order 
-0001a8d0: 3d6f 7264 6572 290d 0a20 2020 2020 2020  =order)..       
-0001a8e0: 2069 6620 7265 6e61 6d65 5f6c 6162 656c   if rename_label
-0001a8f0: 7320 6973 206e 6f74 204e 6f6e 653a 200d  s is not None: .
-0001a900: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-0001a910: 203d 2072 656e 616d 655f 6c61 6265 6c73   = rename_labels
-0001a920: 5f69 6e28 2061 7272 202c 2072 656e 616d  _in( arr , renam
-0001a930: 655f 6c61 6265 6c73 202c 2063 6f65 7263  e_labels , coerc
-0001a940: 6520 3d63 6f65 7263 6520 2920 0d0a 0d0a  e =coerce ) ....
-0001a950: 2020 2020 7265 7475 726e 2061 7272 2020      return arr  
-0001a960: 6966 2069 735f 6172 7220 656c 7365 2070  if is_arr else p
-0001a970: 642e 5365 7269 6573 2028 6172 722c 206e  d.Series (arr, n
-0001a980: 616d 6520 3d6e 616d 6520 2029 0d0a 0d0a  ame =name  )....
-0001a990: 6465 6620 7265 6e61 6d65 5f6c 6162 656c  def rename_label
-0001a9a0: 735f 696e 2028 6172 722c 206e 6577 5f6e  s_in (arr, new_n
-0001a9b0: 616d 6573 2c20 636f 6572 6365 203d 2046  ames, coerce = F
-0001a9c0: 616c 7365 293a 200d 0a20 2020 2022 2222  alse): ..    """
-0001a9d0: 2052 656e 616d 6520 6c61 6265 6c20 6279   Rename label by
-0001a9e0: 2061 206e 6577 206e 616d 6573 200d 0a20   a new names .. 
-0001a9f0: 2020 200d 0a20 2020 203a 7061 7261 6d20     ..    :param 
-0001aa00: 6172 723a 2061 7272 3a20 6172 7261 792d  arr: arr: array-
-0001aa10: 6c69 6b65 207c 7061 6e64 6173 2e53 6572  like |pandas.Ser
-0001aa20: 6965 7320 0d0a 2020 2020 2020 2020 2061  ies ..         a
-0001aa30: 7272 6179 206f 7220 7365 7269 6573 2063  rray or series c
-0001aa40: 6f6e 7461 696e 696e 6720 6e75 6d65 7269  ontaining numeri
-0001aa50: 6361 6c20 7661 6c75 6573 2e20 4966 2061  cal values. If a
-0001aa60: 206e 6f6e 2d6e 756d 6572 6963 616c 2076   non-numerical v
-0001aa70: 616c 7565 7320 0d0a 2020 2020 2020 2020  alues ..        
-0001aa80: 2069 7320 6769 7665 6e20 2c20 616e 2065   is given , an e
-0001aa90: 7272 6f72 7320 7769 6c6c 2072 6169 7365  rrors will raise
-0001aaa0: 732e 200d 0a20 2020 203a 7061 7261 6d20  s. ..    :param 
-0001aab0: 6e65 775f 6e61 6d65 733a 206c 6973 7420  new_names: list 
-0001aac0: 6f66 2073 7472 3b20 0d0a 2020 2020 2020  of str; ..      
-0001aad0: 2020 6c69 7374 206f 6620 7374 7269 6e67    list of string
-0001aae0: 206f 7220 7661 6c75 6573 2074 6f20 7265   or values to re
-0001aaf0: 706c 6163 6520 7468 6520 6c61 6265 6c20  place the label 
-0001ab00: 696e 7465 6765 7220 6964 656e 7469 6669  integer identifi
-0001ab10: 6572 2e20 0d0a 2020 2020 3a70 6172 616d  er. ..    :param
-0001ab20: 2063 6f65 7263 653a 2062 6f6f 6c2c 2064   coerce: bool, d
-0001ab30: 6566 6175 6c74 203d 4661 6c73 652c 200d  efault =False, .
-0001ab40: 0a20 2020 2020 2020 2066 6f72 6365 2074  .        force t
-0001ab50: 6865 2027 6e65 775f 6e61 6d65 7327 2074  he 'new_names' t
-0001ab60: 6f20 6170 7065 6172 2069 6e20 7468 6520  o appear in the 
-0001ab70: 7461 7267 6574 2069 6e63 6c75 6469 6e67  target including
-0001ab80: 206f 7220 6e6f 7420 736f 6d65 200d 0a20   or not some .. 
-0001ab90: 2020 2020 2020 2069 6e74 6567 6572 2069         integer i
-0001aba0: 6465 6e74 6966 6965 7220 636c 6173 7320  dentifier class 
-0001abb0: 6c61 6265 6c2e 2060 636f 6572 6365 6020  label. `coerce` 
-0001abc0: 6973 2060 6054 7275 6560 602c 2074 6865  is ``True``, the
-0001abd0: 2074 6172 6765 7420 6172 7261 7920 0d0a   target array ..
-0001abe0: 2020 2020 2020 2020 686f 6c64 2074 6865          hold the
-0001abf0: 2064 7479 7065 206f 6620 6e65 775f 6172   dtype of new_ar
-0001ac00: 7261 793b 2063 6f65 7263 696e 6720 7468  ray; coercing th
-0001ac10: 6520 6c61 6265 6c20 6e61 6d65 7320 7769  e label names wi
-0001ac20: 6c6c 206e 6f74 2079 6965 6c64 200d 0a20  ll not yield .. 
-0001ac30: 2020 2020 2020 2065 7272 6f72 2e20 436f         error. Co
-0001ac40: 6e73 6571 7565 6e74 6c79 2063 616e 2069  nsequently can i
-0001ac50: 6e74 726f 6475 6365 2061 6e20 756e 6578  ntroduce an unex
-0001ac60: 7065 6374 6564 2072 6573 756c 7473 2e0d  pected results..
-0001ac70: 0a20 2020 203a 7265 7475 726e 3a20 6172  .    :return: ar
-0001ac80: 7261 792d 6c69 6b65 2c20 0d0a 2020 2020  ray-like, ..    
-0001ac90: 2020 2020 416e 2061 7272 6179 2d6c 696b      An array-lik
-0001aca0: 6520 7769 7468 2066 756c 6c20 6e65 7720  e with full new 
-0001acb0: 6c61 6265 6c20 6e61 6d65 732e 200d 0a20  label names. .. 
-0001acc0: 2020 2022 2222 0d0a 2020 2020 0d0a 2020     """..    ..  
-0001acd0: 2020 6966 206e 6f74 2069 735f 6974 6572    if not is_iter
-0001ace0: 6162 6c65 286e 6577 5f6e 616d 6573 293a  able(new_names):
-0001acf0: 200d 0a20 2020 2020 2020 206e 6577 5f6e   ..        new_n
-0001ad00: 616d 6573 3d20 5b6e 6577 5f6e 616d 6573  ames= [new_names
-0001ad10: 5d0d 0a20 2020 2074 7275 655f 6c61 6265  ]..    true_labe
-0001ad20: 6c73 203d 206e 702e 756e 6971 7565 2028  ls = np.unique (
-0001ad30: 6172 7229 200d 0a20 2020 200d 0a20 2020  arr) ..    ..   
-0001ad40: 2069 6620 7661 6c69 6461 7465 5f6c 6162   if validate_lab
-0001ad50: 656c 7328 6172 722c 206e 6577 5f6e 616d  els(arr, new_nam
-0001ad60: 6573 2c20 7265 7475 726e 5f62 6f6f 6c3d  es, return_bool=
-0001ad70: 2054 7275 6529 3a20 0d0a 2020 2020 2020   True): ..      
-0001ad80: 2020 7265 7475 726e 2061 7272 200d 0a0d    return arr ...
-0001ad90: 0a20 2020 2069 6620 6c65 6e28 7472 7565  .    if len(true
-0001ada0: 5f6c 6162 656c 7329 2021 3d20 6c65 6e28  _labels) != len(
-0001adb0: 6e65 775f 6e61 6d65 7329 3a0d 0a20 2020  new_names):..   
-0001adc0: 2020 2020 2069 6620 6e6f 7420 636f 6572       if not coer
-0001add0: 6365 3a20 0d0a 2020 2020 2020 2020 2020  ce: ..          
-0001ade0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0001adf0: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
-0001ae00: 2020 2020 2022 4361 6e27 7420 7265 6e61       "Can't rena
-0001ae10: 6d65 206c 6162 656c 733b 2074 6865 206e  me labels; the n
-0001ae20: 6577 206e 616d 6573 2061 6e64 2075 6e69  ew names and uni
-0001ae30: 7175 6520 6c61 6265 6c22 200d 0a20 2020  que label" ..   
-0001ae40: 2020 2020 2020 2020 2020 2020 2022 2069               " i
-0001ae50: 6465 6e74 6966 6965 7273 2073 697a 6520  dentifiers size 
-0001ae60: 6d75 7374 2062 6520 636f 6e73 6973 7465  must be consiste
-0001ae70: 6e74 3b20 6578 7065 6374 207b 7d2c 2067  nt; expect {}, g
-0001ae80: 6f74 2022 200d 0a20 2020 2020 2020 2020  ot " ..         
-0001ae90: 2020 2020 2020 2022 7b7d 206c 6162 656c         "{} label
-0001aea0: 2873 292e 222e 666f 726d 6174 286c 656e  (s).".format(len
-0001aeb0: 2874 7275 655f 6c61 6265 6c73 292c 206c  (true_labels), l
-0001aec0: 656e 286e 6577 5f6e 616d 6573 2929 0d0a  en(new_names))..
-0001aed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aee0: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
-0001aef0: 2020 2020 2020 2020 6966 206c 656e 2874          if len(t
-0001af00: 7275 655f 6c61 6265 6c73 2920 3c20 6c65  rue_labels) < le
-0001af10: 6e28 6e65 775f 6e61 6d65 7329 203a 200d  n(new_names) : .
-0001af20: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
-0001af30: 5f6e 616d 6573 203d 206e 6577 5f6e 616d  _names = new_nam
-0001af40: 6573 205b 3a20 6c65 6e28 6e65 775f 6e61  es [: len(new_na
-0001af50: 6d65 7329 5d0d 0a20 2020 2020 2020 2065  mes)]..        e
-0001af60: 6c73 653a 200d 0a20 2020 2020 2020 2020  lse: ..         
-0001af70: 2020 206e 6577 5f6e 616d 6573 203d 206c     new_names = l
-0001af80: 6973 7428 6e65 775f 6e61 6d65 7329 2020  ist(new_names)  
-0001af90: 2b20 6c69 7374 280d 0a20 2020 2020 2020  + list(..       
-0001afa0: 2020 2020 2020 2020 2074 7275 655f 6c61           true_la
-0001afb0: 6265 6c73 295b 6c65 6e28 6e65 775f 6e61  bels)[len(new_na
-0001afc0: 6d65 7329 3a5d 0d0a 2020 2020 2020 2020  mes):]..        
-0001afd0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-0001afe0: 6e28 224e 756d 6265 7220 6f66 2074 6865  n("Number of the
-0001aff0: 2067 6976 656e 206c 6162 656c 7320 277b   given labels '{
-0001b000: 7d27 2061 6e64 2076 616c 7565 7320 277b  }' and values '{
-0001b010: 7d27 220d 0a20 2020 2020 2020 2020 2020  }'"..           
-0001b020: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b030: 2061 7265 206e 6f74 2063 6f6e 7369 7374   are not consist
-0001b040: 656e 742e 2042 6520 6177 6172 6520 7468  ent. Be aware th
-0001b050: 6174 2074 6869 7320 636f 756c 6420 220d  at this could ".
-0001b060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b070: 2020 2020 2020 2020 2020 2022 7969 656c             "yiel
-0001b080: 6420 616e 2065 7870 6563 7465 6420 7265  d an expected re
-0001b090: 7375 6c74 732e 222e 666f 726d 6174 280d  sults.".format(.
-0001b0a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b0b0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0001b0c0: 656e 286e 6577 5f6e 616d 6573 292c 206c  en(new_names), l
-0001b0d0: 656e 2874 7275 655f 6c61 6265 6c73 2929  en(true_labels))
-0001b0e0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-0001b0f0: 0a20 2020 206e 6577 5f6e 616d 6573 203d  .    new_names =
-0001b100: 206e 702e 6172 7261 7928 6e65 775f 6e61   np.array(new_na
-0001b110: 6d65 7329 0d0a 2020 2020 2320 7878 7878  mes)..    # xxxx
-0001b120: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0001b130: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0001b140: 7878 7878 0d0a 2020 2020 2320 686f 6c64  xxxx..    # hold
-0001b150: 2074 6865 2074 7970 6520 6f66 2061 7272   the type of arr
-0001b160: 2074 6f20 6f70 6572 6174 6520 7468 6520   to operate the 
-0001b170: 0d0a 2020 2020 2320 656c 656d 656e 7420  ..    # element 
-0001b180: 7769 7365 2063 6f6d 7061 7261 6973 6f6e  wise comparaison
-0001b190: 2069 6620 6e6f 7420 6120 0d0a 2020 2020   if not a ..    
-0001b1a0: 2320 5661 6c75 6545 7272 6f72 3a27 2069  # ValueError:' i
-0001b1b0: 6e76 616c 6964 206c 6974 6572 616c 2066  nvalid literal f
-0001b1c0: 6f72 2069 6e74 2829 2077 6974 6820 6261  or int() with ba
-0001b1d0: 7365 2031 3027 200d 0a20 2020 2023 2077  se 10' ..    # w
-0001b1e0: 696c 6c20 6170 7065 6172 2e20 0d0a 2020  ill appear. ..  
-0001b1f0: 2020 6966 206e 6f74 206e 702e 6973 7375    if not np.issu
-0001b200: 6264 7479 7065 286e 702e 6172 7261 7928  bdtype(np.array(
-0001b210: 6e65 775f 6e61 6d65 7329 2e64 7479 7065  new_names).dtype
-0001b220: 2c20 6e70 2e6e 756d 6265 7229 3a20 0d0a  , np.number): ..
-0001b230: 2020 2020 2020 2020 6172 723d 2061 7272          arr= arr
-0001b240: 2e61 7374 7970 6520 286e 702e 6172 7261  .astype (np.arra
-0001b250: 7928 6e65 775f 6e61 6d65 7329 2e64 7479  y(new_names).dty
-0001b260: 7065 290d 0a20 2020 2020 2020 2074 7275  pe)..        tru
-0001b270: 655f 6c61 6265 6c73 203d 2074 7275 655f  e_labels = true_
-0001b280: 6c61 6265 6c73 2e61 7374 7970 6520 286e  labels.astype (n
-0001b290: 702e 6172 7261 7928 6e65 775f 6e61 6d65  p.array(new_name
-0001b2a0: 7329 2e64 7479 7065 290d 0a0d 0a20 2020  s).dtype)....   
-0001b2b0: 2066 6f72 2065 6c20 2c20 6e65 6c20 696e   for el , nel in
-0001b2c0: 207a 6970 2028 7472 7565 5f6c 6162 656c   zip (true_label
-0001b2d0: 732c 206e 6577 5f6e 616d 6573 2029 3a20  s, new_names ): 
-0001b2e0: 0d0a 2020 2020 2020 2020 2320 7878 7878  ..        # xxxx
-0001b2f0: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0001b300: 7878 7878 7878 7878 7878 7878 7878 780d  xxxxxxxxxxxxxxx.
-0001b310: 0a20 2020 2020 2020 2023 2065 6c65 6d65  .        # eleme
-0001b320: 6e74 2063 6f6d 7061 7269 736f 6e20 7468  nt comparison th
-0001b330: 726f 7773 2061 2066 7574 7572 6520 7761  rows a future wa
-0001b340: 726e 696e 6720 6865 7265 200d 0a20 2020  rning here ..   
-0001b350: 2020 2020 2023 2062 6563 6175 7365 206f       # because o
-0001b360: 6620 6120 6469 7361 6772 6565 6d65 6e74  f a disagreement
-0001b370: 2062 6574 7765 656e 204e 756d 7079 2061   between Numpy a
-0001b380: 6e64 206e 6174 6976 6520 7079 7468 6f6e  nd native python
-0001b390: 200d 0a20 2020 2020 2020 2023 204e 756d   ..        # Num
-0001b3a0: 7079 2076 6572 7369 6f6e 203d 2731 2e32  py version ='1.2
-0001b3b0: 322e 3427 2077 6869 6c65 2070 7974 686f  2.4' while pytho
-0001b3c0: 6e20 7665 7273 696f 6e20 3d20 332e 392e  n version = 3.9.
-0001b3d0: 3132 0d0a 2020 2020 2020 2020 2320 7468  12..        # th
-0001b3e0: 6973 2063 6f64 6520 6973 2062 7269 7474  is code is britt
-0001b3f0: 6c65 2061 6e64 2072 6571 7569 7265 7320  le and requires 
-0001b400: 7468 6573 6520 7665 7273 696f 6e73 2061  these versions a
-0001b410: 626f 7665 2e20 0d0a 2020 2020 2020 2020  bove. ..        
-0001b420: 2320 7878 7878 7878 7878 7878 7878 7878  # xxxxxxxxxxxxxx
-0001b430: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0001b440: 7878 7878 780d 0a20 2020 2020 2020 2023  xxxxx..        #
-0001b450: 2073 7570 7072 6573 7320 656c 656d 656e   suppress elemen
-0001b460: 7420 7769 7365 2063 6f6d 7061 7269 736f  t wise compariso
-0001b470: 6e20 7761 726e 696e 6720 6c6f 6361 6c6c  n warning locall
-0001b480: 7920 0d0a 2020 2020 2020 2020 7769 7468  y ..        with
-0001b490: 2077 6172 6e69 6e67 732e 6361 7463 685f   warnings.catch_
-0001b4a0: 7761 726e 696e 6773 2829 3a0d 0a20 2020  warnings():..   
-0001b4b0: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
-0001b4c0: 732e 7369 6d70 6c65 6669 6c74 6572 2861  s.simplefilter(a
-0001b4d0: 6374 696f 6e3d 2769 676e 6f72 6527 2c20  ction='ignore', 
-0001b4e0: 6361 7465 676f 7279 3d46 7574 7572 6557  category=FutureW
-0001b4f0: 6172 6e69 6e67 290d 0a20 2020 2020 2020  arning)..       
-0001b500: 2020 2020 2061 7272 205b 6172 7220 3d3d       arr [arr ==
-0001b510: 2065 6c20 5d20 3d20 6e65 6c20 0d0a 2020   el ] = nel ..  
-0001b520: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0001b530: 7265 7475 726e 2061 7272 200d 0a0d 0a20  return arr .... 
-0001b540: 2020 200d 0a64 6566 205f 6361 7474 6172     ..def _cattar
-0001b550: 6765 7420 2861 7220 2c20 6c61 6265 6c73  get (ar , labels
-0001b560: 202c 206f 7264 6572 3d4e 6f6e 6529 3a20   , order=None): 
-0001b570: 0d0a 2020 2020 2222 2220 4120 7368 6164  ..    """ A shad
-0001b580: 6f77 2066 756e 6374 696f 6e20 6f66 203a  ow function of :
-0001b590: 6675 6e63 3a60 7761 7465 782e 7574 696c  func:`watex.util
-0001b5a0: 732e 6675 6e63 7574 696c 732e 6361 7474  s.funcutils.catt
-0001b5b0: 6172 6765 7460 2e20 0d0a 2020 2020 0d0a  arget`. ..    ..
-0001b5c0: 2020 2020 3a70 6172 616d 2061 723a 2061      :param ar: a
-0001b5d0: 7272 6179 2d6c 696b 6520 6f66 206e 756d  rray-like of num
-0001b5e0: 6572 6963 616c 2076 616c 7565 7320 0d0a  erical values ..
-0001b5f0: 2020 2020 3a70 6172 616d 206c 6162 656c      :param label
-0001b600: 733a 2069 6e74 206f 7220 6c69 7374 206f  s: int or list o
-0001b610: 6620 696e 742c 200d 0a20 2020 2020 2020  f int, ..       
-0001b620: 2074 6865 206e 756d 6265 7220 6f66 2063   the number of c
-0001b630: 6174 6567 6f72 7920 746f 2073 706c 6974  ategory to split
-0001b640: 2027 6172 2769 6e74 6f2e 200d 0a20 2020   'ar'into. ..   
-0001b650: 203a 7061 7261 6d20 6f72 6465 723a 2073   :param order: s
-0001b660: 7472 2c20 6f70 7469 6f6e 616c 2c20 0d0a  tr, optional, ..
-0001b670: 2020 2020 2020 2020 7468 6520 6f72 6465          the orde
-0001b680: 7220 6f66 206c 6162 656c 2074 6f20 6e65  r of label to ne
-0001b690: 2063 6174 6567 6f72 697a 6564 2e20 4966   categorized. If
-0001b6a0: 204e 6f6e 6520 6f72 2061 6e79 206f 7468   None or any oth
-0001b6b0: 6572 2076 616c 7565 732c 200d 0a20 2020  er values, ..   
-0001b6c0: 2020 2020 2074 6865 2063 6174 6567 6f72       the categor
-0001b6d0: 697a 6174 696f 6e20 6f66 206c 6162 656c  ization of label
-0001b6e0: 7320 636f 6e73 6964 6572 7320 6f6e 6c79  s considers only
-0001b6f0: 2074 6865 206c 6561 6e67 7468 206f 6620   the leangth of 
-0001b700: 6172 7261 792e 200d 0a20 2020 2020 2020  array. ..       
-0001b710: 2046 6f72 2069 6e73 7461 6e63 6520 6120   For instance a 
-0001b720: 7265 7665 7273 6520 6172 7261 7920 616e  reverse array an
-0001b730: 6420 6e6f 6e2d 7265 7665 7273 6520 6172  d non-reverse ar
-0001b740: 7261 7920 7969 656c 6420 7468 6520 7361  ray yield the sa
-0001b750: 6d65 200d 0a20 2020 2020 2020 2063 6174  me ..        cat
-0001b760: 6567 6f72 697a 6174 696f 6e20 7361 6d70  egorization samp
-0001b770: 6c65 732e 2057 6865 6e20 6f72 6465 7220  les. When order 
-0001b780: 6973 2073 6574 2074 6f20 6060 7374 7269  is set to ``stri
-0001b790: 6374 6060 2c20 7468 6520 0d0a 2020 2020  ct``, the ..    
-0001b7a0: 2020 2020 6361 7465 676f 7269 7a61 7469      categorizati
-0001b7b0: 6f6e 2020 7374 7269 6374 6c79 2063 6f6e  on  strictly con
-0001b7c0: 7369 6465 7220 7468 6520 7661 6c75 6520  sider the value 
-0001b7d0: 6f66 2065 6163 6820 656c 656d 656e 742e  of each element.
-0001b7e0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-0001b7f0: 203a 7265 7475 726e 3a20 6172 7261 792d   :return: array-
-0001b800: 6c69 6b65 206f 6620 696e 7420 2c20 6172  like of int , ar
-0001b810: 7261 7920 6f66 2063 6174 6567 6f72 697a  ray of categoriz
-0001b820: 6564 2076 616c 7565 732e 2020 0d0a 2020  ed values.  ..  
-0001b830: 2020 2222 220d 0a20 2020 2023 2061 7373    """..    # ass
-0001b840: 6572 7420 6c61 6265 6c73 0d0a 2020 2020  ert labels..    
-0001b850: 6966 2069 735f 6974 6572 6162 6c65 2028  if is_iterable (
-0001b860: 6c61 6265 6c73 293a 0d0a 2020 2020 2020  labels):..      
-0001b870: 2020 6c61 6265 6c73 203d 5b69 6e74 2028    labels =[int (
-0001b880: 5f61 7373 6572 745f 616c 6c5f 7479 7065  _assert_all_type
-0001b890: 7328 6c61 622c 2069 6e74 2c20 666c 6f61  s(lab, int, floa
-0001b8a0: 7429 2920 0d0a 2020 2020 2020 2020 2020  t)) ..          
-0001b8b0: 2020 2020 2020 2066 6f72 206c 6162 2069         for lab i
-0001b8c0: 6e20 6c61 6265 6c73 205d 0d0a 2020 2020  n labels ]..    
-0001b8d0: 2020 2020 6c61 6265 6c73 203d 206e 702e      labels = np.
-0001b8e0: 6172 7261 7920 286c 6162 656c 7320 2c20  array (labels , 
-0001b8f0: 6474 7970 6520 3d20 6e70 2e69 6e74 3332  dtype = np.int32
-0001b900: 2029 200d 0a20 2020 2020 2020 2063 6320   ) ..        cc 
-0001b910: 3d20 6c61 6265 6c73 200d 0a20 2020 2020  = labels ..     
-0001b920: 2020 2023 2061 7373 6572 7420 7768 6574     # assert whet
-0001b930: 6865 7220 656c 656d 656e 7420 6973 206f  her element is o
-0001b940: 6e20 7468 6520 6172 7261 7920 0d0a 2020  n the array ..  
-0001b950: 2020 2020 2020 7320 3d20 7365 7420 2861        s = set (a
-0001b960: 7229 2e69 6e74 6572 7365 6374 696f 6e28  r).intersection(
-0001b970: 6c61 6265 6c73 2920 0d0a 2020 2020 2020  labels) ..      
-0001b980: 2020 6966 206c 656e 2873 2920 213d 206c    if len(s) != l
-0001b990: 656e 286c 6162 656c 7329 3a20 0d0a 2020  en(labels): ..  
-0001b9a0: 2020 2020 2020 2020 2020 6d76 203d 2073            mv = s
-0001b9b0: 6574 286c 6162 656c 7329 2e64 6966 6665  et(labels).diffe
-0001b9c0: 7265 6e63 6520 2873 2920 0d0a 2020 2020  rence (s) ..    
-0001b9d0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001b9e0: 2020 2020 2020 666d 7420 3d20 5b66 227b        fmt = [f"{
-0001b9f0: 2773 2720 6966 206c 656e 286d 7629 203e  's' if len(mv) >
-0001ba00: 3120 656c 7365 2727 7d20 222c 206d 762c  1 else''} ", mv,
-0001ba10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001ba20: 2020 2020 2066 227b 2769 7327 2069 6620       f"{'is' if 
-0001ba30: 6c65 6e28 6d76 2920 3c3d 3120 656c 7365  len(mv) <=1 else
-0001ba40: 2761 7265 277d 225d 0d0a 2020 2020 2020  'are'}"]..      
-0001ba50: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-0001ba60: 6172 6e28 224c 6162 656c 2076 616c 7565  arn("Label value
-0001ba70: 7320 6d75 7374 2062 6520 6172 7261 7920  s must be array 
-0001ba80: 7365 6c66 2d63 6f6e 7461 696e 2069 7465  self-contain ite
-0001ba90: 6d2e 2022 0d0a 2020 2020 2020 2020 2020  m. "..          
-0001baa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bab0: 2022 4c61 6265 6c7b 307d 207b 317d 207b   "Label{0} {1} {
-0001bac0: 327d 206d 6973 7369 6e67 2069 6e20 7468  2} missing in th
-0001bad0: 6520 6172 7261 792e 222e 666f 726d 6174  e array.".format
-0001bae0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0001baf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb00: 2020 2a66 6d74 290d 0a20 2020 2020 2020    *fmt)..       
+0000c370: 2020 2066 2220 4578 7065 6374 7320 7b6f     f" Expects {o
+0000c380: 7574 7d22 290d 0a20 2020 2023 636f 6d70  ut}")..    #comp
+0000c390: 7574 6520 7468 6520 6f63 6375 7265 6e63  ute the occurenc
+0000c3a0: 6520 6f66 2074 6865 2073 7472 6174 756d  e of the stratum
+0000c3b0: 2069 6e20 7468 6520 6461 7461 3a20 0d0a   in the data: ..
+0000c3c0: 2020 2020 6273 2c20 2072 202c 2063 2020      bs,  r , c  
+0000c3d0: 3d20 5f67 6574 5f73 5f6f 6363 7572 656e  = _get_s_occuren
+0000c3e0: 6365 2873 6461 7461 202c 2073 7472 6174  ce(sdata , strat
+0000c3f0: 756d 2029 0d0a 2020 2020 2020 2020 0d0a  um )..        ..
+0000c400: 2020 2020 7265 7475 726e 2028 2028 2072      return ( ( r
+0000c410: 202c 2063 2029 2020 6966 2028 2072 6574   , c )  if ( ret
+0000c420: 7572 6e5f 7261 7465 2061 6e64 2072 6574  urn_rate and ret
+0000c430: 7572 6e5f 636f 756e 7473 2920 656c 7365  urn_counts) else
+0000c440: 2020 2820 0d0a 2020 2020 2020 2020 2020    ( ..          
+0000c450: 2020 7220 6966 2072 6574 7572 6e5f 7261    r if return_ra
+0000c460: 7465 2065 6c73 6520 6320 2920 6966 2072  te else c ) if r
+0000c470: 6574 7572 6e5f 7261 7465 206f 7220 7265  eturn_rate or re
+0000c480: 7475 726e 5f63 6f75 6e74 7320 656c 7365  turn_counts else
+0000c490: 2062 7320 0d0a 2020 2020 2020 2020 2020   bs ..          
+0000c4a0: 2020 2920 0d0a 0d0a 6465 6620 5f67 6574    ) ....def _get
+0000c4b0: 5f73 5f6f 6363 7572 656e 6365 2028 0d0a  _s_occurence (..
+0000c4c0: 2020 2020 2020 2020 7364 2c20 2f2c 2020          sd, /,  
+0000c4d0: 6273 203d 204e 6f6e 6520 2c20 7265 7665  bs = None , reve
+0000c4e0: 7273 653d 2054 7275 652c 206b 6579 203d  rse= True, key =
+0000c4f0: 2031 2c20 0d0a 2020 2020 2020 2020 2920   1, ..        ) 
+0000c500: 2d3e 2054 7570 6c65 205b 7374 722c 2066  -> Tuple [str, f
+0000c510: 6c6f 6174 2c20 4c69 7374 205d 3a20 0d0a  loat, List ]: ..
+0000c520: 2020 2020 2222 2220 5265 7475 726e 7320      """ Returns 
+0000c530: 7468 6520 6f63 6375 7265 6e63 6520 6f66  the occurence of
+0000c540: 2074 6865 206f 626a 6563 7420 696e 2074   the object in t
+0000c550: 6865 2064 6174 612e 200d 0a20 2020 203a  he data. ..    :
+0000c560: 7061 7261 6d20 7364 3a20 6172 7261 792d  param sd: array-
+0000c570: 6c69 6b65 2031 6420 6f66 2020 6461 7461  like 1d of  data
+0000c580: 200d 0a20 2020 203a 7061 7261 6d20 6273   ..    :param bs
+0000c590: 3a20 7374 7220 2d20 6261 7365 206e 616d  : str - base nam
+0000c5a0: 6520 6f66 2074 6865 206f 626a 6563 742e  e of the object.
+0000c5b0: 2049 6620 2762 7327 2069 6620 6769 7665   If 'bs' if give
+0000c5c0: 6e20 7468 6520 6175 746f 200d 0a20 2020  n the auto ..   
+0000c5d0: 2020 2020 2073 6561 7263 6820 2077 696c       search  wil
+0000c5e0: 6c20 6e6f 7420 6265 2075 7365 642e 200d  l not be used. .
+0000c5f0: 0a20 2020 203a 7061 7261 6d20 6b65 793a  .    :param key:
+0000c600: 2069 6e74 2c20 6465 6661 756c 743d 3120   int, default=1 
+0000c610: 0d0a 2020 2020 2020 2020 6b65 7920 6f66  ..        key of
+0000c620: 206f 7264 6572 6564 2073 6f72 7465 6420   ordered sorted 
+0000c630: 6469 6374 2e20 4d75 7374 2062 6520 6569  dict. Must be ei
+0000c640: 7468 6572 207b 302c 2031 7d3a 2060 3060  ther {0, 1}: `0`
+0000c650: 2066 6f72 206b 6579 200d 0a20 2020 2020   for key ..     
+0000c660: 2020 206f 7264 6572 6564 2073 6561 7263     ordered searc
+0000c670: 6720 7768 696c 6520 6031 6020 6973 2066  g while `1` is f
+0000c680: 6f72 2076 616c 7565 2073 6561 7263 682e  or value search.
+0000c690: 200d 0a20 2020 203a 7061 7261 6d20 7265   ..    :param re
+0000c6a0: 7665 7273 653a 2062 6f6f 6c2c 2072 6576  verse: bool, rev
+0000c6b0: 6572 7365 206f 7264 6572 6564 2064 6963  erse ordered dic
+0000c6c0: 7469 6f6e 6e61 7279 0d0a 2020 2020 3a72  tionnary..    :r
+0000c6d0: 6574 7572 6e73 3a20 6273 2c20 722c 2063  eturns: bs, r, c
+0000c6e0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000c6f0: 2074 6865 2062 6173 6520 6f62 6a65 6374   the base object
+0000c700: 2c20 7261 7465 206f 7220 636f 756e 7473  , rate or counts
+0000c710: 2e0d 0a20 2020 2022 2222 0d0a 2020 2020  ...    """..    
+0000c720: 2320 736f 7274 6564 2073 7472 6174 6120  # sorted strata 
+0000c730: 696e 2061 7363 656e 6469 6e67 206f 6363  in ascending occ
+0000c740: 7572 656e 6365 200d 0a20 2020 2073 3d64  urence ..    s=d
+0000c750: 6963 7420 2820 436f 756e 7465 7228 7364  ict ( Counter(sd
+0000c760: 2029 2029 200d 0a20 2020 2073 6d20 3d20   ) ) ..    sm = 
+0000c770: 6469 6374 2028 0d0a 2020 2020 2020 2020  dict (..        
+0000c780: 736f 7274 6564 2028 732e 6974 656d 7320  sorted (s.items 
+0000c790: 2829 202c 206b 6579 3d20 6c61 6d62 6461  () , key= lambda
+0000c7a0: 2078 3a78 5b6b 6579 5d2c 2072 6576 6572   x:x[key], rever
+0000c7b0: 7365 203d 7265 7665 7273 6520 290d 0a20  se =reverse ).. 
+0000c7c0: 2020 2020 2020 2029 0d0a 2020 2020 6273         )..    bs
+0000c7d0: 203d 206c 6973 7428 736d 2920 5b30 5d20   = list(sm) [0] 
+0000c7e0: 2069 6620 6273 2069 7320 4e6f 6e65 2065   if bs is None e
+0000c7f0: 6c73 6520 6273 200d 0a20 2020 2072 3d20  lse bs ..    r= 
+0000c800: 736d 5b62 735d 202f 2073 756d 2028 736d  sm[bs] / sum (sm
+0000c810: 2e76 616c 7565 7320 2829 2920 2320 7261  .values ()) # ra
+0000c820: 7469 6f0d 0a20 2020 2063 203d 206c 6973  tio..    c = lis
+0000c830: 7428 7a69 7020 2873 6d2e 6b65 7973 2829  t(zip (sm.keys()
+0000c840: 2c20 736d 2e76 616c 7565 7320 2829 2929  , sm.values ()))
+0000c850: 200d 0a20 2020 200d 0a20 2020 2072 6574   ..    ..    ret
+0000c860: 7572 6e20 2062 732c 2020 7220 2c20 630d  urn  bs,  r , c.
+0000c870: 0a20 2020 2020 2020 2020 0d0a 6465 6620  .         ..def 
+0000c880: 6765 745f 636f 6d70 7265 7373 6564 5f76  get_compressed_v
+0000c890: 6563 746f 7228 0d0a 2020 2020 642c 202f  ector(..    d, /
+0000c8a0: 2c20 0d0a 2020 2020 736e 616d 652c 2020  , ..    sname,  
+0000c8b0: 0d0a 2020 2020 7374 7261 7475 6d20 3d4e  ..    stratum =N
+0000c8c0: 6f6e 6520 2c20 0d0a 2020 2020 7374 7261  one , ..    stra
+0000c8d0: 7465 6779 203d 2261 7665 7261 6765 222c  tegy ="average",
+0000c8e0: 200d 0a20 2020 2061 735f 6672 616d 6520   ..    as_frame 
+0000c8f0: 3d20 4661 6c73 652c 200d 0a20 2020 2072  = False, ..    r
+0000c900: 616e 646f 6d5f 7374 6174 6520 3d20 4e6f  andom_state = No
+0000c910: 6e65 2c20 0d0a 2020 2020 292d 3e20 5365  ne, ..    )-> Se
+0000c920: 7269 6573 203a 0d0a 2020 2020 2222 2220  ries :..    """ 
+0000c930: 436f 6d70 7265 7373 6573 2062 6173 6520  Compresses base 
+0000c940: 7374 7261 7475 6d20 6461 7461 2069 6e74  stratum data int
+0000c950: 6f20 6120 7369 6e67 756c 6172 2076 6563  o a singular vec
+0000c960: 746f 7220 636f 6d70 6f73 6564 206f 6620  tor composed of 
+0000c970: 616c 6c20 0d0a 2020 2020 6665 6174 7572  all ..    featur
+0000c980: 6520 6e61 6d65 7320 696e 2074 6865 2074  e names in the t
+0000c990: 6172 6765 7474 6564 2064 6174 6120 6064  argetted data `d
+0000c9a0: 602e 200d 0a20 2020 200d 0a20 2020 2050  `. ..    ..    P
+0000c9b0: 6172 616d 6574 6572 7320 0d0a 2020 2020  arameters ..    
+0000c9c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
+0000c9d0: 2020 643a 2070 616e 6461 7320 4461 7461    d: pandas Data
+0000c9e0: 4672 616d 650d 0a20 2020 2020 2020 2056  Frame..        V
+0000c9f0: 616c 6964 2064 6174 6120 636f 6e74 6169  alid data contai
+0000ca00: 6e69 6e67 2074 6865 2073 7472 6174 612e  ning the strata.
+0000ca10: 2049 6620 6461 7461 6672 616d 6520 6973   If dataframe is
+0000ca20: 2070 6173 7365 642c 2027 736e 616d 6527   passed, 'sname'
+0000ca30: 2069 7320 0d0a 2020 2020 2020 2020 6e65   is ..        ne
+0000ca40: 6564 6564 2074 6f20 6665 7463 6820 7374  eded to fetch st
+0000ca50: 7261 7461 2076 616c 7565 732e 200d 0a20  rata values. .. 
+0000ca60: 2020 2073 6e61 6d65 3a20 7374 722c 206f     sname: str, o
+0000ca70: 7074 696f 6e61 6c20 0d0a 2020 2020 2020  ptional ..      
+0000ca80: 2020 4e61 6d65 206f 6620 636f 6c75 6d6e    Name of column
+0000ca90: 2069 6e20 7468 6520 6461 7461 6672 616d   in the datafram
+0000caa0: 6520 7468 6174 2063 6f6e 7461 696e 7320  e that contains 
+0000cab0: 7468 6520 7374 7261 7461 2076 616c 7565  the strata value
+0000cac0: 732e 200d 0a20 2020 2020 2020 2044 6f6e  s. ..        Don
+0000cad0: 7420 636f 6e66 7573 6520 2773 6e61 6d65  t confuse 'sname
+0000cae0: 2720 7769 7468 2027 7374 7261 7475 6d27  ' with 'stratum'
+0000caf0: 2077 6869 6368 2069 7320 7468 6520 6e61   which is the na
+0000cb00: 6d65 206f 6620 7468 6520 7661 6c69 6420  me of the valid 
+0000cb10: 0d0a 2020 2020 2020 2020 6c61 7965 722f  ..        layer/
+0000cb20: 726f 636b 2069 6e20 7468 6520 6172 7261  rock in the arra
+0000cb30: 792f 5365 7269 6573 206f 6620 7374 7261  y/Series of stra
+0000cb40: 7461 2e20 0d0a 2020 2020 7374 7261 7475  ta. ..    stratu
+0000cb50: 6d3a 2073 7472 2c20 6f70 7469 6f6e 616c  m: str, optional
+0000cb60: 200d 0a20 2020 2020 2020 204e 616d 6520   ..        Name 
+0000cb70: 6f66 2074 6865 2062 6173 6520 7374 7261  of the base stra
+0000cb80: 7475 6d2e 204d 7573 7420 6265 2073 656c  tum. Must be sel
+0000cb90: 6620 636f 6e74 6169 6e20 6173 2061 6e20  f contain as an 
+0000cba0: 6974 656d 206f 6620 7468 6520 0d0a 2020  item of the ..  
+0000cbb0: 2020 2020 2020 7374 7261 7461 2064 6174        strata dat
+0000cbc0: 612e 204e 6f74 6520 7468 6174 2069 6620  a. Note that if 
+0000cbd0: 6073 7472 6174 756d 6020 6973 2070 6173  `stratum` is pas
+0000cbe0: 7365 642c 2074 6865 2061 7574 6f2d 6465  sed, the auto-de
+0000cbf0: 7465 6374 696f 6e20 6f66 200d 0a20 2020  tection of ..   
+0000cc00: 2020 2020 2062 6173 6520 7374 7261 7475       base stratu
+0000cc10: 6d20 6973 206e 6f74 2074 7269 6767 6572  m is not trigger
+0000cc20: 6564 2e20 4974 2072 6574 7572 6e73 2074  ed. It returns t
+0000cc30: 6865 2073 616d 6520 7374 7261 7475 6d20  he same stratum 
+0000cc40: 2c20 686f 7765 7665 720d 0a20 2020 2020  , however..     
+0000cc50: 2020 2069 7420 6361 6e20 6769 7665 7320     it can gives 
+0000cc60: 7468 6520 7261 7465 2061 6e64 206f 6363  the rate and occ
+0000cc70: 7572 656e 6365 206f 6620 7468 6973 2073  urence of this s
+0000cc80: 7472 6174 756d 2069 6620 6072 6574 7572  tratum if `retur
+0000cc90: 6e5f 7261 7465 6020 0d0a 2020 2020 2020  n_rate` ..      
+0000cca0: 2020 6f72 2060 7265 7475 726e 5f63 6f75    or `return_cou
+0000ccb0: 6e74 7360 2069 7320 7365 7420 746f 2060  nts` is set to `
+0000ccc0: 6054 7275 6560 602e 200d 0a20 2020 200d  `True``. ..    .
+0000ccd0: 0a20 2020 2073 7472 6174 6567 793a 2073  .    strategy: s
+0000cce0: 7472 202c 2064 6566 6175 6c74 3d27 6176  tr , default='av
+0000ccf0: 6572 6167 6527 206f 7220 276d 6561 6e27  erage' or 'mean'
+0000cd00: 2c20 0d0a 2020 2020 2020 2020 7374 7261  , ..        stra
+0000cd10: 7465 6779 2075 7365 6420 746f 2073 656c  tegy used to sel
+0000cd20: 6563 7420 6f72 2063 6f6d 7075 7465 2074  ect or compute t
+0000cd30: 6865 206e 756d 6572 6963 616c 2064 6174  he numerical dat
+0000cd40: 6120 696e 746f 2061 200d 0a20 2020 2020  a into a ..     
+0000cd50: 2020 2073 696e 6775 6c61 7220 7365 7269     singular seri
+0000cd60: 6573 2e20 4974 2063 616e 2062 6520 5b27  es. It can be ['
+0000cd70: 6e61 6976 6527 5d2e 2049 6e20 7468 6174  naive']. In that
+0000cd80: 2063 6173 6520 2c20 6120 7369 6e67 6c65   case , a single
+0000cd90: 2073 6572 6965 200d 0a20 2020 2020 2020   serie ..       
+0000cda0: 2069 6620 7261 6e64 6f6d 6c79 2070 6963   if randomly pic
+0000cdb0: 6b65 6420 7570 2069 6e74 6f20 7468 6520  ked up into the 
+0000cdc0: 6261 7365 2073 7472 6174 6120 6461 7461  base strata data
+0000cdd0: 2e0d 0a20 2020 2061 735f 6672 616d 653a  ...    as_frame:
+0000cde0: 2062 6f6f 6c2c 2064 6566 6175 6c74 3d27   bool, default='
+0000cdf0: 4661 6c73 6527 0d0a 2020 2020 2020 2020  False'..        
+0000ce00: 5265 7475 726e 7320 636f 6d70 7265 7373  Returns compress
+0000ce10: 6564 2076 6563 746f 7220 696e 746f 2061  ed vector into a
+0000ce20: 2064 6174 6166 7261 6d65 2072 6174 6865   dataframe rathe
+0000ce30: 7220 7468 6174 206b 6565 7069 6e67 2069  r that keeping i
+0000ce40: 6e20 0d0a 2020 2020 2020 2020 7365 7269  n ..        seri
+0000ce50: 6573 2e20 0d0a 2020 2020 7261 6e64 6f6d  es. ..    random
+0000ce60: 5f73 7461 7465 3a20 696e 742c 206f 7074  _state: int, opt
+0000ce70: 696f 6e61 6c2c 200d 0a20 2020 2020 2020  ional, ..       
+0000ce80: 2053 7461 7465 2066 6f72 2072 616e 646f   State for rando
+0000ce90: 6d6c 7920 7365 6c65 6374 6564 2061 2063  mly selected a c
+0000cea0: 6f6d 7072 6573 7365 6420 7665 6374 6f72  ompressed vector
+0000ceb0: 2077 6865 6e20 6060 6e61 6976 6560 6020   when ``naive`` 
+0000cec0: 6973 200d 0a20 2020 2020 2020 2070 6173  is ..        pas
+0000ced0: 7365 6420 6173 2073 7472 6174 6567 792e  sed as strategy.
+0000cee0: 0d0a 2020 2020 0d0a 2020 2020 5265 7475  ..    ..    Retu
+0000cef0: 726e 7320 0d0a 2020 2020 2d2d 2d2d 2d2d  rns ..    ------
+0000cf00: 2d2d 0d0a 2020 2020 6d73 3a20 7061 6e64  --..    ms: pand
+0000cf10: 6173 2073 6572 6965 732f 6461 7461 6672  as series/datafr
+0000cf20: 616d 6520 0d0a 2020 2020 2020 2020 7265  ame ..        re
+0000cf30: 7475 726e 7320 6120 636f 6d70 7265 7373  turns a compress
+0000cf40: 6564 2076 6563 746f 7220 696e 2070 616e  ed vector in pan
+0000cf50: 6461 7320 7365 7269 6573 2063 6f6d 706f  das series compo
+0000cf60: 7365 206f 6620 616c 6c20 6665 6174 7572  se of all featur
+0000cf70: 6573 2e20 0d0a 2020 2020 2020 2020 4e6f  es. ..        No
+0000cf80: 7465 202c 2074 6865 2076 6563 746f 7220  te , the vector 
+0000cf90: 6865 7265 2064 6f65 7320 6e6f 7420 7265  here does not re
+0000cfa0: 6665 7220 6173 206d 6174 6820 7665 6374  fer as math vect
+0000cfb0: 6f72 2063 6f6d 706f 7365 206f 6620 0d0a  or compose of ..
+0000cfc0: 2020 2020 2020 2020 6e75 6d65 7269 6361          numerica
+0000cfd0: 6c20 7661 6c75 6573 206f 6e6c 792e 2041  l values only. A
+0000cfe0: 2063 6f6d 7072 6573 7365 6420 7665 6374   compressed vect
+0000cff0: 6f72 2068 6572 6520 6973 2061 2073 6572  or here is a ser
+0000d000: 6965 7320 7468 6174 2069 7320 0d0a 2020  ies that is ..  
+0000d010: 2020 2020 2020 7468 6520 7265 7375 6c74        the result
+0000d020: 206f 6620 6176 6572 6167 696e 6720 7468   of averaging th
+0000d030: 6520 6e75 6d65 7269 6361 6c20 6665 6174  e numerical feat
+0000d040: 7572 6573 206f 6620 7468 6520 6261 7365  ures of the base
+0000d050: 2073 7472 6174 756d 2061 6e64 200d 0a20   stratum and .. 
+0000d060: 2020 2020 2020 2069 6e63 6c75 696e 6720         incluing 
+0000d070: 6974 7320 636f 7272 6573 706f 6e64 696e  its correspondin
+0000d080: 6720 6361 7465 676f 7269 6361 6c20 7661  g categorical va
+0000d090: 6c75 6573 2e20 4e6f 7465 2074 6865 7265  lues. Note there
+0000d0a0: 2c20 7468 6520 2060 6d73 600d 0a20 2020  , the  `ms`..   
+0000d0b0: 2020 2020 2063 616e 2063 6f6e 7461 696e       can contain
+0000d0c0: 2063 6174 6567 6f72 6963 616c 2076 616c   categorical val
+0000d0d0: 7565 7320 616e 6420 6861 7320 7468 6520  ues and has the 
+0000d0e0: 7361 6d65 206e 756d 6265 7220 616e 6420  same number and 
+0000d0f0: 6665 6174 7572 6573 2061 7320 0d0a 2020  features as ..  
+0000d100: 2020 2020 2020 7468 6520 6f72 6967 696e        the origin
+0000d110: 616c 2066 7261 6d65 2060 6460 2e20 0d0a  al frame `d`. ..
+0000d120: 2020 2020 0d0a 2020 2020 4578 616d 706c      ..    Exampl
+0000d130: 650d 0a20 2020 202d 2d2d 2d2d 2d2d 0d0a  e..    -------..
+0000d140: 2020 2020 3e3e 3e20 6672 6f6d 2077 6174      >>> from wat
+0000d150: 6578 2e64 6174 6173 6574 7320 696d 706f  ex.datasets impo
+0000d160: 7274 206c 6f61 645f 686c 6f67 7320 0d0a  rt load_hlogs ..
+0000d170: 2020 2020 3e3e 3e20 6672 6f6d 2077 6174      >>> from wat
+0000d180: 6578 2e75 7469 6c73 2e68 7964 726f 7574  ex.utils.hydrout
+0000d190: 696c 7320 696d 706f 7274 2067 6574 5f63  ils import get_c
+0000d1a0: 6f6d 7072 6573 7365 645f 7665 6374 6f72  ompressed_vector
+0000d1b0: 200d 0a20 2020 203e 3e3e 2064 6174 6120   ..    >>> data 
+0000d1c0: 3d20 6c6f 6164 5f68 6c6f 6773 2829 2e66  = load_hlogs().f
+0000d1d0: 7261 6d65 2023 2067 6574 206f 6e6c 7920  rame # get only 
+0000d1e0: 7468 6520 6672 616d 6520 200d 0a20 2020  the frame  ..   
+0000d1f0: 203e 3e3e 2067 6574 5f63 6f6d 7072 6573   >>> get_compres
+0000d200: 7365 645f 7665 6374 6f72 2028 6461 7461  sed_vector (data
+0000d210: 2c20 736e 616d 653d 2773 7472 6174 615f  , sname='strata_
+0000d220: 6e61 6d65 2729 5b3a 345d 0d0a 2020 2020  name')[:4]..    
+0000d230: 2e2e 2e20 686f 6c65 5f6e 756d 6265 7220  ... hole_number 
+0000d240: 2020 2020 2020 2020 2020 4835 3032 0d0a            H502..
+0000d250: 2020 2020 2020 2020 7374 7261 7461 5f6e          strata_n
+0000d260: 616d 6520 2020 2020 2073 696c 7473 746f  ame      siltsto
+0000d270: 6e65 0d0a 2020 2020 2020 2020 6171 7569  ne..        aqui
+0000d280: 6665 725f 6772 6f75 7020 2020 2020 2020  fer_group       
+0000d290: 2020 2020 4949 0d0a 2020 2020 2020 2020      II..        
+0000d2a0: 7075 6d70 696e 675f 6c65 7665 6c20 2020  pumping_level   
+0000d2b0: 2020 2020 5a46 5341 4949 0d0a 2020 2020      ZFSAII..    
+0000d2c0: 2020 2020 6474 7970 653a 206f 626a 6563      dtype: objec
+0000d2d0: 740d 0a20 2020 203e 3e3e 2067 6574 5f63  t..    >>> get_c
+0000d2e0: 6f6d 7072 6573 7365 645f 7665 6374 6f72  ompressed_vector
+0000d2f0: 2028 6461 7461 2c20 736e 616d 653d 2773   (data, sname='s
+0000d300: 7472 6174 615f 6e61 6d65 272c 2061 735f  trata_name', as_
+0000d310: 6672 616d 653d 5472 7565 2029 0d0a 2020  frame=True )..  
+0000d320: 2020 2e2e 2e20 2020 686f 6c65 5f6e 756d    ...   hole_num
+0000d330: 6265 7220 7374 7261 7461 5f6e 616d 6520  ber strata_name 
+0000d340: 6171 7569 6665 725f 6772 6f75 7020 202e  aquifer_group  .
+0000d350: 2e2e 2020 2020 2020 2020 7220 2020 2020  ..        r     
+0000d360: 7270 2072 656d 6172 6b0d 0a20 2020 2020  rp remark..     
+0000d370: 2020 2030 2020 2020 2020 2020 4835 3032     0        H502
+0000d380: 2020 2073 696c 7473 746f 6e65 2020 2020     siltstone    
+0000d390: 2020 2020 2020 2020 4949 2020 2e2e 2e20          II  ... 
+0000d3a0: 2034 312e 3730 3735 2020 3539 2e32 3320   41.7075  59.23 
+0000d3b0: 2020 204e 614e 0d0a 2020 2020 2020 2020     NaN..        
+0000d3c0: 5b31 2072 6f77 7320 7820 3233 2063 6f6c  [1 rows x 23 col
+0000d3d0: 756d 6e73 5d0d 0a20 2020 203e 3e3e 2067  umns]..    >>> g
+0000d3e0: 6574 5f63 6f6d 7072 6573 7365 645f 7665  et_compressed_ve
+0000d3f0: 6374 6f72 2028 6461 7461 2c20 736e 616d  ctor (data, snam
+0000d400: 653d 2773 7472 6174 615f 6e61 6d65 272c  e='strata_name',
+0000d410: 2073 7472 6174 6567 793d 276e 6169 7665   strategy='naive
+0000d420: 2729 0d0a 2020 2020 2e2e 2e20 686f 6c65  ')..    ... hole
+0000d430: 5f6e 756d 6265 7220 2020 2020 2020 2020  _number         
+0000d440: 2048 3530 320d 0a20 2020 2020 2020 2064   H502..        d
+0000d450: 6570 7468 5f74 6f70 2020 2020 2020 2020  epth_top        
+0000d460: 2020 3337 392e 3135 0d0a 2020 2020 2020    379.15..      
+0000d470: 2020 6465 7074 685f 626f 7474 6f6d 2020    depth_bottom  
+0000d480: 2020 2020 2020 3337 392e 370d 0a20 2020        379.7..   
+0000d490: 2020 2020 2073 7472 6174 615f 6e61 6d65       strata_name
+0000d4a0: 2020 2020 2073 696c 7473 746f 6e65 0d0a       siltstone..
+0000d4b0: 2020 2020 2020 2020 4e61 6d65 3a20 3339          Name: 39
+0000d4c0: 2c20 6474 7970 653a 206f 626a 6563 740d  , dtype: object.
+0000d4d0: 0a20 2020 2022 2222 0d0a 2020 2020 5f61  .    """..    _a
+0000d4e0: 7373 6572 745f 616c 6c5f 7479 7065 7328  ssert_all_types(
+0000d4f0: 642c 2070 642e 4461 7461 4672 616d 652c  d, pd.DataFrame,
+0000d500: 206f 626a 6e61 6d65 203d 2022 4461 7461   objname = "Data
+0000d510: 2066 6f72 2073 616d 706c 6573 2063 6f6d   for samples com
+0000d520: 7072 6573 7369 6e67 2229 0d0a 0d0a 2020  pressing")....  
+0000d530: 2020 643d 2063 6865 636b 5f61 7272 6179    d= check_array
+0000d540: 280d 0a20 2020 2020 2020 2064 2c20 0d0a  (..        d, ..
+0000d550: 2020 2020 2020 2020 666f 7263 655f 616c          force_al
+0000d560: 6c5f 6669 6e69 7465 3d22 616c 6c6f 772d  l_finite="allow-
+0000d570: 6e61 6e22 2c20 0d0a 2020 2020 2020 2020  nan", ..        
+0000d580: 6474 7970 6520 3d6f 626a 6563 742c 200d  dtype =object, .
+0000d590: 0a20 2020 2020 2020 2069 6e70 7574 5f6e  .        input_n
+0000d5a0: 616d 653d 2244 6174 6120 666f 7220 7371  ame="Data for sq
+0000d5b0: 7565 657a 696e 6722 2c0d 0a20 2020 2020  ueezing",..     
+0000d5c0: 2020 2074 6f5f 6672 616d 6520 3d54 7275     to_frame =Tru
+0000d5d0: 652c 200d 0a20 2020 2020 2020 2029 0d0a  e, ..        )..
+0000d5e0: 2020 2020 736e 616d 6520 3d20 5f61 7373      sname = _ass
+0000d5f0: 6572 745f 616c 6c5f 7479 7065 7328 736e  ert_all_types(sn
+0000d600: 616d 652c 2073 7472 202c 2022 2773 6e61  ame, str , "'sna
+0000d610: 6d65 2720 2820 7374 7261 7461 2063 6f6c  me' ( strata col
+0000d620: 756d 6e20 6e61 6d65 2029 2229 0d0a 2020  umn name )")..  
+0000d630: 2020 0d0a 2020 2020 7374 7261 7465 6779    ..    strategy
+0000d640: 3d20 7374 7228 7374 7261 7465 6779 292e  = str(strategy).
+0000d650: 6c6f 7765 7228 292e 7374 7269 7028 2920  lower().strip() 
+0000d660: 0d0a 2020 2020 6173 7365 7274 2073 7472  ..    assert str
+0000d670: 6174 6567 7920 696e 207b 276d 6561 6e27  ategy in {'mean'
+0000d680: 2c20 2761 7665 7261 6765 272c 2027 6e61  , 'average', 'na
+0000d690: 6976 6527 7d2c 2022 5375 7070 6f72 7473  ive'}, "Supports
+0000d6a0: 206f 6e6c 7920 7374 7261 7465 6779 2022   only strategy "
+0000d6b0: 5c0d 0a20 2020 2020 2020 2066 2227 6d65  \..        f"'me
+0000d6c0: 616e 272c 2027 6176 6572 6167 6527 206f  an', 'average' o
+0000d6d0: 7220 276e 6169 7665 273b 2067 6f74 207b  r 'naive'; got {
+0000d6e0: 7374 7261 7465 6779 2172 7d22 0d0a 2020  strategy!r}"..  
+0000d6f0: 2020 6966 2073 7472 6174 756d 2069 7320    if stratum is 
+0000d700: 4e6f 6e65 3a20 0d0a 2020 2020 2020 2020  None: ..        
+0000d710: 7374 7261 7475 6d20 3d20 7365 6c65 6374  stratum = select
+0000d720: 5f62 6173 655f 7374 7261 7475 6d28 642c  _base_stratum(d,
+0000d730: 2073 6e61 6d65 3d20 736e 616d 652c 2073   sname= sname, s
+0000d740: 7472 6174 756d 3d20 7374 7261 7475 6d20  tratum= stratum 
+0000d750: 290d 0a20 2020 2073 7472 6174 756d 203d  )..    stratum =
+0000d760: 205f 6173 7365 7274 5f61 6c6c 5f74 7970   _assert_all_typ
+0000d770: 6573 2873 7472 6174 756d 2c20 7374 7220  es(stratum, str 
+0000d780: 2c20 6f62 6a6e 616d 6520 3d20 2742 6173  , objname = 'Bas
+0000d790: 6520 7374 7261 7475 6d20 2729 0d0a 2020  e stratum ')..  
+0000d7a0: 2020 2367 726f 7570 2079 2061 6e64 2067    #group y and g
+0000d7b0: 6574 206f 6e6c 7920 7468 6520 6261 7365  et only the base
+0000d7c0: 2073 7472 6174 756d 2064 6174 6120 0d0a   stratum data ..
+0000d7d0: 2020 2020 7069 6563 6573 203d 2064 6963      pieces = dic
+0000d7e0: 7428 6c69 7374 2864 2e67 726f 7570 6279  t(list(d.groupby
+0000d7f0: 2028 736e 616d 6529 2929 200d 0a20 2020   (sname))) ..   
+0000d800: 2062 735f 6420 203d 2070 642e 4461 7461   bs_d  = pd.Data
+0000d810: 4672 616d 6528 2070 6965 6365 7320 5b20  Frame( pieces [ 
+0000d820: 7374 7261 7475 6d20 5d29 200d 0a20 2020  stratum ]) ..   
+0000d830: 2023 2067 6574 2074 6865 206e 756d 6572   # get the numer
+0000d840: 6963 616c 2066 6561 7475 7265 7320 6f6e  ical features on
+0000d850: 6c79 2062 6566 6f72 6520 2061 7070 6c79  ly before  apply
+0000d860: 696e 6720 6f70 6572 6174 696f 6e20 0d0a  ing operation ..
+0000d870: 2020 2020 5f2c 206e 756d 6620 2c20 6361      _, numf , ca
+0000d880: 7466 2020 3d20 746f 5f6e 756d 6572 6963  tf  = to_numeric
+0000d890: 5f64 7479 7065 7328 6273 5f64 202c 2072  _dtypes(bs_d , r
+0000d8a0: 6574 7572 6e5f 6665 6174 7572 655f 7479  eturn_feature_ty
+0000d8b0: 7065 733d 2054 7275 6520 290d 0a20 2020  pes= True )..   
+0000d8c0: 200d 0a20 2020 2069 6620 7374 7261 7465   ..    if strate
+0000d8d0: 6779 2020 696e 2028 276d 6561 6e27 2c20  gy  in ('mean', 
+0000d8e0: 2761 7665 7261 6765 2729 203a 0d0a 2020  'average') :..  
+0000d8f0: 2020 2020 2020 2378 7878 7878 7878 7878        #xxxxxxxxx
+0000d900: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
+0000d910: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
+0000d920: 7878 7878 7878 780d 0a20 2020 2020 2020  xxxxxxx..       
+0000d930: 2066 726f 6d20 2e2e 6578 6c69 622e 736b   from ..exlib.sk
+0000d940: 6c65 6172 6e20 696d 706f 7274 2053 696d  learn import Sim
+0000d950: 706c 6549 6d70 7574 6572 200d 0a20 2020  pleImputer ..   
+0000d960: 2020 2020 2023 7878 7878 7878 7878 7878       #xxxxxxxxxx
+0000d970: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
+0000d980: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
+0000d990: 7878 7878 7878 0d0a 2020 2020 2020 2020  xxxxxx..        
+0000d9a0: 6d73 203d 2062 735f 645b 206e 756d 6620  ms = bs_d[ numf 
+0000d9b0: 5d2e 6d65 616e 2829 200d 0a20 2020 2020  ].mean() ..     
+0000d9c0: 2020 2069 6620 6c65 6e28 6361 7466 2921     if len(catf)!
+0000d9d0: 3d30 3a0d 0a20 2020 2020 2020 2020 2020  =0:..           
+0000d9e0: 2023 2049 6d70 7574 6520 6461 7461 2061   # Impute data a
+0000d9f0: 6e64 2066 696c 6c20 7468 6520 6761 7020  nd fill the gap 
+0000da00: 6966 2065 7869 7374 730d 0a20 2020 2020  if exists..     
+0000da10: 2020 2020 2020 2023 2020 6279 2074 6865         #  by the
+0000da20: 206d 6f73 7420 6672 6571 7565 6e74 2063   most frequent c
+0000da30: 6174 6567 6f72 6961 6c20 6665 6174 7572  ategorial featur
+0000da40: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
+0000da50: 2073 696d 203d 2053 696d 706c 6549 6d70   sim = SimpleImp
+0000da60: 7574 6572 2873 7472 6174 6567 7920 3d20  uter(strategy = 
+0000da70: 276d 6f73 745f 6672 6571 7565 6e74 2729  'most_frequent')
+0000da80: 200d 0a20 2020 2020 2020 2020 2020 2078   ..            x
+0000da90: 7420 3d20 7369 6d2e 6669 745f 7472 616e  t = sim.fit_tran
+0000daa0: 7366 6f72 6d28 6273 5f64 5b63 6174 665d  sform(bs_d[catf]
+0000dab0: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
+0000dac0: 6273 5f64 6320 3d20 7064 2e44 6174 6146  bs_dc = pd.DataF
+0000dad0: 7261 6d65 2878 7420 2c20 636f 6c75 6d6e  rame(xt , column
+0000dae0: 7320 3d20 7369 6d2e 6665 6174 7572 655f  s = sim.feature_
+0000daf0: 6e61 6d65 735f 696e 5f20 2920 0d0a 2020  names_in_ ) ..  
+0000db00: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
+0000db10: 6f6e 6c79 2073 696e 676c 6520 7661 6c75  only single valu
+0000db20: 6520 6f66 2074 6865 2066 6972 7374 2072  e of the first r
+0000db30: 6f77 200d 0a20 2020 2020 2020 2020 2020  ow ..           
+0000db40: 2062 735f 696e 6974 203d 2062 735f 6463   bs_init = bs_dc
+0000db50: 202e 696c 6f63 205b 3020 2c20 3a20 5d20   .iloc [0 , : ] 
+0000db60: 0d0a 2020 2020 2020 2020 2020 2020 236d  ..            #m
+0000db70: 732e 7265 7365 745f 696e 6465 7820 2869  s.reset_index (i
+0000db80: 6e70 6c61 6365 203d 5472 7565 2029 200d  nplace =True ) .
+0000db90: 0a20 2020 2020 2020 2020 2020 206d 7320  .            ms 
+0000dba0: 3d20 7064 2e63 6f6e 6361 7420 2820 5b20  = pd.concat ( [ 
+0000dbb0: 6273 5f69 6e69 742c 206d 7320 205d 2c20  bs_init, ms  ], 
+0000dbc0: 6178 6973 203d 2030 2029 200d 0a20 2020  axis = 0 ) ..   
+0000dbd0: 2065 6c69 6620 7374 7261 7465 6779 203d   elif strategy =
+0000dbe0: 3d27 6e61 6976 6527 3a0d 0a20 2020 2020  ='naive':..     
+0000dbf0: 2020 2072 616e 646f 6d5f 7374 6174 653d     random_state=
+0000dc00: 2072 616e 646f 6d5f 7374 6174 6520 6f72   random_state or
+0000dc10: 2034 3220 0d0a 2020 2020 2020 2020 2320   42 ..        # 
+0000dc20: 7261 6e64 6f6d 6c79 2070 6963 6b20 7570  randomly pick up
+0000dc30: 206f 6e65 2069 6e64 6578 200d 0a20 2020   one index ..   
+0000dc40: 2020 2020 2072 616e 6420 3d20 6e70 2e72       rand = np.r
+0000dc50: 616e 646f 6d2e 5261 6e64 6f6d 5374 6174  andom.RandomStat
+0000dc60: 6520 2872 616e 646f 6d5f 7374 6174 6520  e (random_state 
+0000dc70: 290d 0a20 2020 2020 2020 2023 2069 6620  )..        # if 
+0000dc80: 7573 6520 7361 6d70 6c65 202c 202d 3e20  use sample , -> 
+0000dc90: 7265 7475 726e 2061 206c 6973 7420 616e  return a list an
+0000dca0: 6420 6d75 7374 200d 0a20 2020 2020 2020  d must ..       
+0000dcb0: 2023 2073 7065 6369 6679 2074 6865 206b   # specify the k
+0000dcc0: 206e 756d 6265 7220 6f66 2073 6571 7565   number of seque
+0000dcd0: 6e63 6520 2c20 0d0a 2020 2020 2020 2020  nce , ..        
+0000dce0: 2320 7768 696c 6520 6865 7265 202c 206f  # while here , o
+0000dcf0: 6e6c 7920 6120 7369 6e67 6c65 2069 7320  nly a single is 
+0000dd00: 6973 2065 7870 6563 7465 643a 206c 696b  is expected: lik
+0000dd10: 6520 0d0a 2020 2020 2020 2020 2320 7261  e ..        # ra
+0000dd20: 6e64 6f6d 2e73 616d 706c 6520 286c 6973  ndom.sample (lis
+0000dd30: 7428 7261 6e64 2e70 6572 6d75 7461 7469  t(rand.permutati
+0000dd40: 6f6e 2028 5830 2e69 6e64 6578 2029 2920  on (X0.index )) 
+0000dd50: 2c20 3120 290d 0a20 2020 2020 2020 2069  , 1 )..        i
+0000dd60: 7820 3d20 7261 6e64 6f6d 2e63 686f 6963  x = random.choic
+0000dd70: 6520 2872 616e 642e 7065 726d 7574 6174  e (rand.permutat
+0000dd80: 696f 6e20 2862 735f 642e 696e 6465 7820  ion (bs_d.index 
+0000dd90: 2929 200d 0a20 2020 2020 2020 206d 7320  )) ..        ms 
+0000dda0: 3d20 6273 5f64 2e6c 6f63 205b 6978 205d  = bs_d.loc [ix ]
+0000ddb0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0000ddc0: 2072 6574 7572 6e20 206d 7320 2069 6620   return  ms  if 
+0000ddd0: 6e6f 7420 6173 5f66 7261 6d65 2020 656c  not as_frame  el
+0000dde0: 7365 2070 642e 4461 7461 4672 616d 6528  se pd.DataFrame(
+0000ddf0: 0d0a 2020 2020 2020 2020 6469 6374 286d  ..        dict(m
+0000de00: 7329 202c 2069 6e64 6578 203d 2072 616e  s) , index = ran
+0000de10: 6765 2028 3129 290d 0a0d 0a64 6566 205f  ge (1))....def _
+0000de20: 6173 7365 7274 5f72 6564 7563 655f 696e  assert_reduce_in
+0000de30: 6465 7865 7320 282a 6978 7320 2920 3a20  dexes (*ixs ) : 
+0000de40: 0d0a 2020 2020 2222 2220 4173 7365 7274  ..    """ Assert
+0000de50: 2072 6564 7563 696e 6720 696e 6465 7869   reducing indexi
+0000de60: 6e67 2061 6e64 2072 6574 7572 6e20 6120  ng and return a 
+0000de70: 6c69 7374 206f 6620 7661 6c69 6473 2069  list of valids i
+0000de80: 6e64 6578 6573 2060 6978 7360 2222 220d  ndexes `ixs`""".
+0000de90: 0a20 2020 2069 7873 203d 206c 6973 7428  .    ixs = list(
+0000dea0: 6978 7320 290d 0a20 2020 2066 6f72 2069  ixs )..    for i
+0000deb0: 692c 2069 7820 696e 2065 6e75 6d65 7261  i, ix in enumera
+0000dec0: 7465 2028 6978 7329 3a20 0d0a 2020 2020  te (ixs): ..    
+0000ded0: 2020 2020 6966 206e 6f74 2069 735f 6974      if not is_it
+0000dee0: 6572 6162 6c65 2820 6978 2920 3a20 0d0a  erable( ix) : ..
+0000def0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000df00: 6520 496e 6465 7845 7272 6f72 2028 2245  e IndexError ("E
+0000df10: 7870 6563 7473 2061 2070 6169 7220 7475  xpects a pair tu
+0000df20: 706c 6520 6f72 206c 6973 7420 692e 652e  ple or list i.e.
+0000df30: 5b73 7461 7274 2c20 7374 6f70 5d27 220d  [start, stop]'".
+0000df40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000df50: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000df60: 2220 666f 7220 7265 6475 6369 6e67 2069  " for reducing i
+0000df70: 6e64 6578 696e 673b 2067 6f74 207b 6978  ndexing; got {ix
+0000df80: 7d22 2920 0d0a 2020 2020 2020 2020 6966  }") ..        if
+0000df90: 206c 656e 2869 7829 2021 3d32 203a 200d   len(ix) !=2 : .
+0000dfa0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000dfb0: 7365 2049 6e64 6578 4572 726f 7228 6622  se IndexError(f"
+0000dfc0: 496e 6465 7820 6d75 7374 2062 6520 6120  Index must be a 
+0000dfd0: 7061 6972 205b 7374 6172 742c 2074 6f70  pair [start, top
+0000dfe0: 5d3a 2067 6f74 207b 6978 7d22 290d 0a20  ]: got {ix}").. 
+0000dff0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+0000e000: 2020 2020 2020 2020 2069 7820 3d20 5b69           ix = [i
+0000e010: 6e74 2028 6929 2066 6f72 2069 2069 6e20  nt (i) for i in 
+0000e020: 6978 205d 0d0a 2020 2020 2020 2020 6578  ix ]..        ex
+0000e030: 6365 7074 203a 200d 0a20 2020 2020 2020  cept : ..       
+0000e040: 2020 2020 2072 6169 7365 2049 6e64 6578       raise Index
+0000e050: 4572 726f 7228 2249 6e64 6578 2073 686f  Error("Index sho
+0000e060: 756c 6420 6265 2061 2070 6169 7220 7475  uld be a pair tu
+0000e070: 706c 652f 6c69 7374 206f 6620 696e 7465  ple/list of inte
+0000e080: 6765 7273 3b22 0d0a 2020 2020 2020 2020  gers;"..        
+0000e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e0a0: 2020 2020 2066 2220 6368 6563 6b20 7b69       f" check {i
+0000e0b0: 787d 2229 0d0a 2020 2020 2020 2020 656c  x}")..        el
+0000e0c0: 7365 3a20 6978 735b 6969 5d20 3d20 6978  se: ixs[ii] = ix
+0000e0d0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0000e0e0: 2072 6574 7572 6e20 6978 7320 0d0a 0d0a   return ixs ....
+0000e0f0: 6465 6620 6765 745f 7365 6374 696f 6e73  def get_sections
+0000e100: 5f66 726f 6d5f 6465 7074 6820 2028 7a2c  _from_depth  (z,
+0000e110: 207a 5f72 616e 6765 2c20 7265 7475 726e   z_range, return
+0000e120: 5f69 6e64 6578 203d 4661 6c73 6520 2920  _index =False ) 
+0000e130: 3a0d 0a20 2020 2022 2222 2047 6574 7320  :..    """ Gets 
+0000e140: 6171 7569 6665 7220 7365 6374 696f 6e73  aquifer sections
+0000e150: 2028 2775 7070 6572 272c 2027 6c6f 7765   ('upper', 'lowe
+0000e160: 7227 2920 696e 2064 6174 6120 277a 2720  r') in data 'z' 
+0000e170: 6672 6f6d 2074 6865 200d 0a20 2020 2064  from the ..    d
+0000e180: 6570 7468 2072 616e 6765 2e0d 0a20 2020  epth range...   
+0000e190: 200d 0a20 2020 2054 6869 7320 6d69 6768   ..    This migh
+0000e1a0: 7420 6265 2075 7365 6675 6c6c 2074 6f20  t be usefull to 
+0000e1b0: 636f 6d70 7574 6520 7468 6520 7468 6963  compute the thic
+0000e1c0: 6b6e 6573 7320 6f66 2074 6865 2061 7175  kness of the aqu
+0000e1d0: 6966 6572 2e20 0d0a 2020 2020 0d0a 2020  ifer. ..    ..  
+0000e1e0: 2020 5061 7261 6d65 7465 7273 200d 0a20    Parameters .. 
+0000e1f0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0000e200: 2020 207a 3a20 6172 7261 792d 6c69 6b65     z: array-like
+0000e210: 2031 6420 6f72 2070 642e 5365 7269 6573   1d or pd.Series
+0000e220: 200d 0a20 2020 2020 2020 2041 7272 6179   ..        Array
+0000e230: 206f 7220 7061 6e64 6173 2073 6572 6965   or pandas serie
+0000e240: 7320 636f 6e74 616e 696e 6720 7468 6520  s contaning the 
+0000e250: 6465 7074 6820 7661 6c75 6573 200d 0a20  depth values .. 
+0000e260: 2020 207a 5f72 616e 6765 3a20 7475 706c     z_range: tupl
+0000e270: 6520 2866 6c6f 6174 292c 200d 0a20 2020  e (float), ..   
+0000e280: 2020 2020 2053 6563 7469 6f6e 205b 2775       Section ['u
+0000e290: 7070 6572 272c 2027 6c6f 7765 7227 5d20  pper', 'lower'] 
+0000e2a0: 6f66 2074 6865 2061 7175 6966 6572 2061  of the aquifer a
+0000e2b0: 7420 6469 6666 6572 6e74 2064 6570 7468  t differnt depth
+0000e2c0: 2e0d 0a20 2020 2020 2020 2054 6865 2072  ...        The r
+0000e2d0: 616e 6765 206f 6620 7468 6520 6465 7074  ange of the dept
+0000e2e0: 6820 6d75 7374 2061 2070 6169 7220 7661  h must a pair va
+0000e2f0: 6c75 6573 2061 6e64 2020 636f 756c 6420  lues and  could 
+0000e300: 6e6f 7420 6265 0d0a 2020 2020 2020 2020  not be..        
+0000e310: 2067 7265 6174 6572 2074 6861 6e20 7468   greater than th
+0000e320: 6520 6d61 7869 6d75 6d20 6465 7074 6820  e maximum depth 
+0000e330: 6f66 2074 6865 2077 656c 6c2e 200d 0a20  of the well. .. 
+0000e340: 2020 2072 6574 7572 6e5f 696e 6465 783a     return_index:
+0000e350: 2062 6f6f 6c2c 2064 6566 6175 6c74 3d46   bool, default=F
+0000e360: 616c 7365 200d 0a20 2020 2020 2020 2072  alse ..        r
+0000e370: 6574 7572 6e73 2074 6865 2069 6e64 6963  eturns the indic
+0000e380: 6573 206f 6620 7468 6520 7365 6374 696f  es of the sectio
+0000e390: 6e73 205b 2775 7070 6572 272c 2027 6c6f  ns ['upper', 'lo
+0000e3a0: 7765 7227 5d20 0d0a 2020 2020 2020 2020  wer'] ..        
+0000e3b0: 6f66 2074 6865 2061 7175 6966 6572 2061  of the aquifer a
+0000e3c0: 6e64 206e 6f6e 2d76 616c 6964 2073 6563  nd non-valid sec
+0000e3d0: 7469 6f6e 7320 746f 6f2e 200d 0a20 2020  tions too. ..   
+0000e3e0: 2020 2020 200d 0a20 2020 2052 6574 7572       ..    Retur
+0000e3f0: 6e73 200d 0a20 2020 202d 2d2d 2d2d 2d2d  ns ..    -------
+0000e400: 2d2d 2d0d 0a20 2020 2073 6563 7469 6f6e  ---..    section
+0000e410: 733a 2054 7570 6c65 2028 666c 6f61 742c  s: Tuple (float,
+0000e420: 2066 6c6f 6174 290d 0a20 2020 2020 2020   float)..       
+0000e430: 5265 616c 2076 616c 7565 7320 6f66 2074  Real values of t
+0000e440: 6865 2020 7570 7065 7220 616e 6420 6c6f  he  upper and lo
+0000e450: 7765 7220 7365 6374 696f 6e73 206f 6620  wer sections of 
+0000e460: 7468 6520 6171 7569 6665 722e 200d 0a20  the aquifer. .. 
+0000e470: 2020 2049 6620 6060 7265 7475 726e 5f69     If ``return_i
+0000e480: 6e64 6578 6060 2069 7320 2754 7275 6527  ndex`` is 'True'
+0000e490: 2c20 6675 6e63 7469 6f6e 2072 6574 7572  , function retur
+0000e4a0: 6e73 3a20 0d0a 2020 2020 2020 2875 7069  ns: ..      (upi
+0000e4b0: 782c 206c 6f77 6978 293a 2054 7570 6c65  x, lowix): Tuple
+0000e4c0: 2028 696e 742c 2069 6e74 2029 0d0a 2020   (int, int )..  
+0000e4d0: 2020 2020 2020 2020 696e 6469 6365 7320          indices 
+0000e4e0: 6f66 2075 7070 6572 2061 6e64 206c 6f77  of upper and low
+0000e4f0: 6572 2073 6563 7469 6f6e 7320 696e 2074  er sections in t
+0000e500: 6865 2064 6570 7468 2061 7272 6179 2060  he depth array `
+0000e510: 7a60 0d0a 2020 2020 2020 2869 6e76 6978  z`..      (invix
+0000e520: 293a 206c 6973 7420 6f66 2054 7570 6c65  ): list of Tuple
+0000e530: 2028 696e 742c 2069 6e74 2920 0d0a 2020   (int, int) ..  
+0000e540: 2020 2020 2020 2020 6c69 7374 206f 6620          list of 
+0000e550: 696e 6469 6365 7320 6f66 2069 6e76 616c  indices of inval
+0000e560: 6964 2073 6563 7469 6f6e 730d 0a20 2020  id sections..   
+0000e570: 2020 2020 2020 200d 0a20 2020 2045 7861         ..    Exa
+0000e580: 6d70 6c65 0d0a 2020 2020 2d2d 2d2d 2d2d  mple..    ------
+0000e590: 2d2d 0d0a 2020 2020 3e3e 3e20 6672 6f6d  --..    >>> from
+0000e5a0: 2077 6174 6578 2e64 6174 6173 6574 7320   watex.datasets 
+0000e5b0: 696d 706f 7274 206c 6f61 645f 686c 6f67  import load_hlog
+0000e5c0: 7320 0d0a 2020 2020 3e3e 3e20 6672 6f6d  s ..    >>> from
+0000e5d0: 2077 6174 6578 2e75 7469 6c73 2e68 7964   watex.utils.hyd
+0000e5e0: 726f 7574 696c 7320 696d 706f 7274 2067  routils import g
+0000e5f0: 6574 5f73 6563 7469 6f6e 735f 6672 6f6d  et_sections_from
+0000e600: 5f64 6570 7468 0d0a 2020 2020 3e3e 3e20  _depth..    >>> 
+0000e610: 6461 7461 3d20 6c6f 6164 5f68 6c6f 6773  data= load_hlogs
+0000e620: 2829 2e66 7261 6d65 2020 0d0a 2020 2020  ().frame  ..    
+0000e630: 3e3e 3e20 2320 6765 7420 7265 616c 2073  >>> # get real s
+0000e640: 6563 7469 6f6e 7320 6672 6f6d 2064 6570  ections from dep
+0000e650: 7468 2031 362e 3235 2074 6f20 3132 352e  th 16.25 to 125.
+0000e660: 3833 206d 0d0a 2020 2020 3e3e 3e20 6765  83 m..    >>> ge
+0000e670: 745f 7365 6374 696f 6e73 5f66 726f 6d5f  t_sections_from_
+0000e680: 6465 7074 6820 2820 6461 7461 2e64 6570  depth ( data.dep
+0000e690: 7468 5f74 6f70 2c20 2820 3136 2e32 352c  th_top, ( 16.25,
+0000e6a0: 2031 3235 2e38 3329 290d 0a20 2020 202e   125.83))..    .
+0000e6b0: 2e2e 2020 2832 322e 3436 2c20 3132 382e  ..  (22.46, 128.
+0000e6c0: 3233 290d 0a20 2020 203e 3e3e 2023 2061  23)..    >>> # a
+0000e6d0: 7175 6966 6572 2064 6570 7468 2066 726f  quifer depth fro
+0000e6e0: 6d20 3136 2e32 3520 6d20 746f 2074 6865  m 16.25 m to the
+0000e6f0: 2065 6e64 200d 0a20 2020 203e 3e3e 2067   end ..    >>> g
+0000e700: 6574 5f73 6563 7469 6f6e 735f 6672 6f6d  et_sections_from
+0000e710: 5f64 6570 7468 2028 2064 6174 612e 6465  _depth ( data.de
+0000e720: 7074 685f 746f 702c 2028 2031 362e 3235  pth_top, ( 16.25
+0000e730: 2c29 290d 0a20 2020 202e 2e2e 2028 3232  ,))..    ... (22
+0000e740: 2e34 362c 2036 3933 2e33 3729 0d0a 2020  .46, 693.37)..  
+0000e750: 2020 3e3e 3e20 6765 745f 7365 6374 696f    >>> get_sectio
+0000e760: 6e73 5f66 726f 6d5f 6465 7074 6820 2820  ns_from_depth ( 
+0000e770: 6461 7461 2e64 6570 7468 5f74 6f70 2c20  data.depth_top, 
+0000e780: 2820 3136 2e32 352c 2031 3235 2e38 3329  ( 16.25, 125.83)
+0000e790: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000e7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e7b0: 2020 2020 7265 7475 726e 5f69 6e64 6578      return_index
+0000e7c0: 203d 5472 7565 2029 0d0a 2020 2020 2e2e   =True )..    ..
+0000e7d0: 2e20 2828 332c 2031 3129 2c20 5b28 302c  . ((3, 11), [(0,
+0000e7e0: 2033 292c 2028 3131 2c20 3138 3029 5d29   3), (11, 180)])
+0000e7f0: 0d0a 2020 2020 3e3e 3e20 6765 745f 7365  ..    >>> get_se
+0000e800: 6374 696f 6e73 5f66 726f 6d5f 6465 7074  ctions_from_dept
+0000e810: 6820 2820 6461 7461 2e64 6570 7468 5f74  h ( data.depth_t
+0000e820: 6f70 2c20 2820 3136 2e32 352c 292c 200d  op, ( 16.25,), .
+0000e830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e850: 2020 7265 7475 726e 5f69 6e64 6578 203d    return_index =
+0000e860: 5472 7565 2029 0d0a 2020 2020 2e2e 2e20  True )..    ... 
+0000e870: 2828 332c 2031 3831 292c 205b 2830 2c20  ((3, 181), [(0, 
+0000e880: 3329 5d29 0d0a 200d 0a20 2020 2022 2222  3)]).. ..    """
+0000e890: 0d0a 2020 2020 7a20 3d20 5f61 7373 6572  ..    z = _asser
+0000e8a0: 745f 616c 6c5f 7479 7065 7328 7a2c 2070  t_all_types(z, p
+0000e8b0: 642e 5365 7269 6573 2c20 6e70 2e6e 6461  d.Series, np.nda
+0000e8c0: 7272 6179 202c 2022 4465 7074 6822 290d  rray , "Depth").
+0000e8d0: 0a20 2020 2069 6620 6e6f 7420 5f69 735f  .    if not _is_
+0000e8e0: 6172 7261 796c 696b 655f 3164 2028 7a29  arraylike_1d (z)
+0000e8f0: 203a 200d 0a20 2020 2020 2020 2072 6169   : ..        rai
+0000e900: 7365 2044 6570 7468 4572 726f 7228 2022  se DepthError( "
+0000e910: 4465 7074 6820 6578 7065 6374 7320 6f6e  Depth expects on
+0000e920: 652d 6469 6d65 6e73 696f 6e61 6c20 6172  e-dimensional ar
+0000e930: 7261 792e 2229 0d0a 2020 2020 2020 2020  ray.")..        
+0000e940: 0d0a 2020 2020 2320 6368 6563 6b20 6465  ..    # check de
+0000e950: 7074 6820 7a20 6172 7261 7920 0d0a 2020  pth z array ..  
+0000e960: 2020 7a3d 2063 6865 636b 5f79 2028 0d0a    z= check_y (..
+0000e970: 2020 2020 2020 2020 7a2c 200d 0a20 2020          z, ..   
+0000e980: 2020 2020 2069 6e70 7574 5f6e 616d 653d       input_name=
+0000e990: 2022 4172 7261 7920 6f66 2064 6570 7468   "Array of depth
+0000e9a0: 2027 7a27 222c 200d 0a20 2020 2020 2020   'z'", ..       
+0000e9b0: 2074 6f5f 6672 616d 6520 3d54 7275 652c   to_frame =True,
+0000e9c0: 200d 0a20 2020 2020 2020 2029 0d0a 2020   ..        )..  
+0000e9d0: 2020 6966 206e 6f74 2069 735f 6974 6572    if not is_iter
+0000e9e0: 6162 6c65 287a 5f72 616e 6765 293a 200d  able(z_range): .
+0000e9f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000ea00: 5479 7065 4572 726f 7220 2822 4465 7074  TypeError ("Dept
+0000ea10: 6820 7261 6e67 6520 6d75 7374 2062 6520  h range must be 
+0000ea20: 616e 2069 7465 7261 626c 6520 6f62 6a65  an iterable obje
+0000ea30: 6374 2c22 0d0a 2020 2020 2020 2020 2020  ct,"..          
+0000ea40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ea50: 6622 206e 6f74 207b 7479 7065 2028 7a5f  f" not {type (z_
+0000ea60: 7261 6e67 6529 2e5f 5f6e 616d 655f 5f21  range).__name__!
+0000ea70: 727d 2229 0d0a 2020 2020 7a5f 7261 6e67  r}")..    z_rang
+0000ea80: 653d 2073 6f72 7465 6420 2820 6c69 7374  e= sorted ( list
+0000ea90: 287a 5f72 616e 6765 2029 2029 200d 0a20  (z_range ) ) .. 
+0000eaa0: 2020 2069 6620 6d61 7828 7a5f 7261 6e67     if max(z_rang
+0000eab0: 6520 2920 3e20 6d61 7828 7a29 3a20 0d0a  e ) > max(z): ..
+0000eac0: 2020 2020 2020 2020 7261 6973 6520 4465          raise De
+0000ead0: 7074 6845 7272 6f72 2822 4465 7074 6820  pthError("Depth 
+0000eae0: 7661 6c75 6520 6361 6e6e 6f74 2062 6520  value cannot be 
+0000eaf0: 6772 6561 7465 7220 7468 616e 2074 6865  greater than the
+0000eb00: 206d 6178 696d 756d 2022 0d0a 2020 2020   maximum "..    
+0000eb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eb20: 2020 2020 2066 2264 6570 7468 2069 6e20       f"depth in 
+0000eb30: 7468 6520 7765 6c6c 3d20 7b6d 6178 287a  the well= {max(z
+0000eb40: 297d 3b20 676f 7420 7b6d 6178 287a 5f72  )}; got {max(z_r
+0000eb50: 616e 6765 297d 2229 0d0a 2020 2020 6966  ange)}")..    if
+0000eb60: 206c 656e 287a 5f72 616e 6765 293d 3d31   len(z_range)==1
+0000eb70: 3a20 0d0a 2020 2020 2020 2020 7761 726e  : ..        warn
+0000eb80: 696e 6773 2e77 6172 6e28 2253 696e 676c  ings.warn("Singl
+0000eb90: 6520 7661 6c75 6520 6973 2070 6173 7365  e value is passe
+0000eba0: 642e 2052 656d 656d 6265 722c 2069 7420  d. Remember, it 
+0000ebb0: 6d61 7920 636f 7272 6573 706f 6e64 2022  may correspond "
+0000ebc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000ebd0: 2020 2020 2020 2020 2274 6f20 7468 6520          "to the 
+0000ebe0: 6465 7074 6820 7661 6c75 6520 6f66 2074  depth value of t
+0000ebf0: 6865 2075 7070 6572 2073 6563 7469 6f6e  he upper section
+0000ec00: 2074 6869 6e20 7468 6520 656e 642e 2229   thin the end.")
+0000ec10: 0d0a 2020 2020 2020 2020 7a5f 7261 6e67  ..        z_rang
+0000ec20: 6520 3d20 7a5f 7261 6e67 6520 2b20 5b6d  e = z_range + [m
+0000ec30: 6178 2028 7a20 295d 0d0a 2020 2020 656c  ax (z )]..    el
+0000ec40: 6966 206c 656e 287a 5f72 616e 6765 2920  if len(z_range) 
+0000ec50: 3e20 323a 200d 0a20 2020 2020 2020 2072  > 2: ..        r
+0000ec60: 6169 7365 2044 6570 7468 4572 726f 7228  aise DepthError(
+0000ec70: 2022 546f 6f20 6d61 6e79 2076 616c 7565   "Too many value
+0000ec80: 7320 666f 7220 7468 6520 6465 7074 6820  s for the depth 
+0000ec90: 7365 6374 696f 6e20 7261 6e67 652e 220d  section range.".
+0000eca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ecb0: 2020 2020 2020 2020 2020 2245 7870 6563            "Expec
+0000ecc0: 7473 2061 2070 6169 7220 7661 6c75 6573  ts a pair values
+0000ecd0: 205b 2075 7070 6572 2c20 6c6f 7765 725d   [ upper, lower]
+0000ece0: 2073 6563 7469 6f6e 732e 220d 0a20 2020   sections."..   
+0000ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed00: 2020 2020 2020 290d 0a20 2020 2023 2067        )..    # g
+0000ed10: 6574 2074 6865 2069 6e64 6963 6573 2066  et the indices f
+0000ed20: 726f 6d20 6465 7074 6820 0d0a 2020 2020  rom depth ..    
+0000ed30: 7570 6978 2020 3d20 6e70 2e61 7267 6d69  upix  = np.argmi
+0000ed40: 6e20 2028 206e 702e 6162 7320 2820 0d0a  n  ( np.abs ( ..
+0000ed50: 2020 2020 2020 2020 286e 702e 6172 7261          (np.arra
+0000ed60: 7928 7a29 202d 207a 5f72 616e 6765 205b  y(z) - z_range [
+0000ed70: 305d 2029 2029 2029 200d 0a20 2020 206c  0] ) ) ) ..    l
+0000ed80: 6f77 6978 203d 206e 702e 6172 676d 696e  owix = np.argmin
+0000ed90: 2020 2820 6e70 2e61 6273 2028 0d0a 2020    ( np.abs (..  
+0000eda0: 2020 2020 2020 286e 702e 6172 7261 7928        (np.array(
+0000edb0: 7a29 202d 207a 5f72 616e 6765 205b 2d31  z) - z_range [-1
+0000edc0: 5d20 2920 2920 2920 0d0a 2020 2020 2320  ] ) ) ) ..    # 
+0000edd0: 666f 7220 636f 6e73 6973 7465 6e63 7920  for consistency 
+0000ede0: 2c20 7265 7365 745f 7a72 616e 6765 2077  , reset_zrange w
+0000edf0: 6974 6820 0d0a 2020 2020 2320 7472 7565  ith ..    # true
+0000ee00: 2076 616c 7565 7320 6672 6f6d 2064 6570   values from dep
+0000ee10: 7468 207a 200d 0a20 2020 2073 6563 7469  th z ..    secti
+0000ee20: 6f6e 7320 3d20 2820 7a20 5b75 7069 7820  ons = ( z [upix 
+0000ee30: 5d2c 207a 5b6c 6f77 6978 205d 2029 2020  ], z[lowix ] )  
+0000ee40: 0d0a 2020 2020 7a5f 7261 6e67 6520 3d20  ..    z_range = 
+0000ee50: 206e 702e 6172 7261 7920 2820 2820 7570   np.array ( ( up
+0000ee60: 6978 202c 206c 6f77 6978 2029 202c 2064  ix , lowix ) , d
+0000ee70: 7479 7065 203d 206e 702e 696e 7433 3220  type = np.int32 
+0000ee80: 2920 0d0a 0d0a 2020 2020 2320 636f 6d70  ) ....    # comp
+0000ee90: 7574 6520 7468 6520 6469 6666 6572 656e  ute the differen
+0000eea0: 6365 2062 6574 7765 656e 2061 646a 6163  ce between adjac
+0000eeb0: 656e 7420 6465 7074 6873 0d0a 2020 2020  ent depths..    
+0000eec0: 6469 6666 203d 206e 702e 6469 6666 2028  diff = np.diff (
+0000eed0: 7a29 200d 0a20 2020 2023 2077 6865 6e20  z) ..    # when 
+0000eee0: 6465 7074 6820 0d0a 2020 2020 6966 2073  depth ..    if s
+0000eef0: 6574 2028 7365 6374 696f 6e73 2029 3d3d  et (sections )==
+0000ef00: 313a 200d 0a20 2020 2020 2020 2072 6169  1: ..        rai
+0000ef10: 7365 2044 6570 7468 4572 726f 7228 2255  se DepthError("U
+0000ef20: 7070 6572 2061 6e64 206c 6f77 6572 2073  pper and lower s
+0000ef30: 6563 7469 6f6e 7320 6d75 7374 2068 6176  ections must hav
+0000ef40: 6520 6469 6666 6572 656e 7420 6465 7074  e different dept
+0000ef50: 6873 2e22 290d 0a20 2020 200d 0a20 2020  hs.")..    ..   
+0000ef60: 2069 6620 2820 666c 6f61 7428 206e 702e   if ( float( np.
+0000ef70: 6469 6666 2028 7365 6374 696f 6e73 2929  diff (sections))
+0000ef80: 203c 3d64 6966 662e 6d69 6e28 2920 293a   <=diff.min() ):
+0000ef90: 200d 0a20 2020 2020 2020 2023 2074 6869   ..        # thi
+0000efa0: 636b 6e65 7373 2074 6f20 7061 7373 2074  ckness to pass t
+0000efb0: 6f20 616e 6f74 6865 7220 6c61 7965 7273  o another layers
+0000efc0: 200d 0a20 2020 2020 2020 2072 6169 7365   ..        raise
+0000efd0: 2044 6570 7468 4572 726f 7228 6622 4465   DepthError(f"De
+0000efe0: 7074 6820 7b7a 5f72 616e 6765 7d20 6172  pth {z_range} ar
+0000eff0: 6520 746f 6f20 636c 6f73 6520 7468 6174  e too close that
+0000f000: 2070 726f 6261 626c 7920 220d 0a20 2020   probably "..   
+0000f010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f020: 2020 2020 2020 2266 6967 7572 6520 6f75        "figure ou
+0000f030: 7420 7468 6520 7361 6d65 206c 6179 6572  t the same layer
+0000f040: 2e20 4469 6666 6572 656e 6365 2062 6574  . Difference bet
+0000f050: 7765 656e 2022 0d0a 2020 2020 2020 2020  ween "..        
+0000f060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f070: 2022 6164 6a61 6365 6e74 2064 6570 7468   "adjacent depth
+0000f080: 7320 6d75 7374 2062 6520 6772 6561 7465  s must be greate
+0000f090: 7220 7468 616e 220d 0a20 2020 2020 2020  r than"..       
+0000f0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f0b0: 2066 2220 7b72 6f75 6e64 2028 2066 6c6f   f" {round ( flo
+0000f0c0: 6174 2864 6966 662e 6d69 6e28 2929 2c20  at(diff.min()), 
+0000f0d0: 3229 207d 2229 0d0a 2020 2020 2320 6e6f  2) }")..    # no
+0000f0e0: 7420 6765 7420 7468 6520 696e 6465 7820  t get the index 
+0000f0f0: 6672 6f6d 206e 6f6e 2076 616c 6964 2064  from non valid d
+0000f100: 6174 610d 0a20 2020 2023 202b 3120 666f  ata..    # +1 fo
+0000f110: 7220 5079 7468 6f6e 2069 6e64 6578 696e  r Python indexin
+0000f120: 670d 0a20 2020 2069 6e76 6978 203d 205f  g..    invix = _
+0000f130: 6765 745f 696e 7661 6c69 645f 696e 6465  get_invalid_inde
+0000f140: 7865 7320 287a 2c20 7a5f 7261 6e67 6520  xes (z, z_range 
+0000f150: 290d 0a20 2020 200d 0a20 2020 2072 6574  )..    ..    ret
+0000f160: 7572 6e20 2073 6563 7469 6f6e 7320 6966  urn  sections if
+0000f170: 206e 6f74 2020 7265 7475 726e 5f69 6e64   not  return_ind
+0000f180: 6578 2065 6c73 6520 2820 0d0a 2020 2020  ex else ( ..    
+0000f190: 2020 2020 2820 7570 6978 202c 206c 6f77      ( upix , low
+0000f1a0: 6978 202b 2031 2029 2c20 2069 6e76 6978  ix + 1 ),  invix
+0000f1b0: 2029 200d 0a0d 0a0d 0a64 6566 2067 6574   ) ......def get
+0000f1c0: 5f75 6e69 7175 655f 7365 6374 696f 6e20  _unique_section 
+0000f1d0: 280d 0a20 2020 2020 2020 202a 6461 7461  (..        *data
+0000f1e0: 2c20 7a6e 616d 652c 206b 6e61 6d65 2c20  , zname, kname, 
+0000f1f0: 2072 6574 7572 6e5f 696e 6465 783d 4661   return_index=Fa
+0000f200: 6c73 652c 2072 6574 7572 6e5f 6461 7461  lse, return_data
+0000f210: 203d 4661 6c73 652c 200d 0a20 2020 2020   =False, ..     
+0000f220: 2020 2065 7272 6f72 3d27 7261 6973 6527     error='raise'
+0000f230: 2c20 2a2a 6b77 7320 2920 3a20 0d0a 0d0a  , **kws ) : ....
+0000f240: 2020 2020 7365 6374 2c20 6461 7420 3d20      sect, dat = 
+0000f250: 6765 745f 6171 7569 6665 725f 7365 6374  get_aquifer_sect
+0000f260: 696f 6e73 282a 6461 7461 2c20 7a6e 616d  ions(*data, znam
+0000f270: 653d 7a6e 616d 652c 206b 6e61 6d65 3d6b  e=zname, kname=k
+0000f280: 6e61 6d65 2c20 0d0a 2020 2020 2020 2020  name, ..        
+0000f290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f2a0: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
+0000f2b0: 696e 6465 7820 3d72 6574 7572 6e5f 696e  index =return_in
+0000f2c0: 6465 782c 200d 0a20 2020 2020 2020 2020  dex, ..         
+0000f2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f2e0: 2020 2020 2020 2020 7265 7475 726e 5f64          return_d
+0000f2f0: 6174 613d 2054 7275 652c 0d0a 2020 2020  ata= True,..    
+0000f300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f310: 2020 2020 2020 2020 2020 2020 2065 7272               err
+0000f320: 6f72 203d 2065 7272 6f72 202c 202a 2a6b  or = error , **k
+0000f330: 7773 290d 0a20 2020 2073 6563 7420 3d20  ws)..    sect = 
+0000f340: 6e70 2e61 7272 6179 2028 6c69 7374 2869  np.array (list(i
+0000f350: 7465 7274 6f6f 6c73 2e63 6861 696e 282a  tertools.chain(*
+0000f360: 7365 6374 2929 290d 0a20 2020 2073 6920  sect)))..    si 
+0000f370: 3d20 6e70 2e61 7272 6179 2028 5b73 6563  = np.array ([sec
+0000f380: 742e 6d69 6e28 292c 2073 6563 742e 6d61  t.min(), sect.ma
+0000f390: 7828 295d 2c20 0d0a 2020 2020 2020 2020  x()], ..        
+0000f3a0: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
+0000f3b0: 203d 206e 702e 696e 7433 3220 6966 2072   = np.int32 if r
+0000f3c0: 6574 7572 6e5f 696e 6465 7820 656c 7365  eturn_index else
+0000f3d0: 206e 702e 666c 6f61 7433 3220 290d 0a20   np.float32 ).. 
+0000f3e0: 2020 2072 6574 7572 6e20 7369 2069 6620     return si if 
+0000f3f0: 6e6f 7420 7265 7475 726e 5f64 6174 6120  not return_data 
+0000f400: 656c 7365 2020 2820 7369 2c20 6461 7420  else  ( si, dat 
+0000f410: 2920 0d0a 0d0a 6765 745f 756e 6971 7565  ) ....get_unique
+0000f420: 5f73 6563 7469 6f6e 2e5f 5f64 6f63 5f5f  _section.__doc__
+0000f430: 3d22 2222 5c0d 0a47 6574 2074 6865 2073  ="""\..Get the s
+0000f440: 6563 7469 6f6e 2074 6f20 636f 6e73 6964  ection to consid
+0000f450: 6572 2075 6e69 7175 6520 696e 206d 756c  er unique in mul
+0000f460: 7469 706c 6520 6171 7569 6665 7273 2e20  tiple aquifers. 
+0000f470: 0d0a 0d0a 5468 6520 756e 6971 7565 2073  ....The unique s
+0000f480: 6563 7469 6f6e 2027 7570 7065 7227 2061  ection 'upper' a
+0000f490: 6e64 2027 6c6f 7765 7227 2069 7320 7468  nd 'lower' is th
+0000f4a0: 6520 7661 6c69 6420 7261 6e67 6520 6f66  e valid range of
+0000f4b0: 2074 6865 2077 686f 6c65 200d 0a73 6563   the whole ..sec
+0000f4c0: 7469 6f6e 7320 6f66 2065 6163 6820 6171  tions of each aq
+0000f4d0: 7569 6665 7273 2e20 4974 2069 7320 2063  uifers. It is  c
+0000f4e0: 6f6e 7369 6465 7265 6420 6173 2020 7468  onsidered as  th
+0000f4f0: 6520 6d61 696e 2076 616c 6964 2073 6563  e main valid sec
+0000f500: 7469 6f6e 200d 0a66 726f 6d20 7768 6963  tion ..from whic
+0000f510: 6820 6461 7461 2063 616e 206e 6f74 2062  h data can not b
+0000f520: 6520 636f 6d70 7265 7373 6564 2061 6e64  e compressed and
+0000f530: 206e 6f74 2061 6c74 6572 6564 2e20 466f   not altered. Fo
+0000f540: 7220 696e 7374 616e 6365 2c20 200d 0a74  r instance,  ..t
+0000f550: 6865 2075 7365 206f 6620 696e 6465 7865  he use of indexe
+0000f560: 7320 6973 2020 6e65 6365 7373 6172 7920  s is  necessary 
+0000f570: 746f 2073 6872 756e 6b20 7468 6520 6461  to shrunk the da
+0000f580: 7461 2065 7863 6570 7420 7468 6973 2076  ta except this v
+0000f590: 616c 6964 200d 0a73 6563 7469 6f6e 2e20  alid ..section. 
+0000f5a0: 4d6f 736c 7920 7468 6520 6461 7461 2066  Mosly the data f
+0000f5b0: 726f 6d20 7468 6520 7365 6374 696f 6e20  rom the section 
+0000f5c0: 6973 2063 6f6e 7369 6465 7265 6420 7468  is considered th
+0000f5d0: 6520 7661 6c69 6420 6461 7461 2061 7320  e valid data as 
+0000f5e0: 7468 6520 0d0a 7072 6564 6963 746f 7220  the ..predictor 
+0000f5f0: 5872 2e20 4f75 7420 6f66 2074 6865 2072  Xr. Out of the r
+0000f600: 616e 6765 206f 6620 6171 7569 6665 7273  ange of aquifers
+0000f610: 2065 6374 696f 6e2c 2064 6174 6120 6361   ection, data ca
+0000f620: 6e20 6265 2064 6973 6361 7264 6564 206f  n be discarded o
+0000f630: 7220 0d0a 636f 6d70 7265 7373 6564 2074  r ..compressed t
+0000f640: 6f20 746f 7020 5872 2e20 0d0a 0d0a 5265  o top Xr. ....Re
+0000f650: 7475 726e 7320 7661 6c69 6420 7365 6374  turns valid sect
+0000f660: 696f 6e20 696e 6465 7865 7320 6966 2027  ion indexes if '
+0000f670: 7265 7475 726e 5f69 6e64 6578 2720 6973  return_index' is
+0000f680: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
+0000f690: 2e20 2020 200d 0a20 2020 200d 0a50 6172  .    ..    ..Par
+0000f6a0: 616d 6574 6572 730d 0a2d 2d2d 2d2d 2d2d  ameters..-------
+0000f6b0: 2d2d 2d2d 0d0a 643a 206c 6973 7420 6f66  ----..d: list of
+0000f6c0: 2070 616e 6461 7320 6461 7461 6672 616d   pandas datafram
+0000f6d0: 6520 0d0a 2020 2020 4461 7461 2074 6861  e ..    Data tha
+0000f6e0: 7420 636f 6e74 6169 6e73 206d 6169 6e6c  t contains mainl
+0000f6f0: 7920 7468 6520 6171 7569 6665 7220 7661  y the aquifer va
+0000f700: 6c75 6573 2e20 4974 206e 6565 6473 2074  lues. It needs t
+0000f710: 6f20 7370 6563 6966 7920 7468 6520 0d0a  o specify the ..
+0000f720: 2020 2020 6e61 6d65 206f 6620 7468 6520      name of the 
+0000f730: 6465 7074 6820 636f 6c75 6d6e 2060 7a6e  depth column `zn
+0000f740: 616d 6560 2061 7320 7765 6c6c 2061 7320  ame` as well as 
+0000f750: 7468 6520 6e61 6d65 206f 6620 7065 726d  the name of perm
+0000f760: 6561 6269 6c69 7920 0d0a 2020 2020 606b  eabiliy ..    `k
+0000f770: 6e61 6d65 6020 636f 6c75 6d6e 2e20 200d  name` column.  .
+0000f780: 0a7b 7061 7261 6d73 2e63 6f72 652e 7a6e  .{params.core.zn
+0000f790: 616d 657d 0d0a 7b70 6172 616d 732e 636f  ame}..{params.co
+0000f7a0: 7265 2e6b 6e61 6d65 7d0d 0a7b 7061 7261  re.kname}..{para
+0000f7b0: 6d73 2e63 6f72 652e 7a7d 0d0a 0d0a 7265  ms.core.z}....re
+0000f7c0: 7475 726e 5f69 6e64 6578 3a20 626f 6f6c  turn_index: bool
+0000f7d0: 2c20 6465 6661 756c 7420 3d46 616c 7365  , default =False
+0000f7e0: 202c 200d 0a20 2020 2052 6574 7572 6e73   , ..    Returns
+0000f7f0: 2074 6865 2070 6f73 6974 696f 6e73 2028   the positions (
+0000f800: 696e 6465 7865 7329 206f 6620 7468 6520  indexes) of the 
+0000f810: 7570 7065 7220 616e 6420 6c6f 7765 7220  upper and lower 
+0000f820: 7365 6374 696f 6e73 206f 6620 7468 650d  sections of the.
+0000f830: 0a20 2020 2073 6861 6c6c 6f77 6572 2020  .    shallower  
+0000f840: 616e 6420 6465 6570 2061 7175 6966 6572  and deep aquifer
+0000f850: 7320 666f 756e 6420 696e 2074 6865 2077  s found in the w
+0000f860: 686f 6c65 2020 6461 7461 6672 616d 6573  hole  dataframes
+0000f870: 2e0d 0a72 6574 7572 6e5f 6461 7461 3a20  ...return_data: 
+0000f880: 626f 6f6c 2c20 6465 6661 756c 743d 4661  bool, default=Fa
+0000f890: 6c73 652c 200d 0a20 2020 2052 6574 7572  lse, ..    Retur
+0000f8a0: 6e20 7661 6c69 6420 6461 7461 2e20 4974  n valid data. It
+0000f8b0: 2069 7320 7573 6566 756c 6c20 7768 656e   is usefull when
+0000f8c0: 2027 6572 726f 7227 2069 7320 7365 7420   'error' is set 
+0000f8d0: 746f 2027 6967 6e6f 7265 270d 0a20 2020  to 'ignore'..   
+0000f8e0: 2074 6f20 636f 6c6c 6563 7420 7468 6520   to collect the 
+0000f8f0: 7661 6c69 6420 6461 7461 2e20 0d0a 6572  valid data. ..er
+0000f900: 726f 723a 2073 7472 2c20 6465 6661 756c  ror: str, defaul
+0000f910: 743d 2772 6169 7365 2720 0d0a 2020 2020  t='raise' ..    
+0000f920: 5261 6973 6520 6572 726f 7273 2069 6620  Raise errors if 
+0000f930: 7472 6f75 626c 6520 6f63 6375 7273 2077  trouble occurs w
+0000f940: 6865 6e20 636f 6d70 7574 696e 6720 7468  hen computing th
+0000f950: 6520 7365 6374 696f 6e20 6f66 2065 6163  e section of eac
+0000f960: 6820 6171 7569 6665 722e 200d 0a20 2020  h aquifer. ..   
+0000f970: 2049 6620 2769 676e 6f72 6527 2c20 6120   If 'ignore', a 
+0000f980: 5573 6572 5761 726e 696e 6720 6973 2064  UserWarning is d
+0000f990: 6973 706c 6179 6564 2077 6865 6e20 696e  isplayed when in
+0000f9a0: 7661 6c69 6420 6461 7461 2069 7320 666f  valid data is fo
+0000f9b0: 756e 642e 2041 6e79 200d 0a20 2020 206f  und. Any ..    o
+0000f9c0: 7468 6572 2076 616c 7565 206f 6620 6065  ther value of `e
+0000f9d0: 7272 6f72 6020 7769 6c6c 2073 6574 2065  rror` will set e
+0000f9e0: 7272 6f72 2074 6f20 6072 6169 7365 602e  rror to `raise`.
+0000f9f0: 200d 0a6b 7773 3a20 6469 6374 2c20 0d0a   ..kws: dict, ..
+0000fa00: 2020 2020 4164 6469 7469 6f6e 616c 206b      Additional k
+0000fa10: 6579 776f 7264 7320 6172 6775 6d65 6e74  eywords argument
+0000fa20: 7320 7061 7373 6564 2020 746f 2020 0d0a  s passed  to  ..
+0000fa30: 2020 2020 3a66 756e 633a 607e 7761 7465      :func:`~wate
+0000fa40: 782e 7574 696c 732e 6879 6472 6f75 7469  x.utils.hydrouti
+0000fa50: 6c73 2e67 6574 5f61 7175 6966 6572 5f73  ls.get_aquifer_s
+0000fa60: 6563 7469 6f6e 7360 2e0d 0a20 2020 200d  ections`...    .
+0000fa70: 0a52 6574 7572 6e73 200d 0a2d 2d2d 2d2d  .Returns ..-----
+0000fa80: 2d2d 2d0d 0a75 702c 206c 6f77 203a 6c69  ---..up, low :li
+0000fa90: 7374 206f 6620 7570 7065 7220 616e 6420  st of upper and 
+0000faa0: 6c6f 7765 7220 7365 6374 696f 6e20 7661  lower section va
+0000fab0: 6c75 6573 206f 6620 6171 7569 6665 722e  lues of aquifer.
+0000fac0: 0d0a 2020 2020 2d20 2875 7069 782c 206c  ..    - (upix, l
+0000fad0: 6f77 6978 2029 3a20 5475 706c 6520 6f66  owix ): Tuple of
+0000fae0: 2069 6e64 6578 6573 206f 6620 6c6f 7765   indexes of lowe
+0000faf0: 7220 616e 6420 7570 7065 7220 7365 6374  r and upper sect
+0000fb00: 696f 6e73 2020 0d0a 2020 2020 2d20 2875  ions  ..    - (u
+0000fb10: 702c 206c 6f77 293a 2054 7570 6c65 206f  p, low): Tuple o
+0000fb20: 6620 6171 7569 6665 7220 7365 6374 696f  f aquifer sectio
+0000fb30: 6e73 2028 7570 7065 7220 616e 6420 6c6f  ns (upper and lo
+0000fb40: 7765 7229 2020 0d0a 2020 2020 2d20 2875  wer)  ..    - (u
+0000fb50: 7069 782c 206c 6f77 6978 292c 2028 7570  pix, lowix), (up
+0000fb60: 2c20 6c6f 7729 203a 2070 6f73 6974 696f  , low) : positio
+0000fb70: 6e73 2061 6e64 2073 6563 7469 6f6e 7320  ns and sections 
+0000fb80: 7661 6c75 6573 206f 6620 6171 7569 6665  values of aquife
+0000fb90: 7273 200d 0a20 2020 2020 2020 2069 6620  rs ..        if 
+0000fba0: 6072 6574 7572 6e5f 696e 6465 7860 2061  `return_index` a
+0000fbb0: 6e64 2072 6574 7572 6e5f 7365 6374 696f  nd return_sectio
+0000fbc0: 6e73 6020 6172 6520 6060 5472 7565 6060  ns` are ``True``
+0000fbd0: 2e20 200d 0a0d 0a53 6565 2041 6c73 6f20  .  ....See Also 
+0000fbe0: 0d0a 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 7761  ..----------..wa
+0000fbf0: 7465 782e 7574 696c 732e 6879 6472 6f75  tex.utils.hydrou
+0000fc00: 7469 6c73 2e67 6574 5f61 7175 6966 6572  tils.get_aquifer
+0000fc10: 5f73 6563 7469 6f6e 3a20 636f 6d70 7574  _section: comput
+0000fc20: 6520 7369 6e67 6c65 2073 6563 7469 6f6e  e single section
+0000fc30: 0d0a 0d0a 7761 7465 782e 7574 696c 732e  ....watex.utils.
+0000fc40: 6879 6472 6f75 7469 6c73 2e67 6574 5f61  hydroutils.get_a
+0000fc50: 7175 6966 6572 5f73 6563 7469 6f6e 733a  quifer_sections:
+0000fc60: 2063 6f6d 7075 7465 206d 756c 7469 706c   compute multipl
+0000fc70: 6520 7365 6374 696f 6e73 200d 0a20 0d0a  e sections .. ..
+0000fc80: 0d0a 4578 616d 706c 650d 0a2d 2d2d 2d2d  ..Example..-----
+0000fc90: 2d2d 2020 200d 0a3e 3e3e 2066 726f 6d20  --   ..>>> from 
+0000fca0: 7761 7465 782e 6461 7461 7365 7473 2069  watex.datasets i
+0000fcb0: 6d70 6f72 7420 6c6f 6164 5f68 6c6f 6773  mport load_hlogs
+0000fcc0: 200d 0a3e 3e3e 2064 6174 6120 3d20 6c6f   ..>>> data = lo
+0000fcd0: 6164 5f68 6c6f 6773 2028 292e 6672 616d  ad_hlogs ().fram
+0000fce0: 6520 0d0a 3e3e 3e20 6765 745f 756e 6971  e ..>>> get_uniq
+0000fcf0: 7565 5f73 6563 7469 6f6e 2028 6461 7461  ue_section (data
+0000fd00: 2e63 6f70 7928 2920 2c20 7a6e 616d 6520  .copy() , zname 
+0000fd10: 3d27 6465 7074 6827 2c20 6b6e 616d 6520  ='depth', kname 
+0000fd20: 3d27 6b27 2c20 2920 0d0a 2e2e 2e20 6172  ='k', ) ..... ar
+0000fd30: 7261 7928 5b31 3937 2e31 322c 2033 3639  ray([197.12, 369
+0000fd40: 2e37 315d 2c20 6474 7970 653d 666c 6f61  .71], dtype=floa
+0000fd50: 7433 3229 0d0a 3e3e 3e20 6765 745f 756e  t32)..>>> get_un
+0000fd60: 6971 7565 5f73 6563 7469 6f6e 7320 2864  ique_sections (d
+0000fd70: 6174 612e 636f 7079 2829 202c 207a 6e61  ata.copy() , zna
+0000fd80: 6d65 203d 2764 6570 7468 272c 206b 6e61  me ='depth', kna
+0000fd90: 6d65 203d 276b 272c 200d 0a20 2020 2020  me ='k', ..     
+0000fda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fdb0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000fdc0: 6e5f 696e 6465 7820 3d54 7275 6529 0d0a  n_index =True)..
+0000fdd0: 2e2e 2e20 6172 7261 7928 5b31 362c 2032  ... array([16, 2
+0000fde0: 395d 290d 0a0d 0a22 2222 2e66 6f72 6d61  9])....""".forma
+0000fdf0: 7428 0d0a 2020 2020 7061 7261 6d73 3d5f  t(..    params=_
+0000fe00: 7061 7261 6d5f 646f 6373 2c0d 0a20 2020  param_docs,..   
+0000fe10: 2029 0d0a 2020 2020 0d0a 6465 6620 6765   )..    ..def ge
+0000fe20: 745f 6171 7569 6665 725f 7365 6374 696f  t_aquifer_sectio
+0000fe30: 6e73 2028 0d0a 2020 2020 2a64 6174 6120  ns (..    *data 
+0000fe40: 2c20 200d 0a20 2020 207a 6e61 6d65 2c20  ,  ..    zname, 
+0000fe50: 0d0a 2020 2020 6b6e 616d 652c 200d 0a20  ..    kname, .. 
+0000fe60: 2020 2072 6574 7572 6e5f 696e 6465 7820     return_index 
+0000fe70: 3d46 616c 7365 2c20 0d0a 2020 2020 7265  =False, ..    re
+0000fe80: 7475 726e 5f64 6174 613d 4661 6c73 652c  turn_data=False,
+0000fe90: 0d0a 2020 2020 6572 726f 7220 3d20 2769  ..    error = 'i
+0000fea0: 676e 6f72 6527 2c20 200d 0a20 2020 202a  gnore',  ..    *
+0000feb0: 2a6b 7773 200d 0a20 2020 2029 3a20 0d0a  *kws ..    ): ..
+0000fec0: 0d0a 2020 2020 6572 726f 7273 203d 205b  ..    errors = [
+0000fed0: 5d0d 0a20 2020 2069 735f 7661 6c69 645f  ]..    is_valid_
+0000fee0: 6466 7320 3d20 5b5d 203b 2069 735f 6e6f  dfs = [] ; is_no
+0000fef0: 745f 7661 6c69 6420 3d5b 5d0d 0a20 2020  t_valid =[]..   
+0000ff00: 2073 6563 7469 6f6e 5f69 6e64 6578 6573   section_indexes
+0000ff10: 202c 7365 6374 696f 6e73 203d 5b5d 202c   ,sections =[] ,
+0000ff20: 205b 5d0d 0a20 2020 200d 0a20 2020 2065   []..    ..    e
+0000ff30: 7272 6f72 203d 2772 6169 7365 2720 6966  rror ='raise' if
+0000ff40: 2065 7272 6f72 2021 3d27 6967 6e6f 7265   error !='ignore
+0000ff50: 2720 656c 7365 2027 6967 6e6f 7265 270d  ' else 'ignore'.
+0000ff60: 0a0d 0a20 2020 2066 6f72 2069 692c 2064  ...    for ii, d
+0000ff70: 6620 696e 2065 6e75 6d65 7261 7465 2028  f in enumerate (
+0000ff80: 2064 6174 6129 203a 200d 0a20 2020 2020   data) : ..     
+0000ff90: 2020 2074 7279 203a 200d 0a20 2020 2020     try : ..     
+0000ffa0: 2020 2020 2020 2069 782c 2073 6563 203d         ix, sec =
+0000ffb0: 2067 6574 5f61 7175 6966 6572 5f73 6563   get_aquifer_sec
+0000ffc0: 7469 6f6e 280d 0a20 2020 2020 2020 2020  tion(..         
+0000ffd0: 2020 2020 2020 2064 6620 2c20 0d0a 2020         df , ..  
+0000ffe0: 2020 2020 2020 2020 2020 2020 2020 7a6e                zn
+0000fff0: 616d 6520 3d20 7a6e 616d 6520 2c20 0d0a  ame = zname , ..
+00010000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010010: 6b6e 616d 6520 3d20 6b6e 616d 6520 2c20  kname = kname , 
+00010020: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010030: 2020 7265 7475 726e 5f69 6e64 6578 3d20    return_index= 
+00010040: 5472 7565 2c20 0d0a 2020 2020 2020 2020  True, ..        
+00010050: 2020 2020 2020 2020 7265 7475 726e 5f73          return_s
+00010060: 6563 7469 6f6e 733d 5472 7565 2c20 0d0a  ections=True, ..
+00010070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010080: 2a2a 6b77 730d 0a20 2020 2020 2020 2020  **kws..         
+00010090: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+000100a0: 2020 2020 2020 6973 5f76 616c 6964 5f64        is_valid_d
+000100b0: 6673 202e 6170 7065 6e64 2028 6466 2029  fs .append (df )
+000100c0: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
+000100d0: 2045 7863 6570 7469 6f6e 2061 7320 6572   Exception as er
+000100e0: 7220 3a0d 0a20 2020 2020 2020 2020 2020  r :..           
+000100f0: 2023 2069 6620 6572 726f 7220 3d3d 2772   # if error =='r
+00010100: 6169 7365 273a 0d0a 2020 2020 2020 2020  aise':..        
+00010110: 2020 2020 2320 2020 2020 7261 6973 6520      #     raise 
+00010120: 6572 720d 0a20 2020 2020 2020 2020 2020  err..           
+00010130: 2065 7272 6f72 732e 6170 7065 6e64 2873   errors.append(s
+00010140: 7472 2865 7272 2929 0d0a 2020 2020 2020  tr(err))..      
+00010150: 2020 2020 2020 6973 5f6e 6f74 5f76 616c        is_not_val
+00010160: 6964 2e61 7070 656e 6420 2869 6920 2b20  id.append (ii + 
+00010170: 3120 290d 0a20 2020 2020 2020 2020 2020  1 )..           
+00010180: 2063 6f6e 7469 6e75 6520 0d0a 2020 2020   continue ..    
+00010190: 2020 2020 7365 6374 696f 6e5f 696e 6465      section_inde
+000101a0: 7865 732e 6170 7065 6e64 2869 7829 3b20  xes.append(ix); 
+000101b0: 7365 6374 696f 6e73 2e61 7070 656e 6428  sections.append(
+000101c0: 7365 6320 290d 0a20 2020 2020 2020 200d  sec )..        .
+000101d0: 0a20 2020 2069 6620 6c65 6e28 6973 5f6e  .    if len(is_n
+000101e0: 6f74 5f76 616c 6964 2921 3d30 203a 200d  ot_valid)!=0 : .
+000101f0: 0a20 2020 2020 2020 2076 6572 6220 3d20  .        verb = 
+00010200: 6622 7b27 7327 2069 6620 6c65 6e28 6973  f"{'s' if len(is
+00010210: 5f6e 6f74 5f76 616c 6964 293e 3120 656c  _not_valid)>1 el
+00010220: 7365 2727 7d22 0d0a 2020 2020 2020 2020  se''}"..        
+00010230: 6d73 6720 3d20 2255 6e73 7570 706f 7274  msg = "Unsupport
+00010240: 7320 6461 7461 2061 7420 706f 7369 7469  s data at positi
+00010250: 6f6e 7b30 7d20 7b31 7d2e 222e 666f 726d  on{0} {1}.".form
+00010260: 6174 2820 7665 7262 2c20 0d0a 2020 2020  at( verb, ..    
+00010270: 2020 2020 2020 2020 2073 6d61 7274 5f66           smart_f
+00010280: 6f72 6d61 7428 6973 5f6e 6f74 5f76 616c  ormat(is_not_val
+00010290: 6964 2929 0d0a 2020 2020 2020 2020 2020  id))..          
+000102a0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+000102b0: 2020 2020 2069 6620 6572 726f 7220 3d3d       if error ==
+000102c0: 2772 6169 7365 273a 0d0a 2020 2020 2020  'raise':..      
+000102d0: 2020 2020 2020 6765 7472 203d 2028 2253        getr = ("S
+000102e0: 6563 7469 6f6e 7322 2c20 2263 6f6d 7075  ections", "compu
+000102f0: 7465 6422 200d 0a20 2020 2020 2020 2020  ted" ..         
+00010300: 2020 2020 2020 2020 2020 2020 2029 2020               )  
+00010310: 6966 206e 6f74 2072 6574 7572 6e5f 696e  if not return_in
+00010320: 6465 7820 656c 7365 2020 2822 496e 6469  dex else  ("Indi
+00010330: 6365 7322 2c20 226f 6274 6169 6e65 6422  ces", "obtained"
+00010340: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+00010350: 6274 6578 7420 3d20 225c 6e52 6561 736f  btext = "\nReaso
+00010360: 6e7b 7d22 2e66 6f72 6d61 7428 7665 7262  n{}".format(verb
+00010370: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00010380: 6e74 6578 7420 3d20 227b 307d 2063 616e  ntext = "{0} can
+00010390: 6e6f 7420 6265 207b 317d 2e20 506c 6561  not be {1}. Plea
+000103a0: 7365 2063 6865 636b 2079 6f75 7220 6461  se check your da
+000103b0: 7461 2e22 2e66 6f72 6d61 7420 2820 0d0a  ta.".format ( ..
+000103c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000103d0: 6765 7472 5b30 5d2c 2067 6574 725b 2d31  getr[0], getr[-1
+000103e0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+000103f0: 6d65 7373 203d 206d 7367 202b 2020 6c69  mess = msg +  li
+00010400: 7374 696e 675f 6974 656d 735f 666f 726d  sting_items_form
+00010410: 6174 280d 0a20 2020 2020 2020 2020 2020  at(..           
+00010420: 2020 2020 2065 7272 6f72 732c 2062 6567       errors, beg
+00010430: 696e 7465 7874 3d62 7465 7874 2c20 656e  intext=btext, en
+00010440: 6474 6578 743d 656e 7465 7874 202c 2076  dtext=entext , v
+00010450: 6572 626f 7365 203d 4661 6c73 6520 290d  erbose =False ).
+00010460: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00010470: 7365 2044 6174 6173 6574 4572 726f 7228  se DatasetError(
+00010480: 6d65 7373 2920 0d0a 2020 2020 2020 2020  mess) ..        
+00010490: 2020 2020 0d0a 2020 2020 2020 2020 7761      ..        wa
+000104a0: 726e 696e 6773 2e77 6172 6e28 6d73 6720  rnings.warn(msg 
+000104b0: 2b20 2220 4461 7461 207b 7d20 6469 7363  + " Data {} disc
+000104c0: 6172 6465 642e 222e 666f 726d 6174 2820  arded.".format( 
+000104d0: 0d0a 2020 2020 2020 2020 2020 2020 2269  ..            "i
+000104e0: 7322 2069 6620 6c65 6e28 6973 5f6e 6f74  s" if len(is_not
+000104f0: 5f76 616c 6964 293c 3220 656c 7365 2022  _valid)<2 else "
+00010500: 6172 6522 290d 0a20 2020 2020 2020 2020  are")..         
+00010510: 2020 2020 2020 2020 2020 2020 2029 2020               )  
+00010520: 2020 2020 2020 0d0a 2020 2020 723d 2073        ..    r= s
+00010530: 6563 7469 6f6e 5f69 6e64 6578 6573 2069  ection_indexes i
+00010540: 6620 7265 7475 726e 5f69 6e64 6578 2065  f return_index e
+00010550: 6c73 6520 7365 6374 696f 6e73 200d 0a20  lse sections .. 
+00010560: 2020 200d 0a20 2020 2072 6574 7572 6e20     ..    return 
+00010570: 2072 2020 6966 206e 6f74 2072 6574 7572   r  if not retur
+00010580: 6e5f 6461 7461 2065 6c73 6520 2820 7220  n_data else ( r 
+00010590: 2c20 6973 5f76 616c 6964 5f64 6673 2920  , is_valid_dfs) 
+000105a0: 0d0a 0d0a 6765 745f 6171 7569 6665 725f  ....get_aquifer_
+000105b0: 7365 6374 696f 6e73 2e5f 5f64 6f63 5f5f  sections.__doc__
+000105c0: 3d22 2222 5c0d 0a47 6574 2074 6865 2073  ="""\..Get the s
+000105d0: 6563 7469 6f6e 206f 6620 6561 6368 2061  ection of each a
+000105e0: 7175 6966 6572 2066 6f72 6d20 6d75 6c74  quifer form mult
+000105f0: 6970 6c65 2064 6174 6166 7261 6d65 732e  iple dataframes.
+00010600: 200d 0a20 0d0a 5468 6520 756e 6971 7565   .. ..The unique
+00010610: 2073 6563 7469 6f6e 2027 7570 7065 7227   section 'upper'
+00010620: 2061 6e64 2027 6c6f 7765 7227 2069 7320   and 'lower' is 
+00010630: 7468 6520 7661 6c69 6420 7261 6e67 6520  the valid range 
+00010640: 6f66 2074 6865 2077 686f 6c65 200d 0a64  of the whole ..d
+00010650: 6174 6120 746f 2063 6f6e 7369 6465 7220  ata to consider 
+00010660: 6173 2061 2020 7661 6c69 6420 6461 7461  as a  valid data
+00010670: 2e20 0d0a 5468 6520 7573 6520 6f66 2074  . ..The use of t
+00010680: 6865 2069 6e64 6578 2069 7320 206e 6563  he index is  nec
+00010690: 6573 7361 7279 2074 6f20 7368 7275 6e6b  essary to shrunk
+000106a0: 2074 6865 2064 6174 6120 6f66 2074 6865   the data of the
+000106b0: 2077 686f 6c65 200d 0a62 6f72 6568 6f6c   whole ..borehol
+000106c0: 6573 2e20 4d6f 736c 7920 7468 6520 6461  es. Mosly the da
+000106d0: 7461 2066 726f 6d20 7468 6520 7365 6374  ta from the sect
+000106e0: 696f 6e20 6973 2063 6f6e 7369 6465 6420  ion is consided 
+000106f0: 7468 6520 7661 6c69 6420 6461 7461 2061  the valid data a
+00010700: 7320 7468 6520 0d0a 7072 6564 6963 746f  s the ..predicto
+00010710: 7220 5872 2e20 4f75 7420 6f66 2074 6865  r Xr. Out of the
+00010720: 2072 616e 6765 206f 6620 6171 7569 6665   range of aquife
+00010730: 7273 2065 6374 696f 6e2c 2064 6174 6120  rs ection, data 
+00010740: 6361 6e20 6265 2064 6973 6361 7264 6564  can be discarded
+00010750: 206f 7220 0d0a 636f 6d70 7265 7373 6564   or ..compressed
+00010760: 2074 6f20 746f 7020 5872 2e20 0d0a 0d0a   to top Xr. ....
+00010770: 5265 7475 726e 7320 7661 6c69 6420 7365  Returns valid se
+00010780: 6374 696f 6e20 696e 6465 7865 7320 6966  ction indexes if
+00010790: 2027 7265 7475 726e 5f69 6e64 6578 2720   'return_index' 
+000107a0: 6973 2073 6574 2074 6f20 6060 5472 7565  is set to ``True
+000107b0: 6060 2e20 2020 200d 0a20 2020 0d0a 5061  ``.    ..   ..Pa
+000107c0: 7261 6d65 7465 7273 200d 0a2d 2d2d 2d2d  rameters ..-----
+000107d0: 2d2d 2d2d 2d2d 2d20 0d0a 6461 7461 3a20  ------- ..data: 
+000107e0: 6c69 7374 206f 6620 7061 6e64 6173 2064  list of pandas d
+000107f0: 6174 6166 7261 6d65 200d 0a20 2020 2044  ataframe ..    D
+00010800: 6174 6120 7468 6174 2063 6f6e 7461 696e  ata that contain
+00010810: 7320 6d61 696e 6c79 2074 6865 2061 7175  s mainly the aqu
+00010820: 6966 6572 2076 616c 7565 732e 2049 7420  ifer values. It 
+00010830: 6e65 6564 7320 746f 2073 7065 6369 6679  needs to specify
+00010840: 2074 6865 200d 0a20 2020 206e 616d 6520   the ..    name 
+00010850: 6f66 2074 6865 2064 6570 7468 2063 6f6c  of the depth col
+00010860: 756d 6e20 607a 6e61 6d65 6020 6173 2077  umn `zname` as w
+00010870: 656c 6c20 6173 2074 6865 206e 616d 6520  ell as the name 
+00010880: 6f66 2070 6572 6d65 6162 696c 6979 200d  of permeabiliy .
+00010890: 0a20 2020 2060 6b6e 616d 6560 2063 6f6c  .    `kname` col
+000108a0: 756d 6e2e 2020 0d0a 7b70 6172 616d 732e  umn.  ..{params.
+000108b0: 636f 7265 2e7a 6e61 6d65 7d0d 0a7b 7061  core.zname}..{pa
+000108c0: 7261 6d73 2e63 6f72 652e 6b6e 616d 657d  rams.core.kname}
+000108d0: 0d0a 7b70 6172 616d 732e 636f 7265 2e7a  ..{params.core.z
+000108e0: 7d0d 0a0d 0a72 6574 7572 6e5f 696e 6465  }....return_inde
+000108f0: 783a 2062 6f6f 6c2c 2064 6566 6175 6c74  x: bool, default
+00010900: 203d 4661 6c73 6520 2c20 0d0a 2020 2020   =False , ..    
+00010910: 5265 7475 726e 7320 7468 6520 706f 7369  Returns the posi
+00010920: 7469 6f6e 7320 2869 6e64 6578 6573 2920  tions (indexes) 
+00010930: 6f66 2074 6865 2075 7070 6572 2061 6e64  of the upper and
+00010940: 206c 6f77 6572 2073 6563 7469 6f6e 7320   lower sections 
+00010950: 6f66 2074 6865 0d0a 2020 2065 6163 6820  of the..   each 
+00010960: 6171 7569 6665 7220 666f 756e 6420 696e  aquifer found in
+00010970: 2065 6163 6820 6461 7461 6672 616d 652e   each dataframe.
+00010980: 0d0a 0d0a 6572 726f 723a 2073 7472 2c20  ....error: str, 
+00010990: 6465 6661 756c 743d 2769 676e 6f72 6527  default='ignore'
+000109a0: 200d 0a20 2020 2052 6169 7365 2065 7272   ..    Raise err
+000109b0: 6f72 7320 6966 2074 726f 7562 6c65 206f  ors if trouble o
+000109c0: 6363 7572 7320 7768 656e 2063 6f6d 7075  ccurs when compu
+000109d0: 7469 6e67 2074 6865 2073 6563 7469 6f6e  ting the section
+000109e0: 206f 6620 6561 6368 2061 7175 6966 6572   of each aquifer
+000109f0: 2e20 0d0a 2020 2020 4966 2027 6967 6e6f  . ..    If 'igno
+00010a00: 7265 272c 2061 2055 7365 7257 6172 6e69  re', a UserWarni
+00010a10: 6e67 2069 7320 6469 7370 6c61 7965 6420  ng is displayed 
+00010a20: 6966 2069 6e76 616c 6964 2064 6174 6120  if invalid data 
+00010a30: 6973 2066 6f75 6e64 2e20 416e 7920 0d0a  is found. Any ..
+00010a40: 2020 2020 6f74 6865 7220 7661 6c75 6520      other value 
+00010a50: 6f66 2060 6572 726f 7260 2077 696c 6c20  of `error` will 
+00010a60: 7365 7420 6572 726f 7220 746f 2060 7261  set error to `ra
+00010a70: 6973 6560 2e20 0d0a 7265 7475 726e 5f64  ise`. ..return_d
+00010a80: 6174 613a 2062 6f6f 6c2c 2064 6566 6175  ata: bool, defau
+00010a90: 6c74 3d46 616c 7365 2c20 0d0a 2020 2020  lt=False, ..    
+00010aa0: 5265 7475 726e 2076 616c 6964 2064 6174  Return valid dat
+00010ab0: 612e 2049 7420 6973 2075 7365 6675 6c6c  a. It is usefull
+00010ac0: 2077 6865 6e20 2765 7272 6f72 2720 6973   when 'error' is
+00010ad0: 2073 6574 2074 6f20 2769 676e 6f72 6527   set to 'ignore'
+00010ae0: 0d0a 2020 2020 746f 2063 6f6c 6c65 6374  ..    to collect
+00010af0: 2074 6865 2076 616c 6964 2064 6174 612e   the valid data.
+00010b00: 200d 0a20 2020 2020 2020 0d0a 6b77 733a   ..       ..kws:
+00010b10: 2064 6963 742c 200d 0a20 2020 2041 6464   dict, ..    Add
+00010b20: 6974 696f 6e61 6c20 6b65 7977 6f72 6473  itional keywords
+00010b30: 2061 7267 756d 656e 7473 2070 6173 7365   arguments passe
+00010b40: 6420 2074 6f20 200d 0a20 2020 203a 6675  d  to  ..    :fu
+00010b50: 6e63 3a60 7e77 6174 6578 2e75 7469 6c73  nc:`~watex.utils
+00010b60: 2e68 7964 726f 7574 696c 732e 6765 745f  .hydroutils.get_
+00010b70: 6171 7569 6665 725f 7365 6374 696f 6e73  aquifer_sections
+00010b80: 602e 0d0a 2020 2020 0d0a 5265 7475 726e  `...    ..Return
+00010b90: 7320 0d0a 2d2d 2d2d 2d2d 2d2d 0d0a 7570  s ..--------..up
+00010ba0: 2c20 6c6f 7720 3a6c 6973 7420 6f66 2075  , low :list of u
+00010bb0: 7070 6572 2061 6e64 206c 6f77 6572 2073  pper and lower s
+00010bc0: 6563 7469 6f6e 2076 616c 7565 7320 6f66  ection values of
+00010bd0: 2061 7175 6966 6572 2e0d 0a20 2020 202d   aquifer...    -
+00010be0: 2028 7570 6978 2c20 6c6f 7769 7820 293a   (upix, lowix ):
+00010bf0: 2054 7570 6c65 206f 6620 696e 6465 7865   Tuple of indexe
+00010c00: 7320 6f66 206c 6f77 6572 2061 6e64 2075  s of lower and u
+00010c10: 7070 6572 2073 6563 7469 6f6e 7320 200d  pper sections  .
+00010c20: 0a20 2020 202d 2028 7570 2c20 6c6f 7729  .    - (up, low)
+00010c30: 3a20 5475 706c 6520 6f66 2061 7175 6966  : Tuple of aquif
+00010c40: 6572 2073 6563 7469 6f6e 7320 2875 7070  er sections (upp
+00010c50: 6572 2061 6e64 206c 6f77 6572 2920 200d  er and lower)  .
+00010c60: 0a20 2020 202d 2028 7570 6978 2c20 6c6f  .    - (upix, lo
+00010c70: 7769 7829 2c20 2875 702c 206c 6f77 2920  wix), (up, low) 
+00010c80: 3a20 706f 7369 7469 6f6e 7320 616e 6420  : positions and 
+00010c90: 7365 6374 696f 6e73 2076 616c 7565 7320  sections values 
+00010ca0: 6f66 2061 7175 6966 6572 7320 0d0a 2020  of aquifers ..  
+00010cb0: 2020 2020 2020 6966 2060 7265 7475 726e        if `return
+00010cc0: 5f69 6e64 6578 6020 616e 6420 7265 7475  _index` and retu
+00010cd0: 726e 5f73 6563 7469 6f6e 7360 2061 7265  rn_sections` are
+00010ce0: 2060 6054 7275 6560 602e 2020 0d0a 0d0a   ``True``.  ....
+00010cf0: 5365 6520 416c 736f 200d 0a2d 2d2d 2d2d  See Also ..-----
+00010d00: 2d2d 2d2d 2d0d 0a77 6174 6578 2e75 7469  -----..watex.uti
+00010d10: 6c73 2e68 7964 726f 7574 696c 732e 6765  ls.hydroutils.ge
+00010d20: 745f 6171 7569 6665 725f 7365 6374 696f  t_aquifer_sectio
+00010d30: 6e73 3a20 0d0a 2020 2020 636f 6d70 7574  ns: ..    comput
+00010d40: 6520 6d75 6c74 6970 6c65 7320 6171 7569  e multiples aqui
+00010d50: 6665 7220 7365 6374 696f 6e73 0d0a 0d0a  fer sections....
+00010d60: 4578 616d 706c 650d 0a2d 2d2d 2d2d 2d2d  Example..-------
+00010d70: 2020 200d 0a3e 3e3e 2066 726f 6d20 7761     ..>>> from wa
+00010d80: 7465 782e 6461 7461 7365 7473 2069 6d70  tex.datasets imp
+00010d90: 6f72 7420 6c6f 6164 5f68 6c6f 6773 200d  ort load_hlogs .
+00010da0: 0a3e 3e3e 2066 726f 6d20 7761 7465 782e  .>>> from watex.
+00010db0: 7574 696c 732e 6879 6472 6f75 7469 6c73  utils.hydroutils
+00010dc0: 2069 6d70 6f72 7420 6765 745f 6171 7569   import get_aqui
+00010dd0: 6665 725f 7365 6374 696f 6e73 0d0a 3e3e  fer_sections..>>
+00010de0: 3e20 6461 7461 203d 206c 6f61 645f 686c  > data = load_hl
+00010df0: 6f67 7320 2829 2e66 7261 6d65 200d 0a3e  ogs ().frame ..>
+00010e00: 3e3e 2067 6574 5f61 7175 6966 6572 5f73  >> get_aquifer_s
+00010e10: 6563 7469 6f6e 7320 2864 6174 612c 2064  ections (data, d
+00010e20: 6174 6120 2c20 7a6e 616d 6520 3d27 6465  ata , zname ='de
+00010e30: 7074 6827 2c20 6b6e 616d 6520 3d27 6b27  pth', kname ='k'
+00010e40: 2029 200d 0a2e 2e2e 205b 5b31 3937 2e31   ) ..... [[197.1
+00010e50: 322c 2033 3639 2e37 315d 2c20 5b31 3937  2, 369.71], [197
+00010e60: 2e31 322c 2033 3639 2e37 315d 5d0d 0a3e  .12, 369.71]]..>
+00010e70: 3e3e 2067 6574 5f61 7175 6966 6572 5f73  >> get_aquifer_s
+00010e80: 6563 7469 6f6e 7320 2864 6174 612c 2064  ections (data, d
+00010e90: 6174 6120 2c20 7a6e 616d 6520 3d27 6465  ata , zname ='de
+00010ea0: 7074 6827 2c20 6b6e 616d 6520 3d27 6b27  pth', kname ='k'
+00010eb0: 202c 200d 0a20 2020 2020 2020 2020 2020   , ..           
+00010ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ed0: 7265 7475 726e 5f69 6e64 6578 203d 5472  return_index =Tr
+00010ee0: 7565 2029 200d 0a2e 2e2e 2020 5b5b 3136  ue ) .....  [[16
+00010ef0: 2c20 3239 5d2c 205b 3136 2c20 3239 5d5d  , 29], [16, 29]]
+00010f00: 0d0a 0d0a 2222 222e 666f 726d 6174 280d  ....""".format(.
+00010f10: 0a20 2020 2070 6172 616d 733d 5f70 6172  .    params=_par
+00010f20: 616d 5f64 6f63 732c 0d0a 2020 2020 290d  am_docs,..    ).
+00010f30: 0a64 6566 205f 6765 745f 696e 7661 6c69  .def _get_invali
+00010f40: 645f 696e 6465 7865 7320 2028 2064 2c20  d_indexes  ( d, 
+00010f50: 2f2c 2076 616c 6964 5f69 6e64 6578 6573  /, valid_indexes
+00010f60: 2c20 696e 5f61 7261 6e67 6520 3d46 616c  , in_arange =Fal
+00010f70: 7365 2029 3a20 0d0a 2020 2020 2222 2220  se ): ..    """ 
+00010f80: 4765 7420 6e6f 6e20 7661 6c69 6420 696e  Get non valid in
+00010f90: 6465 7865 7320 6672 6f6d 2076 616c 6964  dexes from valid
+00010fa0: 2073 6563 7469 6f6e 2069 6e64 6578 6573   section indexes
+00010fb0: 200d 0a20 2020 200d 0a20 2020 203a 7061   ..    ..    :pa
+00010fc0: 7261 6d20 643a 2061 7272 6179 5f6c 696b  ram d: array_lik
+00010fd0: 6520 3164 200d 0a20 2020 2020 2020 2061  e 1d ..        a
+00010fe0: 7272 6179 2d6c 696b 6520 6461 7461 2066  rray-like data f
+00010ff0: 6f72 2072 6563 6f76 6572 2074 6865 2073  or recover the s
+00011000: 6563 7469 6f6e 2072 616e 6765 2069 6e64  ection range ind
+00011010: 6578 6573 200d 0a20 2020 203a 7061 7261  exes ..    :para
+00011020: 6d20 7365 6374 696f 6e5f 6978 3a20 5475  m section_ix: Tu
+00011030: 706c 6520 2869 6e74 2c20 696e 7429 200d  ple (int, int) .
+00011040: 0a20 2020 2020 2020 2049 6e64 6578 206f  .        Index o
+00011050: 6620 7570 7065 7220 616e 6420 6c6f 7765  f upper and lowe
+00011060: 7220 7365 6374 696f 6e73 0d0a 2020 2020  r sections..    
+00011070: 3a70 6172 616d 2069 6e5f 6172 616e 6765  :param in_arange
+00011080: 3a20 626f 6f6c 2c20 0d0a 2020 2020 2020  : bool, ..      
+00011090: 2020 4c69 7374 2061 6c6c 2069 6e64 6578    List all index
+000110a0: 2076 616c 7565 732e 200d 0a20 2020 203a   values. ..    :
+000110b0: 7265 7475 726e 733a 200d 0a20 2020 2020  returns: ..     
+000110c0: 2020 2069 6e76 6978 3a20 4c69 7374 2854     invix: List(T
+000110d0: 7570 6c65 2869 6e74 2929 0d0a 2020 2020  uple(int))..    
+000110e0: 2020 2020 5265 7475 726e 7320 696e 7661      Returns inva
+000110f0: 6c69 6420 696e 6465 7865 7320 6f6e 746f  lid indexes onto
+00011100: 2061 206c 6973 7420 0d0a 2020 2020 4578   a list ..    Ex
+00011110: 616d 706c 6520 0d0a 2020 2020 2d2d 2d2d  ample ..    ----
+00011120: 2d2d 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e  -------..    >>>
+00011130: 2066 726f 6d20 7761 7465 782e 7574 696c   from watex.util
+00011140: 732e 6879 6472 6f75 7469 6c73 2069 6d70  s.hydroutils imp
+00011150: 6f72 7420 5f67 6574 5f69 6e76 616c 6964  ort _get_invalid
+00011160: 5f69 6e64 6578 6573 0d0a 2020 2020 3e3e  _indexes..    >>
+00011170: 3e20 696d 706f 7274 206e 756d 7079 2061  > import numpy a
+00011180: 7320 6e70 200d 0a20 2020 203e 3e3e 2069  s np ..    >>> i
+00011190: 6478 203d 206e 702e 6172 616e 6765 2028  dx = np.arange (
+000111a0: 3530 2920 0d0a 2020 2020 3e3e 3e20 5f67  50) ..    >>> _g
+000111b0: 6574 5f69 6e76 616c 6964 5f69 6e64 6578  et_invalid_index
+000111c0: 6573 2028 6964 7820 2c20 2833 2c20 3131  es (idx , (3, 11
+000111d0: 2029 290d 0a20 2020 202e 2e2e 205b 2830   ))..    ... [(0
+000111e0: 2c20 3329 2c20 2831 322c 2035 3029 5d0d  , 3), (12, 50)].
+000111f0: 0a20 2020 200d 0a20 2020 2022 2222 0d0a  .    ..    """..
+00011200: 2020 2020 6966 2069 6e5f 6172 616e 6765      if in_arange
+00011210: 203a 200d 0a20 2020 2020 2020 2076 616c   : ..        val
+00011220: 6964 5f69 6e64 6578 6573 203d 206e 702e  id_indexes = np.
+00011230: 6172 7261 7920 2820 206c 6973 7428 200d  array (  list( .
+00011240: 0a20 2020 2020 2020 2020 2020 2072 616e  .            ran
+00011250: 6765 2028 202a 205b 2020 7661 6c69 645f  ge ( * [  valid_
+00011260: 696e 6465 7865 7320 5b30 5d20 2c20 7661  indexes [0] , va
+00011270: 6c69 645f 696e 6465 7865 7320 5b2d 315d  lid_indexes [-1]
+00011280: 202b 3120 5d20 2929 2920 200d 0a20 2020   +1 ] )))  ..   
+00011290: 2020 2020 206d 6173 6b20 3d20 5f69 7369       mask = _isi
+000112a0: 6e28 7261 6e67 6528 6c65 6e28 6429 292c  n(range(len(d)),
+000112b0: 2076 616c 6964 5f69 6e64 6578 6573 2c20   valid_indexes, 
+000112c0: 7265 7475 726e 5f6d 6173 6b3d 5472 7565  return_mask=True
+000112d0: 2029 0d0a 2020 2020 2020 2020 696e 7669   )..        invi
+000112e0: 7820 3d20 6e70 2e61 7261 6e67 6520 286c  x = np.arange (l
+000112f0: 656e 2864 2929 5b7e 6d61 736b 205d 0d0a  en(d))[~mask ]..
+00011300: 2020 2020 656c 7365 203a 0d0a 2020 2020      else :..    
+00011310: 2020 2020 2320 2b31 2066 6f72 2050 7974      # +1 for Pyt
+00011320: 686f 6e20 696e 6465 7869 6e67 0d0a 2020  hon indexing..  
+00011330: 2020 2020 2020 696e 7669 7820 3d20 2028        invix =  (
+00011340: 6e70 2e61 7261 6e67 6520 286c 656e 2864  np.arange (len(d
+00011350: 2929 5b3a 7661 6c69 645f 696e 6465 7865  ))[:valid_indexe
+00011360: 7320 5b30 5d20 2b20 3120 5d2c 0d0a 2020  s [0] + 1 ],..  
+00011370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011380: 6e70 2e61 7261 6e67 6520 286c 656e 2864  np.arange (len(d
+00011390: 2920 2b20 3120 295b 7661 6c69 645f 696e  ) + 1 )[valid_in
+000113a0: 6465 7865 735b 315d 2b31 203a 205d 2920  dexes[1]+1 : ]) 
+000113b0: 0d0a 2020 2020 2020 2020 696e 7669 783d  ..        invix=
+000113c0: 2020 5b20 2820 6d69 6e28 6978 2920 2c20    [ ( min(ix) , 
+000113d0: 6d61 7828 6978 2929 2020 666f 7220 6978  max(ix))  for ix
+000113e0: 2069 6e20 696e 7669 7820 2069 6620 2028   in invix  if  (
+000113f0: 200d 0a20 2020 2020 2020 2020 2020 206c   ..            l
+00011400: 656e 2869 7820 2921 3d30 2061 6e64 206c  en(ix )!=0 and l
+00011410: 656e 2873 6574 2869 7829 293e 3129 2020  en(set(ix))>1)  
+00011420: 5d20 2320 2831 3831 2c20 3138 3120 290d  ] # (181, 181 ).
+00011430: 0a20 2020 200d 0a20 2020 2072 6574 7572  .    ..    retur
+00011440: 6e20 696e 7669 7820 0d0a 2020 0d0a 6465  n invix ..  ..de
+00011450: 6620 6765 745f 7873 5f78 725f 7370 6c69  f get_xs_xr_spli
+00011460: 7473 2028 0d0a 2020 2020 6461 7461 2c20  ts (..    data, 
+00011470: 0d0a 2020 2020 2f2c 0d0a 2020 2020 7a5f  ..    /,..    z_
+00011480: 7261 6e67 6520 3d20 4e6f 6e65 2c20 0d0a  range = None, ..
+00011490: 2020 2020 7a6e 616d 6520 3d20 4e6f 6e65      zname = None
+000114a0: 2c20 0d0a 2020 2020 7365 6374 696f 6e5f  , ..    section_
+000114b0: 696e 6465 7865 733a 5475 706c 655b 696e  indexes:Tuple[in
+000114c0: 742c 2069 6e74 5d3d 4e6f 6e65 2c20 0d0a  t, int]=None, ..
+000114d0: 2020 2020 292d 3e20 5475 706c 6520 5b44      )-> Tuple [D
+000114e0: 6174 6146 7261 6d65 205d 3a0d 0a20 2020  ataFrame ]:..   
+000114f0: 2022 2222 5370 6c69 7420 6461 7461 2069   """Split data i
+00011500: 6e74 6f20 6d61 7472 6978 203a 6d61 7468  nto matrix :math
+00011510: 3a60 585f 7360 2077 6974 6820 7361 6d70  :`X_s` with samp
+00011520: 6c65 203a 6d61 7468 3a60 6d73 6020 2875  le :math:`ms` (u
+00011530: 6e77 616e 7465 6420 6461 7461 2029 200d  nwanted data ) .
+00011540: 0a20 2020 2061 6e64 203a 6d61 7468 3a60  .    and :math:`
+00011550: 585f 7260 206f 6620 7361 6d70 6c65 7320  X_r` of samples 
+00011560: 3a6d 6174 683a 606d 5f72 6028 2076 616c  :math:`m_r`( val
+00011570: 6964 2061 7175 6966 6572 2064 6174 6120  id aquifer data 
+00011580: 290d 0a20 2020 200d 0a20 2020 2050 6172  )..    ..    Par
+00011590: 616d 6574 6572 7320 0d0a 2020 2020 2d2d  ameters ..    --
+000115a0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2064  ---------..    d
+000115b0: 6174 613a 2070 616e 6461 7320 6461 7461  ata: pandas data
+000115c0: 6672 616d 6520 0d0a 2020 2020 2020 2020  frame ..        
+000115d0: 4461 7461 6672 616d 6520 666f 7220 636f  Dataframe for co
+000115e0: 6d70 7265 7373 696e 672e 200d 0a20 2020  mpressing. ..   
+000115f0: 207a 6e61 6d65 3a20 7374 722c 696e 7420   zname: str,int 
+00011600: 2c20 0d0a 2020 2020 2020 2020 7468 6520  , ..        the 
+00011610: 6e61 6d65 206f 6620 6465 7074 6820 636f  name of depth co
+00011620: 6c75 6d6e 2e20 276e 616d 6527 206e 6565  lumn. 'name' nee
+00011630: 6473 2074 6f20 6265 2073 7570 706c 6965  ds to be supplie
+00011640: 6420 0d0a 2020 2020 2020 2020 7768 656e  d ..        when
+00011650: 2060 7365 6374 696f 6e5f 696e 6465 7865   `section_indexe
+00011660: 7360 2069 7320 6e6f 7420 7072 6f76 6964  s` is not provid
+00011670: 6564 2e20 0d0a 2020 2020 7a5f 7261 6e67  ed. ..    z_rang
+00011680: 653a 2074 7570 6c65 2028 666c 6f61 7429  e: tuple (float)
+00011690: 2c20 0d0a 2020 2020 2020 2020 5365 6374  , ..        Sect
+000116a0: 696f 6e20 5b27 7570 7065 7227 2c20 276c  ion ['upper', 'l
+000116b0: 6f77 6572 275d 206f 6620 7468 6520 6171  ower'] of the aq
+000116c0: 7569 6665 7220 6174 2064 6966 6665 7265  uifer at differe
+000116d0: 6e74 2064 6570 7468 2e0d 0a20 2020 2020  nt depth...     
+000116e0: 2020 2054 6865 2072 616e 6765 206f 6620     The range of 
+000116f0: 7468 6520 6465 7074 6820 6d75 7374 2061  the depth must a
+00011700: 2070 6169 7220 7661 6c75 6573 2061 6e64   pair values and
+00011710: 2020 636f 756c 6420 6e6f 7420 6265 0d0a    could not be..
+00011720: 2020 2020 2020 2020 6772 6561 7465 7220          greater 
+00011730: 7468 616e 2074 6865 206d 6178 696d 756d  than the maximum
+00011740: 2064 6570 7468 206f 6620 7468 6520 7765   depth of the we
+00011750: 6c6c 2e0d 0a20 2020 2073 6563 7469 6f6e  ll...    section
+00011760: 5f69 6e64 6578 6573 3a20 7475 706c 6520  _indexes: tuple 
+00011770: 6f72 206c 6973 7420 6f66 2069 6e74 200d  or list of int .
+00011780: 0a20 2020 2020 2020 206c 6973 7420 6f66  .        list of
+00011790: 2061 2070 6169 7220 7475 706c 6520 6f72   a pair tuple or
+000117a0: 206c 6973 7420 6f66 2069 6e74 6567 6572   list of integer
+000117b0: 732e 2049 7420 6973 2062 6520 7468 6520  s. It is be the 
+000117c0: 7468 6520 7661 6c69 6420 0d0a 2020 2020  the valid ..    
+000117d0: 2020 2020 7365 6374 696f 6e73 2820 7570      sections( up
+000117e0: 7065 7220 616e 6420 6c6f 7765 7220 2920  per and lower ) 
+000117f0: 696e 6465 7865 7320 6f66 2020 6f66 2074  indexes of  of t
+00011800: 6865 2061 7175 6966 6572 2e20 4966 200d  he aquifer. If .
+00011810: 0a20 2020 2020 2020 2074 6865 2064 6570  .        the dep
+00011820: 7468 2072 616e 6765 2060 7a5f 7261 6e67  th range `z_rang
+00011830: 6560 2061 6e64 2060 7a6e 616d 6560 2061  e` and `zname` a
+00011840: 7265 2073 7570 706c 6965 642c 2060 7365  re supplied, `se
+00011850: 6374 696f 6e5f 696e 6465 7865 7360 0d0a  ction_indexes`..
+00011860: 2020 2020 2020 2020 6361 6e20 6265 204e          can be N
+00011870: 6f6e 652e 2020 4e6f 7465 2074 6861 7420  one.  Note that 
+00011880: 7468 6520 6c61 7374 2069 6e64 6978 2069  the last indix i
+00011890: 7320 636f 6e73 6964 6572 6564 2061 7320  s considered as 
+000118a0: 7468 6520 6c61 7374 200d 0a20 2020 2020  the last ..     
+000118b0: 2020 2070 6f73 6974 696f 6e2c 2074 6865     position, the
+000118c0: 2062 6f74 746f 6d20 6f66 2074 6865 2073   bottom of the s
+000118d0: 6563 7469 6f6e 2074 6865 7265 666f 7265  ection therefore
+000118e0: 2c20 6974 7320 7661 6c75 6520 6973 200d  , its value is .
+000118f0: 0a20 2020 2020 2020 2069 6e63 6c75 6465  .        include
+00011900: 6420 696e 2074 6865 2064 6174 612e 0d0a  d in the data...
+00011910: 2020 2020 2020 2020 0d0a 2020 2020 5265          ..    Re
+00011920: 7475 726e 730d 0a20 2020 202d 2d2d 2d2d  turns..    -----
+00011930: 2d2d 2d0d 0a20 2020 202d 2078 7320 3a20  ---..    - xs : 
+00011940: 6c69 7374 206f 6620 7061 6e64 6173 2064  list of pandas d
+00011950: 6174 6166 7261 6d65 200d 0a20 2020 2020  ataframe ..     
+00011960: 2020 202d 2073 6872 696e 6b69 6e67 2070     - shrinking p
+00011970: 6172 7420 6f66 2064 6174 6120 666f 7220  art of data for 
+00011980: 636f 6d70 7265 7373 696e 672e 204e 6f74  compressing. Not
+00011990: 6520 7468 6174 2069 7420 6973 206f 6e20  e that it is on 
+000119a0: 6c69 7374 200d 0a20 2020 2020 2020 2062  list ..        b
+000119b0: 6563 6175 7365 2069 6620 6461 7461 6672  ecause if datafr
+000119c0: 616d 6520 636f 7272 6573 706f 6e64 7320  ame corresponds 
+000119d0: 746f 2074 6865 206e 6f6e 2d76 616c 6964  to the non-valid
+000119e0: 2064 6174 6166 7261 6d65 2073 6563 7469   dataframe secti
+000119f0: 6f6e 732e 200d 0a20 2020 202d 2078 723a  ons. ..    - xr:
+00011a00: 2070 616e 6461 7320 6461 7461 6672 616d   pandas datafram
+00011a10: 6520 200d 0a20 2020 2020 2020 202d 2076  e  ..        - v
+00011a20: 616c 6964 2064 6174 6120 7265 666c 6563  alid data reflec
+00011a30: 7469 6e67 2074 6f20 7468 6520 6171 7569  ting to the aqui
+00011a40: 6665 7220 7061 7274 206f 7220 696e 636c  fer part or incl
+00011a50: 7564 696e 6720 7468 6520 0d0a 2020 2020  uding the ..    
+00011a60: 2020 2020 6171 7569 6665 7220 6461 7461      aquifer data
+00011a70: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
+00011a80: 2020 4578 616d 706c 650d 0a20 2020 202d    Example..    -
+00011a90: 2d2d 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e  -------..    >>>
+00011aa0: 2066 726f 6d20 7761 7465 782e 6461 7461   from watex.data
+00011ab0: 7365 7473 2069 6d70 6f72 7420 6c6f 6164  sets import load
+00011ac0: 5f68 6c6f 6773 200d 0a20 2020 203e 3e3e  _hlogs ..    >>>
+00011ad0: 2066 726f 6d20 7761 7465 782e 7574 696c   from watex.util
+00011ae0: 732e 6879 6472 6f75 7469 6c73 2069 6d70  s.hydroutils imp
+00011af0: 6f72 7420 6765 745f 7873 5f78 725f 7370  ort get_xs_xr_sp
+00011b00: 6c69 7473 200d 0a20 2020 203e 3e3e 2064  lits ..    >>> d
+00011b10: 6174 6120 3d20 6c6f 6164 5f68 6c6f 6773  ata = load_hlogs
+00011b20: 2028 292e 6672 616d 6520 0d0a 2020 2020   ().frame ..    
+00011b30: 3e3e 3e20 7873 2c20 7872 203d 2067 6574  >>> xs, xr = get
+00011b40: 5f78 735f 7872 5f73 706c 6974 7320 2864  _xs_xr_splits (d
+00011b50: 6174 612c 2033 2e31 312c 2073 6563 7469  ata, 3.11, secti
+00011b60: 6f6e 5f69 6e64 6578 6573 203d 2028 3137  on_indexes = (17
+00011b70: 2c20 3230 2029 2029 0d0a 2020 2020 2222  , 20 ) )..    ""
+00011b80: 220d 0a20 2020 2078 732c 2078 7220 3d20  "..    xs, xr = 
+00011b90: 4e6f 6e65 2c20 4e6f 6e65 0d0a 2020 2020  None, None..    
+00011ba0: 0d0a 2020 2020 6461 7461 3d20 6368 6563  ..    data= chec
+00011bb0: 6b5f 6172 7261 7928 0d0a 2020 2020 2020  k_array(..      
+00011bc0: 2020 6461 7461 2c20 0d0a 2020 2020 2020    data, ..      
+00011bd0: 2020 666f 7263 655f 616c 6c5f 6669 6e69    force_all_fini
+00011be0: 7465 3d22 616c 6c6f 772d 6e61 6e22 2c20  te="allow-nan", 
+00011bf0: 0d0a 2020 2020 2020 2020 6474 7970 6520  ..        dtype 
+00011c00: 3d6f 626a 6563 742c 200d 0a20 2020 2020  =object, ..     
+00011c10: 2020 2069 6e70 7574 5f6e 616d 653d 2244     input_name="D
+00011c20: 6174 6120 666f 7220 7371 7565 657a 696e  ata for squeezin
+00011c30: 6722 2c0d 0a20 2020 2020 2020 2074 6f5f  g",..        to_
+00011c40: 6672 616d 6520 3d54 7275 652c 200d 0a20  frame =True, .. 
+00011c50: 2020 2029 0d0a 2020 2020 0d0a 2020 2020     )..    ..    
+00011c60: 6966 2073 6563 7469 6f6e 5f69 6e64 6578  if section_index
+00011c70: 6573 2069 7320 6e6f 7420 4e6f 6e65 3a20  es is not None: 
+00011c80: 0d0a 2020 2020 2020 2020 7365 6374 696f  ..        sectio
+00011c90: 6e5f 696e 6465 7865 7320 3d20 5f61 7373  n_indexes = _ass
+00011ca0: 6572 745f 7265 6475 6365 5f69 6e64 6578  ert_reduce_index
+00011cb0: 6573 2028 7365 6374 696f 6e5f 696e 6465  es (section_inde
+00011cc0: 7865 7329 205b 305d 200d 0a20 2020 2020  xes) [0] ..     
+00011cd0: 2020 2069 6620 7365 6374 696f 6e5f 696e     if section_in
+00011ce0: 6465 7865 7320 5b31 5d20 3e20 6c65 6e28  dexes [1] > len(
+00011cf0: 6461 7461 2029 3a20 0d0a 2020 2020 2020  data ): ..      
+00011d00: 2020 2020 2020 2320 6966 2069 6e64 6578        # if index
+00011d10: 2069 7320 6966 2077 6964 652c 7461 6b65   is if wide,take
+00011d20: 2074 6865 2066 6972 7374 2069 6e64 6578   the first index
+00011d30: 2074 6869 6e20 7468 6520 656e 6420 0d0a   thin the end ..
+00011d40: 2020 2020 2020 2020 2020 2020 7365 6374              sect
+00011d50: 696f 6e5f 696e 6465 7865 7320 3d20 5b73  ion_indexes = [s
+00011d60: 6563 7469 6f6e 5f69 6e64 6578 6573 5b30  ection_indexes[0
+00011d70: 5d2c 206c 656e 2864 6174 6129 5d0d 0a20  ], len(data)].. 
+00011d80: 2020 2020 2020 2069 6e76 616c 6964 5f69         invalid_i
+00011d90: 6e64 6578 6573 203d 205f 6765 745f 696e  ndexes = _get_in
+00011da0: 7661 6c69 645f 696e 6465 7865 7328 0d0a  valid_indexes(..
+00011db0: 2020 2020 2020 2020 2020 2020 6e70 2e61              np.a
+00011dc0: 7261 6e67 6520 286c 656e 2864 6174 6129  range (len(data)
+00011dd0: 292c 2073 6563 7469 6f6e 5f69 6e64 6578  ), section_index
+00011de0: 6573 2920 200d 0a0d 0a20 2020 2023 2076  es)  ....    # v
+00011df0: 616c 6964 2073 6563 7469 6f6e 2069 6e64  alid section ind
+00011e00: 6578 206f 6620 6171 7569 6665 720d 0a20  ex of aquifer.. 
+00011e10: 2020 2065 6c69 6620 7a5f 7261 6e67 6520     elif z_range 
+00011e20: 6973 206e 6f74 204e 6f6e 6520 3a20 0d0a  is not None : ..
+00011e30: 2020 2020 2020 2020 7a20 3d20 6973 5f76          z = is_v
+00011e40: 616c 6964 5f64 6570 7468 2028 6461 7461  alid_depth (data
+00011e50: 2c20 7a6e 616d 6520 3d20 7a6e 616d 6520  , zname = zname 
+00011e60: 2c20 7265 7475 726e 5f7a 203d 2054 7275  , return_z = Tru
+00011e70: 6529 0d0a 2020 2020 2020 2020 7365 6374  e)..        sect
+00011e80: 696f 6e5f 696e 6465 7865 732c 2069 6e76  ion_indexes, inv
+00011e90: 616c 6964 5f69 6e64 6578 6573 203d 2067  alid_indexes = g
+00011ea0: 6574 5f73 6563 7469 6f6e 735f 6672 6f6d  et_sections_from
+00011eb0: 5f64 6570 7468 280d 0a20 2020 2020 2020  _depth(..       
+00011ec0: 2020 2020 207a 2c20 7a5f 7261 6e67 652c       z, z_range,
+00011ed0: 2072 6574 7572 6e5f 696e 6465 783d 5472   return_index=Tr
+00011ee0: 7565 2029 0d0a 0d0a 2020 2020 2320 2b31  ue )....    # +1
+00011ef0: 2066 6f72 2050 7974 686f 6e20 696e 6465   for Python inde
+00011f00: 7820 0d0a 2020 2020 7472 7920 3a20 0d0a  x ..    try : ..
+00011f10: 2020 2020 2020 2020 7872 203d 2064 6174          xr = dat
+00011f20: 612e 696c 6f63 205b 7261 6e67 6520 282a  a.iloc [range (*
+00011f30: 5b73 6563 7469 6f6e 5f69 6e64 6578 6573  [section_indexes
+00011f40: 5b30 5d2c 2073 6563 7469 6f6e 5f69 6e64  [0], section_ind
+00011f50: 6578 6573 5b2d 315d 202b 315d 295d 0d0a  exes[-1] +1])]..
+00011f60: 2020 2020 6578 6365 7074 2049 6e64 6578      except Index
+00011f70: 4572 726f 7220 3a20 0d0a 2020 2020 2020  Error : ..      
+00011f80: 2020 2320 6272 6561 6b20 2b31 206f 6620    # break +1 of 
+00011f90: 5079 7468 6f6e 2069 6e64 6578 2061 6e64  Python index and
+00011fa0: 2074 616b 6520 696e 6465 7820 7468 696e   take index thin
+00011fb0: 2074 6865 2065 6e64 2e20 0d0a 2020 2020   the end. ..    
+00011fc0: 2020 2020 7872 203d 2064 6174 612e 696c      xr = data.il
+00011fd0: 6f63 205b 7261 6e67 6520 282a 5b73 6563  oc [range (*[sec
+00011fe0: 7469 6f6e 5f69 6e64 6578 6573 5b30 5d2c  tion_indexes[0],
+00011ff0: 2073 6563 7469 6f6e 5f69 6e64 6578 6573   section_indexes
+00012000: 5b2d 315d 5d29 5d0d 0a20 2020 2065 7863  [-1]])]..    exc
+00012010: 6570 7420 4578 6365 7074 696f 6e20 6173  ept Exception as
+00012020: 2065 7272 203a 0d0a 2020 2020 2020 2020   err :..        
+00012030: 7261 6973 6520 6572 7220 0d0a 2020 2020  raise err ..    
+00012040: 696e 7661 6c69 645f 696e 6465 7865 7320  invalid_indexes 
+00012050: 3d20 5f61 7373 6572 745f 7265 6475 6365  = _assert_reduce
+00012060: 5f69 6e64 6578 6573 282a 696e 7661 6c69  _indexes(*invali
+00012070: 645f 696e 6465 7865 7320 290d 0a20 2020  d_indexes )..   
+00012080: 206d 6178 5f69 7820 3d20 6d61 7820 286c   max_ix = max (l
+00012090: 6973 7428 6974 6572 746f 6f6c 732e 6368  ist(itertools.ch
+000120a0: 6169 6e28 2a69 6e76 616c 6964 5f69 6e64  ain(*invalid_ind
+000120b0: 6578 6573 2929 290d 0a20 2020 200d 0a20  exes)))..    .. 
+000120c0: 2020 2069 6620 206d 6178 5f69 7820 3e20     if  max_ix > 
+000120d0: 6c65 6e28 6461 7461 2920 3a0d 0a20 2020  len(data) :..   
+000120e0: 2020 2020 2072 6169 7365 2049 6e64 6578       raise Index
+000120f0: 4572 726f 7228 6622 5772 6f6e 6720 696e  Error(f"Wrong in
+00012100: 6465 7821 2049 6e64 6578 207b 6d61 785f  dex! Index {max_
+00012110: 6978 7d20 6973 206f 7574 206f 6620 7261  ix} is out of ra
+00012120: 6e67 6520 220d 0a20 2020 2020 2020 2020  nge "..         
+00012130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012140: 6622 6f66 2064 6174 6120 7769 7468 206c  f"of data with l
+00012150: 656e 6774 6820 3d20 7b6c 656e 2864 6174  ength = {len(dat
+00012160: 6129 7d22 290d 0a20 0d0a 2020 2020 7873  a)}").. ..    xs
+00012170: 203d 205b 2064 6174 612e 696c 6f63 5b20   = [ data.iloc[ 
+00012180: 7261 6e67 6520 282a 2069 6e64 295d 2066  range (* ind)] f
+00012190: 6f72 2069 6e64 2069 6e20 696e 7661 6c69  or ind in invali
+000121a0: 645f 696e 6465 7865 735d 0d0a 0d0a 2020  d_indexes]....  
+000121b0: 2020 7265 7475 726e 2078 732c 2078 7220    return xs, xr 
+000121c0: 0d0a 0d0a 6465 6620 7265 6475 6365 5f73  ....def reduce_s
+000121d0: 616d 706c 6573 2028 0d0a 2020 2020 2a64  amples (..    *d
+000121e0: 6174 6120 2c20 0d0a 2020 2020 736e 616d  ata , ..    snam
+000121f0: 652c 200d 0a20 2020 207a 6e61 6d65 3d4e  e, ..    zname=N
+00012200: 6f6e 652c 200d 0a20 2020 206b 6e61 6d65  one, ..    kname
+00012210: 3d20 4e6f 6e65 2c0d 0a20 2020 2073 6563  = None,..    sec
+00012220: 7469 6f6e 5f69 6e64 6578 6573 3d4e 6f6e  tion_indexes=Non
+00012230: 652c 2020 0d0a 2020 2020 6572 726f 723d  e,  ..    error=
+00012240: 2772 6169 7365 272c 200d 0a20 2020 2073  'raise', ..    s
+00012250: 7472 6174 6567 793d 2027 6176 6572 6167  trategy= 'averag
+00012260: 6527 2c20 200d 0a20 2020 2076 6572 6966  e',  ..    verif
+00012270: 795f 696e 7465 6772 6974 793d 4661 6c73  y_integrity=Fals
+00012280: 652c 200d 0a20 2020 2069 676e 6f72 655f  e, ..    ignore_
+00012290: 696e 6465 783d 4661 6c73 652c 200d 0a20  index=False, .. 
+000122a0: 2020 202a 2a6b 7773 0d0a 2020 2020 292d     **kws..    )-
+000122b0: 3e4c 6973 745b 4461 7461 4672 616d 655d  >List[DataFrame]
+000122c0: 203a 200d 0a20 2020 200d 0a20 2020 206d   : ..    ..    m
+000122d0: 7367 203d 2028 2227 536f 6674 2720 6d6f  sg = ("'Soft' mo
+000122e0: 6465 2069 7320 7472 6967 6765 7265 6420  de is triggered 
+000122f0: 666f 7220 7361 6d70 6c65 7320 7265 6475  for samples redu
+00012300: 6369 6e67 2e22 0d0a 2020 2020 2020 2020  cing."..        
+00012310: 2020 2022 207b 307d 206e 756d 6265 727b     " {0} number{
+00012320: 317d 206f 6620 6461 7461 2070 6173 7365  1} of data passe
+00012330: 6420 6172 6520 6e6f 7420 7661 6c69 642e  d are not valid.
+00012340: 220d 0a20 2020 2020 2020 2020 2020 2220  "..           " 
+00012350: 5265 6d65 6d62 6572 2074 6861 7420 6461  Remember that da
+00012360: 7461 206d 7573 7420 636f 6e74 6169 6e20  ta must contain 
+00012370: 7468 6520 2764 6570 7468 2720 616e 6422  the 'depth' and"
+00012380: 0d0a 2020 2020 2020 2020 2020 2022 2061  ..           " a
+00012390: 7175 6966 6572 2076 616c 7565 732e 2053  quifer values. S
+000123a0: 686f 756c 6420 6265 2064 6973 6361 7264  hould be discard
+000123b0: 6564 2064 7572 696e 6720 7468 6522 0d0a  ed during the"..
+000123c0: 2020 2020 2020 2020 2020 2022 2063 6f6d             " com
+000123d0: 7075 7469 6e67 206f 6620 6171 7569 6665  puting of aquife
+000123e0: 7220 7365 6374 696f 6e73 2e20 5468 6973  r sections. This
+000123f0: 206d 6967 6874 206c 6561 6420 746f 220d   might lead to".
+00012400: 0a20 2020 2020 2020 2020 2020 2220 6272  .           " br
+00012410: 6561 6b69 6e67 2063 6f64 6520 6f72 2069  eaking code or i
+00012420: 6e76 616c 6964 2072 6573 756c 7473 2e20  nvalid results. 
+00012430: 5573 6520 6174 2079 6f75 7220 6f77 6e20  Use at your own 
+00012440: 220d 0a20 2020 2020 2020 2020 2020 2220  "..           " 
+00012450: 7269 736b 2e22 200d 0a20 2020 2020 2020  risk." ..       
+00012460: 2029 0d0a 0d0a 2020 2020 6466 3020 3d20   )....    df0 = 
+00012470: 636f 7079 2e64 6565 7063 6f70 7928 6461  copy.deepcopy(da
+00012480: 7461 2920 2320 6d61 6b65 2061 2063 6f70  ta) # make a cop
+00012490: 7920 6f66 2066 7261 6d65 200d 0a20 2020  y of frame ..   
+000124a0: 2064 6673 203d 205f 7661 6c69 6461 7465   dfs = _validate
+000124b0: 5f73 616d 706c 6573 2820 2a64 6630 2029  _samples( *df0 )
+000124c0: 2020 0d0a 2020 2020 0d0a 2020 2020 6466    ..    ..    df
+000124d0: 733d 5b64 662e 7265 7365 745f 696e 6465  s=[df.reset_inde
+000124e0: 7828 2920 666f 7220 6466 2069 6e20 6466  x() for df in df
+000124f0: 735d 2023 2072 6573 6574 2069 6e64 6578  s] # reset index
+00012500: 200d 0a20 2020 2023 2067 6574 2074 6865   ..    # get the
+00012510: 2061 7175 6966 6572 2073 6563 7469 6f6e   aquifer section
+00012520: 7320 6669 7274 7320 0d0a 2020 2020 6966  s firts ..    if
+00012530: 2073 6563 7469 6f6e 5f69 6e64 6578 6573   section_indexes
+00012540: 2069 7320 4e6f 6e65 3a20 0d0a 2020 2020   is None: ..    
+00012550: 2020 2020 7365 6374 696f 6e5f 696e 6465      section_inde
+00012560: 7865 732c 2064 6673 203d 2067 6574 5f75  xes, dfs = get_u
+00012570: 6e69 7175 655f 7365 6374 696f 6e28 0d0a  nique_section(..
+00012580: 2020 2020 2020 2020 2020 2020 2a64 6673              *dfs
+00012590: 2c20 7a6e 616d 653d 7a6e 616d 652c 206b  , zname=zname, k
+000125a0: 6e61 6d65 3d6b 6e61 6d65 2c20 6572 726f  name=kname, erro
+000125b0: 723d 2065 7272 6f72 2c20 0d0a 2020 2020  r= error, ..    
+000125c0: 2020 2020 2020 2020 7265 7475 726e 5f64          return_d
+000125d0: 6174 6120 3d54 7275 652c 2072 6574 7572  ata =True, retur
+000125e0: 6e5f 696e 6465 783d 5472 7565 200d 0a20  n_index=True .. 
+000125f0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00012600: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00012610: 6966 206c 656e 2864 6630 2921 3d6c 656e  if len(df0)!=len
+00012620: 2864 6673 293a 200d 0a20 2020 2020 2020  (dfs): ..       
+00012630: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00012640: 726e 2028 206d 7367 2e66 6f72 6d61 7428  rn ( msg.format(
+00012650: 6c65 6e28 7365 6374 696f 6e5f 696e 6465  len(section_inde
+00012660: 7865 7329 2c20 0d0a 2020 2020 2020 2020  xes), ..        
+00012670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012680: 2273 2220 6966 206c 656e 2873 6563 7469  "s" if len(secti
+00012690: 6f6e 5f69 6e64 6578 6573 293e 3120 656c  on_indexes)>1 el
+000126a0: 7365 2022 2229 290d 0a20 2020 2020 2020  se ""))..       
+000126b0: 200d 0a20 2020 2058 732c 2058 7220 3d5b   ..    Xs, Xr =[
+000126c0: 5d2c 205b 5d0d 0a20 2020 2066 6f72 2064  ], []..    for d
+000126d0: 6620 696e 2064 6673 203a 200d 0a20 2020  f in dfs : ..   
+000126e0: 2020 2020 2078 732c 2078 7220 3d20 6765       xs, xr = ge
+000126f0: 745f 7873 5f78 725f 7370 6c69 7473 2028  t_xs_xr_splits (
+00012700: 6466 2c20 7365 6374 696f 6e5f 696e 6465  df, section_inde
+00012710: 7865 733d 2073 6563 7469 6f6e 5f69 6e64  xes= section_ind
+00012720: 6578 6573 290d 0a20 2020 2020 2020 2058  exes)..        X
+00012730: 732e 6170 7065 6e64 2878 7329 203b 2058  s.append(xs) ; X
+00012740: 722e 6170 7065 6e64 2878 7229 0d0a 2020  r.append(xr)..  
+00012750: 2020 2020 2020 0d0a 2020 2020 645f 6e65        ..    d_ne
+00012760: 773d 5b5d 0d0a 2020 2020 666f 7220 2064  w=[]..    for  d
+00012770: 665f 7873 202c 2064 665f 7872 2069 6e20  f_xs , df_xr in 
+00012780: 7a69 7020 2820 5873 202c 2058 7220 293a  zip ( Xs , Xr ):
+00012790: 200d 0a20 2020 2020 2020 2023 2023 2063   ..        # # c
+000127a0: 6f6d 7075 7465 2074 6865 2062 6173 6520  ompute the base 
+000127b0: 7374 7261 7475 6d20 666f 7220 0d0a 2020  stratum for ..  
+000127c0: 2020 2020 2020 2320 6561 6368 2065 6163        # each eac
+000127d0: 6820 7265 6475 6365 2073 6563 7469 6f6e  h reduce section
+000127e0: 7320 0d0a 2020 2020 2020 2020 6261 7365  s ..        base
+000127f0: 735f 7320 3d20 5b20 7365 6c65 6374 5f62  s_s = [ select_b
+00012800: 6173 655f 7374 7261 7475 6d28 642c 2073  ase_stratum(d, s
+00012810: 6e61 6d65 3d73 6e61 6d65 2029 0d0a 2020  name=sname )..  
+00012820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012830: 2020 666f 7220 692c 2064 2069 6e20 656e    for i, d in en
+00012840: 756d 6572 6174 6520 2864 665f 7873 2920  umerate (df_xs) 
+00012850: 5d20 0d0a 2020 2020 2020 2020 2320 7265  ] ..        # re
+00012860: 6475 6365 2073 616d 706c 6520 666f 7220  duce sample for 
+00012870: 6561 6368 2069 6e76 616c 6964 2073 6563  each invalid sec
+00012880: 7469 6f6e 2077 6974 6820 0d0a 2020 2020  tion with ..    
+00012890: 2020 2020 2320 6d69 7373 696e 6720 6b20      # missing k 
+000128a0: 0d0a 2020 2020 2020 2020 636f 6d70 5f76  ..        comp_v
+000128b0: 6563 7320 3d20 5b20 6765 745f 636f 6d70  ecs = [ get_comp
+000128c0: 7265 7373 6564 5f76 6563 746f 7228 2064  ressed_vector( d
+000128d0: 2c20 736e 616d 653d 736e 616d 6520 2c20  , sname=sname , 
+000128e0: 7374 7261 7475 6d20 3d20 7374 2c20 200d  stratum = st,  .
+000128f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012900: 2020 2020 2020 6173 5f66 7261 6d65 203d        as_frame =
+00012910: 5472 7565 202c 2073 7472 6174 6567 793d  True , strategy=
+00012920: 7374 7261 7465 6779 2c20 0d0a 2020 2020  strategy, ..    
+00012930: 2020 2020 2020 2020 2920 666f 7220 692c          ) for i,
+00012940: 2028 7374 202c 2064 2920 2069 6e20 656e   (st , d)  in en
+00012950: 756d 6572 6174 6520 2820 7a69 7020 2862  umerate ( zip (b
+00012960: 6173 6573 5f73 202c 2064 665f 7873 2929  ases_s , df_xs))
+00012970: 2020 5d0d 0a20 2020 2020 2020 2023 2067    ]..        # g
+00012980: 6574 2074 6865 2069 6e64 6578 2074 6f20  et the index to 
+00012990: 7374 6163 6b20 7468 6520 636f 6d70 7265  stack the compre
+000129a0: 7365 6420 7361 6d70 6c65 2077 6974 6820  sed sample with 
+000129b0: 0d0a 2020 2020 2020 2020 2320 7468 6520  ..        # the 
+000129c0: 7661 6c69 6420 7061 7274 206f 6620 6171  valid part of aq
+000129d0: 7569 6665 7220 6461 7461 2e20 0d0a 2020  uifer data. ..  
+000129e0: 2020 2020 2020 7873 5f69 6e64 6578 6573        xs_indexes
+000129f0: 203d 205b 2820 6d69 6e28 2064 662e 696e   = [( min( df.in
+00012a00: 6465 7829 2c20 6d61 7828 6466 2e69 6e64  dex), max(df.ind
+00012a10: 6578 2929 2066 6f72 2064 6620 696e 2064  ex)) for df in d
+00012a20: 665f 7873 205d 0d0a 2020 2020 2020 2020  f_xs ]..        
+00012a30: 2320 636f 6e63 6174 2074 6865 2063 6f6d  # concat the com
+00012a40: 7072 6573 7320 7769 7468 2078 7220 0d0a  press with xr ..
+00012a50: 2020 2020 2020 2020 6466 5f3d 205f 636f          df_= _co
+00012a60: 6e63 6174 5f63 6f6d 7072 6573 7365 645f  ncat_compressed_
+00012a70: 7873 5f78 7228 0d0a 2020 2020 2020 2020  xs_xr(..        
+00012a80: 2020 2020 7873 5f69 6e64 6578 6573 203d      xs_indexes =
+00012a90: 7873 5f69 6e64 6578 6573 202c 7872 5f69  xs_indexes ,xr_i
+00012aa0: 6e64 6578 6573 203d 2073 6563 7469 6f6e  ndexes = section
+00012ab0: 5f69 6e64 6578 6573 2c20 0d0a 2020 2020  _indexes, ..    
+00012ac0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+00012ad0: 7265 7373 6564 5f66 7261 6d65 7320 3d20  ressed_frames = 
+00012ae0: 636f 6d70 5f76 6563 732c 200d 0a20 2020  comp_vecs, ..   
+00012af0: 2020 2020 2020 2020 2020 2020 2078 723d               xr=
+00012b00: 2064 665f 7872 2029 0d0a 2020 2020 2020   df_xr )..      
+00012b10: 2020 645f 6e65 772e 6170 7065 6e64 2028    d_new.append (
+00012b20: 6466 5f29 0d0a 0d0a 2020 2020 6966 206e  df_)....    if n
+00012b30: 6f74 2069 676e 6f72 655f 696e 6465 783a  ot ignore_index:
+00012b40: 200d 0a20 2020 2020 2020 2023 2067 6f74   ..        # got
+00012b50: 2062 6163 6b20 696e 6961 6c20 6461 7461   back inial data
+00012b60: 2e20 0d0a 2020 2020 2020 2020 645f 6e65  . ..        d_ne
+00012b70: 7720 3d20 5b20 6466 2e64 726f 7020 2820  w = [ df.drop ( 
+00012b80: 636f 6c75 6d6e 7320 3d20 2769 6e64 6578  columns = 'index
+00012b90: 2729 200d 0a20 2020 2020 2020 2020 2020  ') ..           
+00012ba0: 2020 2020 2020 2069 6620 2769 6e64 6578         if 'index
+00012bb0: 2720 696e 2064 662e 636f 6c75 6d6e 7320  ' in df.columns 
+00012bc0: 656c 7365 2064 6620 0d0a 2020 2020 2020  else df ..      
+00012bd0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00012be0: 6466 2069 6e20 645f 6e65 7720 0d0a 2020  df in d_new ..  
+00012bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012c00: 5d0d 0a20 2020 2023 2076 6572 6966 7920  ]..    # verify 
+00012c10: 696e 7465 6772 6974 7920 6669 7273 740d  integrity first.
+00012c20: 0a20 2020 2023 2062 6566 6f72 6520 7265  .    # before re
+00012c30: 7365 7420 696e 6465 7820 0d0a 2020 2020  set index ..    
+00012c40: 6966 2076 6572 6966 795f 696e 7465 6772  if verify_integr
+00012c50: 6974 793a 200d 0a20 2020 2020 2020 2064  ity: ..        d
+00012c60: 5f6e 6577 203d 205b 2020 6466 2e64 726f  _new = [  df.dro
+00012c70: 705f 6475 706c 6963 6174 6573 2873 7562  p_duplicates(sub
+00012c80: 7365 743d 4e6f 6e65 2c20 6b65 6570 3d27  set=None, keep='
+00012c90: 6669 7273 7427 2c20 200d 0a20 2020 2020  first',  ..     
+00012ca0: 2020 2020 2020 2069 676e 6f72 655f 696e         ignore_in
+00012cb0: 6465 783d 6967 6e6f 7265 5f69 6e64 6578  dex=ignore_index
+00012cc0: 2029 2066 6f72 2064 6620 696e 2064 5f6e   ) for df in d_n
+00012cd0: 6577 205d 200d 0a20 2020 2020 2020 200d  ew ] ..        .
+00012ce0: 0a20 2020 2069 6620 6967 6e6f 7265 5f69  .    if ignore_i
+00012cf0: 6e64 6578 203a 200d 0a20 2020 2020 2020  ndex : ..       
+00012d00: 2023 2072 6573 6574 2074 6865 2069 6e64   # reset the ind
+00012d10: 6578 206f 6620 7468 6520 6e65 7720 6461  ex of the new da
+00012d20: 7461 2066 7261 6d65 0d0a 2020 2020 2020  ta frame..      
+00012d30: 2020 645f 6e65 7720 3d20 5b64 662e 7265    d_new = [df.re
+00012d40: 7365 745f 696e 6465 7820 2829 2066 6f72  set_index () for
+00012d50: 2064 6620 696e 2064 5f6e 6577 205d 0d0a   df in d_new ]..
+00012d60: 2020 2020 2020 2020 645f 6e65 7720 3d20          d_new = 
+00012d70: 5b20 6466 2e64 726f 7020 2863 6f6c 756d  [ df.drop (colum
+00012d80: 6e73 203d 2027 6c65 7665 6c5f 3027 206f  ns = 'level_0' o
+00012d90: 7220 2769 6e64 6578 2729 2069 660d 0a20  r 'index') if.. 
+00012da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012db0: 2827 6c65 7665 6c5f 3027 206f 7220 2769  ('level_0' or 'i
+00012dc0: 6e64 6578 2729 2020 696e 2064 662e 636f  ndex')  in df.co
+00012dd0: 6c75 6d6e 7320 656c 7365 2064 6620 0d0a  lumns else df ..
+00012de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012df0: 2066 6f72 2064 6620 696e 2064 5f6e 6577   for df in d_new
+00012e00: 2020 5d0d 0a20 2020 200d 0a20 2020 2072    ]..    ..    r
+00012e10: 6574 7572 6e20 645f 6e65 7720 0d0a 0d0a  eturn d_new ....
+00012e20: 7265 6475 6365 5f73 616d 706c 6573 2e5f  reduce_samples._
+00012e30: 5f64 6f63 5f5f 203d 2222 225c 0d0a 4372  _doc__ ="""\..Cr
+00012e40: 6561 7465 2061 206e 6577 2064 6174 6166  eate a new dataf
+00012e50: 7261 6d65 2062 7920 7371 7565 657a 696e  rame by squeezin
+00012e60: 672f 636f 6d70 7265 7373 696e 6720 7468  g/compressing th
+00012e70: 6520 6e6f 6e20 7661 6c69 6420 6461 7461  e non valid data
+00012e80: 2e20 0d0a 0d0a 5468 6520 6d2d 7361 6d70  . ....The m-samp
+00012e90: 6c65 7320 7265 6475 6374 696f 6e20 6973  les reduction is
+00012ea0: 206e 6563 6573 7361 7279 2066 6f72 2074   necessary for t
+00012eb0: 6865 2064 6174 6173 6574 2077 6974 6820  he dataset with 
+00012ec0: 6120 6c6f 7420 6f66 200d 0a6d 6973 7369  a lot of ..missi
+00012ed0: 6e67 206b 2d76 616c 7565 732e 2054 6865  ng k-values. The
+00012ee0: 2074 6563 686e 6971 7565 206f 6620 7368   technique of sh
+00012ef0: 7269 6e6b 696e 6720 7468 6520 6e75 6d62  rinking the numb
+00012f00: 6572 206f 6620 6b30 20e2 8093 7661 6c75  er of k0 ...valu
+00012f10: 6573 200d 0a28 6b2d 6d69 7373 696e 6720  es ..(k-missing 
+00012f20: 7661 6c75 6573 2029 2073 6565 6d73 2061  values ) seems a
+00012f30: 2072 656c 6576 616e 7420 6964 6561 2e20   relevant idea. 
+00012f40: 4974 2063 6f6e 7369 7374 7320 746f 2063  It consists to c
+00012f50: 6f6d 7072 6573 7365 6420 7468 6520 0d0a  ompressed the ..
+00012f60: 7661 6c75 6573 206f 6620 7468 6520 6d69  values of the mi
+00012f70: 7373 696e 6720 3a6d 6174 683a 606b 202d  ssing :math:`k -
+00012f80: 7661 6c75 6573 2066 726f 6d20 7468 6520  values from the 
+00012f90: 746f 7020 2820 6465 7074 6820 6571 7561  top ( depth equa
+00012fa0: 6c73 2030 2029 200d 0a74 6869 6e20 7468  ls 0 ) ..thin th
+00012fb0: 6520 7570 7065 7220 7365 6374 696f 6e20  e upper section 
+00012fc0: 6f66 2074 6865 2066 6972 7374 2061 7175  of the first aqu
+00012fd0: 6966 6572 2077 6974 6820 6c6f 7765 7220  ifer with lower 
+00012fe0: 6465 7074 6820 696e 746f 200d 0a61 2073  depth into ..a s
+00012ff0: 696e 676c 6520 7665 6374 6f72 203a 6d61  ingle vector :ma
+00013000: 7468 3a60 785f 7260 2077 6974 6820 6469  th:`x_r` with di
+00013010: 6d65 6e73 696f 6e20 2831 c397 6e20 2920  mension (1..n ) 
+00013020: 692e 652e 2063 6f6e 7461 696e 7320 0d0a  i.e. contains ..
+00013030: 7468 6520 6e2d 6665 6174 7572 6573 2e20  the n-features. 
+00013040: 200d 0a20 0d0a 5061 7261 6d65 7465 7273   .. ..Parameters
+00013050: 200d 0a2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a   ..-----------..
+00013060: 6461 7461 3a20 6c69 7374 206f 6620 6461  data: list of da
+00013070: 7461 6672 616d 6573 0d0a 2020 2020 4461  taframes..    Da
+00013080: 7461 2074 6861 7420 636f 6e74 6169 6e73  ta that contains
+00013090: 206d 6169 6e6c 7920 7468 6520 6171 7569   mainly the aqui
+000130a0: 6665 7220 7661 6c75 6573 2e20 4974 206d  fer values. It m
+000130b0: 7573 7420 636f 6e74 6169 6e73 2074 6865  ust contains the
+000130c0: 200d 0a20 2020 2064 6570 7468 2076 616c   ..    depth val
+000130d0: 7565 7320 7265 6665 7269 6e67 2061 7420  ues refering at 
+000130e0: 7468 6520 636f 6c75 6d6e 5f6e 616d 6520  the column_name 
+000130f0: 7061 7373 6564 2061 7420 607a 6e61 6d65  passed at `zname
+00013100: 6020 2061 6e64 200d 0a20 2020 2074 6865  `  and ..    the
+00013110: 2070 6572 6d65 6162 696c 6974 7920 636f   permeability co
+00013120: 6566 6669 6369 656e 7420 606b 6020 7061  efficient `k` pa
+00013130: 7373 6564 2074 6f20 606b 6e61 6d65 6020  ssed to `kname` 
+00013140: 2e20 426f 7468 2061 7267 756d 656e 7420  . Both argument 
+00013150: 6e65 6564 200d 0a20 2020 2074 2073 7570  need ..    t sup
+00013160: 706c 6965 6420 7768 656e 2064 6174 6166  plied when dataf
+00013170: 616d 6520 6173 2070 6173 7365 7320 6173  ame as passes as
+00013180: 2070 6f73 6974 696f 6e61 6c20 6172 6775   positional argu
+00013190: 6d65 6e74 732e 0d0a 2020 2020 0d0a 736e  ments...    ..sn
+000131a0: 616d 653a 2073 7472 2c20 6f70 7469 6f6e  ame: str, option
+000131b0: 616c 200d 0a20 2020 204e 616d 6520 6f66  al ..    Name of
+000131c0: 2063 6f6c 756d 6e20 696e 2074 6865 2064   column in the d
+000131d0: 6174 6166 7261 6d65 2074 6861 7420 636f  ataframe that co
+000131e0: 6e74 6169 6e73 2074 6865 2073 7472 6174  ntains the strat
+000131f0: 6120 7661 6c75 6573 2e20 0d0a 2020 2020  a values. ..    
+00013200: 446f 6e74 2063 6f6e 6675 7365 2027 736e  Dont confuse 'sn
+00013210: 616d 6527 2077 6974 6820 2773 7472 6174  ame' with 'strat
+00013220: 756d 2720 7768 6963 6820 6973 2074 6865  um' which is the
+00013230: 206e 616d 6520 6f66 2074 6865 2076 616c   name of the val
+00013240: 6964 200d 0a20 2020 206c 6179 6572 2f72  id ..    layer/r
+00013250: 6f63 6b20 696e 2074 6865 2061 7272 6179  ock in the array
+00013260: 2f53 6572 6965 7320 6f66 2073 7472 6174  /Series of strat
+00013270: 612e 200d 0a0d 0a7b 7061 7261 6d73 2e63  a. ....{params.c
+00013280: 6f72 652e 7a6e 616d 657d 0d0a 7b70 6172  ore.zname}..{par
+00013290: 616d 732e 636f 7265 2e6b 6e61 6d65 7d0d  ams.core.kname}.
+000132a0: 0a7b 7061 7261 6d73 2e63 6f72 652e 7a7d  .{params.core.z}
+000132b0: 0d0a 0d0a 7374 7261 7465 6779 3a20 7374  ....strategy: st
+000132c0: 7220 2c20 6465 6661 756c 743d 2761 7665  r , default='ave
+000132d0: 7261 6765 2720 6f72 2027 6d65 616e 272c  rage' or 'mean',
+000132e0: 200d 0a20 2020 2073 7472 6174 6567 7920   ..    strategy 
+000132f0: 7573 6564 2074 6f20 7365 6c65 6374 206f  used to select o
+00013300: 7220 636f 6d70 7574 6520 7468 6520 6e75  r compute the nu
+00013310: 6d65 7269 6361 6c20 6461 7461 2069 6e74  merical data int
+00013320: 6f20 6120 0d0a 2020 2020 7369 6e67 756c  o a ..    singul
+00013330: 6172 2073 6572 6965 732e 2049 7420 6361  ar series. It ca
+00013340: 6e20 6265 205b 276e 6169 7665 275d 2e20  n be ['naive']. 
+00013350: 496e 2074 6861 7420 6361 7365 202c 2061  In that case , a
+00013360: 2073 696e 676c 6520 7365 7269 6520 0d0a   single serie ..
+00013370: 2020 2020 6966 2072 616e 646f 6d6c 7920      if randomly 
+00013380: 7069 636b 6564 2075 7020 696e 746f 2074  picked up into t
+00013390: 6865 2062 6173 6520 7374 7261 7461 2064  he base strata d
+000133a0: 6174 612e 0d0a 2020 2020 0d0a 7365 6374  ata...    ..sect
+000133b0: 696f 6e5f 696e 6465 7865 733a 2074 7570  ion_indexes: tup
+000133c0: 6c65 206f 7220 6c69 7374 206f 6620 696e  le or list of in
+000133d0: 7420 0d0a 2020 2020 6c69 7374 206f 6620  t ..    list of 
+000133e0: 6120 7061 6972 2074 7570 6c65 206f 7220  a pair tuple or 
+000133f0: 6c69 7374 206f 6620 696e 7465 6765 7273  list of integers
+00013400: 2e20 4974 2069 7320 6265 2074 6865 2074  . It is be the t
+00013410: 6865 2076 616c 6964 200d 0a20 2020 2073  he valid ..    s
+00013420: 6563 7469 6f6e 7328 2075 7070 6572 2061  ections( upper a
+00013430: 6e64 206c 6f77 6572 2029 2069 6e64 6578  nd lower ) index
+00013440: 6573 206f 6620 206f 6620 7468 6520 6171  es of  of the aq
+00013450: 7569 6665 722e 2049 6620 0d0a 2020 2020  uifer. If ..    
+00013460: 7468 6520 6465 7074 6820 7261 6e67 6520  the depth range 
+00013470: 607a 5f72 616e 6765 6020 616e 6420 607a  `z_range` and `z
+00013480: 6e61 6d65 6020 6172 6520 7375 7070 6c69  name` are suppli
+00013490: 6564 2c20 6073 6563 7469 6f6e 5f69 6e64  ed, `section_ind
+000134a0: 6578 6573 600d 0a20 2020 2063 616e 2062  exes`..    can b
+000134b0: 6520 4e6f 6e65 2e20 204e 6f74 6520 7468  e None.  Note th
+000134c0: 6174 2074 6865 206c 6173 7420 696e 6469  at the last indi
+000134d0: 7820 6973 2063 6f6e 7369 6465 7265 6420  x is considered 
+000134e0: 6173 2074 6865 206c 6173 7420 0d0a 2020  as the last ..  
+000134f0: 2020 706f 7369 7469 6f6e 2c20 7468 6520    position, the 
+00013500: 626f 7474 6f6d 206f 6620 7468 6520 7365  bottom of the se
+00013510: 6374 696f 6e20 7468 6572 6566 6f72 652c  ction therefore,
+00013520: 2069 7473 2076 616c 7565 2069 7320 0d0a   its value is ..
+00013530: 2020 2020 696e 636c 7564 6564 2069 6e20      included in 
+00013540: 7468 6520 6461 7461 2e0d 0a20 2020 2020  the data...     
+00013550: 2020 200d 0a65 7272 6f72 3a20 7374 722c     ..error: str,
+00013560: 2064 6566 6175 6c74 3d27 7261 6973 6527   default='raise'
+00013570: 200d 0a20 2020 2052 6169 7365 2065 7272   ..    Raise err
+00013580: 6f72 7320 6966 2074 726f 7562 6c65 206f  ors if trouble o
+00013590: 6363 7572 7320 7768 656e 2063 6f6d 7075  ccurs when compu
+000135a0: 7469 6e67 2074 6865 2073 6563 7469 6f6e  ting the section
+000135b0: 206f 6620 6561 6368 2061 7175 6966 6572   of each aquifer
+000135c0: 2e20 0d0a 2020 2020 4966 2027 6967 6e6f  . ..    If 'igno
+000135d0: 7265 272c 2061 2055 7365 7257 6172 6e69  re', a UserWarni
+000135e0: 6e67 2069 7320 6469 7370 6c61 7965 6420  ng is displayed 
+000135f0: 7768 656e 2069 6e76 616c 6964 2064 6174  when invalid dat
+00013600: 6120 6973 2066 6f75 6e64 2e20 416e 7920  a is found. Any 
+00013610: 0d0a 2020 2020 6f74 6865 7220 7661 6c75  ..    other valu
+00013620: 6520 6f66 2060 6572 726f 7260 2077 696c  e of `error` wil
+00013630: 6c20 7365 7420 6572 726f 7220 746f 2060  l set error to `
+00013640: 7261 6973 6560 2e20 0d0a 0d0a 7665 7269  raise`. ....veri
+00013650: 6679 5f69 6e74 6567 7269 7479 3a20 626f  fy_integrity: bo
+00013660: 6f6c 2c20 6465 6661 756c 743d 4661 6c73  ol, default=Fals
+00013670: 650d 0a20 2020 2043 6865 636b 2074 6865  e..    Check the
+00013680: 206e 6577 2069 6e64 6578 2066 6f72 2064   new index for d
+00013690: 7570 6c69 6361 7465 732e 204f 7468 6572  uplicates. Other
+000136a0: 7769 7365 2064 6566 6572 2074 6865 2063  wise defer the c
+000136b0: 6865 636b 2075 6e74 696c 200d 0a20 2020  heck until ..   
+000136c0: 206e 6563 6573 7361 7279 2e20 5365 7474   necessary. Sett
+000136d0: 696e 6720 746f 2046 616c 7365 2077 696c  ing to False wil
+000136e0: 6c20 696d 7072 6f76 6520 7468 6520 7065  l improve the pe
+000136f0: 7266 6f72 6d61 6e63 6520 6f66 200d 0a20  rformance of .. 
+00013700: 2020 2074 6869 7320 6d65 7468 6f64 2e0d     this method..
+00013710: 0a20 2020 2069 6620 2754 7275 6527 2c20  .    if 'True', 
+00013720: 7265 6d6f 7665 2074 6865 2064 7570 6c69  remove the dupli
+00013730: 6361 7465 2072 6f77 7320 6672 6f6d 2061  cate rows from a
+00013740: 2044 6174 6146 7261 6d65 2e0d 0a20 2020   DataFrame...   
+00013750: 200d 0a20 2020 2020 2020 2073 7562 7365   ..        subse
+00013760: 743a 2042 7920 6465 6661 756c 742c 2069  t: By default, i
+00013770: 6620 7468 6520 726f 7773 2068 6176 6520  f the rows have 
+00013780: 7468 6520 7361 6d65 2076 616c 7565 7320  the same values 
+00013790: 696e 2061 6c6c 2074 6865 200d 0a20 2020  in all the ..   
+000137a0: 2020 2020 2063 6f6c 756d 6e73 2c20 7468       columns, th
+000137b0: 6579 2061 7265 2063 6f6e 7369 6465 7265  ey are considere
+000137c0: 6420 6475 706c 6963 6174 6573 2e20 5468  d duplicates. Th
+000137d0: 6973 2070 6172 616d 6574 6572 2069 7320  is parameter is 
+000137e0: 7573 6564 200d 0a20 2020 2020 2020 2074  used ..        t
+000137f0: 6f20 7370 6563 6966 7920 7468 6520 636f  o specify the co
+00013800: 6c75 6d6e 7320 7468 6174 206f 6e6c 7920  lumns that only 
+00013810: 6e65 6564 2074 6f20 6265 2063 6f6e 7369  need to be consi
+00013820: 6465 7265 6420 666f 7220 0d0a 2020 2020  dered for ..    
+00013830: 2020 2020 6964 656e 7469 6679 696e 6720      identifying 
+00013840: 6475 706c 6963 6174 6573 2e0d 0a20 2020  duplicates...   
+00013850: 2020 2020 206b 6565 703a 2044 6574 6572       keep: Deter
+00013860: 6d69 6e65 7320 7768 6963 6820 6475 706c  mines which dupl
+00013870: 6963 6174 6573 2028 6966 2061 6e79 2920  icates (if any) 
+00013880: 746f 206b 6565 702e 2049 7420 7461 6b65  to keep. It take
+00013890: 7320 696e 7075 7473 2061 732c 0d0a 2020  s inputs as,..  
+000138a0: 2020 2020 2020 6669 7273 7420 e280 9320        first ... 
+000138b0: 4472 6f70 2064 7570 6c69 6361 7465 7320  Drop duplicates 
+000138c0: 6578 6365 7074 2066 6f72 2074 6865 2066  except for the f
+000138d0: 6972 7374 206f 6363 7572 7265 6e63 652e  irst occurrence.
+000138e0: 200d 0a20 2020 2020 2020 2054 6869 7320   ..        This 
+000138f0: 6973 2074 6865 2064 6566 6175 6c74 2062  is the default b
+00013900: 6568 6176 696f 722e 0d0a 2020 2020 2020  ehavior...      
+00013910: 2020 6c61 7374 20e2 8093 2044 726f 7020    last ... Drop 
+00013920: 6475 706c 6963 6174 6573 2065 7863 6570  duplicates excep
+00013930: 7420 666f 7220 7468 6520 6c61 7374 206f  t for the last o
+00013940: 6363 7572 7265 6e63 652e 0d0a 2020 2020  ccurrence...    
+00013950: 2020 2020 4661 6c73 6520 e280 9320 4472      False ... Dr
+00013960: 6f70 2061 6c6c 2064 7570 6c69 6361 7465  op all duplicate
+00013970: 732e 0d0a 2020 2020 2020 2020 696e 706c  s...        inpl
+00013980: 6163 653a 2049 7420 6973 2075 7365 6420  ace: It is used 
+00013990: 746f 2073 7065 6369 6679 2077 6865 7468  to specify wheth
+000139a0: 6572 2074 6f20 7265 7475 726e 2061 206e  er to return a n
+000139b0: 6577 2044 6174 6146 7261 6d65 206f 7220  ew DataFrame or 
+000139c0: 0d0a 2020 2020 2020 2020 7570 6461 7465  ..        update
+000139d0: 2061 6e20 6578 6973 7469 6e67 206f 6e65   an existing one
+000139e0: 2e20 4974 2069 7320 6120 626f 6f6c 6561  . It is a boolea
+000139f0: 6e20 666c 6167 2077 6974 6820 6465 6661  n flag with defa
+00013a00: 756c 7420 4661 6c73 652e 0d0a 6967 6e6f  ult False...igno
+00013a10: 7265 5f69 6e64 6578 3a20 626f 6f6c 2c20  re_index: bool, 
+00013a20: 6465 6661 756c 743d 4661 6c73 652c 200d  default=False, .
+00013a30: 0a20 2020 2049 7420 6973 2061 2062 6f6f  .    It is a boo
+00013a40: 6c65 616e 2066 6c61 6720 746f 2069 6e64  lean flag to ind
+00013a50: 6963 6174 6520 6966 2072 6f77 2069 6e64  icate if row ind
+00013a60: 6578 2073 686f 756c 6420 0d0a 2020 2020  ex should ..    
+00013a70: 6265 2072 6573 6574 2061 6674 6572 2064  be reset after d
+00013a80: 726f 7070 696e 6720 6475 706c 6963 6174  ropping duplicat
+00013a90: 6520 726f 7773 2e20 4661 6c73 653a 2049  e rows. False: I
+00013aa0: 7420 6b65 6570 7320 7468 6520 6f72 6967  t keeps the orig
+00013ab0: 696e 616c 200d 0a20 2020 2072 6f77 2069  inal ..    row i
+00013ac0: 6e64 6578 2e20 5472 7565 3a20 4974 2072  ndex. True: It r
+00013ad0: 6573 6574 2074 6865 2069 6e64 6578 2c20  eset the index, 
+00013ae0: 616e 6420 7468 6520 7265 7375 6c74 696e  and the resultin
+00013af0: 6720 726f 7773 2077 696c 6c20 6265 200d  g rows will be .
+00013b00: 0a20 2020 206c 6162 656c 6564 2030 2c20  .    labeled 0, 
+00013b10: 312c 20e2 80a6 2c20 6e20 e280 9320 312e  1, ..., n ... 1.
+00013b20: 200d 0a20 2020 200d 0a52 6574 7572 6e73   ..    ..Returns
+00013b30: 200d 0a2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a64   ..----------..d
+00013b40: 665f 6e65 773a 204c 6973 7420 6f66 2070  f_new: List of p
+00013b50: 616e 6461 732e 6461 7461 6672 616d 6573  andas.dataframes
+00013b60: 0d0a 2020 2020 6e65 7720 6461 7461 6672  ..    new datafr
+00013b70: 616d 6573 2077 6974 6820 7265 6475 6369  ames with reduci
+00013b80: 6e67 2073 616d 706c 6573 2e20 0d0a 2020  ng samples. ..  
+00013b90: 2020 0d0a 4578 616d 706c 6520 0d0a 2d2d    ..Example ..--
+00013ba0: 2d2d 2d2d 2d2d 0d0a 3e3e 3e20 6672 6f6d  ------..>>> from
+00013bb0: 2077 6174 6578 2e64 6174 6173 6574 7320   watex.datasets 
+00013bc0: 696d 706f 7274 206c 6f61 645f 686c 6f67  import load_hlog
+00013bd0: 730d 0a3e 3e3e 2066 726f 6d20 7761 7465  s..>>> from wate
+00013be0: 782e 7574 696c 732e 6879 6472 6f75 7469  x.utils.hydrouti
+00013bf0: 6c73 2069 6d70 6f72 7420 7265 6475 6365  ls import reduce
+00013c00: 5f73 616d 706c 6573 200d 0a3e 3e3e 2064  _samples ..>>> d
+00013c10: 6174 6120 3d20 6c6f 6164 5f68 6c6f 6773  ata = load_hlogs
+00013c20: 2028 292e 6672 616d 6520 2320 6765 7420   ().frame # get 
+00013c30: 7468 6520 6672 616d 6573 200d 0a3e 3e3e  the frames ..>>>
+00013c40: 2023 2061 6464 2065 7870 6c69 6369 746c   # add explicitl
+00013c50: 7920 7468 6520 6171 7569 6665 7220 7365  y the aquifer se
+00013c60: 6374 696f 6e20 696e 6469 6365 7320 0d0a  ction indices ..
+00013c70: 3e3e 3e20 6466 6e65 773d 2072 6564 7563  >>> dfnew= reduc
+00013c80: 655f 7361 6d70 6c65 7320 2864 6174 612e  e_samples (data.
+00013c90: 636f 7079 2829 2c20 736e 616d 653d 2773  copy(), sname='s
+00013ca0: 7472 6174 615f 6e61 6d65 272c 200d 0a20  trata_name', .. 
+00013cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013cc0: 2020 2020 2020 2020 2020 2020 7365 6374              sect
+00013cd0: 696f 6e5f 696e 6465 7865 7320 3d20 2831  ion_indexes = (1
+00013ce0: 362c 2032 3920 292c 290d 0a3e 3e3e 2064  6, 29 ),)..>>> d
+00013cf0: 666e 6577 5b30 5d0d 0a2e 2e2e 2020 2020  fnew[0].....    
+00013d00: 686f 6c65 5f6e 756d 6265 7220 2020 2020  hole_number     
+00013d10: 2020 2020 2020 2020 2020 7374 7261 7461            strata
+00013d20: 5f6e 616d 6520 2020 2020 726f 636b 5f6e  _name     rock_n
+00013d30: 616d 6520 202e 2e2e 2020 2020 2020 7220  ame  ...      r 
+00013d40: 2020 2020 7270 2020 7265 6d61 726b 0d0a      rp  remark..
+00013d50: 2020 2020 3020 2020 2020 2020 2020 4835      0         H5
+00013d60: 3032 2020 2020 2020 2020 2020 2020 2020  02              
+00013d70: 2020 2020 6d75 6473 746f 6e65 2020 2020      mudstone    
+00013d80: 2020 2020 2020 204a 327a 2020 2e2e 2e20         J2z  ... 
+00013d90: 2020 204e 614e 2020 2020 4e61 4e20 2020     NaN    NaN   
+00013da0: 2020 4e61 4e0d 0a20 2020 2031 3620 2020    NaN..    16   
+00013db0: 2020 2020 2048 3530 3220 2020 2020 2020       H502       
+00013dc0: 2020 2020 2020 2020 2020 7369 6c74 7374            siltst
+00013dd0: 6f6e 6520 2020 2020 2020 2020 2020 4e61  one           Na
+00013de0: 4e20 202e 2e2e 2020 3335 2e37 3420 2035  N  ...  35.74  5
+00013df0: 392e 3233 2020 2020 204e 614e 0d0a 2020  9.23     NaN..  
+00013e00: 2020 3137 2020 2020 2020 2020 4835 3032    17        H502
+00013e10: 2020 2020 6669 6e65 2d67 7261 696e 6564      fine-grained
+00013e20: 2073 616e 6473 746f 6e65 2020 2020 2020   sandstone      
+00013e30: 2020 2020 204e 614e 2020 2e2e 2e20 2033       NaN  ...  3
+00013e40: 352e 3734 2020 3539 2e32 3320 2020 2020  5.74  59.23     
+00013e50: 4e61 4e0d 0a20 2020 2031 3820 2020 2020  NaN..    18     
+00013e60: 2020 2048 3530 3220 2020 2020 2020 2020     H502         
+00013e70: 2020 2020 2020 2020 7369 6c74 7374 6f6e          siltston
+00013e80: 6520 2020 2020 2020 2020 2020 4e61 4e20  e           NaN 
+00013e90: 202e 2e2e 2020 3335 2e37 3420 2035 392e   ...  35.74  59.
+00013ea0: 3233 2020 2020 204e 614e 0d0a 2020 2020  23     NaN..    
+00013eb0: 3139 2020 2020 2020 2020 4835 3032 2020  19        H502  
+00013ec0: 2020 6669 6e65 2d67 7261 696e 6564 2073    fine-grained s
+00013ed0: 616e 6473 746f 6e65 2020 2020 2020 2020  andstone        
+00013ee0: 2020 204e 614e 2020 2e2e 2e20 2033 352e     NaN  ...  35.
+00013ef0: 3734 2020 3539 2e32 3320 2020 2020 4e61  74  59.23     Na
+00013f00: 4e0d 0a20 2020 2032 3020 2020 2020 2020  N..    20       
+00013f10: 2048 3530 3220 2020 2020 2020 2020 2020   H502           
+00013f20: 2020 2020 2020 206d 7564 7374 6f6e 6520         mudstone 
+00013f30: 2020 2020 2020 2020 2020 4e61 4e20 202e            NaN  .
+00013f40: 2e2e 2020 3335 2e37 3420 2035 392e 3233  ..  35.74  59.23
+00013f50: 2020 2020 204e 614e 0d0a 2020 2020 3231       NaN..    21
+00013f60: 2020 2020 2020 2020 4835 3032 2020 2020          H502    
+00013f70: 2020 2020 2020 2020 2020 2020 2073 696c               sil
+00013f80: 7473 746f 6e65 2020 2020 2020 2020 2020  tstone          
+00013f90: 204e 614e 2020 2e2e 2e20 2033 352e 3734   NaN  ...  35.74
+00013fa0: 2020 3539 2e32 3320 2020 2020 4e61 4e0d    59.23     NaN.
+00013fb0: 0a20 2020 2032 3220 2020 2020 2020 2048  .    22        H
+00013fc0: 3530 3220 2020 2066 696e 652d 6772 6169  502    fine-grai
+00013fd0: 6e65 6420 7361 6e64 7374 6f6e 6520 2020  ned sandstone   
+00013fe0: 2020 2020 2020 2020 4e61 4e20 202e 2e2e          NaN  ...
+00013ff0: 2020 3539 2e36 3120 2035 392e 3233 2020    59.61  59.23  
+00014000: 2020 204e 614e 0d0a 2020 2020 3233 2020     NaN..    23  
+00014010: 2020 2020 2020 4835 3032 2020 2020 2020        H502      
+00014020: 2020 2020 2020 2020 2020 2073 696c 7473             silts
+00014030: 746f 6e65 2020 2020 2020 2020 2020 204e  tone           N
+00014040: 614e 2020 2e2e 2e20 2035 392e 3631 2020  aN  ...  59.61  
+00014050: 3539 2e32 3320 2020 2020 4e61 4e0d 0a20  59.23     NaN.. 
+00014060: 2020 2032 3420 2020 2020 2020 2048 3530     24        H50
+00014070: 3220 2020 2066 696e 652d 6772 6169 6e65  2    fine-graine
+00014080: 6420 7361 6e64 7374 6f6e 6520 2020 2020  d sandstone     
+00014090: 2020 2020 2020 4e61 4e20 202e 2e2e 2020        NaN  ...  
+000140a0: 3539 2e36 3120 2035 392e 3233 2020 2020  59.61  59.23    
+000140b0: 204e 614e 0d0a 2020 2020 3235 2020 2020   NaN..    25    
+000140c0: 2020 2020 4835 3032 2020 436f 6172 7365      H502  Coarse
+000140d0: 2d67 7261 696e 6564 2073 616e 6473 746f  -grained sandsto
+000140e0: 6e65 2020 2020 2020 2020 2020 204e 614e  ne           NaN
+000140f0: 2020 2e2e 2e20 2035 392e 3631 2020 3539    ...  59.61  59
+00014100: 2e32 3320 2020 2020 4e61 4e0d 0a20 2020  .23     NaN..   
+00014110: 2032 3620 2020 2020 2020 2048 3530 3220   26        H502 
+00014120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014130: 206d 7564 7374 6f6e 6520 2020 2020 2020   mudstone       
+00014140: 2020 2020 4e61 4e20 202e 2e2e 2020 3832      NaN  ...  82
+00014150: 2e33 3320 2035 392e 3233 2020 2020 204e  .33  59.23     N
+00014160: 614e 0d0a 2020 2020 3237 2020 2020 2020  aN..    27      
+00014170: 2020 4835 3032 2020 2020 6669 6e65 2d67    H502    fine-g
+00014180: 7261 696e 6564 2073 616e 6473 746f 6e65  rained sandstone
+00014190: 2020 2020 2020 2020 2020 204e 614e 2020             NaN  
+000141a0: 2e2e 2e20 2038 322e 3333 2020 3539 2e32  ...  82.33  59.2
+000141b0: 3320 2020 2020 4e61 4e0d 0a20 2020 2032  3     NaN..    2
+000141c0: 3820 2020 2020 2020 2048 3530 3220 2043  8        H502  C
+000141d0: 6f61 7273 652d 6772 6169 6e65 6420 7361  oarse-grained sa
+000141e0: 6e64 7374 6f6e 6520 2020 2020 2020 2020  ndstone         
+000141f0: 2020 4a32 7a20 202e 2e2e 2020 3832 2e33    J2z  ...  82.3
+00014200: 3320 2035 392e 3233 2020 2020 204e 614e  3  59.23     NaN
+00014210: 0d0a 2020 2020 3239 2020 2020 2020 2020  ..    29        
+00014220: 4835 3032 2020 2020 2020 2020 2020 2020  H502            
+00014230: 2020 2020 2020 2020 2020 636f 616c 2020            coal  
+00014240: 284a 3279 2920 2032 636f 616c 2020 2e2e  (J2y)  2coal  ..
+00014250: 2e20 2038 322e 3333 2020 3539 2e32 3320  .  82.33  59.23 
+00014260: 2020 2020 4e61 4e0d 0a20 2020 2030 2020      NaN..    0  
+00014270: 2020 2020 2020 2048 3530 3220 2020 2020         H502     
+00014280: 2020 2020 2020 2020 2020 2020 7369 6c74              silt
+00014290: 7374 6f6e 6520 2020 2020 2020 2020 2020  stone           
+000142a0: 4e61 4e20 202e 2e2e 2020 2020 4e61 4e20  NaN  ...    NaN 
+000142b0: 2020 204e 614e 2020 2020 204e 614e 0d0a     NaN     NaN..
+000142c0: 0d0a 5b31 3620 726f 7773 2078 2032 3320  ..[16 rows x 23 
+000142d0: 636f 6c75 6d6e 735d 0d0a 3e3e 3e20 2320  columns]..>>> # 
+000142e0: 7370 6563 6966 7920 7468 6520 636f 6c75  specify the colu
+000142f0: 6d6e 206e 616d 6520 616e 6420 6b6e 616d  mn name and knam
+00014300: 6520 7769 7468 6f75 7420 7365 6374 696f  e without sectio
+00014310: 6e20 696e 6465 7865 7320 0d0a 3e3e 3e20  n indexes ..>>> 
+00014320: 6466 6e65 773d 2072 6564 7563 655f 7361  dfnew= reduce_sa
+00014330: 6d70 6c65 7320 280d 0a20 2020 2064 6174  mples (..    dat
+00014340: 612e 636f 7079 2829 2c20 736e 616d 653d  a.copy(), sname=
+00014350: 2773 7472 6174 615f 6e61 6d65 272c 2064  'strata_name', d
+00014360: 6174 612c 207a 6e61 6d65 3d27 6465 7074  ata, zname='dept
+00014370: 6827 2c20 6b6e 616d 653d 276b 272c 200d  h', kname='k', .
+00014380: 0a20 2020 2069 676e 6f72 655f 696e 6465  .    ignore_inde
+00014390: 783d 2054 7275 6520 295b 305d 0d0a 2e2e  x= True )[0]....
+000143a0: 2e20 6466 6e65 775b 305d 2e69 6e64 6578  . dfnew[0].index
+000143b0: 2023 2069 6e64 6578 2069 7320 7265 7365   # index is rese
+000143c0: 7420 0d0a 2e2e 2e20 5261 6e67 6549 6e64  t ..... RangeInd
+000143d0: 6578 2873 7461 7274 3d30 2c20 7374 6f70  ex(start=0, stop
+000143e0: 3d31 362c 2073 7465 703d 3129 0d0a 0d0a  =16, step=1)....
+000143f0: 2222 222e 666f 726d 6174 280d 0a20 2020  """.format(..   
+00014400: 2070 6172 616d 733d 5f70 6172 616d 5f64   params=_param_d
+00014410: 6f63 732c 0d0a 2020 2020 290d 0a20 2020  ocs,..    )..   
+00014420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014430: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+00014440: 0a64 6566 205f 636f 6e63 6174 5f63 6f6d  .def _concat_com
+00014450: 7072 6573 7365 645f 7873 5f78 7220 280d  pressed_xs_xr (.
+00014460: 0a20 2020 2020 2020 2078 735f 696e 6465  .        xs_inde
+00014470: 7865 733a 4c69 7374 5b69 6e74 5d2c 200d  xes:List[int], .
+00014480: 0a20 2020 2020 2020 2078 725f 696e 6465  .        xr_inde
+00014490: 7865 733a 204c 6973 745b 696e 745d 2c20  xes: List[int], 
+000144a0: 0d0a 2020 2020 2020 2020 636f 6d70 7265  ..        compre
+000144b0: 7373 6564 5f66 7261 6d65 733a 4c69 7374  ssed_frames:List
+000144c0: 5b44 6174 6146 7261 6d65 5d2c 200d 0a20  [DataFrame], .. 
+000144d0: 2020 2020 2020 2078 723a 4461 7461 4672         xr:DataFr
+000144e0: 616d 6520 2029 3a0d 0a20 2020 2022 2222  ame  ):..    """
+000144f0: 2043 6f6e 6361 7420 7468 6520 636f 6d70   Concat the comp
+00014500: 7265 7373 6564 2066 7261 6d65 7320 6672  ressed frames fr
+00014510: 6f6d 2060 7873 6020 7769 7468 2074 6865  om `xs` with the
+00014520: 2076 616c 6964 2066 7261 6d65 732e 0d0a   valid frames...
+00014530: 2020 2020 0d0a 2020 2020 5573 6520 7468      ..    Use th
+00014540: 6520 696e 6465 7820 6f66 2064 6966 6665  e index of diffe
+00014550: 7265 6e74 2066 7261 6d65 7320 746f 206d  rent frames to m
+00014560: 6572 6765 2074 6865 2066 7261 6d65 2062  erge the frame b
+00014570: 7920 7265 7370 6563 7469 6e67 2074 6865  y respecting the
+00014580: 200d 0a20 2020 2064 6570 7468 2070 6f73   ..    depth pos
+00014590: 6974 696f 6e73 2e20 466f 7220 696e 7374  itions. For inst
+000145a0: 616e 6365 2c20 6966 2074 6865 2076 616c  ance, if the val
+000145b0: 6964 2073 6563 696f 6e20 6f66 2061 7175  id secion of aqu
+000145c0: 6966 6572 2069 7320 6672 616d 6564 200d  ifer is framed .
+000145d0: 0a20 2020 2062 6574 7765 656e 2074 776f  .    between two
+000145e0: 2069 6e76 616c 6964 2073 6563 7469 6f6e   invalid section
+000145f0: 7320 636f 6d70 6f73 6564 206f 6620 6d69  s composed of mi
+00014600: 7373 696e 6720 276b 2720 7661 6c75 6573  ssing 'k' values
+00014610: 2c20 7468 6520 626f 7468 0d0a 2020 2020  , the both..    
+00014620: 7365 6374 696f 6e73 2061 7265 2073 6872  sections are shr
+00014630: 616e 6b20 616e 6420 7468 6569 7220 636f  ank and their co
+00014640: 6d70 7265 7373 6564 2066 7261 6d65 7320  mpressed frames 
+00014650: 6172 6520 616c 736f 2066 7261 6d65 6420  are also framed 
+00014660: 7468 6520 0d0a 2020 2020 7365 6374 696f  the ..    sectio
+00014670: 6e20 6f66 2076 616c 6964 2064 6174 612e  n of valid data.
+00014680: 2054 6869 7320 6b65 6570 2074 6865 2070   This keep the p
+00014690: 6f73 6974 696f 6e20 6f66 2074 6865 200d  osition of the .
+000146a0: 0a20 2020 2061 7175 6966 6572 2069 6e74  .    aquifer int
+000146b0: 6163 742e 2054 6869 7320 6973 2075 7365  act. This is use
+000146c0: 6675 6c6c 2066 6f72 2070 7265 6469 6374  full for predict
+000146d0: 696f 6e20 7075 7270 6f73 652e 200d 0a20  ion purpose. .. 
+000146e0: 2020 200d 0a20 2020 203a 7061 7261 6d20     ..    :param 
+000146f0: 7873 5f69 6e64 6578 6573 3a20 6c69 7374  xs_indexes: list
+00014700: 206f 6620 696e 7420 0d0a 2020 2020 2020   of int ..      
+00014710: 2020 696e 6469 6365 7320 6f66 2069 6e76    indices of inv
+00014720: 616c 6964 2073 6563 7469 6f6e 7320 0d0a  alid sections ..
+00014730: 2020 2020 3a70 6172 616d 2078 725f 696e      :param xr_in
+00014740: 6465 7865 733a 206c 6973 7420 6f66 2069  dexes: list of i
+00014750: 6e74 202c 0d0a 2020 2020 2020 2020 696e  nt ,..        in
+00014760: 6469 6365 7320 6f66 2076 616c 6964 2073  dices of valid s
+00014770: 6563 7469 6f6e 206f 6620 6171 7569 6665  ection of aquife
+00014780: 722e 2076 616c 6964 2064 6174 6120 0d0a  r. valid data ..
+00014790: 2020 2020 3a70 6172 616d 2063 6f6d 7072      :param compr
+000147a0: 6573 7365 645f 6672 616d 6573 3a20 7061  essed_frames: pa
+000147b0: 6e64 6173 2064 6174 6166 7261 6d65 200d  ndas dataframe .
+000147c0: 0a20 2020 2020 2020 2074 6865 2063 6f6d  .        the com
+000147d0: 7072 6573 7365 6420 6672 616d 6573 2066  pressed frames f
+000147e0: 726f 6d20 6078 7360 2e20 0d0a 2020 2020  rom `xs`. ..    
+000147f0: 3a70 6172 616d 2078 723a 2064 6174 6166  :param xr: dataf
+00014800: 7261 6d65 200d 0a20 2020 2020 2020 2076  rame ..        v
+00014810: 616c 6964 2064 6174 6120 2820 636f 6e74  alid data ( cont
+00014820: 6169 6e20 7468 6520 6171 7569 6665 7220  ain the aquifer 
+00014830: 7365 6374 696f 6e73 2029 0d0a 2020 2020  sections )..    
+00014840: 2222 220d 0a20 2020 2070 6f73 203d 205b  """..    pos = [
+00014850: 206e 702e 6172 7261 7928 6b29 2e6d 6561   np.array(k).mea
+00014860: 6e28 2920 666f 7220 6b20 696e 2078 735f  n() for k in xs_
+00014870: 696e 6465 7865 7320 5d0d 0a20 2020 2064  indexes ]..    d
+00014880: 6963 7320 3d20 6469 6374 2028 207a 6970  ics = dict ( zip
+00014890: 2028 2070 6f73 202c 2063 6f6d 7072 6573   ( pos , compres
+000148a0: 7365 645f 6672 616d 6573 2929 0d0a 2020  sed_frames))..  
+000148b0: 2020 0d0a 2020 2020 6469 6373 205b 6e70    ..    dics [np
+000148c0: 2e61 7272 6179 2878 725f 696e 6465 7865  .array(xr_indexe
+000148d0: 7329 2e6d 6561 6e28 295d 3d20 7872 200d  s).mean()]= xr .
+000148e0: 0a20 2020 2023 2073 6f72 7465 6420 7374  .    # sorted st
+000148f0: 7261 7461 2069 6e20 6173 6365 6e64 696e  rata in ascendin
+00014900: 6720 6f63 6375 7265 6e63 6520 0d0a 2020  g occurence ..  
+00014910: 2020 736d 203d 2064 6963 7420 280d 0a20    sm = dict (.. 
+00014920: 2020 2020 2020 2073 6f72 7465 6420 2864         sorted (d
+00014930: 6963 732e 6974 656d 7320 2829 202c 206b  ics.items () , k
+00014940: 6579 3d20 6c61 6d62 6461 2078 3a78 5b30  ey= lambda x:x[0
+00014950: 5d29 0d0a 2020 2020 2020 2020 290d 0a20  ])..        ).. 
+00014960: 2020 2063 3d20 6c69 7374 2873 6d2e 7661     c= list(sm.va
+00014970: 6c75 6573 2028 2929 0d0a 2020 2020 7265  lues ())..    re
+00014980: 7475 726e 2020 7064 2e63 6f6e 6361 7420  turn  pd.concat 
+00014990: 2863 2029 0d0a 0d0a 2020 2020 0d0a 6465  (c )....    ..de
+000149a0: 6620 6973 5f76 616c 6964 5f64 6570 7468  f is_valid_depth
+000149b0: 2028 7a2c 202f 2c20 7a6e 616d 6520 3d4e   (z, /, zname =N
+000149c0: 6f6e 6520 2c20 7265 7475 726e 5f7a 203d  one , return_z =
+000149d0: 2046 616c 7365 293a 200d 0a20 2020 2022   False): ..    "
+000149e0: 2222 2041 7373 6572 7420 7768 6574 6865  "" Assert whethe
+000149f0: 7220 6465 7074 6820 6973 2076 616c 6964  r depth is valid
+00014a00: 2069 6e20 6461 7461 6672 616d 6520 6f66   in dataframe of
+00014a10: 2074 776f 2d64 696d 656e 7369 6f6e 616c   two-dimensional
+00014a20: 200d 0a20 2020 2061 7272 6179 2070 6173   ..    array pas
+00014a30: 7365 6420 746f 2060 7a60 2061 7267 756d  sed to `z` argum
+00014a40: 656e 742e 200d 0a20 2020 200d 0a20 2020  ent. ..    ..   
+00014a50: 2050 6172 616d 6574 6572 7320 0d0a 2020   Parameters ..  
+00014a60: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a    ------------..
+00014a70: 2020 2020 7a3a 206e 6461 7272 6179 2c20      z: ndarray, 
+00014a80: 7061 6e64 6173 2073 6572 6965 7320 6f72  pandas series or
+00014a90: 2064 6174 6166 7261 6d65 200d 0a20 2020   dataframe ..   
+00014aa0: 2020 2020 2049 6620 4461 7461 6672 616d       If Datafram
+00014ab0: 6520 6973 2067 6976 656e 2c20 277a 6e61  e is given, 'zna
+00014ac0: 6d65 2720 6d75 7374 2062 6520 7375 7070  me' must be supp
+00014ad0: 6c69 6564 2074 6f20 6665 7463 6820 6f72  lied to fetch or
+00014ae0: 2061 7373 6572 7420 0d0a 2020 2020 2020   assert ..      
+00014af0: 2020 7468 6520 6465 7074 6820 6578 6973    the depth exis
+00014b00: 7465 6e63 6520 6f66 2074 6865 2064 6570  tence of the dep
+00014b10: 7468 2069 6e20 607a 602e 200d 0a20 2020  th in `z`. ..   
+00014b20: 207a 6e61 6d65 3a20 7374 722c 696e 7420   zname: str,int 
+00014b30: 2c20 0d0a 2020 2020 2020 2020 7468 6520  , ..        the 
+00014b40: 6e61 6d65 206f 6620 6465 7074 6820 636f  name of depth co
+00014b50: 6c75 6d6e 2e20 276e 616d 6527 206e 6565  lumn. 'name' nee
+00014b60: 6473 2074 6f20 6265 2073 7570 706c 6965  ds to be supplie
+00014b70: 6420 7768 656e 2060 7a60 2069 7320 0d0a  d when `z` is ..
+00014b80: 2020 2020 2020 2020 6769 7665 6e20 7768          given wh
+00014b90: 6572 6561 7320 696e 6465 7820 6973 206e  ereas index is n
+00014ba0: 6565 6465 6420 7768 656e 2060 7a60 2069  eeded when `z` i
+00014bb0: 7320 616e 206e 6461 7272 6179 2077 6974  s an ndarray wit
+00014bc0: 6820 7477 6f20 0d0a 2020 2020 2020 2020  h two ..        
+00014bd0: 6469 6d65 6e73 696f 6e61 6c2e 200d 0a20  dimensional. .. 
+00014be0: 2020 2020 2020 200d 0a20 2020 2072 6574         ..    ret
+00014bf0: 7572 6e5f 585f 7a3a 2062 6f6f 6c2c 2064  urn_X_z: bool, d
+00014c00: 6566 6175 6c74 203d 4661 6c73 650d 0a20  efault =False.. 
+00014c10: 2020 2020 2020 2072 6574 7572 6e73 207a         returns z
+00014c20: 2073 6572 6965 7320 6f72 2061 7272 6179   series or array
+00014c30: 2020 6966 2073 6574 2074 6f20 6060 5472    if set to ``Tr
+00014c40: 7565 6060 2e20 0d0a 2020 2020 0d0a 2020  ue``. ..    ..  
+00014c50: 2020 5265 7475 726e 7320 0d0a 2020 2020    Returns ..    
+00014c60: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 207a  ---------..    z
+00014c70: 302c 2069 735f 7a3a 2061 7272 6179 202f  0, is_z: array /
+00014c80: 626f 6f6c 2c20 0d0a 2020 2020 2020 2020  bool, ..        
+00014c90: 416e 2061 7272 6179 2d6c 696b 6520 3164  An array-like 1d
+00014ca0: 206f 6620 607a 6020 6f72 2027 5472 7565   of `z` or 'True
+00014cb0: 2f46 616c 7365 2720 7768 6574 6865 7220  /False' whether 
+00014cc0: 7a20 6578 6973 7473 206f 7220 6e6f 742e  z exists or not.
+00014cd0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00014ce0: 2045 7861 6d70 6c65 200d 0a20 2020 202d   Example ..    -
+00014cf0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e  -------..    >>>
+00014d00: 2066 726f 6d20 7761 7465 782e 6461 7461   from watex.data
+00014d10: 7365 7473 2069 6d70 6f72 7420 6c6f 6164  sets import load
+00014d20: 5f68 6c6f 6773 200d 0a20 2020 203e 3e3e  _hlogs ..    >>>
+00014d30: 2066 726f 6d20 7761 7465 782e 7574 696c   from watex.util
+00014d40: 732e 6879 6472 6f75 7469 6c73 2069 6d70  s.hydroutils imp
+00014d50: 6f72 7420 6973 5f76 616c 6964 5f64 6570  ort is_valid_dep
+00014d60: 7468 200d 0a20 2020 203e 3e3e 2064 3d20  th ..    >>> d= 
+00014d70: 6c6f 6164 5f68 6c6f 6773 2028 2920 0d0a  load_hlogs () ..
+00014d80: 2020 2020 3e3e 3e20 583d 2064 2e66 7261      >>> X= d.fra
+00014d90: 6d65 200d 0a20 2020 203e 3e3e 2069 735f  me ..    >>> is_
+00014da0: 7661 6c69 645f 6465 7074 6828 582c 207a  valid_depth(X, z
+00014db0: 6e61 6d65 3d27 6465 7074 6827 2920 2320  name='depth') # 
+00014dc0: 6973 2064 6174 6166 7261 6d65 202c 206e  is dataframe , n
+00014dd0: 6565 6420 746f 2070 6173 7320 277a 6e61  eed to pass 'zna
+00014de0: 6d65 270d 0a20 2020 202e 2e2e 2054 7275  me'..    ... Tru
+00014df0: 650d 0a20 2020 203e 3e3e 2069 735f 7661  e..    >>> is_va
+00014e00: 6c69 645f 6465 7074 6820 2858 2c20 7a6e  lid_depth (X, zn
+00014e10: 616d 6520 3d20 2764 6570 7468 272c 2072  ame = 'depth', r
+00014e20: 6574 7572 6e5f 7a20 3d20 5472 7565 290d  eturn_z = True).
+00014e30: 0a20 2020 202e 2e2e 2030 2020 2020 2020  .    ... 0      
+00014e40: 2020 302e 3030 0d0a 2020 2020 2020 2020    0.00..        
+00014e50: 3120 2020 2020 2020 2032 2e33 300d 0a20  1        2.30.. 
+00014e60: 2020 2020 2020 2032 2020 2020 2020 2020         2        
+00014e70: 382e 3234 0d0a 2020 2020 2020 2020 3320  8.24..        3 
+00014e80: 2020 2020 2020 3232 2e34 360d 0a20 2020        22.46..   
+00014e90: 2020 2020 2034 2020 2020 2020 2034 342e       4       44.
+00014ea0: 3736 0d0a 2020 2020 2020 2020 200d 0a20  76..         .. 
+00014eb0: 2020 2020 2020 2031 3736 2020 2020 3637         176    67
+00014ec0: 342e 3032 0d0a 2020 2020 2020 2020 3137  4.02..        17
+00014ed0: 3720 2020 2036 3830 2e31 380d 0a20 2020  7    680.18..   
+00014ee0: 2020 2020 2031 3738 2020 2020 3638 312e       178    681.
+00014ef0: 3638 0d0a 2020 2020 2020 2020 3137 3920  68..        179 
+00014f00: 2020 2036 3932 2e39 370d 0a20 2020 2020     692.97..     
+00014f10: 2020 2031 3830 2020 2020 3639 332e 3337     180    693.37
+00014f20: 0d0a 2020 2020 2020 2020 4e61 6d65 3a20  ..        Name: 
+00014f30: 6465 7074 685f 746f 702c 204c 656e 6774  depth_top, Lengt
+00014f40: 683a 2031 3831 2c20 6474 7970 653a 2066  h: 181, dtype: f
+00014f50: 6c6f 6174 3634 0d0a 2020 2020 2222 220d  loat64..    """.
+00014f60: 0a20 2020 2069 735f 7a20 3d54 7275 6520  .    is_z =True 
+00014f70: 0d0a 2020 2020 7a20 3d20 5f61 7373 6572  ..    z = _asser
+00014f80: 745f 616c 6c5f 7479 7065 7328 7a2c 206e  t_all_types(z, n
+00014f90: 702e 6e64 6172 7261 7920 2c20 7064 2e53  p.ndarray , pd.S
+00014fa0: 6572 6965 732c 2070 642e 4461 7461 4672  eries, pd.DataFr
+00014fb0: 616d 652c 200d 0a20 2020 2020 2020 2020  ame, ..         
+00014fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014fd0: 206f 626a 6e61 6d65 203d 2744 6570 7468   objname ='Depth
+00014fe0: 2729 200d 0a20 2020 207a 6e61 6d65 203d  ') ..    zname =
+00014ff0: 205f 6173 7365 7274 5f61 6c6c 5f74 7970   _assert_all_typ
+00015000: 6573 287a 6e61 6d65 2c20 7374 722c 206f  es(zname, str, o
+00015010: 626a 6e61 6d65 203d 2227 7a6e 616d 6522  bjname ="'zname"
+00015020: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015040: 2920 6966 207a 6e61 6d65 2069 7320 6e6f  ) if zname is no
+00015050: 7420 4e6f 6e65 2065 6c73 6520 4e6f 6e65  t None else None
+00015060: 2020 0d0a 2020 2020 6966 2068 6173 6174    ..    if hasat
+00015070: 7472 287a 2c20 275f 5f61 7272 6179 5f5f  tr(z, '__array__
+00015080: 2729 2061 6e64 2068 6173 6174 7472 2028  ') and hasattr (
+00015090: 7a2c 2027 6e61 6d65 2729 3a20 0d0a 2020  z, 'name'): ..  
+000150a0: 2020 2020 2020 7a6e 616d 6520 3d20 7a2e        zname = z.
+000150b0: 6e61 6d65 200d 0a20 2020 2020 2020 200d  name ..        .
+000150c0: 0a20 2020 2065 6c69 6620 6861 7361 7474  .    elif hasatt
+000150d0: 7220 287a 202c 2763 6f6c 756d 6e73 2720  r (z ,'columns' 
+000150e0: 293a 200d 0a20 2020 2020 2020 2023 2061  ): ..        # a
+000150f0: 7373 6572 7420 7768 6574 6865 7220 6465  ssert whether de
+00015100: 7074 6820 0d0a 2020 2020 2020 2020 2320  pth ..        # 
+00015110: 6d61 7065 2061 2063 6f70 7920 746f 206e  mape a copy to n
+00015120: 6f74 2063 6f72 7275 7074 2058 2073 696e  ot corrupt X sin
+00015130: 6365 2074 6865 2066 756e 6374 696f 6e20  ce the function 
+00015140: 0d0a 2020 2020 2020 2020 2320 7265 6d6f  ..        # remo
+00015150: 7665 2074 6865 2064 6570 7468 2069 6e20  ve the depth in 
+00015160: 636f 6c75 6d6e 7320 0d0a 2020 2020 2020  columns ..      
+00015170: 2020 7a5f 636f 7079 203d 207a 2e63 6f70    z_copy = z.cop
+00015180: 7928 2920 0d0a 2020 2020 2020 2020 6966  y() ..        if
+00015190: 207a 6e61 6d65 2069 7320 4e6f 6e65 3a20   zname is None: 
+000151a0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+000151b0: 6973 6520 5661 6c75 6545 7272 6f72 2028  ise ValueError (
+000151c0: 2227 7a6e 616d 6527 2028 2044 6570 7468  "'zname' ( Depth
+000151d0: 2063 6f6c 756d 6e20 6e61 6d65 2029 2063   column name ) c
+000151e0: 616e 206e 6f74 2062 6520 4e6f 6e65 220d  an not be None".
+000151f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015200: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00015210: 2077 6865 6e20 6120 6461 7461 6672 616d   when a datafram
+00015220: 6520 6973 2067 6976 656e 2e22 290d 0a20  e is given.").. 
+00015230: 2020 2020 2020 2023 202d 2d3e 2064 6561         # --> dea
+00015240: 6c73 2077 6974 6820 6465 7074 6820 0d0a  ls with depth ..
+00015250: 2020 2020 2020 2020 2320 696e 2074 6865          # in the
+00015260: 2063 6173 6520 6465 7074 6820 6973 2067   case depth is g
+00015270: 6976 656e 2077 6869 6c65 200d 0a20 2020  iven while ..   
+00015280: 2020 2020 2023 2064 6174 6166 7261 6d65       # dataframe
+00015290: 2069 7320 6769 7665 6e2e 200d 0a20 2020   is given. ..   
+000152a0: 2020 2020 2023 2069 6620 7a20 6973 206e       # if z is n
+000152b0: 6f74 204e 6f6e 653a 200d 0a20 2020 2020  ot None: ..     
+000152c0: 2020 2023 2020 2020 207a 6e61 6d65 203d     #     zname =
+000152d0: 4e6f 6e65 2023 2073 6574 204e 6f6e 6520  None # set None 
+000152e0: 0d0a 2020 2020 2020 2020 6966 207a 6e61  ..        if zna
+000152f0: 6d65 2069 7320 6e6f 7420 4e6f 6e65 203a  me is not None :
+00015300: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
+00015310: 2065 7261 7365 6420 7468 6520 6465 7074   erased the dept
+00015320: 6820 616e 6420 6e61 6d65 0d0a 2020 2020  h and name..    
+00015330: 2020 2020 2020 2020 7472 793a 200d 0a20          try: .. 
+00015340: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+00015350: 2c20 7a30 203d 2069 735f 6465 7074 685f  , z0 = is_depth_
+00015360: 696e 280d 0a20 2020 2020 2020 2020 2020  in(..           
+00015370: 2020 2020 207a 5f63 6f70 792c 206e 616d       z_copy, nam
+00015380: 6520 3d20 7a6e 616d 652c 2065 7272 6f72  e = zname, error
+00015390: 203d 2027 7261 6973 6527 2920 0d0a 2020   = 'raise') ..  
+000153a0: 2020 2020 2020 2020 2020 6578 6365 7074            except
+000153b0: 2045 7863 6570 7469 6f6e 2061 7320 6572   Exception as er
+000153c0: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
+000153d0: 2020 2020 6966 2072 6574 7572 6e5f 7a3a      if return_z:
+000153e0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000153f0: 2020 2020 2020 2072 6169 7365 2044 6570         raise Dep
+00015400: 7468 4572 726f 7228 2244 6570 7468 206e  thError("Depth n
+00015410: 616d 6520 277a 6e61 6d65 2720 2220 2b20  ame 'zname' " + 
+00015420: 7374 7228 0d0a 2020 2020 2020 2020 2020  str(..          
+00015430: 2020 2020 2020 2020 2020 2020 2020 6572                er
+00015440: 7229 2e72 6570 6c61 6365 2028 2745 272c  r).replace ('E',
+00015450: 2027 6527 2920 290d 0a20 2020 2020 2020   'e') )..       
+00015460: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+00015470: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00015480: 6c73 653a 2069 735f 7a3d 2046 616c 7365  lse: is_z= False
+00015490: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+000154a0: 2020 2020 0d0a 2020 2020 2020 2020 7a6e      ..        zn
+000154b0: 616d 653d 207a 302e 6e61 6d65 200d 0a20  ame= z0.name .. 
+000154c0: 2020 2065 6c69 6620 6861 7361 7474 7220     elif hasattr 
+000154d0: 287a 2c20 275f 5f61 7272 6179 5f5f 2729  (z, '__array__')
+000154e0: 3a20 0d0a 2020 2020 2020 2020 6966 206e  : ..        if n
+000154f0: 6f74 205f 6973 5f61 7272 6179 6c69 6b65  ot _is_arraylike
+00015500: 5f31 6420 287a 293a 200d 0a20 2020 2020  _1d (z): ..     
+00015510: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00015520: 7565 4572 726f 7220 2822 4d75 6c74 6964  ueError ("Multid
+00015530: 696d 656e 7369 6f6e 616c 2027 6b27 2061  imensional 'k' a
+00015540: 7272 6179 2069 7320 6e6f 7420 616c 6c6f  rray is not allo
+00015550: 7765 6422 0d0a 2020 2020 2020 2020 2020  wed"..          
+00015560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015570: 2020 2020 2220 4578 7065 6374 206f 6e65      " Expect one
+00015580: 2d64 696d 656e 7369 6f6e 616c 2061 7272  -dimensional arr
+00015590: 6179 2e22 290d 0a20 2020 2020 2020 207a  ay.")..        z
+000155a0: 303d 2070 642e 5365 7269 6573 2028 7a2c  0= pd.Series (z,
+000155b0: 206e 616d 6520 3d7a 6e61 6d65 2920 6966   name =zname) if
+000155c0: 207a 6e61 6d65 2069 7320 6e6f 7420 4e6f   zname is not No
+000155d0: 6e65 2065 6c73 6520 7a20 0d0a 0d0a 2020  ne else z ....  
+000155e0: 2020 7265 7475 726e 207a 3020 6966 2072    return z0 if r
+000155f0: 6574 7572 6e5f 7a20 656c 7365 2069 735f  eturn_z else is_
+00015600: 7a20 200d 0a0d 0a64 6566 2067 6574 5f61  z  ....def get_a
+00015610: 7175 6966 6572 5f73 6563 7469 6f6e 2028  quifer_section (
+00015620: 0d0a 2020 2020 2020 2020 6172 725f 6b2c  ..        arr_k,
+00015630: 202f 2c20 7a6e 616d 653d 4e6f 6e65 2c20   /, zname=None, 
+00015640: 6b6e 616d 6520 3d20 4e6f 6e65 2c20 207a  kname = None,  z
+00015650: 3d20 4e6f 6e65 2c20 0d0a 2020 2020 2020  = None, ..      
+00015660: 2020 7265 7475 726e 5f69 6e64 6578 203d    return_index =
+00015670: 2046 616c 7365 2c20 7265 7475 726e 5f73   False, return_s
+00015680: 6563 7469 6f6e 7320 3d20 5472 7565 200d  ections = True .
+00015690: 0a20 2020 2020 2020 2029 203a 200d 0a20  .        ) : .. 
+000156a0: 2020 205f 6173 7365 7274 5f61 6c6c 5f74     _assert_all_t
+000156b0: 7970 6573 2820 6172 725f 6b2c 2070 642e  ypes( arr_k, pd.
+000156c0: 4461 7461 4672 616d 652c 206e 702e 6e64  DataFrame, np.nd
+000156d0: 6172 7261 7929 0d0a 2020 2020 0d0a 2020  array)..    ..  
+000156e0: 2020 6966 207a 2069 7320 6e6f 7420 4e6f    if z is not No
+000156f0: 6e65 3a20 0d0a 2020 2020 2020 2020 6d73  ne: ..        ms
+00015700: 203d 2028 6622 4465 7074 6820 7b74 7970   = (f"Depth {typ
+00015710: 6528 7a29 2e5f 5f6e 616d 655f 5f7d 2073  e(z).__name__} s
+00015720: 697a 6520 6d75 7374 2062 6520 636f 6e73  ize must be cons
+00015730: 6973 7465 6e74 2077 6974 6822 0d0a 2020  istent with"..  
+00015740: 2020 2020 2020 2020 2020 2066 2220 7b74             f" {t
+00015750: 7970 6520 2861 7272 5f6b 292e 5f5f 6e61  ype (arr_k).__na
+00015760: 6d65 5f5f 2172 7d3b 676f 7420 7b6c 656e  me__!r};got {len
+00015770: 287a 297d 2061 6e64 207b 6c65 6e28 6172  (z)} and {len(ar
+00015780: 725f 6b29 7d2e 220d 0a20 2020 2020 2020  r_k)}."..       
+00015790: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+000157a0: 205f 6173 7365 7274 5f61 6c6c 5f74 7970   _assert_all_typ
+000157b0: 6573 287a 2c20 6e70 2e6e 6461 7272 6179  es(z, np.ndarray
+000157c0: 2c20 7064 2e53 6572 6965 7329 0d0a 2020  , pd.Series)..  
+000157d0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000157e0: 6966 206e 6f74 205f 6973 5f61 7272 6179  if not _is_array
+000157f0: 6c69 6b65 5f31 6428 7a29 3a20 0d0a 2020  like_1d(z): ..  
+00015800: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00015810: 4465 7074 6845 7272 6f72 2028 2244 6570  DepthError ("Dep
+00015820: 7468 2073 7570 706f 7274 7320 6f6e 6c79  th supports only
+00015830: 206f 6e65 2d64 696d 656e 7369 6f6e 616c   one-dimensional
+00015840: 2061 7272 6179 2c22 0d0a 2020 2020 2020   array,"..      
+00015850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015860: 2020 2020 2020 2066 2220 6e6f 7420 7b74         f" not {t
+00015870: 7970 6528 7a29 2e5f 5f6e 616d 655f 5f21  ype(z).__name__!
+00015880: 727d 2e22 290d 0a20 2020 2020 2020 2020  r}.")..         
+00015890: 2020 2023 2063 6865 636b 2064 6570 7468     # check depth
+000158a0: 207a 2061 7272 6179 200d 0a20 2020 2020   z array ..     
+000158b0: 2020 207a 3d20 6368 6563 6b5f 7920 280d     z= check_y (.
+000158c0: 0a20 2020 2020 2020 2020 2020 207a 2c20  .            z, 
+000158d0: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
+000158e0: 7075 745f 6e61 6d65 3d20 2241 7272 6179  put_name= "Array
+000158f0: 206f 6620 6465 7074 6820 277a 2722 2c20   of depth 'z'", 
+00015900: 0d0a 2020 2020 2020 2020 2020 2020 746f  ..            to
+00015910: 5f66 7261 6d65 203d 5472 7565 2c20 0d0a  _frame =True, ..
+00015920: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00015930: 2020 2020 2020 2069 6620 6e6f 7420 5f63         if not _c
+00015940: 6865 636b 5f63 6f6e 7369 7374 656e 6379  heck_consistency
+00015950: 5f73 697a 6528 7a2c 2061 7272 5f6b 2c20  _size(z, arr_k, 
+00015960: 6572 726f 7220 3d27 6967 6e6f 7265 2729  error ='ignore')
+00015970: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00015980: 7261 6973 6520 4465 7074 6845 7272 6f72  raise DepthError
+00015990: 2028 6d73 290d 0a20 2020 2020 2020 2020   (ms)..         
+000159a0: 2020 2020 2020 200d 0a20 2020 2069 6620         ..    if 
+000159b0: 287a 2069 7320 4e6f 6e65 2061 6e64 207a  (z is None and z
+000159c0: 6e61 6d65 2069 7320 6e6f 7420 4e6f 6e65  name is not None
+000159d0: 2029 3a20 0d0a 2020 2020 2020 2020 7a20   ): ..        z 
+000159e0: 3d20 6973 5f76 616c 6964 5f64 6570 7468  = is_valid_depth
+000159f0: 2028 2061 7272 5f6b 202c 207a 6e61 6d65   ( arr_k , zname
+00015a00: 203d 207a 6e61 6d65 202c 2072 6574 7572   = zname , retur
+00015a10: 6e5f 7a20 3d20 5472 7565 2029 0d0a 2020  n_z = True )..  
+00015a20: 2020 2020 2020 7a6e 616d 6520 3d20 7a2e        zname = z.
+00015a30: 6e61 6d65 200d 0a20 2020 2020 2020 200d  name ..        .
+00015a40: 0a20 2020 2065 6c69 6620 2820 7a20 6973  .    elif ( z is
+00015a50: 204e 6f6e 6520 616e 6420 7a6e 616d 6520   None and zname 
+00015a60: 6973 204e 6f6e 6520 293a 200d 0a20 2020  is None ): ..   
+00015a70: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00015a80: 7065 4572 726f 7220 2822 4578 7065 6374  peError ("Expect
+00015a90: 7320 616e 2061 7272 6179 206f 6620 6465  s an array of de
+00015aa0: 7074 6820 277a 2720 6f72 2020 6465 7074  pth 'z' or  dept
+00015ab0: 6820 636f 6c75 6d6e 220d 0a20 2020 2020  h column"..     
+00015ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ad0: 2020 2020 2020 2022 206e 616d 6520 277a         " name 'z
+00015ae0: 6e61 6d65 2720 696e 2074 6865 2064 6174  name' in the dat
+00015af0: 6166 7261 6d65 2e22 2920 2020 200d 0a20  aframe.")    .. 
+00015b00: 2020 2020 2020 200d 0a20 2020 2069 6620         ..    if 
+00015b10: 6861 7361 7474 7220 2861 7272 5f6b 202c  hasattr (arr_k ,
+00015b20: 2763 6f6c 756d 6e73 2720 293a 0d0a 2020  'columns' ):..  
+00015b30: 2020 2020 2020 2320 6465 616c 2077 6974        # deal wit
+00015b40: 6820 6172 725f 6b20 0d0a 2020 2020 2020  h arr_k ..      
+00015b50: 2020 6966 206b 6e61 6d65 2069 7320 4e6f    if kname is No
+00015b60: 6e65 3a20 0d0a 2020 2020 2020 2020 2020  ne: ..          
+00015b70: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00015b80: 6f72 2028 2227 6b6e 616d 6527 2028 2050  or ("'kname' ( P
+00015b90: 6572 6d65 6162 696c 6974 7920 636f 6566  ermeability coef
+00015ba0: 6669 6369 656e 7420 2920 636f 6c75 6d6e  ficient ) column
+00015bb0: 206e 616d 6522 0d0a 2020 2020 2020 2020   name"..        
+00015bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015bd0: 2020 2020 2020 2220 6361 6e6e 6f74 2062        " cannot b
+00015be0: 6520 4e6f 6e65 2077 6865 6e20 6120 6461  e None when a da
+00015bf0: 7461 6672 616d 6520 6973 2067 6976 656e  taframe is given
+00015c00: 2e22 2920 0d0a 2020 2020 2020 2020 656c  .") ..        el
+00015c10: 7365 3a20 0d0a 2020 2020 2020 2020 2020  se: ..          
+00015c20: 2020 5f61 7373 6572 745f 616c 6c5f 7479    _assert_all_ty
+00015c30: 7065 7328 6b6e 616d 652c 2073 7472 202c  pes(kname, str ,
+00015c40: 2069 6e74 202c 2066 6c6f 6174 2c20 206f   int , float,  o
+00015c50: 626a 6e61 6d65 3d22 276b 6e61 6d65 2722  bjname="'kname'"
+00015c60: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
+00015c70: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+00015c80: 6e73 7461 6e63 6520 286b 6e61 6d65 202c  nstance (kname ,
+00015c90: 2028 696e 742c 2066 6c6f 6174 2929 3a20   (int, float)): 
+00015ca0: 0d0a 2020 2020 2020 2020 2020 2020 6b6e  ..            kn
+00015cb0: 616d 6520 3d20 696e 7420 286b 6e61 6d65  ame = int (kname
+00015cc0: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
+00015cd0: 6966 206b 6e61 6d65 203e 206c 656e 2861  if kname > len(a
+00015ce0: 7272 5f6b 2e63 6f6c 756d 6e73 293a 200d  rr_k.columns): .
+00015cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015d00: 2072 6169 7365 2049 6e64 6578 4572 726f   raise IndexErro
+00015d10: 7220 2866 2227 6b6e 616d 6527 2061 7420  r (f"'kname' at 
+00015d20: 696e 6465 7820 7b6b 6e61 6d65 7d20 6973  index {kname} is
+00015d30: 206f 7574 206f 6620 7468 6520 220d 0a20   out of the ".. 
+00015d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d60: 2066 2264 6174 6166 7261 6d65 2063 6f6c   f"dataframe col
+00015d70: 756d 6e20 7369 7a65 3d7b 6c65 6e28 6172  umn size={len(ar
+00015d80: 725f 6b2e 636f 6c75 6d6e 7329 7d22 290d  r_k.columns)}").
+00015d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015da0: 200d 0a20 2020 2020 2020 2020 2020 206b   ..            k
+00015db0: 6e61 6d65 203d 2061 7272 5f6b 2e63 6f6c  name = arr_k.col
+00015dc0: 756d 6e73 5b6b 6e61 6d65 5d0d 0a20 2020  umns[kname]..   
+00015dd0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00015de0: 2020 2069 6620 6b6e 616d 6520 6e6f 7420     if kname not 
+00015df0: 696e 2061 7272 5f6b 2e63 6f6c 756d 6e73  in arr_k.columns
+00015e00: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+00015e10: 6169 7365 2056 616c 7565 4572 726f 7220  aise ValueError 
+00015e20: 2866 2227 6b6e 616d 6527 207b 6b6e 616d  (f"'kname' {knam
+00015e30: 6521 727d 206e 6f74 2066 6f75 6e64 2069  e!r} not found i
+00015e40: 6e20 6461 7461 6672 616d 652e 2229 0d0a  n dataframe.")..
+00015e50: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00015e60: 2020 6172 725f 6b20 3d20 6172 725f 6b5b    arr_k = arr_k[
+00015e70: 6b6e 616d 655d 200d 0a20 2020 2020 2020  kname] ..       
+00015e80: 2061 7272 5f6b 3d20 6172 725f 6b2e 7661   arr_k= arr_k.va
+00015e90: 6c75 6573 200d 0a20 2020 2020 2020 200d  lues ..        .
+00015ea0: 0a20 2020 2065 6c69 6620 6861 7361 7474  .    elif hasatt
+00015eb0: 7220 2861 7272 5f6b 2c20 275f 5f61 7272  r (arr_k, '__arr
+00015ec0: 6179 5f5f 2729 3a20 0d0a 2020 2020 2020  ay__'): ..      
+00015ed0: 2020 6966 206e 6f74 205f 6973 5f61 7272    if not _is_arr
+00015ee0: 6179 6c69 6b65 5f31 6420 2861 7272 5f6b  aylike_1d (arr_k
+00015ef0: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
+00015f00: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00015f10: 7220 2822 4d75 6c74 6964 696d 656e 7369  r ("Multidimensi
+00015f20: 6f6e 616c 2027 6b27 2061 7272 6179 2069  onal 'k' array i
+00015f30: 7320 6e6f 7420 616c 6c6f 7765 6422 0d0a  s not allowed"..
+00015f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f50: 2020 2020 2020 2020 2020 2020 2020 2220                " 
+00015f60: 4578 7065 6374 206f 6e65 2d64 696d 656e  Expect one-dimen
+00015f70: 7369 6f6e 616c 2061 7272 6179 2e22 290d  sional array.").
+00015f80: 0a0d 0a20 2020 2023 2066 6f72 2063 6f6e  ...    # for con
+00015f90: 7369 7374 656e 6379 2c20 7365 7420 616c  sistency, set al
+00015fa0: 6c20 746f 2031 6420 6172 7261 7920 0d0a  l to 1d array ..
+00015fb0: 2020 2020 7a20 3d20 7265 7368 6170 6520      z = reshape 
+00015fc0: 287a 2920 3b20 6172 725f 6b20 3d20 7265  (z) ; arr_k = re
+00015fd0: 7368 6170 6520 2861 7272 5f6b 290d 0a0d  shape (arr_k)...
+00015fe0: 0a20 2020 2069 6e64 6578 6573 2c20 203d  .    indexes,  =
+00015ff0: 206e 702e 7768 6572 6520 287e 6e70 2e69   np.where (~np.i
+00016000: 736e 616e 2028 6172 725f 6b29 2920 0d0a  snan (arr_k)) ..
+00016010: 2020 2020 6966 2068 6173 6174 7472 2028      if hasattr (
+00016020: 696e 6465 7865 732c 2027 5f5f 6c65 6e5f  indexes, '__len_
+00016030: 5f27 293a 200d 0a20 2020 2020 2020 2023  _'): ..        #
+00016040: 202b 3120 666f 7220 5079 7468 6f6e 2069   +1 for Python i
+00016050: 6e64 6578 696e 670d 0a20 2020 2020 2020  ndexing..       
+00016060: 2069 6e64 6578 6573 203d 5b20 696e 6465   indexes =[ inde
+00016070: 7865 7320 5b30 205d 202c 2069 6e64 6578  xes [0 ] , index
+00016080: 6573 205b 2d31 5d5d 200d 0a20 2020 2020  es [-1]] ..     
+00016090: 2020 200d 0a20 2020 2073 6563 7469 6f6e     ..    section
+000160a0: 7320 3d20 7a5b 696e 6465 7865 7320 5d0d  s = z[indexes ].
+000160b0: 0a20 2020 200d 0a20 2020 2072 6574 7572  .    ..    retur
+000160c0: 6e20 2820 5b2a 2069 6e64 6578 6573 205d  n ( [* indexes ]
+000160d0: 2c20 5b2a 2073 6563 7469 6f6e 7320 5d29  , [* sections ])
+000160e0: 2020 2069 6620 2820 0d0a 2020 2020 2020     if ( ..      
+000160f0: 2020 7265 7475 726e 5f69 6e64 6578 2061    return_index a
+00016100: 6e64 2072 6574 7572 6e5f 7365 6374 696f  nd return_sectio
+00016110: 6e73 2029 2065 6c73 6520 2028 200d 0a20  ns ) else  ( .. 
+00016120: 2020 2020 2020 2020 2020 205b 2a69 6e64             [*ind
+00016130: 6578 6573 205d 2069 6620 7265 7475 726e  exes ] if return
+00016140: 5f69 6e64 6578 2065 6c73 6520 205b 2a73  _index else  [*s
+00016150: 6563 7469 6f6e 735d 290d 0a0d 0a67 6574  ections])....get
+00016160: 5f61 7175 6966 6572 5f73 6563 7469 6f6e  _aquifer_section
+00016170: 2e5f 5f64 6f63 5f5f 3d22 2222 5c0d 0a44  .__doc__="""\..D
+00016180: 6574 6563 7420 6120 7369 6e67 6c65 2061  etect a single a
+00016190: 7175 6966 6572 2073 6563 7469 6f6e 2028  quifer section (
+000161a0: 7570 7065 7220 616e 6420 6c6f 7765 7229  upper and lower)
+000161b0: 2069 6e20 6465 7074 682e 2020 0d0a 0d0a   in depth.  ....
+000161c0: 5468 6973 2069 7320 7573 6566 756c 2074  This is useful t
+000161d0: 7269 7020 746f 2063 6f6d 7075 7465 2074  rip to compute t
+000161e0: 6865 2074 6869 636b 6e65 7373 206f 6620  he thickness of 
+000161f0: 7468 6520 6171 7569 6665 722e 0d0a 0d0a  the aquifer.....
+00016200: 5061 7261 6d65 7465 7273 200d 0a2d 2d2d  Parameters ..---
+00016210: 2d2d 2d2d 2d2d 2d2d 0d0a 6172 725f 6b3a  --------..arr_k:
+00016220: 206e 6461 7272 6179 206f 7220 6461 7461   ndarray or data
+00016230: 6672 616d 6520 0d0a 2020 2020 4461 7461  frame ..    Data
+00016240: 2074 6861 7420 636f 6e74 6169 6e73 206d   that contains m
+00016250: 6169 6e6c 7920 7468 6520 6171 7569 6665  ainly the aquife
+00016260: 7220 7661 6c75 6573 2e20 4974 2063 616e  r values. It can
+00016270: 2061 6c73 6f20 636f 6e74 6169 6e73 2074   also contains t
+00016280: 6865 200d 0a20 2020 2064 6570 7468 2076  he ..    depth v
+00016290: 616c 7565 732e 2049 6620 7468 6520 6465  alues. If the de
+000162a0: 7074 6820 6973 2069 6e63 6c75 6465 6420  pth is included 
+000162b0: 696e 2074 6865 2060 6172 725f 6b60 2c20  in the `arr_k`, 
+000162c0: 607a 6e61 6d65 6020 6e65 6564 7320 746f  `zname` needs to
+000162d0: 200d 0a20 2020 2062 6520 7375 7070 6c69   ..    be suppli
+000162e0: 6564 2066 6f72 2072 6563 6f76 6572 696e  ed for recoverin
+000162f0: 6720 616e 6420 6465 7074 682e 200d 0a20  g and depth. .. 
+00016300: 2020 200d 0a7b 7061 7261 6d73 2e63 6f72     ..{params.cor
+00016310: 652e 7a6e 616d 657d 0d0a 7b70 6172 616d  e.zname}..{param
+00016320: 732e 636f 7265 2e6b 6e61 6d65 7d0d 0a7b  s.core.kname}..{
+00016330: 7061 7261 6d73 2e63 6f72 652e 7a7d 0d0a  params.core.z}..
+00016340: 0d0a 7265 7475 726e 5f69 6e64 6578 3a20  ..return_index: 
+00016350: 626f 6f6c 2c20 6465 6661 756c 7420 3d46  bool, default =F
+00016360: 616c 7365 202c 200d 0a20 2020 2052 6574  alse , ..    Ret
+00016370: 7572 6e73 2074 6865 2070 6f73 6974 696f  urns the positio
+00016380: 6e73 2028 696e 6465 7865 7329 206f 6620  ns (indexes) of 
+00016390: 7468 6520 7570 7065 7220 616e 6420 6c6f  the upper and lo
+000163a0: 7765 7220 7365 6374 696f 6e73 206f 6620  wer sections of 
+000163b0: 7468 650d 0a20 2020 2020 6171 7569 6665  the..     aquife
+000163c0: 7220 666f 756e 6420 696e 2074 6865 2064  r found in the d
+000163d0: 6174 6166 7261 6d65 2060 6172 725f 6b60  ataframe `arr_k`
+000163e0: 2e20 0d0a 7265 7475 726e 5f73 6563 7469  . ..return_secti
+000163f0: 6f6e 733a 2062 6f6f 6c2c 2064 6566 6175  ons: bool, defau
+00016400: 6c74 3d54 7275 652c 200d 0a20 2020 2052  lt=True, ..    R
+00016410: 6574 7572 6e73 2074 6865 2073 6563 7469  eturns the secti
+00016420: 6f6e 7320 2875 7070 6572 2061 6e64 206c  ons (upper and l
+00016430: 6f77 6572 2920 6f66 2074 6865 2061 7175  ower) of the aqu
+00016440: 6966 6572 732e 200d 0a0d 0a52 6574 7572  ifers. ....Retur
+00016450: 6e73 200d 0a2d 2d2d 2d2d 2d2d 2d0d 0a75  ns ..--------..u
+00016460: 702c 206c 6f77 203a 6c69 7374 206f 6620  p, low :list of 
+00016470: 7570 7065 7220 616e 6420 6c6f 7765 7220  upper and lower 
+00016480: 7365 6374 696f 6e20 7661 6c75 6573 206f  section values o
+00016490: 6620 6171 7569 6665 722e 0d0a 2020 2020  f aquifer...    
+000164a0: 2d20 2875 7069 782c 206c 6f77 6978 2029  - (upix, lowix )
+000164b0: 3a20 5475 706c 6520 6f66 2069 6e64 6578  : Tuple of index
+000164c0: 6573 206f 6620 6c6f 7765 7220 616e 6420  es of lower and 
+000164d0: 7570 7065 7220 7365 6374 696f 6e73 2020  upper sections  
+000164e0: 0d0a 2020 2020 2d20 2875 702c 206c 6f77  ..    - (up, low
+000164f0: 293a 2054 7570 6c65 206f 6620 6171 7569  ): Tuple of aqui
+00016500: 6665 7220 7365 6374 696f 6e73 2028 7570  fer sections (up
+00016510: 7065 7220 616e 6420 6c6f 7765 7229 2020  per and lower)  
+00016520: 0d0a 2020 2020 2d20 2875 7069 782c 206c  ..    - (upix, l
+00016530: 6f77 6978 292c 2028 7570 2c20 6c6f 7729  owix), (up, low)
+00016540: 203a 2070 6f73 6974 696f 6e73 2061 6e64   : positions and
+00016550: 2073 6563 7469 6f6e 7320 7661 6c75 6573   sections values
+00016560: 206f 6620 6171 7569 6665 7273 200d 0a20   of aquifers .. 
+00016570: 2020 2020 2020 2069 6620 6072 6574 7572         if `retur
+00016580: 6e5f 696e 6465 7860 2061 6e64 2072 6574  n_index` and ret
+00016590: 7572 6e5f 7365 6374 696f 6e73 6020 6172  urn_sections` ar
+000165a0: 6520 6060 5472 7565 6060 2e20 200d 0a0d  e ``True``.  ...
+000165b0: 0a45 7861 6d70 6c65 0d0a 2d2d 2d2d 2d2d  .Example..------
+000165c0: 2d0d 0a3e 3e3e 2066 726f 6d20 7761 7465  -..>>> from wate
+000165d0: 782e 6461 7461 7365 7473 2069 6d70 6f72  x.datasets impor
+000165e0: 7420 6c6f 6164 5f68 6c6f 6773 200d 0a3e  t load_hlogs ..>
+000165f0: 3e3e 2066 726f 6d20 7761 7465 782e 7574  >> from watex.ut
+00016600: 696c 732e 6879 6472 6f75 7469 6c73 2069  ils.hydroutils i
+00016610: 6d70 6f72 7420 6765 745f 6171 7569 6665  mport get_aquife
+00016620: 725f 7365 6374 696f 6e20 0d0a 3e3e 3e20  r_section ..>>> 
+00016630: 6461 7461 203d 206c 6f61 645f 686c 6f67  data = load_hlog
+00016640: 7320 2829 2e66 7261 6d65 2023 2072 6574  s ().frame # ret
+00016650: 7572 6e20 616c 6c20 6461 7461 2069 6e63  urn all data inc
+00016660: 6c75 6469 6e67 2074 6865 2027 6465 7074  luding the 'dept
+00016670: 6827 2076 616c 7565 7320 0d0a 3e3e 3e20  h' values ..>>> 
+00016680: 6765 745f 6171 7569 6665 725f 7365 6374  get_aquifer_sect
+00016690: 696f 6e20 2864 6174 6120 2c20 7a6e 616d  ion (data , znam
+000166a0: 6520 3d27 6465 7074 6827 2c20 6b6e 616d  e ='depth', knam
+000166b0: 6520 3d27 6b27 290d 0a2e 2e2e 205b 3139  e ='k')..... [19
+000166c0: 372e 3132 2c20 3336 392e 3731 5d20 2320  7.12, 369.71] # 
+000166d0: 7365 6374 696f 6e20 7374 6172 7473 2066  section starts f
+000166e0: 726f 6d20 3139 372e 3132 202d 3e20 3336  rom 197.12 -> 36
+000166f0: 392e 3731 206d 200d 0a3e 3e3e 2067 6574  9.71 m ..>>> get
+00016700: 5f61 7175 6966 6572 5f73 6563 7469 6f6e  _aquifer_section
+00016710: 2028 6461 7461 202c 207a 6e61 6d65 203d   (data , zname =
+00016720: 2764 6570 7468 272c 206b 6e61 6d65 203d  'depth', kname =
+00016730: 276b 272c 2072 6574 7572 6e5f 696e 6465  'k', return_inde
+00016740: 783d 5472 7565 2920 0d0a 2e2e 2e20 285b  x=True) ..... ([
+00016750: 3136 2c20 3239 5d2c 205b 3139 372e 3132  16, 29], [197.12
+00016760: 2c20 3336 392e 3731 5d29 2023 2075 7070  , 369.71]) # upp
+00016770: 6572 2061 6e64 206c 6f77 6572 2d3e 2070  er and lower-> p
+00016780: 6f73 6974 696f 6e20 3136 2061 6e64 2032  osition 16 and 2
+00016790: 392e 0d0a 0d0a 2222 222e 666f 726d 6174  9.....""".format
+000167a0: 280d 0a20 2020 2070 6172 616d 733d 5f70  (..    params=_p
+000167b0: 6172 616d 5f64 6f63 732c 0d0a 2020 2020  aram_docs,..    
+000167c0: 290d 0a20 2020 200d 0a64 6566 205f 6b70  )..    ..def _kp
+000167d0: 2028 6b2c 202f 2c20 206b 723d 2028 2e30   (k, /,  kr= (.0
+000167e0: 3120 2c20 2e30 3720 292c 2073 7472 696e  1 , .07 ), strin
+000167f0: 6720 3d20 4661 6c73 6520 2920 3a0d 0a20  g = False ) :.. 
+00016800: 2020 2022 2222 2044 6566 6175 6c74 2070     """ Default p
+00016810: 6572 6d65 6162 696c 6974 7920 276b 2720  ermeability 'k' 
+00016820: 6d61 7070 696e 6720 7573 696e 6720 6469  mapping using di
+00016830: 6374 2074 6f20 7661 6c69 6461 7465 2074  ct to validate t
+00016840: 6865 2063 6f6e 7469 6e75 6520 0d0a 2020  he continue ..  
+00016850: 2020 7661 6c75 6520 276b 2720 0d0a 2020    value 'k' ..  
+00016860: 2020 3a70 6172 616d 206b 3a20 666c 6f61    :param k: floa
+00016870: 742c 200d 0a20 2020 2020 2020 2063 6f6e  t, ..        con
+00016880: 7469 6e75 6520 7661 6c75 6520 6f66 2074  tinue value of t
+00016890: 6865 2070 6572 6d65 6162 696c 6974 7920  he permeability 
+000168a0: 636f 6566 6669 6369 656e 7420 0d0a 2020  coefficient ..  
+000168b0: 2020 3a70 6172 616d 206b 723a 2054 7570    :param kr: Tup
+000168c0: 6c65 2c20 0d0a 2020 2020 2020 2020 7261  le, ..        ra
+000168d0: 6e67 6520 6f66 2070 6572 6d65 6162 696c  nge of permeabil
+000168e0: 6974 7920 636f 6566 6669 6369 656e 7420  ity coefficient 
+000168f0: 746f 2063 6174 6567 6f72 697a 6520 0d0a  to categorize ..
+00016900: 2020 2020 3a70 6172 616d 2073 7472 696e      :param strin
+00016910: 673a 2062 6f6f 6c2c 2073 7472 200d 0a20  g: bool, str .. 
+00016920: 2020 2020 2020 206c 6162 656c 2074 6f20         label to 
+00016930: 7072 6566 6978 2074 6865 2074 6865 2063  prefix the the c
+00016940: 6174 6567 6f72 6961 6c20 7661 6c75 652e  ategorial value.
+00016950: 200d 0a20 2020 203a 7265 7475 726e 3a20   ..    :return: 
+00016960: 666c 6f61 742f 7374 7220 2d20 6e65 7720  float/str - new 
+00016970: 6361 7465 676f 7269 6361 6c20 7661 6c75  categorical valu
+00016980: 6520 2e20 0d0a 0d0a 2020 2020 2222 220d  e . ....    """.
+00016990: 0a20 2020 2064 203d 207b 303a 206b 203c  .    d = {0: k <
+000169a0: 3d30 202c 2031 3a20 3020 3c20 6b20 3c3d  =0 , 1: 0 < k <=
+000169b0: 206b 725b 305d 2c20 323a 206b 725b 305d   kr[0], 2: kr[0]
+000169c0: 203c 206b 203c 3d6b 725b 315d 2c20 333a   < k <=kr[1], 3:
+000169d0: 206b 203e 206b 725b 315d 200d 0a20 2020   k > kr[1] ..   
+000169e0: 2020 2020 2020 7d0d 0a20 2020 206c 6162        }..    lab
+000169f0: 656c 203d 2027 6b27 2069 6620 7374 7228  el = 'k' if str(
+00016a00: 7374 7269 6e67 292e 6c6f 7765 7228 293d  string).lower()=
+00016a10: 3d27 7472 7565 2720 656c 7365 2073 7472  ='true' else str
+00016a20: 2873 7472 696e 6720 290d 0a20 2020 2066  (string )..    f
+00016a30: 6f72 2076 2c20 7661 6c75 6520 696e 2064  or v, value in d
+00016a40: 2e69 7465 6d73 2028 2920 3a0d 0a20 2020  .items () :..   
+00016a50: 2020 2020 2069 6620 7661 6c75 653a 2072       if value: r
+00016a60: 6574 7572 6e20 7620 6966 206e 6f74 2073  eturn v if not s
+00016a70: 7472 696e 6720 656c 7365 2020 2820 0d0a  tring else  ( ..
+00016a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a90: 6c61 6265 6c20 2b20 7374 7228 7629 2069  label + str(v) i
+00016aa0: 6620 6e6f 7420 6d61 7468 2e69 736e 616e  f not math.isnan
+00016ab0: 2028 7629 2065 6c73 6520 6e70 2e6e 616e   (v) else np.nan
+00016ac0: 2029 200d 0a0d 0a64 6566 2063 6c61 7373   ) ....def class
+00016ad0: 6966 795f 6b20 280d 0a20 2020 2020 2020  ify_k (..       
+00016ae0: 206f 3a44 6174 6146 7261 6d65 7c20 5365   o:DataFrame| Se
+00016af0: 7269 6573 207c 2041 7272 6179 4c69 6b65  ries | ArrayLike
+00016b00: 2c20 2f2c 2020 6675 6e63 3a20 6361 6c6c  , /,  func: call
+00016b10: 6162 6c65 7c46 3d20 4e6f 6e65 202c 200d  able|F= None , .
+00016b20: 0a20 2020 2020 2020 206b 6e61 6d65 3a73  .        kname:s
+00016b30: 7472 3d4e 6f6e 652c 2069 6e70 6c61 6365  tr=None, inplace
+00016b40: 3a62 6f6f 6c20 3d46 616c 7365 2c20 7374  :bool =False, st
+00016b50: 7269 6e67 3a73 7472 203d 4661 6c73 652c  ring:str =False,
+00016b60: 200d 0a20 2020 2020 2020 2064 6566 6175   ..        defau
+00016b70: 6c74 5f66 756e 633a 626f 6f6c 3d46 616c  lt_func:bool=Fal
+00016b80: 7365 2020 0d0a 2020 2020 2020 2020 293a  se  ..        ):
+00016b90: 0d0a 2020 2020 2222 2220 4361 7465 676f  ..    """ Catego
+00016ba0: 7269 7a65 2074 6865 2070 6572 6d65 6162  rize the permeab
+00016bb0: 696c 6974 7920 636f 6566 6669 6369 656e  ility coefficien
+00016bc0: 7420 276b 270d 0a20 2020 200d 0a20 2020  t 'k'..    ..   
+00016bd0: 204d 6170 2074 6865 2063 6f6e 7469 6e75   Map the continu
+00016be0: 6f75 7320 276b 2720 696e 746f 2063 6174  ous 'k' into cat
+00016bf0: 6567 6f72 6961 6c20 636c 6173 7365 732e  egorial classes.
+00016c00: 200d 0a20 2020 200d 0a20 2020 2050 6172   ..    ..    Par
+00016c10: 616d 6574 6572 7320 0d0a 2020 2020 2d2d  ameters ..    --
+00016c20: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 6f3a  --------..    o:
+00016c30: 206e 6461 7272 6179 206f 6620 7064 2e53   ndarray of pd.S
+00016c40: 6572 6965 7320 6f72 2044 6174 6166 7261  eries or Datafra
+00016c50: 6d65 0d0a 2020 2020 2020 2020 6461 7461  me..        data
+00016c60: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00016c70: 7065 726d 6561 6269 6c69 7479 2063 6f65  permeability coe
+00016c80: 6666 6963 6965 6e74 206b 2063 6f6e 7469  fficient k conti
+00016c90: 6e65 6f75 7320 7661 6c75 6573 2e20 0d0a  neous values. ..
+00016ca0: 2020 2020 2020 2020 4966 2064 6174 6120          If data 
+00016cb0: 6973 2070 6173 7373 6564 2061 7320 6120  is passsed as a 
+00016cc0: 7061 6e64 6173 2064 6174 6166 7261 6d65  pandas dataframe
+00016cd0: 2c20 7468 6520 636f 6c75 6d6e 2063 6f6e  , the column con
+00016ce0: 7461 696e 696e 6720 7468 6520 0d0a 2020  taining the ..  
+00016cf0: 2020 2020 2020 6b2d 7661 6c75 6573 2060        k-values `
+00016d00: 6b6e 616d 6560 206e 6565 6473 2074 6f20  kname` needs to 
+00016d10: 6265 2073 7065 6369 6669 6564 2e20 0d0a  be specified. ..
+00016d20: 2020 2020 6675 6e63 3a20 6361 6c6c 6162      func: callab
+00016d30: 6c65 200d 0a20 2020 2020 2020 2046 756e  le ..        Fun
+00016d40: 6374 696f 6e20 746f 2073 7065 6369 6669  ction to specifi
+00016d50: 6361 6c6c 7920 6d61 7020 7468 6520 7065  cally map the pe
+00016d60: 726d 6561 6269 6c69 7479 2063 6f65 6666  rmeability coeff
+00016d70: 6963 6965 6e74 2063 6f6c 756d 6e20 0d0a  icient column ..
+00016d80: 2020 2020 2020 2020 696e 2074 6865 2064          in the d
+00016d90: 6174 6166 7261 6d65 206f 6620 7365 7269  ataframe of seri
+00016da0: 652e 2049 6620 6e6f 7420 6769 7665 6e2c  e. If not given,
+00016db0: 2074 6865 2064 6566 6175 6c74 2066 756e   the default fun
+00016dc0: 6374 696f 6e20 6361 6e20 6265 200d 0a20  ction can be .. 
+00016dd0: 2020 2020 2020 2065 6e61 626c 6564 2069         enabled i
+00016de0: 6e73 7465 6164 2066 726f 6d20 7061 7261  nstead from para
+00016df0: 6d20 6064 6566 6175 6c74 5f66 756e 6360  m `default_func`
+00016e00: 2e20 0d0a 2020 2020 696e 706c 6163 653a  . ..    inplace:
+00016e10: 2062 6f6f 6c2c 2064 6566 6175 6c74 3d46   bool, default=F
+00016e20: 616c 7365 200d 0a20 2020 2020 2020 204d  alse ..        M
+00016e30: 6f64 6966 6965 6420 6f62 6a65 6374 2069  odified object i
+00016e40: 6e70 6c61 6365 2061 6e64 2072 6574 7572  nplace and retur
+00016e50: 6e20 4e6f 6e65 200d 0a20 2020 2073 7472  n None ..    str
+00016e60: 696e 673a 2062 6f6f 6c2c 200d 0a20 2020  ing: bool, ..   
+00016e70: 2020 2020 2049 6620 7365 7420 746f 2022       If set to "
+00016e80: 5472 7565 222c 2063 6174 6567 6f72 697a  True", categoriz
+00016e90: 6564 206d 6170 2066 726f 6d20 276b 2720  ed map from 'k' 
+00016ea0: 2073 686f 756c 6420 6265 2070 7265 6669   should be prefi
+00016eb0: 7865 6420 6279 2022 6b22 2e20 0d0a 2020  xed by "k". ..  
+00016ec0: 2020 2020 2020 486f 7765 7665 7220 6973        However is
+00016ed0: 2073 7472 696e 6720 7661 6c75 6520 6973   string value is
+00016ee0: 2067 6976 656e 202c 2074 6865 2070 7265   given , the pre
+00016ef0: 6669 7820 6973 2063 6861 6e67 6564 2061  fix is changed a
+00016f00: 6363 6f72 6469 6e67 200d 0a20 2020 2020  ccording ..     
+00016f10: 2020 2074 6f20 7468 6973 206c 6162 656c     to this label
+00016f20: 2e20 0d0a 2020 2020 6465 6661 756c 745f  . ..    default_
+00016f30: 7566 756e 633a 2062 6f6f 6c2c 200d 0a20  ufunc: bool, .. 
+00016f40: 2020 2020 2020 2044 6566 6175 6c74 2066         Default f
+00016f50: 756e 6374 696f 6e20 666f 7220 6d61 7070  unction for mapp
+00016f60: 696e 6720 6b20 6973 2073 6574 7469 6e67  ing k is setting
+00016f70: 2074 6f20 6060 5472 7565 6060 2e20 4e6f   to ``True``. No
+00016f80: 7465 2074 6861 742c 2074 6869 7320 0d0a  te that, this ..
+00016f90: 2020 2020 2020 2020 636f 756c 6420 7072          could pr
+00016fa0: 6f62 6162 6c79 206e 6f74 2066 6974 7465  obably not fitte
+00016fb0: 6420 796f 7572 206f 776e 2064 6174 612e  d your own data.
+00016fc0: 2053 6f20 2069 7420 6973 2072 6563 6f6d   So  it is recom
+00016fd0: 6d65 6e64 6564 2074 6f20 0d0a 2020 2020  mended to ..    
+00016fe0: 2020 2020 7072 6f76 6964 6520 796f 7572      provide your
+00016ff0: 206f 776e 2066 756e 6374 696f 6e20 666f   own function fo
+00017000: 7220 6d61 7070 696e 6720 276b 272e 2048  r mapping 'k'. H
+00017010: 6f77 6576 6572 2074 6865 2064 6566 6175  owever the defau
+00017020: 6c74 2027 6b27 200d 0a20 2020 2020 2020  lt 'k' ..       
+00017030: 206d 6170 7069 6e67 2069 7320 6769 7665   mapping is give
+00017040: 6e20 6173 2066 6f6c 6c6f 773a 200d 0a20  n as follow: .. 
+00017050: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00017060: 2020 2020 202d 206b 3020 7b30 7d3a 206b       - k0 {0}: k
+00017070: 203d 2030 200d 0a20 2020 2020 2020 202d   = 0 ..        -
+00017080: 206b 3120 7b31 7d3a 2030 203c 206b 203c   k1 {1}: 0 < k <
+00017090: 3d20 2e30 3120 0d0a 2020 2020 2020 2020  = .01 ..        
+000170a0: 2d20 6b32 207b 327d 3a20 2e30 3120 3c20  - k2 {2}: .01 < 
+000170b0: 6b20 3c3d 202e 3037 200d 0a20 2020 2020  k <= .07 ..     
+000170c0: 2020 202d 206b 3320 7b33 7d3a 206b 3e20     - k3 {3}: k> 
+000170d0: 2e30 3720 0d0a 2020 2020 5265 7475 726e  .07 ..    Return
+000170e0: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d0d  s..    --------.
+000170f0: 0a20 2020 206f 3a20 4e6f 6e65 2c20 206e  .    o: None,  n
+00017100: 6461 7272 6179 2c20 5365 7269 6573 206f  darray, Series o
+00017110: 7220 4461 7461 6672 616d 6520 0d0a 2020  r Dataframe ..  
+00017120: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
+00017130: 6520 6f6e 6c79 2069 6620 6461 7461 6672  e only if datafr
+00017140: 616d 6520 6973 2067 6976 656e 2061 6e64  ame is given and
+00017150: 2060 696e 706c 6163 6560 2069 7320 7365   `inplace` is se
+00017160: 7420 0d0a 2020 2020 2020 2020 746f 2060  t ..        to `
+00017170: 6054 7275 6560 6020 692e 6520 6d6f 6469  `True`` i.e modi
+00017180: 6669 6564 206f 626a 6563 7420 696e 706c  fied object inpl
+00017190: 6163 652e 200d 0a20 2020 2020 2020 200d  ace. ..        .
+000171a0: 0a20 2020 2045 7861 6d70 6c65 7320 0d0a  .    Examples ..
+000171b0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020      --------..  
+000171c0: 2020 3e3e 3e20 696d 706f 7274 206e 756d    >>> import num
+000171d0: 7079 2061 7320 6e70 200d 0a20 2020 203e  py as np ..    >
+000171e0: 3e3e 2066 726f 6d20 7761 7465 782e 6461  >> from watex.da
+000171f0: 7461 7365 7473 2069 6d70 6f72 7420 6c6f  tasets import lo
+00017200: 6164 5f68 6c6f 6773 200d 0a20 2020 203e  ad_hlogs ..    >
+00017210: 3e3e 2066 726f 6d20 7761 7465 782e 7574  >> from watex.ut
+00017220: 696c 732e 6879 6472 6f75 7469 6c73 2069  ils.hydroutils i
+00017230: 6d70 6f72 7420 636c 6173 7369 6679 5f6b  mport classify_k
+00017240: 200d 0a20 2020 203e 3e3e 205f 2c20 7930   ..    >>> _, y0
+00017250: 203d 206c 6f61 645f 686c 6f67 7320 2861   = load_hlogs (a
+00017260: 735f 6672 616d 6520 3d54 7275 6529 200d  s_frame =True) .
+00017270: 0a20 2020 203e 3e3e 2023 206c 6574 2076  .    >>> # let v
+00017280: 6973 7561 6c69 7a65 2066 6f75 7220 6e6f  isualize four no
+00017290: 6e7a 6572 6f73 2076 616c 7565 7320 696e  nzeros values in
+000172a0: 2079 3020 0d0a 2020 2020 3e3e 3e20 7930   y0 ..    >>> y0
+000172b0: 2e6b 2e76 616c 7565 7320 5b20 7e6e 702e  .k.values [ ~np.
+000172c0: 6973 6e61 6e20 2879 302e 6b20 2920 5d5b  isnan (y0.k ) ][
+000172d0: 3a34 5d0d 0a20 2020 202e 2e2e 2020 6172  :4]..    ...  ar
+000172e0: 7261 7928 5b30 2e30 3534 2c20 302e 3035  ray([0.054, 0.05
+000172f0: 342c 2030 2e30 3534 2c20 302e 3035 345d  4, 0.054, 0.054]
+00017300: 290d 0a20 2020 203e 3e3e 2063 6c61 7373  )..    >>> class
+00017310: 6966 795f 6b20 2879 3020 2c20 6b6e 616d  ify_k (y0 , knam
+00017320: 6520 3d27 6b27 2c20 696e 706c 6163 6520  e ='k', inplace 
+00017330: 3d54 7275 652c 2075 7365 5f64 6566 6175  =True, use_defau
+00017340: 6c74 5f66 756e 633d 5472 7565 2029 0d0a  lt_func=True )..
+00017350: 2020 2020 3e3e 3e20 2320 6c65 7420 7365      >>> # let se
+00017360: 6520 6167 6169 6e20 7468 6520 7361 6d65  e again the same
+00017370: 2066 6f75 7220 7661 6c75 6520 696e 2074   four value in t
+00017380: 6865 2064 6174 6166 7261 6d65 200d 0a20  he dataframe .. 
+00017390: 2020 203e 3e3e 2079 302e 6b2e 7661 6c75     >>> y0.k.valu
+000173a0: 6573 205b 207e 6e70 2e69 736e 616e 2028  es [ ~np.isnan (
+000173b0: 7930 2e6b 2029 205d 5b3a 345d 0d0a 2020  y0.k ) ][:4]..  
+000173c0: 2020 2e2e 2e20 6172 7261 7928 5b32 2e2c    ... array([2.,
+000173d0: 2032 2e2c 2032 2e2c 2032 2e5d 2920 0d0a   2., 2., 2.]) ..
+000173e0: 2020 2020 0d0a 2020 2020 2222 220d 0a20      ..    """.. 
+000173f0: 2020 205f 6173 7365 7274 5f61 6c6c 5f74     _assert_all_t
+00017400: 7970 6573 286f 2c20 7064 2e53 6572 6965  ypes(o, pd.Serie
+00017410: 732c 2070 642e 4461 7461 4672 616d 652c  s, pd.DataFrame,
+00017420: 206e 702e 6e64 6172 7261 7929 0d0a 2020   np.ndarray)..  
+00017430: 2020 0d0a 2020 2020 6466 756e 6320 3d20    ..    dfunc = 
+00017440: 6c61 6d62 6461 206b 203a 205f 6b70 2028  lambda k : _kp (
+00017450: 6b2c 2073 7472 696e 6720 3d20 7374 7269  k, string = stri
+00017460: 6e67 2029 2023 2064 6566 6175 6c74 200d  ng ) # default .
+00017470: 0a20 2020 2066 756e 6320 3d20 6675 6e63  .    func = func
+00017480: 206f 7220 2020 2820 6466 756e 6320 6966   or   ( dfunc if
+00017490: 2064 6566 6175 6c74 5f66 756e 6320 656c   default_func el
+000174a0: 7365 204e 6f6e 6520 2920 0d0a 2020 2020  se None ) ..    
+000174b0: 6966 2066 756e 6320 6973 204e 6f6e 653a  if func is None:
+000174c0: 200d 0a20 2020 2020 2020 2072 6169 7365   ..        raise
+000174d0: 2054 7970 6545 7272 6f72 2028 2227 7566   TypeError ("'uf
+000174e0: 756e 6327 2063 616e 6e6f 7420 6265 204e  unc' cannot be N
+000174f0: 6f6e 6520 7768 656e 2074 6865 2064 6566  one when the def
+00017500: 6175 6c74 220d 0a20 2020 2020 2020 2020  ault"..         
+00017510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017520: 2220 276b 2720 6d61 7070 696e 6720 6675  " 'k' mapping fu
+00017530: 6e63 7469 6f6e 2069 7320 6e6f 7420 7472  nction is not tr
+00017540: 6967 6765 7265 642e 2229 0d0a 2020 2020  iggered.")..    
+00017550: 6f6f 3d20 636f 7079 2e64 6565 7063 6f70  oo= copy.deepcop
+00017560: 7920 286f 2029 0d0a 2020 2020 6966 2068  y (o )..    if h
+00017570: 6173 6174 7472 2028 6f2c 2027 636f 6c75  asattr (o, 'colu
+00017580: 6d6e 7327 293a 0d0a 2020 2020 2020 2020  mns'):..        
+00017590: 6966 206b 6e61 6d65 2069 7320 4e6f 6e65  if kname is None
+000175a0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+000175b0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+000175c0: 2028 226b 6e61 6d65 2720 6973 206e 6f74   ("kname' is not
+000175d0: 2073 6574 2077 6869 6c65 2064 6174 6166   set while dataf
+000175e0: 7261 6d65 2069 7320 6769 7665 6e2e 2022  rame is given. "
+000175f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017610: 2250 6c65 6173 6520 7370 6563 6966 7920  "Please specify 
+00017620: 7468 6520 6e61 6d65 206f 6620 7065 726d  the name of perm
+00017630: 6561 6269 6c69 7479 2063 6f6c 756d 6e2e  eability column.
+00017640: 2229 0d0a 2020 2020 2020 2020 6973 5f69  ")..        is_i
+00017650: 6e5f 6966 2820 6f2c 206b 6e61 6d65 2029  n_if( o, kname )
+00017660: 0d0a 2020 0d0a 2020 2020 2020 2020 6966  ..  ..        if
+00017670: 2069 6e70 6c61 6365 203a 200d 0a20 2020   inplace : ..   
+00017680: 2020 2020 2020 2020 206f 5b6b 6e61 6d65           o[kname
+00017690: 5d20 3d20 6f5b 6b6e 616d 655d 2e6d 6170  ] = o[kname].map
+000176a0: 2028 6675 6e63 2920 0d0a 2020 2020 2020   (func) ..      
+000176b0: 2020 2020 2020 7265 7475 726e 200d 0a20        return .. 
+000176c0: 2020 2020 2020 206f 6f5b 6b6e 616d 655d         oo[kname]
+000176d0: 203d 206f 6f5b 6b6e 616d 655d 2e6d 6170   = oo[kname].map
+000176e0: 2028 6675 6e63 2920 0d0a 2020 2020 2020   (func) ..      
+000176f0: 2020 0d0a 2020 2020 656c 6966 2068 6173    ..    elif has
+00017700: 6174 7472 286f 2c20 276e 616d 6527 293a  attr(o, 'name'):
+00017710: 200d 0a20 2020 2020 2020 206f 6f3d 206f   ..        oo= o
+00017720: 6f2e 6d61 7028 6675 6e63 2029 200d 0a20  o.map(func ) .. 
+00017730: 200d 0a20 2020 2065 6c69 6620 6861 7361   ..    elif hasa
+00017740: 7474 7228 6f2c 2027 5f5f 6172 7261 795f  ttr(o, '__array_
+00017750: 5f27 293a 200d 0a20 2020 2020 2020 206f  _'): ..        o
+00017760: 6f20 3d20 6e70 2e61 7272 6179 2028 6c69  o = np.array (li
+00017770: 7374 286d 6170 2028 6675 6e63 2c20 6f20  st(map (func, o 
+00017780: 2929 290d 0a20 2020 2020 2020 200d 0a20  )))..        .. 
+00017790: 2020 2072 6574 7572 6e20 6f6f 200d 0a0d     return oo ...
+000177a0: 0a23 5858 5854 4f44 4f20 636f 6d70 7574  .#XXXTODO comput
+000177b0: 6520 7420 7061 7261 6d65 7465 7273 200d  e t parameters .
+000177c0: 0a64 6566 2074 7261 6e73 6d69 7373 6962  .def transmissib
+000177d0: 696c 6974 7920 2873 2c20 642c 2074 696d  ility (s, d, tim
+000177e0: 652c 2029 3a20 0d0a 2020 2020 2222 2254  e, ): ..    """T
+000177f0: 7261 6e73 6d69 7373 6962 696c 6974 7920  ransmissibility 
+00017800: 5420 7265 7072 6573 656e 7473 2074 6865  T represents the
+00017810: 2061 6269 6c69 7479 206f 6620 6171 7569   ability of aqui
+00017820: 6665 7227 7320 7761 7465 7220 636f 6e64  fer's water cond
+00017830: 7563 7469 7669 7479 2e0d 0a20 2020 200d  uctivity...    .
+00017840: 0a20 2020 2049 7420 6973 2074 6865 206e  .    It is the n
+00017850: 756d 6572 6963 2065 7175 6976 616c 656e  umeric equivalen
+00017860: 7420 6f66 2074 6865 2070 726f 6475 6374  t of the product
+00017870: 206f 6620 6879 6472 6175 6c69 6320 636f   of hydraulic co
+00017880: 6e64 7563 7469 7669 7479 2074 696d 6573  nductivity times
+00017890: 0d0a 2020 2020 6171 7569 6665 7227 7320  ..    aquifer's 
+000178a0: 7468 6963 6b6e 6573 7320 2854 203d 204b  thickness (T = K
+000178b0: 4d29 2c20 7768 6963 6820 6d65 616e 7320  M), which means 
+000178c0: 6974 2069 7320 7468 6520 7365 6570 6167  it is the seepag
+000178d0: 6520 666c 6f77 2075 6e64 6572 2074 6865  e flow under the
+000178e0: 0d0a 2020 2020 636f 6e64 6974 696f 6e20  ..    condition 
+000178f0: 6f66 2075 6e69 7420 6879 6472 6175 6c69  of unit hydrauli
+00017900: 6320 6772 6164 6965 6e74 2c20 756e 6974  c gradient, unit
+00017910: 2074 696d 652c 2061 6e64 2075 6e69 7420   time, and unit 
+00017920: 7769 6474 680d 0a20 2020 200d 0a20 2020  width..    ..   
+00017930: 2022 2222 0d0a 2020 2020 2e2e 2e20 0d0a   """..    ... ..
+00017940: 2020 2020 2020 0d0a 6465 6620 6368 6563        ..def chec
+00017950: 6b5f 666c 6f77 5f6f 626a 6563 7469 7669  k_flow_objectivi
+00017960: 7479 2028 2079 202c 2f2c 2020 7661 6c75  ty ( y ,/,  valu
+00017970: 6573 2c20 636c 6173 7365 7320 2029 203a  es, classes  ) :
+00017980: 0d0a 2020 2020 2222 2220 4675 6e63 7469  ..    """ Functi
+00017990: 6f6e 2063 6865 636b 7320 7468 6520 666c  on checks the fl
+000179a0: 6f77 2072 6174 6520 6f62 6a65 6374 6976  ow rate objectiv
+000179b0: 6974 790d 0a20 2020 200d 0a20 2020 2049  ity..    ..    I
+000179c0: 6620 6f62 6a65 6374 6976 6520 6973 2073  f objective is s
+000179d0: 6574 2074 6f20 6066 6c6f 7760 2069 2e65  et to `flow` i.e
+000179e0: 2074 6865 2070 7265 6469 6374 696f 6e20   the prediction 
+000179f0: 666f 6375 7365 7320 6f6e 2074 6865 2066  focuses on the f
+00017a00: 6c6f 770d 0a20 2020 2072 6174 652c 2074  low..    rate, t
+00017a10: 6865 7265 2061 7265 2073 6f6d 6520 636f  here are some co
+00017a20: 6e64 6974 696f 6e73 2074 6861 7420 7468  nditions that th
+00017a30: 6520 7461 7267 6574 2060 7960 206e 6565  e target `y` nee
+00017a40: 6473 2074 6f20 6d65 6574 2077 6865 6e20  ds to meet when 
+00017a50: 0d0a 2020 2020 7661 6c75 6573 2061 7265  ..    values are
+00017a60: 2070 6173 7365 6420 666f 7220 636c 6173   passed for clas
+00017a70: 7365 7320 6361 7465 676f 7269 7a61 7469  ses categorizati
+00017a80: 6f6e 2e20 0d0a 2020 2020 0d0a 2020 2020  on. ..    ..    
+00017a90: 3a70 6172 616d 2076 616c 7565 733a 206c  :param values: l
+00017aa0: 6973 7420 6f66 2076 616c 7565 7320 746f  ist of values to
+00017ab0: 2065 6e63 6f64 696e 6720 7468 6520 6e75   encoding the nu
+00017ac0: 6d65 7269 6361 6c20 7461 7267 6574 2060  merical target `
+00017ad0: 7960 2e20 0d0a 2020 2020 2020 2020 666f  y`. ..        fo
+00017ae0: 7220 696e 7374 616e 6365 2060 6076 616c  r instance ``val
+00017af0: 7565 733d 5b30 2c20 312c 2032 5d60 6020  ues=[0, 1, 2]`` 
+00017b00: 0d0a 2020 2020 3a70 6172 616d 206f 626a  ..    :param obj
+00017b10: 6563 7469 7665 3a20 7374 722c 2072 656c  ective: str, rel
+00017b20: 6174 6520 746f 2074 6865 2066 6c6f 7720  ate to the flow 
+00017b30: 7261 7465 2070 7265 6469 6374 696f 6e2e  rate prediction.
+00017b40: 2053 6574 2074 6f20 0d0a 2020 2020 2020   Set to ..      
+00017b50: 2020 6060 4e6f 6e65 6060 2066 6f72 2061    ``None`` for a
+00017b60: 6e79 206f 7468 6572 2070 7265 6469 6374  ny other predict
+00017b70: 696f 6e73 2e20 0d0a 2020 2020 3a70 6172  ions. ..    :par
+00017b80: 616d 2070 7265 6669 783a 2074 6865 2070  am prefix: the p
+00017b90: 7265 6669 7820 746f 2061 6464 2074 6f20  refix to add to 
+00017ba0: 7468 6520 636c 6173 7320 6c61 6265 6c73  the class labels
+00017bb0: 2e20 466f 7220 696e 7374 616e 6365 2c20  . For instance, 
+00017bc0: 6966 200d 0a20 2020 2020 2020 2074 6865  if ..        the
+00017bd0: 2060 7072 6566 6978 6020 6571 7561 6c73   `prefix` equals
+00017be0: 2074 6f20 6060 4652 6060 2c20 636c 6173   to ``FR``, clas
+00017bf0: 7320 6c61 6265 6c73 2077 696c 6c20 6265  s labels will be
+00017c00: 636f 6d65 3a3a 200d 0a20 2020 2020 2020  come:: ..       
+00017c10: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00017c20: 2020 205b 302c 2031 2c20 325d 203d 3e20     [0, 1, 2] => 
+00017c30: 5b46 5230 2c20 4652 312c 2046 5232 5d0d  [FR0, FR1, FR2].
+00017c40: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00017c50: 2020 203a 7061 7261 6d20 636c 6173 7365     :param classe
+00017c60: 733a 206c 6973 7420 6f66 2063 6c61 7373  s: list of class
+00017c70: 6573 206e 616d 6573 2074 6f20 7265 706c  es names to repl
+00017c80: 6163 6520 7468 6520 6465 6661 756c 7420  ace the default 
+00017c90: 6046 5260 2074 6861 7420 6973 200d 0a20  `FR` that is .. 
+00017ca0: 2020 2020 2020 2075 7365 6420 746f 2073         used to s
+00017cb0: 7065 6369 6679 2074 6865 2066 6c6f 7720  pecify the flow 
+00017cc0: 7261 7465 2e20 466f 7220 696e 7374 616e  rate. For instan
+00017cd0: 6365 2c20 6974 2063 616e 2062 653a 3a20  ce, it can be:: 
+00017ce0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+00017cf0: 2020 2020 2020 2020 2020 2020 5b30 2c20              [0, 
+00017d00: 312c 2032 5d20 3d3e 205b 7366 302c 2073  1, 2] => [sf0, s
+00017d10: 6631 2c20 7366 325d 0d0a 2020 2020 3a72  f1, sf2]..    :r
+00017d20: 6574 7572 6e73 3a0d 0a20 2020 2020 2020  eturns:..       
+00017d30: 2028 792c 2063 6c61 7373 6573 293a 2054   (y, classes): T
+00017d40: 7570 6c65 2c20 0d0a 2020 2020 2020 2020  uple, ..        
+00017d50: 2d20 793a 2061 7272 6179 2d6c 696b 6520  - y: array-like 
+00017d60: 3164 2020 6f66 2063 6174 6567 6f72 697a  1d  of categoriz
+00017d70: 6564 2020 6079 6020 0d0a 2020 2020 2020  ed  `y` ..      
+00017d80: 2020 2d20 636c 6173 7365 733a 206c 6973    - classes: lis
+00017d90: 7420 6f66 2066 6c6f 7720 7261 7465 2063  t of flow rate c
+00017da0: 6c61 7373 6573 2e20 0d0a 2020 2020 2222  lasses. ..    ""
+00017db0: 220d 0a20 2020 206d 7367 3d20 2822 4f62  "..    msg= ("Ob
+00017dc0: 6a65 6374 6976 6520 6973 2027 666c 6f77  jective is 'flow
+00017dd0: 2720 7768 6572 6561 7320 7468 6520 7461  ' whereas the ta
+00017de0: 7267 6574 2076 616c 7565 2069 7320 7365  rget value is se
+00017df0: 7420 746f 207b 307d 2e22 0d0a 2020 2020  t to {0}."..    
+00017e00: 2020 2020 2020 2220 5461 7267 6574 2069        " Target i
+00017e10: 7320 6465 6661 756c 746c 7920 656e 636f  s defaultly enco
+00017e20: 6465 6420 746f 2068 6f6c 6420 696e 7465  ded to hold inte
+00017e30: 6765 7273 207b 317d 2e20 4966 220d 0a20  gers {1}. If".. 
+00017e40: 2020 2020 2020 2020 2022 2074 6865 2061           " the a
+00017e50: 7574 6f2d 6361 7465 676f 7269 7a61 7469  uto-categorizati
+00017e60: 6f6e 2064 6f65 7320 6e6f 7420 6669 7420  on does not fit 
+00017e70: 7468 6520 7265 616c 2076 616c 7565 7322  the real values"
+00017e80: 0d0a 2020 2020 2020 2020 2020 2220 6f66  ..          " of
+00017e90: 2066 6c6f 7720 7261 6e67 6573 2c20 706c   flow ranges, pl
+00017ea0: 6561 7365 2073 6574 2074 6865 2072 616e  ease set the ran
+00017eb0: 6765 206f 6620 7468 6520 7265 616c 2066  ge of the real f
+00017ec0: 6c6f 7720 7661 6c75 6573 220d 0a20 2020  low values"..   
+00017ed0: 2020 2020 2020 2022 2076 6961 2070 6172         " via par
+00017ee0: 616d 2060 7661 6c75 6573 6020 6f72 2060  am `values` or `
+00017ef0: 6c61 6265 6c5f 7661 6c75 6573 602e 220d  label_values`.".
+00017f00: 0a20 2020 2020 2020 2020 2029 200d 0a20  .          ) .. 
+00017f10: 2020 2079 3d63 6865 636b 5f79 2820 0d0a     y=check_y( ..
+00017f20: 2020 2020 2020 2020 792c 200d 0a20 2020          y, ..   
+00017f30: 2020 2020 2069 6e70 7574 5f6e 616d 653d       input_name=
+00017f40: 2220 466c 6f77 2061 7272 6179 2027 7927  " Flow array 'y'
+00017f50: 222c 200d 0a20 2020 2020 2020 2074 6f5f  ", ..        to_
+00017f60: 6672 616d 653d 5472 7565 0d0a 2020 2020  frame=True..    
+00017f70: 2020 2020 290d 0a20 2020 2069 6620 7661      )..    if va
+00017f80: 6c75 6573 2069 7320 4e6f 6e65 3a0d 0a20  lues is None:.. 
+00017f90: 2020 2020 2020 206d 7367 203d 2028 224d         msg = ("M
+00017fa0: 6973 7369 6e67 2076 616c 7565 7320 666f  issing values fo
+00017fb0: 7220 6361 7465 676f 7269 7a69 6e67 2027  r categorizing '
+00017fc0: 7927 3b20 7468 6520 6e75 6d62 6572 206f  y'; the number o
+00017fd0: 6622 0d0a 2020 2020 2020 2020 2020 2020  f"..            
+00017fe0: 2020 2020 2220 6f63 6375 7265 6e63 6520      " occurence 
+00017ff0: 696e 2074 6865 2074 6172 6765 7420 6973  in the target is
+00018000: 2068 656e 6365 666f 7274 6820 6e6f 7420   henceforth not 
+00018010: 616c 6c6f 7765 642e 220d 0a20 2020 2020  allowed."..     
+00018020: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00018030: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+00018040: 6172 6e28 2256 616c 7565 7320 6172 6520  arn("Values are 
+00018050: 6e6f 7420 7365 742e 2054 6865 206e 6577  not set. The new
+00018060: 2076 6572 7369 6f6e 2064 6f65 7320 6e6f   version does no
+00018070: 7422 200d 0a20 2020 2020 2020 2020 2020  t" ..           
+00018080: 2020 2020 2020 2020 2020 2022 2074 6f6c             " tol
+00018090: 6572 6174 6520 7468 6520 6e75 6d62 6572  erate the number
+000180a0: 206f 6620 6f63 6375 7272 656e 6365 2074   of occurrence t
+000180b0: 6f20 6265 2075 7365 642e 220d 0a20 2020  o be used."..   
+000180c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000180d0: 2020 2022 2050 726f 7669 6465 2074 6865     " Provide the
+000180e0: 206c 6973 7420 6f66 2066 6c6f 7720 7661   list of flow va
+000180f0: 6c75 6573 2069 6e73 7465 6164 2e22 2c0d  lues instead.",.
+00018100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018110: 2020 2020 2020 2044 6570 7265 6361 7469         Deprecati
+00018120: 6f6e 5761 726e 696e 6720 290d 0a20 2020  onWarning )..   
+00018130: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00018140: 7272 6f72 2028 6d73 6729 0d0a 2020 2020  rror (msg)..    
+00018150: 2020 2020 0d0a 2020 2020 656c 6966 2076      ..    elif v
+00018160: 616c 7565 7320 6973 206e 6f74 204e 6f6e  alues is not Non
+00018170: 653a 200d 0a20 2020 2020 2020 2069 6620  e: ..        if 
+00018180: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
+00018190: 732c 2020 2869 6e74 2c20 666c 6f61 7429  s,  (int, float)
+000181a0: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
+000181b0: 7920 3d20 2063 6174 6567 6f72 697a 655f  y =  categorize_
+000181c0: 7461 7267 6574 2879 202c 206c 6162 656c  target(y , label
+000181d0: 7320 3d20 696e 7428 7661 6c75 6573 2920  s = int(values) 
+000181e0: 290d 0a20 2020 2020 2020 2020 2020 7761  )..           wa
+000181f0: 726e 696e 6773 2e77 6172 6e28 6d73 672e  rnings.warn(msg.
+00018200: 666f 726d 6174 2876 616c 7565 732c 206e  format(values, n
+00018210: 702e 756e 6971 7565 2028 7929 2029 290d  p.unique (y) )).
+00018220: 0a20 2020 2020 2020 2020 2020 7661 6c75  .           valu
+00018230: 6573 203d 206e 702e 756e 6971 7565 2028  es = np.unique (
+00018240: 7929 0d0a 2020 2020 2020 2020 0d0a 2020  y)..        ..  
+00018250: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00018260: 7461 6e63 6528 7661 6c75 6573 2c20 286c  tance(values, (l
+00018270: 6973 742c 2074 7570 6c65 2c20 6e70 2e6e  ist, tuple, np.n
+00018280: 6461 7272 6179 2929 3a0d 0a20 2020 2020  darray)):..     
+00018290: 2020 2020 2020 2079 203d 206e 702e 756e         y = np.un
+000182a0: 6971 7565 2879 2920 0d0a 2020 2020 2020  ique(y) ..      
+000182b0: 2020 2020 2020 6966 206c 656e 2876 616c        if len(val
+000182c0: 7565 7329 213d 6c65 6e28 7929 3a20 0d0a  ues)!=len(y): ..
+000182d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000182e0: 7761 726e 696e 6773 2e77 6172 6e28 2253  warnings.warn("S
+000182f0: 697a 6520 6f66 2075 6e69 7175 6520 6964  ize of unique id
+00018300: 656e 7469 6669 6572 2063 6c61 7373 206c  entifier class l
+00018310: 6162 656c 7322 0d0a 2020 2020 2020 2020  abels"..        
+00018320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018330: 2020 2020 2020 2220 616e 6420 7468 6520        " and the 
+00018340: 6769 7665 6e20 7661 6c75 6573 206d 6967  given values mig
+00018350: 6874 2062 6520 636f 6e73 6973 7465 6e74  ht be consistent
+00018360: 2e22 0d0a 2020 2020 2020 2020 2020 2020  ."..            
+00018370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018380: 2020 6622 2049 6465 6e66 6965 7220 7369    f" Idenfier si
+00018390: 7a65 7320 3d20 7b6c 656e 2879 297d 2077  zes = {len(y)} w
+000183a0: 6865 7265 6173 2067 6976 656e 2022 0d0a  hereas given "..
+000183b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000183c0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+000183d0: 2076 616c 7565 7320 6c65 6e67 7468 2061   values length a
+000183e0: 7265 203d 7b6c 656e 2876 616c 7565 7329  re ={len(values)
+000183f0: 7d2e 2057 696c 6c22 0d0a 2020 2020 2020  }. Will"..      
+00018400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018410: 2020 2020 2020 2020 2220 7573 6520 7468          " use th
+00018420: 6520 756e 6971 7565 2069 6465 6e74 6966  e unique identif
+00018430: 6965 7220 6c61 6265 6c73 2069 6e73 7465  ier labels inste
+00018440: 6164 2e22 290d 0a20 2020 2020 2020 2020  ad.")..         
+00018450: 2020 2020 2020 2076 616c 7565 7320 3d20         values = 
+00018460: 7920 0d0a 2020 2020 2020 2020 2020 2020  y ..            
+00018470: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00018480: 2020 7920 3d20 6361 7465 676f 7269 7a65    y = categorize
+00018490: 5f66 6c6f 7728 792c 2076 616c 7565 732c  _flow(y, values,
+000184a0: 2063 6c61 7373 6573 3d63 6c61 7373 6573   classes=classes
+000184b0: 2020 290d 0a20 2020 2020 2020 2065 6c73    )..        els
+000184c0: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
+000184d0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+000184e0: 6f72 2822 7b74 7970 6520 2876 616c 7565  or("{type (value
+000184f0: 7329 2e5f 5f6e 616d 655f 5f21 727d 2069  s).__name__!r} i
+00018500: 7320 6e6f 7420 616c 6c6f 7722 0d0a 2020  s not allow"..  
+00018510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018520: 2020 2020 2020 2020 2020 2022 2045 7870             " Exp
+00018530: 6563 7420 6120 6c69 7374 206f 6620 696e  ect a list of in
+00018540: 7465 6765 7273 2e22 290d 0a20 2020 2020  tegers.")..     
+00018550: 2020 2020 2020 200d 0a20 2020 2063 6c61         ..    cla
+00018560: 7373 6573 203d 2063 6c61 7373 6573 206f  sses = classes o
+00018570: 7220 7661 6c75 6573 200d 0a20 2020 2072  r values ..    r
+00018580: 6574 7572 6e20 792c 2063 6c61 7373 6573  eturn y, classes
+00018590: 200d 0a20 0d0a 4063 6174 6d61 7066 6c6f   .. ..@catmapflo
+000185a0: 7732 2863 6174 5f63 6c61 7373 6573 3d5b  w2(cat_classes=[
+000185b0: 2746 5230 272c 2027 4652 3127 2c20 2746  'FR0', 'FR1', 'F
+000185c0: 5232 272c 2027 4652 3327 5d29 232c 2027  R2', 'FR3'])#, '
+000185d0: 4652 3427 5d20 290d 0a64 6566 2063 6174  FR4'] )..def cat
+000185e0: 6567 6f72 697a 655f 666c 6f77 280d 0a20  egorize_flow(.. 
+000185f0: 2020 2020 2020 2074 6172 6765 743a 2053         target: S
+00018600: 6572 6965 7320 7c20 4172 7261 794c 696b  eries | ArrayLik
+00018610: 655b 545d 202c 0d0a 2020 2020 2020 2020  e[T] ,..        
+00018620: 666c 6f77 5f76 616c 7565 733a 204c 6973  flow_values: Lis
+00018630: 7420 5b66 6c6f 6174 5d2c 0d0a 2020 2020  t [float],..    
+00018640: 2020 2020 2a2a 6b77 6172 6773 0d0a 2020      **kwargs..  
+00018650: 2020 2920 2d3e 2054 7570 6c65 5b20 4c69    ) -> Tuple[ Li
+00018660: 7374 5b66 6c6f 6174 5d2c 2054 2c20 4c69  st[float], T, Li
+00018670: 7374 5b73 7472 5d5d 3a20 0d0a 2020 2020  st[str]]: ..    
+00018680: 2222 2220 0d0a 2020 2020 4361 7465 676f  """ ..    Catego
+00018690: 7269 7a65 2060 666c 6f77 6020 696e 746f  rize `flow` into
+000186a0: 2064 6966 6665 7265 6e74 2063 6c61 7373   different class
+000186b0: 6573 2e20 4966 2074 6865 206f 7074 696f  es. If the optio
+000186c0: 6e61 6c0d 0a20 2020 2060 666c 6f77 5f63  nal..    `flow_c
+000186d0: 6c61 7373 6573 6020 2061 7267 756d 656e  lasses`  argumen
+000186e0: 7420 6973 2067 6976 656e 2c20 6974 2073  t is given, it s
+000186f0: 686f 756c 6420 6265 2065 7261 7365 6420  hould be erased 
+00018700: 7468 650d 0a20 2020 2060 6361 745f 636c  the..    `cat_cl
+00018710: 6173 7365 7360 2061 7267 756d 656e 7420  asses` argument 
+00018720: 6f66 2064 6563 6f72 6f72 6174 6f72 2060  of decororator `
+00018730: 6465 636f 2e63 6174 6d61 7066 6c6f 7760  deco.catmapflow`
+00018740: 2e0d 0a20 2020 200d 0a20 2020 2050 6172  ...    ..    Par
+00018750: 616d 6574 6572 7320 0d0a 2020 2020 2d2d  ameters ..    --
+00018760: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00018770: 7461 7267 6574 3a20 6172 7261 792d 6c69  target: array-li
+00018780: 6b65 2c20 7061 6e64 6173 2e53 6572 6965  ke, pandas.Serie
+00018790: 732c 200d 0a20 2020 2020 2020 2046 6c6f  s, ..        Flo
+000187a0: 7720 6172 7261 7920 746f 2062 6520 6361  w array to be ca
+000187b0: 7465 676f 7269 7a65 640d 0a20 2020 200d  tegorized..    .
+000187c0: 0a20 2020 2066 6c6f 775f 7661 6c75 6573  .    flow_values
+000187d0: 3a20 6c69 7374 206f 6620 7374 7220 0d0a  : list of str ..
+000187e0: 2020 2020 2020 2020 5661 6c75 6573 2066          Values f
+000187f0: 6f72 2066 6c6f 7720 6361 7465 676f 7269  or flow categori
+00018800: 7a61 7469 6f6e 3b20 6974 2064 6973 7472  zation; it distr
+00018810: 6962 7574 6573 2074 6865 2066 6c6f 7720  ibutes the flow 
+00018820: 7661 6c75 6573 2061 730d 0a20 2020 2020  values as..     
+00018830: 2020 206e 756d 6572 6963 616c 2076 616c     numerical val
+00018840: 7565 732e 2046 6f72 2069 6e73 7461 6e63  ues. For instanc
+00018850: 6520 6361 6e20 6265 2072 616e 6765 6420  e can be ranged 
+00018860: 6173 2061 2074 7570 6c65 206f 6620 626f  as a tuple of bo
+00018870: 756e 6473 200d 0a20 2020 2020 2020 2061  unds ..        a
+00018880: 7320 6265 6c6f 7720 3a3a 200d 0a20 2020  s below :: ..   
+00018890: 200d 0a20 2020 2020 2020 2020 2020 2066   ..            f
+000188a0: 6c6f 775f 7661 6c75 6573 3d20 5b30 2e30  low_values= [0.0
+000188b0: 2c20 5b30 2e30 2c20 332e 305d 2c20 5b33  , [0.0, 3.0], [3
+000188c0: 2e30 2c20 362e 305d 2c20 5b36 2e30 2c20  .0, 6.0], [6.0, 
+000188d0: 3130 2e30 5d2c 2031 302e 305d 2028 3129  10.0], 10.0] (1)
+000188e0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+000188f0: 2020 2020 2020 2020 6f72 2069 7420 6361          or it ca
+00018900: 6e20 616c 736f 2061 6363 6570 7420 7468  n also accept th
+00018910: 6520 6c69 7374 206f 6620 696e 7465 6765  e list of intege
+00018920: 7220 6c61 6265 6c20 6964 656e 7469 6669  r label identifi
+00018930: 6572 7320 6173 3a3a 0d0a 2020 2020 2020  ers as::..      
+00018940: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00018950: 2020 2020 666c 6f77 5f76 616c 7565 7320      flow_values 
+00018960: 3d5b 302e 202c 2033 2e2c 2036 2e2c 2031  =[0. , 3., 6., 1
+00018970: 302e 5d20 2832 290d 0a20 2020 2020 2020  0.] (2)..       
+00018980: 200d 0a20 2020 2020 2020 2046 6f72 2069   ..        For i
+00018990: 6e73 7461 6e63 6520 7275 6e69 6e67 2074  nstance runing t
+000189a0: 6865 2073 7465 7020 2832 2920 7368 6f75  he step (2) shou
+000189b0: 6420 636f 6e76 6572 7420 7468 6520 666c  d convert the fl
+000189c0: 6f77 2072 6174 6520 626f 756e 6473 2074  ow rate bounds t
+000189d0: 6f20 0d0a 2020 2020 2020 2020 7265 6163  o ..        reac
+000189e0: 6820 7468 6520 7374 6570 2028 3129 2e20  h the step (1). 
+000189f0: 5468 6520 6172 7261 6e67 656d 656e 7420  The arrangement 
+00018a00: 6f66 2074 6865 2066 6c6f 7720 7261 7465  of the flow rate
+00018a10: 206f 6265 7973 2073 6f6d 6520 6372 6974   obeys some crit
+00018a20: 6572 6961 200d 0a20 2020 2020 2020 2077  eria ..        w
+00018a30: 6869 6368 2064 6570 656e 6420 6f66 2074  hich depend of t
+00018a40: 6865 2074 7970 6573 206f 6620 6879 6472  he types of hydr
+00018a50: 6175 6c69 6320 7379 7374 656d 2072 6571  aulic system req
+00018a60: 7569 7265 6420 6163 636f 7264 696e 6720  uired according 
+00018a70: 746f 2074 6865 0d0a 2020 2020 2020 2020  to the..        
+00018a80: 6e75 6d62 6572 206f 6620 696e 6861 6269  number of inhabi
+00018a90: 7461 6e74 7320 6c69 7669 6e67 206f 6e20  tants living on 
+00018aa0: 6120 7375 7276 6579 206c 6f63 616c 6974  a survey localit
+00018ab0: 792f 7669 6c6c 6167 6573 206f 7220 746f  y/villages or to
+00018ac0: 776e 2e0d 0a20 2020 2020 2020 2054 6865  wn...        The
+00018ad0: 2063 6f6d 6d6f 6e20 7265 7175 6573 7420   common request 
+00018ae0: 666c 6f77 2072 6174 6520 6475 7269 6e67  flow rate during
+00018af0: 2074 6865 2063 616d 7061 6967 6e73 2066   the campaigns f
+00018b00: 6f72 2064 7269 6e6c 696e 6720 0d0a 2020  or drinling ..  
+00018b10: 2020 2020 2020 7761 7465 7220 7375 7070        water supp
+00018b20: 6c79 2063 616e 2062 6520 206f 7267 616e  ly can be  organ
+00018b30: 697a 6564 2061 7320 666f 6c6c 6f77 3a20  ized as follow: 
+00018b40: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+00018b50: 2020 2020 2020 2020 2020 2020 666c 6f77              flow
+00018b60: 5f76 616c 7565 7320 3d5b 302c 2020 312c  _values =[0,  1,
+00018b70: 2020 3320 2c20 3130 2020 5d0d 0a20 2020    3 , 10  ]..   
+00018b80: 2020 2020 2020 2020 2063 6c61 7373 6573           classes
+00018b90: 203d 205b 2746 5230 272c 2027 4652 3127   = ['FR0', 'FR1'
+00018ba0: 2c20 2746 5232 272c 2027 4652 3327 5d0d  , 'FR2', 'FR3'].
+00018bb0: 0a20 2020 200d 0a20 2020 2020 2020 2077  .    ..        w
+00018bc0: 6865 7265 203a 0d0a 2020 2020 2020 2020  here :..        
+00018bd0: 2020 2020 2d20 6060 4652 3060 6020 6571      - ``FR0`` eq
+00018be0: 7561 6c73 2074 6f20 7661 6c75 6573 203d  uals to values =
+00018bf0: 3020 202d 3e20 6472 7920 626f 7265 686f  0  -> dry boreho
+00018c00: 6c65 7320 0d0a 2020 2020 2020 2020 2020  les ..          
+00018c10: 2020 2d20 6060 4652 3160 6020 6571 7561    - ``FR1`` equa
+00018c20: 6c73 2074 6f20 7661 6c75 6573 2062 6574  ls to values bet
+00018c30: 7765 656e 2020 302d 3128 303c 2076 616c  ween  0-1(0< val
+00018c40: 7565 3c3d 3129 2066 6f72 2056 696c 6c61  ue<=1) for Villa
+00018c50: 6765 200d 0a20 2020 2020 2020 2020 2020  ge ..           
+00018c60: 2020 2020 2068 7964 7261 756c 6963 2073       hydraulic s
+00018c70: 7973 7465 6d73 2028 5648 290d 0a20 2020  ystems (VH)..   
+00018c80: 2020 2020 2020 2020 202d 2060 6046 5232           - ``FR2
+00018c90: 6060 2065 7175 616c 7320 746f 2076 616c  `` equals to val
+00018ca0: 7565 7320 6265 7477 6565 6e20 2031 2d31  ues between  1-1
+00018cb0: 2028 313c 2076 616c 7565 3c3d 3329 2066   (1< value<=3) f
+00018cc0: 6f72 2069 6d70 726f 7665 6420 200d 0a20  or improved  .. 
+00018cd0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00018ce0: 696c 6c61 6765 2068 7964 7261 756c 6963  illage hydraulic
+00018cf0: 2073 7973 7465 6d20 2849 5648 290d 0a20   system (IVH).. 
+00018d00: 2020 2020 2020 2020 2020 202d 2060 6046             - ``F
+00018d10: 5233 6060 2067 7265 6174 6865 7220 7468  R3`` greather th
+00018d20: 616e 2033 2028 3e33 2920 666f 7220 7572  an 3 (>3) for ur
+00018d30: 6261 6e20 6879 6472 6175 6c69 6320 7379  ban hydraulic sy
+00018d40: 7374 656d 2028 5548 290d 0a20 2020 2020  stem (UH)..     
+00018d50: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00018d60: 2020 2020 2052 6566 6572 2074 6f20 5b31       Refer to [1
+00018d70: 5d5f 2066 6f72 206d 6f72 6520 6465 7461  ]_ for more deta
+00018d80: 696c 732e 200d 0a20 2020 2020 2020 200d  ils. ..        .
+00018d90: 0a20 2020 2063 6c61 7373 6573 3a20 6c69  .    classes: li
+00018da0: 7374 206f 6620 7374 7220 2c20 0d0a 2020  st of str , ..  
+00018db0: 2020 2020 2020 6c69 7465 7261 6c20 6c61        literal la
+00018dc0: 6265 6c73 206f 6620 6361 7465 676f 7269  bels of categori
+00018dd0: 7a65 6420 666c 6f77 2072 6174 6573 2e20  zed flow rates. 
+00018de0: 4966 2067 6976 656e 2c20 7368 6f75 6c64  If given, should
+00018df0: 2062 6520 0d0a 2020 2020 2020 2020 636f   be ..        co
+00018e00: 6e73 6973 7465 6e74 2077 6974 6820 7468  nsistent with th
+00018e10: 6520 7369 7a65 206f 6620 6066 6c6f 775f  e size of `flow_
+00018e20: 7661 6c75 6573 6027 0d0a 2020 2020 0d0a  values`'..    ..
+00018e30: 2020 2020 2020 2020 0d0a 2020 2020 5265          ..    Re
+00018e40: 7475 726e 7320 0d0a 2020 2020 2d2d 2d2d  turns ..    ----
+00018e50: 2d2d 2d2d 2d0d 0a20 2020 2028 6e65 775f  -----..    (new_
+00018e60: 666c 6f77 5f76 616c 7565 732c 2074 6172  flow_values, tar
+00018e70: 6765 742c 2063 6c61 7373 6573 290d 0a20  get, classes).. 
+00018e80: 2020 2020 2020 202d 2060 606e 6577 5f66         - ``new_f
+00018e90: 6c6f 775f 7661 6c75 6573 6060 3a20 4974  low_values``: It
+00018ea0: 6572 6162 6c65 206f 626a 6563 7420 6173  erable object as
+00018eb0: 2074 7970 6520 2832 2920 0d0a 2020 2020   type (2) ..    
+00018ec0: 2020 2020 2d20 6060 7461 7267 6574 6060      - ``target``
+00018ed0: 3a20 5261 7720 666c 6f77 2069 7465 7261  : Raw flow itera
+00018ee0: 626c 6520 6f62 6a65 6374 2074 6f20 6265  ble object to be
+00018ef0: 2063 6174 6567 6f72 697a 6564 0d0a 2020   categorized..  
+00018f00: 2020 2020 2020 2d20 6060 636c 6173 7365        - ``classe
+00018f10: 7360 603a 2049 6620 6769 7665 6e20 2c20  s``: If given , 
+00018f20: 7365 6520 6060 636c 6173 7365 7360 6020  see ``classes`` 
+00018f30: 7061 7261 6d73 2e20 0d0a 2020 2020 2020  params. ..      
+00018f40: 2020 2020 2020 0d0a 2020 2020 5265 6665        ..    Refe
+00018f50: 7265 6e63 6573 200d 0a20 2020 202d 2d2d  rences ..    ---
+00018f60: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00018f70: 2e2e 205b 315d 204b 6f75 6164 696f 2c20  .. [1] Kouadio, 
+00018f80: 4b2e 4c2e 2c20 4b6f 7561 6d65 2c20 4c2e  K.L., Kouame, L.
+00018f90: 4e2e 2c20 4472 6973 7361 2c20 432e 2c20  N., Drissa, C., 
+00018fa0: 4d69 2c20 422e 2c20 4b6f 7561 6d65 6c61  Mi, B., Kouamela
+00018fb0: 6e2c 204b 2e53 2e2c 200d 0a20 2020 2020  n, K.S., ..     
+00018fc0: 2020 2047 6e6f 6c65 6261 2c20 532e 502e     Gnoleba, S.P.
+00018fd0: 442e 2c20 5a68 616e 672c 2048 2e2c 2065  D., Zhang, H., e
+00018fe0: 7420 616c 2e20 2832 3032 3229 2047 726f  t al. (2022) Gro
+00018ff0: 756e 6477 6174 6572 2046 6c6f 7720 5261  undwater Flow Ra
+00019000: 7465 200d 0a20 2020 2020 2020 2050 7265  te ..        Pre
+00019010: 6469 6374 696f 6e20 6672 6f6d 2047 656f  diction from Geo
+00019020: e280 9045 6c65 6374 7269 6361 6c20 4665  ...Electrical Fe
+00019030: 6174 7572 6573 2075 7369 6e67 2053 7570  atures using Sup
+00019040: 706f 7274 2056 6563 746f 7220 4d61 6368  port Vector Mach
+00019050: 696e 6573 2e20 0d0a 2020 2020 2020 2020  ines. ..        
+00019060: 5761 7465 7220 5265 736f 7572 2e20 5265  Water Resour. Re
+00019070: 732e 203a 646f 693a 6031 302e 3130 3239  s. :doi:`10.1029
+00019080: 2f32 3032 3177 7230 3331 3632 3360 0d0a  /2021wr031623`..
+00019090: 2020 2020 2020 2020 0d0a 2020 2020 2e2e          ..    ..
+000190a0: 205b 325d 204b 7261 2c20 4b2e 4a2e 2c20   [2] Kra, K.J., 
+000190b0: 4b6f 6666 692c 2059 2e53 2e4b 2e2c 2041  Koffi, Y.S.K., A
+000190c0: 6c6c 612c 204b 2e41 2e20 2620 4b6f 7561  lla, K.A. & Koua
+000190d0: 6469 6f2c 2041 2e46 2e20 2832 3031 3629  dio, A.F. (2016)
+000190e0: 2050 726f 6a65 7473 200d 0a20 2020 2020   Projets ..     
+000190f0: 2020 2064 e280 99c3 a96d 6572 6765 6e63     d.....mergenc
+00019100: 6520 706f 7374 2d63 7269 7365 2065 7420  e post-crise et 
+00019110: 6469 7370 6172 6974 c3a9 2074 6572 7269  disparit.. terri
+00019120: 746f 7269 616c 6520 656e 2043 c3b4 7465  toriale en C..te
+00019130: 2064 e280 9949 766f 6972 652e 200d 0a20   d...Ivoire. .. 
+00019140: 2020 2020 2020 204c 6573 2043 6168 2e20         Les Cah. 
+00019150: 6475 2043 454c 4854 4f2c 2032 2c20 3630  du CELHTO, 2, 60
+00019160: 38e2 8093 3632 342e 0d0a 2020 2020 2020  8...624...      
+00019170: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
+00019180: 2020 2222 220d 0a20 2020 2063 6c61 7373    """..    class
+00019190: 6573 203d 2020 6b77 6172 6773 2e70 6f70  es =  kwargs.pop
+000191a0: 2827 636c 6173 7365 7327 2c20 4e6f 6e65  ('classes', None
+000191b0: 290d 0a0d 0a20 2020 206e 6577 5f66 6c6f  )....    new_flo
+000191c0: 775f 7661 6c75 6573 203d 205b 5d0d 0a20  w_values = [].. 
+000191d0: 2020 2069 6e73 6964 655f 696e 7465 725f     inside_inter_
+000191e0: 666c 6167 3d20 4661 6c73 650d 0a20 2020  flag= False..   
+000191f0: 200d 0a20 2020 2069 6620 6973 696e 7374   ..    if isinst
+00019200: 616e 6365 2866 6c6f 775f 7661 6c75 6573  ance(flow_values
+00019210: 2c20 2874 7570 6c65 2c20 6e70 2e6e 6461  , (tuple, np.nda
+00019220: 7272 6179 2929 3a20 0d0a 2020 2020 2020  rray)): ..      
+00019230: 2020 666c 6f77 5f76 616c 7565 7320 3d6c    flow_values =l
+00019240: 6973 7428 666c 6f77 5f76 616c 7565 7329  ist(flow_values)
+00019250: 0d0a 2020 2020 2320 4c6f 6f70 2061 6e64  ..    # Loop and
+00019260: 2066 696e 6420 0d0a 2020 2020 666f 7220   find ..    for 
+00019270: 6a6a 2c20 5f69 7465 7220 696e 2065 6e75  jj, _iter in enu
+00019280: 6d65 7261 7465 2866 6c6f 775f 7661 6c75  merate(flow_valu
+00019290: 6573 2920 3a20 0d0a 2020 2020 2020 2020  es) : ..        
+000192a0: 6966 2069 7369 6e73 7461 6e63 6528 5f69  if isinstance(_i
+000192b0: 7465 722c 2028 6c69 7374 2c20 7475 706c  ter, (list, tupl
+000192c0: 652c 206e 702e 6e64 6172 7261 7929 293a  e, np.ndarray)):
+000192d0: 200d 0a20 2020 2020 2020 2020 2020 2069   ..            i
+000192e0: 6e73 6964 655f 696e 7465 725f 666c 6167  nside_inter_flag
+000192f0: 203d 2054 7275 6520 0d0a 2020 2020 2020   = True ..      
+00019300: 2020 2020 2020 666c 6f77 5f76 616c 7565        flow_value
+00019310: 735b 6a6a 5d3d 206c 6973 7428 5f69 7465  s[jj]= list(_ite
+00019320: 7229 0d0a 200d 0a20 2020 2069 6620 696e  r).. ..    if in
+00019330: 7369 6465 5f69 6e74 6572 5f66 6c61 673a  side_inter_flag:
+00019340: 200d 0a20 2020 2020 2020 206e 6577 5f66   ..        new_f
+00019350: 6c6f 775f 7661 6c75 6573 203d 666c 6f77  low_values =flow
+00019360: 5f76 616c 7565 7320 0d0a 2020 2020 0d0a  _values ..    ..
+00019370: 2020 2020 6966 2069 6e73 6964 655f 696e      if inside_in
+00019380: 7465 725f 666c 6167 2069 7320 4661 6c73  ter_flag is Fals
+00019390: 653a 200d 0a20 2020 2020 2020 2066 6c6f  e: ..        flo
+000193a0: 775f 7661 6c75 6573 3d20 736f 7274 6564  w_values= sorted
+000193b0: 2866 6c6f 775f 7661 6c75 6573 290d 0a20  (flow_values).. 
+000193c0: 2020 2020 2020 2023 2069 6620 302e 2069         # if 0. i
+000193d0: 6e20 666c 6f77 5f76 616c 7565 7320 3a20  n flow_values : 
+000193e0: 0d0a 2020 2020 2020 2020 2320 2020 2020  ..        #     
+000193f0: 6e65 775f 666c 6f77 5f76 616c 7565 732e  new_flow_values.
+00019400: 6170 7065 6e64 2830 2e29 200d 0a20 2020  append(0.) ..   
+00019410: 2020 2020 2066 6f72 2073 732c 2076 616c       for ss, val
+00019420: 2069 6e20 656e 756d 6572 6174 6528 666c   in enumerate(fl
+00019430: 6f77 5f76 616c 7565 7329 203a 200d 0a20  ow_values) : .. 
+00019440: 2020 2020 2020 2020 2020 2069 6620 7373             if ss
+00019450: 203d 3d30 203a 200d 0a20 2020 2020 2020   ==0 : ..       
+00019460: 2020 2020 2020 2020 2023 6170 7065 6e64           #append
+00019470: 2061 6c77 6179 7320 7468 6520 6669 7273   always the firs
+00019480: 7420 7661 6c75 6573 2e20 0d0a 2020 2020  t values. ..    
+00019490: 2020 2020 2020 2020 2020 2020 206e 6577               new
+000194a0: 5f66 6c6f 775f 7661 6c75 6573 2e61 7070  _flow_values.app
+000194b0: 656e 6428 7661 6c29 200d 0a20 2020 2020  end(val) ..     
+000194c0: 2020 2020 2020 2023 2069 6620 7661 6c20         # if val 
+000194d0: 213d 302e 203a 200d 0a20 2020 2020 2020  !=0. : ..       
+000194e0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+000194f0: 2020 2020 2020 2020 2020 2020 6966 2076              if v
+00019500: 616c 203d 3d66 6c6f 775f 7661 6c75 6573  al ==flow_values
+00019510: 5b2d 315d 3a20 0d0a 2020 2020 2020 2020  [-1]: ..        
+00019520: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+00019530: 666c 6f77 5f76 616c 7565 732e 6170 7065  flow_values.appe
+00019540: 6e64 285b 666c 6f77 5f76 616c 7565 735b  nd([flow_values[
+00019550: 7373 2d31 5d2c 2076 616c 5d29 0d0a 2020  ss-1], val])..  
+00019560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019570: 2020 6e65 775f 666c 6f77 5f76 616c 7565    new_flow_value
+00019580: 732e 6170 7065 6e64 2876 616c 290d 0a20  s.append(val).. 
+00019590: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000195a0: 6c73 653a 200d 0a20 2020 2020 2020 2020  lse: ..         
+000195b0: 2020 2020 2020 2020 2020 6e65 775f 666c            new_fl
+000195c0: 6f77 5f76 616c 7565 732e 6170 7065 6e64  ow_values.append
+000195d0: 285b 666c 6f77 5f76 616c 7565 735b 7373  ([flow_values[ss
+000195e0: 2d31 5d2c 2076 616c 5d29 0d0a 200d 0a20  -1], val]).. .. 
+000195f0: 2020 2072 6574 7572 6e20 6e65 775f 666c     return new_fl
+00019600: 6f77 5f76 616c 7565 732c 2074 6172 6765  ow_values, targe
+00019610: 742c 2063 6c61 7373 6573 2020 2020 2020  t, classes      
+00019620: 2020 0d0a 0d0a 4077 7269 7465 6628 7265    ....@writef(re
+00019630: 6173 6f6e 3d27 7772 6974 6527 2c20 6672  ason='write', fr
+00019640: 6f6d 5f3d 2764 6627 290d 0a64 6566 2065  om_='df')..def e
+00019650: 7870 6f72 7464 6620 280d 0a20 2020 2064  xportdf (..    d
+00019660: 6620 3a20 4461 7461 4672 616d 6520 3d4e  f : DataFrame =N
+00019670: 6f6e 652c 0d0a 2020 2020 7265 666f 7574  one,..    refout
+00019680: 3a20 4f70 7469 6f6e 616c 205b 7374 725d  : Optional [str]
+00019690: 203d 4e6f 6e65 2c20 0d0a 2020 2020 746f   =None, ..    to
+000196a0: 3a20 4f70 7469 6f6e 616c 205b 7374 725d  : Optional [str]
+000196b0: 203d 4e6f 6e65 2c20 0d0a 2020 2020 7361   =None, ..    sa
+000196c0: 7665 7061 7468 3a4f 7074 696f 6e61 6c20  vepath:Optional 
+000196d0: 5b73 7472 5d20 3d4e 6f6e 652c 0d0a 2020  [str] =None,..  
+000196e0: 2020 6d6f 646e 616d 653a 2073 7472 2020    modname: str  
+000196f0: 3d27 5f77 6578 706f 7274 6564 5f27 2c20  ='_wexported_', 
+00019700: 0d0a 2020 2020 7265 7365 745f 696e 6465  ..    reset_inde
+00019710: 783a 2062 6f6f 6c20 3d54 7275 650d 0a29  x: bool =True..)
+00019720: 202d 3e20 5475 706c 6520 5b44 6174 6146   -> Tuple [DataF
+00019730: 7261 6d65 2c20 556e 696f 6e5b 7374 722c  rame, Union[str,
+00019740: 2073 7472 5d2c 2062 6f6f 6c20 5d3a 200d   str], bool ]: .
+00019750: 0a20 2020 2022 2222 200d 0a20 2020 2045  .    """ ..    E
+00019760: 7870 6f72 7420 6461 7461 6672 616d 6520  xport dataframe 
+00019770: 6060 6466 6060 2020 746f 2060 7265 666f  ``df``  to `refo
+00019780: 7574 6020 6669 6c65 732e 200d 0a20 2020  ut` files. ..   
+00019790: 200d 0a20 2020 2060 7265 666f 7574 6020   ..    `refout` 
+000197a0: 6669 6c65 2063 616e 2062 6520 4578 6365  file can be Exce
+000197b0: 6c6c 2073 6865 6574 2066 696c 6520 6f72  ll sheet file or
+000197c0: 2027 2e6a 736f 6e27 2066 696c 652e 2054   '.json' file. T
+000197d0: 6f20 6765 7420 6d6f 7265 2064 6574 6169  o get more detai
+000197e0: 6c73 200d 0a20 2020 2061 626f 7574 2074  ls ..    about t
+000197f0: 6865 2060 7772 6974 6566 6020 6465 636f  he `writef` deco
+00019800: 7261 746f 7220 2c20 7365 6520 3a64 6f63  rator , see :doc
+00019810: 3a60 7761 7465 782e 7574 696c 732e 6465  :`watex.utils.de
+00019820: 636f 7261 746f 722e 7772 6974 6566 602e  corator.writef`.
+00019830: 200d 0a20 2020 200d 0a20 2020 203a 7061   ..    ..    :pa
+00019840: 7261 6d20 7265 666f 7574 3a20 0d0a 2020  ram refout: ..  
+00019850: 2020 2020 2020 4f75 7470 7574 2066 696c        Output fil
+00019860: 656e 616d 652e 2049 6620 6e6f 7420 6769  ename. If not gi
+00019870: 7665 6e20 7769 6c6c 2062 6520 6372 6561  ven will be crea
+00019880: 7465 6420 7265 6665 7269 6e67 2074 6f20  ted refering to 
+00019890: 7468 6520 0d0a 2020 2020 2020 2020 6578  the ..        ex
+000198a0: 706f 7274 6564 2064 6174 652e 200d 0a20  ported date. .. 
+000198b0: 2020 2020 2020 200d 0a20 2020 203a 7061         ..    :pa
+000198c0: 7261 6d20 746f 3a20 4578 706f 7274 2074  ram to: Export t
+000198d0: 7970 653b 2043 616e 2062 6520 602e 786c  ype; Can be `.xl
+000198e0: 7378 6020 2c20 602e 6373 7660 2c20 602e  sx` , `.csv`, `.
+000198f0: 6a73 6f6e 6020 616e 6420 656c 7365 2e0d  json` and else..
+00019900: 0a20 2020 2020 2020 0d0a 2020 2020 3a70  .       ..    :p
+00019910: 6172 616d 2073 6176 6570 6174 683a 200d  aram savepath: .
+00019920: 0a20 2020 2020 2020 2050 6174 6820 746f  .        Path to
+00019930: 2073 6176 6520 7468 6520 6072 6566 6f75   save the `refou
+00019940: 7460 2066 696c 656e 616d 652e 2049 6620  t` filename. If 
+00019950: 6e6f 7420 6769 7665 6e0d 0a20 2020 2020  not given..     
+00019960: 2020 2077 696c 6c20 6265 2063 7265 6174     will be creat
+00019970: 6564 2e0d 0a20 2020 203a 7061 7261 6d20  ed...    :param 
+00019980: 6d6f 646e 616d 653a 2046 6f6c 6465 7220  modname: Folder 
+00019990: 746f 2068 6f6c 6420 7468 6520 6072 6566  to hold the `ref
+000199a0: 6f75 7460 2066 696c 652e 2043 6861 6e67  out` file. Chang
+000199b0: 6520 6974 2061 6363 6f72 6469 6e67 6c79  e it accordingly
+000199c0: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
+000199d0: 203a 7265 7475 726e 733a 200d 0a20 2020   :returns: ..   
+000199e0: 2020 2020 202d 2060 6466 5f60 3a20 6e65       - `df_`: ne
+000199f0: 7720 6461 7461 6672 616d 6520 746f 2062  w dataframe to b
+00019a00: 6520 6578 706f 7274 6564 2e20 0d0a 2020  e exported. ..  
+00019a10: 2020 2020 2020 0d0a 2020 2020 2222 220d        ..    """.
+00019a20: 0a20 2020 2069 6620 6466 2069 7320 4e6f  .    if df is No
+00019a30: 6e65 203a 0d0a 2020 2020 2020 2020 7761  ne :..        wa
+00019a40: 726e 696e 6773 2e77 6172 6e28 0d0a 2020  rnings.warn(..  
+00019a50: 2020 2020 2020 2020 2020 274f 6e63 6520            'Once 
+00019a60: 6060 6466 6060 2061 7267 756d 656e 7473  ``df`` arguments
+00019a70: 2069 6e20 6465 636f 7261 746f 7220 3a60   in decorator :`
+00019a80: 636c 6173 733a 7e64 6563 6f72 6174 6f72  class:~decorator
+00019a90: 2e77 7269 7465 6660 270d 0a20 2020 2020  .writef`'..     
+00019aa0: 2020 2020 2020 2027 2069 7320 7365 6c65         ' is sele
+00019ab0: 6374 6564 2e20 5468 6520 6d61 696e 2074  cted. The main t
+00019ac0: 7970 6520 6f66 2066 696c 6520 7265 6164  ype of file read
+00019ad0: 7920 746f 2062 6520 7772 6974 7465 6e20  y to be written 
+00019ae0: 4d55 5354 2062 6520 270d 0a20 2020 2020  MUST be '..     
+00019af0: 2020 2020 2020 2027 6120 7064 2e44 6174         'a pd.Dat
+00019b00: 6146 7261 6d65 2066 6f72 6d61 742e 2049  aFrame format. I
+00019b10: 6620 6e6f 7420 616e 2065 7272 6f72 2072  f not an error r
+00019b20: 6169 7365 732e 2050 6c65 6173 6520 7265  aises. Please re
+00019b30: 6665 7220 746f 2027 0d0a 2020 2020 2020  fer to '..      
+00019b40: 2020 2020 2020 273a 646f 633a 607e 2e75        ':doc:`~.u
+00019b50: 7469 6c73 2e64 6563 6f72 6174 6f72 2e77  tils.decorator.w
+00019b60: 7269 7465 6660 2066 6f72 206d 6f72 6520  ritef` for more 
+00019b70: 6465 7461 696c 732e 2729 0d0a 2020 2020  details.')..    
+00019b80: 2020 2020 0d0a 2020 2020 2020 2020 7261      ..        ra
+00019b90: 6973 6520 4669 6c65 4861 6e64 6c69 6e67  ise FileHandling
+00019ba0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+00019bb0: 2020 2020 274e 6f20 6461 7461 6672 616d      'No datafram
+00019bc0: 6520 6465 7465 6374 6564 2e20 506c 6561  e detected. Plea
+00019bd0: 7365 2070 726f 7669 6465 6420 796f 7572  se provided your
+00019be0: 2064 6174 6146 7261 6d65 2e27 290d 0a0d   dataFrame.')...
+00019bf0: 0a20 2020 2064 665f 203d 6466 2e63 6f70  .    df_ =df.cop
+00019c00: 7928 6465 6570 3d54 7275 6529 0d0a 2020  y(deep=True)..  
+00019c10: 2020 6966 2072 6573 6574 5f69 6e64 6578    if reset_index
+00019c20: 2069 7320 5472 7565 203a 200d 0a20 2020   is True : ..   
+00019c30: 2020 2020 2064 665f 2e72 6573 6574 5f69       df_.reset_i
+00019c40: 6e64 6578 2869 6e70 6c61 6365 203d 5472  ndex(inplace =Tr
+00019c50: 7565 290d 0a20 2020 2069 6620 7361 7665  ue)..    if save
+00019c60: 7061 7468 2069 7320 4e6f 6e65 203a 0d0a  path is None :..
+00019c70: 2020 2020 2020 2020 7361 7665 7061 7468          savepath
+00019c80: 203d 2073 6176 6570 6174 685f 286d 6f64   = savepath_(mod
+00019c90: 6e61 6d65 290d 0a20 2020 2020 2020 200d  name)..        .
+00019ca0: 0a20 2020 2072 6574 7572 6e20 6466 5f2c  .    return df_,
+00019cb0: 2074 6f2c 2020 7265 666f 7574 2c20 7361   to,  refout, sa
+00019cc0: 7665 7061 7468 2c20 7265 7365 745f 696e  vepath, reset_in
+00019cd0: 6465 7820 2020 0d0a 0d0a 6465 6620 6361  dex   ....def ca
+00019ce0: 7465 676f 7269 7a65 5f74 6172 6765 7428  tegorize_target(
+00019cf0: 0d0a 2020 2020 2020 2020 6172 7220 3a41  ..        arr :A
+00019d00: 7272 6179 4c69 6b65 207c 5365 7269 6573  rrayLike |Series
+00019d10: 202c 202f 2c20 0d0a 2020 2020 2020 2020   , /, ..        
+00019d20: 6675 6e63 3a20 4620 3d20 4e6f 6e65 2c20  func: F = None, 
+00019d30: 200d 0a20 2020 2020 2020 206c 6162 656c   ..        label
+00019d40: 733a 2069 6e74 207c 204c 6973 745b 696e  s: int | List[in
+00019d50: 745d 203d 204e 6f6e 652c 200d 0a20 2020  t] = None, ..   
+00019d60: 2020 2020 2072 656e 616d 655f 6c61 6265       rename_labe
+00019d70: 6c73 3a20 4f70 7469 6f6e 616c 5b73 7472  ls: Optional[str
+00019d80: 5d20 3d20 4e6f 6e65 2c20 0d0a 2020 2020  ] = None, ..    
+00019d90: 2020 2020 636f 6572 6365 3a62 6f6f 6c3d      coerce:bool=
+00019da0: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
+00019db0: 6f72 6465 723a 7374 723d 2773 7472 6963  order:str='stric
+00019dc0: 7427 2c0d 0a20 2020 2020 2020 2029 3a20  t',..        ): 
+00019dd0: 0d0a 2020 2020 2222 2220 4361 7465 676f  ..    """ Catego
+00019de0: 7269 7a65 2061 7272 6179 2074 6f20 686f  rize array to ho
+00019df0: 6c64 2074 6865 2067 6976 656e 2069 6465  ld the given ide
+00019e00: 6e74 6966 6965 7220 6c61 6265 6c73 2e20  ntifier labels. 
+00019e10: 0d0a 2020 2020 0d0a 2020 2020 436c 6173  ..    ..    Clas
+00019e20: 7369 6669 6572 206e 756d 6572 6963 616c  sifier numerical
+00019e30: 2076 616c 7565 7320 6163 636f 7264 696e   values accordin
+00019e40: 6720 746f 2074 6865 2067 6976 656e 206c  g to the given l
+00019e50: 6162 656c 2076 616c 7565 732e 204c 6162  abel values. Lab
+00019e60: 656c 7320 0d0a 2020 2020 6172 6520 6120  els ..    are a 
+00019e70: 6c69 7374 206f 6620 696e 7465 6765 7273  list of integers
+00019e80: 2077 6865 7265 2065 6163 6820 696e 7465   where each inte
+00019e90: 6765 7220 6973 2061 2067 726f 7570 206f  ger is a group o
+00019ea0: 6620 756e 6971 7565 2069 6465 6e74 6966  f unique identif
+00019eb0: 6965 7220 200d 0a20 2020 206f 6620 6120  ier  ..    of a 
+00019ec0: 7361 6d70 6c65 2069 6e20 7468 6520 6461  sample in the da
+00019ed0: 7461 7365 742e 200d 0a20 2020 200d 0a20  taset. ..    .. 
+00019ee0: 2020 2050 6172 616d 6574 6572 7320 0d0a     Parameters ..
+00019ef0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d      -----------.
+00019f00: 0a20 2020 2061 7272 3a20 6172 7261 792d  .    arr: array-
+00019f10: 6c69 6b65 207c 7061 6e64 6173 2e53 6572  like |pandas.Ser
+00019f20: 6965 7320 0d0a 2020 2020 2020 2020 6172  ies ..        ar
+00019f30: 7261 7920 6f72 2073 6572 6965 7320 636f  ray or series co
+00019f40: 6e74 6169 6e69 6e67 206e 756d 6572 6963  ntaining numeric
+00019f50: 616c 2076 616c 7565 732e 2049 6620 6120  al values. If a 
+00019f60: 6e6f 6e2d 6e75 6d65 7269 6361 6c20 7661  non-numerical va
+00019f70: 6c75 6573 200d 0a20 2020 2020 2020 2069  lues ..        i
+00019f80: 7320 6769 7665 6e20 2c20 616e 2065 7272  s given , an err
+00019f90: 6f72 7320 7769 6c6c 2072 6169 7365 732e  ors will raises.
+00019fa0: 200d 0a20 2020 2066 756e 633a 2043 616c   ..    func: Cal
+00019fb0: 6c61 626c 652c 200d 0a20 2020 2020 2020  lable, ..       
+00019fc0: 2046 756e 6374 696f 6e20 746f 2063 6174   Function to cat
+00019fd0: 6567 6f72 697a 6520 7468 6520 7461 7267  egorize the targ
+00019fe0: 6574 2079 2e20 200d 0a20 2020 206c 6162  et y.  ..    lab
+00019ff0: 656c 733a 2069 6e74 2c20 6c69 7374 206f  els: int, list o
+0001a000: 6620 696e 742c 200d 0a20 2020 2020 2020  f int, ..       
+0001a010: 2069 6620 616e 2069 6e74 6567 6572 2076   if an integer v
+0001a020: 616c 7565 2069 7320 6769 7665 6e2c 2069  alue is given, i
+0001a030: 7420 7368 6f75 6c64 2062 6520 636f 6e73  t should be cons
+0001a040: 6964 6572 6564 2061 7320 7468 6520 6e75  idered as the nu
+0001a050: 6d62 6572 200d 0a20 2020 2020 2020 206f  mber ..        o
+0001a060: 6620 6361 7465 676f 7279 2074 6f20 7370  f category to sp
+0001a070: 6c69 7420 2779 272e 2046 6f72 2069 6e73  lit 'y'. For ins
+0001a080: 7461 6e63 6520 6060 6c61 6265 6c3d 3360  tance ``label=3`
+0001a090: 6020 616e 6420 6170 706c 6965 6420 6f6e  ` and applied on
+0001a0a0: 200d 0a20 2020 2020 2020 2074 6865 2066   ..        the f
+0001a0b0: 6972 7374 2074 656e 206e 756d 6265 722c  irst ten number,
+0001a0c0: 2074 6865 206c 6162 656c 7320 7661 6c75   the labels valu
+0001a0d0: 6573 2073 686f 756c 6420 6265 2060 605b  es should be ``[
+0001a0e0: 302c 2031 2c20 325d 6060 2e20 0d0a 2020  0, 1, 2]``. ..  
+0001a0f0: 2020 2020 2020 4966 206c 6162 656c 7320        If labels 
+0001a100: 6172 6520 6769 7665 6e20 6173 2061 206c  are given as a l
+0001a110: 6973 742c 2069 7465 6d73 206d 7573 7420  ist, items must 
+0001a120: 6265 2073 656c 662d 636f 6e74 6169 6e20  be self-contain 
+0001a130: 696e 2074 6865 200d 0a20 2020 2020 2020  in the ..       
+0001a140: 2074 6172 6765 7420 2779 272e 0d0a 2020   target 'y'...  
+0001a150: 2020 7265 6e61 6d65 5f6c 6162 656c 733a    rename_labels:
+0001a160: 206c 6973 7420 6f66 2073 7472 3b20 0d0a   list of str; ..
+0001a170: 2020 2020 2020 2020 6c69 7374 206f 6620          list of 
+0001a180: 7374 7269 6e67 206f 7220 7661 6c75 6573  string or values
+0001a190: 2074 6f20 7265 706c 6163 6520 7468 6520   to replace the 
+0001a1a0: 6c61 6265 6c20 696e 7465 6765 7220 6964  label integer id
+0001a1b0: 656e 7469 6669 6572 2e20 0d0a 2020 2020  entifier. ..    
+0001a1c0: 636f 6572 6365 3a20 626f 6f6c 2c20 6465  coerce: bool, de
+0001a1d0: 6661 756c 7420 3d46 616c 7365 2c20 0d0a  fault =False, ..
+0001a1e0: 2020 2020 2020 2020 666f 7263 6520 7468          force th
+0001a1f0: 6520 6e65 7720 6c61 6265 6c20 6e61 6d65  e new label name
+0001a200: 7320 7061 7373 6564 2074 6f20 6072 656e  s passed to `ren
+0001a210: 616d 655f 6c61 6265 6c73 6020 746f 2061  ame_labels` to a
+0001a220: 7070 6561 7220 696e 2074 6865 200d 0a20  ppear in the .. 
+0001a230: 2020 2020 2020 2074 6172 6765 7420 696e         target in
+0001a240: 636c 7564 696e 6720 6f72 206e 6f74 2073  cluding or not s
+0001a250: 6f6d 6520 696e 7465 6765 7220 6964 656e  ome integer iden
+0001a260: 7469 6669 6572 2063 6c61 7373 206c 6162  tifier class lab
+0001a270: 656c 2e20 4966 200d 0a20 2020 2020 2020  el. If ..       
+0001a280: 2060 636f 6572 6365 6020 6973 2060 6054   `coerce` is ``T
+0001a290: 7275 6560 602c 2074 6865 2074 6172 6765  rue``, the targe
+0001a2a0: 7420 6172 7261 7920 686f 6c64 7320 7468  t array holds th
+0001a2b0: 6520 6474 7970 6520 6f66 206e 6577 5f61  e dtype of new_a
+0001a2c0: 7272 6179 2e20 0d0a 0d0a 2020 2020 5265  rray. ....    Re
+0001a2d0: 7475 726e 0d0a 2020 2020 2d2d 2d2d 2d2d  turn..    ------
+0001a2e0: 2d2d 0d0a 2020 2020 6172 723a 2041 7272  --..    arr: Arr
+0001a2f0: 6179 6c69 6b65 207c 7061 6e64 6173 2e53  aylike |pandas.S
+0001a300: 6572 6965 730d 0a20 2020 2020 2020 2054  eries..        T
+0001a310: 6865 2063 6174 6567 6f72 7920 6172 7261  he category arra
+0001a320: 7920 7769 7468 2075 6e69 7175 6520 6964  y with unique id
+0001a330: 656e 7469 6665 7220 6c61 6265 6c73 200d  entifer labels .
+0001a340: 0a20 2020 2020 2020 200d 0a20 2020 2045  .        ..    E
+0001a350: 7861 6d70 6c65 7320 0d0a 2020 2020 2d2d  xamples ..    --
+0001a360: 2d2d 2d2d 2d2d 0d0a 0d0a 2020 2020 3e3e  ------....    >>
+0001a370: 3e20 6672 6f6d 2077 6174 6578 2e75 7469  > from watex.uti
+0001a380: 6c73 2e6d 6c75 7469 6c73 2069 6d70 6f72  ls.mlutils impor
+0001a390: 7420 6361 7474 6172 6765 7420 0d0a 2020  t cattarget ..  
+0001a3a0: 2020 3e3e 3e20 6465 6620 6269 6e66 756e    >>> def binfun
+0001a3b0: 6328 7629 3a20 0d0a 2020 2020 2020 2020  c(v): ..        
+0001a3c0: 2020 2020 6966 2076 203c 2033 203a 2072      if v < 3 : r
+0001a3d0: 6574 7572 6e20 3020 0d0a 2020 2020 2020  eturn 0 ..      
+0001a3e0: 2020 2020 2020 656c 7365 203a 2072 6574        else : ret
+0001a3f0: 7572 6e20 3120 0d0a 2020 2020 3e3e 3e20  urn 1 ..    >>> 
+0001a400: 6172 7220 3d20 6e70 2e61 7261 6e67 6520  arr = np.arange 
+0001a410: 2831 3020 290d 0a20 2020 203e 3e3e 2061  (10 )..    >>> a
+0001a420: 7272 200d 0a20 2020 202e 2e2e 2061 7272  rr ..    ... arr
+0001a430: 6179 285b 302c 2031 2c20 322c 2033 2c20  ay([0, 1, 2, 3, 
+0001a440: 342c 2035 2c20 362c 2037 2c20 382c 2039  4, 5, 6, 7, 8, 9
+0001a450: 5d29 0d0a 2020 2020 3e3e 3e20 7461 7267  ])..    >>> targ
+0001a460: 6574 203d 2063 6174 7461 7267 6574 2861  et = cattarget(a
+0001a470: 7272 2c20 6675 6e63 203d 6269 6e66 756e  rr, func =binfun
+0001a480: 6329 0d0a 2020 2020 2e2e 2e20 6172 7261  c)..    ... arra
+0001a490: 7928 5b30 2c20 302c 2030 2c20 312c 2031  y([0, 0, 0, 1, 1
+0001a4a0: 2c20 312c 2031 2c20 312c 2031 2c20 315d  , 1, 1, 1, 1, 1]
+0001a4b0: 2c20 6474 7970 653d 696e 7436 3429 0d0a  , dtype=int64)..
+0001a4c0: 2020 2020 3e3e 3e20 6361 7474 6172 6765      >>> cattarge
+0001a4d0: 7428 6172 722c 206c 6162 656c 7320 3d33  t(arr, labels =3
+0001a4e0: 2029 0d0a 2020 2020 2e2e 2e20 6172 7261   )..    ... arra
+0001a4f0: 7928 5b30 2c20 302c 2030 2c20 312c 2031  y([0, 0, 0, 1, 1
+0001a500: 2c20 312c 2032 2c20 322c 2032 2c20 325d  , 1, 2, 2, 2, 2]
+0001a510: 290d 0a20 2020 203e 3e3e 2061 7272 6179  )..    >>> array
+0001a520: 285b 322c 2032 2c20 322c 2032 2c20 312c  ([2, 2, 2, 2, 1,
+0001a530: 2031 2c20 312c 2030 2c20 302c 2030 5d29   1, 1, 0, 0, 0])
+0001a540: 200d 0a20 2020 203e 3e3e 2063 6174 7461   ..    >>> catta
+0001a550: 7267 6574 2861 7272 2c20 6c61 6265 6c73  rget(arr, labels
+0001a560: 203d 3320 2c20 6f72 6465 7220 3d4e 6f6e   =3 , order =Non
+0001a570: 6520 290d 0a20 2020 202e 2e2e 2061 7272  e )..    ... arr
+0001a580: 6179 285b 302c 2030 2c20 302c 2030 2c20  ay([0, 0, 0, 0, 
+0001a590: 312c 2031 2c20 312c 2032 2c20 322c 2032  1, 1, 1, 2, 2, 2
+0001a5a0: 5d29 0d0a 2020 2020 3e3e 3e20 6361 7474  ])..    >>> catt
+0001a5b0: 6172 6765 7428 6172 725b 3a3a 2d31 5d2c  arget(arr[::-1],
+0001a5c0: 206c 6162 656c 7320 3d33 202c 206f 7264   labels =3 , ord
+0001a5d0: 6572 203d 4e6f 6e65 2029 0d0a 2020 2020  er =None )..    
+0001a5e0: 2e2e 2e20 6172 7261 7928 5b30 2c20 302c  ... array([0, 0,
+0001a5f0: 2030 2c20 312c 2031 2c20 312c 2032 2c20   0, 1, 1, 1, 2, 
+0001a600: 322c 2032 2c20 325d 2920 2320 7265 7665  2, 2, 2]) # reve
+0001a610: 7273 6520 646f 6573 206e 6f74 2063 6861  rse does not cha
+0001a620: 6e67 650d 0a20 2020 203e 3e3e 2063 6174  nge..    >>> cat
+0001a630: 7461 7267 6574 2861 7272 2c20 6c61 6265  target(arr, labe
+0001a640: 6c73 203d 5b30 202c 2032 2c20 2034 5d20  ls =[0 , 2,  4] 
+0001a650: 2029 0d0a 2020 2020 2e2e 2e20 6172 7261   )..    ... arra
+0001a660: 7928 5b30 2c20 302c 2030 2c20 322c 2032  y([0, 0, 0, 2, 2
+0001a670: 2c20 342c 2034 2c20 342c 2034 2c20 345d  , 4, 4, 4, 4, 4]
+0001a680: 290d 0a0d 0a20 2020 2022 2222 0d0a 2020  )....    """..  
+0001a690: 2020 6172 7220 3d20 5f61 7373 6572 745f    arr = _assert_
+0001a6a0: 616c 6c5f 7479 7065 7328 6172 722c 206e  all_types(arr, n
+0001a6b0: 702e 6e64 6172 7261 792c 2070 642e 5365  p.ndarray, pd.Se
+0001a6c0: 7269 6573 2920 0d0a 2020 2020 6973 5f61  ries) ..    is_a
+0001a6d0: 7272 203d 4661 6c73 6520 0d0a 2020 2020  rr =False ..    
+0001a6e0: 6966 2069 7369 6e73 7461 6e63 6520 2861  if isinstance (a
+0001a6f0: 7272 2c20 6e70 2e6e 6461 7272 6179 2029  rr, np.ndarray )
+0001a700: 203a 0d0a 2020 2020 2020 2020 6172 7220   :..        arr 
+0001a710: 3d20 7064 2e53 6572 6965 7320 2861 7272  = pd.Series (arr
+0001a720: 2020 2c20 6e61 6d65 203d 2027 6e6f 6e65    , name = 'none
+0001a730: 2729 200d 0a20 2020 2020 2020 2069 735f  ') ..        is_
+0001a740: 6172 7220 3d54 7275 6520 0d0a 2020 2020  arr =True ..    
+0001a750: 2020 2020 0d0a 2020 2020 6966 2066 756e      ..    if fun
+0001a760: 6320 6973 206e 6f74 204e 6f6e 653a 200d  c is not None: .
+0001a770: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0001a780: 2069 6e73 7065 6374 2e69 7366 756e 6374   inspect.isfunct
+0001a790: 696f 6e20 2866 756e 6329 3a20 0d0a 2020  ion (func): ..  
+0001a7a0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001a7b0: 5479 7065 4572 726f 7220 280d 0a20 2020  TypeError (..   
+0001a7c0: 2020 2020 2020 2020 2020 2020 2066 2745               f'E
+0001a7d0: 7870 6563 7420 6120 6675 6e63 7469 6f6e  xpect a function
+0001a7e0: 2062 7574 2067 6f74 207b 7479 7065 2866   but got {type(f
+0001a7f0: 756e 6329 2e5f 5f6e 616d 655f 5f21 727d  unc).__name__!r}
+0001a800: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+0001a810: 0d0a 2020 2020 2020 2020 6172 723d 2061  ..        arr= a
+0001a820: 7272 2e61 7070 6c79 2028 6675 6e63 2029  rr.apply (func )
+0001a830: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0001a840: 2020 2020 7265 7475 726e 2020 6172 722e      return  arr.
+0001a850: 7661 6c75 6573 2020 6966 2069 735f 6172  values  if is_ar
+0001a860: 7220 656c 7365 2061 7272 2020 200d 0a20  r else arr   .. 
+0001a870: 2020 200d 0a20 2020 206e 616d 6520 3d20     ..    name = 
+0001a880: 6172 722e 6e61 6d65 200d 0a20 2020 2061  arr.name ..    a
+0001a890: 7272 203d 2061 7272 2e76 616c 7565 7320  rr = arr.values 
+0001a8a0: 0d0a 0d0a 2020 2020 6966 206c 6162 656c  ....    if label
+0001a8b0: 7320 6973 206e 6f74 204e 6f6e 653a 200d  s is not None: .
+0001a8c0: 0a20 2020 2020 2020 2061 7272 203d 205f  .        arr = _
+0001a8d0: 6361 7474 6172 6765 7420 2861 7272 202c  cattarget (arr ,
+0001a8e0: 206c 6162 656c 732c 206f 7264 6572 203d   labels, order =
+0001a8f0: 6f72 6465 7229 0d0a 2020 2020 2020 2020  order)..        
+0001a900: 6966 2072 656e 616d 655f 6c61 6265 6c73  if rename_labels
+0001a910: 2069 7320 6e6f 7420 4e6f 6e65 3a20 0d0a   is not None: ..
+0001a920: 2020 2020 2020 2020 2020 2020 6172 7220              arr 
+0001a930: 3d20 7265 6e61 6d65 5f6c 6162 656c 735f  = rename_labels_
+0001a940: 696e 2820 6172 7220 2c20 7265 6e61 6d65  in( arr , rename
+0001a950: 5f6c 6162 656c 7320 2c20 636f 6572 6365  _labels , coerce
+0001a960: 203d 636f 6572 6365 2029 200d 0a0d 0a20   =coerce ) .... 
+0001a970: 2020 2072 6574 7572 6e20 6172 7220 2069     return arr  i
+0001a980: 6620 6973 5f61 7272 2065 6c73 6520 7064  f is_arr else pd
+0001a990: 2e53 6572 6965 7320 2861 7272 2c20 6e61  .Series (arr, na
+0001a9a0: 6d65 203d 6e61 6d65 2020 290d 0a0d 0a64  me =name  )....d
+0001a9b0: 6566 2072 656e 616d 655f 6c61 6265 6c73  ef rename_labels
+0001a9c0: 5f69 6e20 2861 7272 2c20 6e65 775f 6e61  _in (arr, new_na
+0001a9d0: 6d65 732c 2063 6f65 7263 6520 3d20 4661  mes, coerce = Fa
+0001a9e0: 6c73 6529 3a20 0d0a 2020 2020 2222 2220  lse): ..    """ 
+0001a9f0: 5265 6e61 6d65 206c 6162 656c 2062 7920  Rename label by 
+0001aa00: 6120 6e65 7720 6e61 6d65 7320 0d0a 2020  a new names ..  
+0001aa10: 2020 0d0a 2020 2020 3a70 6172 616d 2061    ..    :param a
+0001aa20: 7272 3a20 6172 723a 2061 7272 6179 2d6c  rr: arr: array-l
+0001aa30: 696b 6520 7c70 616e 6461 732e 5365 7269  ike |pandas.Seri
+0001aa40: 6573 200d 0a20 2020 2020 2020 2020 6172  es ..         ar
+0001aa50: 7261 7920 6f72 2073 6572 6965 7320 636f  ray or series co
+0001aa60: 6e74 6169 6e69 6e67 206e 756d 6572 6963  ntaining numeric
+0001aa70: 616c 2076 616c 7565 732e 2049 6620 6120  al values. If a 
+0001aa80: 6e6f 6e2d 6e75 6d65 7269 6361 6c20 7661  non-numerical va
+0001aa90: 6c75 6573 200d 0a20 2020 2020 2020 2020  lues ..         
+0001aaa0: 6973 2067 6976 656e 202c 2061 6e20 6572  is given , an er
+0001aab0: 726f 7273 2077 696c 6c20 7261 6973 6573  rors will raises
+0001aac0: 2e20 0d0a 2020 2020 3a70 6172 616d 206e  . ..    :param n
+0001aad0: 6577 5f6e 616d 6573 3a20 6c69 7374 206f  ew_names: list o
+0001aae0: 6620 7374 723b 200d 0a20 2020 2020 2020  f str; ..       
+0001aaf0: 206c 6973 7420 6f66 2073 7472 696e 6720   list of string 
+0001ab00: 6f72 2076 616c 7565 7320 746f 2072 6570  or values to rep
+0001ab10: 6c61 6365 2074 6865 206c 6162 656c 2069  lace the label i
+0001ab20: 6e74 6567 6572 2069 6465 6e74 6966 6965  nteger identifie
+0001ab30: 722e 200d 0a20 2020 203a 7061 7261 6d20  r. ..    :param 
+0001ab40: 636f 6572 6365 3a20 626f 6f6c 2c20 6465  coerce: bool, de
+0001ab50: 6661 756c 7420 3d46 616c 7365 2c20 0d0a  fault =False, ..
+0001ab60: 2020 2020 2020 2020 666f 7263 6520 7468          force th
+0001ab70: 6520 276e 6577 5f6e 616d 6573 2720 746f  e 'new_names' to
+0001ab80: 2061 7070 6561 7220 696e 2074 6865 2074   appear in the t
+0001ab90: 6172 6765 7420 696e 636c 7564 696e 6720  arget including 
+0001aba0: 6f72 206e 6f74 2073 6f6d 6520 0d0a 2020  or not some ..  
+0001abb0: 2020 2020 2020 696e 7465 6765 7220 6964        integer id
+0001abc0: 656e 7469 6669 6572 2063 6c61 7373 206c  entifier class l
+0001abd0: 6162 656c 2e20 6063 6f65 7263 6560 2069  abel. `coerce` i
+0001abe0: 7320 6060 5472 7565 6060 2c20 7468 6520  s ``True``, the 
+0001abf0: 7461 7267 6574 2061 7272 6179 200d 0a20  target array .. 
+0001ac00: 2020 2020 2020 2068 6f6c 6420 7468 6520         hold the 
+0001ac10: 6474 7970 6520 6f66 206e 6577 5f61 7272  dtype of new_arr
+0001ac20: 6179 3b20 636f 6572 6369 6e67 2074 6865  ay; coercing the
+0001ac30: 206c 6162 656c 206e 616d 6573 2077 696c   label names wil
+0001ac40: 6c20 6e6f 7420 7969 656c 6420 0d0a 2020  l not yield ..  
+0001ac50: 2020 2020 2020 6572 726f 722e 2043 6f6e        error. Con
+0001ac60: 7365 7175 656e 746c 7920 6361 6e20 696e  sequently can in
+0001ac70: 7472 6f64 7563 6520 616e 2075 6e65 7870  troduce an unexp
+0001ac80: 6563 7465 6420 7265 7375 6c74 732e 0d0a  ected results...
+0001ac90: 2020 2020 3a72 6574 7572 6e3a 2061 7272      :return: arr
+0001aca0: 6179 2d6c 696b 652c 200d 0a20 2020 2020  ay-like, ..     
+0001acb0: 2020 2041 6e20 6172 7261 792d 6c69 6b65     An array-like
+0001acc0: 2077 6974 6820 6675 6c6c 206e 6577 206c   with full new l
+0001acd0: 6162 656c 206e 616d 6573 2e20 0d0a 2020  abel names. ..  
+0001ace0: 2020 2222 220d 0a20 2020 200d 0a20 2020    """..    ..   
+0001acf0: 2069 6620 6e6f 7420 6973 5f69 7465 7261   if not is_itera
+0001ad00: 626c 6528 6e65 775f 6e61 6d65 7329 3a20  ble(new_names): 
+0001ad10: 0d0a 2020 2020 2020 2020 6e65 775f 6e61  ..        new_na
+0001ad20: 6d65 733d 205b 6e65 775f 6e61 6d65 735d  mes= [new_names]
+0001ad30: 0d0a 2020 2020 7472 7565 5f6c 6162 656c  ..    true_label
+0001ad40: 7320 3d20 6e70 2e75 6e69 7175 6520 2861  s = np.unique (a
+0001ad50: 7272 2920 0d0a 2020 2020 0d0a 2020 2020  rr) ..    ..    
+0001ad60: 6966 2076 616c 6964 6174 655f 6c61 6265  if validate_labe
+0001ad70: 6c73 2861 7272 2c20 6e65 775f 6e61 6d65  ls(arr, new_name
+0001ad80: 732c 2072 6574 7572 6e5f 626f 6f6c 3d20  s, return_bool= 
+0001ad90: 5472 7565 293a 200d 0a20 2020 2020 2020  True): ..       
+0001ada0: 2072 6574 7572 6e20 6172 7220 0d0a 0d0a   return arr ....
+0001adb0: 2020 2020 6966 206c 656e 2874 7275 655f      if len(true_
+0001adc0: 6c61 6265 6c73 2920 213d 206c 656e 286e  labels) != len(n
+0001add0: 6577 5f6e 616d 6573 293a 0d0a 2020 2020  ew_names):..    
+0001ade0: 2020 2020 6966 206e 6f74 2063 6f65 7263      if not coerc
+0001adf0: 653a 200d 0a20 2020 2020 2020 2020 2020  e: ..           
+0001ae00: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0001ae10: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+0001ae20: 2020 2020 2243 616e 2774 2072 656e 616d      "Can't renam
+0001ae30: 6520 6c61 6265 6c73 3b20 7468 6520 6e65  e labels; the ne
+0001ae40: 7720 6e61 6d65 7320 616e 6420 756e 6971  w names and uniq
+0001ae50: 7565 206c 6162 656c 2220 0d0a 2020 2020  ue label" ..    
+0001ae60: 2020 2020 2020 2020 2020 2020 2220 6964              " id
+0001ae70: 656e 7469 6669 6572 7320 7369 7a65 206d  entifiers size m
+0001ae80: 7573 7420 6265 2063 6f6e 7369 7374 656e  ust be consisten
+0001ae90: 743b 2065 7870 6563 7420 7b7d 2c20 676f  t; expect {}, go
+0001aea0: 7420 2220 0d0a 2020 2020 2020 2020 2020  t " ..          
+0001aeb0: 2020 2020 2020 227b 7d20 6c61 6265 6c28        "{} label(
+0001aec0: 7329 2e22 2e66 6f72 6d61 7428 6c65 6e28  s).".format(len(
+0001aed0: 7472 7565 5f6c 6162 656c 7329 2c20 6c65  true_labels), le
+0001aee0: 6e28 6e65 775f 6e61 6d65 7329 290d 0a20  n(new_names)).. 
+0001aef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af00: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+0001af10: 2020 2020 2020 2069 6620 6c65 6e28 7472         if len(tr
+0001af20: 7565 5f6c 6162 656c 7329 203c 206c 656e  ue_labels) < len
+0001af30: 286e 6577 5f6e 616d 6573 2920 3a20 0d0a  (new_names) : ..
+0001af40: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+0001af50: 6e61 6d65 7320 3d20 6e65 775f 6e61 6d65  names = new_name
+0001af60: 7320 5b3a 206c 656e 286e 6577 5f6e 616d  s [: len(new_nam
+0001af70: 6573 295d 0d0a 2020 2020 2020 2020 656c  es)]..        el
+0001af80: 7365 3a20 0d0a 2020 2020 2020 2020 2020  se: ..          
+0001af90: 2020 6e65 775f 6e61 6d65 7320 3d20 6c69    new_names = li
+0001afa0: 7374 286e 6577 5f6e 616d 6573 2920 202b  st(new_names)  +
+0001afb0: 206c 6973 7428 0d0a 2020 2020 2020 2020   list(..        
+0001afc0: 2020 2020 2020 2020 7472 7565 5f6c 6162          true_lab
+0001afd0: 656c 7329 5b6c 656e 286e 6577 5f6e 616d  els)[len(new_nam
+0001afe0: 6573 293a 5d0d 0a20 2020 2020 2020 2020  es):]..         
+0001aff0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+0001b000: 2822 4e75 6d62 6572 206f 6620 7468 6520  ("Number of the 
+0001b010: 6769 7665 6e20 6c61 6265 6c73 2027 7b7d  given labels '{}
+0001b020: 2720 616e 6420 7661 6c75 6573 2027 7b7d  ' and values '{}
+0001b030: 2722 0d0a 2020 2020 2020 2020 2020 2020  '"..            
+0001b040: 2020 2020 2020 2020 2020 2020 2020 2220                " 
+0001b050: 6172 6520 6e6f 7420 636f 6e73 6973 7465  are not consiste
+0001b060: 6e74 2e20 4265 2061 7761 7265 2074 6861  nt. Be aware tha
+0001b070: 7420 7468 6973 2063 6f75 6c64 2022 0d0a  t this could "..
+0001b080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b090: 2020 2020 2020 2020 2020 2279 6965 6c64            "yield
+0001b0a0: 2061 6e20 6578 7065 6374 6564 2072 6573   an expected res
+0001b0b0: 756c 7473 2e22 2e66 6f72 6d61 7428 0d0a  ults.".format(..
+0001b0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b0d0: 2020 2020 2020 2020 2020 2020 2020 6c65                le
+0001b0e0: 6e28 6e65 775f 6e61 6d65 7329 2c20 6c65  n(new_names), le
+0001b0f0: 6e28 7472 7565 5f6c 6162 656c 7329 2929  n(true_labels)))
+0001b100: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+0001b110: 2020 2020 6e65 775f 6e61 6d65 7320 3d20      new_names = 
+0001b120: 6e70 2e61 7272 6179 286e 6577 5f6e 616d  np.array(new_nam
+0001b130: 6573 290d 0a20 2020 2023 2078 7878 7878  es)..    # xxxxx
+0001b140: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
+0001b150: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
+0001b160: 7878 780d 0a20 2020 2023 2068 6f6c 6420  xxx..    # hold 
+0001b170: 7468 6520 7479 7065 206f 6620 6172 7220  the type of arr 
+0001b180: 746f 206f 7065 7261 7465 2074 6865 200d  to operate the .
+0001b190: 0a20 2020 2023 2065 6c65 6d65 6e74 2077  .    # element w
+0001b1a0: 6973 6520 636f 6d70 6172 6169 736f 6e20  ise comparaison 
+0001b1b0: 6966 206e 6f74 2061 200d 0a20 2020 2023  if not a ..    #
+0001b1c0: 2056 616c 7565 4572 726f 723a 2720 696e   ValueError:' in
+0001b1d0: 7661 6c69 6420 6c69 7465 7261 6c20 666f  valid literal fo
+0001b1e0: 7220 696e 7428 2920 7769 7468 2062 6173  r int() with bas
+0001b1f0: 6520 3130 2720 0d0a 2020 2020 2320 7769  e 10' ..    # wi
+0001b200: 6c6c 2061 7070 6561 722e 200d 0a20 2020  ll appear. ..   
+0001b210: 2069 6620 6e6f 7420 6e70 2e69 7373 7562   if not np.issub
+0001b220: 6474 7970 6528 6e70 2e61 7272 6179 286e  dtype(np.array(n
+0001b230: 6577 5f6e 616d 6573 292e 6474 7970 652c  ew_names).dtype,
+0001b240: 206e 702e 6e75 6d62 6572 293a 200d 0a20   np.number): .. 
+0001b250: 2020 2020 2020 2061 7272 3d20 6172 722e         arr= arr.
+0001b260: 6173 7479 7065 2028 6e70 2e61 7272 6179  astype (np.array
+0001b270: 286e 6577 5f6e 616d 6573 292e 6474 7970  (new_names).dtyp
+0001b280: 6529 0d0a 2020 2020 2020 2020 7472 7565  e)..        true
+0001b290: 5f6c 6162 656c 7320 3d20 7472 7565 5f6c  _labels = true_l
+0001b2a0: 6162 656c 732e 6173 7479 7065 2028 6e70  abels.astype (np
+0001b2b0: 2e61 7272 6179 286e 6577 5f6e 616d 6573  .array(new_names
+0001b2c0: 292e 6474 7970 6529 0d0a 0d0a 2020 2020  ).dtype)....    
+0001b2d0: 666f 7220 656c 202c 206e 656c 2069 6e20  for el , nel in 
+0001b2e0: 7a69 7020 2874 7275 655f 6c61 6265 6c73  zip (true_labels
+0001b2f0: 2c20 6e65 775f 6e61 6d65 7320 293a 200d  , new_names ): .
+0001b300: 0a20 2020 2020 2020 2023 2078 7878 7878  .        # xxxxx
+0001b310: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
+0001b320: 7878 7878 7878 7878 7878 7878 7878 0d0a  xxxxxxxxxxxxxx..
+0001b330: 2020 2020 2020 2020 2320 656c 656d 656e          # elemen
+0001b340: 7420 636f 6d70 6172 6973 6f6e 2074 6872  t comparison thr
+0001b350: 6f77 7320 6120 6675 7475 7265 2077 6172  ows a future war
+0001b360: 6e69 6e67 2068 6572 6520 0d0a 2020 2020  ning here ..    
+0001b370: 2020 2020 2320 6265 6361 7573 6520 6f66      # because of
+0001b380: 2061 2064 6973 6167 7265 656d 656e 7420   a disagreement 
+0001b390: 6265 7477 6565 6e20 4e75 6d70 7920 616e  between Numpy an
+0001b3a0: 6420 6e61 7469 7665 2070 7974 686f 6e20  d native python 
+0001b3b0: 0d0a 2020 2020 2020 2020 2320 4e75 6d70  ..        # Nump
+0001b3c0: 7920 7665 7273 696f 6e20 3d27 312e 3232  y version ='1.22
+0001b3d0: 2e34 2720 7768 696c 6520 7079 7468 6f6e  .4' while python
+0001b3e0: 2076 6572 7369 6f6e 203d 2033 2e39 2e31   version = 3.9.1
+0001b3f0: 320d 0a20 2020 2020 2020 2023 2074 6869  2..        # thi
+0001b400: 7320 636f 6465 2069 7320 6272 6974 746c  s code is brittl
+0001b410: 6520 616e 6420 7265 7175 6972 6573 2074  e and requires t
+0001b420: 6865 7365 2076 6572 7369 6f6e 7320 6162  hese versions ab
+0001b430: 6f76 652e 200d 0a20 2020 2020 2020 2023  ove. ..        #
+0001b440: 2078 7878 7878 7878 7878 7878 7878 7878   xxxxxxxxxxxxxxx
+0001b450: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
+0001b460: 7878 7878 0d0a 2020 2020 2020 2020 2320  xxxx..        # 
+0001b470: 7375 7070 7265 7373 2065 6c65 6d65 6e74  suppress element
+0001b480: 2077 6973 6520 636f 6d70 6172 6973 6f6e   wise comparison
+0001b490: 2077 6172 6e69 6e67 206c 6f63 616c 6c79   warning locally
+0001b4a0: 200d 0a20 2020 2020 2020 2077 6974 6820   ..        with 
+0001b4b0: 7761 726e 696e 6773 2e63 6174 6368 5f77  warnings.catch_w
+0001b4c0: 6172 6e69 6e67 7328 293a 0d0a 2020 2020  arnings():..    
+0001b4d0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+0001b4e0: 2e73 696d 706c 6566 696c 7465 7228 6163  .simplefilter(ac
+0001b4f0: 7469 6f6e 3d27 6967 6e6f 7265 272c 2063  tion='ignore', c
+0001b500: 6174 6567 6f72 793d 4675 7475 7265 5761  ategory=FutureWa
+0001b510: 726e 696e 6729 0d0a 2020 2020 2020 2020  rning)..        
+0001b520: 2020 2020 6172 7220 5b61 7272 203d 3d20      arr [arr == 
+0001b530: 656c 205d 203d 206e 656c 200d 0a20 2020  el ] = nel ..   
+0001b540: 2020 2020 2020 2020 200d 0a20 2020 2072           ..    r
+0001b550: 6574 7572 6e20 6172 7220 0d0a 0d0a 2020  eturn arr ....  
+0001b560: 2020 0d0a 6465 6620 5f63 6174 7461 7267    ..def _cattarg
+0001b570: 6574 2028 6172 202c 206c 6162 656c 7320  et (ar , labels 
+0001b580: 2c20 6f72 6465 723d 4e6f 6e65 293a 200d  , order=None): .
+0001b590: 0a20 2020 2022 2222 2041 2073 6861 646f  .    """ A shado
+0001b5a0: 7720 6675 6e63 7469 6f6e 206f 6620 3a66  w function of :f
+0001b5b0: 756e 633a 6077 6174 6578 2e75 7469 6c73  unc:`watex.utils
+0001b5c0: 2e66 756e 6375 7469 6c73 2e63 6174 7461  .funcutils.catta
+0001b5d0: 7267 6574 602e 200d 0a20 2020 200d 0a20  rget`. ..    .. 
+0001b5e0: 2020 203a 7061 7261 6d20 6172 3a20 6172     :param ar: ar
+0001b5f0: 7261 792d 6c69 6b65 206f 6620 6e75 6d65  ray-like of nume
+0001b600: 7269 6361 6c20 7661 6c75 6573 200d 0a20  rical values .. 
+0001b610: 2020 203a 7061 7261 6d20 6c61 6265 6c73     :param labels
+0001b620: 3a20 696e 7420 6f72 206c 6973 7420 6f66  : int or list of
+0001b630: 2069 6e74 2c20 0d0a 2020 2020 2020 2020   int, ..        
+0001b640: 7468 6520 6e75 6d62 6572 206f 6620 6361  the number of ca
+0001b650: 7465 676f 7279 2074 6f20 7370 6c69 7420  tegory to split 
+0001b660: 2761 7227 696e 746f 2e20 0d0a 2020 2020  'ar'into. ..    
+0001b670: 3a70 6172 616d 206f 7264 6572 3a20 7374  :param order: st
+0001b680: 722c 206f 7074 696f 6e61 6c2c 200d 0a20  r, optional, .. 
+0001b690: 2020 2020 2020 2074 6865 206f 7264 6572         the order
+0001b6a0: 206f 6620 6c61 6265 6c20 746f 206e 6520   of label to ne 
+0001b6b0: 6361 7465 676f 7269 7a65 642e 2049 6620  categorized. If 
+0001b6c0: 4e6f 6e65 206f 7220 616e 7920 6f74 6865  None or any othe
+0001b6d0: 7220 7661 6c75 6573 2c20 0d0a 2020 2020  r values, ..    
+0001b6e0: 2020 2020 7468 6520 6361 7465 676f 7269      the categori
+0001b6f0: 7a61 7469 6f6e 206f 6620 6c61 6265 6c73  zation of labels
+0001b700: 2063 6f6e 7369 6465 7273 206f 6e6c 7920   considers only 
+0001b710: 7468 6520 6c65 616e 6774 6820 6f66 2061  the leangth of a
+0001b720: 7272 6179 2e20 0d0a 2020 2020 2020 2020  rray. ..        
+0001b730: 466f 7220 696e 7374 616e 6365 2061 2072  For instance a r
+0001b740: 6576 6572 7365 2061 7272 6179 2061 6e64  everse array and
+0001b750: 206e 6f6e 2d72 6576 6572 7365 2061 7272   non-reverse arr
+0001b760: 6179 2079 6965 6c64 2074 6865 2073 616d  ay yield the sam
+0001b770: 6520 0d0a 2020 2020 2020 2020 6361 7465  e ..        cate
+0001b780: 676f 7269 7a61 7469 6f6e 2073 616d 706c  gorization sampl
+0001b790: 6573 2e20 5768 656e 206f 7264 6572 2069  es. When order i
+0001b7a0: 7320 7365 7420 746f 2060 6073 7472 6963  s set to ``stric
+0001b7b0: 7460 602c 2074 6865 200d 0a20 2020 2020  t``, the ..     
+0001b7c0: 2020 2063 6174 6567 6f72 697a 6174 696f     categorizatio
+0001b7d0: 6e20 2073 7472 6963 746c 7920 636f 6e73  n  strictly cons
+0001b7e0: 6964 6572 2074 6865 2076 616c 7565 206f  ider the value o
+0001b7f0: 6620 6561 6368 2065 6c65 6d65 6e74 2e20  f each element. 
+0001b800: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0001b810: 3a72 6574 7572 6e3a 2061 7272 6179 2d6c  :return: array-l
+0001b820: 696b 6520 6f66 2069 6e74 202c 2061 7272  ike of int , arr
+0001b830: 6179 206f 6620 6361 7465 676f 7269 7a65  ay of categorize
+0001b840: 6420 7661 6c75 6573 2e20 200d 0a20 2020  d values.  ..   
+0001b850: 2022 2222 0d0a 2020 2020 2320 6173 7365   """..    # asse
+0001b860: 7274 206c 6162 656c 730d 0a20 2020 2069  rt labels..    i
+0001b870: 6620 6973 5f69 7465 7261 626c 6520 286c  f is_iterable (l
+0001b880: 6162 656c 7329 3a0d 0a20 2020 2020 2020  abels):..       
+0001b890: 206c 6162 656c 7320 3d5b 696e 7420 285f   labels =[int (_
+0001b8a0: 6173 7365 7274 5f61 6c6c 5f74 7970 6573  assert_all_types
+0001b8b0: 286c 6162 2c20 696e 742c 2066 6c6f 6174  (lab, int, float
+0001b8c0: 2929 200d 0a20 2020 2020 2020 2020 2020  )) ..           
+0001b8d0: 2020 2020 2020 666f 7220 6c61 6220 696e        for lab in
+0001b8e0: 206c 6162 656c 7320 5d0d 0a20 2020 2020   labels ]..     
+0001b8f0: 2020 206c 6162 656c 7320 3d20 6e70 2e61     labels = np.a
+0001b900: 7272 6179 2028 6c61 6265 6c73 202c 2064  rray (labels , d
+0001b910: 7479 7065 203d 206e 702e 696e 7433 3220  type = np.int32 
+0001b920: 2920 0d0a 2020 2020 2020 2020 6363 203d  ) ..        cc =
+0001b930: 206c 6162 656c 7320 0d0a 2020 2020 2020   labels ..      
+0001b940: 2020 2320 6173 7365 7274 2077 6865 7468    # assert wheth
+0001b950: 6572 2065 6c65 6d65 6e74 2069 7320 6f6e  er element is on
+0001b960: 2074 6865 2061 7272 6179 200d 0a20 2020   the array ..   
+0001b970: 2020 2020 2073 203d 2073 6574 2028 6172       s = set (ar
+0001b980: 292e 696e 7465 7273 6563 7469 6f6e 286c  ).intersection(l
+0001b990: 6162 656c 7329 200d 0a20 2020 2020 2020  abels) ..       
+0001b9a0: 2069 6620 6c65 6e28 7329 2021 3d20 6c65   if len(s) != le
+0001b9b0: 6e28 6c61 6265 6c73 293a 200d 0a20 2020  n(labels): ..   
+0001b9c0: 2020 2020 2020 2020 206d 7620 3d20 7365           mv = se
+0001b9d0: 7428 6c61 6265 6c73 292e 6469 6666 6572  t(labels).differ
+0001b9e0: 656e 6365 2028 7329 200d 0a20 2020 2020  ence (s) ..     
+0001b9f0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0001ba00: 2020 2020 2066 6d74 203d 205b 6622 7b27       fmt = [f"{'
+0001ba10: 7327 2069 6620 6c65 6e28 6d76 2920 3e31  s' if len(mv) >1
+0001ba20: 2065 6c73 6527 277d 2022 2c20 6d76 2c0d   else''} ", mv,.
+0001ba30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ba40: 2020 2020 6622 7b27 6973 2720 6966 206c      f"{'is' if l
+0001ba50: 656e 286d 7629 203c 3d31 2065 6c73 6527  en(mv) <=1 else'
+0001ba60: 6172 6527 7d22 5d0d 0a20 2020 2020 2020  are'}"]..       
+0001ba70: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+0001ba80: 726e 2822 4c61 6265 6c20 7661 6c75 6573  rn("Label values
+0001ba90: 206d 7573 7420 6265 2061 7272 6179 2073   must be array s
+0001baa0: 656c 662d 636f 6e74 6169 6e20 6974 656d  elf-contain item
+0001bab0: 2e20 220d 0a20 2020 2020 2020 2020 2020  . "..           
+0001bac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bad0: 224c 6162 656c 7b30 7d20 7b31 7d20 7b32  "Label{0} {1} {2
+0001bae0: 7d20 6d69 7373 696e 6720 696e 2074 6865  } missing in the
+0001baf0: 2061 7272 6179 2e22 2e66 6f72 6d61 7428   array.".format(
+0001bb00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 0001bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb20: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
-0001bb30: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0001bb40: 6f72 2028 0d0a 2020 2020 2020 2020 2020  or (..          
-0001bb50: 2020 2020 2020 226c 6162 656c 2076 616c        "label val
-0001bb60: 7565 7b30 7d20 7b31 7d20 7b32 7d20 6d69  ue{0} {1} {2} mi
-0001bb70: 7373 696e 6720 696e 2074 6865 2061 7272  ssing in the arr
-0001bb80: 6179 2e22 2e66 6f72 6d61 7428 2a66 6d74  ay.".format(*fmt
-0001bb90: 2929 0d0a 2020 2020 656c 7365 203a 200d  ))..    else : .
-0001bba0: 0a20 2020 2020 2020 206c 6162 656c 7320  .        labels 
-0001bbb0: 3d20 696e 7420 285f 6173 7365 7274 5f61  = int (_assert_a
-0001bbc0: 6c6c 5f74 7970 6573 286c 6162 656c 7320  ll_types(labels 
-0001bbd0: 2c20 696e 742c 2066 6c6f 6174 2929 0d0a  , int, float))..
-0001bbe0: 2020 2020 2020 2020 6c61 6265 6c73 203d          labels =
-0001bbf0: 206e 702e 6c69 6e73 7061 6365 2028 206d   np.linspace ( m
-0001bc00: 696e 2861 7229 2c20 6d61 7820 2861 7229  in(ar), max (ar)
-0001bc10: 2c20 6c61 6265 6c73 202b 2031 2029 2023  , labels + 1 ) #
-0001bc20: 2b20 2e30 3030 3030 3030 3120 0d0a 2020  + .00000001 ..  
-0001bc30: 2020 2020 2020 2361 7272 6179 285b 2030        #array([ 0
-0001bc40: 2e2c 2020 362e 2c20 3132 2e2c 2031 382e  .,  6., 12., 18.
-0001bc50: 5d29 0d0a 2020 2020 2020 2020 2320 7370  ])..        # sp
-0001bc60: 6c69 7420 6172 7220 616e 6420 6765 7420  lit arr and get 
-0001bc70: 7468 6520 7261 6e67 6520 6f66 2077 6974  the range of wit
-0001bc80: 6820 6d61 7820 626f 756e 6420 0d0a 2020  h max bound ..  
-0001bc90: 2020 2020 2020 6363 203d 206e 702e 6172        cc = np.ar
-0001bca0: 616e 6765 2028 6c65 6e28 6c61 6265 6c73  ange (len(labels
-0001bcb0: 2929 2023 5b30 2c20 312c 2033 5d0d 0a20  )) #[0, 1, 3].. 
-0001bcc0: 2020 2020 2020 2023 2077 6520 6578 7065         # we expe
-0001bcd0: 6374 2074 6872 6565 2063 6c61 7373 6573  ct three classes
-0001bce0: 205b 2030 2c20 312c 2033 205d 2077 6869   [ 0, 1, 3 ] whi
-0001bcf0: 6c65 206d 6178 696d 756d 200d 0a20 2020  le maximum ..   
-0001bd00: 2020 2020 2023 2076 616c 7565 2069 7320       # value is 
-0001bd10: 3138 202e 2077 6520 7761 6e74 2074 6865  18 . we want the
-0001bd20: 2076 616c 7565 2076 616c 7565 2074 6f20   value value to 
-0001bd30: 6265 203e 3d20 3132 2077 6869 6368 200d  be >= 12 which .
-0001bd40: 0a20 2020 2020 2020 2023 2069 6e63 6c75  .        # inclu
-0001bd50: 6465 2031 3820 2c20 736f 2072 656d 6f76  de 18 , so remov
-0001bd60: 6520 7468 6520 3138 2069 6e20 7468 6520  e the 18 in the 
-0001bd70: 6c69 7374 200d 0a20 2020 2020 2020 206c  list ..        l
-0001bd80: 6162 656c 7320 3d20 6c61 6265 6c73 205b  abels = labels [
-0001bd90: 3a2d 315d 2023 2072 656d 6f76 6520 7468  :-1] # remove th
-0001bda0: 6520 6c61 7374 2069 7465 6d73 2061 0d0a  e last items a..
-0001bdb0: 2020 2020 2020 2020 2320 6172 7261 7928          # array(
-0001bdc0: 5b30 2c20 312c 2032 2c20 332c 2034 2c20  [0, 1, 2, 3, 4, 
-0001bdd0: 352c 2036 2c20 372c 2038 2c20 395d 290d  5, 6, 7, 8, 9]).
-0001bde0: 0a20 2020 2020 2020 2023 2061 7272 6179  .        # array
-0001bdf0: 285b 302c 2030 2c20 302c 2030 2c20 312c  ([0, 0, 0, 0, 1,
-0001be00: 2031 2c20 312c 2032 2c20 322c 2032 5d29   1, 1, 2, 2, 2])
-0001be10: 2023 2033 2063 6c61 7373 6573 200d 0a20   # 3 classes .. 
-0001be20: 2020 2020 2020 2023 2020 6172 7261 7928         #  array(
-0001be30: 5b20 302e 2020 2020 2020 2020 2c20 2033  [ 0.        ,  3
-0001be40: 2e33 3333 3333 3333 332c 2020 362e 3636  .33333333,  6.66
-0001be50: 3636 3636 3637 2c20 3130 2e20 5d29 202b  666667, 10. ]) +
-0001be60: 200d 0a20 2020 2023 2074 6f20 6176 6f69   ..    # to avoi
-0001be70: 6420 7468 6520 696e 6465 7820 626f 756e  d the index boun
-0001be80: 6420 6572 726f 7220 0d0a 2020 2020 2320  d error ..    # 
-0001be90: 6170 7065 6e64 206e 616e 2076 616c 7565  append nan value
-0001bea0: 2074 6f20 6c65 6e67 7468 656e 2061 7272   to lengthen arr
-0001beb0: 200d 0a20 2020 2072 203d 206e 702e 6170   ..    r = np.ap
-0001bec0: 7065 6e64 2028 6c61 6265 6c73 202c 206e  pend (labels , n
-0001bed0: 702e 6e61 6e20 2920 0d0a 2020 2020 6e65  p.nan ) ..    ne
-0001bee0: 775f 6172 7220 3d20 6e70 2e7a 6572 6f73  w_arr = np.zeros
-0001bef0: 5f6c 696b 6528 6172 2920 0d0a 2020 2020  _like(ar) ..    
-0001bf00: 2320 7072 696e 7428 6c61 6265 6c73 290d  # print(labels).
-0001bf10: 0a20 2020 2061 7220 3d20 6172 2e61 7374  .    ar = ar.ast
-0001bf20: 7970 6520 286e 702e 666c 6f61 7433 3229  ype (np.float32)
-0001bf30: 0d0a 0d0a 2020 2020 6966 206f 7264 6572  ....    if order
-0001bf40: 203d 3d27 7374 7269 6374 273a 200d 0a20   =='strict': .. 
-0001bf50: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-0001bf60: 7261 6e67 6520 286c 656e 2872 2929 3a0d  range (len(r)):.
-0001bf70: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001bf80: 6920 3d3d 206c 656e 2872 2920 2d32 203a  i == len(r) -2 :
-0001bf90: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0001bfa0: 2020 2069 7820 3d20 6e70 2e61 7267 7768     ix = np.argwh
-0001bfb0: 6572 6520 2820 2861 7220 3e3d 2072 5b69  ere ( (ar >= r[i
-0001bfc0: 5d29 2026 2028 6172 2021 3d20 6e70 2e69  ]) & (ar != np.i
-0001bfd0: 6e66 2029 290d 0a20 2020 2020 2020 2020  nf ))..         
-0001bfe0: 2020 2020 2020 206e 6577 5f61 7272 5b69         new_arr[i
-0001bff0: 7820 5d3d 2063 635b 695d 0d0a 2020 2020  x ]= cc[i]..    
-0001c000: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-0001c010: 6b20 0d0a 2020 2020 2020 2020 2020 2020  k ..            
-0001c020: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0001c030: 2069 203d 3d30 203a 200d 0a20 2020 2020   i ==0 : ..     
-0001c040: 2020 2020 2020 2020 2020 2069 7820 3d20             ix = 
-0001c050: 6e70 2e61 7267 7768 6572 6520 2861 7220  np.argwhere (ar 
-0001c060: 3c20 725b 6920 2b31 5d29 0d0a 2020 2020  < r[i +1])..    
-0001c070: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-0001c080: 6172 7220 5b69 785d 203d 3d20 6363 5b69  arr [ix] == cc[i
-0001c090: 5d20 0d0a 2020 2020 2020 2020 2020 2020  ] ..            
-0001c0a0: 2020 2020 6172 205b 6978 205d 203d 206e      ar [ix ] = n
-0001c0b0: 702e 696e 6620 2320 7265 706c 6163 6520  p.inf # replace 
-0001c0c0: 6279 2061 2062 6967 206e 756d 6265 7220  by a big number 
-0001c0d0: 7468 616e 2069 7420 7761 7320 0d0a 2020  than it was ..  
-0001c0e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0001c0f0: 7261 7468 6572 2074 6861 6e20 6465 6c65  rather than dele
-0001c100: 7465 2069 7420 0d0a 2020 2020 2020 2020  te it ..        
-0001c110: 2020 2020 656c 7365 203a 0d0a 2020 2020      else :..    
-0001c120: 2020 2020 2020 2020 2020 2020 6978 203d              ix =
-0001c130: 206e 702e 6172 6777 6865 7265 2820 2872   np.argwhere( (r
-0001c140: 5b69 5d20 3c3d 2061 7229 2026 2028 6172  [i] <= ar) & (ar
-0001c150: 203c 2072 5b69 202b 315d 2920 290d 0a20   < r[i +1]) ).. 
-0001c160: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001c170: 6577 5f61 7272 205b 6978 205d 3d20 6363  ew_arr [ix ]= cc
-0001c180: 5b69 5d20 0d0a 2020 2020 2020 2020 2020  [i] ..          
-0001c190: 2020 2020 2020 6172 205b 6978 205d 203d        ar [ix ] =
-0001c1a0: 206e 702e 696e 6620 0d0a 2020 2020 656c   np.inf ..    el
-0001c1b0: 7365 3a20 0d0a 2020 2020 2020 2020 6c3d  se: ..        l=
-0001c1c0: 206c 6973 7428 2920 0d0a 2020 2020 2020   list() ..      
-0001c1d0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-0001c1e0: 2028 6c65 6e28 7229 293a 200d 0a20 2020   (len(r)): ..   
-0001c1f0: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
-0001c200: 206c 656e 2872 2920 2d32 203a 200d 0a20   len(r) -2 : .. 
-0001c210: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0001c220: 2e61 7070 656e 6420 286e 702e 7265 7065  .append (np.repe
-0001c230: 6174 2028 2063 635b 695d 2c20 6c65 6e28  at ( cc[i], len(
-0001c240: 6172 2929 2920 0d0a 2020 2020 2020 2020  ar))) ..        
-0001c250: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001c260: 2020 2020 2020 2020 2020 6272 6561 6b0d            break.
-0001c270: 0a20 2020 2020 2020 2020 2020 2069 7820  .            ix 
-0001c280: 3d20 6e70 2e61 7267 7768 6572 6520 2820  = np.argwhere ( 
-0001c290: 2861 7220 3c20 7220 5b20 6920 2b20 3120  (ar < r [ i + 1 
-0001c2a0: 5d20 2929 0d0a 2020 2020 2020 2020 2020  ] ))..          
-0001c2b0: 2020 6c2e 6170 7065 6e64 2028 6e70 2e72    l.append (np.r
-0001c2c0: 6570 6561 7420 2863 635b 695d 2c20 6c65  epeat (cc[i], le
-0001c2d0: 6e20 2861 725b 6978 205d 2929 2920 200d  n (ar[ix ])))  .
-0001c2e0: 0a20 2020 2020 2020 2020 2020 2023 2072  .            # r
-0001c2f0: 656d 6f76 6520 7468 6520 7661 6c75 6520  emove the value 
-0001c300: 7265 6164 7920 666f 7220 6920 6c61 6265  ready for i labe
-0001c310: 6c20 0d0a 2020 2020 2020 2020 2020 2020  l ..            
-0001c320: 2320 6361 7465 676f 7269 7a61 7469 6f6e  # categorization
-0001c330: 200d 0a20 2020 2020 2020 2020 2020 2061   ..            a
-0001c340: 7220 3d20 6e70 2e64 656c 6574 6520 2861  r = np.delete (a
-0001c350: 722c 2069 7820 2029 0d0a 2020 2020 2020  r, ix  )..      
-0001c360: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001c370: 6e65 775f 6172 723d 206e 702e 6873 7461  new_arr= np.hsta
-0001c380: 636b 2028 6c29 2e61 7374 7970 6520 286e  ck (l).astype (n
-0001c390: 702e 696e 7433 3229 2020 0d0a 2020 2020  p.int32)  ..    
-0001c3a0: 2020 2020 0d0a 2020 2020 7265 7475 726e      ..    return
-0001c3b0: 206e 6577 5f61 7272 2e61 7374 7970 6520   new_arr.astype 
-0001c3c0: 286e 702e 696e 7433 3229 2020 0d0a 0d0a  (np.int32)  ....
-0001c3d0: 0d0a 6465 6620 7661 6c69 6461 7465 5f6c  ..def validate_l
-0001c3e0: 6162 656c 7320 2874 2c20 2f2c 206c 6162  abels (t, /, lab
-0001c3f0: 656c 732c 2072 6574 7572 6e5f 626f 6f6c  els, return_bool
-0001c400: 203d 2046 616c 7365 293a 200d 0a20 2020   = False): ..   
-0001c410: 2022 2222 2041 7373 6572 7420 7468 6520   """ Assert the 
-0001c420: 7661 6c69 6469 7479 206f 6620 7468 6520  validity of the 
-0001c430: 6c61 6265 6c20 696e 2074 6865 2074 6172  label in the tar
-0001c440: 6765 7420 2061 6e64 2072 6574 7572 6e20  get  and return 
-0001c450: 7468 6520 6c61 6265 6c20 0d0a 2020 2020  the label ..    
-0001c460: 6f72 2074 6865 2062 6f6f 6c65 616e 2077  or the boolean w
-0001c470: 6865 7468 6572 2061 6c6c 2069 7465 6d73  hether all items
-0001c480: 206f 6620 6c61 6265 6c20 6172 6520 696e   of label are in
-0001c490: 2074 6865 2074 6172 6765 742e 200d 0a20   the target. .. 
-0001c4a0: 2020 200d 0a20 2020 203a 7061 7261 6d20     ..    :param 
-0001c4b0: 743a 2061 7272 6179 2d6c 696b 652c 2074  t: array-like, t
-0001c4c0: 6172 6765 7420 7468 6174 2069 7320 6578  arget that is ex
-0001c4d0: 7065 6374 6564 2074 6f20 636f 6e74 6169  pected to contai
-0001c4e0: 6e20 7468 6520 6c61 6265 6c73 2e20 0d0a  n the labels. ..
-0001c4f0: 2020 2020 3a70 6172 616d 206c 6162 656c      :param label
-0001c500: 733a 2069 6e74 2c20 7374 7220 6f72 206c  s: int, str or l
-0001c510: 6973 7420 6f66 2028 7374 7220 6f72 2069  ist of (str or i
-0001c520: 6e74 2920 7468 6174 2069 7320 7375 7070  nt) that is supp
-0001c530: 6f73 6564 2074 6f20 6265 2069 6e20 0d0a  osed to be in ..
-0001c540: 2020 2020 2020 2020 7468 6520 7461 7267          the targ
-0001c550: 6574 2060 7460 2e20 0d0a 2020 2020 3a70  et `t`. ..    :p
-0001c560: 6172 616d 2072 6574 7572 6e5f 626f 6f6c  aram return_bool
-0001c570: 3a20 626f 6f6c 2c20 6465 6661 756c 743d  : bool, default=
-0001c580: 4661 6c73 653b 2072 6574 7572 6e73 2027  False; returns '
-0001c590: 5472 7565 2720 6f72 2027 4661 6c73 6527  True' or 'False'
-0001c5a0: 2072 6174 6865 7220 0d0a 2020 2020 2020   rather ..      
-0001c5b0: 2020 7468 6520 6c61 6265 6c73 2069 6620    the labels if 
-0001c5c0: 7365 7420 746f 2060 6054 7275 6560 602e  set to ``True``.
-0001c5d0: 200d 0a20 2020 203a 7265 7475 726e 733a   ..    :returns:
-0001c5e0: 2062 6f6f 6c20 6f72 206c 6162 656c 733b   bool or labels;
-0001c5f0: 2027 5472 7565 2720 6f72 2027 4661 6c73   'True' or 'Fals
-0001c600: 6527 2069 6620 6072 6574 7572 6e5f 626f  e' if `return_bo
-0001c610: 6f6c 6020 6973 2073 6574 2074 6f20 0d0a  ol` is set to ..
-0001c620: 2020 2020 2020 2020 6060 5472 7565 6060          ``True``
-0001c630: 2061 6e64 206c 6162 656c 7320 6f74 6865   and labels othe
-0001c640: 7277 6973 652e 200d 0a20 2020 2020 2020  rwise. ..       
-0001c650: 200d 0a20 2020 203a 6578 616d 706c 653a   ..    :example:
-0001c660: 200d 0a20 2020 203e 3e3e 2066 726f 6d20   ..    >>> from 
-0001c670: 7761 7465 782e 6461 7461 7365 7473 2069  watex.datasets i
-0001c680: 6d70 6f72 7420 6665 7463 685f 6461 7461  mport fetch_data
-0001c690: 200d 0a20 2020 203e 3e3e 2066 726f 6d20   ..    >>> from 
-0001c6a0: 7761 7465 782e 7574 696c 732e 6d6c 7574  watex.utils.mlut
-0001c6b0: 696c 7320 696d 706f 7274 2063 6174 7461  ils import catta
-0001c6c0: 7267 6574 2c20 6c61 6265 6c73 5f76 616c  rget, labels_val
-0001c6d0: 6964 6174 6f72 200d 0a20 2020 203e 3e3e  idator ..    >>>
-0001c6e0: 205f 2c20 7920 3d20 6665 7463 685f 6461   _, y = fetch_da
-0001c6f0: 7461 2028 2762 6167 6f75 6527 2c20 7265  ta ('bagoue', re
-0001c700: 7475 726e 5f58 5f79 3d54 7275 652c 2061  turn_X_y=True, a
-0001c710: 735f 6672 616d 653d 5472 7565 2920 0d0a  s_frame=True) ..
-0001c720: 2020 2020 3e3e 3e20 2320 6269 6e61 7269      >>> # binari
-0001c730: 7a65 2074 6172 6765 7420 7920 696e 746f  ze target y into
-0001c740: 205b 3020 2c20 315d 0d0a 2020 2020 3e3e   [0 , 1]..    >>
-0001c750: 3e20 7962 696e 203d 2063 6174 7461 7267  > ybin = cattarg
-0001c760: 6574 2879 2c20 6c61 6265 6c73 3d32 2029  et(y, labels=2 )
-0001c770: 0d0a 2020 2020 3e3e 3e20 7661 6c69 6461  ..    >>> valida
-0001c780: 7465 5f6c 6162 656c 7320 2879 6269 6e2c  te_labels (ybin,
-0001c790: 205b 302c 2031 5d29 0d0a 2020 2020 2e2e   [0, 1])..    ..
-0001c7a0: 2e20 5b30 2c20 315d 2023 2061 6c6c 206c  . [0, 1] # all l
-0001c7b0: 6162 656c 7320 6578 6973 742e 200d 0a20  abels exist. .. 
-0001c7c0: 2020 203e 3e3e 2076 616c 6964 6174 655f     >>> validate_
-0001c7d0: 6c61 6265 6c73 2028 792c 205b 302c 2031  labels (y, [0, 1
-0001c7e0: 2c20 335d 290d 0a20 2020 202e 2e2e 2056  , 3])..    ... V
-0001c7f0: 616c 7565 4572 726f 723a 2056 616c 7565  alueError: Value
-0001c800: 2027 3327 2069 7320 6d69 7373 696e 6720   '3' is missing 
-0001c810: 696e 2074 6865 2074 6172 6765 742e 0d0a  in the target...
-0001c820: 2020 2020 3e3e 3e20 7661 6c69 6461 7465      >>> validate
-0001c830: 5f6c 6162 656c 7320 2879 6269 6e2c 2030  _labels (ybin, 0
-0001c840: 2029 0d0a 2020 2020 2e2e 2e20 5b30 5d0d   )..    ... [0].
-0001c850: 0a20 2020 203e 3e3e 2076 616c 6964 6174  .    >>> validat
-0001c860: 655f 6c61 6265 6c73 2028 7962 696e 2c20  e_labels (ybin, 
-0001c870: 5b30 2c20 355d 2c20 7265 7475 726e 5f62  [0, 5], return_b
-0001c880: 6f6f 6c3d 5472 7565 2029 2023 206e 6f20  ool=True ) # no 
-0001c890: 7261 6973 6520 6572 726f 720d 0a20 2020  raise error..   
-0001c8a0: 202e 2e2e 2046 616c 7365 0d0a 2020 2020   ... False..    
-0001c8b0: 2020 2020 0d0a 2020 2020 2222 220d 0a20      ..    """.. 
-0001c8c0: 2020 200d 0a20 2020 2069 6620 6e6f 7420     ..    if not 
-0001c8d0: 6973 5f69 7465 7261 626c 6528 6c61 6265  is_iterable(labe
-0001c8e0: 6c73 293a 0d0a 2020 2020 2020 2020 6c61  ls):..        la
-0001c8f0: 6265 6c73 203d 5b6c 6162 656c 735d 200d  bels =[labels] .
-0001c900: 0a20 2020 2020 2020 200d 0a20 2020 2074  .        ..    t
-0001c910: 203d 206e 702e 6172 7261 7928 7429 0d0a   = np.array(t)..
-0001c920: 2020 2020 6d61 736b 203d 206e 702e 6973      mask = np.is
-0001c930: 696e 2874 2c20 6c61 6265 6c73 2920 0d0a  in(t, labels) ..
-0001c940: 2020 2020 7472 7565 5f6c 6162 656c 7320      true_labels 
-0001c950: 3d20 6e70 2e75 6e69 7175 6520 2874 5b6d  = np.unique (t[m
-0001c960: 6173 6b5d 2920 0d0a 2020 2020 2320 7365  ask]) ..    # se
-0001c970: 7420 7468 6520 6469 6666 6572 656e 6365  t the difference
-0001c980: 2074 6f20 6b6e 6f77 200d 0a20 2020 2023   to know ..    #
-0001c990: 2077 6865 7468 6572 2061 6c6c 206c 6162   whether all lab
-0001c9a0: 656c 7320 6172 6520 7661 6c69 6420 0d0a  els are valid ..
-0001c9b0: 2020 2020 7265 6d61 696e 6465 7220 3d20      remainder = 
-0001c9c0: 6c69 7374 2873 6574 286c 6162 656c 7329  list(set(labels)
-0001c9d0: 2e64 6966 6665 7265 6e63 6520 2874 7275  .difference (tru
-0001c9e0: 655f 6c61 6265 6c73 2929 0d0a 2020 2020  e_labels))..    
-0001c9f0: 0d0a 2020 2020 6973 7661 6c69 6420 3d20  ..    isvalid = 
-0001ca00: 5472 7565 200d 0a20 2020 2069 6620 6c65  True ..    if le
-0001ca10: 6e28 7265 6d61 696e 6465 7229 213d 3020  n(remainder)!=0 
-0001ca20: 3a20 0d0a 2020 2020 2020 2020 6966 206e  : ..        if n
-0001ca30: 6f74 2072 6574 7572 6e5f 626f 6f6c 3a20  ot return_bool: 
-0001ca40: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0001ca50: 7261 6973 6520 6572 726f 7220 200d 0a20  raise error  .. 
-0001ca60: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001ca70: 2056 616c 7565 4572 726f 7220 280d 0a20   ValueError (.. 
-0001ca80: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001ca90: 4c61 6265 6c20 7661 6c75 657b 307d 207b  Label value{0} {
-0001caa0: 317d 207b 327d 206d 6973 7369 6e67 2069  1} {2} missing i
-0001cab0: 6e20 7468 6520 7461 7267 6574 2027 7927  n the target 'y'
-0001cac0: 2e22 2e66 6f72 6d61 7420 2820 0d0a 2020  .".format ( ..  
-0001cad0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0001cae0: 7b27 7327 2069 6620 6c65 6e28 7265 6d61  {'s' if len(rema
-0001caf0: 696e 6465 7229 3e31 2065 6c73 6520 2727  inder)>1 else ''
-0001cb00: 7d22 2c20 0d0a 2020 2020 2020 2020 2020  }", ..          
-0001cb10: 2020 2020 2020 6622 7b73 6d61 7274 5f66        f"{smart_f
-0001cb20: 6f72 6d61 7428 7265 6d61 696e 6465 7229  ormat(remainder)
-0001cb30: 7d22 2c0d 0a20 2020 2020 2020 2020 2020  }",..           
-0001cb40: 2020 2020 2066 227b 2761 7265 2720 6966       f"{'are' if
-0001cb50: 206c 656e 2872 656d 6169 6e64 6572 293e   len(remainder)>
-0001cb60: 2031 2065 6c73 6520 2769 7327 7d22 290d   1 else 'is'}").
-0001cb70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001cb80: 2029 0d0a 2020 2020 2020 2020 6973 7661   )..        isva
-0001cb90: 6c69 643d 2046 616c 7365 200d 0a20 2020  lid= False ..   
-0001cba0: 2020 2020 200d 0a20 2020 2072 6574 7572       ..    retur
-0001cbb0: 6e20 6973 7661 6c69 6420 6966 2072 6574  n isvalid if ret
-0001cbc0: 7572 6e5f 626f 6f6c 2065 6c73 6520 206c  urn_bool else  l
-0001cbd0: 6162 656c 7320 0d0a 0d0a 6465 6620 5f76  abels ....def _v
-0001cbe0: 616c 6964 6174 655f 7361 6d70 6c65 7320  alidate_samples 
-0001cbf0: 282a 6466 7320 2c20 6572 726f 723a 7374  (*dfs , error:st
-0001cc00: 7220 3d27 7261 6973 6527 293a 200d 0a20  r ='raise'): .. 
-0001cc10: 2020 2022 2222 2056 616c 6964 6174 6520     """ Validate 
-0001cc20: 6461 7461 202e 200d 0a20 2020 2020 6368  data . ..     ch
-0001cc30: 6563 6b20 7368 6170 6573 2061 6e64 2074  eck shapes and t
-0001cc40: 6865 2063 6f6c 756d 6e73 2069 7465 6d73  he columns items
-0001cc50: 2069 6e20 7468 6520 6461 7461 2e0d 0a20   in the data... 
-0001cc60: 2020 2020 0d0a 2020 2020 3a70 6172 616d      ..    :param
-0001cc70: 2064 6673 3a20 6c69 7374 206f 6620 6461   dfs: list of da
-0001cc80: 7461 6672 616d 6573 206f 7220 6172 7261  taframes or arra
-0001cc90: 792d 6c69 6b65 200d 0a20 2020 2020 2020  y-like ..       
-0001cca0: 2044 6174 6166 7261 6d65 206d 7573 7420   Dataframe must 
-0001ccb0: 6861 7665 2074 6865 2073 616d 6520 7369  have the same si
-0001ccc0: 7a65 2061 6c6f 6e67 2061 7869 7320 312e  ze along axis 1.
-0001ccd0: 2049 6620 6572 726f 7220 6973 2027 6967   If error is 'ig
-0001cce0: 6e6f 7265 270d 0a20 2020 2020 2020 2065  nore'..        e
-0001ccf0: 7272 6f72 2069 7320 6d75 7465 6420 6966  rror is muted if
-0001cd00: 2074 6865 206c 656e 6774 6820 2820 616c   the length ( al
-0001cd10: 6f6e 6720 6178 6973 2030 2920 6f66 2064  ong axis 0) of d
-0001cd20: 6174 6120 646f 6573 206e 6f74 2066 6974  ata does not fit
-0001cd30: 200d 0a20 2020 2020 2020 2065 6163 6820   ..        each 
-0001cd40: 6f74 6865 722e 200d 0a20 2020 203a 7061  other. ..    :pa
-0001cd50: 7261 6d20 6572 726f 723a 2073 7472 2c20  ram error: str, 
-0001cd60: 6465 6661 756c 743d 2772 6169 7365 2720  default='raise' 
-0001cd70: 0d0a 2020 2020 2020 2020 5261 6973 6520  ..        Raise 
-0001cd80: 6162 736f 6c75 7465 6c79 2065 7272 6f72  absolutely error
-0001cd90: 2069 6620 6461 7461 2068 6173 206e 6f74   if data has not
-0001cda0: 2074 6865 2073 616d 6520 7368 6170 652c   the same shape,
-0001cdb0: 2073 697a 6520 616e 6420 6974 656d 7320   size and items 
-0001cdc0: 0d0a 2020 2020 2020 2020 696e 2063 6f6c  ..        in col
-0001cdd0: 756d 6e73 2e20 0d0a 2020 2020 3a72 6574  umns. ..    :ret
-0001cde0: 7572 6e3a 200d 0a20 2020 2020 2020 2076  urn: ..        v
-0001cdf0: 616c 6964 5f64 6673 3a20 4c69 7374 206f  alid_dfs: List o
-0001ce00: 6620 7661 6c69 6461 2064 6174 612e 2049  f valida data. I
-0001ce10: 6620 2765 7272 6f72 2720 6973 2027 6967  f 'error' is 'ig
-0001ce20: 6e6f 7265 2720 2c20 4974 2073 7469 6c6c  nore' , It still
-0001ce30: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
-0001ce40: 6e73 2074 6865 206c 6973 7420 6f66 2076  ns the list of v
-0001ce50: 616c 6964 2064 6174 6120 616e 6420 6578  alid data and ex
-0001ce60: 636c 7564 6573 2074 6865 2069 6e76 616c  cludes the inval
-0001ce70: 6964 2061 6c6c 2074 696d 6573 200d 0a20  id all times .. 
-0001ce80: 2020 2020 2020 206c 6561 7669 6e67 2061         leaving a
-0001ce90: 6e20 7573 6572 7761 726e 6d69 6d67 2e0d  n userwarnmimg..
-0001cea0: 0a20 2020 2020 2020 200d 0a20 2020 2022  .        ..    "
-0001ceb0: 2222 0d0a 2020 2020 7368 6170 655f 696e  ""..    shape_in
-0001cec0: 6974 203d 2064 6673 5b30 5d2e 7368 6170  it = dfs[0].shap
-0001ced0: 655b 315d 0d0a 2020 2020 5b20 5f61 7373  e[1]..    [ _ass
-0001cee0: 6572 745f 616c 6c5f 7479 7065 7328 6466  ert_all_types(df
-0001cef0: 2c20 6e70 2e6e 6461 7272 6179 2c20 7064  , np.ndarray, pd
-0001cf00: 2e44 6174 6146 7261 6d65 2920 666f 7220  .DataFrame) for 
-0001cf10: 6466 2069 6e20 6466 7320 5d0d 0a20 2020  df in dfs ]..   
-0001cf20: 2064 6966 665f 7368 6170 6520 2c20 7368   diff_shape , sh
-0001cf30: 6170 6573 2020 2c20 636f 6c73 203d 205b  apes  , cols = [
-0001cf40: 5d2c 205b 5d2c 5b5d 0d0a 2020 2020 0d0a  ], [],[]..    ..
-0001cf50: 2020 2020 636f 6c5f 696e 6974 203d 2064      col_init = d
-0001cf60: 6673 5b30 5d2e 636f 6c75 6d6e 7320 6966  fs[0].columns if
-0001cf70: 2068 6173 6174 7472 2028 6466 735b 305d   hasattr (dfs[0]
-0001cf80: 202c 2027 636f 6c75 6d6e 7327 2920 656c   , 'columns') el
-0001cf90: 7365 205b 5d20 0d0a 2020 2020 7661 6c69  se [] ..    vali
-0001cfa0: 645f 6466 7320 3d5b 5d0d 0a20 2020 2066  d_dfs =[]..    f
-0001cfb0: 6f72 206b 202c 2064 6620 696e 2065 6e75  or k , df in enu
-0001cfc0: 6d65 7261 7465 2028 6466 7329 203a 200d  merate (dfs) : .
-0001cfd0: 0a20 2020 2020 2020 2069 6620 6466 2e73  .        if df.s
-0001cfe0: 6861 7065 5b31 5d20 213d 2073 6861 7065  hape[1] != shape
-0001cff0: 5f69 6e69 7420 3a0d 0a20 2020 2020 2020  _init :..       
-0001d000: 2020 2020 2064 6966 665f 7368 6170 652e       diff_shape.
-0001d010: 6170 7065 6e64 286b 2920 0d0a 2020 2020  append(k) ..    
-0001d020: 2020 2020 656c 7365 3a20 7661 6c69 645f      else: valid_
-0001d030: 6466 732e 6170 7065 6e64 2028 6466 2029  dfs.append (df )
-0001d040: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001d050: 2020 2020 7368 6170 6573 2e61 7070 656e      shapes.appen
-0001d060: 6420 2864 662e 7368 6170 6529 0d0a 2020  d (df.shape)..  
-0001d070: 2020 2020 2020 6966 2068 6173 6174 7472        if hasattr
-0001d080: 2028 6466 2c20 2763 6f6c 756d 6e73 2729   (df, 'columns')
-0001d090: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0001d0a0: 636f 6c73 2e61 7070 656e 6420 286c 6973  cols.append (lis
-0001d0b0: 7428 6466 2e63 6f6c 756d 6e73 2029 290d  t(df.columns )).
-0001d0c0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0001d0d0: 2020 2063 6f75 6e74 7368 6170 6573 203d     countshapes =
-0001d0e0: 206c 6973 7428 436f 756e 7465 7220 2873   list(Counter (s
-0001d0f0: 6861 7065 7320 2929 2023 2069 7465 7261  hapes )) # itera
-0001d100: 626c 6520 6f62 6a65 6374 200d 0a20 2020  ble object ..   
-0001d110: 206f 6363 7368 6170 6573 203d 2063 6f75   occshapes = cou
-0001d120: 6e74 7368 6170 6573 205b 305d 2023 2074  ntshapes [0] # t
-0001d130: 6865 206d 6f73 7420 6f63 6375 7265 6e63  he most occurenc
-0001d140: 6520 7368 6170 650d 0a20 2020 2069 6620  e shape..    if 
-0001d150: 6c65 6e28 6469 6666 5f73 6861 7065 2029  len(diff_shape )
-0001d160: 213d 3020 3a20 0d0a 2020 2020 2020 2020  !=0 : ..        
-0001d170: 763d 6622 7b27 7327 2069 6620 6c65 6e28  v=f"{'s' if len(
-0001d180: 6469 6666 5f73 6861 7065 293e 3120 656c  diff_shape)>1 el
-0001d190: 7365 2027 277d 220d 0a20 2020 2020 2020  se ''}"..       
-0001d1a0: 206d 6573 7320 3d20 2822 5368 6170 6573   mess = ("Shapes
-0001d1b0: 2066 6f72 2061 6c6c 2064 6174 6120 6d75   for all data mu
-0001d1c0: 7374 2062 6520 636f 6e73 6973 7465 6e74  st be consistent
-0001d1d0: 3b20 676f 7420 2220 0d0a 2020 2020 2020  ; got " ..      
-0001d1e0: 2020 2020 2020 2020 2020 6622 6174 2074            f"at t
-0001d1f0: 6865 2070 6f73 6974 696f 6e7b 767d 207b  he position{v} {
-0001d200: 736d 6172 745f 666f 726d 6174 2864 6966  smart_format(dif
-0001d210: 665f 7368 6170 6529 7d2e 2229 0d0a 2020  f_shape)}.")..  
-0001d220: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001d230: 6966 2065 7272 6f72 203d 3d27 7261 6973  if error =='rais
-0001d240: 6527 3a20 0d0a 2020 2020 2020 2020 2020  e': ..          
-0001d250: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0001d260: 6f72 2028 6d65 7373 202b 2066 2220 4578  or (mess + f" Ex
-0001d270: 7065 6374 7320 7b6f 6363 7368 6170 6573  pects {occshapes
-0001d280: 7d22 290d 0a0d 0a20 2020 2020 2020 2077  }")....        w
-0001d290: 6172 6e69 6e67 732e 7761 726e 286d 6573  arnings.warn(mes
-0001d2a0: 7320 2b20 6622 5468 6520 6d6f 7374 2066  s + f"The most f
-0001d2b0: 7265 7175 656e 7420 7368 6170 6520 6973  requent shape is
-0001d2c0: 207b 6f63 6373 6861 7065 737d 220d 0a20   {occshapes}".. 
-0001d2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d2e0: 2020 2020 2022 2050 6c65 6173 6520 6368       " Please ch
-0001d2f0: 6563 6b20 6f72 2072 6576 6572 6966 7920  eck or reverify 
-0001d300: 796f 7572 2064 6174 612e 2054 6869 7320  your data. This 
-0001d310: 6d69 6768 7420 6c65 6164 2074 6f22 0d0a  might lead to"..
-0001d320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d330: 2020 2020 2020 2220 6272 6561 6b69 6e67        " breaking
-0001d340: 2063 6f64 6520 6f72 2069 6e76 616c 6964   code or invalid
-0001d350: 2072 6573 756c 7473 2e20 5573 6520 6174   results. Use at
-0001d360: 2079 6f75 7220 6f77 6e20 7269 736b 2e22   your own risk."
-0001d370: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001d380: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-0001d390: 2020 2073 6861 7065 3120 3d20 6c69 7374     shape1 = list
-0001d3a0: 286d 6170 2028 6c61 6d62 6461 206b 3a6b  (map (lambda k:k
-0001d3b0: 5b31 5d2c 2020 636f 756e 7473 6861 7065  [1],  countshape
-0001d3c0: 7329 290d 0a20 2020 2020 2020 200d 0a20  s))..        .. 
-0001d3d0: 2020 2020 2020 2069 6620 7365 7420 2873         if set (s
-0001d3e0: 6861 7065 3129 2021 3d31 203a 200d 0a20  hape1) !=1 : .. 
-0001d3f0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001d400: 2056 616c 7565 4572 726f 7220 2822 5368   ValueError ("Sh
-0001d410: 6170 6520 616c 6f6e 6720 6178 6973 2031  ape along axis 1
-0001d420: 206d 7573 7420 6265 2063 6f6e 7369 7374   must be consist
-0001d430: 656e 742e 2022 0d0a 2020 2020 2020 2020  ent. "..        
-0001d440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d450: 2020 2020 2020 6622 476f 7420 7b73 6d61        f"Got {sma
-0001d460: 7274 5f66 6f72 6d61 7420 2863 6f75 6e74  rt_format (count
-0001d470: 7368 6170 6573 297d 2e20 4368 6563 6b20  shapes)}. Check 
-0001d480: 7468 6520 220d 0a20 2020 2020 2020 2020  the "..         
-0001d490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d4a0: 2020 2020 2066 2264 6174 6120 6174 2070       f"data at p
-0001d4b0: 6f73 6974 696f 6e7b 767d 207b 736d 6172  osition{v} {smar
-0001d4c0: 745f 666f 726d 6174 2864 6966 665f 7368  t_format(diff_sh
-0001d4d0: 6170 6529 7d20 220d 0a20 2020 2020 2020  ape)} "..       
-0001d4e0: 2020 2020 2020 2020 2029 200d 0a20 2020           ) ..   
-0001d4f0: 2020 2020 2020 2020 200d 0a20 2020 2063           ..    c
-0001d500: 6f6c 7373 6574 203d 2073 6574 2028 206c  olsset = set ( l
-0001d510: 6973 7428 6974 6572 746f 6f6c 732e 6368  ist(itertools.ch
-0001d520: 6169 6e20 282a 636f 6c73 2029 2029 2029  ain (*cols ) ) )
-0001d530: 200d 0a20 0d0a 2020 2020 6966 206c 656e   .. ..    if len
-0001d540: 2863 6f6c 7373 6574 2029 2021 3d20 6c65  (colsset ) != le
-0001d550: 6e28 636f 6c5f 696e 6974 2920 3a20 0d0a  n(col_init) : ..
-0001d560: 2020 2020 2020 2020 7261 6973 6520 4461          raise Da
-0001d570: 7461 7365 7445 7272 6f72 2028 2245 7870  tasetError ("Exp
-0001d580: 6563 7420 6964 656e 7469 6361 6c20 636f  ect identical co
-0001d590: 6c75 6d6e 7320 666f 7220 616c 6c20 6461  lumns for all da
-0001d5a0: 7461 220d 0a20 2020 2020 2020 2020 2020  ta"..           
-0001d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d5c0: 2022 2050 6c65 6173 6520 6368 6563 6b20   " Please check 
-0001d5d0: 796f 7572 2064 6174 612e 2229 200d 0a20  your data.") .. 
-0001d5e0: 2020 200d 0a20 2020 2072 6574 7572 6e20     ..    return 
-0001d5f0: 7661 6c69 645f 6466 7320 0d0a 0d0a 4064  valid_dfs ....@d
-0001d600: 6570 7265 6361 7465 6420 2822 466f 726d  eprecated ("Form
-0001d610: 6174 2069 7320 6e6f 206c 6f6e 6765 7220  at is no longer 
-0001d620: 7573 6564 2c20 7265 706c 6163 6564 2062  used, replaced b
-0001d630: 7922 0d0a 2020 2020 2020 2020 2020 2020  y"..            
-0001d640: 2022 2060 5f41 7175 6966 6572 4772 6f75   " `_AquiferGrou
-0001d650: 702e 5f66 6f72 6d61 7460 2069 6e73 7465  p._format` inste
-0001d660: 6164 2e22 2920 2020 2020 2020 200d 0a64  ad.")        ..d
-0001d670: 6566 205f 666f 726d 6174 5f67 726f 7570  ef _format_group
-0001d680: 7320 2820 6469 6320 2c20 2f2c 206e 616d  s ( dic , /, nam
-0001d690: 6520 3d20 274c 6162 656c 2729 3a20 0d0a  e = 'Label'): ..
-0001d6a0: 2020 2020 2222 2220 5265 7072 6573 656e      """ Represen
-0001d6b0: 7420 7468 6520 6171 7569 6665 7220 6772  t the aquifer gr
-0001d6c0: 6f75 7020 616e 6420 7472 7565 206c 6162  oup and true lab
-0001d6d0: 656c 7320 7072 6570 6f6e 6465 7261 6e63  els preponderanc
-0001d6e0: 6520 2222 220d 0a20 2020 2061 673d 5b22  e """..    ag=["
-0001d6f0: 7b3a 377d 222e 666f 726d 6174 2822 4c61  {:7}".format("La
-0001d700: 6265 6c7b 7d20 2822 2e66 6f72 6d61 7428  bel{} (".format(
-0001d710: 2273 2220 6966 206c 656e 2864 6963 293e  "s" if len(dic)>
-0001d720: 3120 656c 7365 2027 2729 295d 0d0a 2020  1 else ''))]..  
-0001d730: 2020 666f 7220 6b2c 2028 6c61 6265 6c2c    for k, (label,
-0001d740: 2072 6570 725f 7661 6c20 2920 696e 2065   repr_val ) in e
-0001d750: 6e75 6d65 7261 7465 2028 2064 6963 2e69  numerate ( dic.i
-0001d760: 7465 6d73 2829 2029 3a20 0d0a 2020 2020  tems() ): ..    
-0001d770: 2020 2020 7072 6570 202c 2067 2020 3d20      prep , g  = 
-0001d780: 7265 7072 5f76 616c 200d 0a20 2020 2020  repr_val ..     
-0001d790: 2020 2061 6720 2b3d 205b 227b 303a 5e33     ag += ["{0:^3
-0001d7a0: 7d3a 207b 313a 3e31 307d 202d 3e20 7b32  }: {1:>10} -> {2
-0001d7b0: 3a3e 377d 7b33 3a3e 337d 222e 666f 726d  :>7}{3:>3}".form
-0001d7c0: 6174 2028 0d0a 2020 2020 2020 2020 2020  at (..          
-0001d7d0: 2020 6c61 6265 6c20 6966 206b 3d3d 3020    label if k==0 
-0001d7e0: 656c 7365 2022 7b3a 3e31 307d 222e 666f  else "{:>10}".fo
-0001d7f0: 726d 6174 286c 6162 656c 292c 0d0a 2020  rmat(label),..  
-0001d800: 2020 2020 2020 2020 2020 2769 6d70 6f72            'impor
-0001d810: 7461 6e63 6527 2c20 726f 756e 6428 7072  tance', round(pr
-0001d820: 6570 202a 3130 302c 2033 2920 2c20 2225  ep *100, 3) , "%
-0001d830: 2229 205d 0d0a 2020 2020 2020 2020 0d0a  ") ]..        ..
-0001d840: 2020 2020 2020 2020 6167 202b 3d5b 227b          ag +=["{
-0001d850: 3a5e 337d 5b20 2820 2741 7175 6966 6572  :^3}[ ( 'Aquifer
-0001d860: 2067 726f 7570 273a 5c6e 222e 666f 726d   group':\n".form
-0001d870: 6174 2822 3d22 295d 0d0a 2020 2020 2020  at("=")]..      
-0001d880: 2020 6167 2b3d 5b22 7b3a 3e35 307d 3a7b    ag+=["{:>50}:{
-0001d890: 3a3e 3135 7d2c 5c6e 222e 666f 726d 6174  :>15},\n".format
-0001d8a0: 2820 6b2c 2072 6f75 6e64 2876 2c20 3329  ( k, round(v, 3)
-0001d8b0: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
-0001d8c0: 2066 6f72 206b 2c20 7620 696e 2067 2e69   for k, v in g.i
-0001d8d0: 7465 6d73 2829 205d 0d0a 2020 2020 2020  tems() ]..      
-0001d8e0: 2020 0d0a 2020 2020 2020 2020 6167 2b3d    ..        ag+=
-0001d8f0: 277b 3a3e 3430 7d27 2e66 6f72 6d61 7428  '{:>40}'.format(
-0001d900: 2229 5d2c 5c6e 2022 2920 0d0a 2020 2020  ")],\n ") ..    
-0001d910: 2020 2020 0d0a 2020 2020 6167 2b3d 5b22      ..    ag+=["
-0001d920: 7b3a 3e37 7d22 2e66 6f72 6d61 7428 2229  {:>7}".format(")
-0001d930: 2229 5d0d 0a20 2020 200d 0a20 2020 2072  ")]..    ..    r
-0001d940: 6574 7572 6e20 7072 696e 7428 2727 2e6a  eturn print(''.j
-0001d950: 6f69 6e20 2861 6729 2029 200d 0a0d 0a64  oin (ag) ) ....d
-0001d960: 6566 205f 6e61 6d65 5f6d 7873 5f6c 6162  ef _name_mxs_lab
-0001d970: 656c 7328 2a73 202c 2073 6570 203d 2727  els(*s , sep =''
-0001d980: 2c20 7072 6566 6978 203d 2222 293a 200d  , prefix =""): .
-0001d990: 0a20 2020 2022 2222 204e 616d 6520 7468  .    """ Name th
-0001d9a0: 6520 4d69 7874 7572 6520 5374 7261 7465  e Mixture Strate
-0001d9b0: 6779 206c 6162 656c 7320 6672 6f6d 2061  gy labels from a
-0001d9c0: 206c 6973 7420 6f66 206c 6162 656c 7320   list of labels 
-0001d9d0: 616e 6420 0d0a 2020 2020 7369 6d69 6c61  and ..    simila
-0001d9e0: 7269 7479 2067 726f 7570 200d 0a20 2020  rity group ..   
-0001d9f0: 200d 0a20 2020 2050 6172 616d 6574 6572   ..    Parameter
-0001da00: 7320 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  s ..    --------
-0001da10: 2d2d 2d0d 0a20 2020 2073 3a20 6c69 7374  ---..    s: list
-0001da20: 200d 0a20 2020 2020 2020 204c 6973 7420   ..        List 
-0001da30: 6f66 206f 6620 7061 6972 2028 6c61 6265  of of pair (labe
-0001da40: 6c2c 2073 696d 696c 6172 6974 7920 2920  l, similarity ) 
-0001da50: 0d0a 2020 2020 5265 7475 726e 730d 0a20  ..    Returns.. 
-0001da60: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
-0001da70: 206d 7873 3a20 6c69 7374 2c20 0d0a 2020   mxs: list, ..  
-0001da80: 2020 2020 2020 636f 6d62 696e 6564 2073        combined s
-0001da90: 696d 696c 6172 6974 7920 6e61 6d65 732e  imilarity names.
-0001daa0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-0001dab0: 2045 7861 6d70 6c65 0d0a 2020 2020 2d2d   Example..    --
-0001dac0: 2d2d 2d2d 2d2d 0d0a 2020 2020 3e3e 3e20  ------..    >>> 
-0001dad0: 6672 6f6d 2077 6174 6578 2e75 7469 6c73  from watex.utils
-0001dae0: 2e68 7964 726f 7574 696c 7320 696d 706f  .hydroutils impo
-0001daf0: 7274 205f 6e61 6d65 5f6d 7873 5f6c 6162  rt _name_mxs_lab
-0001db00: 656c 7320 0d0a 2020 2020 3e3e 3e20 5f6e  els ..    >>> _n
-0001db10: 616d 655f 6d78 735f 6c61 6265 6c73 2028  ame_mxs_labels (
-0001db20: 2028 312c 2032 2920 2c20 2832 2c20 3420   (1, 2) , (2, 4 
-0001db30: 292c 2028 332c 2037 2029 2920 0d0a 2020  ), (3, 7 )) ..  
-0001db40: 2020 2e2e 2e20 5b31 322c 2032 342c 2033    ... [12, 24, 3
-0001db50: 375d 0d0a 2020 2020 3e3e 3e20 5f6e 616d  7]..    >>> _nam
-0001db60: 655f 6d78 735f 6c61 6265 6c73 2028 2028  e_mxs_labels ( (
-0001db70: 312c 2032 2920 2c20 2832 2c20 3420 292c  1, 2) , (2, 4 ),
-0001db80: 2028 332c 2037 2029 2c20 7072 6566 6978   (3, 7 ), prefix
-0001db90: 203d 276b 2729 200d 0a20 2020 202e 2e2e   ='k') ..    ...
-0001dba0: 205b 276b 3132 272c 2027 6b32 3427 2c20   ['k12', 'k24', 
-0001dbb0: 276b 3337 275d 0d0a 2020 2020 3e3e 3e20  'k37']..    >>> 
-0001dbc0: 5f6e 616d 655f 6d78 735f 6c61 6265 6c73  _name_mxs_labels
-0001dbd0: 2828 312c 2027 6772 6f75 7049 2729 2c20  ((1, 'groupI'), 
-0001dbe0: 2832 2c20 2767 726f 7570 4949 2729 2c20  (2, 'groupII'), 
-0001dbf0: 7365 703d 275f 272c 2070 7265 6669 783d  sep='_', prefix=
-0001dc00: 276b 2729 0d0a 2020 2020 2e2e 2e20 5b27  'k')..    ... ['
-0001dc10: 6b31 5f67 726f 7570 4927 2c20 276b 315f  k1_groupI', 'k1_
-0001dc20: 6772 6f75 7049 4927 5d0d 0a20 2020 200d  groupII']..    .
-0001dc30: 0a20 2020 2022 2222 0d0a 2020 2020 666f  .    """..    fo
-0001dc40: 7220 6f20 696e 2073 203a 200d 0a20 2020  r o in s : ..   
-0001dc50: 2020 2020 2069 6620 6e6f 7420 6973 5f69       if not is_i
-0001dc60: 7465 7261 626c 6528 6f29 3a0d 0a20 2020  terable(o):..   
-0001dc70: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0001dc80: 616c 7565 4572 726f 7220 280d 0a20 2020  alueError (..   
-0001dc90: 2020 2020 2020 2020 2020 2020 2022 5772               "Wr
-0001dca0: 6f6e 6720 7661 6c75 652e 2045 7870 6563  ong value. Expec
-0001dcb0: 7420 6120 7061 6972 2076 616c 7565 7320  t a pair values 
-0001dcc0: 286c 6162 656c 2c20 7369 6d69 6c61 7220  (label, similar 
-0001dcd0: 6772 6f75 7029 220d 0a20 2020 2020 2020  group)"..       
-0001dce0: 2020 2020 2020 2020 2020 2220 676f 743a            " got:
-0001dcf0: 207b 6f7d 2229 0d0a 2020 2020 2020 2020   {o}")..        
-0001dd00: 6966 206c 656e 286f 2920 213d 3220 3a0d  if len(o) !=2 :.
-0001dd10: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001dd20: 7365 2056 616c 7565 4572 726f 7220 2822  se ValueError ("
-0001dd30: 4578 7065 6374 2061 2070 6169 7220 7661  Expect a pair va
-0001dd40: 6c75 6573 2028 6c61 6265 6c2c 2073 696d  lues (label, sim
-0001dd50: 696c 6172 2067 726f 7570 5f29 2e22 0d0a  ilar group_)."..
-0001dd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd70: 2020 2020 2020 2020 2020 2020 2020 2220                " 
-0001dd80: 6e6f 7420 7b6f 7d22 290d 0a20 2020 206d  not {o}")..    m
-0001dd90: 7873 203d 6c69 7374 2829 200d 0a20 2020  xs =list() ..   
-0001dda0: 2066 6f72 206f 2069 6e20 7320 3a20 0d0a   for o in s : ..
-0001ddb0: 2020 2020 2020 2020 7873 203d 2073 7472          xs = str
-0001ddc0: 2870 7265 6669 7829 202b 2073 7472 286f  (prefix) + str(o
-0001ddd0: 5b30 5d29 202b 2073 7472 2873 6570 2920  [0]) + str(sep) 
-0001dde0: 2b20 7374 7228 6f5b 315d 290d 0a20 2020  + str(o[1])..   
-0001ddf0: 2020 2020 2074 7279 203a 200d 0a20 2020       try : ..   
-0001de00: 2020 2020 2020 2020 2078 7320 3d20 696e           xs = in
-0001de10: 7420 2878 7320 290d 0a20 2020 2020 2020  t (xs )..       
-0001de20: 2065 7863 6570 7420 3a20 0d0a 2020 2020   except : ..    
-0001de30: 2020 2020 2020 2020 7061 7373 200d 0a20          pass .. 
-0001de40: 2020 2020 2020 2066 696e 616c 6c79 3a20         finally: 
-0001de50: 6d78 732e 6170 7065 6e64 2028 7873 2029  mxs.append (xs )
-0001de60: 0d0a 2020 2020 7265 7475 726e 206d 7873  ..    return mxs
-0001de70: 200d 0a20 0d0a 6465 6620 5f4d 5853 5f69   .. ..def _MXS_i
-0001de80: 665f 6e6f 2863 6f6e 7465 7874 2c20 202f  f_no(context,  /
-0001de90: 2c20 2079 5f74 7275 6520 2c20 795f 7072  ,  y_true , y_pr
-0001dea0: 6564 202c 2063 6d73 6720 3d27 272c 2074  ed , cmsg ='', t
-0001deb0: 7261 696c 6572 203d 2022 2a22 293a 200d  railer = "*"): .
-0001dec0: 0a20 2020 2022 2222 204d 616b 6520 4d58  .    """ Make MX
-0001ded0: 5320 6163 636f 7264 696e 6720 746f 2074  S according to t
-0001dee0: 6865 2063 6f6e 7465 7874 2077 6865 7468  he context wheth
-0001def0: 6572 2061 2073 696d 696c 6172 6974 7920  er a similarity 
-0001df00: 0d0a 2020 2020 2062 6574 7765 656e 2074  ..     between t
-0001df10: 6865 2074 7275 6520 6c61 6265 6c73 2069  he true labels i
-0001df20: 6e20 2779 5f74 7275 6527 2061 6e64 204e  n 'y_true' and N
-0001df30: 4741 206c 6162 656c 7320 6973 2066 6f75  GA labels is fou
-0001df40: 6e64 206f 7220 6e6f 742e 200d 0a20 2020  nd or not. ..   
-0001df50: 2020 0d0a 2020 2020 3a70 6172 616d 2079    ..    :param y
-0001df60: 5f74 7275 653a 2061 7272 6179 2d6c 696b  _true: array-lik
-0001df70: 6520 3164 200d 0a20 2020 2020 2020 2061  e 1d ..        a
-0001df80: 7272 6179 5f6c 696b 6520 636f 6e74 6169  rray_like contai
-0001df90: 6e69 6e67 2074 6865 2074 7275 6520 6c61  ning the true la
-0001dfa0: 6265 6c73 200d 0a20 2020 203a 7061 7261  bels ..    :para
-0001dfb0: 6d20 795f 7072 6564 3a20 6172 7261 795f  m y_pred: array_
-0001dfc0: 6c69 6b65 2031 6420 0d0a 2020 2020 2020  like 1d ..      
-0001dfd0: 2020 6172 7261 7920 6f66 2074 6865 204e    array of the N
-0001dfe0: 4741 2070 7265 6469 6374 6564 206c 6162  GA predicted lab
-0001dff0: 656c 732e 200d 0a20 2020 203a 7061 7261  els. ..    :para
-0001e000: 6d20 636f 6e74 6578 743a 2073 7472 202c  m context: str ,
-0001e010: 207b 276e 6f20 7369 6d69 6c61 7269 7479   {'no similarity
-0001e020: 272c 207d 0d0a 2020 2020 3a70 6172 616d  ', }..    :param
-0001e030: 2063 736d 673a 7374 722c 200d 0a20 2020   csmg:str, ..   
-0001e040: 2020 2020 2066 6f72 6d61 7461 6765 206d       formatage m
-0001e050: 6573 7361 6765 2069 7320 7772 6f6e 6720  essage is wrong 
-0001e060: 636f 6e74 6578 7420 6973 2070 6173 7365  context is passe
-0001e070: 6420 696e 2074 6865 2077 726f 6e67 2066  d in the wrong f
-0001e080: 756e 6374 696f 6e2e 200d 0a0d 0a20 2020  unction. ....   
-0001e090: 203a 7265 7475 726e 733a 200d 0a20 2020   :returns: ..   
-0001e0a0: 2020 2020 202d 2079 5f6d 7873 3a20 6172       - y_mxs: ar
-0001e0b0: 7261 792d 6c69 6b65 2031 6420 2c20 4d58  ray-like 1d , MX
-0001e0c0: 5320 6e65 7720 6c61 6265 6c73 2063 7265  S new labels cre
-0001e0d0: 6174 6564 200d 0a20 2020 2020 2020 202d  ated ..        -
-0001e0e0: 2067 726f 7570 5f63 6c61 7373 6573 5f3a   group_classes_:
-0001e0f0: 2064 6963 742c 2074 6865 206c 6162 656c   dict, the label
-0001e100: 7320 696e 204e 4741 206c 6162 656c 7320  s in NGA labels 
-0001e110: 616e 6420 7468 6569 7220 0d0a 2020 2020  and their ..    
-0001e120: 2020 2020 2020 2020 706f 7373 6962 6c65          possible
-0001e130: 2072 656e 616d 6564 2076 616c 7565 732e   renamed values.
-0001e140: 204d 6f73 7420 6f66 2074 6865 2063 6173   Most of the cas
-0001e150: 652c 2074 6869 7320 6861 7070 656e 7320  e, this happens 
-0001e160: 200d 0a20 2020 2020 2020 2020 2020 2077   ..            w
-0001e170: 6865 6e20 7468 6520 7468 6520 6772 6f75  hen the the grou
-0001e180: 7073 2076 616c 7565 7320 6172 6520 6769  ps values are gi
-0001e190: 7665 6e20 6173 2069 6e74 6572 6765 7220  ven as interger 
-0001e1a0: 636c 6173 7365 7320 7261 7468 6572 200d  classes rather .
-0001e1b0: 0a20 2020 2020 2020 2020 2020 2074 6861  .            tha
-0001e1c0: 6e20 7374 7269 6e67 2e20 0d0a 2020 2020  n string. ..    
-0001e1d0: 2020 2020 2d20 6772 6f75 705f 6c61 6265      - group_labe
-0001e1e0: 6c73 3a20 5468 6520 7369 6d69 6c61 7220  ls: The similar 
-0001e1f0: 6c61 6265 6c73 2066 6f75 6e64 2061 7420  labels found at 
-0001e200: 7468 6520 7361 6d65 2074 696d 6520 696e  the same time in
-0001e210: 200d 0a20 2020 2020 2020 2020 2020 2027   ..            '
-0001e220: 795f 7472 7565 2720 616e 6420 4e47 4120  y_true' and NGA 
-0001e230: 6c61 6265 6c73 2e20 0d0a 2020 2020 2020  labels. ..      
-0001e240: 2020 2d20 7369 6d5f 6772 6f75 7073 3a20    - sim_groups: 
-0001e250: 6772 6f75 7073 2020 6f66 2070 6169 7220  groups  of pair 
-0001e260: 636f 6d70 6f73 6564 206f 6620 7468 6520  composed of the 
-0001e270: 7369 6d69 6c61 7220 6c61 6265 6c20 616e  similar label an
-0001e280: 6420 0d0a 2020 2020 2020 2020 2020 2020  d ..            
-0001e290: 616e 6420 7468 6520 6c61 6265 6c20 696e  and the label in
-0001e2a0: 2074 6865 2070 7265 6469 6374 6564 204e   the predicted N
-0001e2b0: 4741 2e20 0d0a 2020 2020 2020 2020 2020  GA. ..          
-0001e2c0: 2020 0d0a 2020 2020 3a65 7861 6d70 6c65    ..    :example
-0001e2d0: 3a20 0d0a 2020 2020 2020 2020 3e3e 3e20  : ..        >>> 
-0001e2e0: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-0001e2f0: 6e70 200d 0a20 2020 2020 2020 203e 3e3e  np ..        >>>
-0001e300: 2066 726f 6d20 7761 7465 782e 7574 696c   from watex.util
-0001e310: 732e 6879 6472 6f75 7469 6c73 2069 6d70  s.hydroutils imp
-0001e320: 6f72 7420 5f4d 5853 5f69 665f 6e6f 0d0a  ort _MXS_if_no..
-0001e330: 2020 2020 2020 2020 3e3e 3e20 795f 7472          >>> y_tr
-0001e340: 7565 203d 206e 702e 6172 616e 6765 2028  ue = np.arange (
-0001e350: 3529 200d 0a20 2020 2020 2020 203e 3e3e  5) ..        >>>
-0001e360: 2079 5f70 7265 6420 3d20 6e70 2e61 7261   y_pred = np.ara
-0001e370: 6e67 6520 2831 2c20 3629 200d 0a20 2020  nge (1, 6) ..   
-0001e380: 2020 2020 203e 3e3e 205f 2c20 642c 202a       >>> _, d, *
-0001e390: 5f3d 205f 4d58 535f 6966 5f6e 6f20 2827  _= _MXS_if_no ('
-0001e3a0: 6e6f 272c 2079 5f74 7275 6520 3d79 5f74  no', y_true =y_t
-0001e3b0: 7275 6520 2c20 795f 7072 6564 203d 795f  rue , y_pred =y_
-0001e3c0: 7072 6564 2029 0d0a 2020 2020 2020 2020  pred )..        
-0001e3d0: 3e3e 3e20 6420 0d0a 2020 2020 2020 2020  >>> d ..        
-0001e3e0: 2e2e 2e20 7b31 3a20 2731 2a27 2c20 323a  ... {1: '1*', 2:
-0001e3f0: 2027 322a 272c 2033 3a20 2733 2a27 2c20   '2*', 3: '3*', 
-0001e400: 343a 2027 342a 272c 2035 3a20 2735 277d  4: '4*', 5: '5'}
-0001e410: 0d0a 2020 2020 2020 2020 3e3e 3e20 5f2c  ..        >>> _,
-0001e420: 2064 2c20 2a5f 3d20 5f4d 5853 5f69 665f   d, *_= _MXS_if_
-0001e430: 6e6f 2028 276e 6f27 2c20 795f 7472 7565  no ('no', y_true
-0001e440: 203d 795f 7472 7565 202c 2079 5f70 7265   =y_true , y_pre
-0001e450: 6420 3d79 5f70 7265 642c 200d 0a20 2020  d =y_pred, ..   
-0001e460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e470: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0001e480: 7261 696c 6572 203d 4e6f 6e65 290d 0a20  railer =None).. 
-0001e490: 2020 2020 2020 203e 3e3e 2064 0d0a 2020         >>> d..  
-0001e4a0: 2020 2020 2020 2e2e 2e20 7b31 3a20 352c        ... {1: 5,
-0001e4b0: 2032 3a20 362c 2033 3a20 372c 2034 3a20   2: 6, 3: 7, 4: 
-0001e4c0: 382c 2035 3a20 397d 2023 2072 656e 616d  8, 5: 9} # renam
-0001e4d0: 6520 6c61 6265 6c73 200d 0a20 2020 2020  e labels ..     
-0001e4e0: 2020 200d 0a20 2020 2022 2222 0d0a 2020     ..    """..  
-0001e4f0: 2020 6173 7365 7274 2073 7472 2863 6f6e    assert str(con
-0001e500: 7465 7874 292e 6c6f 7765 7228 2920 696e  text).lower() in
-0001e510: 207b 276e 6f27 2c20 276e 6f20 7369 6d69   {'no', 'no simi
-0001e520: 6c61 7269 7479 272c 200d 0a20 2020 2020  larity', ..     
-0001e530: 2020 2027 7369 6d69 6c61 7269 7479 2064     'similarity d
-0001e540: 6f65 7320 6e6f 7420 6578 6973 7427 2c20  oes not exist', 
-0001e550: 2746 616c 7365 272c 2773 696d 696c 6172  'False','similar
-0001e560: 6974 7920 6e6f 7420 666f 756e 6427 0d0a  ity not found'..
-0001e570: 2020 2020 2020 2020 7d2c 2063 6d73 672e          }, cmsg.
-0001e580: 666f 726d 6174 2028 5f4d 5853 5f69 665f  format (_MXS_if_
-0001e590: 7965 732e 5f5f 6e61 6d65 5f5f 2c20 2761  yes.__name__, 'a
-0001e5a0: 7420 6c65 6173 7420 4f4e 4527 290d 0a20  t least ONE').. 
-0001e5b0: 2020 200d 0a20 2020 2023 2073 696d 696c     ..    # simil
-0001e5c0: 6172 6974 7920 6772 6f75 7073 2069 6e20  arity groups in 
-0001e5d0: 7061 6972 2028 7472 7565 206c 6162 656c  pair (true label
-0001e5e0: 202c 2073 696d 696c 6172 2067 726f 7570   , similar group
-0001e5f0: 2029 2020 2020 200d 0a20 2020 2073 696d   )     ..    sim
-0001e600: 5f67 726f 7570 7320 3d4e 6f6e 6520 0d0a  _groups =None ..
-0001e610: 2020 2020 6772 6f75 705f 6c61 6265 6c73      group_labels
-0001e620: 203d 4e6f 6e65 2023 204e 4741 2073 696d   =None # NGA sim
-0001e630: 696c 6172 2067 726f 7570 7320 0d0a 2020  ilar groups ..  
-0001e640: 2020 795f 6d78 7320 3d20 795f 7072 6564    y_mxs = y_pred
-0001e650: 2e63 6f70 7928 292e 6173 7479 7065 2028  .copy().astype (
-0001e660: 206f 626a 6563 7420 290d 0a0d 0a20 2020   object )....   
-0001e670: 2023 2067 6574 2074 6865 206c 6162 656c   # get the label
-0001e680: 2066 726f 6d20 7369 6d69 6c61 7269 7479   from similarity
-0001e690: 2067 726f 7570 733a 200d 0a20 2020 2074   groups: ..    t
-0001e6a0: 7275 655f 6c61 6265 6c73 203d 206e 702e  rue_labels = np.
-0001e6b0: 756e 6971 7565 2028 795f 7472 7565 2029  unique (y_true )
-0001e6c0: 200d 0a20 2020 2023 2020 6772 6f75 705f   ..    #  group_
-0001e6d0: 6c61 6265 6c73 203d 205b 2067 726f 7570  labels = [ group
-0001e6e0: 2020 666f 7220 5f2c 2067 726f 7570 2069    for _, group i
-0001e6f0: 6e20 7320 5d0d 0a20 2020 204e 4741 5f6c  n s ]..    NGA_l
-0001e700: 6162 656c 7320 3d20 6e70 2e75 6e69 7175  abels = np.uniqu
-0001e710: 6520 2820 795f 7072 6564 2029 200d 0a20  e ( y_pred ) .. 
-0001e720: 2020 2023 2052 656e 616d 6520 7468 6520     # Rename the 
-0001e730: 4e47 4120 6c61 6265 6c73 2075 7369 6e67  NGA labels using
-0001e740: 2074 6865 2074 7261 696c 6572 206f 7220   the trailer or 
-0001e750: 0d0a 2020 2020 2320 6164 6420 636f 6e73  ..    # add cons
-0001e760: 7461 6e74 3b20 0d0a 2020 2020 6772 6f75  tant; ..    grou
-0001e770: 705f 636c 6173 7365 735f 203d 2064 6963  p_classes_ = dic
-0001e780: 7428 2920 0d0a 2020 2020 6966 2061 6e79  t() ..    if any
-0001e790: 285b 206c 2069 6e20 7472 7565 5f6c 6162  ([ l in true_lab
-0001e7a0: 656c 7320 666f 7220 6c20 696e 204e 4741  els for l in NGA
-0001e7b0: 5f6c 6162 656c 7320 5d29 3a20 0d0a 2020  _labels ]): ..  
-0001e7c0: 2020 2020 2020 7073 6575 646f 5f4e 4741        pseudo_NGA
-0001e7d0: 5f6c 6162 656c 7320 3d20 5f63 7265 6174  _labels = _creat
-0001e7e0: 655f 6d78 735f 7073 6575 646f 5f6c 6162  e_mxs_pseudo_lab
-0001e7f0: 656c 7320 280d 0a20 2020 2020 2020 2020  els (..         
-0001e800: 2020 2079 5f74 7275 653d 795f 7472 7565     y_true=y_true
-0001e810: 202c 2079 5f70 7265 643d 795f 7072 6564   , y_pred=y_pred
-0001e820: 202c 2067 726f 7570 5f6c 6162 656c 733d   , group_labels=
-0001e830: 204e 6f6e 652c 200d 0a20 2020 2020 2020   None, ..       
-0001e840: 2020 2020 2074 7261 696c 6572 203d 7472       trailer =tr
-0001e850: 6169 6c65 7229 0d0a 2020 2020 2020 2020  ailer)..        
-0001e860: 666f 7220 6b6c 6162 656c 2069 6e20 4e47  for klabel in NG
-0001e870: 415f 6c61 6265 6c73 203a 200d 0a20 2020  A_labels : ..   
-0001e880: 2020 2020 2020 2020 206e 6b6c 6162 656c           nklabel
-0001e890: 203d 2070 7365 7564 6f5f 4e47 415f 6c61   = pseudo_NGA_la
-0001e8a0: 6265 6c73 2e67 6574 286b 6c61 6265 6c29  bels.get(klabel)
-0001e8b0: 200d 0a20 2020 2020 2020 2020 2020 206b   ..            k
-0001e8c0: 6c61 6265 6c5f 6978 2c20 203d 206e 702e  label_ix,  = np.
-0001e8d0: 7768 6572 6520 2879 5f70 7265 6420 3d3d  where (y_pred ==
-0001e8e0: 6b6c 6162 656c 290d 0a20 2020 2020 2020  klabel)..       
-0001e8f0: 2020 2020 2079 5f6d 7873 205b 6b6c 6162       y_mxs [klab
-0001e900: 656c 5f69 7820 5d20 3d20 6e6b 6c61 6265  el_ix ] = nklabe
-0001e910: 6c0d 0a20 2020 2020 2020 2020 2020 2023  l..            #
-0001e920: 206b 6565 7020 6974 2069 6e74 6f20 7468   keep it into th
-0001e930: 6520 6d6f 6469 6669 6564 2067 726f 7570  e modified group
-0001e940: 2063 6c61 7373 6573 200d 0a20 2020 2020   classes ..     
-0001e950: 2020 2020 2020 2067 726f 7570 5f63 6c61         group_cla
-0001e960: 7373 6573 5f20 5b6b 6c61 6265 6c5d 203d  sses_ [klabel] =
-0001e970: 206e 6b6c 6162 656c 200d 0a0d 0a20 2020   nklabel ....   
-0001e980: 2072 6574 7572 6e20 795f 6d78 7320 2c20   return y_mxs , 
-0001e990: 6772 6f75 705f 636c 6173 7365 735f 202c  group_classes_ ,
-0001e9a0: 2067 726f 7570 5f6c 6162 656c 7320 2c20   group_labels , 
-0001e9b0: 7369 6d5f 6772 6f75 7073 200d 0a0d 0a64  sim_groups ....d
-0001e9c0: 6566 205f 6372 6561 7465 5f6d 7873 5f70  ef _create_mxs_p
-0001e9d0: 7365 7564 6f5f 6c61 6265 6c73 280d 0a20  seudo_labels(.. 
-0001e9e0: 2020 2020 2020 2079 5f74 7275 652c 2079         y_true, y
-0001e9f0: 5f70 7265 642c 2067 726f 7570 5f6c 6162  _pred, group_lab
-0001ea00: 656c 7320 3d20 4e6f 6e65 202c 2074 7261  els = None , tra
-0001ea10: 696c 6572 203d 272a 2729 3a20 0d0a 2020  iler ='*'): ..  
-0001ea20: 2020 2222 2220 6372 6561 7465 2070 7365    """ create pse
-0001ea30: 7564 6f20 4d58 5320 6c61 6265 6c73 2020  udo MXS labels  
-0001ea40: 616e 6420 7361 7665 2069 7420 696e 2070  and save it in p
-0001ea50: 7365 7564 6f2d 6469 6374 2e20 0d0a 2020  seudo-dict. ..  
-0001ea60: 2020 0d0a 2020 2020 6966 206c 6162 656c    ..    if label
-0001ea70: 7320 6e6f 7420 696e 2074 6865 2067 726f  s not in the gro
-0001ea80: 7570 2069 7320 666f 756e 6420 696e 2074  up is found in t
-0001ea90: 6865 2063 6c61 7373 206c 6162 656c 7320  he class labels 
-0001eaa0: 6f66 2074 6865 2027 795f 7472 7565 272c  of the 'y_true',
-0001eab0: 200d 0a20 2020 2072 656e 616d 6520 6974   ..    rename it
-0001eac0: 2075 7369 6e67 2074 6865 204d 5853 2074   using the MXS t
-0001ead0: 7261 696c 6572 2027 2a27 2061 7320 6120  railer '*' as a 
-0001eae0: 7370 6563 6961 6c20 636c 6173 7320 6c61  special class la
-0001eaf0: 6265 6c2e 200d 0a20 2020 206f 7468 6572  bel. ..    other
-0001eb00: 7769 7365 2073 6b69 7070 6564 2e20 0d0a  wise skipped. ..
-0001eb10: 2020 2020 0d0a 2020 2020 4966 2074 6865      ..    If the
-0001eb20: 2067 726f 7570 206c 6162 656c 2069 7320   group label is 
-0001eb30: 6e6f 7420 666f 756e 6420 696e 2074 6865  not found in the
-0001eb40: 2063 6c61 7373 206c 6162 656c 7320 6f66   class labels of
-0001eb50: 2074 6865 2027 795f 7472 7565 272c 2069   the 'y_true', i
-0001eb60: 7420 0d0a 2020 2020 646f 6573 206e 6f74  t ..    does not
-0001eb70: 206e 6565 6420 746f 2072 656e 616d 6520   need to rename 
-0001eb80: 6974 2e20 4b65 6570 2069 7420 696e 7461  it. Keep it inta
-0001eb90: 6374 202c 2068 6f77 6576 6572 2062 6563  ct , however bec
-0001eba0: 6175 7365 2c20 7468 6520 6474 7970 6520  ause, the dtype 
-0001ebb0: 6861 7320 0d0a 2020 2020 6368 616e 6765  has ..    change
-0001ebc0: 2074 6f20 7374 7269 6e67 2c20 7468 6520   to string, the 
-0001ebd0: 636c 6173 7320 6c61 6265 6c20 7368 6f75  class label shou
-0001ebe0: 6c64 206e 6f20 6c6f 6e67 6572 2062 6520  ld no longer be 
-0001ebf0: 616e 2069 6e74 6567 6572 2e20 0d0a 2020  an integer. ..  
-0001ec00: 2020 0d0a 2020 2020 3a70 6172 616d 2079    ..    :param y
-0001ec10: 5f74 7275 653a 2061 7272 6179 2d6c 696b  _true: array-lik
-0001ec20: 6520 3164 202c 200d 0a20 2020 2020 2020  e 1d , ..       
-0001ec30: 2061 7272 6179 206f 6620 7468 6520 636c   array of the cl
-0001ec40: 6173 7320 6c61 6265 6c20 696e 2027 795f  ass label in 'y_
-0001ec50: 7472 7565 2720 200d 0a20 2020 203a 7061  true'  ..    :pa
-0001ec60: 7261 6d20 795f 7072 6564 3a20 6172 7261  ram y_pred: arra
-0001ec70: 792d 6c69 6b65 2031 642c 200d 0a20 2020  y-like 1d, ..   
-0001ec80: 2020 2020 2061 7272 6179 206f 6620 7468       array of th
-0001ec90: 6520 7072 6564 6963 7465 6420 636c 6173  e predicted clas
-0001eca0: 7320 284d 6978 7475 7265 2061 7272 6179  s (Mixture array
-0001ecb0: 2920 7468 6174 2063 6f6e 7461 696e 7320  ) that contains 
-0001ecc0: 0d0a 2020 2020 2020 2020 7468 6520 4e47  ..        the NG
-0001ecd0: 4120 6c61 6265 6c73 2e20 0d0a 2020 2020  A labels. ..    
-0001ece0: 3a70 6172 616d 2067 726f 7570 5f6c 6162  :param group_lab
-0001ecf0: 656c 733a 206c 6973 742c 200d 0a20 2020  els: list, ..   
-0001ed00: 2020 2020 206c 6973 7420 6f66 2074 6865       list of the
-0001ed10: 206c 6162 656c 2066 726f 6d20 2779 5f70   label from 'y_p
-0001ed20: 7265 6427 2074 6861 7420 7369 6d69 6c61  red' that simila
-0001ed30: 7269 7479 2068 6173 2062 6565 6e20 666f  rity has been fo
-0001ed40: 756e 6420 696e 200d 0a20 2020 2020 2020  und in ..       
-0001ed50: 2074 6865 2027 795f 7472 7565 272e 2046   the 'y_true'. F
-0001ed60: 6f72 2074 6869 7320 7265 6173 6f6e 2c20  or this reason, 
-0001ed70: 7369 6e63 6520 6974 7320 7369 6d69 6c61  since its simila
-0001ed80: 7269 7469 6573 2068 6176 6520 6120 7370  rities have a sp
-0001ed90: 6563 6961 6c20 0d0a 2020 2020 2020 2020  ecial ..        
-0001eda0: 636c 6173 7320 6c61 6265 6c20 6e6f 6d65  class label nome
-0001edb0: 6e63 6c61 7475 7265 732c 2069 7420 7769  nclatures, it wi
-0001edc0: 6c6c 2062 6520 6469 7363 7261 6465 6420  ll be discraded 
-0001edd0: 6672 6f6d 2074 6865 2027 795f 7072 6564  from the 'y_pred
-0001ede0: 2720 692e 6520 0d0a 2020 2020 2020 2020  ' i.e ..        
-0001edf0: 7468 6520 7072 6564 6963 7465 6420 4e47  the predicted NG
-0001ee00: 4120 6c61 6265 6c73 2e20 5468 7573 206f  A labels. Thus o
-0001ee10: 6e6c 7920 7468 6520 4e47 4120 6c61 6265  nly the NGA labe
-0001ee20: 6c73 2065 7863 6570 7420 7468 6520 200d  ls except the  .
-0001ee30: 0a20 2020 2020 2020 2060 6772 6f75 705f  .        `group_
-0001ee40: 6c61 6265 6c73 6020 6172 6520 7573 6564  labels` are used
-0001ee50: 2066 6f72 2072 656e 616d 696e 672e 0d0a   for renaming...
-0001ee60: 2020 2020 3a70 6172 616d 2074 7261 696c      :param trail
-0001ee70: 6572 3a20 7374 722c 2064 6566 6175 6c74  er: str, default
-0001ee80: 3d27 2a27 0d0a 2020 2020 2020 2020 5468  ='*'..        Th
-0001ee90: 6520 4d69 7874 7572 6520 7374 7261 7465  e Mixture strate
-0001eea0: 6779 206d 6172 6b65 7220 746f 2064 6966  gy marker to dif
-0001eeb0: 6665 7265 6e74 6961 7465 2074 6865 2065  ferentiate the e
-0001eec0: 7869 7374 696e 6720 636c 6173 7320 6c61  xisting class la
-0001eed0: 6265 6c20 200d 0a20 2020 2020 2020 2069  bel  ..        i
-0001eee0: 6e20 2779 5f74 7275 6527 2077 6974 6820  n 'y_true' with 
-0001eef0: 7468 6520 7072 6564 6963 7465 6420 6c61  the predicted la
-0001ef00: 6265 6c73 2027 795f 7072 6564 2720 6573  bels 'y_pred' es
-0001ef10: 7065 6369 616c 6c79 2077 6865 6e20 200d  pecially when  .
-0001ef20: 0a20 2020 2020 2020 2074 6865 2074 6865  .        the the
-0001ef30: 2073 616d 6520 636c 6173 7320 6c61 6265   same class labe
-0001ef40: 6c73 2061 7265 2061 6c73 6f20 7072 6573  ls are also pres
-0001ef50: 656e 7420 7468 6520 7472 7565 206c 6162  ent the true lab
-0001ef60: 656c 2077 6974 6820 7468 6520 0d0a 2020  el with the ..  
-0001ef70: 2020 2020 2020 7361 6d65 206c 6162 656c        same label
-0001ef80: 2d69 6465 6e74 6966 6965 7220 6e61 6d65  -identifier name
-0001ef90: 2e20 5468 6973 2075 7365 6675 6c6c 2020  . This usefull  
-0001efa0: 746f 2061 766f 6964 2061 6e79 2063 6f6e  to avoid any con
-0001efb0: 6675 7369 6f6e 2020 666f 720d 0a20 2020  fusion  for..   
-0001efc0: 2020 2020 2062 6f74 6820 6c61 6265 6c73       both labels
-0001efd0: 2020 696e 2060 795f 7472 7565 6020 616e    in `y_true` an
-0001efe0: 6420 6079 5f70 7265 6460 2066 6f72 2062  d `y_pred` for b
-0001eff0: 6574 7465 7220 6465 6d61 7263 6174 696f  etter demarcatio
-0001f000: 6e20 616e 6420 0d0a 2020 2020 2020 2020  n and ..        
-0001f010: 6469 7374 696e 6374 696f 6e2e 204e 6f74  distinction. Not
-0001f020: 6520 7468 6174 2069 6620 7468 6520 6074  e that if the `t
-0001f030: 7261 696c 6572 6069 7320 7365 7420 746f  railer`is set to
-0001f040: 2060 604e 6f6e 6560 6020 616e 6420 626f   ``None`` and bo
-0001f050: 7468 200d 0a20 2020 2020 2020 2060 795f  th ..        `y_
-0001f060: 7472 7565 6020 616e 6420 6079 5f70 7265  true` and `y_pre
-0001f070: 6460 2061 7265 206e 756d 6572 6963 2064  d` are numeric d
-0001f080: 6174 612c 2074 6865 206c 6162 656c 7320  ata, the labels 
-0001f090: 696e 2060 795f 7072 6564 6020 6172 6520  in `y_pred` are 
-0001f0a0: 0d0a 2020 2020 2020 2020 7379 7374 656d  ..        system
-0001f0b0: 6174 6963 616c 6c79 2072 656e 616d 6564  atically renamed
-0001f0c0: 2074 6f20 6265 2064 6973 7469 6e63 7420   to be distinct 
-0001f0d0: 7769 7468 2074 6865 206f 6e65 7320 696e  with the ones in
-0001f0e0: 2074 6865 2027 795f 7472 7565 272e 200d   the 'y_true'. .
-0001f0f0: 0a20 2020 2020 2020 200d 0a20 2020 203a  .        ..    :
-0001f100: 7265 7475 726e 733a 200d 0a20 2020 2020  returns: ..     
-0001f110: 2020 2070 7365 7564 6f5f 6469 6374 3a20     pseudo_dict: 
-0001f120: 6469 6374 2c20 0d0a 2020 2020 2020 2020  dict, ..        
-0001f130: 2020 2020 6469 6374 696f 6e6e 6172 7920      dictionnary 
-0001f140: 636f 6d70 6f73 6564 206f 6620 7468 6520  composed of the 
-0001f150: 4e47 4120 6c61 6265 6c73 2074 6861 7420  NGA labels that 
-0001f160: 6172 6520 6e6f 7420 696e 2060 6772 6f75  are not in `grou
-0001f170: 705f 6c61 6265 6c73 600d 0a20 2020 2020  p_labels`..     
-0001f180: 2020 2020 2020 2061 6e64 2077 686f 7365         and whose
-0001f190: 2074 6865 6972 206c 6162 656c 7320 6861   their labels ha
-0001f1a0: 7665 2062 6565 6e20 7265 6e61 6d65 642e  ve been renamed.
-0001f1b0: 200d 0a20 2020 203a 6578 616d 706c 653a   ..    :example:
-0001f1c0: 200d 0a20 2020 2020 2020 203e 3e3e 2066   ..        >>> f
-0001f1d0: 726f 6d20 7761 7465 782e 7574 696c 732e  rom watex.utils.
-0001f1e0: 6879 6472 6f75 7469 6c73 2069 6d70 6f72  hydroutils impor
-0001f1f0: 7420 5f63 7265 6174 655f 6d78 735f 7073  t _create_mxs_ps
-0001f200: 6575 646f 5f6c 6162 656c 7320 0d0a 2020  eudo_labels ..  
-0001f210: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-0001f220: 206e 756d 7079 2061 7320 6e70 200d 0a20   numpy as np .. 
-0001f230: 2020 2020 2020 203e 3e3e 2079 5f74 7275         >>> y_tru
-0001f240: 6520 3d20 6e70 2e61 7261 6e67 6520 2835  e = np.arange (5
-0001f250: 2920 0d0a 2020 2020 2020 2020 3e3e 3e20  ) ..        >>> 
-0001f260: 795f 7072 6564 203d 206e 702e 6172 616e  y_pred = np.aran
-0001f270: 6765 2028 312c 2036 2920 0d0a 2020 2020  ge (1, 6) ..    
-0001f280: 2020 2020 3e3e 3e20 6772 6f75 705f 6c61      >>> group_la
-0001f290: 6265 6c73 203d 5b32 2c20 335d 2023 206f  bels =[2, 3] # o
-0001f2a0: 6e6c 7920 3220 616e 6420 3320 7468 6174  nly 2 and 3 that
-0001f2b0: 2068 6176 6520 7369 6d69 6c61 7269 7479   have similarity
-0001f2c0: 200d 0a20 2020 2020 2020 203e 3e3e 205f   ..        >>> _
-0001f2d0: 6372 6561 7465 5f6d 7873 5f70 7365 7564  create_mxs_pseud
-0001f2e0: 6f5f 6c61 6265 6c73 2028 795f 7472 7565  o_labels (y_true
-0001f2f0: 2c20 795f 7072 6564 2c20 6772 6f75 705f  , y_pred, group_
-0001f300: 6c61 6265 6c73 2029 0d0a 2020 2020 2020  labels )..      
-0001f310: 2020 2e2e 2e20 7b31 3a20 2731 2a27 2c20    ... {1: '1*', 
-0001f320: 343a 2027 342a 272c 2035 3a20 2735 2a27  4: '4*', 5: '5*'
-0001f330: 7d0d 0a20 2020 2020 2020 203e 3e3e 2023  }..        >>> #
-0001f340: 2063 7265 6174 6520 6120 7073 6575 646f   create a pseudo
-0001f350: 204d 5853 206c 6162 656c 7320 7768 656e   MXS labels when
-0001f360: 2020 6772 6f75 7020 6973 204e 6f6e 650d    group is None.
-0001f370: 0a20 2020 2020 2020 203e 3e3e 205f 6372  .        >>> _cr
-0001f380: 6561 7465 5f6d 7873 5f70 7365 7564 6f5f  eate_mxs_pseudo_
-0001f390: 6c61 6265 6c73 2028 795f 7472 7565 2c20  labels (y_true, 
-0001f3a0: 795f 7072 6564 2c20 4e6f 6e65 2029 0d0a  y_pred, None )..
-0001f3b0: 2020 2020 2020 2020 2e2e 2e20 7b27 3127          ... {'1'
-0001f3c0: 3a20 2731 2a27 2c20 2732 273a 2027 322a  : '1*', '2': '2*
-0001f3d0: 272c 2027 3327 3a20 2733 2a27 2c20 2734  ', '3': '3*', '4
-0001f3e0: 273a 2027 342a 272c 2027 3527 3a20 2735  ': '4*', '5': '5
-0001f3f0: 277d 0d0a 2020 2020 2020 2020 3e3e 3e20  '}..        >>> 
-0001f400: 2320 2a63 6f6d 6d65 6e74 7320 0d0a 2020  # *comments ..  
-0001f410: 2020 2020 2020 2020 2020 2320 7468 6520            # the 
-0001f420: 6162 6f76 6520 7265 7375 6c74 7320 6465  above results de
-0001f430: 6d61 7263 6174 6564 2074 6865 206c 6162  marcated the lab
-0001f440: 656c 2069 6e20 795f 7072 6564 2074 6861  el in y_pred tha
-0001f450: 7420 0d0a 2020 2020 2020 2020 2020 2020  t ..            
-0001f460: 2320 6578 6973 7420 696e 2079 5f74 7275  # exist in y_tru
-0001f470: 6520 7573 696e 6720 7468 6520 6465 6661  e using the defa
-0001f480: 756c 7420 7472 6169 6c65 7220 272a 270d  ult trailer '*'.
-0001f490: 0a20 2020 2020 2020 203e 3e3e 2023 2020  .        >>> #  
-0001f4a0: 6265 6361 7573 6520 7468 6520 6269 7468  because the bith
-0001f4b0: 2079 5f74 7275 6520 616e 6420 795f 7072   y_true and y_pr
-0001f4c0: 6564 2061 7265 206e 756d 6572 6963 202c  ed are numeric ,
-0001f4d0: 206c 6574 2073 6574 200d 0a20 2020 2020   let set ..     
-0001f4e0: 2020 203e 3e3e 2023 2074 6865 2074 7261     >>> # the tra
-0001f4f0: 696c 6572 2074 6f20 4e6f 6e65 200d 0a20  iler to None .. 
-0001f500: 2020 2020 2020 203e 3e3e 205f 6372 6561         >>> _crea
-0001f510: 7465 5f6d 7873 5f70 7365 7564 6f5f 6c61  te_mxs_pseudo_la
-0001f520: 6265 6c73 2028 795f 7472 7565 2c20 795f  bels (y_true, y_
-0001f530: 7072 6564 2c20 4e6f 6e65 202c 2074 7261  pred, None , tra
-0001f540: 696c 6572 203d 204e 6f6e 6529 0d0a 2020  iler = None)..  
-0001f550: 2020 2020 2020 2e2e 2e20 7b31 3a20 352c        ... {1: 5,
-0001f560: 2032 3a20 362c 2033 3a20 372c 2034 3a20   2: 6, 3: 7, 4: 
-0001f570: 382c 2035 3a20 397d 0d0a 2020 2020 2020  8, 5: 9}..      
-0001f580: 2020 3e3e 3e20 2320 2a20 636f 6d6d 656e    >>> # * commen
-0001f590: 7473 3a20 0d0a 2020 2020 2020 2020 2020  ts: ..          
-0001f5a0: 2020 2320 4769 7665 7320 7468 6520 6469    # Gives the di
-0001f5b0: 6666 6572 656e 7473 206d 6170 2063 6861  fferents map cha
-0001f5c0: 6e67 6573 202e 2054 6875 7320 6c61 6265  nges . Thus labe
-0001f5d0: 6c20 3120 696e 2079 5f70 7265 6420 0d0a  l 1 in y_pred ..
-0001f5e0: 2020 2020 2020 2020 2020 2020 2320 6265              # be
-0001f5f0: 636f 6d65 206c 6162 656c 2035 2c20 6c61  come label 5, la
-0001f600: 6265 6c20 3220 6265 636f 6d65 206c 6162  bel 2 become lab
-0001f610: 656c 2036 2061 6e64 2073 6f20 6f6e 2e20  el 6 and so on. 
-0001f620: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0001f630: 7468 6973 2069 7320 7065 7266 6f72 6d65  this is performe
-0001f640: 6420 746f 2061 766f 6964 2063 6f6e 6675  d to avoid confu
-0001f650: 7369 6e67 2074 6865 206c 6162 656c 2069  sing the label i
-0001f660: 6e20 795f 7472 7565 200d 0a20 2020 2020  n y_true ..     
-0001f670: 2020 2020 2020 2023 2077 6865 7265 2031         # where 1
-0001f680: 2c20 322c 2033 2c20 3420 6172 6520 616c  , 2, 3, 4 are al
-0001f690: 736f 2070 7265 7365 6e74 732e 200d 0a20  so presents. .. 
-0001f6a0: 2020 2020 2020 203e 3e3e 2023 206c 6574         >>> # let
-0001f6b0: 2063 7265 6174 6520 6120 6d61 7020 7768   create a map wh
-0001f6c0: 6572 6520 795f 7472 7565 2061 6e64 2079  ere y_true and y
-0001f6d0: 5f70 7265 6420 6172 6520 6469 6666 6572  _pred are differ
-0001f6e0: 656e 7420 616e 6420 0d0a 2020 2020 2020  ent and ..      
-0001f6f0: 2020 3e3e 3e20 2320 6e6f 7420 6e75 6d65    >>> # not nume
-0001f700: 7269 6320 7661 6c75 6573 200d 0a20 2020  ric values ..   
-0001f710: 2020 2020 203e 3e3e 2079 5f74 7275 655f       >>> y_true_
-0001f720: 6e6f 203d 206e 702e 6172 7261 7920 285b  no = np.array ([
-0001f730: 276b 3127 2c20 276b 3227 2c20 276b 3327  'k1', 'k2', 'k3'
-0001f740: 5d29 200d 0a20 2020 2020 2020 203e 3e3e  ]) ..        >>>
-0001f750: 2079 5f70 7265 645f 6e6f 203d 206e 702e   y_pred_no = np.
-0001f760: 6172 7261 7928 5b27 6331 272c 2027 6332  array(['c1', 'c2
-0001f770: 272c 2027 6333 275d 290d 0a20 2020 2020  ', 'c3'])..     
-0001f780: 2020 203e 3e3e 205f 6372 6561 7465 5f6d     >>> _create_m
-0001f790: 7873 5f70 7365 7564 6f5f 6c61 6265 6c73  xs_pseudo_labels
-0001f7a0: 2028 795f 7472 7565 5f6e 6f2c 2079 5f70   (y_true_no, y_p
-0001f7b0: 7265 645f 6e6f 2c20 4e6f 6e65 2029 0d0a  red_no, None )..
-0001f7c0: 2020 2020 2020 2020 0d0a 2020 2020 2222          ..    ""
-0001f7d0: 2220 0d0a 2020 2020 6772 6f75 705f 6c61  " ..    group_la
-0001f7e0: 6265 6c73 203d 2067 726f 7570 5f6c 6162  bels = group_lab
-0001f7f0: 656c 7320 6f72 2020 5b5d 0d0a 2020 2020  els or  []..    
-0001f800: 6966 206e 6f74 2068 6173 6174 7472 2028  if not hasattr (
-0001f810: 6772 6f75 705f 6c61 6265 6c73 2c20 275f  group_labels, '_
-0001f820: 5f6c 656e 5f5f 2729 3a20 0d0a 2020 2020  _len__'): ..    
-0001f830: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001f840: 7272 6f72 2028 2247 726f 7570 206c 6162  rror ("Group lab
-0001f850: 656c 2063 616e 2774 2062 6520 4e6f 6e65  el can't be None
-0001f860: 2061 6e64 206d 7573 7420 6265 2061 6e20   and must be an 
-0001f870: 6974 6572 6162 6c65 220d 0a20 2020 2020  iterable"..     
-0001f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f890: 2020 2020 2020 6622 206f 626a 6563 742e        f" object.
-0001f8a0: 2047 6f74 3a20 7b74 7970 6528 6772 6f75   Got: {type(grou
-0001f8b0: 705f 6c61 6265 6c73 292e 5f5f 6e61 6d65  p_labels).__name
-0001f8c0: 5f5f 2172 7d22 0d0a 2020 2020 2020 2020  __!r}"..        
-0001f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f8e0: 2020 2029 0d0a 2020 2020 6966 206e 6f74     )..    if not
-0001f8f0: 2028 5f69 735f 6172 7261 796c 696b 655f   (_is_arraylike_
-0001f900: 3164 2879 5f70 7265 6420 2920 616e 6420  1d(y_pred ) and 
-0001f910: 5f69 735f 6172 7261 796c 696b 655f 3164  _is_arraylike_1d
-0001f920: 2879 5f74 7275 6529 293a 200d 0a20 2020  (y_true)): ..   
-0001f930: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0001f940: 7272 6f72 2028 2227 7927 2065 7870 6563  rror ("'y' expec
-0001f950: 7473 2074 6f20 6265 2061 6e20 6172 7261  ts to be an arra
-0001f960: 792d 6c69 6b65 2031 6420 2229 200d 0a20  y-like 1d ") .. 
-0001f970: 2020 2020 2020 200d 0a20 2020 205f 6368         ..    _ch
-0001f980: 6563 6b5f 636f 6e73 6973 7465 6e63 795f  eck_consistency_
-0001f990: 7369 7a65 2879 5f74 7275 652c 2079 5f70  size(y_true, y_p
-0001f9a0: 7265 6429 200d 0a20 2020 200d 0a20 2020  red) ..    ..   
-0001f9b0: 2074 7275 655f 6c61 6265 6c73 5f6f 7269   true_labels_ori
-0001f9c0: 6720 3d20 6e70 2e75 6e69 7175 6520 2879  g = np.unique (y
-0001f9d0: 5f74 7275 6529 200d 0a20 2020 204e 4741  _true) ..    NGA
-0001f9e0: 5f6c 6162 656c 7320 3d20 6e70 2e75 6e69  _labels = np.uni
-0001f9f0: 7175 6520 2879 5f70 7265 6429 0d0a 2020  que (y_pred)..  
-0001fa00: 2020 7073 6575 646f 5f64 6963 7420 3d20    pseudo_dict = 
-0001fa10: 7b7d 200d 0a20 2020 2023 2063 6f6d 7075  {} ..    # compu
-0001fa20: 7465 2074 6865 206c 6162 656c 7320 6e6f  te the labels no
-0001fa30: 7420 0d0a 2020 2020 2320 696e 2074 6865  t ..    # in the
-0001fa40: 2067 726f 7570 200d 0a20 2020 206c 6162   group ..    lab
-0001fa50: 656c 735f 6e6f 745f 696e 5f67 6f75 7073  els_not_in_goups
-0001fa60: 203d 2069 735f 696e 5f69 6628 4e47 415f   = is_in_if(NGA_
-0001fa70: 6c61 6265 6c73 2c20 6772 6f75 705f 6c61  labels, group_la
-0001fa80: 6265 6c73 202c 200d 0a20 2020 2020 2020  bels , ..       
-0001fa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001faa0: 2020 2020 7265 7475 726e 5f64 6966 663d      return_diff=
-0001fab0: 2054 7275 6529 0d0a 2020 2020 6966 206c   True)..    if l
-0001fac0: 6162 656c 735f 6e6f 745f 696e 5f67 6f75  abels_not_in_gou
-0001fad0: 7073 2069 7320 4e6f 6e65 3a0d 0a20 2020  ps is None:..   
-0001fae0: 2020 2020 2072 6574 7572 6e20 2070 7365       return  pse
-0001faf0: 7564 6f5f 6469 6374 200d 0a20 2020 200d  udo_dict ..    .
-0001fb00: 0a20 2020 2070 7365 7564 6f5f 6c61 6265  .    pseudo_labe
-0001fb10: 6c73 203d 206e 702e 6172 7261 7928 6c61  ls = np.array(la
-0001fb20: 6265 6c73 5f6e 6f74 5f69 6e5f 676f 7570  bels_not_in_goup
-0001fb30: 7329 200d 0a20 2020 200d 0a20 2020 2023  s) ..    ..    #
-0001fb40: 2063 6865 636b 2077 6865 7468 6572 2062   check whether b
-0001fb50: 6f74 6820 6461 7461 2061 7265 2067 6976  oth data are giv
-0001fb60: 656e 2061 7320 6e75 6d65 7269 6320 6461  en as numeric da
-0001fb70: 7461 0d0a 2020 2020 2320 736f 2074 6865  ta..    # so the
-0001fb80: 206e 756d 6572 6963 206c 6162 656c 2063   numeric label c
-0001fb90: 616e 2062 6520 7265 6e61 6d65 2062 7920  an be rename by 
-0001fba0: 746f 7070 696e 6720 7468 6520 6d61 7820  topping the max 
-0001fbb0: 7661 6c75 6520 0d0a 2020 2020 2320 676f  value ..    # go
-0001fbc0: 7420 6672 6f6d 2074 6865 2074 7275 655f  t from the true_
-0001fbd0: 6c61 6265 6c73 2074 6f20 7468 6520 7072  labels to the pr
-0001fbe0: 6564 6963 7465 6420 6c61 6265 6c20 0d0a  edicted label ..
-0001fbf0: 2020 2020 2320 7072 6f76 6964 6564 2074      # provided t
-0001fc00: 6861 7420 7472 6169 6c65 7220 6973 204e  hat trailer is N
-0001fc10: 6f6e 652e 0d0a 2020 2020 6973 5f6e 756d  one...    is_num
-0001fc20: 6572 6963 203d 2046 616c 7365 200d 0a20  eric = False .. 
-0001fc30: 2020 2069 6620 285f 6973 5f6e 756d 6572     if (_is_numer
-0001fc40: 6963 5f64 7479 7065 2874 7275 655f 6c61  ic_dtype(true_la
-0001fc50: 6265 6c73 5f6f 7269 6729 200d 0a20 2020  bels_orig) ..   
-0001fc60: 2020 2020 2061 6e64 205f 6973 5f6e 756d       and _is_num
-0001fc70: 6572 6963 5f64 7479 7065 286c 6162 656c  eric_dtype(label
-0001fc80: 735f 6e6f 745f 696e 5f67 6f75 7073 2c20  s_not_in_goups, 
-0001fc90: 746f 5f61 7272 6179 3d54 7275 6529 0d0a  to_array=True)..
-0001fca0: 2020 2020 2020 2020 293a 2069 735f 6e75          ): is_nu
-0001fcb0: 6d65 7269 6320 3d20 5472 7565 200d 0a20  meric = True .. 
-0001fcc0: 2020 200d 0a20 2020 2023 206d 616e 6167     ..    # manag
-0001fcd0: 6520 7472 6169 6c65 7220 0d0a 2020 2020  e trailer ..    
-0001fce0: 7472 6169 6c65 7220 3d20 4e6f 6e65 2069  trailer = None i
-0001fcf0: 6620 7472 6169 6c65 7220 696e 2028 2727  f trailer in (''
-0001fd00: 2c20 4e6f 6e65 2920 656c 7365 2073 7472  , None) else str
-0001fd10: 2874 7261 696c 6572 2920 0d0a 2020 2020  (trailer) ..    
-0001fd20: 6966 2074 7261 696c 6572 2069 7320 4e6f  if trailer is No
-0001fd30: 6e65 3a0d 0a20 2020 2020 2020 2023 202d  ne:..        # -
-0001fd40: 3e20 696d 7072 6f76 6520 7468 6520 7761  > improve the wa
-0001fd50: 726e 696e 6720 6d65 7373 6167 6520 0d0a  rning message ..
-0001fd60: 2020 2020 2020 2020 6e6c 6162 733d 2069          nlabs= i
-0001fd70: 735f 696e 5f69 6628 4e47 415f 6c61 6265  s_in_if(NGA_labe
-0001fd80: 6c73 2c20 7472 7565 5f6c 6162 656c 735f  ls, true_labels_
-0001fd90: 6f72 6967 2c20 0d0a 2020 2020 2020 2020  orig, ..        
-0001fda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fdb0: 2020 2020 2020 2072 6574 7572 6e5f 696e         return_in
-0001fdc0: 7465 7273 6563 743d 5472 7565 290d 0a20  tersect=True).. 
-0001fdd0: 2020 2020 2020 2077 6172 6e5f 6d73 6720         warn_msg 
-0001fde0: 3d20 280d 0a20 2020 2020 2020 2020 2020  = (..           
-0001fdf0: 2022 4e6f 7465 2074 6861 7420 7b30 7d20   "Note that {0} 
-0001fe00: 6c61 6265 6c7b 317d 2069 6e20 2779 5f70  label{1} in 'y_p
-0001fe10: 7265 6427 207b 327d 2061 6c73 6f20 6176  red' {2} also av
-0001fe20: 6169 6c61 6265 2069 6e20 220d 0a20 2020  ailabe in "..   
-0001fe30: 2020 2020 2020 2020 2022 2779 5f74 7275           "'y_tru
-0001fe40: 6527 2077 6974 6820 7468 6520 7361 6d65  e' with the same
-0001fe50: 206c 6162 656c 2d69 6465 6e74 6966 6965   label-identifie
-0001fe60: 7220 616e 6420 6172 6520 6e6f 7420 7265  r and are not re
-0001fe70: 6e61 6d65 642e 220d 0a20 2020 2020 2020  named."..       
-0001fe80: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
-0001fe90: 200d 0a20 2020 2020 2020 2077 6172 6e5f   ..        warn_
-0001fea0: 6d73 6720 3d20 7761 726e 5f6d 7367 2e66  msg = warn_msg.f
-0001feb0: 6f72 6d61 7420 280d 0a20 2020 2020 2020  ormat (..       
-0001fec0: 2020 2020 206c 656e 286e 6c61 6273 292c       len(nlabs),
-0001fed0: 2022 7322 2069 6620 6c65 6e28 6e6c 6162   "s" if len(nlab
-0001fee0: 7329 203e 2031 2065 6c73 6520 2727 2c20  s) > 1 else '', 
-0001fef0: 2261 7265 2220 6966 206c 656e 280d 0a20  "are" if len(.. 
-0001ff00: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001ff10: 6c61 6273 293e 3120 656c 7365 2027 6973  labs)>1 else 'is
-0001ff20: 2729 2069 6620 6e6c 6162 7320 6973 206e  ') if nlabs is n
-0001ff30: 6f74 204e 6f6e 6520 656c 7365 2022 220d  ot None else "".
-0001ff40: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0001ff50: 2020 2069 6620 6c65 6e28 6772 6f75 705f     if len(group_
-0001ff60: 6c61 6265 6c73 2920 3d3d 303a 200d 0a20  labels) ==0: .. 
-0001ff70: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-0001ff80: 7420 6973 5f6e 756d 6572 6963 3a20 0d0a  t is_numeric: ..
-0001ff90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ffa0: 6d73 6720 3d20 2822 5472 6169 6c65 7220  msg = ("Trailer 
-0001ffb0: 6973 2065 6d70 7479 2077 6869 6c65 206f  is empty while o
-0001ffc0: 6e65 206f 7220 626f 7468 2079 5f74 7275  ne or both y_tru
-0001ffd0: 6520 616e 6420 7468 6522 0d0a 2020 2020  e and the"..    
-0001ffe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fff0: 2020 2020 2220 7072 6564 6963 7465 6420      " predicted 
-00020000: 2779 5f70 7265 6427 2061 7272 6179 7320  'y_pred' arrays 
-00020010: 6172 6520 6e6f 7420 6120 6e75 6d65 7269  are not a numeri
-00020020: 6320 6461 7461 2e22 0d0a 2020 2020 2020  c data."..      
-00020030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020040: 2020 2220 7b7d 2054 6869 7320 6d69 6768    " {} This migh
-00020050: 7420 6c65 6164 2074 6f20 756e 6578 7065  t lead to unexpe
-00020060: 6374 6564 2072 6573 756c 7473 2062 7920  cted results by 
-00020070: 636f 6e66 7573 696e 6722 0d0a 2020 2020  confusing"..    
-00020080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020090: 2020 2020 2220 7468 6520 7072 6564 6963      " the predic
-000200a0: 7465 6420 6c61 6265 6c73 2069 6e20 2779  ted labels in 'y
-000200b0: 5f70 7265 6427 2077 6974 6820 7468 6520  _pred' with the 
-000200c0: 7472 7565 220d 0a20 2020 2020 2020 2020  true"..         
-000200d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000200e0: 206c 6162 656c 7320 696e 2027 795f 7072   labels in 'y_pr
-000200f0: 6564 272e 2055 7365 2061 7420 796f 7572  ed'. Use at your
-00020100: 206f 776e 2072 6973 6b2e 220d 0a20 2020   own risk."..   
-00020110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020120: 2020 2020 2029 0d0a 0d0a 2020 2020 2020       )....      
-00020130: 2020 2020 2020 2020 2020 6966 206e 6c61            if nla
-00020140: 6273 3a20 7761 726e 696e 6773 2e77 6172  bs: warnings.war
-00020150: 6e28 6d73 672e 666f 726d 6174 2877 6172  n(msg.format(war
-00020160: 6e5f 6d73 6729 290d 0a20 2020 2020 2020  n_msg))..       
-00020170: 2020 2020 2020 2020 2074 7261 696c 6572           trailer
-00020180: 203d 2727 0d0a 2020 2020 2020 2020 2020   =''..          
-00020190: 2020 6966 2069 735f 6e75 6d65 7269 6320    if is_numeric 
-000201a0: 616e 6420 7472 6169 6c65 7220 6973 204e  and trailer is N
-000201b0: 6f6e 653a 200d 0a20 2020 2020 2020 2020  one: ..         
-000201c0: 2020 2020 2020 2070 7365 7564 6f5f 6c61         pseudo_la
-000201d0: 6265 6c73 203d 205f 6d69 7874 7572 655f  bels = _mixture_
-000201e0: 6e75 6d5f 6c61 6265 6c5f 6966 5f30 5f69  num_label_if_0_i
-000201f0: 6e20 280d 0a20 2020 2020 2020 2020 2020  n (..           
-00020200: 2020 2020 2020 2020 2074 7275 655f 6c61           true_la
-00020210: 6265 6c73 5f6f 7269 672c 206c 6162 656c  bels_orig, label
-00020220: 735f 6e6f 745f 696e 5f67 6f75 7073 2029  s_not_in_goups )
-00020230: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00020240: 2020 2020 2020 2020 656c 6966 206c 656e          elif len
-00020250: 2867 726f 7570 5f6c 6162 656c 7329 213d  (group_labels)!=
-00020260: 3020 3a20 0d0a 2020 2020 2020 2020 2020  0 : ..          
-00020270: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-00020280: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00020290: 2020 2242 6520 6177 6172 6521 2074 6865    "Be aware! the
-000202a0: 2074 7261 696c 6572 2069 7320 656d 7074   trailer is empt
-000202b0: 792e 2059 6f75 206d 6179 2070 726f 6261  y. You may proba
-000202c0: 626c 7920 636f 6e66 7573 6522 0d0a 2020  bly confuse"..  
-000202d0: 2020 2020 2020 2020 2020 2020 2020 2220                " 
-000202e0: 7468 6520 7472 7565 206c 6162 656c 7320  the true labels 
-000202f0: 696e 2027 795f 7472 7565 2720 746f 2074  in 'y_true' to t
-00020300: 6865 2070 7265 6469 6374 6564 206c 6162  he predicted lab
-00020310: 656c 732e 220d 0a20 2020 2020 2020 2020  els."..         
-00020320: 2020 2020 2020 2022 2054 6869 7320 7769         " This wi
-00020330: 6c6c 2063 7265 6174 6520 756e 6578 7065  ll create unexpe
-00020340: 6374 6564 2072 6573 756c 7473 2077 6865  cted results whe
-00020350: 6e20 626f 7468 2061 7272 6179 7320 6c61  n both arrays la
-00020360: 6265 6c73 220d 0a20 2020 2020 2020 2020  bels"..         
-00020370: 2020 2020 2020 2022 2061 7265 2063 6f6e         " are con
-00020380: 6675 7365 642e 207b 7d20 496e 2070 7261  fused. {} In pra
-00020390: 7469 6365 2c20 7468 6973 2062 6568 6176  tice, this behav
-000203a0: 696f 7220 6973 206e 6f74 2074 6f6c 6572  ior is not toler
-000203b0: 6162 6c65 2e22 0d0a 2020 2020 2020 2020  able."..        
-000203c0: 2020 2020 2020 2020 2220 4265 2073 7572          " Be sur
-000203d0: 652c 2079 6f75 206b 6e6f 7720 7768 6174  e, you know what
-000203e0: 2079 6f75 2061 7265 2064 6f69 6e67 2e20   you are doing. 
-000203f0: 5573 6520 6174 2079 6f75 7220 6f77 6e20  Use at your own 
-00020400: 7269 736b 2e22 0d0a 2020 2020 2020 2020  risk."..        
-00020410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020420: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
-00020430: 2077 6172 6e69 6e67 732e 7761 726e 286d   warnings.warn(m
-00020440: 7367 2e66 6f72 6d61 7428 7761 726e 5f6d  sg.format(warn_m
-00020450: 7367 2929 0d0a 2020 2020 2020 2020 2020  sg))..          
-00020460: 2020 7472 6169 6c65 7220 3d27 2720 0d0a    trailer ='' ..
-00020470: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00020480: 2020 6966 2074 7261 696c 6572 2069 7320    if trailer is 
-00020490: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-000204a0: 2020 2070 7365 7564 6f5f 6c61 6265 6c73     pseudo_labels
-000204b0: 203d 206c 6973 7428 7073 6575 646f 5f6c   = list(pseudo_l
-000204c0: 6162 656c 7329 200d 0a20 2020 2020 2020  abels) ..       
-000204d0: 2023 205b 3020 2c20 3220 2c20 3320 5d0d   # [0 , 2 , 3 ].
-000204e0: 0a20 2020 2069 6620 6e6f 7420 6973 5f6e  .    if not is_n
-000204f0: 756d 6572 6963 206f 7220 7472 6169 6c65  umeric or traile
-00020500: 7220 6973 206e 6f74 204e 6f6e 653a 200d  r is not None: .
-00020510: 0a20 2020 2020 2020 2023 2050 7574 2074  .        # Put t
-00020520: 6865 2074 7275 6520 6c61 6265 6c73 206f  he true labels o
-00020530: 7269 6769 6e20 696e 746f 2061 206c 6973  rigin into a lis
-00020540: 7420 6f66 2073 7472 696e 6720 0d0a 2020  t of string ..  
-00020550: 2020 2020 2020 2320 746f 2070 6572 666f        # to perfo
-00020560: 726d 2065 6c65 6d65 6e74 2077 6973 6520  rm element wise 
-00020570: 636f 6d70 6172 6973 6f6e 2020 0d0a 2020  comparison  ..  
-00020580: 2020 2020 2020 666f 7220 6b20 2c20 6974        for k , it
-00020590: 656d 7320 696e 2065 6e75 6d65 7261 7465  ems in enumerate
-000205a0: 2028 6c61 6265 6c73 5f6e 6f74 5f69 6e5f   (labels_not_in_
-000205b0: 676f 7570 7329 3a20 0d0a 2020 2020 2020  goups): ..      
-000205c0: 2020 2020 2020 6966 2069 7465 6d73 2069        if items i
-000205d0: 6e20 6c69 7374 2874 7275 655f 6c61 6265  n list(true_labe
-000205e0: 6c73 5f6f 7269 6729 3a20 0d0a 2020 2020  ls_orig): ..    
-000205f0: 2020 2020 2020 2020 2020 2020 7073 6575              pseu
-00020600: 646f 5f6c 6162 656c 735b 6b5d 203d 2073  do_labels[k] = s
-00020610: 7472 2869 7465 6d73 2920 2b20 7472 6169  tr(items) + trai
-00020620: 6c65 720d 0a20 2020 2020 2020 2020 2020  ler..           
-00020630: 2065 6c73 653a 2020 7073 6575 646f 5f6c   else:  pseudo_l
-00020640: 6162 656c 735b 6b5d 203d 2069 7465 6d73  abels[k] = items
-00020650: 0d0a 2020 2020 2020 2020 2320 4e75 6d70  ..        # Nump
-00020660: 7920 666f 726d 6174 2074 6865 2073 7472  y format the str
-00020670: 696e 6720 6c61 6265 6c73 200d 0a20 2020  ing labels ..   
-00020680: 2020 2020 2070 7365 7564 6f5f 6c61 6265       pseudo_labe
-00020690: 6c73 203d 206e 702e 6172 7261 7928 7073  ls = np.array(ps
-000206a0: 6575 646f 5f6c 6162 656c 7320 2920 0d0a  eudo_labels ) ..
-000206b0: 2020 2020 2020 2020 0d0a 2020 2020 7073          ..    ps
-000206c0: 6575 646f 5f64 6963 7420 3d20 6469 6374  eudo_dict = dict
-000206d0: 287a 6970 2028 6c61 6265 6c73 5f6e 6f74  (zip (labels_not
-000206e0: 5f69 6e5f 676f 7570 732c 2070 7365 7564  _in_goups, pseud
-000206f0: 6f5f 6c61 6265 6c73 2029 2920 0d0a 0d0a  o_labels )) ....
-00020700: 2020 2020 7265 7475 726e 2020 7073 6575      return  pseu
-00020710: 646f 5f64 6963 7420 0d0a 0d0a 6465 6620  do_dict ....def 
-00020720: 5f6d 6978 7475 7265 5f6e 756d 5f6c 6162  _mixture_num_lab
-00020730: 656c 5f69 665f 305f 696e 2028 7472 7565  el_if_0_in (true
-00020740: 5f6c 6162 656c 732c 206c 6162 656c 735f  _labels, labels_
-00020750: 746f 5f72 656e 616d 6529 203a 0d0a 2020  to_rename) :..  
-00020760: 2020 2222 2220 4973 6f6c 6174 6564 2070    """ Isolated p
-00020770: 6172 7420 6f66 205f 6372 6561 7465 5f6d  art of _create_m
-00020780: 7873 5f70 7365 7564 6f5f 6c61 6265 6c73  xs_pseudo_labels
-00020790: 2022 2222 0d0a 2020 2020 6e65 775f 6c61   """..    new_la
-000207a0: 6265 6c73 203d 206e 702e 6172 7261 7920  bels = np.array 
-000207b0: 286c 6162 656c 735f 746f 5f72 656e 616d  (labels_to_renam
-000207c0: 6520 2920 0d0a 2020 2020 6966 2030 2069  e ) ..    if 0 i
-000207d0: 6e20 6c61 6265 6c73 5f74 6f5f 7265 6e61  n labels_to_rena
-000207e0: 6d65 3a20 0d0a 2020 2020 2020 2020 6e65  me: ..        ne
-000207f0: 775f 6c61 6265 6c73 202b 3d20 6d61 7828  w_labels += max(
-00020800: 7472 7565 5f6c 6162 656c 7329 202b 2031  true_labels) + 1
-00020810: 2023 2073 6b69 7020 7468 6520 3020 0d0a   # skip the 0 ..
-00020820: 2020 2020 2020 2020 2320 7472 7565 5f6c          # true_l
-00020830: 6162 656c 7320 3d5b 3020 2c20 312c 2032  abels =[0 , 1, 2
-00020840: 5d0d 0a20 2020 2020 2020 2023 204e 4741  ]..        # NGA
-00020850: 5f6c 6162 656c 7320 3d5b 2030 2c20 312c  _labels =[ 0, 1,
-00020860: 2032 205d 200d 0a20 2020 2020 2020 2023   2 ] ..        #
-00020870: 2062 6f74 6820 0d0a 2020 2020 2020 2020   both ..        
-00020880: 2320 4e47 415f 6c61 6265 6c73 203d 2032  # NGA_labels = 2
-00020890: 2b31 202b 204e 4741 5f6c 6162 656c 7320  +1 + NGA_labels 
-000208a0: 3d20 5b33 2c20 342c 2035 5d0d 0a20 2020  = [3, 4, 5]..   
-000208b0: 2020 2020 2023 2030 2069 6e20 7472 7565       # 0 in true
-000208c0: 5f6c 6162 656c 7320 6f6e 6c79 2069 2e65  _labels only i.e
-000208d0: 204e 4741 206c 6162 656c 7320 5b31 2c20   NGA labels [1, 
-000208e0: 325d 0d0a 2020 2020 2020 2020 2320 4e47  2]..        # NG
-000208f0: 4120 6c61 7665 6c73 203d 2032 202b 205b  A lavels = 2 + [
-00020900: 312c 2032 5d2d 3e20 5b33 2c20 345d 2021  1, 2]-> [3, 4] !
-00020910: 3d20 7472 7565 5f6c 6162 656c 7320 0d0a  = true_labels ..
-00020920: 2020 2020 2020 2020 2320 3020 6e20 4e47          # 0 n NG
-00020930: 4120 6c61 6265 6c73 206f 6e6c 7920 0d0a  A labels only ..
-00020940: 2020 2020 656c 7365 3a20 0d0a 2020 2020      else: ..    
-00020950: 2020 2020 2320 7472 7565 5f6c 6162 656c      # true_label
-00020960: 7320 3d5b 312c 2032 5d0d 0a20 2020 2020  s =[1, 2]..     
-00020970: 2020 2023 204e 4741 5f6c 6162 656c 7320     # NGA_labels 
-00020980: 3d5b 302c 2031 2c20 3220 5d20 0d0a 2020  =[0, 1, 2 ] ..  
-00020990: 2020 2020 2020 2320 4e47 415f 6c61 6265        # NGA_labe
-000209a0: 6c73 203d 2032 202b 204e 4741 5f6c 6162  ls = 2 + NGA_lab
-000209b0: 656c 7320 3d20 5b32 2c20 332c 2034 5d0d  els = [2, 3, 4].
-000209c0: 0a20 2020 2020 2020 206e 6577 5f6c 6162  .        new_lab
-000209d0: 656c 7320 2b3d 206d 6178 2874 7275 655f  els += max(true_
-000209e0: 6c61 6265 6c73 290d 0a20 2020 2023 2072  labels)..    # r
-000209f0: 6563 6f6e 7665 7274 2074 6f20 696e 7465  econvert to inte
-00020a00: 6765 7220 0d0a 2020 2020 7265 7475 726e  ger ..    return
-00020a10: 2020 6e65 775f 6c61 6265 6c73 2e61 7374    new_labels.ast
-00020a20: 7970 6520 286e 702e 696e 7433 3220 2920  ype (np.int32 ) 
-00020a30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00020a40: 2020 200d 0a64 6566 205f 4d58 535f 6966     ..def _MXS_if
-00020a50: 5f79 6573 2028 636f 6e74 6578 7420 2c20  _yes (context , 
-00020a60: 2f2c 2073 6c67 202c 2079 5f70 7265 642c  /, slg , y_pred,
-00020a70: 2079 5f74 7275 652c 2020 7365 703d 4e6f   y_true,  sep=No
-00020a80: 6e65 2c20 2070 7265 6669 783d 204e 6f6e  ne,  prefix= Non
-00020a90: 652c 200d 0a20 2020 2020 2020 2020 2020  e, ..           
-00020aa0: 2020 2020 2020 636d 7367 3d27 2720 2c20        cmsg='' , 
-00020ab0: 7472 6169 6c65 7220 3d20 222a 2220 293a  trailer = "*" ):
-00020ac0: 200d 0a20 2020 2022 2222 204d 616b 6520   ..    """ Make 
-00020ad0: 4d58 5320 7461 7267 6574 2077 6865 6e20  MXS target when 
-00020ae0: 7369 6d69 6c61 7269 7479 2069 7320 666f  similarity is fo
-00020af0: 756e 6420 6265 7477 6565 6e20 6120 6c61  und between a la
-00020b00: 6265 6c20 696e 2027 795f 7472 7565 2720  bel in 'y_true' 
-00020b10: 616e 6420 0d0a 2020 2020 6c61 6265 6c20  and ..    label 
-00020b20: 696e 2074 6865 2070 7265 6469 6374 6564  in the predicted
-00020b30: 204e 4741 2e20 0d0a 0d0a 2020 2020 3a70   NGA. ....    :p
-00020b40: 6172 616d 2079 5f70 7265 643a 2061 7272  aram y_pred: arr
-00020b50: 6179 5f6c 696b 6520 3164 200d 0a20 2020  ay_like 1d ..   
-00020b60: 2020 2020 2061 7272 6179 206f 6620 7468       array of th
-00020b70: 6520 4e47 4120 7072 6564 6963 7465 6420  e NGA predicted 
-00020b80: 6c61 6265 6c73 2e20 0d0a 2020 2020 3a70  labels. ..    :p
-00020b90: 6172 616d 2063 6f6e 7465 7874 3a20 7374  aram context: st
-00020ba0: 7220 2c20 7b27 7369 6d69 6c61 7269 7479  r , {'similarity
-00020bb0: 2065 7869 7374 7327 7d0d 0a20 2020 203a   exists'}..    :
-00020bc0: 7061 7261 6d20 6373 6d67 3a73 7472 2c20  param csmg:str, 
-00020bd0: 0d0a 2020 2020 2020 2020 666f 726d 6174  ..        format
-00020be0: 6167 6520 6d65 7373 6167 6520 6973 2077  age message is w
-00020bf0: 726f 6e67 2063 6f6e 7465 7874 2069 7320  rong context is 
-00020c00: 7061 7373 6564 2069 6e20 7468 6520 7772  passed in the wr
-00020c10: 6f6e 6720 6675 6e63 7469 6f6e 2e20 0d0a  ong function. ..
-00020c20: 0d0a 2020 2020 3a72 6574 7572 6e73 3a20  ..    :returns: 
-00020c30: 0d0a 2020 2020 2020 2020 2d20 795f 6d78  ..        - y_mx
-00020c40: 733a 2061 7272 6179 2d6c 696b 6520 3164  s: array-like 1d
-00020c50: 202c 204d 5853 206e 6577 206c 6162 656c   , MXS new label
-00020c60: 7320 6372 6561 7465 6420 0d0a 2020 2020  s created ..    
-00020c70: 2020 2020 2d20 6772 6f75 705f 636c 6173      - group_clas
-00020c80: 7365 735f 3a20 6469 6374 2c20 7468 6520  ses_: dict, the 
-00020c90: 6c61 6265 6c73 2069 6e20 4e47 4120 6c61  labels in NGA la
-00020ca0: 6265 6c73 2061 6e64 2074 6865 6972 200d  bels and their .
-00020cb0: 0a20 2020 2020 2020 2020 2020 2070 6f73  .            pos
-00020cc0: 7369 626c 6520 7265 6e61 6d65 6420 7661  sible renamed va
-00020cd0: 6c75 6573 2e20 4d6f 7374 206f 6620 7468  lues. Most of th
-00020ce0: 6520 6361 7365 2c20 7468 6973 2068 6170  e case, this hap
-00020cf0: 7065 6e73 2020 0d0a 2020 2020 2020 2020  pens  ..        
-00020d00: 2020 2020 7768 656e 2074 6865 2074 6865      when the the
-00020d10: 2067 726f 7570 7320 7661 6c75 6573 2061   groups values a
-00020d20: 7265 2067 6976 656e 2061 7320 696e 7465  re given as inte
-00020d30: 7267 6572 2063 6c61 7373 6573 2072 6174  rger classes rat
-00020d40: 6865 7220 0d0a 2020 2020 2020 2020 2020  her ..          
-00020d50: 2020 7468 616e 2073 7472 696e 672e 200d    than string. .
-00020d60: 0a20 2020 2020 2020 202d 2067 726f 7570  .        - group
-00020d70: 5f6c 6162 656c 733a 2054 6865 2073 696d  _labels: The sim
-00020d80: 696c 6172 206c 6162 656c 7320 666f 756e  ilar labels foun
-00020d90: 6420 6174 2074 6865 2073 616d 6520 7469  d at the same ti
-00020da0: 6d65 2069 6e20 0d0a 2020 2020 2020 2020  me in ..        
-00020db0: 2020 2020 2779 5f74 7275 6527 2061 6e64      'y_true' and
-00020dc0: 204e 4741 206c 6162 656c 732e 200d 0a20   NGA labels. .. 
-00020dd0: 2020 2020 2020 202d 2073 696d 5f67 726f         - sim_gro
-00020de0: 7570 733a 2067 726f 7570 7320 206f 6620  ups: groups  of 
-00020df0: 7061 6972 2063 6f6d 706f 7365 6420 6f66  pair composed of
-00020e00: 2074 6865 2073 696d 696c 6172 206c 6162   the similar lab
-00020e10: 656c 2061 6e64 200d 0a20 2020 2020 2020  el and ..       
-00020e20: 2020 2020 2061 6e64 2074 6865 206c 6162       and the lab
-00020e30: 656c 2069 6e20 7468 6520 7072 6564 6963  el in the predic
-00020e40: 7465 6420 4e47 412e 200d 0a0d 0a20 2020  ted NGA. ....   
-00020e50: 2022 2222 0d0a 2020 2020 6173 7365 7274   """..    assert
-00020e60: 2073 7472 2863 6f6e 7465 7874 292e 6c6f   str(context).lo
-00020e70: 7765 7228 2920 696e 207b 0d0a 2020 2020  wer() in {..    
-00020e80: 2020 2020 2773 696d 696c 6172 6974 7920      'similarity 
-00020e90: 6578 6973 7473 272c 2027 7965 7327 2c20  exists', 'yes', 
-00020ea0: 2754 7275 6527 2c20 2773 696d 696c 6172  'True', 'similar
-00020eb0: 6974 7920 6973 2066 6f75 6e64 277d 2c20  ity is found'}, 
-00020ec0: 5c0d 0a20 2020 2020 2020 2063 6d73 672e  \..        cmsg.
-00020ed0: 666f 726d 6174 2028 5f4d 5853 5f69 665f  format (_MXS_if_
-00020ee0: 6e6f 2e5f 5f6e 616d 655f 5f2c 2027 4e4f  no.__name__, 'NO
-00020ef0: 2729 0d0a 2020 2020 2020 2020 0d0a 2020  ')..        ..  
-00020f00: 2020 6966 206e 6f74 2069 735f 6974 6572    if not is_iter
-00020f10: 6162 6c65 2873 6c67 293a 200d 0a20 2020  able(slg): ..   
-00020f20: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00020f30: 7272 6f72 2028 2273 696d 696c 6172 6974  rror ("similarit
-00020f40: 7920 6772 6f75 7020 6d75 7374 2062 6520  y group must be 
-00020f50: 616e 2069 7465 7261 626c 6520 6f62 6a65  an iterable obje
-00020f60: 6374 2e22 0d0a 2020 2020 2020 2020 2020  ct."..          
-00020f70: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00020f80: 2220 476f 743a 207b 7479 7065 2873 6c67  " Got: {type(slg
-00020f90: 292e 5f5f 6e61 6d65 5f5f 2172 7d22 290d  ).__name__!r}").
-00020fa0: 0a20 0d0a 2020 2020 7369 6d5f 6772 6f75  . ..    sim_grou
-00020fb0: 7073 203d 205f 6e61 6d65 5f6d 7873 5f6c  ps = _name_mxs_l
-00020fc0: 6162 656c 7328 2a73 6c67 2c20 7365 7020  abels(*slg, sep 
-00020fd0: 3d20 7365 702c 2070 7265 6669 7820 3d70  = sep, prefix =p
-00020fe0: 7265 6669 7820 290d 0a20 2020 2074 7275  refix )..    tru
-00020ff0: 655f 6c61 6265 6c73 202c 2067 726f 7570  e_labels , group
-00021000: 5f6c 6162 656c 7320 3d20 7a69 7020 282a  _labels = zip (*
-00021010: 736c 6720 290d 0a20 2020 2069 6620 6e6f  slg )..    if no
-00021020: 7420 5f69 735f 6e75 6d65 7269 635f 6474  t _is_numeric_dt
-00021030: 7970 6528 795f 7072 6564 293a 200d 0a20  ype(y_pred): .. 
-00021040: 2020 2020 2020 2074 656d 7079 203d 2074         tempy = t
-00021050: 6f5f 6474 7970 655f 7374 7228 795f 7072  o_dtype_str(y_pr
-00021060: 6564 2c20 7265 7475 726e 5f76 616c 7565  ed, return_value
-00021070: 7320 3d20 5472 7565 2029 0d0a 2020 2020  s = True )..    
-00021080: 656c 7365 203a 2074 656d 7079 203d 2079  else : tempy = y
-00021090: 5f70 7265 642e 636f 7079 2829 0d0a 0d0a  _pred.copy()....
-000210a0: 2020 2020 6966 206e 6f74 2061 6c6c 2028      if not all (
-000210b0: 5b20 6c20 696e 206e 702e 756e 6971 7565  [ l in np.unique
-000210c0: 2028 7465 6d70 7929 2066 6f72 206c 2069   (tempy) for l i
-000210d0: 6e20 6772 6f75 705f 6c61 6265 6c73 205d  n group_labels ]
-000210e0: 293a 200d 0a20 2020 2020 2020 2023 206c  ): ..        # l
-000210f0: 6973 7420 7468 6520 696e 7661 6c69 6420  ist the invalid 
-00021100: 6772 6f75 7073 200d 0a20 2020 2020 2020  groups ..       
-00021110: 2023 206e 6f74 2069 6e20 7468 6520 4e47   # not in the NG
-00021120: 4120 6c61 6265 6c73 200d 0a20 2020 2020  A labels ..     
-00021130: 2020 206d 7367 203d 206c 6973 7469 6e67     msg = listing
-00021140: 5f69 7465 6d73 5f66 6f72 6d61 7428 6772  _items_format(gr
-00021150: 6f75 705f 6c61 6265 6c73 2c20 0d0a 2020  oup_labels, ..  
-00021160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021170: 2020 2020 2020 2020 2020 2022 496e 7661             "Inva
-00021180: 6c69 6420 7369 6d69 6c61 7220 6772 6f75  lid similar grou
-00021190: 7073 222c 2020 0d0a 2020 2020 2020 2020  ps",  ..        
-000211a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000211b0: 2020 2020 2022 4772 6f75 7020 6d75 7374       "Group must
-000211c0: 2062 6520 7468 6520 6c61 6265 6c73 2069   be the labels i
-000211d0: 6e20 7468 6520 7072 6564 6963 7465 6420  n the predicted 
-000211e0: 4e47 412e 222c 0d0a 2020 2020 2020 2020  NGA.",..        
-000211f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021200: 2020 2020 2076 6572 626f 7365 203d 2046       verbose = F
-00021210: 616c 7365 202c 2069 6e6c 696e 6520 3d54  alse , inline =T
-00021220: 7275 6520 2c0d 0a20 2020 2020 2020 2020  rue ,..         
-00021230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021240: 2020 2020 290d 0a20 2020 2020 2020 2072      )..        r
-00021250: 6169 7365 2041 7175 6966 6572 4772 6f75  aise AquiferGrou
-00021260: 7045 7272 6f72 2028 6d73 6729 0d0a 2020  pError (msg)..  
-00021270: 2020 0d0a 2020 2020 795f 6d78 7320 3d20    ..    y_mxs = 
-00021280: 6e70 2e66 756c 6c20 2879 5f70 7265 642e  np.full (y_pred.
-00021290: 7368 6170 6520 2c20 6669 6c6c 5f76 616c  shape , fill_val
-000212a0: 7565 3d20 6e70 2e6e 616e 202c 2064 7479  ue= np.nan , dty
-000212b0: 7065 203d 206f 626a 6563 7420 290d 0a0d  pe = object )...
-000212c0: 0a20 2020 2023 2047 6574 2074 6865 2069  .    # Get the i
-000212d0: 6e64 6578 206f 6620 6561 6368 204e 4741  ndex of each NGA
-000212e0: 206c 6162 656c 730d 0a20 2020 204e 4741   labels..    NGA
-000212f0: 5f6c 6162 656c 5f69 6e64 6963 6573 203d  _label_indices =
-00021300: 207b 200d 0a20 2020 2020 2020 206c 6162   { ..        lab
-00021310: 656c 3a20 6e70 2e77 6865 7265 2028 795f  el: np.where (y_
-00021320: 7072 6564 203d 3d20 6c61 6265 6c20 295b  pred == label )[
-00021330: 305d 2066 6f72 206c 6162 656c 2069 6e20  0] for label in 
-00021340: 6e70 2e75 6e69 7175 6520 2879 5f70 7265  np.unique (y_pre
-00021350: 6420 290d 0a20 2020 2020 2020 207d 0d0a  d )..        }..
-00021360: 2020 2020 2320 6372 6561 7465 2061 2064      # create a d
-00021370: 6963 7420 6f66 2070 7365 7564 6f6c 6162  ict of pseudolab
-00021380: 656c 7320 6e6f 7420 696e 2067 726f 7570  els not in group
-00021390: 5f6c 6162 656c 7320 200d 0a20 2020 2070  _labels  ..    p
-000213a0: 7365 7564 6f5f 4e47 415f 6c61 6265 6c73  seudo_NGA_labels
-000213b0: 203d 205f 6372 6561 7465 5f6d 7873 5f70   = _create_mxs_p
-000213c0: 7365 7564 6f5f 6c61 6265 6c73 2028 0d0a  seudo_labels (..
-000213d0: 2020 2020 2020 2020 795f 7472 7565 2c20          y_true, 
-000213e0: 795f 7072 6564 2c20 6772 6f75 705f 6c61  y_pred, group_la
-000213f0: 6265 6c73 2c20 7472 6169 6c65 7220 3d74  bels, trailer =t
-00021400: 7261 696c 6572 2029 0d0a 2020 2020 6772  railer )..    gr
-00021410: 6f75 705f 636c 6173 7365 735f 203d 2064  oup_classes_ = d
-00021420: 6963 7428 2920 0d0a 2020 2020 666f 7220  ict() ..    for 
-00021430: 6b6c 6162 656c 202c 2076 696e 6465 7820  klabel , vindex 
-00021440: 696e 204e 4741 5f6c 6162 656c 5f69 6e64  in NGA_label_ind
-00021450: 6963 6573 2e69 7465 6d73 2028 2920 3a0d  ices.items () :.
-00021460: 0a20 2020 2020 2020 2069 6620 6b6c 6162  .        if klab
-00021470: 656c 2069 6e20 2067 726f 7570 5f6c 6162  el in  group_lab
-00021480: 656c 7320 3a20 2320 5b20 342c 2034 2c20  els : # [ 4, 4, 
-00021490: 3220 5d0d 0a20 2020 2020 2020 2020 2020  2 ]..           
-000214a0: 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   # -------------
-000214b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000214c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000214d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
-000214e0: 2020 2020 2020 2020 2023 2077 6520 6361           # we ca
-000214f0: 6e20 7369 6d70 6c79 2067 6574 2068 2066  n simply get h f
-00021500: 726f 6d20 696e 6469 6365 732c 2068 6f77  rom indices, how
-00021510: 6576 6572 2069 7420 7468 6572 6520 6973  ever it there is
-00021520: 2074 6865 200d 0a20 2020 2020 2020 2020   the ..         
-00021530: 2020 2023 2073 616d 6520 6b20 6475 706c     # same k dupl
-00021540: 6963 6174 6520 696e 2067 726f 7570 7320  icate in groups 
-00021550: 6c61 6265 6c73 2c20 696e 6465 7820 7769  labels, index wi
-00021560: 6c6c 2061 6c77 6179 7320 6265 200d 0a20  ll always be .. 
-00021570: 2020 2020 2020 2020 2020 2023 2066 6574             # fet
-00021580: 6368 6564 2066 726f 6d20 6669 7273 7420  ched from first 
-00021590: 6f63 6375 7265 6e63 652c 2077 6869 6368  occurence, which
-000215a0: 2073 6565 6d73 2068 6575 7269 7374 6963   seems heuristic
-000215b0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-000215c0: 656c 745f 696e 6465 7820 3d20 2067 726f  elt_index =  gro
-000215d0: 7570 5f6c 6162 656c 732e 696e 6465 7820  up_labels.index 
-000215e0: 286b 6c61 6265 6c20 2920 200d 0a20 2020  (klabel )  ..   
-000215f0: 2020 2020 2020 2020 206e 6b6c 6162 656c           nklabel
-00021600: 203d 2073 696d 5f67 726f 7570 7320 5b65   = sim_groups [e
-00021610: 6c74 5f69 6e64 6578 205d 200d 0a20 2020  lt_index ] ..   
-00021620: 2020 2020 2020 2020 2023 2070 7269 6e74           # print
-00021630: 286b 6c61 6265 6c2c 206e 6b6c 6162 656c  (klabel, nklabel
-00021640: 290d 0a20 2020 2020 2020 2020 2020 2079  )..            y
-00021650: 5f6d 7873 205b 2076 696e 6465 7820 5d20  _mxs [ vindex ] 
-00021660: 3d20 6e6b 6c61 6265 6c0d 0a20 2020 2020  = nklabel..     
-00021670: 2020 2020 2020 2067 726f 7570 5f63 6c61         group_cla
-00021680: 7373 6573 5f20 5b6b 6c61 6265 6c5d 203d  sses_ [klabel] =
-00021690: 206e 6b6c 6162 656c 0d0a 2020 2020 2020   nklabel..      
-000216a0: 2020 2020 2020 2320 2320 2d2d 2d2d 2d2d        # # ------
-000216b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000216c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000216d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-000216e0: 2020 2020 2020 656c 6966 206b 6c61 6265        elif klabe
-000216f0: 6c20 6e6f 7420 696e 2067 726f 7570 5f6c  l not in group_l
-00021700: 6162 656c 7320 3a20 0d0a 2020 2020 2020  abels : ..      
-00021710: 2020 2020 2020 6e6b 6c61 6265 6c20 3d20        nklabel = 
-00021720: 7073 6575 646f 5f4e 4741 5f6c 6162 656c  pseudo_NGA_label
-00021730: 732e 6765 7428 6b6c 6162 656c 2920 0d0a  s.get(klabel) ..
-00021740: 2020 2020 2020 2020 2020 2020 795f 6d78              y_mx
-00021750: 7320 5b20 7669 6e64 6578 205d 203d 206e  s [ vindex ] = n
-00021760: 6b6c 6162 656c 200d 0a20 2020 2020 2020  klabel ..       
-00021770: 2020 2020 2067 726f 7570 5f63 6c61 7373       group_class
-00021780: 6573 5f20 5b6b 6c61 6265 6c5d 203d 206e  es_ [klabel] = n
-00021790: 6b6c 6162 656c 200d 0a20 2020 200d 0a20  klabel ..    .. 
-000217a0: 2020 2072 6574 7572 6e20 795f 6d78 7320     return y_mxs 
-000217b0: 2c20 6772 6f75 705f 636c 6173 7365 735f  , group_classes_
-000217c0: 202c 2067 726f 7570 5f6c 6162 656c 7320   , group_labels 
-000217d0: 2c20 7369 6d5f 6772 6f75 7073 200d 0a0d  , sim_groups ...
-000217e0: 0a40 6465 7072 6563 6174 6564 2822 4675  .@deprecated("Fu
-000217f0: 6e63 7469 6f6e 2069 7320 6865 6e63 6566  nction is hencef
-00021800: 6f72 7468 2064 6570 7265 6361 7465 642e  orth deprecated.
-00021810: 204e 6f74 6520 7573 6520 616e 796d 6f72   Note use anymor
-00021820: 6520 696e 220d 0a20 2020 2020 2020 2020  e in"..         
-00021830: 2020 2022 204d 5853 2073 7472 6174 6567     " MXS strateg
-00021840: 7920 696d 706c 656d 656e 7461 7469 6f6e  y implementation
-00021850: 2e20 4974 2068 6173 2062 6565 6e20 7265  . It has been re
-00021860: 706c 6163 6564 2062 7922 0d0a 2020 2020  placed by"..    
-00021870: 2020 2020 2020 2020 2220 3a66 756e 633a          " :func:
-00021880: 607e 2e5f 6d69 7874 7572 655f 6e75 6d5f  `~._mixture_num_
-00021890: 6c61 6265 6c5f 6966 5f30 5f69 6e60 206d  label_if_0_in` m
-000218a0: 6f72 6520 7374 6162 6c65 2e22 0d0a 2020  ore stable."..  
-000218b0: 2020 2020 2020 2020 2020 2220 4974 2073            " It s
-000218c0: 686f 756c 6420 6265 2072 656d 6f76 6564  hould be removed
-000218d0: 2073 6f6f 6e20 696e 2061 2066 7574 7572   soon in a futur
-000218e0: 6520 7265 616c 6561 7365 2e20 2229 0d0a  e realease. ")..
-000218f0: 6465 6620 5f6d 6978 7475 7265 5f67 726f  def _mixture_gro
-00021900: 7570 5f6c 6162 656c 5f69 6620 2820 6c61  up_label_if ( la
-00021910: 6265 6c5f 6b2c 2074 5f6c 6162 656c 7329  bel_k, t_labels)
-00021920: 3a20 0d0a 2020 2020 2222 2220 5374 6172  : ..    """ Star
-00021930: 7420 636f 756e 7469 6e67 2072 656d 6169  t counting remai
-00021940: 6e69 6e67 206c 6162 656c 7320 6672 6f6d  ning labels from
-00021950: 2074 6865 206d 6178 696d 756d 2076 616c   the maximum val
-00021960: 7565 206f 6620 0d0a 2020 2020 6c61 6265  ue of ..    labe
-00021970: 6c20 666f 756e 6420 696e 2074 6865 2027  l found in the '
-00021980: 745f 6c61 6265 6c73 2720 2222 220d 0a20  t_labels' """.. 
-00021990: 2020 2023 2055 7365 2074 6865 206d 6178     # Use the max
-000219a0: 2065 6c65 6d65 6e74 2069 6e20 7468 6520   element in the 
-000219b0: 7472 7565 206c 6162 656c 7320 0d0a 2020  true labels ..  
-000219c0: 2020 2320 616e 6420 6170 7065 6e64 2069    # and append i
-000219d0: 7420 746f 2074 6865 2072 656d 6169 6e20  t to the remain 
-000219e0: 6c61 6265 6c73 2077 686f 7365 200d 0a20  labels whose .. 
-000219f0: 2020 2023 2061 7265 206e 6f74 2066 6f75     # are not fou
-00021a00: 6e64 2061 7320 7369 6d69 6c61 7269 7479  nd as similarity
-00021a10: 2067 726f 7570 7320 200d 0a20 2020 2023   groups  ..    #
-00021a20: 2074 6869 7320 6973 2070 6f73 7369 626c   this is possibl
-00021a30: 6520 6966 2074 6865 2073 696d 7069 6c61  e if the simpila
-00021a40: 7279 2067 726f 7570 2061 7265 206e 756d  ry group are num
-00021a50: 6572 7920 6461 7461 7479 7065 200d 0a20  ery datatype .. 
-00021a60: 2020 2023 2048 6f77 6576 6572 2069 6620     # However if 
-00021a70: 6966 2073 7472 696e 6720 2c20 6b65 6570  if string , keep
-00021a80: 2069 7420 696e 2074 6865 2064 6174 6173   it in the datas
-00021a90: 6574 7320 0d0a 2020 2020 2320 5468 6520  ets ..    # The 
-00021aa0: 676f 616c 206f 6620 7468 6973 2069 7320  goal of this is 
-00021ab0: 746f 206e 6f74 2062 6520 636f 6e66 7573  to not be confus
-00021ac0: 6520 7769 7468 2074 6865 2065 7869 7374  e with the exist
-00021ad0: 696e 670d 0a20 2020 2023 2020 7472 7565  ing..    #  true
-00021ae0: 206c 6162 656c 7320 7769 7468 2074 6865   labels with the
-00021af0: 2076 616c 6964 206b 206c 6162 656c 7320   valid k labels 
-00021b00: 666f 756e 6420 696e 2074 6865 2079 5f74  found in the y_t
-00021b10: 7275 650d 0a20 2020 200d 0a20 2020 2023  rue..    ..    #
-00021b20: 2066 696e 6420 7468 6520 6772 6f75 7020   find the group 
-00021b30: 6c61 6265 6c20 7768 6963 6820 6578 6973  label which exis
-00021b40: 7473 2069 6e20 7468 6520 745f 6c61 6265  ts in the t_labe
-00021b50: 6c73 2061 6e64 200d 0a20 2020 2023 2063  ls and ..    # c
-00021b60: 7265 6174 6520 7073 6575 646f 2067 726f  reate pseudo gro
-00021b70: 7570 200d 0a20 2020 2023 206c 6162 656c  up ..    # label
-00021b80: 735f 696e 203d 200d 0a20 2020 2069 6620  s_in = ..    if 
-00021b90: 5f69 735f 6e75 6d65 7269 635f 6474 7970  _is_numeric_dtyp
-00021ba0: 6528 745f 6c61 6265 6c73 202c 2074 6f5f  e(t_labels , to_
-00021bb0: 6172 7261 793d 5472 7565 2920 3a0d 0a20  array=True) :.. 
-00021bc0: 2020 2020 2020 206d 6178 5f69 6e5f 745f         max_in_t_
-00021bd0: 6c61 6265 6c73 203d 206d 6178 2028 745f  labels = max (t_
-00021be0: 6c61 6265 6c73 2029 2020 0d0a 2020 2020  labels )  ..    
-00021bf0: 7472 7920 3a20 0d0a 2020 2020 2020 2020  try : ..        
-00021c00: 6c61 6265 6c5f 6b20 3d20 696e 7420 286c  label_k = int (l
-00021c10: 6162 656c 5f6b 2920 0d0a 2020 2020 6578  abel_k) ..    ex
-00021c20: 6365 7074 203a 2023 2077 6865 7265 206b  cept : # where k
-00021c30: 2069 7320 6e6f 7420 6120 6e75 6d65 7269   is not a numeri
-00021c40: 6320 0d0a 2020 2020 2020 2020 2320 6966  c ..        # if
-00021c50: 206c 6162 656c 5f6b 2069 6e20 745f 6c61   label_k in t_la
-00021c60: 6265 6c73 3a20 0d0a 2020 2020 2020 2020  bels: ..        
-00021c70: 7061 7373 200d 0a20 2020 2065 6c73 6520  pass ..    else 
-00021c80: 3a20 0d0a 2020 2020 2020 2020 6c61 6265  : ..        labe
-00021c90: 6c5f 6b20 2b3d 206d 6178 5f69 6e5f 745f  l_k += max_in_t_
-00021ca0: 6c61 6265 6c73 2020 0d0a 2020 2020 2020  labels  ..      
-00021cb0: 2020 0d0a 2020 2020 7265 7475 726e 206c    ..    return l
-00021cc0: 6162 656c 5f6b 200d 0a0d 0a64 6566 205f  abel_k ....def _
-00021cd0: 6b6d 6170 7069 6e67 2028 6172 722c 202f  kmapping (arr, /
-00021ce0: 293a 200d 0a20 2020 2022 2222 2043 6865  ): ..    """ Che
-00021cf0: 636b 2077 6865 7468 6572 2074 6865 2074  ck whether the t
-00021d00: 7275 6520 6c61 6265 6c73 2027 795f 7472  rue labels 'y_tr
-00021d10: 7565 2720 6861 7665 206e 756d 6572 6963  ue' have numeric
-00021d20: 2064 7479 7065 7320 0d0a 2020 2020 6f74   dtypes ..    ot
-00021d30: 6865 7277 6973 652c 2063 7265 6174 6520  herwise, create 
-00021d40: 6120 696e 7465 6765 7220 6c61 6265 6c73  a integer labels
-00021d50: 2074 6f20 2073 7562 7374 6974 7574 6520   to  substitute 
-00021d60: 0d0a 2020 2020 7468 6520 7472 7565 206c  ..    the true l
-00021d70: 6162 656c 732e 2046 6f72 2069 6e73 7461  abels. For insta
-00021d80: 6e63 653a 200d 0a20 2020 2020 2020 200d  nce: ..        .
-00021d90: 0a20 2020 2020 2020 203e 3e3e 205b 276b  .        >>> ['k
-00021da0: 3127 2c20 276b 3227 2c20 276b 3327 5d20  1', 'k2', 'k3'] 
-00021db0: 2d20 3e20 5b31 2c20 322c 2033 5d0d 0a20  - > [1, 2, 3].. 
-00021dc0: 2020 203a 7061 7261 6d20 6172 723a 2061     :param arr: a
-00021dd0: 7272 6179 2d6c 696b 6520 3164 200d 0a20  rray-like 1d .. 
-00021de0: 2020 2020 2020 2061 7272 6179 206f 6620         array of 
-00021df0: 6f6e 6564 696d 656e 7369 6f6e 616c 200d  onedimensional .
-00021e00: 0a20 2020 2022 2222 0d0a 2020 2020 7974  .    """..    yt
-00021e10: 7261 6e73 6620 3d61 7272 2e63 6f70 7928  ransf =arr.copy(
-00021e20: 2920 0d0a 2020 2020 636c 6173 7365 7320  ) ..    classes 
-00021e30: 3d20 4e6f 6e65 200d 0a20 2020 2069 6620  = None ..    if 
-00021e40: 6e6f 7420 5f69 735f 6e75 6d65 7269 635f  not _is_numeric_
-00021e50: 6474 7970 6528 6172 7220 2c20 746f 5f61  dtype(arr , to_a
-00021e60: 7272 6179 203d 5472 7565 2920 3a20 0d0a  rray =True) : ..
-00021e70: 2020 2020 2020 2020 6966 206e 6f74 205f          if not _
-00021e80: 6973 5f61 7272 6179 6c69 6b65 5f31 6428  is_arraylike_1d(
-00021e90: 6172 7229 3a20 0d0a 2020 2020 2020 2020  arr): ..        
-00021ea0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00021eb0: 7272 6f72 2028 2241 7272 6179 206d 7573  rror ("Array mus
-00021ec0: 7420 6265 206f 6e65 2d64 696d 656e 7369  t be one-dimensi
-00021ed0: 6f6e 616c 2c22 0d0a 2020 2020 2020 2020  onal,"..        
-00021ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ef0: 2020 2020 2020 2220 676f 7420 7368 6170        " got shap
-00021f00: 653a 2027 7b6e 702e 6172 7261 7928 6172  e: '{np.array(ar
-00021f10: 7229 2e73 6861 7065 7d27 2229 0d0a 2020  r).shape}'")..  
-00021f20: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00021f30: 2020 2020 756e 696b 5f6c 6162 656c 7320      unik_labels 
-00021f40: 3d20 6e70 2e75 6e69 7175 6520 2861 7272  = np.unique (arr
-00021f50: 290d 0a20 2020 2020 2020 206e 6577 5f6c  )..        new_l
-00021f60: 6162 656c 7320 3d20 6e70 2e61 7261 6e67  abels = np.arang
-00021f70: 6528 312c 206c 656e 2875 6e69 6b5f 6c61  e(1, len(unik_la
-00021f80: 6265 6c73 292b 2031 2029 2020 0d0a 2020  bels)+ 1 )  ..  
-00021f90: 2020 2020 2020 666f 7220 746c 6162 2c20        for tlab, 
-00021fa0: 6e6c 6162 2020 696e 207a 6970 2028 756e  nlab  in zip (un
-00021fb0: 696b 5f6c 6162 656c 732c 206e 6577 5f6c  ik_labels, new_l
-00021fc0: 6162 656c 7320 2920 3a20 0d0a 2020 2020  abels ) : ..    
-00021fd0: 2020 2020 2020 2020 696e 6469 6365 732c          indices,
-00021fe0: 203d 206e 702e 7768 6572 6520 2861 7272   = np.where (arr
-00021ff0: 203d 3d74 6c61 6229 0d0a 2020 2020 2020   ==tlab)..      
-00022000: 2020 2020 2020 7974 7261 6e73 665b 696e        ytransf[in
-00022010: 6469 6365 7320 5d20 3d20 6e6c 6162 200d  dices ] = nlab .
-00022020: 0a20 2020 2020 2020 2063 6c61 7373 6573  .        classes
-00022030: 203d 2064 6963 7420 2820 7a69 7020 2820   = dict ( zip ( 
-00022040: 6e65 775f 6c61 6265 6c73 2c20 756e 696b  new_labels, unik
-00022050: 5f6c 6162 656c 7320 2920 2920 0d0a 2020  _labels ) ) ..  
-00022060: 2020 2320 7472 7920 746f 2063 6f6e 7665    # try to conve
-00022070: 7274 2074 6f20 696e 7433 3220 0d0a 2020  rt to int32 ..  
-00022080: 2020 7472 7920 3a20 7974 7261 6e73 6620    try : ytransf 
-00022090: 3d20 7974 7261 6e73 662e 6173 7479 7065  = ytransf.astype
-000220a0: 2028 6e70 2e69 6e74 3332 2029 0d0a 2020   (np.int32 )..  
-000220b0: 2020 6578 6365 7074 3a20 7061 7373 200d    except: pass .
-000220c0: 0a20 2020 2072 6574 7572 6e20 7974 7261  .    return ytra
-000220d0: 6e73 662c 2063 6c61 7373 6573 20         nsf, classes 
+0001bb20: 202a 666d 7429 0d0a 2020 2020 2020 2020   *fmt)..        
+0001bb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bb40: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+0001bb50: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0001bb60: 7220 280d 0a20 2020 2020 2020 2020 2020  r (..           
+0001bb70: 2020 2020 2022 6c61 6265 6c20 7661 6c75       "label valu
+0001bb80: 657b 307d 207b 317d 207b 327d 206d 6973  e{0} {1} {2} mis
+0001bb90: 7369 6e67 2069 6e20 7468 6520 6172 7261  sing in the arra
+0001bba0: 792e 222e 666f 726d 6174 282a 666d 7429  y.".format(*fmt)
+0001bbb0: 290d 0a20 2020 2065 6c73 6520 3a20 0d0a  )..    else : ..
+0001bbc0: 2020 2020 2020 2020 6c61 6265 6c73 203d          labels =
+0001bbd0: 2069 6e74 2028 5f61 7373 6572 745f 616c   int (_assert_al
+0001bbe0: 6c5f 7479 7065 7328 6c61 6265 6c73 202c  l_types(labels ,
+0001bbf0: 2069 6e74 2c20 666c 6f61 7429 290d 0a20   int, float)).. 
+0001bc00: 2020 2020 2020 206c 6162 656c 7320 3d20         labels = 
+0001bc10: 6e70 2e6c 696e 7370 6163 6520 2820 6d69  np.linspace ( mi
+0001bc20: 6e28 6172 292c 206d 6178 2028 6172 292c  n(ar), max (ar),
+0001bc30: 206c 6162 656c 7320 2b20 3120 2920 232b   labels + 1 ) #+
+0001bc40: 202e 3030 3030 3030 3031 200d 0a20 2020   .00000001 ..   
+0001bc50: 2020 2020 2023 6172 7261 7928 5b20 302e       #array([ 0.
+0001bc60: 2c20 2036 2e2c 2031 322e 2c20 3138 2e5d  ,  6., 12., 18.]
+0001bc70: 290d 0a20 2020 2020 2020 2023 2073 706c  )..        # spl
+0001bc80: 6974 2061 7272 2061 6e64 2067 6574 2074  it arr and get t
+0001bc90: 6865 2072 616e 6765 206f 6620 7769 7468  he range of with
+0001bca0: 206d 6178 2062 6f75 6e64 200d 0a20 2020   max bound ..   
+0001bcb0: 2020 2020 2063 6320 3d20 6e70 2e61 7261       cc = np.ara
+0001bcc0: 6e67 6520 286c 656e 286c 6162 656c 7329  nge (len(labels)
+0001bcd0: 2920 235b 302c 2031 2c20 335d 0d0a 2020  ) #[0, 1, 3]..  
+0001bce0: 2020 2020 2020 2320 7765 2065 7870 6563        # we expec
+0001bcf0: 7420 7468 7265 6520 636c 6173 7365 7320  t three classes 
+0001bd00: 5b20 302c 2031 2c20 3320 5d20 7768 696c  [ 0, 1, 3 ] whil
+0001bd10: 6520 6d61 7869 6d75 6d20 0d0a 2020 2020  e maximum ..    
+0001bd20: 2020 2020 2320 7661 6c75 6520 6973 2031      # value is 1
+0001bd30: 3820 2e20 7765 2077 616e 7420 7468 6520  8 . we want the 
+0001bd40: 7661 6c75 6520 7661 6c75 6520 746f 2062  value value to b
+0001bd50: 6520 3e3d 2031 3220 7768 6963 6820 0d0a  e >= 12 which ..
+0001bd60: 2020 2020 2020 2020 2320 696e 636c 7564          # includ
+0001bd70: 6520 3138 202c 2073 6f20 7265 6d6f 7665  e 18 , so remove
+0001bd80: 2074 6865 2031 3820 696e 2074 6865 206c   the 18 in the l
+0001bd90: 6973 7420 0d0a 2020 2020 2020 2020 6c61  ist ..        la
+0001bda0: 6265 6c73 203d 206c 6162 656c 7320 5b3a  bels = labels [:
+0001bdb0: 2d31 5d20 2320 7265 6d6f 7665 2074 6865  -1] # remove the
+0001bdc0: 206c 6173 7420 6974 656d 7320 610d 0a20   last items a.. 
+0001bdd0: 2020 2020 2020 2023 2061 7272 6179 285b         # array([
+0001bde0: 302c 2031 2c20 322c 2033 2c20 342c 2035  0, 1, 2, 3, 4, 5
+0001bdf0: 2c20 362c 2037 2c20 382c 2039 5d29 0d0a  , 6, 7, 8, 9])..
+0001be00: 2020 2020 2020 2020 2320 6172 7261 7928          # array(
+0001be10: 5b30 2c20 302c 2030 2c20 302c 2031 2c20  [0, 0, 0, 0, 1, 
+0001be20: 312c 2031 2c20 322c 2032 2c20 325d 2920  1, 1, 2, 2, 2]) 
+0001be30: 2320 3320 636c 6173 7365 7320 0d0a 2020  # 3 classes ..  
+0001be40: 2020 2020 2020 2320 2061 7272 6179 285b        #  array([
+0001be50: 2030 2e20 2020 2020 2020 202c 2020 332e   0.        ,  3.
+0001be60: 3333 3333 3333 3333 2c20 2036 2e36 3636  33333333,  6.666
+0001be70: 3636 3636 372c 2031 302e 205d 2920 2b20  66667, 10. ]) + 
+0001be80: 0d0a 2020 2020 2320 746f 2061 766f 6964  ..    # to avoid
+0001be90: 2074 6865 2069 6e64 6578 2062 6f75 6e64   the index bound
+0001bea0: 2065 7272 6f72 200d 0a20 2020 2023 2061   error ..    # a
+0001beb0: 7070 656e 6420 6e61 6e20 7661 6c75 6520  ppend nan value 
+0001bec0: 746f 206c 656e 6774 6865 6e20 6172 7220  to lengthen arr 
+0001bed0: 0d0a 2020 2020 7220 3d20 6e70 2e61 7070  ..    r = np.app
+0001bee0: 656e 6420 286c 6162 656c 7320 2c20 6e70  end (labels , np
+0001bef0: 2e6e 616e 2029 200d 0a20 2020 206e 6577  .nan ) ..    new
+0001bf00: 5f61 7272 203d 206e 702e 7a65 726f 735f  _arr = np.zeros_
+0001bf10: 6c69 6b65 2861 7229 200d 0a20 2020 2023  like(ar) ..    #
+0001bf20: 2070 7269 6e74 286c 6162 656c 7329 0d0a   print(labels)..
+0001bf30: 2020 2020 6172 203d 2061 722e 6173 7479      ar = ar.asty
+0001bf40: 7065 2028 6e70 2e66 6c6f 6174 3332 290d  pe (np.float32).
+0001bf50: 0a0d 0a20 2020 2069 6620 6f72 6465 7220  ...    if order 
+0001bf60: 3d3d 2773 7472 6963 7427 3a20 0d0a 2020  =='strict': ..  
+0001bf70: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+0001bf80: 616e 6765 2028 6c65 6e28 7229 293a 0d0a  ange (len(r)):..
+0001bf90: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0001bfa0: 203d 3d20 6c65 6e28 7229 202d 3220 3a20   == len(r) -2 : 
+0001bfb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001bfc0: 2020 6978 203d 206e 702e 6172 6777 6865    ix = np.argwhe
+0001bfd0: 7265 2028 2028 6172 203e 3d20 725b 695d  re ( (ar >= r[i]
+0001bfe0: 2920 2620 2861 7220 213d 206e 702e 696e  ) & (ar != np.in
+0001bff0: 6620 2929 0d0a 2020 2020 2020 2020 2020  f ))..          
+0001c000: 2020 2020 2020 6e65 775f 6172 725b 6978        new_arr[ix
+0001c010: 205d 3d20 6363 5b69 5d0d 0a20 2020 2020   ]= cc[i]..     
+0001c020: 2020 2020 2020 2020 2020 2062 7265 616b             break
+0001c030: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
+0001c040: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001c050: 6920 3d3d 3020 3a20 0d0a 2020 2020 2020  i ==0 : ..      
+0001c060: 2020 2020 2020 2020 2020 6978 203d 206e            ix = n
+0001c070: 702e 6172 6777 6865 7265 2028 6172 203c  p.argwhere (ar <
+0001c080: 2072 5b69 202b 315d 290d 0a20 2020 2020   r[i +1])..     
+0001c090: 2020 2020 2020 2020 2020 206e 6577 5f61             new_a
+0001c0a0: 7272 205b 6978 5d20 3d3d 2063 635b 695d  rr [ix] == cc[i]
+0001c0b0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0001c0c0: 2020 2061 7220 5b69 7820 5d20 3d20 6e70     ar [ix ] = np
+0001c0d0: 2e69 6e66 2023 2072 6570 6c61 6365 2062  .inf # replace b
+0001c0e0: 7920 6120 6269 6720 6e75 6d62 6572 2074  y a big number t
+0001c0f0: 6861 6e20 6974 2077 6173 200d 0a20 2020  han it was ..   
+0001c100: 2020 2020 2020 2020 2020 2020 2023 2072               # r
+0001c110: 6174 6865 7220 7468 616e 2064 656c 6574  ather than delet
+0001c120: 6520 6974 200d 0a20 2020 2020 2020 2020  e it ..         
+0001c130: 2020 2065 6c73 6520 3a0d 0a20 2020 2020     else :..     
+0001c140: 2020 2020 2020 2020 2020 2069 7820 3d20             ix = 
+0001c150: 6e70 2e61 7267 7768 6572 6528 2028 725b  np.argwhere( (r[
+0001c160: 695d 203c 3d20 6172 2920 2620 2861 7220  i] <= ar) & (ar 
+0001c170: 3c20 725b 6920 2b31 5d29 2029 0d0a 2020  < r[i +1]) )..  
+0001c180: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+0001c190: 775f 6172 7220 5b69 7820 5d3d 2063 635b  w_arr [ix ]= cc[
+0001c1a0: 695d 200d 0a20 2020 2020 2020 2020 2020  i] ..           
+0001c1b0: 2020 2020 2061 7220 5b69 7820 5d20 3d20       ar [ix ] = 
+0001c1c0: 6e70 2e69 6e66 200d 0a20 2020 2065 6c73  np.inf ..    els
+0001c1d0: 653a 200d 0a20 2020 2020 2020 206c 3d20  e: ..        l= 
+0001c1e0: 6c69 7374 2829 200d 0a20 2020 2020 2020  list() ..       
+0001c1f0: 2066 6f72 2069 2069 6e20 7261 6e67 6520   for i in range 
+0001c200: 286c 656e 2872 2929 3a20 0d0a 2020 2020  (len(r)): ..    
+0001c210: 2020 2020 2020 2020 6966 2069 203d 3d20          if i == 
+0001c220: 6c65 6e28 7229 202d 3220 3a20 0d0a 2020  len(r) -2 : ..  
+0001c230: 2020 2020 2020 2020 2020 2020 2020 6c2e                l.
+0001c240: 6170 7065 6e64 2028 6e70 2e72 6570 6561  append (np.repea
+0001c250: 7420 2820 6363 5b69 5d2c 206c 656e 2861  t ( cc[i], len(a
+0001c260: 7229 2929 200d 0a20 2020 2020 2020 2020  r))) ..         
+0001c270: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0001c280: 2020 2020 2020 2020 2062 7265 616b 0d0a           break..
+0001c290: 2020 2020 2020 2020 2020 2020 6978 203d              ix =
+0001c2a0: 206e 702e 6172 6777 6865 7265 2028 2028   np.argwhere ( (
+0001c2b0: 6172 203c 2072 205b 2069 202b 2031 205d  ar < r [ i + 1 ]
+0001c2c0: 2029 290d 0a20 2020 2020 2020 2020 2020   ))..           
+0001c2d0: 206c 2e61 7070 656e 6420 286e 702e 7265   l.append (np.re
+0001c2e0: 7065 6174 2028 6363 5b69 5d2c 206c 656e  peat (cc[i], len
+0001c2f0: 2028 6172 5b69 7820 5d29 2929 2020 0d0a   (ar[ix ])))  ..
+0001c300: 2020 2020 2020 2020 2020 2020 2320 7265              # re
+0001c310: 6d6f 7665 2074 6865 2076 616c 7565 2072  move the value r
+0001c320: 6561 6479 2066 6f72 2069 206c 6162 656c  eady for i label
+0001c330: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
+0001c340: 2063 6174 6567 6f72 697a 6174 696f 6e20   categorization 
+0001c350: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
+0001c360: 203d 206e 702e 6465 6c65 7465 2028 6172   = np.delete (ar
+0001c370: 2c20 6978 2020 290d 0a20 2020 2020 2020  , ix  )..       
+0001c380: 2020 2020 200d 0a20 2020 2020 2020 206e       ..        n
+0001c390: 6577 5f61 7272 3d20 6e70 2e68 7374 6163  ew_arr= np.hstac
+0001c3a0: 6b20 286c 292e 6173 7479 7065 2028 6e70  k (l).astype (np
+0001c3b0: 2e69 6e74 3332 2920 200d 0a20 2020 2020  .int32)  ..     
+0001c3c0: 2020 200d 0a20 2020 2072 6574 7572 6e20     ..    return 
+0001c3d0: 6e65 775f 6172 722e 6173 7479 7065 2028  new_arr.astype (
+0001c3e0: 6e70 2e69 6e74 3332 2920 200d 0a0d 0a0d  np.int32)  .....
+0001c3f0: 0a64 6566 2076 616c 6964 6174 655f 6c61  .def validate_la
+0001c400: 6265 6c73 2028 742c 202f 2c20 6c61 6265  bels (t, /, labe
+0001c410: 6c73 2c20 7265 7475 726e 5f62 6f6f 6c20  ls, return_bool 
+0001c420: 3d20 4661 6c73 6529 3a20 0d0a 2020 2020  = False): ..    
+0001c430: 2222 2220 4173 7365 7274 2074 6865 2076  """ Assert the v
+0001c440: 616c 6964 6974 7920 6f66 2074 6865 206c  alidity of the l
+0001c450: 6162 656c 2069 6e20 7468 6520 7461 7267  abel in the targ
+0001c460: 6574 2020 616e 6420 7265 7475 726e 2074  et  and return t
+0001c470: 6865 206c 6162 656c 200d 0a20 2020 206f  he label ..    o
+0001c480: 7220 7468 6520 626f 6f6c 6561 6e20 7768  r the boolean wh
+0001c490: 6574 6865 7220 616c 6c20 6974 656d 7320  ether all items 
+0001c4a0: 6f66 206c 6162 656c 2061 7265 2069 6e20  of label are in 
+0001c4b0: 7468 6520 7461 7267 6574 2e20 0d0a 2020  the target. ..  
+0001c4c0: 2020 0d0a 2020 2020 3a70 6172 616d 2074    ..    :param t
+0001c4d0: 3a20 6172 7261 792d 6c69 6b65 2c20 7461  : array-like, ta
+0001c4e0: 7267 6574 2074 6861 7420 6973 2065 7870  rget that is exp
+0001c4f0: 6563 7465 6420 746f 2063 6f6e 7461 696e  ected to contain
+0001c500: 2074 6865 206c 6162 656c 732e 200d 0a20   the labels. .. 
+0001c510: 2020 203a 7061 7261 6d20 6c61 6265 6c73     :param labels
+0001c520: 3a20 696e 742c 2073 7472 206f 7220 6c69  : int, str or li
+0001c530: 7374 206f 6620 2873 7472 206f 7220 696e  st of (str or in
+0001c540: 7429 2074 6861 7420 6973 2073 7570 706f  t) that is suppo
+0001c550: 7365 6420 746f 2062 6520 696e 200d 0a20  sed to be in .. 
+0001c560: 2020 2020 2020 2074 6865 2074 6172 6765         the targe
+0001c570: 7420 6074 602e 200d 0a20 2020 203a 7061  t `t`. ..    :pa
+0001c580: 7261 6d20 7265 7475 726e 5f62 6f6f 6c3a  ram return_bool:
+0001c590: 2062 6f6f 6c2c 2064 6566 6175 6c74 3d46   bool, default=F
+0001c5a0: 616c 7365 3b20 7265 7475 726e 7320 2754  alse; returns 'T
+0001c5b0: 7275 6527 206f 7220 2746 616c 7365 2720  rue' or 'False' 
+0001c5c0: 7261 7468 6572 200d 0a20 2020 2020 2020  rather ..       
+0001c5d0: 2074 6865 206c 6162 656c 7320 6966 2073   the labels if s
+0001c5e0: 6574 2074 6f20 6060 5472 7565 6060 2e20  et to ``True``. 
+0001c5f0: 0d0a 2020 2020 3a72 6574 7572 6e73 3a20  ..    :returns: 
+0001c600: 626f 6f6c 206f 7220 6c61 6265 6c73 3b20  bool or labels; 
+0001c610: 2754 7275 6527 206f 7220 2746 616c 7365  'True' or 'False
+0001c620: 2720 6966 2060 7265 7475 726e 5f62 6f6f  ' if `return_boo
+0001c630: 6c60 2069 7320 7365 7420 746f 200d 0a20  l` is set to .. 
+0001c640: 2020 2020 2020 2060 6054 7275 6560 6020         ``True`` 
+0001c650: 616e 6420 6c61 6265 6c73 206f 7468 6572  and labels other
+0001c660: 7769 7365 2e20 0d0a 2020 2020 2020 2020  wise. ..        
+0001c670: 0d0a 2020 2020 3a65 7861 6d70 6c65 3a20  ..    :example: 
+0001c680: 0d0a 2020 2020 3e3e 3e20 6672 6f6d 2077  ..    >>> from w
+0001c690: 6174 6578 2e64 6174 6173 6574 7320 696d  atex.datasets im
+0001c6a0: 706f 7274 2066 6574 6368 5f64 6174 6120  port fetch_data 
+0001c6b0: 0d0a 2020 2020 3e3e 3e20 6672 6f6d 2077  ..    >>> from w
+0001c6c0: 6174 6578 2e75 7469 6c73 2e6d 6c75 7469  atex.utils.mluti
+0001c6d0: 6c73 2069 6d70 6f72 7420 6361 7474 6172  ls import cattar
+0001c6e0: 6765 742c 206c 6162 656c 735f 7661 6c69  get, labels_vali
+0001c6f0: 6461 746f 7220 0d0a 2020 2020 3e3e 3e20  dator ..    >>> 
+0001c700: 5f2c 2079 203d 2066 6574 6368 5f64 6174  _, y = fetch_dat
+0001c710: 6120 2827 6261 676f 7565 272c 2072 6574  a ('bagoue', ret
+0001c720: 7572 6e5f 585f 793d 5472 7565 2c20 6173  urn_X_y=True, as
+0001c730: 5f66 7261 6d65 3d54 7275 6529 200d 0a20  _frame=True) .. 
+0001c740: 2020 203e 3e3e 2023 2062 696e 6172 697a     >>> # binariz
+0001c750: 6520 7461 7267 6574 2079 2069 6e74 6f20  e target y into 
+0001c760: 5b30 202c 2031 5d0d 0a20 2020 203e 3e3e  [0 , 1]..    >>>
+0001c770: 2079 6269 6e20 3d20 6361 7474 6172 6765   ybin = cattarge
+0001c780: 7428 792c 206c 6162 656c 733d 3220 290d  t(y, labels=2 ).
+0001c790: 0a20 2020 203e 3e3e 2076 616c 6964 6174  .    >>> validat
+0001c7a0: 655f 6c61 6265 6c73 2028 7962 696e 2c20  e_labels (ybin, 
+0001c7b0: 5b30 2c20 315d 290d 0a20 2020 202e 2e2e  [0, 1])..    ...
+0001c7c0: 205b 302c 2031 5d20 2320 616c 6c20 6c61   [0, 1] # all la
+0001c7d0: 6265 6c73 2065 7869 7374 2e20 0d0a 2020  bels exist. ..  
+0001c7e0: 2020 3e3e 3e20 7661 6c69 6461 7465 5f6c    >>> validate_l
+0001c7f0: 6162 656c 7320 2879 2c20 5b30 2c20 312c  abels (y, [0, 1,
+0001c800: 2033 5d29 0d0a 2020 2020 2e2e 2e20 5661   3])..    ... Va
+0001c810: 6c75 6545 7272 6f72 3a20 5661 6c75 6520  lueError: Value 
+0001c820: 2733 2720 6973 206d 6973 7369 6e67 2069  '3' is missing i
+0001c830: 6e20 7468 6520 7461 7267 6574 2e0d 0a20  n the target... 
+0001c840: 2020 203e 3e3e 2076 616c 6964 6174 655f     >>> validate_
+0001c850: 6c61 6265 6c73 2028 7962 696e 2c20 3020  labels (ybin, 0 
+0001c860: 290d 0a20 2020 202e 2e2e 205b 305d 0d0a  )..    ... [0]..
+0001c870: 2020 2020 3e3e 3e20 7661 6c69 6461 7465      >>> validate
+0001c880: 5f6c 6162 656c 7320 2879 6269 6e2c 205b  _labels (ybin, [
+0001c890: 302c 2035 5d2c 2072 6574 7572 6e5f 626f  0, 5], return_bo
+0001c8a0: 6f6c 3d54 7275 6520 2920 2320 6e6f 2072  ol=True ) # no r
+0001c8b0: 6169 7365 2065 7272 6f72 0d0a 2020 2020  aise error..    
+0001c8c0: 2e2e 2e20 4661 6c73 650d 0a20 2020 2020  ... False..     
+0001c8d0: 2020 200d 0a20 2020 2022 2222 0d0a 2020     ..    """..  
+0001c8e0: 2020 0d0a 2020 2020 6966 206e 6f74 2069    ..    if not i
+0001c8f0: 735f 6974 6572 6162 6c65 286c 6162 656c  s_iterable(label
+0001c900: 7329 3a0d 0a20 2020 2020 2020 206c 6162  s):..        lab
+0001c910: 656c 7320 3d5b 6c61 6265 6c73 5d20 0d0a  els =[labels] ..
+0001c920: 2020 2020 2020 2020 0d0a 2020 2020 7420          ..    t 
+0001c930: 3d20 6e70 2e61 7272 6179 2874 290d 0a20  = np.array(t).. 
+0001c940: 2020 206d 6173 6b20 3d20 6e70 2e69 7369     mask = np.isi
+0001c950: 6e28 742c 206c 6162 656c 7329 200d 0a20  n(t, labels) .. 
+0001c960: 2020 2074 7275 655f 6c61 6265 6c73 203d     true_labels =
+0001c970: 206e 702e 756e 6971 7565 2028 745b 6d61   np.unique (t[ma
+0001c980: 736b 5d29 200d 0a20 2020 2023 2073 6574  sk]) ..    # set
+0001c990: 2074 6865 2064 6966 6665 7265 6e63 6520   the difference 
+0001c9a0: 746f 206b 6e6f 7720 0d0a 2020 2020 2320  to know ..    # 
+0001c9b0: 7768 6574 6865 7220 616c 6c20 6c61 6265  whether all labe
+0001c9c0: 6c73 2061 7265 2076 616c 6964 200d 0a20  ls are valid .. 
+0001c9d0: 2020 2072 656d 6169 6e64 6572 203d 206c     remainder = l
+0001c9e0: 6973 7428 7365 7428 6c61 6265 6c73 292e  ist(set(labels).
+0001c9f0: 6469 6666 6572 656e 6365 2028 7472 7565  difference (true
+0001ca00: 5f6c 6162 656c 7329 290d 0a20 2020 200d  _labels))..    .
+0001ca10: 0a20 2020 2069 7376 616c 6964 203d 2054  .    isvalid = T
+0001ca20: 7275 6520 0d0a 2020 2020 6966 206c 656e  rue ..    if len
+0001ca30: 2872 656d 6169 6e64 6572 2921 3d30 203a  (remainder)!=0 :
+0001ca40: 200d 0a20 2020 2020 2020 2069 6620 6e6f   ..        if no
+0001ca50: 7420 7265 7475 726e 5f62 6f6f 6c3a 200d  t return_bool: .
+0001ca60: 0a20 2020 2020 2020 2020 2020 2023 2072  .            # r
+0001ca70: 6169 7365 2065 7272 6f72 2020 0d0a 2020  aise error  ..  
+0001ca80: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001ca90: 5661 6c75 6545 7272 6f72 2028 0d0a 2020  ValueError (..  
+0001caa0: 2020 2020 2020 2020 2020 2020 2020 224c                "L
+0001cab0: 6162 656c 2076 616c 7565 7b30 7d20 7b31  abel value{0} {1
+0001cac0: 7d20 7b32 7d20 6d69 7373 696e 6720 696e  } {2} missing in
+0001cad0: 2074 6865 2074 6172 6765 7420 2779 272e   the target 'y'.
+0001cae0: 222e 666f 726d 6174 2028 200d 0a20 2020  ".format ( ..   
+0001caf0: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
+0001cb00: 2773 2720 6966 206c 656e 2872 656d 6169  's' if len(remai
+0001cb10: 6e64 6572 293e 3120 656c 7365 2027 277d  nder)>1 else ''}
+0001cb20: 222c 200d 0a20 2020 2020 2020 2020 2020  ", ..           
+0001cb30: 2020 2020 2066 227b 736d 6172 745f 666f       f"{smart_fo
+0001cb40: 726d 6174 2872 656d 6169 6e64 6572 297d  rmat(remainder)}
+0001cb50: 222c 0d0a 2020 2020 2020 2020 2020 2020  ",..            
+0001cb60: 2020 2020 6622 7b27 6172 6527 2069 6620      f"{'are' if 
+0001cb70: 6c65 6e28 7265 6d61 696e 6465 7229 3e20  len(remainder)> 
+0001cb80: 3120 656c 7365 2027 6973 277d 2229 0d0a  1 else 'is'}")..
+0001cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cba0: 290d 0a20 2020 2020 2020 2069 7376 616c  )..        isval
+0001cbb0: 6964 3d20 4661 6c73 6520 0d0a 2020 2020  id= False ..    
+0001cbc0: 2020 2020 0d0a 2020 2020 7265 7475 726e      ..    return
+0001cbd0: 2069 7376 616c 6964 2069 6620 7265 7475   isvalid if retu
+0001cbe0: 726e 5f62 6f6f 6c20 656c 7365 2020 6c61  rn_bool else  la
+0001cbf0: 6265 6c73 200d 0a0d 0a64 6566 205f 7661  bels ....def _va
+0001cc00: 6c69 6461 7465 5f73 616d 706c 6573 2028  lidate_samples (
+0001cc10: 2a64 6673 202c 2065 7272 6f72 3a73 7472  *dfs , error:str
+0001cc20: 203d 2772 6169 7365 2729 3a20 0d0a 2020   ='raise'): ..  
+0001cc30: 2020 2222 2220 5661 6c69 6461 7465 2064    """ Validate d
+0001cc40: 6174 6120 2e20 0d0a 2020 2020 2063 6865  ata . ..     che
+0001cc50: 636b 2073 6861 7065 7320 616e 6420 7468  ck shapes and th
+0001cc60: 6520 636f 6c75 6d6e 7320 6974 656d 7320  e columns items 
+0001cc70: 696e 2074 6865 2064 6174 612e 0d0a 2020  in the data...  
+0001cc80: 2020 200d 0a20 2020 203a 7061 7261 6d20     ..    :param 
+0001cc90: 6466 733a 206c 6973 7420 6f66 2064 6174  dfs: list of dat
+0001cca0: 6166 7261 6d65 7320 6f72 2061 7272 6179  aframes or array
+0001ccb0: 2d6c 696b 6520 0d0a 2020 2020 2020 2020  -like ..        
+0001ccc0: 4461 7461 6672 616d 6520 6d75 7374 2068  Dataframe must h
+0001ccd0: 6176 6520 7468 6520 7361 6d65 2073 697a  ave the same siz
+0001cce0: 6520 616c 6f6e 6720 6178 6973 2031 2e20  e along axis 1. 
+0001ccf0: 4966 2065 7272 6f72 2069 7320 2769 676e  If error is 'ign
+0001cd00: 6f72 6527 0d0a 2020 2020 2020 2020 6572  ore'..        er
+0001cd10: 726f 7220 6973 206d 7574 6564 2069 6620  ror is muted if 
+0001cd20: 7468 6520 6c65 6e67 7468 2028 2061 6c6f  the length ( alo
+0001cd30: 6e67 2061 7869 7320 3029 206f 6620 6461  ng axis 0) of da
+0001cd40: 7461 2064 6f65 7320 6e6f 7420 6669 7420  ta does not fit 
+0001cd50: 0d0a 2020 2020 2020 2020 6561 6368 206f  ..        each o
+0001cd60: 7468 6572 2e20 0d0a 2020 2020 3a70 6172  ther. ..    :par
+0001cd70: 616d 2065 7272 6f72 3a20 7374 722c 2064  am error: str, d
+0001cd80: 6566 6175 6c74 3d27 7261 6973 6527 200d  efault='raise' .
+0001cd90: 0a20 2020 2020 2020 2052 6169 7365 2061  .        Raise a
+0001cda0: 6273 6f6c 7574 656c 7920 6572 726f 7220  bsolutely error 
+0001cdb0: 6966 2064 6174 6120 6861 7320 6e6f 7420  if data has not 
+0001cdc0: 7468 6520 7361 6d65 2073 6861 7065 2c20  the same shape, 
+0001cdd0: 7369 7a65 2061 6e64 2069 7465 6d73 200d  size and items .
+0001cde0: 0a20 2020 2020 2020 2069 6e20 636f 6c75  .        in colu
+0001cdf0: 6d6e 732e 200d 0a20 2020 203a 7265 7475  mns. ..    :retu
+0001ce00: 726e 3a20 0d0a 2020 2020 2020 2020 7661  rn: ..        va
+0001ce10: 6c69 645f 6466 733a 204c 6973 7420 6f66  lid_dfs: List of
+0001ce20: 2076 616c 6964 6120 6461 7461 2e20 4966   valida data. If
+0001ce30: 2027 6572 726f 7227 2069 7320 2769 676e   'error' is 'ign
+0001ce40: 6f72 6527 202c 2049 7420 7374 696c 6c20  ore' , It still 
+0001ce50: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0001ce60: 7320 7468 6520 6c69 7374 206f 6620 7661  s the list of va
+0001ce70: 6c69 6420 6461 7461 2061 6e64 2065 7863  lid data and exc
+0001ce80: 6c75 6465 7320 7468 6520 696e 7661 6c69  ludes the invali
+0001ce90: 6420 616c 6c20 7469 6d65 7320 0d0a 2020  d all times ..  
+0001cea0: 2020 2020 2020 6c65 6176 696e 6720 616e        leaving an
+0001ceb0: 2075 7365 7277 6172 6e6d 696d 672e 0d0a   userwarnmimg...
+0001cec0: 2020 2020 2020 2020 0d0a 2020 2020 2222          ..    ""
+0001ced0: 220d 0a20 2020 2073 6861 7065 5f69 6e69  "..    shape_ini
+0001cee0: 7420 3d20 6466 735b 305d 2e73 6861 7065  t = dfs[0].shape
+0001cef0: 5b31 5d0d 0a20 2020 205b 205f 6173 7365  [1]..    [ _asse
+0001cf00: 7274 5f61 6c6c 5f74 7970 6573 2864 662c  rt_all_types(df,
+0001cf10: 206e 702e 6e64 6172 7261 792c 2070 642e   np.ndarray, pd.
+0001cf20: 4461 7461 4672 616d 6529 2066 6f72 2064  DataFrame) for d
+0001cf30: 6620 696e 2064 6673 205d 0d0a 2020 2020  f in dfs ]..    
+0001cf40: 6469 6666 5f73 6861 7065 202c 2073 6861  diff_shape , sha
+0001cf50: 7065 7320 202c 2063 6f6c 7320 3d20 5b5d  pes  , cols = []
+0001cf60: 2c20 5b5d 2c5b 5d0d 0a20 2020 200d 0a20  , [],[]..    .. 
+0001cf70: 2020 2063 6f6c 5f69 6e69 7420 3d20 6466     col_init = df
+0001cf80: 735b 305d 2e63 6f6c 756d 6e73 2069 6620  s[0].columns if 
+0001cf90: 6861 7361 7474 7220 2864 6673 5b30 5d20  hasattr (dfs[0] 
+0001cfa0: 2c20 2763 6f6c 756d 6e73 2729 2065 6c73  , 'columns') els
+0001cfb0: 6520 5b5d 200d 0a20 2020 2076 616c 6964  e [] ..    valid
+0001cfc0: 5f64 6673 203d 5b5d 0d0a 2020 2020 666f  _dfs =[]..    fo
+0001cfd0: 7220 6b20 2c20 6466 2069 6e20 656e 756d  r k , df in enum
+0001cfe0: 6572 6174 6520 2864 6673 2920 3a20 0d0a  erate (dfs) : ..
+0001cff0: 2020 2020 2020 2020 6966 2064 662e 7368          if df.sh
+0001d000: 6170 655b 315d 2021 3d20 7368 6170 655f  ape[1] != shape_
+0001d010: 696e 6974 203a 0d0a 2020 2020 2020 2020  init :..        
+0001d020: 2020 2020 6469 6666 5f73 6861 7065 2e61      diff_shape.a
+0001d030: 7070 656e 6428 6b29 200d 0a20 2020 2020  ppend(k) ..     
+0001d040: 2020 2065 6c73 653a 2076 616c 6964 5f64     else: valid_d
+0001d050: 6673 2e61 7070 656e 6420 2864 6620 290d  fs.append (df ).
+0001d060: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0001d070: 2020 2073 6861 7065 732e 6170 7065 6e64     shapes.append
+0001d080: 2028 6466 2e73 6861 7065 290d 0a20 2020   (df.shape)..   
+0001d090: 2020 2020 2069 6620 6861 7361 7474 7220       if hasattr 
+0001d0a0: 2864 662c 2027 636f 6c75 6d6e 7327 293a  (df, 'columns'):
+0001d0b0: 200d 0a20 2020 2020 2020 2020 2020 2063   ..            c
+0001d0c0: 6f6c 732e 6170 7065 6e64 2028 6c69 7374  ols.append (list
+0001d0d0: 2864 662e 636f 6c75 6d6e 7320 2929 0d0a  (df.columns ))..
+0001d0e0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0001d0f0: 2020 636f 756e 7473 6861 7065 7320 3d20    countshapes = 
+0001d100: 6c69 7374 2843 6f75 6e74 6572 2028 7368  list(Counter (sh
+0001d110: 6170 6573 2029 2920 2320 6974 6572 6162  apes )) # iterab
+0001d120: 6c65 206f 626a 6563 7420 0d0a 2020 2020  le object ..    
+0001d130: 6f63 6373 6861 7065 7320 3d20 636f 756e  occshapes = coun
+0001d140: 7473 6861 7065 7320 5b30 5d20 2320 7468  tshapes [0] # th
+0001d150: 6520 6d6f 7374 206f 6363 7572 656e 6365  e most occurence
+0001d160: 2073 6861 7065 0d0a 2020 2020 6966 206c   shape..    if l
+0001d170: 656e 2864 6966 665f 7368 6170 6520 2921  en(diff_shape )!
+0001d180: 3d30 203a 200d 0a20 2020 2020 2020 2076  =0 : ..        v
+0001d190: 3d66 227b 2773 2720 6966 206c 656e 2864  =f"{'s' if len(d
+0001d1a0: 6966 665f 7368 6170 6529 3e31 2065 6c73  iff_shape)>1 els
+0001d1b0: 6520 2727 7d22 0d0a 2020 2020 2020 2020  e ''}"..        
+0001d1c0: 6d65 7373 203d 2028 2253 6861 7065 7320  mess = ("Shapes 
+0001d1d0: 666f 7220 616c 6c20 6461 7461 206d 7573  for all data mus
+0001d1e0: 7420 6265 2063 6f6e 7369 7374 656e 743b  t be consistent;
+0001d1f0: 2067 6f74 2022 200d 0a20 2020 2020 2020   got " ..       
+0001d200: 2020 2020 2020 2020 2066 2261 7420 7468           f"at th
+0001d210: 6520 706f 7369 7469 6f6e 7b76 7d20 7b73  e position{v} {s
+0001d220: 6d61 7274 5f66 6f72 6d61 7428 6469 6666  mart_format(diff
+0001d230: 5f73 6861 7065 297d 2e22 290d 0a20 2020  _shape)}.")..   
+0001d240: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
+0001d250: 6620 6572 726f 7220 3d3d 2772 6169 7365  f error =='raise
+0001d260: 273a 200d 0a20 2020 2020 2020 2020 2020  ': ..           
+0001d270: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0001d280: 7220 286d 6573 7320 2b20 6622 2045 7870  r (mess + f" Exp
+0001d290: 6563 7473 207b 6f63 6373 6861 7065 737d  ects {occshapes}
+0001d2a0: 2229 0d0a 0d0a 2020 2020 2020 2020 7761  ")....        wa
+0001d2b0: 726e 696e 6773 2e77 6172 6e28 6d65 7373  rnings.warn(mess
+0001d2c0: 202b 2066 2254 6865 206d 6f73 7420 6672   + f"The most fr
+0001d2d0: 6571 7565 6e74 2073 6861 7065 2069 7320  equent shape is 
+0001d2e0: 7b6f 6363 7368 6170 6573 7d22 0d0a 2020  {occshapes}"..  
+0001d2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d300: 2020 2020 2220 506c 6561 7365 2063 6865      " Please che
+0001d310: 636b 206f 7220 7265 7665 7269 6679 2079  ck or reverify y
+0001d320: 6f75 7220 6461 7461 2e20 5468 6973 206d  our data. This m
+0001d330: 6967 6874 206c 6561 6420 746f 220d 0a20  ight lead to".. 
+0001d340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d350: 2020 2020 2022 2062 7265 616b 696e 6720       " breaking 
+0001d360: 636f 6465 206f 7220 696e 7661 6c69 6420  code or invalid 
+0001d370: 7265 7375 6c74 732e 2055 7365 2061 7420  results. Use at 
+0001d380: 796f 7572 206f 776e 2072 6973 6b2e 220d  your own risk.".
+0001d390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d3a0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+0001d3b0: 2020 7368 6170 6531 203d 206c 6973 7428    shape1 = list(
+0001d3c0: 6d61 7020 286c 616d 6264 6120 6b3a 6b5b  map (lambda k:k[
+0001d3d0: 315d 2c20 2063 6f75 6e74 7368 6170 6573  1],  countshapes
+0001d3e0: 2929 0d0a 2020 2020 2020 2020 0d0a 2020  ))..        ..  
+0001d3f0: 2020 2020 2020 6966 2073 6574 2028 7368        if set (sh
+0001d400: 6170 6531 2920 213d 3120 3a20 0d0a 2020  ape1) !=1 : ..  
+0001d410: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001d420: 5661 6c75 6545 7272 6f72 2028 2253 6861  ValueError ("Sha
+0001d430: 7065 2061 6c6f 6e67 2061 7869 7320 3120  pe along axis 1 
+0001d440: 6d75 7374 2062 6520 636f 6e73 6973 7465  must be consiste
+0001d450: 6e74 2e20 220d 0a20 2020 2020 2020 2020  nt. "..         
+0001d460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d470: 2020 2020 2066 2247 6f74 207b 736d 6172       f"Got {smar
+0001d480: 745f 666f 726d 6174 2028 636f 756e 7473  t_format (counts
+0001d490: 6861 7065 7329 7d2e 2043 6865 636b 2074  hapes)}. Check t
+0001d4a0: 6865 2022 0d0a 2020 2020 2020 2020 2020  he "..          
+0001d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d4c0: 2020 2020 6622 6461 7461 2061 7420 706f      f"data at po
+0001d4d0: 7369 7469 6f6e 7b76 7d20 7b73 6d61 7274  sition{v} {smart
+0001d4e0: 5f66 6f72 6d61 7428 6469 6666 5f73 6861  _format(diff_sha
+0001d4f0: 7065 297d 2022 0d0a 2020 2020 2020 2020  pe)} "..        
+0001d500: 2020 2020 2020 2020 2920 0d0a 2020 2020          ) ..    
+0001d510: 2020 2020 2020 2020 0d0a 2020 2020 636f          ..    co
+0001d520: 6c73 7365 7420 3d20 7365 7420 2820 6c69  lsset = set ( li
+0001d530: 7374 2869 7465 7274 6f6f 6c73 2e63 6861  st(itertools.cha
+0001d540: 696e 2028 2a63 6f6c 7320 2920 2920 2920  in (*cols ) ) ) 
+0001d550: 0d0a 200d 0a20 2020 2069 6620 6c65 6e28  .. ..    if len(
+0001d560: 636f 6c73 7365 7420 2920 213d 206c 656e  colsset ) != len
+0001d570: 2863 6f6c 5f69 6e69 7429 203a 200d 0a20  (col_init) : .. 
+0001d580: 2020 2020 2020 2072 6169 7365 2044 6174         raise Dat
+0001d590: 6173 6574 4572 726f 7220 2822 4578 7065  asetError ("Expe
+0001d5a0: 6374 2069 6465 6e74 6963 616c 2063 6f6c  ct identical col
+0001d5b0: 756d 6e73 2066 6f72 2061 6c6c 2064 6174  umns for all dat
+0001d5c0: 6122 0d0a 2020 2020 2020 2020 2020 2020  a"..            
+0001d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d5e0: 2220 506c 6561 7365 2063 6865 636b 2079  " Please check y
+0001d5f0: 6f75 7220 6461 7461 2e22 2920 0d0a 2020  our data.") ..  
+0001d600: 2020 0d0a 2020 2020 7265 7475 726e 2076    ..    return v
+0001d610: 616c 6964 5f64 6673 200d 0a0d 0a40 6465  alid_dfs ....@de
+0001d620: 7072 6563 6174 6564 2028 2246 6f72 6d61  precated ("Forma
+0001d630: 7420 6973 206e 6f20 6c6f 6e67 6572 2075  t is no longer u
+0001d640: 7365 642c 2072 6570 6c61 6365 6420 6279  sed, replaced by
+0001d650: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+0001d660: 2220 605f 4171 7569 6665 7247 726f 7570  " `_AquiferGroup
+0001d670: 2e5f 666f 726d 6174 6020 696e 7374 6561  ._format` instea
+0001d680: 642e 2229 2020 2020 2020 2020 0d0a 6465  d.")        ..de
+0001d690: 6620 5f66 6f72 6d61 745f 6772 6f75 7073  f _format_groups
+0001d6a0: 2028 2064 6963 202c 202f 2c20 6e61 6d65   ( dic , /, name
+0001d6b0: 203d 2027 4c61 6265 6c27 293a 200d 0a20   = 'Label'): .. 
+0001d6c0: 2020 2022 2222 2052 6570 7265 7365 6e74     """ Represent
+0001d6d0: 2074 6865 2061 7175 6966 6572 2067 726f   the aquifer gro
+0001d6e0: 7570 2061 6e64 2074 7275 6520 6c61 6265  up and true labe
+0001d6f0: 6c73 2070 7265 706f 6e64 6572 616e 6365  ls preponderance
+0001d700: 2022 2222 0d0a 2020 2020 6167 3d5b 227b   """..    ag=["{
+0001d710: 3a37 7d22 2e66 6f72 6d61 7428 224c 6162  :7}".format("Lab
+0001d720: 656c 7b7d 2028 222e 666f 726d 6174 2822  el{} (".format("
+0001d730: 7322 2069 6620 6c65 6e28 6469 6329 3e31  s" if len(dic)>1
+0001d740: 2065 6c73 6520 2727 2929 5d0d 0a20 2020   else ''))]..   
+0001d750: 2066 6f72 206b 2c20 286c 6162 656c 2c20   for k, (label, 
+0001d760: 7265 7072 5f76 616c 2029 2069 6e20 656e  repr_val ) in en
+0001d770: 756d 6572 6174 6520 2820 6469 632e 6974  umerate ( dic.it
+0001d780: 656d 7328 2920 293a 200d 0a20 2020 2020  ems() ): ..     
+0001d790: 2020 2070 7265 7020 2c20 6720 203d 2072     prep , g  = r
+0001d7a0: 6570 725f 7661 6c20 0d0a 2020 2020 2020  epr_val ..      
+0001d7b0: 2020 6167 202b 3d20 5b22 7b30 3a5e 337d    ag += ["{0:^3}
+0001d7c0: 3a20 7b31 3a3e 3130 7d20 2d3e 207b 323a  : {1:>10} -> {2:
+0001d7d0: 3e37 7d7b 333a 3e33 7d22 2e66 6f72 6d61  >7}{3:>3}".forma
+0001d7e0: 7420 280d 0a20 2020 2020 2020 2020 2020  t (..           
+0001d7f0: 206c 6162 656c 2069 6620 6b3d 3d30 2065   label if k==0 e
+0001d800: 6c73 6520 227b 3a3e 3130 7d22 2e66 6f72  lse "{:>10}".for
+0001d810: 6d61 7428 6c61 6265 6c29 2c0d 0a20 2020  mat(label),..   
+0001d820: 2020 2020 2020 2020 2027 696d 706f 7274           'import
+0001d830: 616e 6365 272c 2072 6f75 6e64 2870 7265  ance', round(pre
+0001d840: 7020 2a31 3030 2c20 3329 202c 2022 2522  p *100, 3) , "%"
+0001d850: 2920 5d0d 0a20 2020 2020 2020 200d 0a20  ) ]..        .. 
+0001d860: 2020 2020 2020 2061 6720 2b3d 5b22 7b3a         ag +=["{:
+0001d870: 5e33 7d5b 2028 2027 4171 7569 6665 7220  ^3}[ ( 'Aquifer 
+0001d880: 6772 6f75 7027 3a5c 6e22 2e66 6f72 6d61  group':\n".forma
+0001d890: 7428 223d 2229 5d0d 0a20 2020 2020 2020  t("=")]..       
+0001d8a0: 2061 672b 3d5b 227b 3a3e 3530 7d3a 7b3a   ag+=["{:>50}:{:
+0001d8b0: 3e31 357d 2c5c 6e22 2e66 6f72 6d61 7428  >15},\n".format(
+0001d8c0: 206b 2c20 726f 756e 6428 762c 2033 2929   k, round(v, 3))
+0001d8d0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0001d8e0: 666f 7220 6b2c 2076 2069 6e20 672e 6974  for k, v in g.it
+0001d8f0: 656d 7328 2920 5d0d 0a20 2020 2020 2020  ems() ]..       
+0001d900: 200d 0a20 2020 2020 2020 2061 672b 3d27   ..        ag+='
+0001d910: 7b3a 3e34 307d 272e 666f 726d 6174 2822  {:>40}'.format("
+0001d920: 295d 2c5c 6e20 2229 200d 0a20 2020 2020  )],\n ") ..     
+0001d930: 2020 200d 0a20 2020 2061 672b 3d5b 227b     ..    ag+=["{
+0001d940: 3a3e 377d 222e 666f 726d 6174 2822 2922  :>7}".format(")"
+0001d950: 295d 0d0a 2020 2020 0d0a 2020 2020 7265  )]..    ..    re
+0001d960: 7475 726e 2070 7269 6e74 2827 272e 6a6f  turn print(''.jo
+0001d970: 696e 2028 6167 2920 2920 0d0a 0d0a 6465  in (ag) ) ....de
+0001d980: 6620 5f6e 616d 655f 6d78 735f 6c61 6265  f _name_mxs_labe
+0001d990: 6c73 282a 7320 2c20 7365 7020 3d27 272c  ls(*s , sep ='',
+0001d9a0: 2070 7265 6669 7820 3d22 2229 3a20 0d0a   prefix =""): ..
+0001d9b0: 2020 2020 2222 2220 4e61 6d65 2074 6865      """ Name the
+0001d9c0: 204d 6978 7475 7265 2053 7472 6174 6567   Mixture Strateg
+0001d9d0: 7920 6c61 6265 6c73 2066 726f 6d20 6120  y labels from a 
+0001d9e0: 6c69 7374 206f 6620 6c61 6265 6c73 2061  list of labels a
+0001d9f0: 6e64 200d 0a20 2020 2073 696d 696c 6172  nd ..    similar
+0001da00: 6974 7920 6772 6f75 7020 0d0a 2020 2020  ity group ..    
+0001da10: 0d0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+0001da20: 200d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d   ..    ---------
+0001da30: 2d2d 0d0a 2020 2020 733a 206c 6973 7420  --..    s: list 
+0001da40: 0d0a 2020 2020 2020 2020 4c69 7374 206f  ..        List o
+0001da50: 6620 6f66 2070 6169 7220 286c 6162 656c  f of pair (label
+0001da60: 2c20 7369 6d69 6c61 7269 7479 2029 200d  , similarity ) .
+0001da70: 0a20 2020 2052 6574 7572 6e73 0d0a 2020  .    Returns..  
+0001da80: 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020    --------..    
+0001da90: 6d78 733a 206c 6973 742c 200d 0a20 2020  mxs: list, ..   
+0001daa0: 2020 2020 2063 6f6d 6269 6e65 6420 7369       combined si
+0001dab0: 6d69 6c61 7269 7479 206e 616d 6573 2e20  milarity names. 
+0001dac0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0001dad0: 4578 616d 706c 650d 0a20 2020 202d 2d2d  Example..    ---
+0001dae0: 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e 2066  -----..    >>> f
+0001daf0: 726f 6d20 7761 7465 782e 7574 696c 732e  rom watex.utils.
+0001db00: 6879 6472 6f75 7469 6c73 2069 6d70 6f72  hydroutils impor
+0001db10: 7420 5f6e 616d 655f 6d78 735f 6c61 6265  t _name_mxs_labe
+0001db20: 6c73 200d 0a20 2020 203e 3e3e 205f 6e61  ls ..    >>> _na
+0001db30: 6d65 5f6d 7873 5f6c 6162 656c 7320 2820  me_mxs_labels ( 
+0001db40: 2831 2c20 3229 202c 2028 322c 2034 2029  (1, 2) , (2, 4 )
+0001db50: 2c20 2833 2c20 3720 2929 200d 0a20 2020  , (3, 7 )) ..   
+0001db60: 202e 2e2e 205b 3132 2c20 3234 2c20 3337   ... [12, 24, 37
+0001db70: 5d0d 0a20 2020 203e 3e3e 205f 6e61 6d65  ]..    >>> _name
+0001db80: 5f6d 7873 5f6c 6162 656c 7320 2820 2831  _mxs_labels ( (1
+0001db90: 2c20 3229 202c 2028 322c 2034 2029 2c20  , 2) , (2, 4 ), 
+0001dba0: 2833 2c20 3720 292c 2070 7265 6669 7820  (3, 7 ), prefix 
+0001dbb0: 3d27 6b27 2920 0d0a 2020 2020 2e2e 2e20  ='k') ..    ... 
+0001dbc0: 5b27 6b31 3227 2c20 276b 3234 272c 2027  ['k12', 'k24', '
+0001dbd0: 6b33 3727 5d0d 0a20 2020 203e 3e3e 205f  k37']..    >>> _
+0001dbe0: 6e61 6d65 5f6d 7873 5f6c 6162 656c 7328  name_mxs_labels(
+0001dbf0: 2831 2c20 2767 726f 7570 4927 292c 2028  (1, 'groupI'), (
+0001dc00: 322c 2027 6772 6f75 7049 4927 292c 2073  2, 'groupII'), s
+0001dc10: 6570 3d27 5f27 2c20 7072 6566 6978 3d27  ep='_', prefix='
+0001dc20: 6b27 290d 0a20 2020 202e 2e2e 205b 276b  k')..    ... ['k
+0001dc30: 315f 6772 6f75 7049 272c 2027 6b31 5f67  1_groupI', 'k1_g
+0001dc40: 726f 7570 4949 275d 0d0a 2020 2020 0d0a  roupII']..    ..
+0001dc50: 2020 2020 2222 220d 0a20 2020 2066 6f72      """..    for
+0001dc60: 206f 2069 6e20 7320 3a20 0d0a 2020 2020   o in s : ..    
+0001dc70: 2020 2020 6966 206e 6f74 2069 735f 6974      if not is_it
+0001dc80: 6572 6162 6c65 286f 293a 0d0a 2020 2020  erable(o):..    
+0001dc90: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001dca0: 6c75 6545 7272 6f72 2028 0d0a 2020 2020  lueError (..    
+0001dcb0: 2020 2020 2020 2020 2020 2020 2257 726f              "Wro
+0001dcc0: 6e67 2076 616c 7565 2e20 4578 7065 6374  ng value. Expect
+0001dcd0: 2061 2070 6169 7220 7661 6c75 6573 2028   a pair values (
+0001dce0: 6c61 6265 6c2c 2073 696d 696c 6172 2067  label, similar g
+0001dcf0: 726f 7570 2922 0d0a 2020 2020 2020 2020  roup)"..        
+0001dd00: 2020 2020 2020 2020 2022 2067 6f74 3a20           " got: 
+0001dd10: 7b6f 7d22 290d 0a20 2020 2020 2020 2069  {o}")..        i
+0001dd20: 6620 6c65 6e28 6f29 2021 3d32 203a 0d0a  f len(o) !=2 :..
+0001dd30: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001dd40: 6520 5661 6c75 6545 7272 6f72 2028 2245  e ValueError ("E
+0001dd50: 7870 6563 7420 6120 7061 6972 2076 616c  xpect a pair val
+0001dd60: 7565 7320 286c 6162 656c 2c20 7369 6d69  ues (label, simi
+0001dd70: 6c61 7220 6772 6f75 705f 292e 220d 0a20  lar group_).".. 
+0001dd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd90: 2020 2020 2020 2020 2020 2020 2022 206e               " n
+0001dda0: 6f74 207b 6f7d 2229 0d0a 2020 2020 6d78  ot {o}")..    mx
+0001ddb0: 7320 3d6c 6973 7428 2920 0d0a 2020 2020  s =list() ..    
+0001ddc0: 666f 7220 6f20 696e 2073 203a 200d 0a20  for o in s : .. 
+0001ddd0: 2020 2020 2020 2078 7320 3d20 7374 7228         xs = str(
+0001dde0: 7072 6566 6978 2920 2b20 7374 7228 6f5b  prefix) + str(o[
+0001ddf0: 305d 2920 2b20 7374 7228 7365 7029 202b  0]) + str(sep) +
+0001de00: 2073 7472 286f 5b31 5d29 0d0a 2020 2020   str(o[1])..    
+0001de10: 2020 2020 7472 7920 3a20 0d0a 2020 2020      try : ..    
+0001de20: 2020 2020 2020 2020 7873 203d 2069 6e74          xs = int
+0001de30: 2028 7873 2029 0d0a 2020 2020 2020 2020   (xs )..        
+0001de40: 6578 6365 7074 203a 200d 0a20 2020 2020  except : ..     
+0001de50: 2020 2020 2020 2070 6173 7320 0d0a 2020         pass ..  
+0001de60: 2020 2020 2020 6669 6e61 6c6c 793a 206d        finally: m
+0001de70: 7873 2e61 7070 656e 6420 2878 7320 290d  xs.append (xs ).
+0001de80: 0a20 2020 2072 6574 7572 6e20 6d78 7320  .    return mxs 
+0001de90: 0d0a 200d 0a64 6566 205f 4d58 535f 6966  .. ..def _MXS_if
+0001dea0: 5f6e 6f28 636f 6e74 6578 742c 2020 2f2c  _no(context,  /,
+0001deb0: 2020 795f 7472 7565 202c 2079 5f70 7265    y_true , y_pre
+0001dec0: 6420 2c20 636d 7367 203d 2727 2c20 7472  d , cmsg ='', tr
+0001ded0: 6169 6c65 7220 3d20 222a 2229 3a20 0d0a  ailer = "*"): ..
+0001dee0: 2020 2020 2222 2220 4d61 6b65 204d 5853      """ Make MXS
+0001def0: 2061 6363 6f72 6469 6e67 2074 6f20 7468   according to th
+0001df00: 6520 636f 6e74 6578 7420 7768 6574 6865  e context whethe
+0001df10: 7220 6120 7369 6d69 6c61 7269 7479 200d  r a similarity .
+0001df20: 0a20 2020 2020 6265 7477 6565 6e20 7468  .     between th
+0001df30: 6520 7472 7565 206c 6162 656c 7320 696e  e true labels in
+0001df40: 2027 795f 7472 7565 2720 616e 6420 4e47   'y_true' and NG
+0001df50: 4120 6c61 6265 6c73 2069 7320 666f 756e  A labels is foun
+0001df60: 6420 6f72 206e 6f74 2e20 0d0a 2020 2020  d or not. ..    
+0001df70: 200d 0a20 2020 203a 7061 7261 6d20 795f   ..    :param y_
+0001df80: 7472 7565 3a20 6172 7261 792d 6c69 6b65  true: array-like
+0001df90: 2031 6420 0d0a 2020 2020 2020 2020 6172   1d ..        ar
+0001dfa0: 7261 795f 6c69 6b65 2063 6f6e 7461 696e  ray_like contain
+0001dfb0: 696e 6720 7468 6520 7472 7565 206c 6162  ing the true lab
+0001dfc0: 656c 7320 0d0a 2020 2020 3a70 6172 616d  els ..    :param
+0001dfd0: 2079 5f70 7265 643a 2061 7272 6179 5f6c   y_pred: array_l
+0001dfe0: 696b 6520 3164 200d 0a20 2020 2020 2020  ike 1d ..       
+0001dff0: 2061 7272 6179 206f 6620 7468 6520 4e47   array of the NG
+0001e000: 4120 7072 6564 6963 7465 6420 6c61 6265  A predicted labe
+0001e010: 6c73 2e20 0d0a 2020 2020 3a70 6172 616d  ls. ..    :param
+0001e020: 2063 6f6e 7465 7874 3a20 7374 7220 2c20   context: str , 
+0001e030: 7b27 6e6f 2073 696d 696c 6172 6974 7927  {'no similarity'
+0001e040: 2c20 7d0d 0a20 2020 203a 7061 7261 6d20  , }..    :param 
+0001e050: 6373 6d67 3a73 7472 2c20 0d0a 2020 2020  csmg:str, ..    
+0001e060: 2020 2020 666f 726d 6174 6167 6520 6d65      formatage me
+0001e070: 7373 6167 6520 6973 2077 726f 6e67 2063  ssage is wrong c
+0001e080: 6f6e 7465 7874 2069 7320 7061 7373 6564  ontext is passed
+0001e090: 2069 6e20 7468 6520 7772 6f6e 6720 6675   in the wrong fu
+0001e0a0: 6e63 7469 6f6e 2e20 0d0a 0d0a 2020 2020  nction. ....    
+0001e0b0: 3a72 6574 7572 6e73 3a20 0d0a 2020 2020  :returns: ..    
+0001e0c0: 2020 2020 2d20 795f 6d78 733a 2061 7272      - y_mxs: arr
+0001e0d0: 6179 2d6c 696b 6520 3164 202c 204d 5853  ay-like 1d , MXS
+0001e0e0: 206e 6577 206c 6162 656c 7320 6372 6561   new labels crea
+0001e0f0: 7465 6420 0d0a 2020 2020 2020 2020 2d20  ted ..        - 
+0001e100: 6772 6f75 705f 636c 6173 7365 735f 3a20  group_classes_: 
+0001e110: 6469 6374 2c20 7468 6520 6c61 6265 6c73  dict, the labels
+0001e120: 2069 6e20 4e47 4120 6c61 6265 6c73 2061   in NGA labels a
+0001e130: 6e64 2074 6865 6972 200d 0a20 2020 2020  nd their ..     
+0001e140: 2020 2020 2020 2070 6f73 7369 626c 6520         possible 
+0001e150: 7265 6e61 6d65 6420 7661 6c75 6573 2e20  renamed values. 
+0001e160: 4d6f 7374 206f 6620 7468 6520 6361 7365  Most of the case
+0001e170: 2c20 7468 6973 2068 6170 7065 6e73 2020  , this happens  
+0001e180: 0d0a 2020 2020 2020 2020 2020 2020 7768  ..            wh
+0001e190: 656e 2074 6865 2074 6865 2067 726f 7570  en the the group
+0001e1a0: 7320 7661 6c75 6573 2061 7265 2067 6976  s values are giv
+0001e1b0: 656e 2061 7320 696e 7465 7267 6572 2063  en as interger c
+0001e1c0: 6c61 7373 6573 2072 6174 6865 7220 0d0a  lasses rather ..
+0001e1d0: 2020 2020 2020 2020 2020 2020 7468 616e              than
+0001e1e0: 2073 7472 696e 672e 200d 0a20 2020 2020   string. ..     
+0001e1f0: 2020 202d 2067 726f 7570 5f6c 6162 656c     - group_label
+0001e200: 733a 2054 6865 2073 696d 696c 6172 206c  s: The similar l
+0001e210: 6162 656c 7320 666f 756e 6420 6174 2074  abels found at t
+0001e220: 6865 2073 616d 6520 7469 6d65 2069 6e20  he same time in 
+0001e230: 0d0a 2020 2020 2020 2020 2020 2020 2779  ..            'y
+0001e240: 5f74 7275 6527 2061 6e64 204e 4741 206c  _true' and NGA l
+0001e250: 6162 656c 732e 200d 0a20 2020 2020 2020  abels. ..       
+0001e260: 202d 2073 696d 5f67 726f 7570 733a 2067   - sim_groups: g
+0001e270: 726f 7570 7320 206f 6620 7061 6972 2063  roups  of pair c
+0001e280: 6f6d 706f 7365 6420 6f66 2074 6865 2073  omposed of the s
+0001e290: 696d 696c 6172 206c 6162 656c 2061 6e64  imilar label and
+0001e2a0: 200d 0a20 2020 2020 2020 2020 2020 2061   ..            a
+0001e2b0: 6e64 2074 6865 206c 6162 656c 2069 6e20  nd the label in 
+0001e2c0: 7468 6520 7072 6564 6963 7465 6420 4e47  the predicted NG
+0001e2d0: 412e 200d 0a20 2020 2020 2020 2020 2020  A. ..           
+0001e2e0: 200d 0a20 2020 203a 6578 616d 706c 653a   ..    :example:
+0001e2f0: 200d 0a20 2020 2020 2020 203e 3e3e 2069   ..        >>> i
+0001e300: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
+0001e310: 7020 0d0a 2020 2020 2020 2020 3e3e 3e20  p ..        >>> 
+0001e320: 6672 6f6d 2077 6174 6578 2e75 7469 6c73  from watex.utils
+0001e330: 2e68 7964 726f 7574 696c 7320 696d 706f  .hydroutils impo
+0001e340: 7274 205f 4d58 535f 6966 5f6e 6f0d 0a20  rt _MXS_if_no.. 
+0001e350: 2020 2020 2020 203e 3e3e 2079 5f74 7275         >>> y_tru
+0001e360: 6520 3d20 6e70 2e61 7261 6e67 6520 2835  e = np.arange (5
+0001e370: 2920 0d0a 2020 2020 2020 2020 3e3e 3e20  ) ..        >>> 
+0001e380: 795f 7072 6564 203d 206e 702e 6172 616e  y_pred = np.aran
+0001e390: 6765 2028 312c 2036 2920 0d0a 2020 2020  ge (1, 6) ..    
+0001e3a0: 2020 2020 3e3e 3e20 5f2c 2064 2c20 2a5f      >>> _, d, *_
+0001e3b0: 3d20 5f4d 5853 5f69 665f 6e6f 2028 276e  = _MXS_if_no ('n
+0001e3c0: 6f27 2c20 795f 7472 7565 203d 795f 7472  o', y_true =y_tr
+0001e3d0: 7565 202c 2079 5f70 7265 6420 3d79 5f70  ue , y_pred =y_p
+0001e3e0: 7265 6420 290d 0a20 2020 2020 2020 203e  red )..        >
+0001e3f0: 3e3e 2064 200d 0a20 2020 2020 2020 202e  >> d ..        .
+0001e400: 2e2e 207b 313a 2027 312a 272c 2032 3a20  .. {1: '1*', 2: 
+0001e410: 2732 2a27 2c20 333a 2027 332a 272c 2034  '2*', 3: '3*', 4
+0001e420: 3a20 2734 2a27 2c20 353a 2027 3527 7d0d  : '4*', 5: '5'}.
+0001e430: 0a20 2020 2020 2020 203e 3e3e 205f 2c20  .        >>> _, 
+0001e440: 642c 202a 5f3d 205f 4d58 535f 6966 5f6e  d, *_= _MXS_if_n
+0001e450: 6f20 2827 6e6f 272c 2079 5f74 7275 6520  o ('no', y_true 
+0001e460: 3d79 5f74 7275 6520 2c20 795f 7072 6564  =y_true , y_pred
+0001e470: 203d 795f 7072 6564 2c20 0d0a 2020 2020   =y_pred, ..    
+0001e480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e490: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+0001e4a0: 6169 6c65 7220 3d4e 6f6e 6529 0d0a 2020  ailer =None)..  
+0001e4b0: 2020 2020 2020 3e3e 3e20 640d 0a20 2020        >>> d..   
+0001e4c0: 2020 2020 202e 2e2e 207b 313a 2035 2c20       ... {1: 5, 
+0001e4d0: 323a 2036 2c20 333a 2037 2c20 343a 2038  2: 6, 3: 7, 4: 8
+0001e4e0: 2c20 353a 2039 7d20 2320 7265 6e61 6d65  , 5: 9} # rename
+0001e4f0: 206c 6162 656c 7320 0d0a 2020 2020 2020   labels ..      
+0001e500: 2020 0d0a 2020 2020 2222 220d 0a20 2020    ..    """..   
+0001e510: 2061 7373 6572 7420 7374 7228 636f 6e74   assert str(cont
+0001e520: 6578 7429 2e6c 6f77 6572 2829 2069 6e20  ext).lower() in 
+0001e530: 7b27 6e6f 272c 2027 6e6f 2073 696d 696c  {'no', 'no simil
+0001e540: 6172 6974 7927 2c20 0d0a 2020 2020 2020  arity', ..      
+0001e550: 2020 2773 696d 696c 6172 6974 7920 646f    'similarity do
+0001e560: 6573 206e 6f74 2065 7869 7374 272c 2027  es not exist', '
+0001e570: 4661 6c73 6527 2c27 7369 6d69 6c61 7269  False','similari
+0001e580: 7479 206e 6f74 2066 6f75 6e64 270d 0a20  ty not found'.. 
+0001e590: 2020 2020 2020 207d 2c20 636d 7367 2e66         }, cmsg.f
+0001e5a0: 6f72 6d61 7420 285f 4d58 535f 6966 5f79  ormat (_MXS_if_y
+0001e5b0: 6573 2e5f 5f6e 616d 655f 5f2c 2027 6174  es.__name__, 'at
+0001e5c0: 206c 6561 7374 204f 4e45 2729 0d0a 2020   least ONE')..  
+0001e5d0: 2020 0d0a 2020 2020 2320 7369 6d69 6c61    ..    # simila
+0001e5e0: 7269 7479 2067 726f 7570 7320 696e 2070  rity groups in p
+0001e5f0: 6169 7220 2874 7275 6520 6c61 6265 6c20  air (true label 
+0001e600: 2c20 7369 6d69 6c61 7220 6772 6f75 7020  , similar group 
+0001e610: 2920 2020 2020 0d0a 2020 2020 7369 6d5f  )     ..    sim_
+0001e620: 6772 6f75 7073 203d 4e6f 6e65 200d 0a20  groups =None .. 
+0001e630: 2020 2067 726f 7570 5f6c 6162 656c 7320     group_labels 
+0001e640: 3d4e 6f6e 6520 2320 4e47 4120 7369 6d69  =None # NGA simi
+0001e650: 6c61 7220 6772 6f75 7073 200d 0a20 2020  lar groups ..   
+0001e660: 2079 5f6d 7873 203d 2079 5f70 7265 642e   y_mxs = y_pred.
+0001e670: 636f 7079 2829 2e61 7374 7970 6520 2820  copy().astype ( 
+0001e680: 6f62 6a65 6374 2029 0d0a 0d0a 2020 2020  object )....    
+0001e690: 2320 6765 7420 7468 6520 6c61 6265 6c20  # get the label 
+0001e6a0: 6672 6f6d 2073 696d 696c 6172 6974 7920  from similarity 
+0001e6b0: 6772 6f75 7073 3a20 0d0a 2020 2020 7472  groups: ..    tr
+0001e6c0: 7565 5f6c 6162 656c 7320 3d20 6e70 2e75  ue_labels = np.u
+0001e6d0: 6e69 7175 6520 2879 5f74 7275 6520 2920  nique (y_true ) 
+0001e6e0: 0d0a 2020 2020 2320 2067 726f 7570 5f6c  ..    #  group_l
+0001e6f0: 6162 656c 7320 3d20 5b20 6772 6f75 7020  abels = [ group 
+0001e700: 2066 6f72 205f 2c20 6772 6f75 7020 696e   for _, group in
+0001e710: 2073 205d 0d0a 2020 2020 4e47 415f 6c61   s ]..    NGA_la
+0001e720: 6265 6c73 203d 206e 702e 756e 6971 7565  bels = np.unique
+0001e730: 2028 2079 5f70 7265 6420 2920 0d0a 2020   ( y_pred ) ..  
+0001e740: 2020 2320 5265 6e61 6d65 2074 6865 204e    # Rename the N
+0001e750: 4741 206c 6162 656c 7320 7573 696e 6720  GA labels using 
+0001e760: 7468 6520 7472 6169 6c65 7220 6f72 200d  the trailer or .
+0001e770: 0a20 2020 2023 2061 6464 2063 6f6e 7374  .    # add const
+0001e780: 616e 743b 200d 0a20 2020 2067 726f 7570  ant; ..    group
+0001e790: 5f63 6c61 7373 6573 5f20 3d20 6469 6374  _classes_ = dict
+0001e7a0: 2829 200d 0a20 2020 2069 6620 616e 7928  () ..    if any(
+0001e7b0: 5b20 6c20 696e 2074 7275 655f 6c61 6265  [ l in true_labe
+0001e7c0: 6c73 2066 6f72 206c 2069 6e20 4e47 415f  ls for l in NGA_
+0001e7d0: 6c61 6265 6c73 205d 293a 200d 0a20 2020  labels ]): ..   
+0001e7e0: 2020 2020 2070 7365 7564 6f5f 4e47 415f       pseudo_NGA_
+0001e7f0: 6c61 6265 6c73 203d 205f 6372 6561 7465  labels = _create
+0001e800: 5f6d 7873 5f70 7365 7564 6f5f 6c61 6265  _mxs_pseudo_labe
+0001e810: 6c73 2028 0d0a 2020 2020 2020 2020 2020  ls (..          
+0001e820: 2020 795f 7472 7565 3d79 5f74 7275 6520    y_true=y_true 
+0001e830: 2c20 795f 7072 6564 3d79 5f70 7265 6420  , y_pred=y_pred 
+0001e840: 2c20 6772 6f75 705f 6c61 6265 6c73 3d20  , group_labels= 
+0001e850: 4e6f 6e65 2c20 0d0a 2020 2020 2020 2020  None, ..        
+0001e860: 2020 2020 7472 6169 6c65 7220 3d74 7261      trailer =tra
+0001e870: 696c 6572 290d 0a20 2020 2020 2020 2066  iler)..        f
+0001e880: 6f72 206b 6c61 6265 6c20 696e 204e 4741  or klabel in NGA
+0001e890: 5f6c 6162 656c 7320 3a20 0d0a 2020 2020  _labels : ..    
+0001e8a0: 2020 2020 2020 2020 6e6b 6c61 6265 6c20          nklabel 
+0001e8b0: 3d20 7073 6575 646f 5f4e 4741 5f6c 6162  = pseudo_NGA_lab
+0001e8c0: 656c 732e 6765 7428 6b6c 6162 656c 2920  els.get(klabel) 
+0001e8d0: 0d0a 2020 2020 2020 2020 2020 2020 6b6c  ..            kl
+0001e8e0: 6162 656c 5f69 782c 2020 3d20 6e70 2e77  abel_ix,  = np.w
+0001e8f0: 6865 7265 2028 795f 7072 6564 203d 3d6b  here (y_pred ==k
+0001e900: 6c61 6265 6c29 0d0a 2020 2020 2020 2020  label)..        
+0001e910: 2020 2020 795f 6d78 7320 5b6b 6c61 6265      y_mxs [klabe
+0001e920: 6c5f 6978 205d 203d 206e 6b6c 6162 656c  l_ix ] = nklabel
+0001e930: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0001e940: 6b65 6570 2069 7420 696e 746f 2074 6865  keep it into the
+0001e950: 206d 6f64 6966 6965 6420 6772 6f75 7020   modified group 
+0001e960: 636c 6173 7365 7320 0d0a 2020 2020 2020  classes ..      
+0001e970: 2020 2020 2020 6772 6f75 705f 636c 6173        group_clas
+0001e980: 7365 735f 205b 6b6c 6162 656c 5d20 3d20  ses_ [klabel] = 
+0001e990: 6e6b 6c61 6265 6c20 0d0a 0d0a 2020 2020  nklabel ....    
+0001e9a0: 7265 7475 726e 2079 5f6d 7873 202c 2067  return y_mxs , g
+0001e9b0: 726f 7570 5f63 6c61 7373 6573 5f20 2c20  roup_classes_ , 
+0001e9c0: 6772 6f75 705f 6c61 6265 6c73 202c 2073  group_labels , s
+0001e9d0: 696d 5f67 726f 7570 7320 0d0a 0d0a 6465  im_groups ....de
+0001e9e0: 6620 5f63 7265 6174 655f 6d78 735f 7073  f _create_mxs_ps
+0001e9f0: 6575 646f 5f6c 6162 656c 7328 0d0a 2020  eudo_labels(..  
+0001ea00: 2020 2020 2020 795f 7472 7565 2c20 795f        y_true, y_
+0001ea10: 7072 6564 2c20 6772 6f75 705f 6c61 6265  pred, group_labe
+0001ea20: 6c73 203d 204e 6f6e 6520 2c20 7472 6169  ls = None , trai
+0001ea30: 6c65 7220 3d27 2a27 293a 200d 0a20 2020  ler ='*'): ..   
+0001ea40: 2022 2222 2063 7265 6174 6520 7073 6575   """ create pseu
+0001ea50: 646f 204d 5853 206c 6162 656c 7320 2061  do MXS labels  a
+0001ea60: 6e64 2073 6176 6520 6974 2069 6e20 7073  nd save it in ps
+0001ea70: 6575 646f 2d64 6963 742e 200d 0a20 2020  eudo-dict. ..   
+0001ea80: 200d 0a20 2020 2069 6620 6c61 6265 6c73   ..    if labels
+0001ea90: 206e 6f74 2069 6e20 7468 6520 6772 6f75   not in the grou
+0001eaa0: 7020 6973 2066 6f75 6e64 2069 6e20 7468  p is found in th
+0001eab0: 6520 636c 6173 7320 6c61 6265 6c73 206f  e class labels o
+0001eac0: 6620 7468 6520 2779 5f74 7275 6527 2c20  f the 'y_true', 
+0001ead0: 0d0a 2020 2020 7265 6e61 6d65 2069 7420  ..    rename it 
+0001eae0: 7573 696e 6720 7468 6520 4d58 5320 7472  using the MXS tr
+0001eaf0: 6169 6c65 7220 272a 2720 6173 2061 2073  ailer '*' as a s
+0001eb00: 7065 6369 616c 2063 6c61 7373 206c 6162  pecial class lab
+0001eb10: 656c 2e20 0d0a 2020 2020 6f74 6865 7277  el. ..    otherw
+0001eb20: 6973 6520 736b 6970 7065 642e 200d 0a20  ise skipped. .. 
+0001eb30: 2020 200d 0a20 2020 2049 6620 7468 6520     ..    If the 
+0001eb40: 6772 6f75 7020 6c61 6265 6c20 6973 206e  group label is n
+0001eb50: 6f74 2066 6f75 6e64 2069 6e20 7468 6520  ot found in the 
+0001eb60: 636c 6173 7320 6c61 6265 6c73 206f 6620  class labels of 
+0001eb70: 7468 6520 2779 5f74 7275 6527 2c20 6974  the 'y_true', it
+0001eb80: 200d 0a20 2020 2064 6f65 7320 6e6f 7420   ..    does not 
+0001eb90: 6e65 6564 2074 6f20 7265 6e61 6d65 2069  need to rename i
+0001eba0: 742e 204b 6565 7020 6974 2069 6e74 6163  t. Keep it intac
+0001ebb0: 7420 2c20 686f 7765 7665 7220 6265 6361  t , however beca
+0001ebc0: 7573 652c 2074 6865 2064 7479 7065 2068  use, the dtype h
+0001ebd0: 6173 200d 0a20 2020 2063 6861 6e67 6520  as ..    change 
+0001ebe0: 746f 2073 7472 696e 672c 2074 6865 2063  to string, the c
+0001ebf0: 6c61 7373 206c 6162 656c 2073 686f 756c  lass label shoul
+0001ec00: 6420 6e6f 206c 6f6e 6765 7220 6265 2061  d no longer be a
+0001ec10: 6e20 696e 7465 6765 722e 200d 0a20 2020  n integer. ..   
+0001ec20: 200d 0a20 2020 203a 7061 7261 6d20 795f   ..    :param y_
+0001ec30: 7472 7565 3a20 6172 7261 792d 6c69 6b65  true: array-like
+0001ec40: 2031 6420 2c20 0d0a 2020 2020 2020 2020   1d , ..        
+0001ec50: 6172 7261 7920 6f66 2074 6865 2063 6c61  array of the cla
+0001ec60: 7373 206c 6162 656c 2069 6e20 2779 5f74  ss label in 'y_t
+0001ec70: 7275 6527 2020 0d0a 2020 2020 3a70 6172  rue'  ..    :par
+0001ec80: 616d 2079 5f70 7265 643a 2061 7272 6179  am y_pred: array
+0001ec90: 2d6c 696b 6520 3164 2c20 0d0a 2020 2020  -like 1d, ..    
+0001eca0: 2020 2020 6172 7261 7920 6f66 2074 6865      array of the
+0001ecb0: 2070 7265 6469 6374 6564 2063 6c61 7373   predicted class
+0001ecc0: 2028 4d69 7874 7572 6520 6172 7261 7929   (Mixture array)
+0001ecd0: 2074 6861 7420 636f 6e74 6169 6e73 200d   that contains .
+0001ece0: 0a20 2020 2020 2020 2074 6865 204e 4741  .        the NGA
+0001ecf0: 206c 6162 656c 732e 200d 0a20 2020 203a   labels. ..    :
+0001ed00: 7061 7261 6d20 6772 6f75 705f 6c61 6265  param group_labe
+0001ed10: 6c73 3a20 6c69 7374 2c20 0d0a 2020 2020  ls: list, ..    
+0001ed20: 2020 2020 6c69 7374 206f 6620 7468 6520      list of the 
+0001ed30: 6c61 6265 6c20 6672 6f6d 2027 795f 7072  label from 'y_pr
+0001ed40: 6564 2720 7468 6174 2073 696d 696c 6172  ed' that similar
+0001ed50: 6974 7920 6861 7320 6265 656e 2066 6f75  ity has been fou
+0001ed60: 6e64 2069 6e20 0d0a 2020 2020 2020 2020  nd in ..        
+0001ed70: 7468 6520 2779 5f74 7275 6527 2e20 466f  the 'y_true'. Fo
+0001ed80: 7220 7468 6973 2072 6561 736f 6e2c 2073  r this reason, s
+0001ed90: 696e 6365 2069 7473 2073 696d 696c 6172  ince its similar
+0001eda0: 6974 6965 7320 6861 7665 2061 2073 7065  ities have a spe
+0001edb0: 6369 616c 200d 0a20 2020 2020 2020 2063  cial ..        c
+0001edc0: 6c61 7373 206c 6162 656c 206e 6f6d 656e  lass label nomen
+0001edd0: 636c 6174 7572 6573 2c20 6974 2077 696c  clatures, it wil
+0001ede0: 6c20 6265 2064 6973 6372 6164 6564 2066  l be discraded f
+0001edf0: 726f 6d20 7468 6520 2779 5f70 7265 6427  rom the 'y_pred'
+0001ee00: 2069 2e65 200d 0a20 2020 2020 2020 2074   i.e ..        t
+0001ee10: 6865 2070 7265 6469 6374 6564 204e 4741  he predicted NGA
+0001ee20: 206c 6162 656c 732e 2054 6875 7320 6f6e   labels. Thus on
+0001ee30: 6c79 2074 6865 204e 4741 206c 6162 656c  ly the NGA label
+0001ee40: 7320 6578 6365 7074 2074 6865 2020 0d0a  s except the  ..
+0001ee50: 2020 2020 2020 2020 6067 726f 7570 5f6c          `group_l
+0001ee60: 6162 656c 7360 2061 7265 2075 7365 6420  abels` are used 
+0001ee70: 666f 7220 7265 6e61 6d69 6e67 2e0d 0a20  for renaming... 
+0001ee80: 2020 203a 7061 7261 6d20 7472 6169 6c65     :param traile
+0001ee90: 723a 2073 7472 2c20 6465 6661 756c 743d  r: str, default=
+0001eea0: 272a 270d 0a20 2020 2020 2020 2054 6865  '*'..        The
+0001eeb0: 204d 6978 7475 7265 2073 7472 6174 6567   Mixture strateg
+0001eec0: 7920 6d61 726b 6572 2074 6f20 6469 6666  y marker to diff
+0001eed0: 6572 656e 7469 6174 6520 7468 6520 6578  erentiate the ex
+0001eee0: 6973 7469 6e67 2063 6c61 7373 206c 6162  isting class lab
+0001eef0: 656c 2020 0d0a 2020 2020 2020 2020 696e  el  ..        in
+0001ef00: 2027 795f 7472 7565 2720 7769 7468 2074   'y_true' with t
+0001ef10: 6865 2070 7265 6469 6374 6564 206c 6162  he predicted lab
+0001ef20: 656c 7320 2779 5f70 7265 6427 2065 7370  els 'y_pred' esp
+0001ef30: 6563 6961 6c6c 7920 7768 656e 2020 0d0a  ecially when  ..
+0001ef40: 2020 2020 2020 2020 7468 6520 7468 6520          the the 
+0001ef50: 7361 6d65 2063 6c61 7373 206c 6162 656c  same class label
+0001ef60: 7320 6172 6520 616c 736f 2070 7265 7365  s are also prese
+0001ef70: 6e74 2074 6865 2074 7275 6520 6c61 6265  nt the true labe
+0001ef80: 6c20 7769 7468 2074 6865 200d 0a20 2020  l with the ..   
+0001ef90: 2020 2020 2073 616d 6520 6c61 6265 6c2d       same label-
+0001efa0: 6964 656e 7469 6669 6572 206e 616d 652e  identifier name.
+0001efb0: 2054 6869 7320 7573 6566 756c 6c20 2074   This usefull  t
+0001efc0: 6f20 6176 6f69 6420 616e 7920 636f 6e66  o avoid any conf
+0001efd0: 7573 696f 6e20 2066 6f72 0d0a 2020 2020  usion  for..    
+0001efe0: 2020 2020 626f 7468 206c 6162 656c 7320      both labels 
+0001eff0: 2069 6e20 6079 5f74 7275 6560 2061 6e64   in `y_true` and
+0001f000: 2060 795f 7072 6564 6020 666f 7220 6265   `y_pred` for be
+0001f010: 7474 6572 2064 656d 6172 6361 7469 6f6e  tter demarcation
+0001f020: 2061 6e64 200d 0a20 2020 2020 2020 2064   and ..        d
+0001f030: 6973 7469 6e63 7469 6f6e 2e20 4e6f 7465  istinction. Note
+0001f040: 2074 6861 7420 6966 2074 6865 2060 7472   that if the `tr
+0001f050: 6169 6c65 7260 6973 2073 6574 2074 6f20  ailer`is set to 
+0001f060: 6060 4e6f 6e65 6060 2061 6e64 2062 6f74  ``None`` and bot
+0001f070: 6820 0d0a 2020 2020 2020 2020 6079 5f74  h ..        `y_t
+0001f080: 7275 6560 2061 6e64 2060 795f 7072 6564  rue` and `y_pred
+0001f090: 6020 6172 6520 6e75 6d65 7269 6320 6461  ` are numeric da
+0001f0a0: 7461 2c20 7468 6520 6c61 6265 6c73 2069  ta, the labels i
+0001f0b0: 6e20 6079 5f70 7265 6460 2061 7265 200d  n `y_pred` are .
+0001f0c0: 0a20 2020 2020 2020 2073 7973 7465 6d61  .        systema
+0001f0d0: 7469 6361 6c6c 7920 7265 6e61 6d65 6420  tically renamed 
+0001f0e0: 746f 2062 6520 6469 7374 696e 6374 2077  to be distinct w
+0001f0f0: 6974 6820 7468 6520 6f6e 6573 2069 6e20  ith the ones in 
+0001f100: 7468 6520 2779 5f74 7275 6527 2e20 0d0a  the 'y_true'. ..
+0001f110: 2020 2020 2020 2020 0d0a 2020 2020 3a72          ..    :r
+0001f120: 6574 7572 6e73 3a20 0d0a 2020 2020 2020  eturns: ..      
+0001f130: 2020 7073 6575 646f 5f64 6963 743a 2064    pseudo_dict: d
+0001f140: 6963 742c 200d 0a20 2020 2020 2020 2020  ict, ..         
+0001f150: 2020 2064 6963 7469 6f6e 6e61 7279 2063     dictionnary c
+0001f160: 6f6d 706f 7365 6420 6f66 2074 6865 204e  omposed of the N
+0001f170: 4741 206c 6162 656c 7320 7468 6174 2061  GA labels that a
+0001f180: 7265 206e 6f74 2069 6e20 6067 726f 7570  re not in `group
+0001f190: 5f6c 6162 656c 7360 0d0a 2020 2020 2020  _labels`..      
+0001f1a0: 2020 2020 2020 616e 6420 7768 6f73 6520        and whose 
+0001f1b0: 7468 6569 7220 6c61 6265 6c73 2068 6176  their labels hav
+0001f1c0: 6520 6265 656e 2072 656e 616d 6564 2e20  e been renamed. 
+0001f1d0: 0d0a 2020 2020 3a65 7861 6d70 6c65 3a20  ..    :example: 
+0001f1e0: 0d0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+0001f1f0: 6f6d 2077 6174 6578 2e75 7469 6c73 2e68  om watex.utils.h
+0001f200: 7964 726f 7574 696c 7320 696d 706f 7274  ydroutils import
+0001f210: 205f 6372 6561 7465 5f6d 7873 5f70 7365   _create_mxs_pse
+0001f220: 7564 6f5f 6c61 6265 6c73 200d 0a20 2020  udo_labels ..   
+0001f230: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
+0001f240: 6e75 6d70 7920 6173 206e 7020 0d0a 2020  numpy as np ..  
+0001f250: 2020 2020 2020 3e3e 3e20 795f 7472 7565        >>> y_true
+0001f260: 203d 206e 702e 6172 616e 6765 2028 3529   = np.arange (5)
+0001f270: 200d 0a20 2020 2020 2020 203e 3e3e 2079   ..        >>> y
+0001f280: 5f70 7265 6420 3d20 6e70 2e61 7261 6e67  _pred = np.arang
+0001f290: 6520 2831 2c20 3629 200d 0a20 2020 2020  e (1, 6) ..     
+0001f2a0: 2020 203e 3e3e 2067 726f 7570 5f6c 6162     >>> group_lab
+0001f2b0: 656c 7320 3d5b 322c 2033 5d20 2320 6f6e  els =[2, 3] # on
+0001f2c0: 6c79 2032 2061 6e64 2033 2074 6861 7420  ly 2 and 3 that 
+0001f2d0: 6861 7665 2073 696d 696c 6172 6974 7920  have similarity 
+0001f2e0: 0d0a 2020 2020 2020 2020 3e3e 3e20 5f63  ..        >>> _c
+0001f2f0: 7265 6174 655f 6d78 735f 7073 6575 646f  reate_mxs_pseudo
+0001f300: 5f6c 6162 656c 7320 2879 5f74 7275 652c  _labels (y_true,
+0001f310: 2079 5f70 7265 642c 2067 726f 7570 5f6c   y_pred, group_l
+0001f320: 6162 656c 7320 290d 0a20 2020 2020 2020  abels )..       
+0001f330: 202e 2e2e 207b 313a 2027 312a 272c 2034   ... {1: '1*', 4
+0001f340: 3a20 2734 2a27 2c20 353a 2027 352a 277d  : '4*', 5: '5*'}
+0001f350: 0d0a 2020 2020 2020 2020 3e3e 3e20 2320  ..        >>> # 
+0001f360: 6372 6561 7465 2061 2070 7365 7564 6f20  create a pseudo 
+0001f370: 4d58 5320 6c61 6265 6c73 2077 6865 6e20  MXS labels when 
+0001f380: 2067 726f 7570 2069 7320 4e6f 6e65 0d0a   group is None..
+0001f390: 2020 2020 2020 2020 3e3e 3e20 5f63 7265          >>> _cre
+0001f3a0: 6174 655f 6d78 735f 7073 6575 646f 5f6c  ate_mxs_pseudo_l
+0001f3b0: 6162 656c 7320 2879 5f74 7275 652c 2079  abels (y_true, y
+0001f3c0: 5f70 7265 642c 204e 6f6e 6520 290d 0a20  _pred, None ).. 
+0001f3d0: 2020 2020 2020 202e 2e2e 207b 2731 273a         ... {'1':
+0001f3e0: 2027 312a 272c 2027 3227 3a20 2732 2a27   '1*', '2': '2*'
+0001f3f0: 2c20 2733 273a 2027 332a 272c 2027 3427  , '3': '3*', '4'
+0001f400: 3a20 2734 2a27 2c20 2735 273a 2027 3527  : '4*', '5': '5'
+0001f410: 7d0d 0a20 2020 2020 2020 203e 3e3e 2023  }..        >>> #
+0001f420: 202a 636f 6d6d 656e 7473 200d 0a20 2020   *comments ..   
+0001f430: 2020 2020 2020 2020 2023 2074 6865 2061           # the a
+0001f440: 626f 7665 2072 6573 756c 7473 2064 656d  bove results dem
+0001f450: 6172 6361 7465 6420 7468 6520 6c61 6265  arcated the labe
+0001f460: 6c20 696e 2079 5f70 7265 6420 7468 6174  l in y_pred that
+0001f470: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
+0001f480: 2065 7869 7374 2069 6e20 795f 7472 7565   exist in y_true
+0001f490: 2075 7369 6e67 2074 6865 2064 6566 6175   using the defau
+0001f4a0: 6c74 2074 7261 696c 6572 2027 2a27 0d0a  lt trailer '*'..
+0001f4b0: 2020 2020 2020 2020 3e3e 3e20 2320 2062          >>> #  b
+0001f4c0: 6563 6175 7365 2074 6865 2062 6974 6820  ecause the bith 
+0001f4d0: 795f 7472 7565 2061 6e64 2079 5f70 7265  y_true and y_pre
+0001f4e0: 6420 6172 6520 6e75 6d65 7269 6320 2c20  d are numeric , 
+0001f4f0: 6c65 7420 7365 7420 0d0a 2020 2020 2020  let set ..      
+0001f500: 2020 3e3e 3e20 2320 7468 6520 7472 6169    >>> # the trai
+0001f510: 6c65 7220 746f 204e 6f6e 6520 0d0a 2020  ler to None ..  
+0001f520: 2020 2020 2020 3e3e 3e20 5f63 7265 6174        >>> _creat
+0001f530: 655f 6d78 735f 7073 6575 646f 5f6c 6162  e_mxs_pseudo_lab
+0001f540: 656c 7320 2879 5f74 7275 652c 2079 5f70  els (y_true, y_p
+0001f550: 7265 642c 204e 6f6e 6520 2c20 7472 6169  red, None , trai
+0001f560: 6c65 7220 3d20 4e6f 6e65 290d 0a20 2020  ler = None)..   
+0001f570: 2020 2020 202e 2e2e 207b 313a 2035 2c20       ... {1: 5, 
+0001f580: 323a 2036 2c20 333a 2037 2c20 343a 2038  2: 6, 3: 7, 4: 8
+0001f590: 2c20 353a 2039 7d0d 0a20 2020 2020 2020  , 5: 9}..       
+0001f5a0: 203e 3e3e 2023 202a 2063 6f6d 6d65 6e74   >>> # * comment
+0001f5b0: 733a 200d 0a20 2020 2020 2020 2020 2020  s: ..           
+0001f5c0: 2023 2047 6976 6573 2074 6865 2064 6966   # Gives the dif
+0001f5d0: 6665 7265 6e74 7320 6d61 7020 6368 616e  ferents map chan
+0001f5e0: 6765 7320 2e20 5468 7573 206c 6162 656c  ges . Thus label
+0001f5f0: 2031 2069 6e20 795f 7072 6564 200d 0a20   1 in y_pred .. 
+0001f600: 2020 2020 2020 2020 2020 2023 2062 6563             # bec
+0001f610: 6f6d 6520 6c61 6265 6c20 352c 206c 6162  ome label 5, lab
+0001f620: 656c 2032 2062 6563 6f6d 6520 6c61 6265  el 2 become labe
+0001f630: 6c20 3620 616e 6420 736f 206f 6e2e 200d  l 6 and so on. .
+0001f640: 0a20 2020 2020 2020 2020 2020 2023 2074  .            # t
+0001f650: 6869 7320 6973 2070 6572 666f 726d 6564  his is performed
+0001f660: 2074 6f20 6176 6f69 6420 636f 6e66 7573   to avoid confus
+0001f670: 696e 6720 7468 6520 6c61 6265 6c20 696e  ing the label in
+0001f680: 2079 5f74 7275 6520 0d0a 2020 2020 2020   y_true ..      
+0001f690: 2020 2020 2020 2320 7768 6572 6520 312c        # where 1,
+0001f6a0: 2032 2c20 332c 2034 2061 7265 2061 6c73   2, 3, 4 are als
+0001f6b0: 6f20 7072 6573 656e 7473 2e20 0d0a 2020  o presents. ..  
+0001f6c0: 2020 2020 2020 3e3e 3e20 2320 6c65 7420        >>> # let 
+0001f6d0: 6372 6561 7465 2061 206d 6170 2077 6865  create a map whe
+0001f6e0: 7265 2079 5f74 7275 6520 616e 6420 795f  re y_true and y_
+0001f6f0: 7072 6564 2061 7265 2064 6966 6665 7265  pred are differe
+0001f700: 6e74 2061 6e64 200d 0a20 2020 2020 2020  nt and ..       
+0001f710: 203e 3e3e 2023 206e 6f74 206e 756d 6572   >>> # not numer
+0001f720: 6963 2076 616c 7565 7320 0d0a 2020 2020  ic values ..    
+0001f730: 2020 2020 3e3e 3e20 795f 7472 7565 5f6e      >>> y_true_n
+0001f740: 6f20 3d20 6e70 2e61 7272 6179 2028 5b27  o = np.array (['
+0001f750: 6b31 272c 2027 6b32 272c 2027 6b33 275d  k1', 'k2', 'k3']
+0001f760: 2920 0d0a 2020 2020 2020 2020 3e3e 3e20  ) ..        >>> 
+0001f770: 795f 7072 6564 5f6e 6f20 3d20 6e70 2e61  y_pred_no = np.a
+0001f780: 7272 6179 285b 2763 3127 2c20 2763 3227  rray(['c1', 'c2'
+0001f790: 2c20 2763 3327 5d29 0d0a 2020 2020 2020  , 'c3'])..      
+0001f7a0: 2020 3e3e 3e20 5f63 7265 6174 655f 6d78    >>> _create_mx
+0001f7b0: 735f 7073 6575 646f 5f6c 6162 656c 7320  s_pseudo_labels 
+0001f7c0: 2879 5f74 7275 655f 6e6f 2c20 795f 7072  (y_true_no, y_pr
+0001f7d0: 6564 5f6e 6f2c 204e 6f6e 6520 290d 0a20  ed_no, None ).. 
+0001f7e0: 2020 2020 2020 200d 0a20 2020 2022 2222         ..    """
+0001f7f0: 200d 0a20 2020 2067 726f 7570 5f6c 6162   ..    group_lab
+0001f800: 656c 7320 3d20 6772 6f75 705f 6c61 6265  els = group_labe
+0001f810: 6c73 206f 7220 205b 5d0d 0a20 2020 2069  ls or  []..    i
+0001f820: 6620 6e6f 7420 6861 7361 7474 7220 2867  f not hasattr (g
+0001f830: 726f 7570 5f6c 6162 656c 732c 2027 5f5f  roup_labels, '__
+0001f840: 6c65 6e5f 5f27 293a 200d 0a20 2020 2020  len__'): ..     
+0001f850: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0001f860: 726f 7220 2822 4772 6f75 7020 6c61 6265  ror ("Group labe
+0001f870: 6c20 6361 6e27 7420 6265 204e 6f6e 6520  l can't be None 
+0001f880: 616e 6420 6d75 7374 2062 6520 616e 2069  and must be an i
+0001f890: 7465 7261 626c 6522 0d0a 2020 2020 2020  terable"..      
+0001f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f8b0: 2020 2020 2066 2220 6f62 6a65 6374 2e20       f" object. 
+0001f8c0: 476f 743a 207b 7479 7065 2867 726f 7570  Got: {type(group
+0001f8d0: 5f6c 6162 656c 7329 2e5f 5f6e 616d 655f  _labels).__name_
+0001f8e0: 5f21 727d 220d 0a20 2020 2020 2020 2020  _!r}"..         
+0001f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f900: 2020 290d 0a20 2020 2069 6620 6e6f 7420    )..    if not 
+0001f910: 285f 6973 5f61 7272 6179 6c69 6b65 5f31  (_is_arraylike_1
+0001f920: 6428 795f 7072 6564 2029 2061 6e64 205f  d(y_pred ) and _
+0001f930: 6973 5f61 7272 6179 6c69 6b65 5f31 6428  is_arraylike_1d(
+0001f940: 795f 7472 7565 2929 3a20 0d0a 2020 2020  y_true)): ..    
+0001f950: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+0001f960: 726f 7220 2822 2779 2720 6578 7065 6374  ror ("'y' expect
+0001f970: 7320 746f 2062 6520 616e 2061 7272 6179  s to be an array
+0001f980: 2d6c 696b 6520 3164 2022 2920 0d0a 2020  -like 1d ") ..  
+0001f990: 2020 2020 2020 0d0a 2020 2020 5f63 6865        ..    _che
+0001f9a0: 636b 5f63 6f6e 7369 7374 656e 6379 5f73  ck_consistency_s
+0001f9b0: 697a 6528 795f 7472 7565 2c20 795f 7072  ize(y_true, y_pr
+0001f9c0: 6564 2920 0d0a 2020 2020 0d0a 2020 2020  ed) ..    ..    
+0001f9d0: 7472 7565 5f6c 6162 656c 735f 6f72 6967  true_labels_orig
+0001f9e0: 203d 206e 702e 756e 6971 7565 2028 795f   = np.unique (y_
+0001f9f0: 7472 7565 2920 0d0a 2020 2020 4e47 415f  true) ..    NGA_
+0001fa00: 6c61 6265 6c73 203d 206e 702e 756e 6971  labels = np.uniq
+0001fa10: 7565 2028 795f 7072 6564 290d 0a20 2020  ue (y_pred)..   
+0001fa20: 2070 7365 7564 6f5f 6469 6374 203d 207b   pseudo_dict = {
+0001fa30: 7d20 0d0a 2020 2020 2320 636f 6d70 7574  } ..    # comput
+0001fa40: 6520 7468 6520 6c61 6265 6c73 206e 6f74  e the labels not
+0001fa50: 200d 0a20 2020 2023 2069 6e20 7468 6520   ..    # in the 
+0001fa60: 6772 6f75 7020 0d0a 2020 2020 6c61 6265  group ..    labe
+0001fa70: 6c73 5f6e 6f74 5f69 6e5f 676f 7570 7320  ls_not_in_goups 
+0001fa80: 3d20 6973 5f69 6e5f 6966 284e 4741 5f6c  = is_in_if(NGA_l
+0001fa90: 6162 656c 732c 2067 726f 7570 5f6c 6162  abels, group_lab
+0001faa0: 656c 7320 2c20 0d0a 2020 2020 2020 2020  els , ..        
+0001fab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fac0: 2020 2072 6574 7572 6e5f 6469 6666 3d20     return_diff= 
+0001fad0: 5472 7565 290d 0a20 2020 2069 6620 6c61  True)..    if la
+0001fae0: 6265 6c73 5f6e 6f74 5f69 6e5f 676f 7570  bels_not_in_goup
+0001faf0: 7320 6973 204e 6f6e 653a 0d0a 2020 2020  s is None:..    
+0001fb00: 2020 2020 7265 7475 726e 2020 7073 6575      return  pseu
+0001fb10: 646f 5f64 6963 7420 0d0a 2020 2020 0d0a  do_dict ..    ..
+0001fb20: 2020 2020 7073 6575 646f 5f6c 6162 656c      pseudo_label
+0001fb30: 7320 3d20 6e70 2e61 7272 6179 286c 6162  s = np.array(lab
+0001fb40: 656c 735f 6e6f 745f 696e 5f67 6f75 7073  els_not_in_goups
+0001fb50: 2920 0d0a 2020 2020 0d0a 2020 2020 2320  ) ..    ..    # 
+0001fb60: 6368 6563 6b20 7768 6574 6865 7220 626f  check whether bo
+0001fb70: 7468 2064 6174 6120 6172 6520 6769 7665  th data are give
+0001fb80: 6e20 6173 206e 756d 6572 6963 2064 6174  n as numeric dat
+0001fb90: 610d 0a20 2020 2023 2073 6f20 7468 6520  a..    # so the 
+0001fba0: 6e75 6d65 7269 6320 6c61 6265 6c20 6361  numeric label ca
+0001fbb0: 6e20 6265 2072 656e 616d 6520 6279 2074  n be rename by t
+0001fbc0: 6f70 7069 6e67 2074 6865 206d 6178 2076  opping the max v
+0001fbd0: 616c 7565 200d 0a20 2020 2023 2067 6f74  alue ..    # got
+0001fbe0: 2066 726f 6d20 7468 6520 7472 7565 5f6c   from the true_l
+0001fbf0: 6162 656c 7320 746f 2074 6865 2070 7265  abels to the pre
+0001fc00: 6469 6374 6564 206c 6162 656c 200d 0a20  dicted label .. 
+0001fc10: 2020 2023 2070 726f 7669 6465 6420 7468     # provided th
+0001fc20: 6174 2074 7261 696c 6572 2069 7320 4e6f  at trailer is No
+0001fc30: 6e65 2e0d 0a20 2020 2069 735f 6e75 6d65  ne...    is_nume
+0001fc40: 7269 6320 3d20 4661 6c73 6520 0d0a 2020  ric = False ..  
+0001fc50: 2020 6966 2028 5f69 735f 6e75 6d65 7269    if (_is_numeri
+0001fc60: 635f 6474 7970 6528 7472 7565 5f6c 6162  c_dtype(true_lab
+0001fc70: 656c 735f 6f72 6967 2920 0d0a 2020 2020  els_orig) ..    
+0001fc80: 2020 2020 616e 6420 5f69 735f 6e75 6d65      and _is_nume
+0001fc90: 7269 635f 6474 7970 6528 6c61 6265 6c73  ric_dtype(labels
+0001fca0: 5f6e 6f74 5f69 6e5f 676f 7570 732c 2074  _not_in_goups, t
+0001fcb0: 6f5f 6172 7261 793d 5472 7565 290d 0a20  o_array=True).. 
+0001fcc0: 2020 2020 2020 2029 3a20 6973 5f6e 756d         ): is_num
+0001fcd0: 6572 6963 203d 2054 7275 6520 0d0a 2020  eric = True ..  
+0001fce0: 2020 0d0a 2020 2020 2320 6d61 6e61 6765    ..    # manage
+0001fcf0: 2074 7261 696c 6572 200d 0a20 2020 2074   trailer ..    t
+0001fd00: 7261 696c 6572 203d 204e 6f6e 6520 6966  railer = None if
+0001fd10: 2074 7261 696c 6572 2069 6e20 2827 272c   trailer in ('',
+0001fd20: 204e 6f6e 6529 2065 6c73 6520 7374 7228   None) else str(
+0001fd30: 7472 6169 6c65 7229 200d 0a20 2020 2069  trailer) ..    i
+0001fd40: 6620 7472 6169 6c65 7220 6973 204e 6f6e  f trailer is Non
+0001fd50: 653a 0d0a 2020 2020 2020 2020 2320 2d3e  e:..        # ->
+0001fd60: 2069 6d70 726f 7665 2074 6865 2077 6172   improve the war
+0001fd70: 6e69 6e67 206d 6573 7361 6765 200d 0a20  ning message .. 
+0001fd80: 2020 2020 2020 206e 6c61 6273 3d20 6973         nlabs= is
+0001fd90: 5f69 6e5f 6966 284e 4741 5f6c 6162 656c  _in_if(NGA_label
+0001fda0: 732c 2074 7275 655f 6c61 6265 6c73 5f6f  s, true_labels_o
+0001fdb0: 7269 672c 200d 0a20 2020 2020 2020 2020  rig, ..         
+0001fdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fdd0: 2020 2020 2020 7265 7475 726e 5f69 6e74        return_int
+0001fde0: 6572 7365 6374 3d54 7275 6529 0d0a 2020  ersect=True)..  
+0001fdf0: 2020 2020 2020 7761 726e 5f6d 7367 203d        warn_msg =
+0001fe00: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+0001fe10: 224e 6f74 6520 7468 6174 207b 307d 206c  "Note that {0} l
+0001fe20: 6162 656c 7b31 7d20 696e 2027 795f 7072  abel{1} in 'y_pr
+0001fe30: 6564 2720 7b32 7d20 616c 736f 2061 7661  ed' {2} also ava
+0001fe40: 696c 6162 6520 696e 2022 0d0a 2020 2020  ilabe in "..    
+0001fe50: 2020 2020 2020 2020 2227 795f 7472 7565          "'y_true
+0001fe60: 2720 7769 7468 2074 6865 2073 616d 6520  ' with the same 
+0001fe70: 6c61 6265 6c2d 6964 656e 7469 6669 6572  label-identifier
+0001fe80: 2061 6e64 2061 7265 206e 6f74 2072 656e   and are not ren
+0001fe90: 616d 6564 2e22 0d0a 2020 2020 2020 2020  amed."..        
+0001fea0: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
+0001feb0: 0d0a 2020 2020 2020 2020 7761 726e 5f6d  ..        warn_m
+0001fec0: 7367 203d 2077 6172 6e5f 6d73 672e 666f  sg = warn_msg.fo
+0001fed0: 726d 6174 2028 0d0a 2020 2020 2020 2020  rmat (..        
+0001fee0: 2020 2020 6c65 6e28 6e6c 6162 7329 2c20      len(nlabs), 
+0001fef0: 2273 2220 6966 206c 656e 286e 6c61 6273  "s" if len(nlabs
+0001ff00: 2920 3e20 3120 656c 7365 2027 272c 2022  ) > 1 else '', "
+0001ff10: 6172 6522 2069 6620 6c65 6e28 0d0a 2020  are" if len(..  
+0001ff20: 2020 2020 2020 2020 2020 2020 2020 6e6c                nl
+0001ff30: 6162 7329 3e31 2065 6c73 6520 2769 7327  abs)>1 else 'is'
+0001ff40: 2920 6966 206e 6c61 6273 2069 7320 6e6f  ) if nlabs is no
+0001ff50: 7420 4e6f 6e65 2065 6c73 6520 2222 0d0a  t None else ""..
+0001ff60: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0001ff70: 2020 6966 206c 656e 2867 726f 7570 5f6c    if len(group_l
+0001ff80: 6162 656c 7329 203d 3d30 3a20 0d0a 2020  abels) ==0: ..  
+0001ff90: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0001ffa0: 2069 735f 6e75 6d65 7269 633a 200d 0a20   is_numeric: .. 
+0001ffb0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0001ffc0: 7367 203d 2028 2254 7261 696c 6572 2069  sg = ("Trailer i
+0001ffd0: 7320 656d 7074 7920 7768 696c 6520 6f6e  s empty while on
+0001ffe0: 6520 6f72 2062 6f74 6820 795f 7472 7565  e or both y_true
+0001fff0: 2061 6e64 2074 6865 220d 0a20 2020 2020   and the"..     
+00020000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020010: 2020 2022 2070 7265 6469 6374 6564 2027     " predicted '
+00020020: 795f 7072 6564 2720 6172 7261 7973 2061  y_pred' arrays a
+00020030: 7265 206e 6f74 2061 206e 756d 6572 6963  re not a numeric
+00020040: 2064 6174 612e 220d 0a20 2020 2020 2020   data."..       
+00020050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020060: 2022 207b 7d20 5468 6973 206d 6967 6874   " {} This might
+00020070: 206c 6561 6420 746f 2075 6e65 7870 6563   lead to unexpec
+00020080: 7465 6420 7265 7375 6c74 7320 6279 2063  ted results by c
+00020090: 6f6e 6675 7369 6e67 220d 0a20 2020 2020  onfusing"..     
+000200a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000200b0: 2020 2022 2074 6865 2070 7265 6469 6374     " the predict
+000200c0: 6564 206c 6162 656c 7320 696e 2027 795f  ed labels in 'y_
+000200d0: 7072 6564 2720 7769 7468 2074 6865 2074  pred' with the t
+000200e0: 7275 6522 0d0a 2020 2020 2020 2020 2020  rue"..          
+000200f0: 2020 2020 2020 2020 2020 2020 2020 2220                " 
+00020100: 6c61 6265 6c73 2069 6e20 2779 5f70 7265  labels in 'y_pre
+00020110: 6427 2e20 5573 6520 6174 2079 6f75 7220  d'. Use at your 
+00020120: 6f77 6e20 7269 736b 2e22 0d0a 2020 2020  own risk."..    
+00020130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020140: 2020 2020 290d 0a0d 0a20 2020 2020 2020      )....       
+00020150: 2020 2020 2020 2020 2069 6620 6e6c 6162           if nlab
+00020160: 733a 2077 6172 6e69 6e67 732e 7761 726e  s: warnings.warn
+00020170: 286d 7367 2e66 6f72 6d61 7428 7761 726e  (msg.format(warn
+00020180: 5f6d 7367 2929 0d0a 2020 2020 2020 2020  _msg))..        
+00020190: 2020 2020 2020 2020 7472 6169 6c65 7220          trailer 
+000201a0: 3d27 270d 0a20 2020 2020 2020 2020 2020  =''..           
+000201b0: 2069 6620 6973 5f6e 756d 6572 6963 2061   if is_numeric a
+000201c0: 6e64 2074 7261 696c 6572 2069 7320 4e6f  nd trailer is No
+000201d0: 6e65 3a20 0d0a 2020 2020 2020 2020 2020  ne: ..          
+000201e0: 2020 2020 2020 7073 6575 646f 5f6c 6162        pseudo_lab
+000201f0: 656c 7320 3d20 5f6d 6978 7475 7265 5f6e  els = _mixture_n
+00020200: 756d 5f6c 6162 656c 5f69 665f 305f 696e  um_label_if_0_in
+00020210: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+00020220: 2020 2020 2020 2020 7472 7565 5f6c 6162          true_lab
+00020230: 656c 735f 6f72 6967 2c20 6c61 6265 6c73  els_orig, labels
+00020240: 5f6e 6f74 5f69 6e5f 676f 7570 7320 290d  _not_in_goups ).
+00020250: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00020260: 2020 2020 2020 2065 6c69 6620 6c65 6e28         elif len(
+00020270: 6772 6f75 705f 6c61 6265 6c73 2921 3d30  group_labels)!=0
+00020280: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+00020290: 2077 6172 6e69 6e67 732e 7761 726e 280d   warnings.warn(.
+000202a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000202b0: 2022 4265 2061 7761 7265 2120 7468 6520   "Be aware! the 
+000202c0: 7472 6169 6c65 7220 6973 2065 6d70 7479  trailer is empty
+000202d0: 2e20 596f 7520 6d61 7920 7072 6f62 6162  . You may probab
+000202e0: 6c79 2063 6f6e 6675 7365 220d 0a20 2020  ly confuse"..   
+000202f0: 2020 2020 2020 2020 2020 2020 2022 2074               " t
+00020300: 6865 2074 7275 6520 6c61 6265 6c73 2069  he true labels i
+00020310: 6e20 2779 5f74 7275 6527 2074 6f20 7468  n 'y_true' to th
+00020320: 6520 7072 6564 6963 7465 6420 6c61 6265  e predicted labe
+00020330: 6c73 2e22 0d0a 2020 2020 2020 2020 2020  ls."..          
+00020340: 2020 2020 2020 2220 5468 6973 2077 696c        " This wil
+00020350: 6c20 6372 6561 7465 2075 6e65 7870 6563  l create unexpec
+00020360: 7465 6420 7265 7375 6c74 7320 7768 656e  ted results when
+00020370: 2062 6f74 6820 6172 7261 7973 206c 6162   both arrays lab
+00020380: 656c 7322 0d0a 2020 2020 2020 2020 2020  els"..          
+00020390: 2020 2020 2020 2220 6172 6520 636f 6e66        " are conf
+000203a0: 7573 6564 2e20 7b7d 2049 6e20 7072 6174  used. {} In prat
+000203b0: 6963 652c 2074 6869 7320 6265 6861 7669  ice, this behavi
+000203c0: 6f72 2069 7320 6e6f 7420 746f 6c65 7261  or is not tolera
+000203d0: 626c 652e 220d 0a20 2020 2020 2020 2020  ble."..         
+000203e0: 2020 2020 2020 2022 2042 6520 7375 7265         " Be sure
+000203f0: 2c20 796f 7520 6b6e 6f77 2077 6861 7420  , you know what 
+00020400: 796f 7520 6172 6520 646f 696e 672e 2055  you are doing. U
+00020410: 7365 2061 7420 796f 7572 206f 776e 2072  se at your own r
+00020420: 6973 6b2e 220d 0a20 2020 2020 2020 2020  isk."..         
+00020430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020440: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+00020450: 7761 726e 696e 6773 2e77 6172 6e28 6d73  warnings.warn(ms
+00020460: 672e 666f 726d 6174 2877 6172 6e5f 6d73  g.format(warn_ms
+00020470: 6729 290d 0a20 2020 2020 2020 2020 2020  g))..           
+00020480: 2074 7261 696c 6572 203d 2727 200d 0a20   trailer ='' .. 
+00020490: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+000204a0: 2069 6620 7472 6169 6c65 7220 6973 206e   if trailer is n
+000204b0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+000204c0: 2020 7073 6575 646f 5f6c 6162 656c 7320    pseudo_labels 
+000204d0: 3d20 6c69 7374 2870 7365 7564 6f5f 6c61  = list(pseudo_la
+000204e0: 6265 6c73 2920 0d0a 2020 2020 2020 2020  bels) ..        
+000204f0: 2320 5b30 202c 2032 202c 2033 205d 0d0a  # [0 , 2 , 3 ]..
+00020500: 2020 2020 6966 206e 6f74 2069 735f 6e75      if not is_nu
+00020510: 6d65 7269 6320 6f72 2074 7261 696c 6572  meric or trailer
+00020520: 2069 7320 6e6f 7420 4e6f 6e65 3a20 0d0a   is not None: ..
+00020530: 2020 2020 2020 2020 2320 5075 7420 7468          # Put th
+00020540: 6520 7472 7565 206c 6162 656c 7320 6f72  e true labels or
+00020550: 6967 696e 2069 6e74 6f20 6120 6c69 7374  igin into a list
+00020560: 206f 6620 7374 7269 6e67 200d 0a20 2020   of string ..   
+00020570: 2020 2020 2023 2074 6f20 7065 7266 6f72       # to perfor
+00020580: 6d20 656c 656d 656e 7420 7769 7365 2063  m element wise c
+00020590: 6f6d 7061 7269 736f 6e20 200d 0a20 2020  omparison  ..   
+000205a0: 2020 2020 2066 6f72 206b 202c 2069 7465       for k , ite
+000205b0: 6d73 2069 6e20 656e 756d 6572 6174 6520  ms in enumerate 
+000205c0: 286c 6162 656c 735f 6e6f 745f 696e 5f67  (labels_not_in_g
+000205d0: 6f75 7073 293a 200d 0a20 2020 2020 2020  oups): ..       
+000205e0: 2020 2020 2069 6620 6974 656d 7320 696e       if items in
+000205f0: 206c 6973 7428 7472 7565 5f6c 6162 656c   list(true_label
+00020600: 735f 6f72 6967 293a 200d 0a20 2020 2020  s_orig): ..     
+00020610: 2020 2020 2020 2020 2020 2070 7365 7564             pseud
+00020620: 6f5f 6c61 6265 6c73 5b6b 5d20 3d20 7374  o_labels[k] = st
+00020630: 7228 6974 656d 7329 202b 2074 7261 696c  r(items) + trail
+00020640: 6572 0d0a 2020 2020 2020 2020 2020 2020  er..            
+00020650: 656c 7365 3a20 2070 7365 7564 6f5f 6c61  else:  pseudo_la
+00020660: 6265 6c73 5b6b 5d20 3d20 6974 656d 730d  bels[k] = items.
+00020670: 0a20 2020 2020 2020 2023 204e 756d 7079  .        # Numpy
+00020680: 2066 6f72 6d61 7420 7468 6520 7374 7269   format the stri
+00020690: 6e67 206c 6162 656c 7320 0d0a 2020 2020  ng labels ..    
+000206a0: 2020 2020 7073 6575 646f 5f6c 6162 656c      pseudo_label
+000206b0: 7320 3d20 6e70 2e61 7272 6179 2870 7365  s = np.array(pse
+000206c0: 7564 6f5f 6c61 6265 6c73 2029 200d 0a20  udo_labels ) .. 
+000206d0: 2020 2020 2020 200d 0a20 2020 2070 7365         ..    pse
+000206e0: 7564 6f5f 6469 6374 203d 2064 6963 7428  udo_dict = dict(
+000206f0: 7a69 7020 286c 6162 656c 735f 6e6f 745f  zip (labels_not_
+00020700: 696e 5f67 6f75 7073 2c20 7073 6575 646f  in_goups, pseudo
+00020710: 5f6c 6162 656c 7320 2929 200d 0a0d 0a20  _labels )) .... 
+00020720: 2020 2072 6574 7572 6e20 2070 7365 7564     return  pseud
+00020730: 6f5f 6469 6374 200d 0a0d 0a64 6566 205f  o_dict ....def _
+00020740: 6d69 7874 7572 655f 6e75 6d5f 6c61 6265  mixture_num_labe
+00020750: 6c5f 6966 5f30 5f69 6e20 2874 7275 655f  l_if_0_in (true_
+00020760: 6c61 6265 6c73 2c20 6c61 6265 6c73 5f74  labels, labels_t
+00020770: 6f5f 7265 6e61 6d65 2920 3a0d 0a20 2020  o_rename) :..   
+00020780: 2022 2222 2049 736f 6c61 7465 6420 7061   """ Isolated pa
+00020790: 7274 206f 6620 5f63 7265 6174 655f 6d78  rt of _create_mx
+000207a0: 735f 7073 6575 646f 5f6c 6162 656c 7320  s_pseudo_labels 
+000207b0: 2222 220d 0a20 2020 206e 6577 5f6c 6162  """..    new_lab
+000207c0: 656c 7320 3d20 6e70 2e61 7272 6179 2028  els = np.array (
+000207d0: 6c61 6265 6c73 5f74 6f5f 7265 6e61 6d65  labels_to_rename
+000207e0: 2029 200d 0a20 2020 2069 6620 3020 696e   ) ..    if 0 in
+000207f0: 206c 6162 656c 735f 746f 5f72 656e 616d   labels_to_renam
+00020800: 653a 200d 0a20 2020 2020 2020 206e 6577  e: ..        new
+00020810: 5f6c 6162 656c 7320 2b3d 206d 6178 2874  _labels += max(t
+00020820: 7275 655f 6c61 6265 6c73 2920 2b20 3120  rue_labels) + 1 
+00020830: 2320 736b 6970 2074 6865 2030 200d 0a20  # skip the 0 .. 
+00020840: 2020 2020 2020 2023 2074 7275 655f 6c61         # true_la
+00020850: 6265 6c73 203d 5b30 202c 2031 2c20 325d  bels =[0 , 1, 2]
+00020860: 0d0a 2020 2020 2020 2020 2320 4e47 415f  ..        # NGA_
+00020870: 6c61 6265 6c73 203d 5b20 302c 2031 2c20  labels =[ 0, 1, 
+00020880: 3220 5d20 0d0a 2020 2020 2020 2020 2320  2 ] ..        # 
+00020890: 626f 7468 200d 0a20 2020 2020 2020 2023  both ..        #
+000208a0: 204e 4741 5f6c 6162 656c 7320 3d20 322b   NGA_labels = 2+
+000208b0: 3120 2b20 4e47 415f 6c61 6265 6c73 203d  1 + NGA_labels =
+000208c0: 205b 332c 2034 2c20 355d 0d0a 2020 2020   [3, 4, 5]..    
+000208d0: 2020 2020 2320 3020 696e 2074 7275 655f      # 0 in true_
+000208e0: 6c61 6265 6c73 206f 6e6c 7920 692e 6520  labels only i.e 
+000208f0: 4e47 4120 6c61 6265 6c73 205b 312c 2032  NGA labels [1, 2
+00020900: 5d0d 0a20 2020 2020 2020 2023 204e 4741  ]..        # NGA
+00020910: 206c 6176 656c 7320 3d20 3220 2b20 5b31   lavels = 2 + [1
+00020920: 2c20 325d 2d3e 205b 332c 2034 5d20 213d  , 2]-> [3, 4] !=
+00020930: 2074 7275 655f 6c61 6265 6c73 200d 0a20   true_labels .. 
+00020940: 2020 2020 2020 2023 2030 206e 204e 4741         # 0 n NGA
+00020950: 206c 6162 656c 7320 6f6e 6c79 200d 0a20   labels only .. 
+00020960: 2020 2065 6c73 653a 200d 0a20 2020 2020     else: ..     
+00020970: 2020 2023 2074 7275 655f 6c61 6265 6c73     # true_labels
+00020980: 203d 5b31 2c20 325d 0d0a 2020 2020 2020   =[1, 2]..      
+00020990: 2020 2320 4e47 415f 6c61 6265 6c73 203d    # NGA_labels =
+000209a0: 5b30 2c20 312c 2032 205d 200d 0a20 2020  [0, 1, 2 ] ..   
+000209b0: 2020 2020 2023 204e 4741 5f6c 6162 656c       # NGA_label
+000209c0: 7320 3d20 3220 2b20 4e47 415f 6c61 6265  s = 2 + NGA_labe
+000209d0: 6c73 203d 205b 322c 2033 2c20 345d 0d0a  ls = [2, 3, 4]..
+000209e0: 2020 2020 2020 2020 6e65 775f 6c61 6265          new_labe
+000209f0: 6c73 202b 3d20 6d61 7828 7472 7565 5f6c  ls += max(true_l
+00020a00: 6162 656c 7329 0d0a 2020 2020 2320 7265  abels)..    # re
+00020a10: 636f 6e76 6572 7420 746f 2069 6e74 6567  convert to integ
+00020a20: 6572 200d 0a20 2020 2072 6574 7572 6e20  er ..    return 
+00020a30: 206e 6577 5f6c 6162 656c 732e 6173 7479   new_labels.asty
+00020a40: 7065 2028 6e70 2e69 6e74 3332 2029 200d  pe (np.int32 ) .
+00020a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020a60: 2020 0d0a 6465 6620 5f4d 5853 5f69 665f    ..def _MXS_if_
+00020a70: 7965 7320 2863 6f6e 7465 7874 202c 202f  yes (context , /
+00020a80: 2c20 736c 6720 2c20 795f 7072 6564 2c20  , slg , y_pred, 
+00020a90: 795f 7472 7565 2c20 2073 6570 3d4e 6f6e  y_true,  sep=Non
+00020aa0: 652c 2020 7072 6566 6978 3d20 4e6f 6e65  e,  prefix= None
+00020ab0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00020ac0: 2020 2020 2063 6d73 673d 2727 202c 2074       cmsg='' , t
+00020ad0: 7261 696c 6572 203d 2022 2a22 2029 3a20  railer = "*" ): 
+00020ae0: 0d0a 2020 2020 2222 2220 4d61 6b65 204d  ..    """ Make M
+00020af0: 5853 2074 6172 6765 7420 7768 656e 2073  XS target when s
+00020b00: 696d 696c 6172 6974 7920 6973 2066 6f75  imilarity is fou
+00020b10: 6e64 2062 6574 7765 656e 2061 206c 6162  nd between a lab
+00020b20: 656c 2069 6e20 2779 5f74 7275 6527 2061  el in 'y_true' a
+00020b30: 6e64 200d 0a20 2020 206c 6162 656c 2069  nd ..    label i
+00020b40: 6e20 7468 6520 7072 6564 6963 7465 6420  n the predicted 
+00020b50: 4e47 412e 200d 0a0d 0a20 2020 203a 7061  NGA. ....    :pa
+00020b60: 7261 6d20 795f 7072 6564 3a20 6172 7261  ram y_pred: arra
+00020b70: 795f 6c69 6b65 2031 6420 0d0a 2020 2020  y_like 1d ..    
+00020b80: 2020 2020 6172 7261 7920 6f66 2074 6865      array of the
+00020b90: 204e 4741 2070 7265 6469 6374 6564 206c   NGA predicted l
+00020ba0: 6162 656c 732e 200d 0a20 2020 203a 7061  abels. ..    :pa
+00020bb0: 7261 6d20 636f 6e74 6578 743a 2073 7472  ram context: str
+00020bc0: 202c 207b 2773 696d 696c 6172 6974 7920   , {'similarity 
+00020bd0: 6578 6973 7473 277d 0d0a 2020 2020 3a70  exists'}..    :p
+00020be0: 6172 616d 2063 736d 673a 7374 722c 200d  aram csmg:str, .
+00020bf0: 0a20 2020 2020 2020 2066 6f72 6d61 7461  .        formata
+00020c00: 6765 206d 6573 7361 6765 2069 7320 7772  ge message is wr
+00020c10: 6f6e 6720 636f 6e74 6578 7420 6973 2070  ong context is p
+00020c20: 6173 7365 6420 696e 2074 6865 2077 726f  assed in the wro
+00020c30: 6e67 2066 756e 6374 696f 6e2e 200d 0a0d  ng function. ...
+00020c40: 0a20 2020 203a 7265 7475 726e 733a 200d  .    :returns: .
+00020c50: 0a20 2020 2020 2020 202d 2079 5f6d 7873  .        - y_mxs
+00020c60: 3a20 6172 7261 792d 6c69 6b65 2031 6420  : array-like 1d 
+00020c70: 2c20 4d58 5320 6e65 7720 6c61 6265 6c73  , MXS new labels
+00020c80: 2063 7265 6174 6564 200d 0a20 2020 2020   created ..     
+00020c90: 2020 202d 2067 726f 7570 5f63 6c61 7373     - group_class
+00020ca0: 6573 5f3a 2064 6963 742c 2074 6865 206c  es_: dict, the l
+00020cb0: 6162 656c 7320 696e 204e 4741 206c 6162  abels in NGA lab
+00020cc0: 656c 7320 616e 6420 7468 6569 7220 0d0a  els and their ..
+00020cd0: 2020 2020 2020 2020 2020 2020 706f 7373              poss
+00020ce0: 6962 6c65 2072 656e 616d 6564 2076 616c  ible renamed val
+00020cf0: 7565 732e 204d 6f73 7420 6f66 2074 6865  ues. Most of the
+00020d00: 2063 6173 652c 2074 6869 7320 6861 7070   case, this happ
+00020d10: 656e 7320 200d 0a20 2020 2020 2020 2020  ens  ..         
+00020d20: 2020 2077 6865 6e20 7468 6520 7468 6520     when the the 
+00020d30: 6772 6f75 7073 2076 616c 7565 7320 6172  groups values ar
+00020d40: 6520 6769 7665 6e20 6173 2069 6e74 6572  e given as inter
+00020d50: 6765 7220 636c 6173 7365 7320 7261 7468  ger classes rath
+00020d60: 6572 200d 0a20 2020 2020 2020 2020 2020  er ..           
+00020d70: 2074 6861 6e20 7374 7269 6e67 2e20 0d0a   than string. ..
+00020d80: 2020 2020 2020 2020 2d20 6772 6f75 705f          - group_
+00020d90: 6c61 6265 6c73 3a20 5468 6520 7369 6d69  labels: The simi
+00020da0: 6c61 7220 6c61 6265 6c73 2066 6f75 6e64  lar labels found
+00020db0: 2061 7420 7468 6520 7361 6d65 2074 696d   at the same tim
+00020dc0: 6520 696e 200d 0a20 2020 2020 2020 2020  e in ..         
+00020dd0: 2020 2027 795f 7472 7565 2720 616e 6420     'y_true' and 
+00020de0: 4e47 4120 6c61 6265 6c73 2e20 0d0a 2020  NGA labels. ..  
+00020df0: 2020 2020 2020 2d20 7369 6d5f 6772 6f75        - sim_grou
+00020e00: 7073 3a20 6772 6f75 7073 2020 6f66 2070  ps: groups  of p
+00020e10: 6169 7220 636f 6d70 6f73 6564 206f 6620  air composed of 
+00020e20: 7468 6520 7369 6d69 6c61 7220 6c61 6265  the similar labe
+00020e30: 6c20 616e 6420 0d0a 2020 2020 2020 2020  l and ..        
+00020e40: 2020 2020 616e 6420 7468 6520 6c61 6265      and the labe
+00020e50: 6c20 696e 2074 6865 2070 7265 6469 6374  l in the predict
+00020e60: 6564 204e 4741 2e20 0d0a 0d0a 2020 2020  ed NGA. ....    
+00020e70: 2222 220d 0a20 2020 2061 7373 6572 7420  """..    assert 
+00020e80: 7374 7228 636f 6e74 6578 7429 2e6c 6f77  str(context).low
+00020e90: 6572 2829 2069 6e20 7b0d 0a20 2020 2020  er() in {..     
+00020ea0: 2020 2027 7369 6d69 6c61 7269 7479 2065     'similarity e
+00020eb0: 7869 7374 7327 2c20 2779 6573 272c 2027  xists', 'yes', '
+00020ec0: 5472 7565 272c 2027 7369 6d69 6c61 7269  True', 'similari
+00020ed0: 7479 2069 7320 666f 756e 6427 7d2c 205c  ty is found'}, \
+00020ee0: 0d0a 2020 2020 2020 2020 636d 7367 2e66  ..        cmsg.f
+00020ef0: 6f72 6d61 7420 285f 4d58 535f 6966 5f6e  ormat (_MXS_if_n
+00020f00: 6f2e 5f5f 6e61 6d65 5f5f 2c20 274e 4f27  o.__name__, 'NO'
+00020f10: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00020f20: 2069 6620 6e6f 7420 6973 5f69 7465 7261   if not is_itera
+00020f30: 626c 6528 736c 6729 3a20 0d0a 2020 2020  ble(slg): ..    
+00020f40: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00020f50: 726f 7220 2822 7369 6d69 6c61 7269 7479  ror ("similarity
+00020f60: 2067 726f 7570 206d 7573 7420 6265 2061   group must be a
+00020f70: 6e20 6974 6572 6162 6c65 206f 626a 6563  n iterable objec
+00020f80: 742e 220d 0a20 2020 2020 2020 2020 2020  t."..           
+00020f90: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00020fa0: 2047 6f74 3a20 7b74 7970 6528 736c 6729   Got: {type(slg)
+00020fb0: 2e5f 5f6e 616d 655f 5f21 727d 2229 0d0a  .__name__!r}")..
+00020fc0: 200d 0a20 2020 2073 696d 5f67 726f 7570   ..    sim_group
+00020fd0: 7320 3d20 5f6e 616d 655f 6d78 735f 6c61  s = _name_mxs_la
+00020fe0: 6265 6c73 282a 736c 672c 2073 6570 203d  bels(*slg, sep =
+00020ff0: 2073 6570 2c20 7072 6566 6978 203d 7072   sep, prefix =pr
+00021000: 6566 6978 2029 0d0a 2020 2020 7472 7565  efix )..    true
+00021010: 5f6c 6162 656c 7320 2c20 6772 6f75 705f  _labels , group_
+00021020: 6c61 6265 6c73 203d 207a 6970 2028 2a73  labels = zip (*s
+00021030: 6c67 2029 0d0a 2020 2020 6966 206e 6f74  lg )..    if not
+00021040: 205f 6973 5f6e 756d 6572 6963 5f64 7479   _is_numeric_dty
+00021050: 7065 2879 5f70 7265 6429 3a20 0d0a 2020  pe(y_pred): ..  
+00021060: 2020 2020 2020 7465 6d70 7920 3d20 746f        tempy = to
+00021070: 5f64 7479 7065 5f73 7472 2879 5f70 7265  _dtype_str(y_pre
+00021080: 642c 2072 6574 7572 6e5f 7661 6c75 6573  d, return_values
+00021090: 203d 2054 7275 6520 290d 0a20 2020 2065   = True )..    e
+000210a0: 6c73 6520 3a20 7465 6d70 7920 3d20 795f  lse : tempy = y_
+000210b0: 7072 6564 2e63 6f70 7928 290d 0a0d 0a20  pred.copy().... 
+000210c0: 2020 2069 6620 6e6f 7420 616c 6c20 285b     if not all ([
+000210d0: 206c 2069 6e20 6e70 2e75 6e69 7175 6520   l in np.unique 
+000210e0: 2874 656d 7079 2920 666f 7220 6c20 696e  (tempy) for l in
+000210f0: 2067 726f 7570 5f6c 6162 656c 7320 5d29   group_labels ])
+00021100: 3a20 0d0a 2020 2020 2020 2020 2320 6c69  : ..        # li
+00021110: 7374 2074 6865 2069 6e76 616c 6964 2067  st the invalid g
+00021120: 726f 7570 7320 0d0a 2020 2020 2020 2020  roups ..        
+00021130: 2320 6e6f 7420 696e 2074 6865 204e 4741  # not in the NGA
+00021140: 206c 6162 656c 7320 0d0a 2020 2020 2020   labels ..      
+00021150: 2020 6d73 6720 3d20 6c69 7374 696e 675f    msg = listing_
+00021160: 6974 656d 735f 666f 726d 6174 2867 726f  items_format(gro
+00021170: 7570 5f6c 6162 656c 732c 200d 0a20 2020  up_labels, ..   
+00021180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021190: 2020 2020 2020 2020 2020 2249 6e76 616c            "Inval
+000211a0: 6964 2073 696d 696c 6172 2067 726f 7570  id similar group
+000211b0: 7322 2c20 200d 0a20 2020 2020 2020 2020  s",  ..         
+000211c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000211d0: 2020 2020 2247 726f 7570 206d 7573 7420      "Group must 
+000211e0: 6265 2074 6865 206c 6162 656c 7320 696e  be the labels in
+000211f0: 2074 6865 2070 7265 6469 6374 6564 204e   the predicted N
+00021200: 4741 2e22 2c0d 0a20 2020 2020 2020 2020  GA.",..         
+00021210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021220: 2020 2020 7665 7262 6f73 6520 3d20 4661      verbose = Fa
+00021230: 6c73 6520 2c20 696e 6c69 6e65 203d 5472  lse , inline =Tr
+00021240: 7565 202c 0d0a 2020 2020 2020 2020 2020  ue ,..          
+00021250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021260: 2020 2029 0d0a 2020 2020 2020 2020 7261     )..        ra
+00021270: 6973 6520 4171 7569 6665 7247 726f 7570  ise AquiferGroup
+00021280: 4572 726f 7220 286d 7367 290d 0a20 2020  Error (msg)..   
+00021290: 200d 0a20 2020 2079 5f6d 7873 203d 206e   ..    y_mxs = n
+000212a0: 702e 6675 6c6c 2028 795f 7072 6564 2e73  p.full (y_pred.s
+000212b0: 6861 7065 202c 2066 696c 6c5f 7661 6c75  hape , fill_valu
+000212c0: 653d 206e 702e 6e61 6e20 2c20 6474 7970  e= np.nan , dtyp
+000212d0: 6520 3d20 6f62 6a65 6374 2029 0d0a 0d0a  e = object )....
+000212e0: 2020 2020 2320 4765 7420 7468 6520 696e      # Get the in
+000212f0: 6465 7820 6f66 2065 6163 6820 4e47 4120  dex of each NGA 
+00021300: 6c61 6265 6c73 0d0a 2020 2020 4e47 415f  labels..    NGA_
+00021310: 6c61 6265 6c5f 696e 6469 6365 7320 3d20  label_indices = 
+00021320: 7b20 0d0a 2020 2020 2020 2020 6c61 6265  { ..        labe
+00021330: 6c3a 206e 702e 7768 6572 6520 2879 5f70  l: np.where (y_p
+00021340: 7265 6420 3d3d 206c 6162 656c 2029 5b30  red == label )[0
+00021350: 5d20 666f 7220 6c61 6265 6c20 696e 206e  ] for label in n
+00021360: 702e 756e 6971 7565 2028 795f 7072 6564  p.unique (y_pred
+00021370: 2029 0d0a 2020 2020 2020 2020 7d0d 0a20   )..        }.. 
+00021380: 2020 2023 2063 7265 6174 6520 6120 6469     # create a di
+00021390: 6374 206f 6620 7073 6575 646f 6c61 6265  ct of pseudolabe
+000213a0: 6c73 206e 6f74 2069 6e20 6772 6f75 705f  ls not in group_
+000213b0: 6c61 6265 6c73 2020 0d0a 2020 2020 7073  labels  ..    ps
+000213c0: 6575 646f 5f4e 4741 5f6c 6162 656c 7320  eudo_NGA_labels 
+000213d0: 3d20 5f63 7265 6174 655f 6d78 735f 7073  = _create_mxs_ps
+000213e0: 6575 646f 5f6c 6162 656c 7320 280d 0a20  eudo_labels (.. 
+000213f0: 2020 2020 2020 2079 5f74 7275 652c 2079         y_true, y
+00021400: 5f70 7265 642c 2067 726f 7570 5f6c 6162  _pred, group_lab
+00021410: 656c 732c 2074 7261 696c 6572 203d 7472  els, trailer =tr
+00021420: 6169 6c65 7220 290d 0a20 2020 2067 726f  ailer )..    gro
+00021430: 7570 5f63 6c61 7373 6573 5f20 3d20 6469  up_classes_ = di
+00021440: 6374 2829 200d 0a20 2020 2066 6f72 206b  ct() ..    for k
+00021450: 6c61 6265 6c20 2c20 7669 6e64 6578 2069  label , vindex i
+00021460: 6e20 4e47 415f 6c61 6265 6c5f 696e 6469  n NGA_label_indi
+00021470: 6365 732e 6974 656d 7320 2829 203a 0d0a  ces.items () :..
+00021480: 2020 2020 2020 2020 6966 206b 6c61 6265          if klabe
+00021490: 6c20 696e 2020 6772 6f75 705f 6c61 6265  l in  group_labe
+000214a0: 6c73 203a 2023 205b 2034 2c20 342c 2032  ls : # [ 4, 4, 2
+000214b0: 205d 0d0a 2020 2020 2020 2020 2020 2020   ]..            
+000214c0: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
+000214d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000214e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000214f0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00021500: 2020 2020 2020 2020 2320 7765 2063 616e          # we can
+00021510: 2073 696d 706c 7920 6765 7420 6820 6672   simply get h fr
+00021520: 6f6d 2069 6e64 6963 6573 2c20 686f 7765  om indices, howe
+00021530: 7665 7220 6974 2074 6865 7265 2069 7320  ver it there is 
+00021540: 7468 6520 0d0a 2020 2020 2020 2020 2020  the ..          
+00021550: 2020 2320 7361 6d65 206b 2064 7570 6c69    # same k dupli
+00021560: 6361 7465 2069 6e20 6772 6f75 7073 206c  cate in groups l
+00021570: 6162 656c 732c 2069 6e64 6578 2077 696c  abels, index wil
+00021580: 6c20 616c 7761 7973 2062 6520 0d0a 2020  l always be ..  
+00021590: 2020 2020 2020 2020 2020 2320 6665 7463            # fetc
+000215a0: 6865 6420 6672 6f6d 2066 6972 7374 206f  hed from first o
+000215b0: 6363 7572 656e 6365 2c20 7768 6963 6820  ccurence, which 
+000215c0: 7365 656d 7320 6865 7572 6973 7469 6320  seems heuristic 
+000215d0: 200d 0a20 2020 2020 2020 2020 2020 2065   ..            e
+000215e0: 6c74 5f69 6e64 6578 203d 2020 6772 6f75  lt_index =  grou
+000215f0: 705f 6c61 6265 6c73 2e69 6e64 6578 2028  p_labels.index (
+00021600: 6b6c 6162 656c 2029 2020 0d0a 2020 2020  klabel )  ..    
+00021610: 2020 2020 2020 2020 6e6b 6c61 6265 6c20          nklabel 
+00021620: 3d20 7369 6d5f 6772 6f75 7073 205b 656c  = sim_groups [el
+00021630: 745f 696e 6465 7820 5d20 0d0a 2020 2020  t_index ] ..    
+00021640: 2020 2020 2020 2020 2320 7072 696e 7428          # print(
+00021650: 6b6c 6162 656c 2c20 6e6b 6c61 6265 6c29  klabel, nklabel)
+00021660: 0d0a 2020 2020 2020 2020 2020 2020 795f  ..            y_
+00021670: 6d78 7320 5b20 7669 6e64 6578 205d 203d  mxs [ vindex ] =
+00021680: 206e 6b6c 6162 656c 0d0a 2020 2020 2020   nklabel..      
+00021690: 2020 2020 2020 6772 6f75 705f 636c 6173        group_clas
+000216a0: 7365 735f 205b 6b6c 6162 656c 5d20 3d20  ses_ [klabel] = 
+000216b0: 6e6b 6c61 6265 6c0d 0a20 2020 2020 2020  nklabel..       
+000216c0: 2020 2020 2023 2023 202d 2d2d 2d2d 2d2d       # # -------
+000216d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000216e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000216f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
+00021700: 2020 2020 2065 6c69 6620 6b6c 6162 656c       elif klabel
+00021710: 206e 6f74 2069 6e20 6772 6f75 705f 6c61   not in group_la
+00021720: 6265 6c73 203a 200d 0a20 2020 2020 2020  bels : ..       
+00021730: 2020 2020 206e 6b6c 6162 656c 203d 2070       nklabel = p
+00021740: 7365 7564 6f5f 4e47 415f 6c61 6265 6c73  seudo_NGA_labels
+00021750: 2e67 6574 286b 6c61 6265 6c29 200d 0a20  .get(klabel) .. 
+00021760: 2020 2020 2020 2020 2020 2079 5f6d 7873             y_mxs
+00021770: 205b 2076 696e 6465 7820 5d20 3d20 6e6b   [ vindex ] = nk
+00021780: 6c61 6265 6c20 0d0a 2020 2020 2020 2020  label ..        
+00021790: 2020 2020 6772 6f75 705f 636c 6173 7365      group_classe
+000217a0: 735f 205b 6b6c 6162 656c 5d20 3d20 6e6b  s_ [klabel] = nk
+000217b0: 6c61 6265 6c20 0d0a 2020 2020 0d0a 2020  label ..    ..  
+000217c0: 2020 7265 7475 726e 2079 5f6d 7873 202c    return y_mxs ,
+000217d0: 2067 726f 7570 5f63 6c61 7373 6573 5f20   group_classes_ 
+000217e0: 2c20 6772 6f75 705f 6c61 6265 6c73 202c  , group_labels ,
+000217f0: 2073 696d 5f67 726f 7570 7320 0d0a 0d0a   sim_groups ....
+00021800: 4064 6570 7265 6361 7465 6428 2246 756e  @deprecated("Fun
+00021810: 6374 696f 6e20 6973 2068 656e 6365 666f  ction is hencefo
+00021820: 7274 6820 6465 7072 6563 6174 6564 2e20  rth deprecated. 
+00021830: 4e6f 2075 7365 2061 6e79 6d6f 7265 2069  No use anymore i
+00021840: 6e22 0d0a 2020 2020 2020 2020 2020 2020  n"..            
+00021850: 2220 4d58 5320 7374 7261 7465 6779 2069  " MXS strategy i
+00021860: 6d70 6c65 6d65 6e74 6174 696f 6e2e 2049  mplementation. I
+00021870: 7420 6861 7320 6265 656e 2072 6570 6c61  t has been repla
+00021880: 6365 6420 6279 220d 0a20 2020 2020 2020  ced by"..       
+00021890: 2020 2020 2022 203a 6675 6e63 3a60 7e2e       " :func:`~.
+000218a0: 5f6d 6978 7475 7265 5f6e 756d 5f6c 6162  _mixture_num_lab
+000218b0: 656c 5f69 665f 305f 696e 6020 6d6f 7265  el_if_0_in` more
+000218c0: 2073 7461 626c 652e 220d 0a20 2020 2020   stable."..     
+000218d0: 2020 2020 2020 2022 2049 7420 7368 6f75         " It shou
+000218e0: 6c64 2062 6520 7265 6d6f 7665 6420 736f  ld be removed so
+000218f0: 6f6e 2069 6e20 6120 6675 7475 7265 2072  on in a future r
+00021900: 6561 6c65 6173 652e 2022 290d 0a64 6566  ealease. ")..def
+00021910: 205f 6d69 7874 7572 655f 6772 6f75 705f   _mixture_group_
+00021920: 6c61 6265 6c5f 6966 2028 206c 6162 656c  label_if ( label
+00021930: 5f6b 2c20 745f 6c61 6265 6c73 293a 200d  _k, t_labels): .
+00021940: 0a20 2020 2022 2222 2053 7461 7274 2063  .    """ Start c
+00021950: 6f75 6e74 696e 6720 7265 6d61 696e 696e  ounting remainin
+00021960: 6720 6c61 6265 6c73 2066 726f 6d20 7468  g labels from th
+00021970: 6520 6d61 7869 6d75 6d20 7661 6c75 6520  e maximum value 
+00021980: 6f66 200d 0a20 2020 206c 6162 656c 2066  of ..    label f
+00021990: 6f75 6e64 2069 6e20 7468 6520 2774 5f6c  ound in the 't_l
+000219a0: 6162 656c 7327 2022 2222 0d0a 2020 2020  abels' """..    
+000219b0: 2320 5573 6520 7468 6520 6d61 7820 656c  # Use the max el
+000219c0: 656d 656e 7420 696e 2074 6865 2074 7275  ement in the tru
+000219d0: 6520 6c61 6265 6c73 200d 0a20 2020 2023  e labels ..    #
+000219e0: 2061 6e64 2061 7070 656e 6420 6974 2074   and append it t
+000219f0: 6f20 7468 6520 7265 6d61 696e 206c 6162  o the remain lab
+00021a00: 656c 7320 7768 6f73 6520 0d0a 2020 2020  els whose ..    
+00021a10: 2320 6172 6520 6e6f 7420 666f 756e 6420  # are not found 
+00021a20: 6173 2073 696d 696c 6172 6974 7920 6772  as similarity gr
+00021a30: 6f75 7073 2020 0d0a 2020 2020 2320 7468  oups  ..    # th
+00021a40: 6973 2069 7320 706f 7373 6962 6c65 2069  is is possible i
+00021a50: 6620 7468 6520 7369 6d70 696c 6172 7920  f the simpilary 
+00021a60: 6772 6f75 7020 6172 6520 6e75 6d65 7279  group are numery
+00021a70: 2064 6174 6174 7970 6520 0d0a 2020 2020   datatype ..    
+00021a80: 2320 486f 7765 7665 7220 6966 2069 6620  # However if if 
+00021a90: 7374 7269 6e67 202c 206b 6565 7020 6974  string , keep it
+00021aa0: 2069 6e20 7468 6520 6461 7461 7365 7473   in the datasets
+00021ab0: 200d 0a20 2020 2023 2054 6865 2067 6f61   ..    # The goa
+00021ac0: 6c20 6f66 2074 6869 7320 6973 2074 6f20  l of this is to 
+00021ad0: 6e6f 7420 6265 2063 6f6e 6675 7365 2077  not be confuse w
+00021ae0: 6974 6820 7468 6520 6578 6973 7469 6e67  ith the existing
+00021af0: 0d0a 2020 2020 2320 2074 7275 6520 6c61  ..    #  true la
+00021b00: 6265 6c73 2077 6974 6820 7468 6520 7661  bels with the va
+00021b10: 6c69 6420 6b20 6c61 6265 6c73 2066 6f75  lid k labels fou
+00021b20: 6e64 2069 6e20 7468 6520 795f 7472 7565  nd in the y_true
+00021b30: 0d0a 2020 2020 0d0a 2020 2020 2320 6669  ..    ..    # fi
+00021b40: 6e64 2074 6865 2067 726f 7570 206c 6162  nd the group lab
+00021b50: 656c 2077 6869 6368 2065 7869 7374 7320  el which exists 
+00021b60: 696e 2074 6865 2074 5f6c 6162 656c 7320  in the t_labels 
+00021b70: 616e 6420 0d0a 2020 2020 2320 6372 6561  and ..    # crea
+00021b80: 7465 2070 7365 7564 6f20 6772 6f75 7020  te pseudo group 
+00021b90: 0d0a 2020 2020 2320 6c61 6265 6c73 5f69  ..    # labels_i
+00021ba0: 6e20 3d20 0d0a 2020 2020 6966 205f 6973  n = ..    if _is
+00021bb0: 5f6e 756d 6572 6963 5f64 7479 7065 2874  _numeric_dtype(t
+00021bc0: 5f6c 6162 656c 7320 2c20 746f 5f61 7272  _labels , to_arr
+00021bd0: 6179 3d54 7275 6529 203a 0d0a 2020 2020  ay=True) :..    
+00021be0: 2020 2020 6d61 785f 696e 5f74 5f6c 6162      max_in_t_lab
+00021bf0: 656c 7320 3d20 6d61 7820 2874 5f6c 6162  els = max (t_lab
+00021c00: 656c 7320 2920 200d 0a20 2020 2074 7279  els )  ..    try
+00021c10: 203a 200d 0a20 2020 2020 2020 206c 6162   : ..        lab
+00021c20: 656c 5f6b 203d 2069 6e74 2028 6c61 6265  el_k = int (labe
+00021c30: 6c5f 6b29 200d 0a20 2020 2065 7863 6570  l_k) ..    excep
+00021c40: 7420 3a20 2320 7768 6572 6520 6b20 6973  t : # where k is
+00021c50: 206e 6f74 2061 206e 756d 6572 6963 200d   not a numeric .
+00021c60: 0a20 2020 2020 2020 2023 2069 6620 6c61  .        # if la
+00021c70: 6265 6c5f 6b20 696e 2074 5f6c 6162 656c  bel_k in t_label
+00021c80: 733a 200d 0a20 2020 2020 2020 2070 6173  s: ..        pas
+00021c90: 7320 0d0a 2020 2020 656c 7365 203a 200d  s ..    else : .
+00021ca0: 0a20 2020 2020 2020 206c 6162 656c 5f6b  .        label_k
+00021cb0: 202b 3d20 6d61 785f 696e 5f74 5f6c 6162   += max_in_t_lab
+00021cc0: 656c 7320 200d 0a20 2020 2020 2020 200d  els  ..        .
+00021cd0: 0a20 2020 2072 6574 7572 6e20 6c61 6265  .    return labe
+00021ce0: 6c5f 6b20 0d0a 0d0a 6465 6620 5f6b 6d61  l_k ....def _kma
+00021cf0: 7070 696e 6720 2861 7272 2c20 2f29 3a20  pping (arr, /): 
+00021d00: 0d0a 2020 2020 2222 2220 4368 6563 6b20  ..    """ Check 
+00021d10: 7768 6574 6865 7220 7468 6520 7472 7565  whether the true
+00021d20: 206c 6162 656c 7320 2779 5f74 7275 6527   labels 'y_true'
+00021d30: 2068 6176 6520 6e75 6d65 7269 6320 6474   have numeric dt
+00021d40: 7970 6573 200d 0a20 2020 206f 7468 6572  ypes ..    other
+00021d50: 7769 7365 2c20 6372 6561 7465 2061 2069  wise, create a i
+00021d60: 6e74 6567 6572 206c 6162 656c 7320 746f  nteger labels to
+00021d70: 2020 7375 6273 7469 7475 7465 200d 0a20    substitute .. 
+00021d80: 2020 2074 6865 2074 7275 6520 6c61 6265     the true labe
+00021d90: 6c73 2e20 466f 7220 696e 7374 616e 6365  ls. For instance
+00021da0: 3a20 0d0a 2020 2020 2020 2020 0d0a 2020  : ..        ..  
+00021db0: 2020 2020 2020 3e3e 3e20 5b27 6b31 272c        >>> ['k1',
+00021dc0: 2027 6b32 272c 2027 6b33 275d 202d 203e   'k2', 'k3'] - >
+00021dd0: 205b 312c 2032 2c20 335d 0d0a 2020 2020   [1, 2, 3]..    
+00021de0: 3a70 6172 616d 2061 7272 3a20 6172 7261  :param arr: arra
+00021df0: 792d 6c69 6b65 2031 6420 0d0a 2020 2020  y-like 1d ..    
+00021e00: 2020 2020 6172 7261 7920 6f66 206f 6e65      array of one
+00021e10: 6469 6d65 6e73 696f 6e61 6c20 0d0a 2020  dimensional ..  
+00021e20: 2020 2222 220d 0a20 2020 2079 7472 616e    """..    ytran
+00021e30: 7366 203d 6172 722e 636f 7079 2829 200d  sf =arr.copy() .
+00021e40: 0a20 2020 2063 6c61 7373 6573 203d 204e  .    classes = N
+00021e50: 6f6e 6520 0d0a 2020 2020 6966 206e 6f74  one ..    if not
+00021e60: 205f 6973 5f6e 756d 6572 6963 5f64 7479   _is_numeric_dty
+00021e70: 7065 2861 7272 202c 2074 6f5f 6172 7261  pe(arr , to_arra
+00021e80: 7920 3d54 7275 6529 203a 200d 0a20 2020  y =True) : ..   
+00021e90: 2020 2020 2069 6620 6e6f 7420 5f69 735f       if not _is_
+00021ea0: 6172 7261 796c 696b 655f 3164 2861 7272  arraylike_1d(arr
+00021eb0: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
+00021ec0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00021ed0: 7220 2822 4172 7261 7920 6d75 7374 2062  r ("Array must b
+00021ee0: 6520 6f6e 652d 6469 6d65 6e73 696f 6e61  e one-dimensiona
+00021ef0: 6c2c 220d 0a20 2020 2020 2020 2020 2020  l,"..           
+00021f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021f10: 2020 2022 2067 6f74 2073 6861 7065 3a20     " got shape: 
+00021f20: 277b 6e70 2e61 7272 6179 2861 7272 292e  '{np.array(arr).
+00021f30: 7368 6170 657d 2722 290d 0a20 2020 2020  shape}'")..     
+00021f40: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00021f50: 2075 6e69 6b5f 6c61 6265 6c73 203d 206e   unik_labels = n
+00021f60: 702e 756e 6971 7565 2028 6172 7229 0d0a  p.unique (arr)..
+00021f70: 2020 2020 2020 2020 6e65 775f 6c61 6265          new_labe
+00021f80: 6c73 203d 206e 702e 6172 616e 6765 2831  ls = np.arange(1
+00021f90: 2c20 6c65 6e28 756e 696b 5f6c 6162 656c  , len(unik_label
+00021fa0: 7329 2b20 3120 2920 200d 0a20 2020 2020  s)+ 1 )  ..     
+00021fb0: 2020 2066 6f72 2074 6c61 622c 206e 6c61     for tlab, nla
+00021fc0: 6220 2069 6e20 7a69 7020 2875 6e69 6b5f  b  in zip (unik_
+00021fd0: 6c61 6265 6c73 2c20 6e65 775f 6c61 6265  labels, new_labe
+00021fe0: 6c73 2029 203a 200d 0a20 2020 2020 2020  ls ) : ..       
+00021ff0: 2020 2020 2069 6e64 6963 6573 2c20 3d20       indices, = 
+00022000: 6e70 2e77 6865 7265 2028 6172 7220 3d3d  np.where (arr ==
+00022010: 746c 6162 290d 0a20 2020 2020 2020 2020  tlab)..         
+00022020: 2020 2079 7472 616e 7366 5b69 6e64 6963     ytransf[indic
+00022030: 6573 205d 203d 206e 6c61 6220 0d0a 2020  es ] = nlab ..  
+00022040: 2020 2020 2020 636c 6173 7365 7320 3d20        classes = 
+00022050: 6469 6374 2028 207a 6970 2028 206e 6577  dict ( zip ( new
+00022060: 5f6c 6162 656c 732c 2075 6e69 6b5f 6c61  _labels, unik_la
+00022070: 6265 6c73 2029 2029 200d 0a20 2020 2023  bels ) ) ..    #
+00022080: 2074 7279 2074 6f20 636f 6e76 6572 7420   try to convert 
+00022090: 746f 2069 6e74 3332 200d 0a20 2020 2074  to int32 ..    t
+000220a0: 7279 203a 2079 7472 616e 7366 203d 2079  ry : ytransf = y
+000220b0: 7472 616e 7366 2e61 7374 7970 6520 286e  transf.astype (n
+000220c0: 702e 696e 7433 3220 290d 0a20 2020 2065  p.int32 )..    e
+000220d0: 7863 6570 743a 2070 6173 7320 0d0a 2020  xcept: pass ..  
+000220e0: 2020 7265 7475 726e 2079 7472 616e 7366    return ytransf
+000220f0: 2c20 636c 6173 7365 7320                 , classes
```

### Comparing `watex-0.2.4/watex/utils/mlutils.py` & `watex-0.2.5/watex/utils/mlutils.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/utils/plotutils.py` & `watex-0.2.5/watex/utils/plotutils.py`

 * *Files 1% similar despite different names*

```diff
@@ -6939,1695 +6939,1757 @@
 0001b1a0: 6574 7572 6e5f 6461 7461 203d 5472 7565  eturn_data =True
 0001b1b0: 202c 2073 616d 706c 6573 203d 2032 3020   , samples = 20 
 0001b1c0: 2920 0d0a 2020 2020 3e3e 3e20 706c 6f74  ) ..    >>> plot
 0001b1d0: 5f73 6b65 7720 2865 6469 5f73 6b29 200d  _skew (edi_sk) .
 0001b1e0: 0a20 2020 203e 3e3e 2070 6c6f 745f 736b  .    >>> plot_sk
 0001b1f0: 6577 2028 6564 695f 736b 2c20 7468 7265  ew (edi_sk, thre
 0001b200: 7368 6f6c 645f 6c69 6e65 3d20 5472 7565  shold_line= True
-0001b210: 2920 0d0a 2020 2020 0d0a 2020 2020 2222  ) ..    ..    ""
-0001b220: 220d 0a20 2020 2069 6620 7374 796c 6520  "..    if style 
-0001b230: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-0001b240: 2020 2020 2020 706c 742e 7374 796c 652e        plt.style.
-0001b250: 7573 6520 2873 7479 6c65 2029 0d0a 2020  use (style )..  
-0001b260: 2020 2020 2020 0d0a 2020 2020 7669 6577        ..    view
-0001b270: 203d 2076 6965 7720 6f72 2027 736b 6577   = view or 'skew
-0001b280: 270d 0a20 2020 200d 0a20 2020 2069 6620  '..    ..    if 
-0001b290: 2827 696e 7627 2020 696e 2073 7472 2028  ('inv'  in str (
-0001b2a0: 7669 6577 292e 6c6f 7765 7228 290d 0a20  view).lower().. 
-0001b2b0: 2020 2020 2020 206f 7220 2772 6f74 2720         or 'rot' 
-0001b2c0: 696e 2073 7472 2028 7669 6577 292e 6c6f  in str (view).lo
-0001b2d0: 7765 7228 290d 0a20 2020 2020 2020 206f  wer()..        o
-0001b2e0: 7220 276d 7527 2069 6e20 7374 7220 2876  r 'mu' in str (v
-0001b2f0: 6965 7729 2e6c 6f77 6572 2829 0d0a 2020  iew).lower()..  
-0001b300: 2020 2020 2020 2920 3a20 0d0a 2020 2020        ) : ..    
-0001b310: 2020 2020 7669 6577 203d 276d 7527 0d0a      view ='mu'..
-0001b320: 2020 2020 2020 2020 0d0a 2020 2020 6966          ..    if
-0001b330: 2027 7065 7269 6f64 2720 696e 2073 7472   'period' in str
-0001b340: 286d 6f64 6529 2e6c 6f77 6572 2829 3a20  (mode).lower(): 
-0001b350: 0d0a 2020 2020 2020 2020 6d6f 6465 203d  ..        mode =
-0001b360: 2770 6572 696f 6427 0d0a 2020 2020 2020  'period'..      
-0001b370: 2020 0d0a 2020 2020 6966 2073 7472 2874    ..    if str(t
-0001b380: 6872 6573 686f 6c64 5f6c 696e 6529 2e6c  hreshold_line).l
-0001b390: 6f77 6572 2829 3d3d 2774 7275 6527 3a20  ower()=='true': 
-0001b3a0: 0d0a 2020 2020 2020 2020 7468 7265 7368  ..        thresh
-0001b3b0: 6f6c 645f 6c69 6e65 203d 2073 7472 286d  old_line = str(m
-0001b3c0: 6574 686f 6429 2e6c 6f77 6572 2829 200d  ethod).lower() .
-0001b3d0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0001b3e0: 2020 2069 6d70 6f72 7420 7761 7465 7820     import watex 
-0001b3f0: 6173 2077 7820 0d0a 2020 2020 706f 203d  as wx ..    po =
-0001b400: 2020 7778 2e45 4d50 726f 6365 7373 696e    wx.EMProcessin
-0001b410: 6728 292e 6669 7428 6564 695f 6f62 6a29  g().fit(edi_obj)
-0001b420: 0d0a 2020 2020 0d0a 2020 2020 2320 7265  ..    ..    # re
-0001b430: 6d6f 7665 2074 6865 206f 7574 6c69 6572  move the outlier
-0001b440: 7320 696e 2074 6865 2064 6174 610d 0a20  s in the data.. 
-0001b450: 2020 2023 2061 6e64 2066 696c 6c65 6420     # and filled 
-0001b460: 7769 7468 204e 614e 200d 0a20 2020 2073  with NaN ..    s
-0001b470: 6b65 772c 206d 7520 3d70 6f2e 736b 6577  kew, mu =po.skew
-0001b480: 286d 6574 686f 6420 3d20 6d65 7468 6f64  (method = method
-0001b490: 2c20 7375 7070 7265 7373 5f6f 7574 6c69  , suppress_outli
-0001b4a0: 6572 7320 3d20 5472 7565 2020 290d 0a20  ers = True  ).. 
-0001b4b0: 2020 2066 7265 7173 203d 2020 312f 2070     freqs =  1/ p
-0001b4c0: 6f2e 6672 6571 735f 2069 6620 6d6f 6465  o.freqs_ if mode
-0001b4d0: 203d 3d27 7065 7269 6f64 2720 656c 7365   =='period' else
-0001b4e0: 2070 6f2e 6672 6571 735f 200d 0a20 2020   po.freqs_ ..   
-0001b4f0: 2079 6d61 7420 3d20 736b 6577 2069 6620   ymat = skew if 
-0001b500: 7669 6577 203d 3d27 736b 6577 2720 656c  view =='skew' el
-0001b510: 7365 206d 7520 0d0a 2020 2020 0d0a 2020  se mu ..    ..  
-0001b520: 2020 6669 672c 2061 7820 3d20 706c 742e    fig, ax = plt.
-0001b530: 7375 6270 6c6f 7473 2831 2c31 2c20 6669  subplots(1,1, fi
-0001b540: 6773 697a 6520 3d66 6967 5f73 697a 6529  gsize =fig_size)
-0001b550: 0d0a 0d0a 2020 2020 232d 2d2d 6d61 6e61  ....    #---mana
-0001b560: 6765 2074 6872 6573 686f 6c64 206c 696e  ge threshold lin
-0001b570: 6520 2d2d 2d2d 2d2d 0d0a 2020 2020 7468  e ------..    th
-0001b580: 725f 636f 6465 203d 207b 2262 6168 7222  r_code = {"bahr"
-0001b590: 3a20 5b31 5d20 2c20 2273 7769 6674 223a  : [1] , "swift":
-0001b5a0: 5b20 325d 202c 2027 626f 7468 273a 5b31  [ 2] , 'both':[1
-0001b5b0: 2c20 325d 207d 0d0a 0d0a 2020 2020 2020  , 2] }....      
-0001b5c0: 2020 0d0a 2020 2020 6966 2074 6872 6573    ..    if thres
-0001b5d0: 686f 6c64 5f6c 696e 6520 6973 206e 6f74  hold_line is not
-0001b5e0: 204e 6f6e 653a 200d 0a20 2020 2020 2020   None: ..       
-0001b5f0: 2069 6620 7374 7228 7468 7265 7368 6f6c   if str(threshol
-0001b600: 645f 6c69 6e65 292e 6c6f 7765 7228 2920  d_line).lower() 
-0001b610: 696e 2028 222a 222c 2022 626f 7468 2229  in ("*", "both")
-0001b620: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0001b630: 7468 7265 7368 6f6c 645f 6c69 6e65 203d  threshold_line =
-0001b640: 2027 626f 7468 270d 0a20 2020 2020 2020   'both'..       
-0001b650: 2020 2020 200d 0a20 2020 2063 7420 3d20       ..    ct = 
-0001b660: 7468 725f 636f 6465 2e67 6574 2873 7472  thr_code.get(str
-0001b670: 2874 6872 6573 686f 6c64 5f6c 696e 6529  (threshold_line)
-0001b680: 2e6c 6f77 6572 2829 2c20 4e6f 6e65 2029  .lower(), None )
-0001b690: 200d 0a20 2020 200d 0a20 2020 2066 6f72   ..    ..    for
-0001b6a0: 2069 2069 6e20 7261 6e67 6520 2873 6b65   i in range (ske
-0001b6b0: 772e 7368 6170 655b 315d 293a 200d 0a20  w.shape[1]): .. 
-0001b6c0: 2020 2020 2020 2061 782e 7363 6174 7465         ax.scatte
-0001b6d0: 7220 2820 6672 6571 732c 2072 6573 6861  r ( freqs, resha
-0001b6e0: 7065 2028 796d 6174 5b3a 2c20 695d 292c  pe (ymat[:, i]),
-0001b6f0: 2a2a 6b77 7320 290d 0a20 2020 2020 2020  **kws )..       
-0001b700: 200d 0a20 2020 2069 6620 6374 3a20 0d0a   ..    if ct: ..
-0001b710: 2020 2020 2020 2020 666f 7220 6d20 696e          for m in
-0001b720: 2063 743a 200d 0a20 2020 2020 2020 2020   ct: ..         
-0001b730: 2020 2070 6c74 2e61 7868 6c69 6e65 2879     plt.axhline(y
-0001b740: 3d30 2e34 2069 6620 6d3d 3d32 2065 6c73  =0.4 if m==2 els
-0001b750: 6520 302e 3320 2c20 636f 6c6f 723d 226b  e 0.3 , color="k
-0001b760: 2220 6966 206d 3d3d 3120 656c 7365 2022  " if m==1 else "
-0001b770: 7222 2c0d 0a20 2020 2020 2020 2020 2020  r",..           
-0001b780: 2020 2020 2020 2020 2020 2020 206c 696e               lin
-0001b790: 6573 7479 6c65 3d22 2d22 2c0d 0a20 2020  estyle="-",..   
-0001b7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b7b0: 2020 2020 206c 6162 656c 3d66 2774 6872       label=f'thr
-0001b7c0: 6573 686f 6c64 3a20 245c 6d75 3d7b 302e  eshold: $\mu={0.
-0001b7d0: 3420 6966 206d 3d3d 3220 656c 7365 2030  4 if m==2 else 0
-0001b7e0: 2e33 7d24 270d 0a20 2020 2020 2020 2020  .3}$'..         
-0001b7f0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0001b800: 0d0a 2020 2020 2020 2020 2020 2020 6178  ..            ax
-0001b810: 2e6c 6567 656e 6428 2920 0d0a 0d0a 2020  .legend() ....  
-0001b820: 2020 6178 2e73 6574 5f78 7363 616c 6528    ax.set_xscale(
-0001b830: 276c 6f67 2729 0d0a 2020 2020 0d0a 2020  'log')..    ..  
-0001b840: 2020 6178 2e73 6574 5f78 6c61 6265 6c28    ax.set_xlabel(
-0001b850: 2750 6572 696f 6420 2824 7324 2927 2069  'Period ($s$)' i
-0001b860: 6620 6d6f 6465 3d3d 2770 6572 696f 6427  f mode=='period'
-0001b870: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0001b880: 2020 2020 2065 6c73 6520 2746 7265 7175       else 'Frequ
-0001b890: 656e 6379 2028 2448 5f7a 2429 2729 0d0a  ency ($H_z$)')..
-0001b8a0: 2020 2020 6178 2e73 6574 5f79 6c61 6265      ax.set_ylabe
-0001b8b0: 6c28 6622 7b27 536b 6577 2720 6966 2076  l(f"{'Skew' if v
-0001b8c0: 6965 7720 3d3d 2773 6b65 7727 2065 6c73  iew =='skew' els
-0001b8d0: 6520 2752 6f74 2e49 6e76 6172 6961 6e74  e 'Rot.Invariant
-0001b8e0: 277d 2220 2b20 2228 245c 6d75 2429 2229  '}" + "($\mu$)")
-0001b8f0: 0d0a 0d0a 2020 2020 706c 742e 786c 696d  ....    plt.xlim
-0001b900: 2028 5b20 6672 6571 732e 6d69 6e28 2920   ([ freqs.min() 
-0001b910: 2c20 6672 6571 732e 6d61 7828 295d 290d  , freqs.max()]).
-0001b920: 0a20 2020 200d 0a20 2020 2023 706c 742e  .    ..    #plt.
-0001b930: 786c 696d 2829 200d 0a0d 0a20 2020 2069  xlim() ....    i
-0001b940: 6620 7361 7665 6669 6720 6973 206e 6f74  f savefig is not
-0001b950: 2020 4e6f 6e65 3a20 0d0a 2020 2020 2020    None: ..      
-0001b960: 2020 7361 7665 6669 6775 7265 2028 6669    savefigure (fi
-0001b970: 672c 2073 6176 6566 6967 2c20 6470 6920  g, savefig, dpi 
-0001b980: 3d20 3330 3029 0d0a 2020 2020 2020 2020  = 300)..        
-0001b990: 0d0a 2020 2020 706c 742e 636c 6f73 6520  ..    plt.close 
-0001b9a0: 2829 2069 6620 7361 7665 6669 6720 6973  () if savefig is
-0001b9b0: 206e 6f74 204e 6f6e 6520 656c 7365 2070   not None else p
-0001b9c0: 6c74 2e73 686f 7728 2920 0d0a 2020 2020  lt.show() ..    
-0001b9d0: 0d0a 2020 2020 7265 7475 726e 2061 7820  ..    return ax 
-0001b9e0: 0d0a 0d0a 6465 6620 5f66 6f72 6d61 745f  ....def _format_
-0001b9f0: 7469 636b 7320 2876 616c 7565 2c20 7469  ticks (value, ti
-0001ba00: 636b 5f6e 756d 6265 722c 2066 6d74 203d  ck_number, fmt =
-0001ba10: 2753 7b3a 3032 7d27 2c20 6e73 6b69 7020  'S{:02}', nskip 
-0001ba20: 3d37 2029 3a0d 0a20 2020 2022 2222 2046  =7 ):..    """ F
-0001ba30: 6f72 6d61 7420 7468 6963 6b20 7061 7261  ormat thick para
-0001ba40: 6d65 7465 7220 7769 7468 2027 4675 6e63  meter with 'Func
-0001ba50: 466f 726d 6174 7465 7228 6675 6e63 2927  Formatter(func)'
-0001ba60: 0d0a 2020 2020 7261 7468 6572 2074 6861  ..    rather tha
-0001ba70: 6e20 7573 696e 6720 6061 7869 2e78 6178  n using `axi.xax
-0001ba80: 6973 2e73 6574 5f6d 616a 6f72 5f6c 6f63  is.set_major_loc
-0001ba90: 6174 6f72 2028 706c 742e 4d61 784e 4c6f  ator (plt.MaxNLo
-0001baa0: 6361 746f 7228 3329 2960 0d0a 2020 2020  cator(3))`..    
-0001bab0: 6178 2e78 6178 6973 2e73 6574 5f6d 616a  ax.xaxis.set_maj
-0001bac0: 6f72 5f66 6f72 6d61 7474 6572 2028 706c  or_formatter (pl
-0001bad0: 742e 4675 6e63 466f 726d 6174 7465 7228  t.FuncFormatter(
-0001bae0: 666f 726d 6174 5f74 6869 636b 7329 290d  format_thicks)).
-0001baf0: 0a20 2020 200d 0a20 2020 203a 7061 7261  .    ..    :para
-0001bb00: 6d20 7661 6c75 653a 2074 6963 6b20 7261  m value: tick ra
-0001bb10: 6e67 6520 7661 6c75 6573 2066 6f72 2066  nge values for f
-0001bb20: 6f72 6d61 7474 696e 6720 0d0a 2020 2020  ormatting ..    
-0001bb30: 3a70 6172 616d 2074 6963 6b5f 6e75 6d62  :param tick_numb
-0001bb40: 6572 3a20 6e75 6d62 6572 206f 6620 7469  er: number of ti
-0001bb50: 636b 7320 746f 2066 6f72 6d61 7420 0d0a  cks to format ..
-0001bb60: 2020 2020 3a70 6172 616d 2066 6d74 3a20      :param fmt: 
-0001bb70: 7374 722c 2064 6566 6175 6c74 3d27 537b  str, default='S{
-0001bb80: 3a30 327d 272c 206b 696e 6420 6f66 2074  :02}', kind of t
-0001bb90: 6963 6b20 666f 726d 6174 6167 6520 0d0a  ick formatage ..
-0001bba0: 2020 2020 3a70 6172 616d 206e 736b 6970      :param nskip
-0001bbb0: 3a20 696e 742c 2064 6566 6175 6c74 203d  : int, default =
-0001bbc0: 372c 206e 756d 6265 7220 6f66 2074 6963  7, number of tic
-0001bbd0: 6b20 746f 2073 6b69 7020 0d0a 2020 2020  k to skip ..    
-0001bbe0: 0d0a 2020 2020 2222 220d 0a20 2020 2069  ..    """..    i
-0001bbf0: 6620 7661 6c75 6520 2520 6e73 6b69 703d  f value % nskip=
-0001bc00: 3d30 3a20 0d0a 2020 2020 2020 2020 7265  =0: ..        re
-0001bc10: 7475 726e 2066 6d74 2e66 6f72 6d61 7428  turn fmt.format(
-0001bc20: 696e 7428 7661 6c75 6529 2b20 3129 0d0a  int(value)+ 1)..
-0001bc30: 2020 2020 656c 7365 3a20 4e6f 6e65 200d      else: None .
-0001bc40: 0a20 2020 200d 0a23 5858 5820 4f50 5449  .    ..#XXX OPTI
-0001bc50: 4d49 5a45 200d 0a64 6566 2070 6c6f 745f  MIZE ..def plot_
-0001bc60: 636f 6e66 6964 656e 6365 2028 0d0a 2020  confidence (..  
-0001bc70: 2020 6461 7461 203d 204e 6f6e 652c 200d    data = None, .
-0001bc80: 0a20 2020 202a 2c20 200d 0a20 2020 2079  .    *,  ..    y
-0001bc90: 3d4e 6f6e 652c 200d 0a20 2020 2078 3d4e  =None, ..    x=N
-0001bca0: 6f6e 652c 200d 0a20 2020 2063 6920 3d2e  one, ..    ci =.
-0001bcb0: 3935 202c 2020 0d0a 2020 2020 6b69 6e64  95 ,  ..    kind
-0001bcc0: 203d 276c 696e 6527 2c20 0d0a 2020 2020   ='line', ..    
-0001bcd0: 625f 7361 6d70 6c65 7320 3d20 3130 3030  b_samples = 1000
-0001bce0: 2c20 0d0a 2020 2020 2a2a 736e 735f 6b77  , ..    **sns_kw
-0001bcf0: 730d 0a20 2020 2029 3a20 0d0a 2020 2020  s..    ): ..    
-0001bd00: 2222 2220 506c 6f74 2063 6f6e 6669 6465  """ Plot confide
-0001bd10: 6e63 6520 6461 7461 200d 0a20 2020 200d  nce data ..    .
-0001bd20: 0a20 2020 2043 6f6e 6669 6465 6e63 6520  .    Confidence 
-0001bd30: 496e 7465 7276 616c 2028 4349 2920 2069  Interval (CI)  i
-0001bd40: 7320 6120 7479 7065 206f 6620 6573 7469  s a type of esti
-0001bd50: 6d61 7465 2063 6f6d 7075 7465 6420 6672  mate computed fr
-0001bd60: 6f6d 2074 6865 2073 7461 7469 7374 6963  om the statistic
-0001bd70: 7320 0d0a 2020 2020 6f66 2074 6865 206f  s ..    of the o
-0001bd80: 6273 6572 7665 6420 6461 7461 2077 6869  bserved data whi
-0001bd90: 6368 2067 6976 6573 2061 2072 616e 6765  ch gives a range
-0001bda0: 206f 6620 7661 6c75 6573 2074 6861 74e2   of values that.
-0001bdb0: 8099 7320 6c69 6b65 6c79 2074 6f20 0d0a  ..s likely to ..
-0001bdc0: 2020 2020 636f 6e74 6169 6e20 6120 706f      contain a po
-0001bdd0: 7075 6c61 7469 6f6e 2070 6172 616d 6574  pulation paramet
-0001bde0: 6572 2077 6974 6820 6120 7061 7274 6963  er with a partic
-0001bdf0: 756c 6172 206c 6576 656c 206f 6620 636f  ular level of co
-0001be00: 6e66 6964 656e 6365 2e0d 0a20 2020 2043  nfidence...    C
-0001be10: 4920 6173 2061 2063 6f6e 6365 7074 2077  I as a concept w
-0001be20: 6173 2070 7574 2066 6f72 7468 2062 7920  as put forth by 
-0001be30: 4a65 727a 7920 4e65 796d 616e 2069 6e20  Jerzy Neyman in 
-0001be40: 6120 7061 7065 7220 7075 626c 6973 6865  a paper publishe
-0001be50: 6420 0d0a 2020 2020 696e 2031 3933 372e  d ..    in 1937.
-0001be60: 2054 6865 7265 2061 7265 2076 6172 696f   There are vario
-0001be70: 7573 2074 7970 6573 206f 6620 7468 6520  us types of the 
-0001be80: 636f 6e66 6964 656e 6365 2069 6e74 6572  confidence inter
-0001be90: 7661 6c2c 2073 6f6d 6520 6f66 200d 0a20  val, some of .. 
-0001bea0: 2020 2074 6865 206d 6f73 7420 636f 6d6d     the most comm
-0001beb0: 6f6e 6c79 2075 7365 6420 6f6e 6573 2061  only used ones a
-0001bec0: 7265 3a20 4349 2066 6f72 206d 6561 6e2c  re: CI for mean,
-0001bed0: 2043 4920 666f 7220 7468 6520 6d65 6469   CI for the medi
-0001bee0: 616e 2c20 4349 2066 6f72 200d 0a20 2020  an, CI for ..   
-0001bef0: 2074 6865 2064 6966 6665 7265 6e63 6520   the difference 
-0001bf00: 6265 7477 6565 6e20 6d65 616e 732c 2043  between means, C
-0001bf10: 4920 666f 7220 6120 7072 6f70 6f72 7469  I for a proporti
-0001bf20: 6f6e 2061 6e64 2043 4920 666f 7220 7468  on and CI for th
-0001bf30: 6520 6469 6666 6572 656e 6365 200d 0a20  e difference .. 
-0001bf40: 2020 2069 6e20 7072 6f70 6f72 7469 6f6e     in proportion
-0001bf50: 732e 0d0a 2020 2020 0d0a 2020 2020 5061  s...    ..    Pa
-0001bf60: 7261 6d65 7465 7273 200d 0a20 2020 202d  rameters ..    -
-0001bf70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
-0001bf80: 2064 6174 613a 2070 616e 6461 732e 4461   data: pandas.Da
-0001bf90: 7461 4672 616d 652c 206e 756d 7079 2e6e  taFrame, numpy.n
-0001bfa0: 6461 7272 6179 2c20 6d61 7070 696e 672c  darray, mapping,
-0001bfb0: 206f 7220 7365 7175 656e 6365 0d0a 2020   or sequence..  
-0001bfc0: 2020 2020 2049 6e70 7574 2064 6174 6120       Input data 
-0001bfd0: 7374 7275 6374 7572 652e 2045 6974 6865  structure. Eithe
-0001bfe0: 7220 6120 6c6f 6e67 2d66 6f72 6d20 636f  r a long-form co
-0001bff0: 6c6c 6563 7469 6f6e 206f 6620 7665 6374  llection of vect
-0001c000: 6f72 7320 0d0a 2020 2020 2020 2074 6861  ors ..       tha
-0001c010: 7420 6361 6e20 6265 2061 7373 6967 6e65  t can be assigne
-0001c020: 6420 746f 206e 616d 6564 2076 6172 6961  d to named varia
-0001c030: 626c 6573 206f 7220 6120 7769 6465 2d66  bles or a wide-f
-0001c040: 6f72 6d20 6461 7461 7365 7420 0d0a 2020  orm dataset ..  
-0001c050: 2020 2020 2074 6861 7420 7769 6c6c 2062       that will b
-0001c060: 6520 696e 7465 726e 616c 6c79 2072 6573  e internally res
-0001c070: 6861 7065 642e 0d0a 0d0a 2020 2020 782c  haped.....    x,
-0001c080: 2079 3a20 7665 6374 6f72 7320 6f72 206b   y: vectors or k
-0001c090: 6579 7320 696e 2064 6174 610d 0a20 2020  eys in data..   
-0001c0a0: 2020 2020 5661 7269 6162 6c65 7320 7468      Variables th
-0001c0b0: 6174 2073 7065 6369 6679 2070 6f73 6974  at specify posit
-0001c0c0: 696f 6e73 206f 6e20 7468 6520 7820 616e  ions on the x an
-0001c0d0: 6420 7920 6178 6573 2e0d 0a20 2020 2020  d y axes...     
-0001c0e0: 2020 0d0a 2020 2020 6369 3a20 666c 6f61    ..    ci: floa
-0001c0f0: 742c 2064 6566 6175 6c74 3d2e 3935 200d  t, default=.95 .
-0001c100: 0a20 2020 2020 2020 436f 6e66 6964 656e  .       Confiden
-0001c110: 6365 2076 616c 7565 2e20 0d0a 2020 2020  ce value. ..    
-0001c120: 2020 200d 0a20 2020 206b 696e 643a 2073     ..    kind: s
-0001c130: 7472 2c20 6465 6661 756c 743d 276c 696e  tr, default='lin
-0001c140: 6527 200d 0a20 2020 2020 2020 6b69 6e64  e' ..       kind
-0001c150: 206f 6620 636f 6e66 6964 656e 6365 2069   of confidence i
-0001c160: 6e74 6572 7676 616c 2070 6c6f 742e 200d  ntervval plot. .
-0001c170: 0a20 2020 2020 200d 0a20 2020 2062 5f73  .      ..    b_s
-0001c180: 616d 706c 6573 3a20 696e 742c 2064 6566  amples: int, def
-0001c190: 6175 6c74 3d31 3030 300d 0a20 2020 2020  ault=1000..     
-0001c1a0: 2020 204e 756d 6265 7220 6f66 2062 6f6f     Number of boo
-0001c1b0: 7473 7472 6170 7320 746f 2075 7365 2066  tstraps to use f
-0001c1c0: 6f72 2063 6f6d 7075 7469 6e67 2074 6865  or computing the
-0001c1d0: 2063 6f6e 6669 6465 6e63 6520 696e 7465   confidence inte
-0001c1e0: 7276 616c 2e0d 0a20 2020 2020 2020 200d  rval...        .
-0001c1f0: 0a20 2020 2073 6e73 5f6b 7773 3a20 6469  .    sns_kws: di
-0001c200: 6374 2c20 0d0a 2020 2020 2020 204b 6579  ct, ..       Key
-0001c210: 776f 7264 7320 6172 6775 6d65 6e74 7320  words arguments 
-0001c220: 7061 7373 6564 2074 6f20 7468 6520 6073  passed to the `s
-0001c230: 6e73 2e6c 696e 6570 6c6f 7460 206f 7220  ns.lineplot` or 
-0001c240: 6073 6e73 2e72 6567 706c 6f74 600d 0a20  `sns.regplot`.. 
-0001c250: 2020 2020 2020 0d0a 2020 2020 5265 7475        ..    Retu
-0001c260: 726e 7320 0d0a 2020 2020 2d2d 2d2d 2d2d  rns ..    ------
-0001c270: 2d2d 2d2d 0d0a 2020 2020 6178 3a20 6d61  ----..    ax: ma
-0001c280: 7470 6c6f 746c 6962 2e61 7865 732e 4178  tplotlib.axes.Ax
-0001c290: 6573 0d0a 2020 2020 2020 2054 6865 206d  es..       The m
-0001c2a0: 6174 706c 6f74 6c69 6220 6178 6573 2063  atplotlib axes c
-0001c2b0: 6f6e 7461 696e 696e 6720 7468 6520 706c  ontaining the pl
-0001c2c0: 6f74 2e0d 0a20 2020 2020 2020 0d0a 2020  ot...       ..  
-0001c2d0: 2020 2222 2220 2020 0d0a 2020 2020 2379    """   ..    #y
-0001c2e0: 203d 206e 702e 6172 7261 7920 2879 2920   = np.array (y) 
-0001c2f0: 0d0a 2020 2020 2378 3d20 7820 6f72 2028  ..    #x= x or (
-0001c300: 206e 702e 6172 616e 6765 2028 6c65 6e28   np.arange (len(
-0001c310: 7929 2920 6966 200d 0a20 2020 2061 783d  y)) if ..    ax=
-0001c320: 4e6f 6e65 200d 0a20 2020 2069 6620 276c  None ..    if 'l
-0001c330: 696e 2720 696e 2073 7472 286b 696e 6429  in' in str(kind)
-0001c340: 2e6c 6f77 6572 2829 3a20 0d0a 2020 2020  .lower(): ..    
-0001c350: 2020 2020 6178 203d 2073 6e73 2e6c 696e      ax = sns.lin
-0001c360: 6570 6c6f 7428 6461 7461 3d20 6461 7461  eplot(data= data
-0001c370: 2c20 783d 782c 2079 3d79 2c20 6369 3d63  , x=x, y=y, ci=c
-0001c380: 692c 202a 2a73 6e73 5f6b 7773 290d 0a20  i, **sns_kws).. 
-0001c390: 2020 2065 6c69 6620 2772 6567 2720 696e     elif 'reg' in
-0001c3a0: 2020 7374 7228 6b69 6e64 292e 6c6f 7765    str(kind).lowe
-0001c3b0: 7228 293a 200d 0a20 2020 2020 2020 2061  r(): ..        a
-0001c3c0: 7820 3d20 736e 732e 7265 6770 6c6f 7428  x = sns.regplot(
-0001c3d0: 6461 7461 203d 2064 6174 612c 2078 3d78  data = data, x=x
-0001c3e0: 2c20 793d 792c 2063 693d 6369 2c20 2a2a  , y=y, ci=ci, **
-0001c3f0: 736e 735f 6b77 7320 2920 0d0a 2020 2020  sns_kws ) ..    
-0001c400: 656c 7365 3a20 0d0a 2020 2020 2020 2020  else: ..        
-0001c410: 6966 206e 6f74 2079 3a20 0d0a 2020 2020  if not y: ..    
-0001c420: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0001c430: 6c75 6545 7272 6f72 2822 7920 7368 6f75  lueError("y shou
-0001c440: 6c64 206e 6f74 2062 6520 4e6f 6e65 2077  ld not be None w
-0001c450: 6865 6e20 7573 696e 6720 7468 6520 626f  hen using the bo
-0001c460: 6f73 7472 6170 7069 6e67 220d 0a20 2020  ostrapping"..   
-0001c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c480: 2020 2020 2020 2020 2020 2220 666f 7220            " for 
-0001c490: 706c 6f74 7469 6e67 2074 6865 2063 6f6e  plotting the con
-0001c4a0: 6669 6465 6e63 6520 696e 7465 7276 616c  fidence interval
-0001c4b0: 2e22 290d 0a20 2020 2020 2020 2062 5f73  .")..        b_s
-0001c4c0: 616d 706c 6573 203d 205f 6173 7365 7274  amples = _assert
-0001c4d0: 5f61 6c6c 5f74 7970 6573 280d 0a20 2020  _all_types(..   
-0001c4e0: 2020 2020 2020 2020 2062 5f73 616d 706c           b_sampl
-0001c4f0: 6573 2c20 696e 742c 2066 6c6f 6174 2c20  es, int, float, 
-0001c500: 6f62 6a6e 616d 653d 2242 6f6f 7473 7472  objname="Bootstr
-0001c510: 6170 2073 616d 706c 6573 2060 625f 7361  ap samples `b_sa
-0001c520: 6d70 6c65 7360 2229 0d0a 2020 2020 2020  mples`")..      
-0001c530: 2020 0d0a 2020 2020 2020 2020 6672 6f6d    ..        from
-0001c540: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
-0001c550: 2069 6d70 6f72 7420 7265 7361 6d70 6c65   import resample
-0001c560: 200d 0a20 2020 2020 2020 2023 2063 6f6e   ..        # con
-0001c570: 6669 6775 7265 2062 6f6f 7473 7472 6170  figure bootstrap
-0001c580: 0d0a 2020 2020 2020 2020 6e5f 6974 6572  ..        n_iter
-0001c590: 6174 696f 6e73 203d 2031 3030 3020 2320  ations = 1000 # 
-0001c5a0: 6865 7265 206b 3d6e 6f2e 206f 6620 626f  here k=no. of bo
-0001c5b0: 6f74 7374 7261 7070 6564 2073 616d 706c  otstrapped sampl
-0001c5c0: 6573 0d0a 2020 2020 2020 2020 6e5f 7369  es..        n_si
-0001c5d0: 7a65 203d 2069 6e74 286c 656e 2879 2929  ze = int(len(y))
-0001c5e0: 0d0a 2020 2020 2020 2020 2020 0d0a 2020  ..          ..  
-0001c5f0: 2020 2020 2020 2320 7275 6e20 626f 6f74        # run boot
-0001c600: 7374 7261 700d 0a20 2020 2020 2020 206d  strap..        m
-0001c610: 6564 6961 6e73 203d 206c 6973 7428 290d  edians = list().
-0001c620: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-0001c630: 6e20 7261 6e67 6528 6e5f 6974 6572 6174  n range(n_iterat
-0001c640: 696f 6e73 293a 0d0a 2020 2020 2020 2020  ions):..        
-0001c650: 2020 2073 203d 2072 6573 616d 706c 6528     s = resample(
-0001c660: 792c 206e 5f73 616d 706c 6573 3d6e 5f73  y, n_samples=n_s
-0001c670: 697a 6529 3b0d 0a20 2020 2020 2020 2020  ize);..         
-0001c680: 2020 6d20 3d20 6e70 2e6d 6564 6961 6e28    m = np.median(
-0001c690: 7329 3b0d 0a20 2020 2020 2020 2020 2020  s);..           
-0001c6a0: 6d65 6469 616e 732e 6170 7065 6e64 286d  medians.append(m
-0001c6b0: 290d 0a20 2020 2020 2020 2020 200d 0a20  )..          .. 
-0001c6c0: 2020 2020 2020 2023 2070 6c6f 7420 7363         # plot sc
-0001c6d0: 6f72 6573 0d0a 2020 2020 2020 2020 706c  ores..        pl
-0001c6e0: 742e 6869 7374 286d 6564 6961 6e73 290d  t.hist(medians).
-0001c6f0: 0a20 2020 2020 2020 2070 6c74 2e73 686f  .        plt.sho
-0001c700: 7728 290d 0a20 2020 2020 2020 2020 200d  w()..          .
-0001c710: 0a20 2020 2020 2020 2023 2063 6f6e 6669  .        # confi
-0001c720: 6465 6e63 6520 696e 7465 7276 616c 730d  dence intervals.
-0001c730: 0a20 2020 2020 2020 2070 203d 2028 2831  .        p = ((1
-0001c740: 2e30 2d63 6929 2f32 2e30 2920 2a20 3130  .0-ci)/2.0) * 10
-0001c750: 300d 0a20 2020 2020 2020 206c 6f77 6572  0..        lower
-0001c760: 203d 2020 6e70 2e70 6572 6365 6e74 696c   =  np.percentil
-0001c770: 6528 6d65 6469 616e 732c 2070 290d 0a20  e(medians, p).. 
-0001c780: 2020 2020 2020 2070 203d 2028 6369 2b28         p = (ci+(
-0001c790: 2831 2e30 2d63 6929 2f32 2e30 2929 202a  (1.0-ci)/2.0)) *
-0001c7a0: 2031 3030 0d0a 2020 2020 2020 2020 7570   100..        up
-0001c7b0: 7065 7220 3d20 206e 702e 7065 7263 656e  per =  np.percen
-0001c7c0: 7469 6c65 286d 6564 6961 6e73 2c20 7029  tile(medians, p)
-0001c7d0: 0d0a 2020 0d0a 2020 2020 2020 2020 7072  ..  ..        pr
-0001c7e0: 696e 7428 6622 5c6e 7b63 692a 3130 307d  int(f"\n{ci*100}
-0001c7f0: 2063 6f6e 6669 6465 6e63 6520 696e 7465   confidence inte
-0001c800: 7276 616c 207b 6c6f 7765 727d 2061 6e64  rval {lower} and
-0001c810: 207b 7570 7065 727d 2229 0d0a 2020 2020   {upper}")..    
-0001c820: 0d0a 2020 2020 7265 7475 726e 2061 7820  ..    return ax 
-0001c830: 0d0a 0d0a 6465 6620 706c 6f74 5f63 6f6e  ....def plot_con
-0001c840: 6669 6465 6e63 655f 656c 6c69 7073 6520  fidence_ellipse 
-0001c850: 2878 2c20 7920 293a 200d 0a20 2020 2022  (x, y ): ..    "
-0001c860: 2222 2050 6c6f 7420 6120 636f 6e66 6964  "" Plot a confid
-0001c870: 656e 6365 2065 6c6c 6970 7365 206f 6620  ence ellipse of 
-0001c880: 6120 7477 6f2d 6469 6d65 6e73 696f 6e61  a two-dimensiona
-0001c890: 6c20 6461 7461 7365 7420 0d0a 2020 2020  l dataset ..    
-0001c8a0: 0d0a 2020 2020 5468 6973 2066 756e 6374  ..    This funct
-0001c8b0: 696f 6e20 706c 6f74 7320 7468 6520 636f  ion plots the co
-0001c8c0: 6e66 6964 656e 6365 2065 6c6c 6970 7365  nfidence ellipse
-0001c8d0: 206f 6620 7468 6520 636f 7661 7269 616e   of the covarian
-0001c8e0: 6365 206f 6620 0d0a 2020 2020 7468 6520  ce of ..    the 
-0001c8f0: 6769 7665 6e20 6172 7261 792d 6c69 6b65  given array-like
-0001c900: 2076 6172 6961 626c 6573 2078 2061 6e64   variables x and
-0001c910: 2079 2e20 5468 6520 656c 6c69 7073 6520   y. The ellipse 
-0001c920: 6973 2070 6c6f 7474 6564 200d 0a20 2020  is plotted ..   
-0001c930: 2069 6e74 6f20 7468 6520 6769 7665 6e20   into the given 
-0001c940: 6178 6573 2d6f 626a 6563 7420 6178 2e0d  axes-object ax..
-0001c950: 0a20 2020 200d 0a20 2020 2054 6865 2061  .    ..    The a
-0001c960: 7070 726f 6163 6820 7468 6174 2069 7320  pproach that is 
-0001c970: 7573 6564 2074 6f20 6f62 7461 696e 2074  used to obtain t
-0001c980: 6865 2063 6f72 7265 6374 2067 656f 6d65  he correct geome
-0001c990: 7472 7920 0d0a 2020 2020 6973 2065 7870  try ..    is exp
-0001c9a0: 6c61 696e 6564 2061 6e64 2070 726f 7665  lained and prove
-0001c9b0: 6420 6865 7265 3a0d 0a20 2020 2020 2068  d here:..      h
-0001c9c0: 7474 7073 3a2f 2f63 6172 7374 656e 7363  ttps://carstensc
-0001c9d0: 6865 6c70 2e67 6974 6875 622e 696f 2f32  help.github.io/2
-0001c9e0: 3031 382f 3039 2f31 342f 506c 6f74 5f43  018/09/14/Plot_C
-0001c9f0: 6f6e 6669 6465 6e63 655f 456c 6c69 7073  onfidence_Ellips
-0001ca00: 655f 3030 312e 6874 6d6c 0d0a 2020 2020  e_001.html..    
-0001ca10: 2020 0d0a 2020 2020 5468 6520 6d65 7468    ..    The meth
-0001ca20: 6f64 2061 766f 6964 7320 7468 6520 7573  od avoids the us
-0001ca30: 6520 6f66 2061 6e20 6974 6572 6174 6976  e of an iterativ
-0001ca40: 6520 6569 6765 6e20 6465 636f 6d70 6f73  e eigen decompos
-0001ca50: 6974 696f 6e20 0d0a 2020 2020 616c 676f  ition ..    algo
-0001ca60: 7269 7468 6d20 616e 6420 6d61 6b65 7320  rithm and makes 
-0001ca70: 7573 6520 6f66 2074 6865 2066 6163 7420  use of the fact 
-0001ca80: 7468 6174 2061 206e 6f72 6d61 6c69 7a65  that a normalize
-0001ca90: 6420 636f 7661 7269 616e 6365 200d 0a20  d covariance .. 
-0001caa0: 2020 206d 6174 7269 7820 2863 6f6d 706f     matrix (compo
-0001cab0: 7365 6420 6f66 2070 6561 7273 6f6e 2063  sed of pearson c
-0001cac0: 6f72 7265 6c61 7469 6f6e 2063 6f65 6666  orrelation coeff
-0001cad0: 6963 6965 6e74 7320 616e 6420 6f6e 6573  icients and ones
-0001cae0: 2920 6973 200d 0a20 2020 2070 6172 7469  ) is ..    parti
-0001caf0: 6375 6c61 726c 7920 6561 7379 2074 6f20  cularly easy to 
-0001cb00: 6861 6e64 6c65 2e0d 0a20 2020 200d 0a20  handle...    .. 
-0001cb10: 2020 2022 2222 0d0a 2020 2020 6669 672c     """..    fig,
-0001cb20: 2061 785f 6e73 7464 203d 2070 6c74 2e73   ax_nstd = plt.s
-0001cb30: 7562 706c 6f74 7328 6669 6773 697a 653d  ubplots(figsize=
-0001cb40: 2836 2c20 3629 290d 0a20 2020 2023 2064  (6, 6))..    # d
-0001cb50: 6570 656e 6465 6e63 795f 6e73 7464 203d  ependency_nstd =
-0001cb60: 205b 5b30 2e38 2c20 302e 3735 5d2c 0d0a   [[0.8, 0.75],..
-0001cb70: 2020 2020 2320 2020 2020 2020 2020 2020      #           
-0001cb80: 2020 2020 2020 2020 205b 2d30 2e32 2c20           [-0.2, 
-0001cb90: 302e 3335 5d5d 0d0a 2020 2020 6d75 203d  0.35]]..    mu =
-0001cba0: 2030 2c20 300d 0a20 2020 2023 2073 6361   0, 0..    # sca
-0001cbb0: 6c65 203d 2038 2c20 350d 0a20 2020 2061  le = 8, 5..    a
-0001cbc0: 785f 6e73 7464 2e61 7876 6c69 6e65 2863  x_nstd.axvline(c
-0001cbd0: 3d27 6772 6579 272c 206c 773d 3129 0d0a  ='grey', lw=1)..
-0001cbe0: 2020 2020 6178 5f6e 7374 642e 6178 686c      ax_nstd.axhl
-0001cbf0: 696e 6528 633d 2767 7265 7927 2c20 6c77  ine(c='grey', lw
-0001cc00: 3d31 290d 0a20 2020 200d 0a20 2020 2023  =1)..    ..    #
-0001cc10: 782c 2079 203d 2067 6574 5f63 6f72 7265  x, y = get_corre
-0001cc20: 6c61 7465 645f 6461 7461 7365 7428 3530  lated_dataset(50
-0001cc30: 302c 2064 6570 656e 6465 6e63 795f 6e73  0, dependency_ns
-0001cc40: 7464 2c20 6d75 2c20 7363 616c 6529 0d0a  td, mu, scale)..
-0001cc50: 2020 2020 6178 5f6e 7374 642e 7363 6174      ax_nstd.scat
-0001cc60: 7465 7228 782c 2079 2c20 733d 302e 3529  ter(x, y, s=0.5)
-0001cc70: 0d0a 2020 2020 0d0a 2020 2020 636f 6e66  ..    ..    conf
-0001cc80: 6964 656e 6365 5f65 6c6c 6970 7365 2878  idence_ellipse(x
-0001cc90: 2c20 792c 2061 785f 6e73 7464 2c20 6e5f  , y, ax_nstd, n_
-0001cca0: 7374 643d 312c 0d0a 2020 2020 2020 2020  std=1,..        
-0001ccb0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0001ccc0: 6162 656c 3d72 2724 315c 7369 676d 6124  abel=r'$1\sigma$
-0001ccd0: 272c 2065 6467 6563 6f6c 6f72 3d27 6669  ', edgecolor='fi
-0001cce0: 7265 6272 6963 6b27 290d 0a20 2020 2063  rebrick')..    c
-0001ccf0: 6f6e 6669 6465 6e63 655f 656c 6c69 7073  onfidence_ellips
-0001cd00: 6528 782c 2079 2c20 6178 5f6e 7374 642c  e(x, y, ax_nstd,
-0001cd10: 206e 5f73 7464 3d32 2c0d 0a20 2020 2020   n_std=2,..     
-0001cd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd30: 2020 6c61 6265 6c3d 7227 2432 5c73 6967    label=r'$2\sig
-0001cd40: 6d61 2427 2c20 6564 6765 636f 6c6f 723d  ma$', edgecolor=
-0001cd50: 2766 7563 6873 6961 272c 0d0a 2020 2020  'fuchsia',..    
-0001cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd70: 2020 206c 696e 6573 7479 6c65 3d27 2d2d     linestyle='--
-0001cd80: 2729 0d0a 2020 2020 636f 6e66 6964 656e  ')..    confiden
-0001cd90: 6365 5f65 6c6c 6970 7365 2878 2c20 792c  ce_ellipse(x, y,
-0001cda0: 2061 785f 6e73 7464 2c20 6e5f 7374 643d   ax_nstd, n_std=
-0001cdb0: 332c 0d0a 2020 2020 2020 2020 2020 2020  3,..            
-0001cdc0: 2020 2020 2020 2020 2020 206c 6162 656c             label
-0001cdd0: 3d72 2724 335c 7369 676d 6124 272c 2065  =r'$3\sigma$', e
-0001cde0: 6467 6563 6f6c 6f72 3d27 626c 7565 272c  dgecolor='blue',
-0001cdf0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0001ce00: 2020 2020 2020 2020 2020 6c69 6e65 7374            linest
-0001ce10: 796c 653d 273a 2729 0d0a 2020 2020 0d0a  yle=':')..    ..
-0001ce20: 2020 2020 6178 5f6e 7374 642e 7363 6174      ax_nstd.scat
-0001ce30: 7465 7228 6d75 5b30 5d2c 206d 755b 315d  ter(mu[0], mu[1]
-0001ce40: 2c20 633d 2772 6564 272c 2073 3d33 290d  , c='red', s=3).
-0001ce50: 0a20 2020 2061 785f 6e73 7464 2e73 6574  .    ax_nstd.set
-0001ce60: 5f74 6974 6c65 2827 4469 6666 6572 656e  _title('Differen
-0001ce70: 7420 7374 616e 6461 7264 2064 6576 6961  t standard devia
-0001ce80: 7469 6f6e 7327 290d 0a20 2020 2061 785f  tions')..    ax_
-0001ce90: 6e73 7464 2e6c 6567 656e 6428 290d 0a20  nstd.legend().. 
-0001cea0: 2020 2070 6c74 2e73 686f 7728 290d 0a20     plt.show().. 
-0001ceb0: 2020 200d 0a64 6566 2063 6f6e 6669 6465     ..def confide
-0001cec0: 6e63 655f 656c 6c69 7073 6528 0d0a 2020  nce_ellipse(..  
-0001ced0: 2020 782c 200d 0a20 2020 2079 2c20 0d0a    x, ..    y, ..
-0001cee0: 2020 2020 6178 2c20 0d0a 2020 2020 6e5f      ax, ..    n_
-0001cef0: 7374 643d 332e 302c 200d 0a20 2020 2066  std=3.0, ..    f
-0001cf00: 6163 6563 6f6c 6f72 3d27 6e6f 6e65 272c  acecolor='none',
-0001cf10: 200d 0a20 2020 202a 2a6b 7761 7267 730d   ..    **kwargs.
-0001cf20: 0a20 2020 2029 3a0d 0a20 2020 2022 2222  .    ):..    """
-0001cf30: 0d0a 2020 2020 4372 6561 7465 2061 2070  ..    Create a p
-0001cf40: 6c6f 7420 6f66 2074 6865 2063 6f76 6172  lot of the covar
-0001cf50: 6961 6e63 6520 636f 6e66 6964 656e 6365  iance confidence
-0001cf60: 2065 6c6c 6970 7365 206f 6620 2a78 2a20   ellipse of *x* 
-0001cf70: 616e 6420 2a79 2a2e 0d0a 0d0a 2020 2020  and *y*.....    
-0001cf80: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
-0001cf90: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-0001cfa0: 782c 2079 203a 2061 7272 6179 2d6c 696b  x, y : array-lik
-0001cfb0: 652c 2073 6861 7065 2028 6e2c 2029 0d0a  e, shape (n, )..
-0001cfc0: 2020 2020 2020 2020 496e 7075 7420 6461          Input da
-0001cfd0: 7461 2e0d 0a0d 0a20 2020 2061 7820 3a20  ta.....    ax : 
-0001cfe0: 6d61 7470 6c6f 746c 6962 2e61 7865 732e  matplotlib.axes.
-0001cff0: 4178 6573 0d0a 2020 2020 2020 2020 5468  Axes..        Th
-0001d000: 6520 6178 6573 206f 626a 6563 7420 746f  e axes object to
-0001d010: 2064 7261 7720 7468 6520 656c 6c69 7073   draw the ellips
-0001d020: 6520 696e 746f 2e0d 0a0d 0a20 2020 206e  e into.....    n
-0001d030: 5f73 7464 203a 2066 6c6f 6174 0d0a 2020  _std : float..  
-0001d040: 2020 2020 2020 5468 6520 6e75 6d62 6572        The number
-0001d050: 206f 6620 7374 616e 6461 7264 2064 6576   of standard dev
-0001d060: 6961 7469 6f6e 7320 746f 2064 6574 6572  iations to deter
-0001d070: 6d69 6e65 2074 6865 2065 6c6c 6970 7365  mine the ellipse
-0001d080: 2773 2072 6164 6975 7365 732e 0d0a 0d0a  's radiuses.....
-0001d090: 2020 2020 2a2a 6b77 6172 6773 0d0a 2020      **kwargs..  
-0001d0a0: 2020 2020 2020 466f 7277 6172 6465 6420        Forwarded 
-0001d0b0: 746f 2060 7e6d 6174 706c 6f74 6c69 622e  to `~matplotlib.
-0001d0c0: 7061 7463 6865 732e 456c 6c69 7073 6560  patches.Ellipse`
-0001d0d0: 0d0a 0d0a 2020 2020 5265 7475 726e 730d  ....    Returns.
-0001d0e0: 0a20 2020 202d 2d2d 2d2d 2d2d 0d0a 2020  .    -------..  
-0001d0f0: 2020 6d70 6c2e 7061 7463 6865 732e 456c    mpl.patches.El
-0001d100: 6c69 7073 650d 0a20 2020 2022 2222 0d0a  lipse..    """..
-0001d110: 2020 2020 6966 2078 2e73 697a 6520 213d      if x.size !=
-0001d120: 2079 2e73 697a 653a 0d0a 2020 2020 2020   y.size:..      
-0001d130: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0001d140: 6f72 2822 7820 616e 6420 7920 6d75 7374  or("x and y must
-0001d150: 2062 6520 7468 6520 7361 6d65 2073 697a   be the same siz
-0001d160: 6522 290d 0a0d 0a20 2020 2063 6f76 203d  e")....    cov =
-0001d170: 206e 702e 636f 7628 782c 2079 290d 0a20   np.cov(x, y).. 
-0001d180: 2020 2070 6561 7273 6f6e 203d 2063 6f76     pearson = cov
-0001d190: 5b30 2c20 315d 2f6e 702e 7371 7274 2863  [0, 1]/np.sqrt(c
-0001d1a0: 6f76 5b30 2c20 305d 202a 2063 6f76 5b31  ov[0, 0] * cov[1
-0001d1b0: 2c20 315d 290d 0a20 2020 2023 2055 7369  , 1])..    # Usi
-0001d1c0: 6e67 2061 2073 7065 6369 616c 2063 6173  ng a special cas
-0001d1d0: 6520 746f 206f 6274 6169 6e20 7468 6520  e to obtain the 
-0001d1e0: 6569 6765 6e76 616c 7565 7320 6f66 2074  eigenvalues of t
-0001d1f0: 6869 730d 0a20 2020 2023 2074 776f 2d64  his..    # two-d
-0001d200: 696d 656e 7369 6f6e 616c 2064 6174 6173  imensional datas
-0001d210: 6574 2e0d 0a20 2020 2065 6c6c 5f72 6164  et...    ell_rad
-0001d220: 6975 735f 7820 3d20 6e70 2e73 7172 7428  ius_x = np.sqrt(
-0001d230: 3120 2b20 7065 6172 736f 6e29 0d0a 2020  1 + pearson)..  
-0001d240: 2020 656c 6c5f 7261 6469 7573 5f79 203d    ell_radius_y =
-0001d250: 206e 702e 7371 7274 2831 202d 2070 6561   np.sqrt(1 - pea
-0001d260: 7273 6f6e 290d 0a20 2020 2065 6c6c 6970  rson)..    ellip
-0001d270: 7365 203d 2045 6c6c 6970 7365 2828 302c  se = Ellipse((0,
-0001d280: 2030 292c 2077 6964 7468 3d65 6c6c 5f72   0), width=ell_r
-0001d290: 6164 6975 735f 7820 2a20 322c 2068 6569  adius_x * 2, hei
-0001d2a0: 6768 743d 656c 6c5f 7261 6469 7573 5f79  ght=ell_radius_y
-0001d2b0: 202a 2032 2c0d 0a20 2020 2020 2020 2020   * 2,..         
-0001d2c0: 2020 2020 2020 2020 2020 2020 2066 6163               fac
-0001d2d0: 6563 6f6c 6f72 3d66 6163 6563 6f6c 6f72  ecolor=facecolor
-0001d2e0: 2c20 2a2a 6b77 6172 6773 290d 0a0d 0a20  , **kwargs).... 
-0001d2f0: 2020 2023 2043 616c 6375 6c61 7469 6e67     # Calculating
-0001d300: 2074 6865 2073 7461 6e64 6172 6420 6465   the standard de
-0001d310: 7669 6174 696f 6e20 6f66 2078 2066 726f  viation of x fro
-0001d320: 6d0d 0a20 2020 2023 2074 6865 2073 7175  m..    # the squ
-0001d330: 6172 6572 6f6f 7420 6f66 2074 6865 2076  areroot of the v
-0001d340: 6172 6961 6e63 6520 616e 6420 6d75 6c74  ariance and mult
-0001d350: 6970 6c79 696e 670d 0a20 2020 2023 2077  iplying..    # w
-0001d360: 6974 6820 7468 6520 6769 7665 6e20 6e75  ith the given nu
-0001d370: 6d62 6572 206f 6620 7374 616e 6461 7264  mber of standard
-0001d380: 2064 6576 6961 7469 6f6e 732e 0d0a 2020   deviations...  
-0001d390: 2020 7363 616c 655f 7820 3d20 6e70 2e73    scale_x = np.s
-0001d3a0: 7172 7428 636f 765b 302c 2030 5d29 202a  qrt(cov[0, 0]) *
-0001d3b0: 206e 5f73 7464 0d0a 2020 2020 6d65 616e   n_std..    mean
-0001d3c0: 5f78 203d 206e 702e 6d65 616e 2878 290d  _x = np.mean(x).
-0001d3d0: 0a0d 0a20 2020 2023 2063 616c 6375 6c61  ...    # calcula
-0001d3e0: 7469 6e67 2074 6865 2073 7461 6e64 6172  ting the standar
-0001d3f0: 6420 6465 7669 6174 696f 6e20 6f66 2079  d deviation of y
-0001d400: 202e 2e2e 0d0a 2020 2020 7363 616c 655f   .....    scale_
-0001d410: 7920 3d20 6e70 2e73 7172 7428 636f 765b  y = np.sqrt(cov[
-0001d420: 312c 2031 5d29 202a 206e 5f73 7464 0d0a  1, 1]) * n_std..
-0001d430: 2020 2020 6d65 616e 5f79 203d 206e 702e      mean_y = np.
-0001d440: 6d65 616e 2879 290d 0a0d 0a20 2020 2074  mean(y)....    t
-0001d450: 7261 6e73 6620 3d20 7472 616e 7366 6f72  ransf = transfor
-0001d460: 6d73 2e41 6666 696e 6532 4428 2920 5c0d  ms.Affine2D() \.
-0001d470: 0a20 2020 2020 2020 202e 726f 7461 7465  .        .rotate
-0001d480: 5f64 6567 2834 3529 205c 0d0a 2020 2020  _deg(45) \..    
-0001d490: 2020 2020 2e73 6361 6c65 2873 6361 6c65      .scale(scale
-0001d4a0: 5f78 2c20 7363 616c 655f 7929 205c 0d0a  _x, scale_y) \..
-0001d4b0: 2020 2020 2020 2020 2e74 7261 6e73 6c61          .transla
-0001d4c0: 7465 286d 6561 6e5f 782c 206d 6561 6e5f  te(mean_x, mean_
-0001d4d0: 7929 0d0a 0d0a 2020 2020 656c 6c69 7073  y)....    ellips
-0001d4e0: 652e 7365 745f 7472 616e 7366 6f72 6d28  e.set_transform(
-0001d4f0: 7472 616e 7366 202b 2061 782e 7472 616e  transf + ax.tran
-0001d500: 7344 6174 6129 0d0a 2020 2020 7265 7475  sData)..    retu
-0001d510: 726e 2061 782e 6164 645f 7061 7463 6828  rn ax.add_patch(
-0001d520: 656c 6c69 7073 6529 2020 0d0a 2020 200d  ellipse)  ..   .
-0001d530: 0a64 6566 2070 6c6f 745f 7374 7269 6b65  .def plot_strike
-0001d540: 2028 0d0a 2020 2020 6c69 7374 5f6f 665f   (..    list_of_
-0001d550: 6564 6973 2c20 2f2c 200d 0a20 2020 206b  edis, /, ..    k
-0001d560: 696e 6420 3d20 322c 0d0a 2020 2020 7065  ind = 2,..    pe
-0001d570: 7269 6f64 5f74 6f6c 6572 616e 6365 3d2e  riod_tolerance=.
-0001d580: 3035 2c20 0d0a 2020 2020 7465 7874 5f70  05, ..    text_p
-0001d590: 6164 203d 312e 3635 202c 200d 0a20 2020  ad =1.65 , ..   
-0001d5a0: 2072 6f74 5f7a 3d30 2e20 2c20 0d0a 2020   rot_z=0. , ..  
-0001d5b0: 2020 2a2a 6b77 730d 0a20 2020 2029 3a20    **kws..    ): 
-0001d5c0: 0d0a 2020 2020 0d0a 2020 2020 6578 7472  ..    ..    extr
-0001d5d0: 6120 3d28 2250 6c6f 7453 7472 696b 6520  a =("PlotStrike 
-0001d5e0: 7573 6573 2027 6d74 7079 2720 6f72 2027  uses 'mtpy' or '
-0001d5f0: 7079 6373 616d 7427 2061 7320 6465 7065  pycsamt' as depe
-0001d600: 6e64 656e 6379 2e22 0d0a 2020 2020 2020  ndency."..      
-0001d610: 2020 2020 2020 290d 0a20 2020 2069 6d70        )..    imp
-0001d620: 6f72 745f 6f70 7469 6f6e 616c 5f64 6570  ort_optional_dep
-0001d630: 656e 6465 6e63 7920 2827 6d74 7079 272c  endency ('mtpy',
-0001d640: 2065 7874 7261 203d 2065 7874 7261 2029   extra = extra )
-0001d650: 0d0a 2020 2020 2378 7878 7878 7878 7878  ..    #xxxxxxxxx
+0001b210: 2920 0d0a 2020 2020 2222 220d 0a20 2020  ) ..    """..   
+0001b220: 2069 6620 7374 796c 6520 6973 206e 6f74   if style is not
+0001b230: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+0001b240: 706c 742e 7374 796c 652e 7573 6520 2873  plt.style.use (s
+0001b250: 7479 6c65 2029 0d0a 2020 2020 2020 2020  tyle )..        
+0001b260: 0d0a 2020 2020 7669 6577 203d 2076 6965  ..    view = vie
+0001b270: 7720 6f72 2027 736b 6577 270d 0a20 2020  w or 'skew'..   
+0001b280: 200d 0a20 2020 2069 6620 2827 696e 7627   ..    if ('inv'
+0001b290: 2020 696e 2073 7472 2028 7669 6577 292e    in str (view).
+0001b2a0: 6c6f 7765 7228 290d 0a20 2020 2020 2020  lower()..       
+0001b2b0: 206f 7220 2772 6f74 2720 696e 2073 7472   or 'rot' in str
+0001b2c0: 2028 7669 6577 292e 6c6f 7765 7228 290d   (view).lower().
+0001b2d0: 0a20 2020 2020 2020 206f 7220 276d 7527  .        or 'mu'
+0001b2e0: 2069 6e20 7374 7220 2876 6965 7729 2e6c   in str (view).l
+0001b2f0: 6f77 6572 2829 0d0a 2020 2020 2020 2020  ower()..        
+0001b300: 2920 3a20 0d0a 2020 2020 2020 2020 7669  ) : ..        vi
+0001b310: 6577 203d 276d 7527 0d0a 2020 2020 2020  ew ='mu'..      
+0001b320: 2020 0d0a 2020 2020 6966 2027 7065 7269    ..    if 'peri
+0001b330: 6f64 2720 696e 2073 7472 286d 6f64 6529  od' in str(mode)
+0001b340: 2e6c 6f77 6572 2829 3a20 0d0a 2020 2020  .lower(): ..    
+0001b350: 2020 2020 6d6f 6465 203d 2770 6572 696f      mode ='perio
+0001b360: 6427 0d0a 2020 2020 2020 2020 0d0a 2020  d'..        ..  
+0001b370: 2020 6966 2073 7472 2874 6872 6573 686f    if str(thresho
+0001b380: 6c64 5f6c 696e 6529 2e6c 6f77 6572 2829  ld_line).lower()
+0001b390: 3d3d 2774 7275 6527 3a20 0d0a 2020 2020  =='true': ..    
+0001b3a0: 2020 2020 7468 7265 7368 6f6c 645f 6c69      threshold_li
+0001b3b0: 6e65 203d 2073 7472 286d 6574 686f 6429  ne = str(method)
+0001b3c0: 2e6c 6f77 6572 2829 200d 0a20 2020 2020  .lower() ..     
+0001b3d0: 2020 2020 2020 200d 0a20 2020 2069 6d70         ..    imp
+0001b3e0: 6f72 7420 7761 7465 7820 6173 2077 7820  ort watex as wx 
+0001b3f0: 0d0a 2020 2020 706f 203d 2020 7778 2e45  ..    po =  wx.E
+0001b400: 4d50 726f 6365 7373 696e 6728 292e 6669  MProcessing().fi
+0001b410: 7428 6564 695f 6f62 6a29 0d0a 2020 2020  t(edi_obj)..    
+0001b420: 0d0a 2020 2020 2320 7265 6d6f 7665 2074  ..    # remove t
+0001b430: 6865 206f 7574 6c69 6572 7320 696e 2074  he outliers in t
+0001b440: 6865 2064 6174 610d 0a20 2020 2023 2061  he data..    # a
+0001b450: 6e64 2066 696c 6c65 6420 7769 7468 204e  nd filled with N
+0001b460: 614e 200d 0a20 2020 2073 6b65 772c 206d  aN ..    skew, m
+0001b470: 7520 3d70 6f2e 736b 6577 286d 6574 686f  u =po.skew(metho
+0001b480: 6420 3d20 6d65 7468 6f64 2c20 7375 7070  d = method, supp
+0001b490: 7265 7373 5f6f 7574 6c69 6572 7320 3d20  ress_outliers = 
+0001b4a0: 5472 7565 2020 290d 0a20 2020 2066 7265  True  )..    fre
+0001b4b0: 7173 203d 2020 312f 2070 6f2e 6672 6571  qs =  1/ po.freq
+0001b4c0: 735f 2069 6620 6d6f 6465 203d 3d27 7065  s_ if mode =='pe
+0001b4d0: 7269 6f64 2720 656c 7365 2070 6f2e 6672  riod' else po.fr
+0001b4e0: 6571 735f 200d 0a20 2020 2079 6d61 7420  eqs_ ..    ymat 
+0001b4f0: 3d20 736b 6577 2069 6620 7669 6577 203d  = skew if view =
+0001b500: 3d27 736b 6577 2720 656c 7365 206d 7520  ='skew' else mu 
+0001b510: 0d0a 2020 2020 0d0a 2020 2020 6669 672c  ..    ..    fig,
+0001b520: 2061 7820 3d20 706c 742e 7375 6270 6c6f   ax = plt.subplo
+0001b530: 7473 2831 2c31 2c20 6669 6773 697a 6520  ts(1,1, figsize 
+0001b540: 3d66 6967 5f73 697a 6529 0d0a 0d0a 2020  =fig_size)....  
+0001b550: 2020 232d 2d2d 6d61 6e61 6765 2074 6872    #---manage thr
+0001b560: 6573 686f 6c64 206c 696e 6520 2d2d 2d2d  eshold line ----
+0001b570: 2d2d 0d0a 2020 2020 7468 725f 636f 6465  --..    thr_code
+0001b580: 203d 207b 2262 6168 7222 3a20 5b31 5d20   = {"bahr": [1] 
+0001b590: 2c20 2273 7769 6674 223a 5b20 325d 202c  , "swift":[ 2] ,
+0001b5a0: 2027 626f 7468 273a 5b31 2c20 325d 207d   'both':[1, 2] }
+0001b5b0: 0d0a 0d0a 2020 2020 6966 2074 6872 6573  ....    if thres
+0001b5c0: 686f 6c64 5f6c 696e 6520 6973 206e 6f74  hold_line is not
+0001b5d0: 204e 6f6e 653a 200d 0a20 2020 2020 2020   None: ..       
+0001b5e0: 2069 6620 7374 7228 7468 7265 7368 6f6c   if str(threshol
+0001b5f0: 645f 6c69 6e65 292e 6c6f 7765 7228 2920  d_line).lower() 
+0001b600: 696e 2028 222a 222c 2022 626f 7468 2229  in ("*", "both")
+0001b610: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0001b620: 7468 7265 7368 6f6c 645f 6c69 6e65 203d  threshold_line =
+0001b630: 2027 626f 7468 270d 0a20 2020 2020 2020   'both'..       
+0001b640: 2020 2020 200d 0a20 2020 2063 7420 3d20       ..    ct = 
+0001b650: 7468 725f 636f 6465 2e67 6574 2873 7472  thr_code.get(str
+0001b660: 2874 6872 6573 686f 6c64 5f6c 696e 6529  (threshold_line)
+0001b670: 2e6c 6f77 6572 2829 2c20 4e6f 6e65 2029  .lower(), None )
+0001b680: 200d 0a20 2020 200d 0a20 2020 2066 6f72   ..    ..    for
+0001b690: 2069 2069 6e20 7261 6e67 6520 2873 6b65   i in range (ske
+0001b6a0: 772e 7368 6170 655b 315d 293a 200d 0a20  w.shape[1]): .. 
+0001b6b0: 2020 2020 2020 2061 782e 7363 6174 7465         ax.scatte
+0001b6c0: 7220 2820 6672 6571 732c 2072 6573 6861  r ( freqs, resha
+0001b6d0: 7065 2028 796d 6174 5b3a 2c20 695d 292c  pe (ymat[:, i]),
+0001b6e0: 2a2a 6b77 7320 290d 0a20 2020 2020 2020  **kws )..       
+0001b6f0: 200d 0a20 2020 2069 6620 6374 3a20 0d0a   ..    if ct: ..
+0001b700: 2020 2020 2020 2020 666f 7220 6d20 696e          for m in
+0001b710: 2063 743a 200d 0a20 2020 2020 2020 2020   ct: ..         
+0001b720: 2020 2070 6c74 2e61 7868 6c69 6e65 2879     plt.axhline(y
+0001b730: 3d30 2e34 2069 6620 6d3d 3d32 2065 6c73  =0.4 if m==2 els
+0001b740: 6520 302e 3320 2c20 636f 6c6f 723d 226b  e 0.3 , color="k
+0001b750: 2220 6966 206d 3d3d 3120 656c 7365 2022  " if m==1 else "
+0001b760: 7222 2c0d 0a20 2020 2020 2020 2020 2020  r",..           
+0001b770: 2020 2020 2020 2020 2020 2020 206c 696e               lin
+0001b780: 6573 7479 6c65 3d22 2d22 2c0d 0a20 2020  estyle="-",..   
+0001b790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b7a0: 2020 2020 206c 6162 656c 3d66 2774 6872       label=f'thr
+0001b7b0: 6573 686f 6c64 3a20 245c 6d75 3d7b 302e  eshold: $\mu={0.
+0001b7c0: 3420 6966 206d 3d3d 3220 656c 7365 2030  4 if m==2 else 0
+0001b7d0: 2e33 7d24 270d 0a20 2020 2020 2020 2020  .3}$'..         
+0001b7e0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001b7f0: 0d0a 2020 2020 2020 2020 2020 2020 6178  ..            ax
+0001b800: 2e6c 6567 656e 6428 2920 0d0a 0d0a 2020  .legend() ....  
+0001b810: 2020 6178 2e73 6574 5f78 7363 616c 6528    ax.set_xscale(
+0001b820: 276c 6f67 2729 0d0a 2020 2020 0d0a 2020  'log')..    ..  
+0001b830: 2020 6178 2e73 6574 5f78 6c61 6265 6c28    ax.set_xlabel(
+0001b840: 2750 6572 696f 6420 2824 7324 2927 2069  'Period ($s$)' i
+0001b850: 6620 6d6f 6465 3d3d 2770 6572 696f 6427  f mode=='period'
+0001b860: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0001b870: 2020 2020 2065 6c73 6520 2746 7265 7175       else 'Frequ
+0001b880: 656e 6379 2028 2448 5f7a 2429 2729 0d0a  ency ($H_z$)')..
+0001b890: 2020 2020 6178 2e73 6574 5f79 6c61 6265      ax.set_ylabe
+0001b8a0: 6c28 6622 7b27 536b 6577 2720 6966 2076  l(f"{'Skew' if v
+0001b8b0: 6965 7720 3d3d 2773 6b65 7727 2065 6c73  iew =='skew' els
+0001b8c0: 6520 2752 6f74 2e49 6e76 6172 6961 6e74  e 'Rot.Invariant
+0001b8d0: 277d 2220 2b20 2228 245c 6d75 2429 2229  '}" + "($\mu$)")
+0001b8e0: 0d0a 0d0a 2020 2020 706c 742e 786c 696d  ....    plt.xlim
+0001b8f0: 2028 5b20 6672 6571 732e 6d69 6e28 2920   ([ freqs.min() 
+0001b900: 2c20 6672 6571 732e 6d61 7828 295d 290d  , freqs.max()]).
+0001b910: 0a20 2020 200d 0a20 2020 2023 706c 742e  .    ..    #plt.
+0001b920: 786c 696d 2829 200d 0a0d 0a20 2020 2069  xlim() ....    i
+0001b930: 6620 7361 7665 6669 6720 6973 206e 6f74  f savefig is not
+0001b940: 2020 4e6f 6e65 3a20 0d0a 2020 2020 2020    None: ..      
+0001b950: 2020 7361 7665 6669 6775 7265 2028 6669    savefigure (fi
+0001b960: 672c 2073 6176 6566 6967 2c20 6470 6920  g, savefig, dpi 
+0001b970: 3d20 3330 3029 0d0a 2020 2020 2020 2020  = 300)..        
+0001b980: 0d0a 2020 2020 706c 742e 636c 6f73 6520  ..    plt.close 
+0001b990: 2829 2069 6620 7361 7665 6669 6720 6973  () if savefig is
+0001b9a0: 206e 6f74 204e 6f6e 6520 656c 7365 2070   not None else p
+0001b9b0: 6c74 2e73 686f 7728 2920 0d0a 2020 2020  lt.show() ..    
+0001b9c0: 0d0a 2020 2020 7265 7475 726e 2061 7820  ..    return ax 
+0001b9d0: 0d0a 0d0a 6465 6620 5f66 6f72 6d61 745f  ....def _format_
+0001b9e0: 7469 636b 7320 2876 616c 7565 2c20 7469  ticks (value, ti
+0001b9f0: 636b 5f6e 756d 6265 722c 2066 6d74 203d  ck_number, fmt =
+0001ba00: 2753 7b3a 3032 7d27 2c20 6e73 6b69 7020  'S{:02}', nskip 
+0001ba10: 3d37 2029 3a0d 0a20 2020 2022 2222 2046  =7 ):..    """ F
+0001ba20: 6f72 6d61 7420 7468 6963 6b20 7061 7261  ormat thick para
+0001ba30: 6d65 7465 7220 7769 7468 2027 4675 6e63  meter with 'Func
+0001ba40: 466f 726d 6174 7465 7228 6675 6e63 2927  Formatter(func)'
+0001ba50: 0d0a 2020 2020 7261 7468 6572 2074 6861  ..    rather tha
+0001ba60: 6e20 7573 696e 6720 6061 7869 2e78 6178  n using `axi.xax
+0001ba70: 6973 2e73 6574 5f6d 616a 6f72 5f6c 6f63  is.set_major_loc
+0001ba80: 6174 6f72 2028 706c 742e 4d61 784e 4c6f  ator (plt.MaxNLo
+0001ba90: 6361 746f 7228 3329 2960 0d0a 2020 2020  cator(3))`..    
+0001baa0: 6178 2e78 6178 6973 2e73 6574 5f6d 616a  ax.xaxis.set_maj
+0001bab0: 6f72 5f66 6f72 6d61 7474 6572 2028 706c  or_formatter (pl
+0001bac0: 742e 4675 6e63 466f 726d 6174 7465 7228  t.FuncFormatter(
+0001bad0: 666f 726d 6174 5f74 6869 636b 7329 290d  format_thicks)).
+0001bae0: 0a20 2020 200d 0a20 2020 203a 7061 7261  .    ..    :para
+0001baf0: 6d20 7661 6c75 653a 2074 6963 6b20 7261  m value: tick ra
+0001bb00: 6e67 6520 7661 6c75 6573 2066 6f72 2066  nge values for f
+0001bb10: 6f72 6d61 7474 696e 6720 0d0a 2020 2020  ormatting ..    
+0001bb20: 3a70 6172 616d 2074 6963 6b5f 6e75 6d62  :param tick_numb
+0001bb30: 6572 3a20 6e75 6d62 6572 206f 6620 7469  er: number of ti
+0001bb40: 636b 7320 746f 2066 6f72 6d61 7420 0d0a  cks to format ..
+0001bb50: 2020 2020 3a70 6172 616d 2066 6d74 3a20      :param fmt: 
+0001bb60: 7374 722c 2064 6566 6175 6c74 3d27 537b  str, default='S{
+0001bb70: 3a30 327d 272c 206b 696e 6420 6f66 2074  :02}', kind of t
+0001bb80: 6963 6b20 666f 726d 6174 6167 6520 0d0a  ick formatage ..
+0001bb90: 2020 2020 3a70 6172 616d 206e 736b 6970      :param nskip
+0001bba0: 3a20 696e 742c 2064 6566 6175 6c74 203d  : int, default =
+0001bbb0: 372c 206e 756d 6265 7220 6f66 2074 6963  7, number of tic
+0001bbc0: 6b20 746f 2073 6b69 7020 0d0a 2020 2020  k to skip ..    
+0001bbd0: 0d0a 2020 2020 2222 220d 0a20 2020 2069  ..    """..    i
+0001bbe0: 6620 7661 6c75 6520 2520 6e73 6b69 703d  f value % nskip=
+0001bbf0: 3d30 3a20 0d0a 2020 2020 2020 2020 7265  =0: ..        re
+0001bc00: 7475 726e 2066 6d74 2e66 6f72 6d61 7428  turn fmt.format(
+0001bc10: 696e 7428 7661 6c75 6529 2b20 3129 0d0a  int(value)+ 1)..
+0001bc20: 2020 2020 656c 7365 3a20 4e6f 6e65 200d      else: None .
+0001bc30: 0a20 2020 200d 0a23 5858 5820 4f50 5449  .    ..#XXX OPTI
+0001bc40: 4d49 5a45 200d 0a64 6566 2070 6c6f 745f  MIZE ..def plot_
+0001bc50: 636f 6e66 6964 656e 6365 2028 0d0a 2020  confidence (..  
+0001bc60: 2020 6461 7461 203d 204e 6f6e 652c 200d    data = None, .
+0001bc70: 0a20 2020 202a 2c20 200d 0a20 2020 2079  .    *,  ..    y
+0001bc80: 3d4e 6f6e 652c 200d 0a20 2020 2078 3d4e  =None, ..    x=N
+0001bc90: 6f6e 652c 200d 0a20 2020 2063 6920 3d2e  one, ..    ci =.
+0001bca0: 3935 202c 2020 0d0a 2020 2020 6b69 6e64  95 ,  ..    kind
+0001bcb0: 203d 276c 696e 6527 2c20 0d0a 2020 2020   ='line', ..    
+0001bcc0: 625f 7361 6d70 6c65 7320 3d20 3130 3030  b_samples = 1000
+0001bcd0: 2c20 0d0a 2020 2020 2a2a 736e 735f 6b77  , ..    **sns_kw
+0001bce0: 730d 0a20 2020 2029 3a20 0d0a 2020 2020  s..    ): ..    
+0001bcf0: 2222 2220 506c 6f74 2063 6f6e 6669 6465  """ Plot confide
+0001bd00: 6e63 6520 6461 7461 200d 0a20 2020 200d  nce data ..    .
+0001bd10: 0a20 2020 2043 6f6e 6669 6465 6e63 6520  .    Confidence 
+0001bd20: 496e 7465 7276 616c 2028 4349 2920 2069  Interval (CI)  i
+0001bd30: 7320 6120 7479 7065 206f 6620 6573 7469  s a type of esti
+0001bd40: 6d61 7465 2063 6f6d 7075 7465 6420 6672  mate computed fr
+0001bd50: 6f6d 2074 6865 2073 7461 7469 7374 6963  om the statistic
+0001bd60: 7320 0d0a 2020 2020 6f66 2074 6865 206f  s ..    of the o
+0001bd70: 6273 6572 7665 6420 6461 7461 2077 6869  bserved data whi
+0001bd80: 6368 2067 6976 6573 2061 2072 616e 6765  ch gives a range
+0001bd90: 206f 6620 7661 6c75 6573 2074 6861 74e2   of values that.
+0001bda0: 8099 7320 6c69 6b65 6c79 2074 6f20 0d0a  ..s likely to ..
+0001bdb0: 2020 2020 636f 6e74 6169 6e20 6120 706f      contain a po
+0001bdc0: 7075 6c61 7469 6f6e 2070 6172 616d 6574  pulation paramet
+0001bdd0: 6572 2077 6974 6820 6120 7061 7274 6963  er with a partic
+0001bde0: 756c 6172 206c 6576 656c 206f 6620 636f  ular level of co
+0001bdf0: 6e66 6964 656e 6365 2e0d 0a20 2020 2043  nfidence...    C
+0001be00: 4920 6173 2061 2063 6f6e 6365 7074 2077  I as a concept w
+0001be10: 6173 2070 7574 2066 6f72 7468 2062 7920  as put forth by 
+0001be20: 4a65 727a 7920 4e65 796d 616e 2069 6e20  Jerzy Neyman in 
+0001be30: 6120 7061 7065 7220 7075 626c 6973 6865  a paper publishe
+0001be40: 6420 0d0a 2020 2020 696e 2031 3933 372e  d ..    in 1937.
+0001be50: 2054 6865 7265 2061 7265 2076 6172 696f   There are vario
+0001be60: 7573 2074 7970 6573 206f 6620 7468 6520  us types of the 
+0001be70: 636f 6e66 6964 656e 6365 2069 6e74 6572  confidence inter
+0001be80: 7661 6c2c 2073 6f6d 6520 6f66 200d 0a20  val, some of .. 
+0001be90: 2020 2074 6865 206d 6f73 7420 636f 6d6d     the most comm
+0001bea0: 6f6e 6c79 2075 7365 6420 6f6e 6573 2061  only used ones a
+0001beb0: 7265 3a20 4349 2066 6f72 206d 6561 6e2c  re: CI for mean,
+0001bec0: 2043 4920 666f 7220 7468 6520 6d65 6469   CI for the medi
+0001bed0: 616e 2c20 4349 2066 6f72 200d 0a20 2020  an, CI for ..   
+0001bee0: 2074 6865 2064 6966 6665 7265 6e63 6520   the difference 
+0001bef0: 6265 7477 6565 6e20 6d65 616e 732c 2043  between means, C
+0001bf00: 4920 666f 7220 6120 7072 6f70 6f72 7469  I for a proporti
+0001bf10: 6f6e 2061 6e64 2043 4920 666f 7220 7468  on and CI for th
+0001bf20: 6520 6469 6666 6572 656e 6365 200d 0a20  e difference .. 
+0001bf30: 2020 2069 6e20 7072 6f70 6f72 7469 6f6e     in proportion
+0001bf40: 732e 0d0a 2020 2020 0d0a 2020 2020 5061  s...    ..    Pa
+0001bf50: 7261 6d65 7465 7273 200d 0a20 2020 202d  rameters ..    -
+0001bf60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
+0001bf70: 2064 6174 613a 2070 616e 6461 732e 4461   data: pandas.Da
+0001bf80: 7461 4672 616d 652c 206e 756d 7079 2e6e  taFrame, numpy.n
+0001bf90: 6461 7272 6179 2c20 6d61 7070 696e 672c  darray, mapping,
+0001bfa0: 206f 7220 7365 7175 656e 6365 0d0a 2020   or sequence..  
+0001bfb0: 2020 2020 2049 6e70 7574 2064 6174 6120       Input data 
+0001bfc0: 7374 7275 6374 7572 652e 2045 6974 6865  structure. Eithe
+0001bfd0: 7220 6120 6c6f 6e67 2d66 6f72 6d20 636f  r a long-form co
+0001bfe0: 6c6c 6563 7469 6f6e 206f 6620 7665 6374  llection of vect
+0001bff0: 6f72 7320 0d0a 2020 2020 2020 2074 6861  ors ..       tha
+0001c000: 7420 6361 6e20 6265 2061 7373 6967 6e65  t can be assigne
+0001c010: 6420 746f 206e 616d 6564 2076 6172 6961  d to named varia
+0001c020: 626c 6573 206f 7220 6120 7769 6465 2d66  bles or a wide-f
+0001c030: 6f72 6d20 6461 7461 7365 7420 0d0a 2020  orm dataset ..  
+0001c040: 2020 2020 2074 6861 7420 7769 6c6c 2062       that will b
+0001c050: 6520 696e 7465 726e 616c 6c79 2072 6573  e internally res
+0001c060: 6861 7065 642e 0d0a 0d0a 2020 2020 782c  haped.....    x,
+0001c070: 2079 3a20 7665 6374 6f72 7320 6f72 206b   y: vectors or k
+0001c080: 6579 7320 696e 2064 6174 610d 0a20 2020  eys in data..   
+0001c090: 2020 2020 5661 7269 6162 6c65 7320 7468      Variables th
+0001c0a0: 6174 2073 7065 6369 6679 2070 6f73 6974  at specify posit
+0001c0b0: 696f 6e73 206f 6e20 7468 6520 7820 616e  ions on the x an
+0001c0c0: 6420 7920 6178 6573 2e0d 0a20 2020 2020  d y axes...     
+0001c0d0: 2020 0d0a 2020 2020 6369 3a20 666c 6f61    ..    ci: floa
+0001c0e0: 742c 2064 6566 6175 6c74 3d2e 3935 200d  t, default=.95 .
+0001c0f0: 0a20 2020 2020 2020 436f 6e66 6964 656e  .       Confiden
+0001c100: 6365 2076 616c 7565 2e20 0d0a 2020 2020  ce value. ..    
+0001c110: 2020 200d 0a20 2020 206b 696e 643a 2073     ..    kind: s
+0001c120: 7472 2c20 6465 6661 756c 743d 276c 696e  tr, default='lin
+0001c130: 6527 200d 0a20 2020 2020 2020 6b69 6e64  e' ..       kind
+0001c140: 206f 6620 636f 6e66 6964 656e 6365 2069   of confidence i
+0001c150: 6e74 6572 7676 616c 2070 6c6f 742e 200d  ntervval plot. .
+0001c160: 0a20 2020 2020 200d 0a20 2020 2062 5f73  .      ..    b_s
+0001c170: 616d 706c 6573 3a20 696e 742c 2064 6566  amples: int, def
+0001c180: 6175 6c74 3d31 3030 300d 0a20 2020 2020  ault=1000..     
+0001c190: 2020 204e 756d 6265 7220 6f66 2062 6f6f     Number of boo
+0001c1a0: 7473 7472 6170 7320 746f 2075 7365 2066  tstraps to use f
+0001c1b0: 6f72 2063 6f6d 7075 7469 6e67 2074 6865  or computing the
+0001c1c0: 2063 6f6e 6669 6465 6e63 6520 696e 7465   confidence inte
+0001c1d0: 7276 616c 2e0d 0a20 2020 2020 2020 200d  rval...        .
+0001c1e0: 0a20 2020 2073 6e73 5f6b 7773 3a20 6469  .    sns_kws: di
+0001c1f0: 6374 2c20 0d0a 2020 2020 2020 204b 6579  ct, ..       Key
+0001c200: 776f 7264 7320 6172 6775 6d65 6e74 7320  words arguments 
+0001c210: 7061 7373 6564 2074 6f20 7468 6520 6073  passed to the `s
+0001c220: 6e73 2e6c 696e 6570 6c6f 7460 206f 7220  ns.lineplot` or 
+0001c230: 6073 6e73 2e72 6567 706c 6f74 600d 0a20  `sns.regplot`.. 
+0001c240: 2020 2020 2020 0d0a 2020 2020 5265 7475        ..    Retu
+0001c250: 726e 7320 0d0a 2020 2020 2d2d 2d2d 2d2d  rns ..    ------
+0001c260: 2d2d 2d2d 0d0a 2020 2020 6178 3a20 6d61  ----..    ax: ma
+0001c270: 7470 6c6f 746c 6962 2e61 7865 732e 4178  tplotlib.axes.Ax
+0001c280: 6573 0d0a 2020 2020 2020 2054 6865 206d  es..       The m
+0001c290: 6174 706c 6f74 6c69 6220 6178 6573 2063  atplotlib axes c
+0001c2a0: 6f6e 7461 696e 696e 6720 7468 6520 706c  ontaining the pl
+0001c2b0: 6f74 2e0d 0a20 2020 2020 2020 0d0a 2020  ot...       ..  
+0001c2c0: 2020 2222 2220 2020 0d0a 2020 2020 2379    """   ..    #y
+0001c2d0: 203d 206e 702e 6172 7261 7920 2879 2920   = np.array (y) 
+0001c2e0: 0d0a 2020 2020 2378 3d20 7820 6f72 2028  ..    #x= x or (
+0001c2f0: 206e 702e 6172 616e 6765 2028 6c65 6e28   np.arange (len(
+0001c300: 7929 2920 6966 200d 0a20 2020 2061 783d  y)) if ..    ax=
+0001c310: 4e6f 6e65 200d 0a20 2020 2069 6620 276c  None ..    if 'l
+0001c320: 696e 2720 696e 2073 7472 286b 696e 6429  in' in str(kind)
+0001c330: 2e6c 6f77 6572 2829 3a20 0d0a 2020 2020  .lower(): ..    
+0001c340: 2020 2020 6178 203d 2073 6e73 2e6c 696e      ax = sns.lin
+0001c350: 6570 6c6f 7428 6461 7461 3d20 6461 7461  eplot(data= data
+0001c360: 2c20 783d 782c 2079 3d79 2c20 6369 3d63  , x=x, y=y, ci=c
+0001c370: 692c 202a 2a73 6e73 5f6b 7773 290d 0a20  i, **sns_kws).. 
+0001c380: 2020 2065 6c69 6620 2772 6567 2720 696e     elif 'reg' in
+0001c390: 2020 7374 7228 6b69 6e64 292e 6c6f 7765    str(kind).lowe
+0001c3a0: 7228 293a 200d 0a20 2020 2020 2020 2061  r(): ..        a
+0001c3b0: 7820 3d20 736e 732e 7265 6770 6c6f 7428  x = sns.regplot(
+0001c3c0: 6461 7461 203d 2064 6174 612c 2078 3d78  data = data, x=x
+0001c3d0: 2c20 793d 792c 2063 693d 6369 2c20 2a2a  , y=y, ci=ci, **
+0001c3e0: 736e 735f 6b77 7320 2920 0d0a 2020 2020  sns_kws ) ..    
+0001c3f0: 656c 7365 3a20 0d0a 2020 2020 2020 2020  else: ..        
+0001c400: 6966 206e 6f74 2079 3a20 0d0a 2020 2020  if not y: ..    
+0001c410: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001c420: 6c75 6545 7272 6f72 2822 7920 7368 6f75  lueError("y shou
+0001c430: 6c64 206e 6f74 2062 6520 4e6f 6e65 2077  ld not be None w
+0001c440: 6865 6e20 7573 696e 6720 7468 6520 626f  hen using the bo
+0001c450: 6f73 7472 6170 7069 6e67 220d 0a20 2020  ostrapping"..   
+0001c460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c470: 2020 2020 2020 2020 2020 2220 666f 7220            " for 
+0001c480: 706c 6f74 7469 6e67 2074 6865 2063 6f6e  plotting the con
+0001c490: 6669 6465 6e63 6520 696e 7465 7276 616c  fidence interval
+0001c4a0: 2e22 290d 0a20 2020 2020 2020 2062 5f73  .")..        b_s
+0001c4b0: 616d 706c 6573 203d 205f 6173 7365 7274  amples = _assert
+0001c4c0: 5f61 6c6c 5f74 7970 6573 280d 0a20 2020  _all_types(..   
+0001c4d0: 2020 2020 2020 2020 2062 5f73 616d 706c           b_sampl
+0001c4e0: 6573 2c20 696e 742c 2066 6c6f 6174 2c20  es, int, float, 
+0001c4f0: 6f62 6a6e 616d 653d 2242 6f6f 7473 7472  objname="Bootstr
+0001c500: 6170 2073 616d 706c 6573 2060 625f 7361  ap samples `b_sa
+0001c510: 6d70 6c65 7360 2229 0d0a 2020 2020 2020  mples`")..      
+0001c520: 2020 0d0a 2020 2020 2020 2020 6672 6f6d    ..        from
+0001c530: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
+0001c540: 2069 6d70 6f72 7420 7265 7361 6d70 6c65   import resample
+0001c550: 200d 0a20 2020 2020 2020 2023 2063 6f6e   ..        # con
+0001c560: 6669 6775 7265 2062 6f6f 7473 7472 6170  figure bootstrap
+0001c570: 0d0a 2020 2020 2020 2020 6e5f 6974 6572  ..        n_iter
+0001c580: 6174 696f 6e73 203d 2031 3030 3020 2320  ations = 1000 # 
+0001c590: 6865 7265 206b 3d6e 6f2e 206f 6620 626f  here k=no. of bo
+0001c5a0: 6f74 7374 7261 7070 6564 2073 616d 706c  otstrapped sampl
+0001c5b0: 6573 0d0a 2020 2020 2020 2020 6e5f 7369  es..        n_si
+0001c5c0: 7a65 203d 2069 6e74 286c 656e 2879 2929  ze = int(len(y))
+0001c5d0: 0d0a 2020 2020 2020 2020 2020 0d0a 2020  ..          ..  
+0001c5e0: 2020 2020 2020 2320 7275 6e20 626f 6f74        # run boot
+0001c5f0: 7374 7261 700d 0a20 2020 2020 2020 206d  strap..        m
+0001c600: 6564 6961 6e73 203d 206c 6973 7428 290d  edians = list().
+0001c610: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+0001c620: 6e20 7261 6e67 6528 6e5f 6974 6572 6174  n range(n_iterat
+0001c630: 696f 6e73 293a 0d0a 2020 2020 2020 2020  ions):..        
+0001c640: 2020 2073 203d 2072 6573 616d 706c 6528     s = resample(
+0001c650: 792c 206e 5f73 616d 706c 6573 3d6e 5f73  y, n_samples=n_s
+0001c660: 697a 6529 3b0d 0a20 2020 2020 2020 2020  ize);..         
+0001c670: 2020 6d20 3d20 6e70 2e6d 6564 6961 6e28    m = np.median(
+0001c680: 7329 3b0d 0a20 2020 2020 2020 2020 2020  s);..           
+0001c690: 6d65 6469 616e 732e 6170 7065 6e64 286d  medians.append(m
+0001c6a0: 290d 0a20 2020 2020 2020 2020 200d 0a20  )..          .. 
+0001c6b0: 2020 2020 2020 2023 2070 6c6f 7420 7363         # plot sc
+0001c6c0: 6f72 6573 0d0a 2020 2020 2020 2020 706c  ores..        pl
+0001c6d0: 742e 6869 7374 286d 6564 6961 6e73 290d  t.hist(medians).
+0001c6e0: 0a20 2020 2020 2020 2070 6c74 2e73 686f  .        plt.sho
+0001c6f0: 7728 290d 0a20 2020 2020 2020 2020 200d  w()..          .
+0001c700: 0a20 2020 2020 2020 2023 2063 6f6e 6669  .        # confi
+0001c710: 6465 6e63 6520 696e 7465 7276 616c 730d  dence intervals.
+0001c720: 0a20 2020 2020 2020 2070 203d 2028 2831  .        p = ((1
+0001c730: 2e30 2d63 6929 2f32 2e30 2920 2a20 3130  .0-ci)/2.0) * 10
+0001c740: 300d 0a20 2020 2020 2020 206c 6f77 6572  0..        lower
+0001c750: 203d 2020 6e70 2e70 6572 6365 6e74 696c   =  np.percentil
+0001c760: 6528 6d65 6469 616e 732c 2070 290d 0a20  e(medians, p).. 
+0001c770: 2020 2020 2020 2070 203d 2028 6369 2b28         p = (ci+(
+0001c780: 2831 2e30 2d63 6929 2f32 2e30 2929 202a  (1.0-ci)/2.0)) *
+0001c790: 2031 3030 0d0a 2020 2020 2020 2020 7570   100..        up
+0001c7a0: 7065 7220 3d20 206e 702e 7065 7263 656e  per =  np.percen
+0001c7b0: 7469 6c65 286d 6564 6961 6e73 2c20 7029  tile(medians, p)
+0001c7c0: 0d0a 2020 0d0a 2020 2020 2020 2020 7072  ..  ..        pr
+0001c7d0: 696e 7428 6622 5c6e 7b63 692a 3130 307d  int(f"\n{ci*100}
+0001c7e0: 2063 6f6e 6669 6465 6e63 6520 696e 7465   confidence inte
+0001c7f0: 7276 616c 207b 6c6f 7765 727d 2061 6e64  rval {lower} and
+0001c800: 207b 7570 7065 727d 2229 0d0a 2020 2020   {upper}")..    
+0001c810: 0d0a 2020 2020 7265 7475 726e 2061 7820  ..    return ax 
+0001c820: 0d0a 0d0a 6465 6620 706c 6f74 5f63 6f6e  ....def plot_con
+0001c830: 6669 6465 6e63 655f 656c 6c69 7073 6520  fidence_ellipse 
+0001c840: 2878 2c20 7920 293a 200d 0a20 2020 2022  (x, y ): ..    "
+0001c850: 2222 2050 6c6f 7420 6120 636f 6e66 6964  "" Plot a confid
+0001c860: 656e 6365 2065 6c6c 6970 7365 206f 6620  ence ellipse of 
+0001c870: 6120 7477 6f2d 6469 6d65 6e73 696f 6e61  a two-dimensiona
+0001c880: 6c20 6461 7461 7365 7420 0d0a 2020 2020  l dataset ..    
+0001c890: 0d0a 2020 2020 5468 6973 2066 756e 6374  ..    This funct
+0001c8a0: 696f 6e20 706c 6f74 7320 7468 6520 636f  ion plots the co
+0001c8b0: 6e66 6964 656e 6365 2065 6c6c 6970 7365  nfidence ellipse
+0001c8c0: 206f 6620 7468 6520 636f 7661 7269 616e   of the covarian
+0001c8d0: 6365 206f 6620 0d0a 2020 2020 7468 6520  ce of ..    the 
+0001c8e0: 6769 7665 6e20 6172 7261 792d 6c69 6b65  given array-like
+0001c8f0: 2076 6172 6961 626c 6573 2078 2061 6e64   variables x and
+0001c900: 2079 2e20 5468 6520 656c 6c69 7073 6520   y. The ellipse 
+0001c910: 6973 2070 6c6f 7474 6564 200d 0a20 2020  is plotted ..   
+0001c920: 2069 6e74 6f20 7468 6520 6769 7665 6e20   into the given 
+0001c930: 6178 6573 2d6f 626a 6563 7420 6178 2e0d  axes-object ax..
+0001c940: 0a20 2020 200d 0a20 2020 2054 6865 2061  .    ..    The a
+0001c950: 7070 726f 6163 6820 7468 6174 2069 7320  pproach that is 
+0001c960: 7573 6564 2074 6f20 6f62 7461 696e 2074  used to obtain t
+0001c970: 6865 2063 6f72 7265 6374 2067 656f 6d65  he correct geome
+0001c980: 7472 7920 0d0a 2020 2020 6973 2065 7870  try ..    is exp
+0001c990: 6c61 696e 6564 2061 6e64 2070 726f 7665  lained and prove
+0001c9a0: 6420 6865 7265 3a0d 0a20 2020 2020 2068  d here:..      h
+0001c9b0: 7474 7073 3a2f 2f63 6172 7374 656e 7363  ttps://carstensc
+0001c9c0: 6865 6c70 2e67 6974 6875 622e 696f 2f32  help.github.io/2
+0001c9d0: 3031 382f 3039 2f31 342f 506c 6f74 5f43  018/09/14/Plot_C
+0001c9e0: 6f6e 6669 6465 6e63 655f 456c 6c69 7073  onfidence_Ellips
+0001c9f0: 655f 3030 312e 6874 6d6c 0d0a 2020 2020  e_001.html..    
+0001ca00: 2020 0d0a 2020 2020 5468 6520 6d65 7468    ..    The meth
+0001ca10: 6f64 2061 766f 6964 7320 7468 6520 7573  od avoids the us
+0001ca20: 6520 6f66 2061 6e20 6974 6572 6174 6976  e of an iterativ
+0001ca30: 6520 6569 6765 6e20 6465 636f 6d70 6f73  e eigen decompos
+0001ca40: 6974 696f 6e20 0d0a 2020 2020 616c 676f  ition ..    algo
+0001ca50: 7269 7468 6d20 616e 6420 6d61 6b65 7320  rithm and makes 
+0001ca60: 7573 6520 6f66 2074 6865 2066 6163 7420  use of the fact 
+0001ca70: 7468 6174 2061 206e 6f72 6d61 6c69 7a65  that a normalize
+0001ca80: 6420 636f 7661 7269 616e 6365 200d 0a20  d covariance .. 
+0001ca90: 2020 206d 6174 7269 7820 2863 6f6d 706f     matrix (compo
+0001caa0: 7365 6420 6f66 2070 6561 7273 6f6e 2063  sed of pearson c
+0001cab0: 6f72 7265 6c61 7469 6f6e 2063 6f65 6666  orrelation coeff
+0001cac0: 6963 6965 6e74 7320 616e 6420 6f6e 6573  icients and ones
+0001cad0: 2920 6973 200d 0a20 2020 2070 6172 7469  ) is ..    parti
+0001cae0: 6375 6c61 726c 7920 6561 7379 2074 6f20  cularly easy to 
+0001caf0: 6861 6e64 6c65 2e0d 0a20 2020 200d 0a20  handle...    .. 
+0001cb00: 2020 2022 2222 0d0a 2020 2020 6669 672c     """..    fig,
+0001cb10: 2061 785f 6e73 7464 203d 2070 6c74 2e73   ax_nstd = plt.s
+0001cb20: 7562 706c 6f74 7328 6669 6773 697a 653d  ubplots(figsize=
+0001cb30: 2836 2c20 3629 290d 0a20 2020 2023 2064  (6, 6))..    # d
+0001cb40: 6570 656e 6465 6e63 795f 6e73 7464 203d  ependency_nstd =
+0001cb50: 205b 5b30 2e38 2c20 302e 3735 5d2c 0d0a   [[0.8, 0.75],..
+0001cb60: 2020 2020 2320 2020 2020 2020 2020 2020      #           
+0001cb70: 2020 2020 2020 2020 205b 2d30 2e32 2c20           [-0.2, 
+0001cb80: 302e 3335 5d5d 0d0a 2020 2020 6d75 203d  0.35]]..    mu =
+0001cb90: 2030 2c20 300d 0a20 2020 2023 2073 6361   0, 0..    # sca
+0001cba0: 6c65 203d 2038 2c20 350d 0a20 2020 2061  le = 8, 5..    a
+0001cbb0: 785f 6e73 7464 2e61 7876 6c69 6e65 2863  x_nstd.axvline(c
+0001cbc0: 3d27 6772 6579 272c 206c 773d 3129 0d0a  ='grey', lw=1)..
+0001cbd0: 2020 2020 6178 5f6e 7374 642e 6178 686c      ax_nstd.axhl
+0001cbe0: 696e 6528 633d 2767 7265 7927 2c20 6c77  ine(c='grey', lw
+0001cbf0: 3d31 290d 0a20 2020 200d 0a20 2020 2023  =1)..    ..    #
+0001cc00: 782c 2079 203d 2067 6574 5f63 6f72 7265  x, y = get_corre
+0001cc10: 6c61 7465 645f 6461 7461 7365 7428 3530  lated_dataset(50
+0001cc20: 302c 2064 6570 656e 6465 6e63 795f 6e73  0, dependency_ns
+0001cc30: 7464 2c20 6d75 2c20 7363 616c 6529 0d0a  td, mu, scale)..
+0001cc40: 2020 2020 6178 5f6e 7374 642e 7363 6174      ax_nstd.scat
+0001cc50: 7465 7228 782c 2079 2c20 733d 302e 3529  ter(x, y, s=0.5)
+0001cc60: 0d0a 2020 2020 0d0a 2020 2020 636f 6e66  ..    ..    conf
+0001cc70: 6964 656e 6365 5f65 6c6c 6970 7365 2878  idence_ellipse(x
+0001cc80: 2c20 792c 2061 785f 6e73 7464 2c20 6e5f  , y, ax_nstd, n_
+0001cc90: 7374 643d 312c 0d0a 2020 2020 2020 2020  std=1,..        
+0001cca0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0001ccb0: 6162 656c 3d72 2724 315c 7369 676d 6124  abel=r'$1\sigma$
+0001ccc0: 272c 2065 6467 6563 6f6c 6f72 3d27 6669  ', edgecolor='fi
+0001ccd0: 7265 6272 6963 6b27 290d 0a20 2020 2063  rebrick')..    c
+0001cce0: 6f6e 6669 6465 6e63 655f 656c 6c69 7073  onfidence_ellips
+0001ccf0: 6528 782c 2079 2c20 6178 5f6e 7374 642c  e(x, y, ax_nstd,
+0001cd00: 206e 5f73 7464 3d32 2c0d 0a20 2020 2020   n_std=2,..     
+0001cd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd20: 2020 6c61 6265 6c3d 7227 2432 5c73 6967    label=r'$2\sig
+0001cd30: 6d61 2427 2c20 6564 6765 636f 6c6f 723d  ma$', edgecolor=
+0001cd40: 2766 7563 6873 6961 272c 0d0a 2020 2020  'fuchsia',..    
+0001cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd60: 2020 206c 696e 6573 7479 6c65 3d27 2d2d     linestyle='--
+0001cd70: 2729 0d0a 2020 2020 636f 6e66 6964 656e  ')..    confiden
+0001cd80: 6365 5f65 6c6c 6970 7365 2878 2c20 792c  ce_ellipse(x, y,
+0001cd90: 2061 785f 6e73 7464 2c20 6e5f 7374 643d   ax_nstd, n_std=
+0001cda0: 332c 0d0a 2020 2020 2020 2020 2020 2020  3,..            
+0001cdb0: 2020 2020 2020 2020 2020 206c 6162 656c             label
+0001cdc0: 3d72 2724 335c 7369 676d 6124 272c 2065  =r'$3\sigma$', e
+0001cdd0: 6467 6563 6f6c 6f72 3d27 626c 7565 272c  dgecolor='blue',
+0001cde0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0001cdf0: 2020 2020 2020 2020 2020 6c69 6e65 7374            linest
+0001ce00: 796c 653d 273a 2729 0d0a 2020 2020 0d0a  yle=':')..    ..
+0001ce10: 2020 2020 6178 5f6e 7374 642e 7363 6174      ax_nstd.scat
+0001ce20: 7465 7228 6d75 5b30 5d2c 206d 755b 315d  ter(mu[0], mu[1]
+0001ce30: 2c20 633d 2772 6564 272c 2073 3d33 290d  , c='red', s=3).
+0001ce40: 0a20 2020 2061 785f 6e73 7464 2e73 6574  .    ax_nstd.set
+0001ce50: 5f74 6974 6c65 2827 4469 6666 6572 656e  _title('Differen
+0001ce60: 7420 7374 616e 6461 7264 2064 6576 6961  t standard devia
+0001ce70: 7469 6f6e 7327 290d 0a20 2020 2061 785f  tions')..    ax_
+0001ce80: 6e73 7464 2e6c 6567 656e 6428 290d 0a20  nstd.legend().. 
+0001ce90: 2020 2070 6c74 2e73 686f 7728 290d 0a20     plt.show().. 
+0001cea0: 2020 200d 0a64 6566 2063 6f6e 6669 6465     ..def confide
+0001ceb0: 6e63 655f 656c 6c69 7073 6528 0d0a 2020  nce_ellipse(..  
+0001cec0: 2020 782c 200d 0a20 2020 2079 2c20 0d0a    x, ..    y, ..
+0001ced0: 2020 2020 6178 2c20 0d0a 2020 2020 6e5f      ax, ..    n_
+0001cee0: 7374 643d 332e 302c 200d 0a20 2020 2066  std=3.0, ..    f
+0001cef0: 6163 6563 6f6c 6f72 3d27 6e6f 6e65 272c  acecolor='none',
+0001cf00: 200d 0a20 2020 202a 2a6b 7761 7267 730d   ..    **kwargs.
+0001cf10: 0a20 2020 2029 3a0d 0a20 2020 2022 2222  .    ):..    """
+0001cf20: 0d0a 2020 2020 4372 6561 7465 2061 2070  ..    Create a p
+0001cf30: 6c6f 7420 6f66 2074 6865 2063 6f76 6172  lot of the covar
+0001cf40: 6961 6e63 6520 636f 6e66 6964 656e 6365  iance confidence
+0001cf50: 2065 6c6c 6970 7365 206f 6620 2a78 2a20   ellipse of *x* 
+0001cf60: 616e 6420 2a79 2a2e 0d0a 0d0a 2020 2020  and *y*.....    
+0001cf70: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+0001cf80: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+0001cf90: 782c 2079 203a 2061 7272 6179 2d6c 696b  x, y : array-lik
+0001cfa0: 652c 2073 6861 7065 2028 6e2c 2029 0d0a  e, shape (n, )..
+0001cfb0: 2020 2020 2020 2020 496e 7075 7420 6461          Input da
+0001cfc0: 7461 2e0d 0a0d 0a20 2020 2061 7820 3a20  ta.....    ax : 
+0001cfd0: 6d61 7470 6c6f 746c 6962 2e61 7865 732e  matplotlib.axes.
+0001cfe0: 4178 6573 0d0a 2020 2020 2020 2020 5468  Axes..        Th
+0001cff0: 6520 6178 6573 206f 626a 6563 7420 746f  e axes object to
+0001d000: 2064 7261 7720 7468 6520 656c 6c69 7073   draw the ellips
+0001d010: 6520 696e 746f 2e0d 0a0d 0a20 2020 206e  e into.....    n
+0001d020: 5f73 7464 203a 2066 6c6f 6174 0d0a 2020  _std : float..  
+0001d030: 2020 2020 2020 5468 6520 6e75 6d62 6572        The number
+0001d040: 206f 6620 7374 616e 6461 7264 2064 6576   of standard dev
+0001d050: 6961 7469 6f6e 7320 746f 2064 6574 6572  iations to deter
+0001d060: 6d69 6e65 2074 6865 2065 6c6c 6970 7365  mine the ellipse
+0001d070: 2773 2072 6164 6975 7365 732e 0d0a 0d0a  's radiuses.....
+0001d080: 2020 2020 2a2a 6b77 6172 6773 0d0a 2020      **kwargs..  
+0001d090: 2020 2020 2020 466f 7277 6172 6465 6420        Forwarded 
+0001d0a0: 746f 2060 7e6d 6174 706c 6f74 6c69 622e  to `~matplotlib.
+0001d0b0: 7061 7463 6865 732e 456c 6c69 7073 6560  patches.Ellipse`
+0001d0c0: 0d0a 0d0a 2020 2020 5265 7475 726e 730d  ....    Returns.
+0001d0d0: 0a20 2020 202d 2d2d 2d2d 2d2d 0d0a 2020  .    -------..  
+0001d0e0: 2020 6d70 6c2e 7061 7463 6865 732e 456c    mpl.patches.El
+0001d0f0: 6c69 7073 650d 0a20 2020 2022 2222 0d0a  lipse..    """..
+0001d100: 2020 2020 6966 2078 2e73 697a 6520 213d      if x.size !=
+0001d110: 2079 2e73 697a 653a 0d0a 2020 2020 2020   y.size:..      
+0001d120: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0001d130: 6f72 2822 7820 616e 6420 7920 6d75 7374  or("x and y must
+0001d140: 2062 6520 7468 6520 7361 6d65 2073 697a   be the same siz
+0001d150: 6522 290d 0a0d 0a20 2020 2063 6f76 203d  e")....    cov =
+0001d160: 206e 702e 636f 7628 782c 2079 290d 0a20   np.cov(x, y).. 
+0001d170: 2020 2070 6561 7273 6f6e 203d 2063 6f76     pearson = cov
+0001d180: 5b30 2c20 315d 2f6e 702e 7371 7274 2863  [0, 1]/np.sqrt(c
+0001d190: 6f76 5b30 2c20 305d 202a 2063 6f76 5b31  ov[0, 0] * cov[1
+0001d1a0: 2c20 315d 290d 0a20 2020 2023 2055 7369  , 1])..    # Usi
+0001d1b0: 6e67 2061 2073 7065 6369 616c 2063 6173  ng a special cas
+0001d1c0: 6520 746f 206f 6274 6169 6e20 7468 6520  e to obtain the 
+0001d1d0: 6569 6765 6e76 616c 7565 7320 6f66 2074  eigenvalues of t
+0001d1e0: 6869 730d 0a20 2020 2023 2074 776f 2d64  his..    # two-d
+0001d1f0: 696d 656e 7369 6f6e 616c 2064 6174 6173  imensional datas
+0001d200: 6574 2e0d 0a20 2020 2065 6c6c 5f72 6164  et...    ell_rad
+0001d210: 6975 735f 7820 3d20 6e70 2e73 7172 7428  ius_x = np.sqrt(
+0001d220: 3120 2b20 7065 6172 736f 6e29 0d0a 2020  1 + pearson)..  
+0001d230: 2020 656c 6c5f 7261 6469 7573 5f79 203d    ell_radius_y =
+0001d240: 206e 702e 7371 7274 2831 202d 2070 6561   np.sqrt(1 - pea
+0001d250: 7273 6f6e 290d 0a20 2020 2065 6c6c 6970  rson)..    ellip
+0001d260: 7365 203d 2045 6c6c 6970 7365 2828 302c  se = Ellipse((0,
+0001d270: 2030 292c 2077 6964 7468 3d65 6c6c 5f72   0), width=ell_r
+0001d280: 6164 6975 735f 7820 2a20 322c 2068 6569  adius_x * 2, hei
+0001d290: 6768 743d 656c 6c5f 7261 6469 7573 5f79  ght=ell_radius_y
+0001d2a0: 202a 2032 2c0d 0a20 2020 2020 2020 2020   * 2,..         
+0001d2b0: 2020 2020 2020 2020 2020 2020 2066 6163               fac
+0001d2c0: 6563 6f6c 6f72 3d66 6163 6563 6f6c 6f72  ecolor=facecolor
+0001d2d0: 2c20 2a2a 6b77 6172 6773 290d 0a0d 0a20  , **kwargs).... 
+0001d2e0: 2020 2023 2043 616c 6375 6c61 7469 6e67     # Calculating
+0001d2f0: 2074 6865 2073 7461 6e64 6172 6420 6465   the standard de
+0001d300: 7669 6174 696f 6e20 6f66 2078 2066 726f  viation of x fro
+0001d310: 6d0d 0a20 2020 2023 2074 6865 2073 7175  m..    # the squ
+0001d320: 6172 6572 6f6f 7420 6f66 2074 6865 2076  areroot of the v
+0001d330: 6172 6961 6e63 6520 616e 6420 6d75 6c74  ariance and mult
+0001d340: 6970 6c79 696e 670d 0a20 2020 2023 2077  iplying..    # w
+0001d350: 6974 6820 7468 6520 6769 7665 6e20 6e75  ith the given nu
+0001d360: 6d62 6572 206f 6620 7374 616e 6461 7264  mber of standard
+0001d370: 2064 6576 6961 7469 6f6e 732e 0d0a 2020   deviations...  
+0001d380: 2020 7363 616c 655f 7820 3d20 6e70 2e73    scale_x = np.s
+0001d390: 7172 7428 636f 765b 302c 2030 5d29 202a  qrt(cov[0, 0]) *
+0001d3a0: 206e 5f73 7464 0d0a 2020 2020 6d65 616e   n_std..    mean
+0001d3b0: 5f78 203d 206e 702e 6d65 616e 2878 290d  _x = np.mean(x).
+0001d3c0: 0a0d 0a20 2020 2023 2063 616c 6375 6c61  ...    # calcula
+0001d3d0: 7469 6e67 2074 6865 2073 7461 6e64 6172  ting the standar
+0001d3e0: 6420 6465 7669 6174 696f 6e20 6f66 2079  d deviation of y
+0001d3f0: 202e 2e2e 0d0a 2020 2020 7363 616c 655f   .....    scale_
+0001d400: 7920 3d20 6e70 2e73 7172 7428 636f 765b  y = np.sqrt(cov[
+0001d410: 312c 2031 5d29 202a 206e 5f73 7464 0d0a  1, 1]) * n_std..
+0001d420: 2020 2020 6d65 616e 5f79 203d 206e 702e      mean_y = np.
+0001d430: 6d65 616e 2879 290d 0a0d 0a20 2020 2074  mean(y)....    t
+0001d440: 7261 6e73 6620 3d20 7472 616e 7366 6f72  ransf = transfor
+0001d450: 6d73 2e41 6666 696e 6532 4428 2920 5c0d  ms.Affine2D() \.
+0001d460: 0a20 2020 2020 2020 202e 726f 7461 7465  .        .rotate
+0001d470: 5f64 6567 2834 3529 205c 0d0a 2020 2020  _deg(45) \..    
+0001d480: 2020 2020 2e73 6361 6c65 2873 6361 6c65      .scale(scale
+0001d490: 5f78 2c20 7363 616c 655f 7929 205c 0d0a  _x, scale_y) \..
+0001d4a0: 2020 2020 2020 2020 2e74 7261 6e73 6c61          .transla
+0001d4b0: 7465 286d 6561 6e5f 782c 206d 6561 6e5f  te(mean_x, mean_
+0001d4c0: 7929 0d0a 0d0a 2020 2020 656c 6c69 7073  y)....    ellips
+0001d4d0: 652e 7365 745f 7472 616e 7366 6f72 6d28  e.set_transform(
+0001d4e0: 7472 616e 7366 202b 2061 782e 7472 616e  transf + ax.tran
+0001d4f0: 7344 6174 6129 0d0a 2020 2020 7265 7475  sData)..    retu
+0001d500: 726e 2061 782e 6164 645f 7061 7463 6828  rn ax.add_patch(
+0001d510: 656c 6c69 7073 6529 2020 0d0a 2020 200d  ellipse)  ..   .
+0001d520: 0a64 6566 2070 6c6f 745f 7374 7269 6b65  .def plot_strike
+0001d530: 2028 0d0a 2020 2020 6c69 7374 5f6f 665f   (..    list_of_
+0001d540: 6564 6973 2c20 2f2c 200d 0a20 2020 206b  edis, /, ..    k
+0001d550: 696e 6420 3d20 322c 0d0a 2020 2020 7065  ind = 2,..    pe
+0001d560: 7269 6f64 5f74 6f6c 6572 616e 6365 3d2e  riod_tolerance=.
+0001d570: 3035 2c20 0d0a 2020 2020 7465 7874 5f70  05, ..    text_p
+0001d580: 6164 203d 312e 3635 202c 200d 0a20 2020  ad =1.65 , ..   
+0001d590: 2072 6f74 5f7a 3d30 2e20 2c20 0d0a 2020   rot_z=0. , ..  
+0001d5a0: 2020 2a2a 6b77 730d 0a20 2020 2029 3a20    **kws..    ): 
+0001d5b0: 0d0a 2020 2020 0d0a 2020 2020 6578 7472  ..    ..    extr
+0001d5c0: 6120 3d28 2250 6c6f 7453 7472 696b 6520  a =("PlotStrike 
+0001d5d0: 7573 6573 2027 6d74 7079 2720 6f72 2027  uses 'mtpy' or '
+0001d5e0: 7079 6373 616d 7427 2061 7320 6465 7065  pycsamt' as depe
+0001d5f0: 6e64 656e 6379 2e22 0d0a 2020 2020 2020  ndency."..      
+0001d600: 2020 2020 2020 290d 0a20 2020 2069 6d70        )..    imp
+0001d610: 6f72 745f 6f70 7469 6f6e 616c 5f64 6570  ort_optional_dep
+0001d620: 656e 6465 6e63 7920 2827 6d74 7079 272c  endency ('mtpy',
+0001d630: 2065 7874 7261 203d 2065 7874 7261 2029   extra = extra )
+0001d640: 0d0a 2020 2020 2378 7878 7878 7878 7878  ..    #xxxxxxxxx
+0001d650: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
 0001d660: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0001d670: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0001d680: 7878 7878 7878 7878 0d0a 2020 2020 6672  xxxxxxxx..    fr
-0001d690: 6f6d 206d 7470 792e 696d 6167 696e 672e  om mtpy.imaging.
-0001d6a0: 706c 6f74 7374 7269 6b65 2069 6d70 6f72  plotstrike impor
-0001d6b0: 7420 506c 6f74 5374 7269 6b65 0d0a 2020  t PlotStrike..  
-0001d6c0: 2020 6672 6f6d 202e 2e70 726f 7065 7274    from ..propert
-0001d6d0: 7920 696d 706f 7274 2049 7345 6469 0d0a  y import IsEdi..
-0001d6e0: 2020 2020 2378 7878 7878 7878 7878 7878      #xxxxxxxxxxx
+0001d670: 7878 7878 7878 7878 0d0a 2020 2020 6672  xxxxxxxx..    fr
+0001d680: 6f6d 206d 7470 792e 696d 6167 696e 672e  om mtpy.imaging.
+0001d690: 706c 6f74 7374 7269 6b65 2069 6d70 6f72  plotstrike impor
+0001d6a0: 7420 506c 6f74 5374 7269 6b65 0d0a 2020  t PlotStrike..  
+0001d6b0: 2020 6672 6f6d 202e 2e70 726f 7065 7274    from ..propert
+0001d6c0: 7920 696d 706f 7274 2049 7345 6469 0d0a  y import IsEdi..
+0001d6d0: 2020 2020 2378 7878 7878 7878 7878 7878      #xxxxxxxxxxx
+0001d6e0: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
 0001d6f0: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0001d700: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0001d710: 7878 7878 7878 0d0a 2020 2020 6966 2069  xxxxxx..    if i
-0001d720: 7369 6e73 7461 6e63 6520 2820 6c69 7374  sinstance ( list
-0001d730: 5f6f 665f 6564 6973 2c20 7374 7229 3a20  _of_edis, str): 
-0001d740: 0d0a 2020 2020 2020 2020 6966 206f 732e  ..        if os.
-0001d750: 7061 7468 2e69 7364 6972 2028 206c 6973  path.isdir ( lis
-0001d760: 745f 6f66 5f65 6469 7320 293a 200d 0a20  t_of_edis ): .. 
-0001d770: 2020 2020 2020 2020 2020 206c 6973 745f             list_
-0001d780: 6f66 5f65 6469 7320 3d20 5b6f 732e 7061  of_edis = [os.pa
-0001d790: 7468 2e6a 6f69 6e28 2066 2920 666f 7220  th.join( f) for 
-0001d7a0: 6620 696e 206f 732e 6c69 7374 6469 7220  f in os.listdir 
-0001d7b0: 286c 6973 745f 6f66 5f65 6469 7329 0d0a  (list_of_edis)..
-0001d7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d7d0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001d7e0: 7472 2866 292e 6c6f 7765 7228 292e 656e  tr(f).lower().en
-0001d7f0: 6473 7769 7468 2028 272e 6564 6927 295d  dswith ('.edi')]
-0001d800: 0d0a 2020 2020 2020 2020 6966 206f 732e  ..        if os.
-0001d810: 7061 7468 2e69 7366 696c 6520 286c 6973  path.isfile (lis
-0001d820: 745f 6f66 5f65 6469 7329 3a20 0d0a 2020  t_of_edis): ..  
-0001d830: 2020 2020 2020 2020 2020 6c69 7374 5f6f            list_o
-0001d840: 665f 6564 6973 203d 5b6c 6973 745f 6f66  f_edis =[list_of
-0001d850: 5f65 6469 7320 5d0d 0a20 2020 2020 2020  _edis ]..       
-0001d860: 200d 0a20 2020 2023 206e 6f77 2063 6865   ..    # now che
-0001d870: 636b 2077 6865 7468 6572 2069 7320 7661  ck whether is va
-0001d880: 6c69 6420 4544 4920 2020 2020 0d0a 2020  lid EDI     ..  
-0001d890: 2020 2320 6c69 7374 2063 6f6d 7072 6568    # list compreh
-0001d8a0: 656e 7369 6f6e 2066 6173 7465 7220 7468  ension faster th
-0001d8b0: 616e 0d0a 2020 2020 2320 7475 706c 6520  an..    # tuple 
-0001d8c0: 286d 6170 2028 6c61 6d62 6461 2066 3a20  (map (lambda f: 
-0001d8d0: 2049 7345 6469 2e5f 6173 7365 7274 5f65   IsEdi._assert_e
-0001d8e0: 6469 2028 6620 292c 206c 6973 745f 6f66  di (f ), list_of
-0001d8f0: 5f65 6469 7320 2920 290d 0a20 2020 205b  _edis ) )..    [
-0001d900: 2049 7345 6469 2e5f 6173 7365 7274 5f65   IsEdi._assert_e
-0001d910: 6469 2028 6620 2920 666f 7220 6620 696e  di (f ) for f in
-0001d920: 206c 6973 745f 6f66 5f65 6469 7320 5d20   list_of_edis ] 
-0001d930: 0d0a 2020 2020 2320 7375 7070 7265 7373  ..    # suppress
-0001d940: 2074 6869 7264 2070 6172 7479 2076 6572   third party ver
-0001d950: 626f 7369 7479 200d 0a20 2020 2077 6974  bosity ..    wit
-0001d960: 6820 6e75 6c6c 6966 795f 6f75 7470 7574  h nullify_output
-0001d970: 2829 3a0d 0a20 2020 2020 2020 2050 6c6f  ():..        Plo
-0001d980: 7453 7472 696b 6528 0d0a 2020 2020 2020  tStrike(..      
-0001d990: 2020 2020 2020 666e 5f6c 6973 743d 6c69        fn_list=li
-0001d9a0: 7374 5f6f 665f 6564 6973 2c0d 0a20 2020  st_of_edis,..   
-0001d9b0: 2020 2020 2020 2020 2070 6c6f 745f 7479           plot_ty
-0001d9c0: 7065 3d6b 696e 642c 0d0a 2020 2020 2020  pe=kind,..      
-0001d9d0: 2020 2020 2020 2a2a 6b77 730d 0a20 2020        **kws..   
-0001d9e0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-0001d9f0: 2020 2020 0d0a 706c 6f74 5f73 7472 696b      ..plot_strik
-0001da00: 652e 5f5f 646f 635f 5f3d 2222 2220 0d0a  e.__doc__=""" ..
-0001da10: 506c 6f74 2074 6865 2073 7472 696b 6520  Plot the strike 
-0001da20: 6573 7469 6d61 7465 6420 6672 6f6d 2074  estimated from t
-0001da30: 6865 2069 6e76 6172 6961 6e74 7320 616e  he invariants an
-0001da40: 6420 7068 6173 6520 7465 6e73 6f72 2e20  d phase tensor. 
-0001da50: 0d0a 696e 2061 2072 6f73 6520 6469 6167  ..in a rose diag
-0001da60: 7261 6d20 6f66 2078 7920 706c 6f74 2e20  ram of xy plot. 
-0001da70: 0d0a 0d0a 5061 7261 6d65 7465 7273 200d  ....Parameters .
-0001da80: 0a2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a6c  .------------..l
-0001da90: 6973 745f 6f66 5f65 6469 733a 206c 6973  ist_of_edis: lis
-0001daa0: 742c 200d 0a20 2020 2066 756c 6c20 7061  t, ..    full pa
-0001dab0: 7468 7320 746f 202e 6564 6920 6669 6c65  ths to .edi file
-0001dac0: 7320 746f 2070 6c6f 7420 6f72 206c 6973  s to plot or lis
-0001dad0: 7420 6f66 203a 7465 726d 3a60 4544 492d  t of :term:`EDI-
-0001dae0: 6669 6c65 7360 2e20 0d0a 2020 2020 0d0a  files`. ..    ..
-0001daf0: 2020 202e 2e20 7665 7273 696f 6e63 6861     .. versioncha
-0001db00: 6e67 6564 3a3a 2030 2e32 2e30 200d 0a20  nged:: 0.2.0 .. 
-0001db10: 2020 2020 204e 6f20 6e65 6564 2074 6f20       No need to 
-0001db20: 7072 6f76 6964 6520 6120 6c69 7374 206f  provide a list o
-0001db30: 6620 7465 726d 3a60 4544 4960 2066 696c  f term:`EDI` fil
-0001db40: 6573 2e20 4865 6e63 6566 6f72 7468 2060  es. Henceforth `
-0001db50: 6c69 7374 5f6f 665f 6564 6973 600d 0a20  list_of_edis`.. 
-0001db60: 2020 2020 2061 6363 6570 7473 2074 6865       accepts the
-0001db70: 2045 4449 2070 6174 682d 6c69 6b65 206f   EDI path-like o
-0001db80: 626a 6563 7420 6f66 2073 696e 676c 6520  bject of single 
-0001db90: 4544 4920 6669 6c65 2074 6865 6e20 6173  EDI file then as
-0001dba0: 7365 7274 7320 0d0a 2020 2020 2020 7468  serts ..      th
-0001dbb0: 6520 7661 6c69 6469 7479 206f 6620 7468  e validity of th
-0001dbc0: 6520 4544 4920 6669 6c65 7320 6166 7465  e EDI files afte
-0001dbd0: 7277 6172 642e 200d 0a0d 0a6b 696e 643a  rward. ....kind:
-0001dbe0: 2069 6e74 2c20 6465 6661 756c 743d 3220   int, default=2 
-0001dbf0: 0d0a 2020 2020 4361 6e20 6265 205b 2031  ..    Can be [ 1
-0001dc00: 207c 2032 205d 2077 6865 7265 3a0d 0a20   | 2 ] where:.. 
-0001dc10: 2020 2020 2020 0d0a 2020 202d 202a 312a        ..   - *1*
-0001dc20: 2074 6f20 706c 6f74 2069 6e64 6976 6964   to plot individ
-0001dc30: 7561 6c20 6465 6361 6465 7320 696e 206f  ual decades in o
-0001dc40: 6e65 2070 6c6f 740d 0a20 2020 2d20 2a32  ne plot..   - *2
-0001dc50: 2a20 746f 2070 6c6f 7420 616c 6c20 7065  * to plot all pe
-0001dc60: 7269 6f64 2072 616e 6765 7320 696e 746f  riod ranges into
-0001dc70: 206f 6e65 2070 6f6c 6172 2064 6961 6772   one polar diagr
-0001dc80: 616d 2066 6f72 2065 6163 6820 0d0a 2020  am for each ..  
-0001dc90: 2020 2073 7472 696b 6520 616e 676c 6520     strike angle 
-0001dca0: 6573 7469 6d61 7469 6f6e 0d0a 2020 2020  estimation..    
-0001dcb0: 2020 2020 200d 0a20 2020 4f6e 6520 636f       ..   One co
-0001dcc0: 756c 6420 7472 7920 616c 736f 2070 6c6f  uld try also plo
-0001dcd0: 745f 7479 7065 203d 2031 2074 6f20 706c  t_type = 1 to pl
-0001dce0: 6f74 2062 7920 6465 6361 6465 0d0a 2020  ot by decade..  
+0001d700: 7878 7878 7878 0d0a 2020 2020 6966 2069  xxxxxx..    if i
+0001d710: 7369 6e73 7461 6e63 6520 2820 6c69 7374  sinstance ( list
+0001d720: 5f6f 665f 6564 6973 2c20 7374 7229 3a20  _of_edis, str): 
+0001d730: 0d0a 2020 2020 2020 2020 6966 206f 732e  ..        if os.
+0001d740: 7061 7468 2e69 7364 6972 2028 206c 6973  path.isdir ( lis
+0001d750: 745f 6f66 5f65 6469 7320 293a 200d 0a20  t_of_edis ): .. 
+0001d760: 2020 2020 2020 2020 2020 206c 6973 745f             list_
+0001d770: 6f66 5f65 6469 7320 3d20 5b6f 732e 7061  of_edis = [os.pa
+0001d780: 7468 2e6a 6f69 6e28 2066 2920 666f 7220  th.join( f) for 
+0001d790: 6620 696e 206f 732e 6c69 7374 6469 7220  f in os.listdir 
+0001d7a0: 286c 6973 745f 6f66 5f65 6469 7329 0d0a  (list_of_edis)..
+0001d7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d7c0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001d7d0: 7472 2866 292e 6c6f 7765 7228 292e 656e  tr(f).lower().en
+0001d7e0: 6473 7769 7468 2028 272e 6564 6927 295d  dswith ('.edi')]
+0001d7f0: 0d0a 2020 2020 2020 2020 6966 206f 732e  ..        if os.
+0001d800: 7061 7468 2e69 7366 696c 6520 286c 6973  path.isfile (lis
+0001d810: 745f 6f66 5f65 6469 7329 3a20 0d0a 2020  t_of_edis): ..  
+0001d820: 2020 2020 2020 2020 2020 6c69 7374 5f6f            list_o
+0001d830: 665f 6564 6973 203d 5b6c 6973 745f 6f66  f_edis =[list_of
+0001d840: 5f65 6469 7320 5d0d 0a20 2020 2020 2020  _edis ]..       
+0001d850: 200d 0a20 2020 2023 206e 6f77 2063 6865   ..    # now che
+0001d860: 636b 2077 6865 7468 6572 2069 7320 7661  ck whether is va
+0001d870: 6c69 6420 4544 4920 2020 2020 0d0a 2020  lid EDI     ..  
+0001d880: 2020 2320 6c69 7374 2063 6f6d 7072 6568    # list compreh
+0001d890: 656e 7369 6f6e 2066 6173 7465 7220 7468  ension faster th
+0001d8a0: 616e 0d0a 2020 2020 2320 7475 706c 6520  an..    # tuple 
+0001d8b0: 286d 6170 2028 6c61 6d62 6461 2066 3a20  (map (lambda f: 
+0001d8c0: 2049 7345 6469 2e5f 6173 7365 7274 5f65   IsEdi._assert_e
+0001d8d0: 6469 2028 6620 292c 206c 6973 745f 6f66  di (f ), list_of
+0001d8e0: 5f65 6469 7320 2920 290d 0a20 2020 205b  _edis ) )..    [
+0001d8f0: 2049 7345 6469 2e5f 6173 7365 7274 5f65   IsEdi._assert_e
+0001d900: 6469 2028 6620 2920 666f 7220 6620 696e  di (f ) for f in
+0001d910: 206c 6973 745f 6f66 5f65 6469 7320 5d20   list_of_edis ] 
+0001d920: 0d0a 2020 2020 2320 7375 7070 7265 7373  ..    # suppress
+0001d930: 2074 6869 7264 2070 6172 7479 2076 6572   third party ver
+0001d940: 626f 7369 7479 200d 0a20 2020 2077 6974  bosity ..    wit
+0001d950: 6820 6e75 6c6c 6966 795f 6f75 7470 7574  h nullify_output
+0001d960: 2829 3a0d 0a20 2020 2020 2020 2050 6c6f  ():..        Plo
+0001d970: 7453 7472 696b 6528 0d0a 2020 2020 2020  tStrike(..      
+0001d980: 2020 2020 2020 666e 5f6c 6973 743d 6c69        fn_list=li
+0001d990: 7374 5f6f 665f 6564 6973 2c0d 0a20 2020  st_of_edis,..   
+0001d9a0: 2020 2020 2020 2020 2070 6c6f 745f 7479           plot_ty
+0001d9b0: 7065 3d6b 696e 642c 0d0a 2020 2020 2020  pe=kind,..      
+0001d9c0: 2020 2020 2020 2a2a 6b77 730d 0a20 2020        **kws..   
+0001d9d0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+0001d9e0: 2020 2020 0d0a 706c 6f74 5f73 7472 696b      ..plot_strik
+0001d9f0: 652e 5f5f 646f 635f 5f3d 2222 2220 0d0a  e.__doc__=""" ..
+0001da00: 506c 6f74 2074 6865 2073 7472 696b 6520  Plot the strike 
+0001da10: 6573 7469 6d61 7465 6420 6672 6f6d 2074  estimated from t
+0001da20: 6865 2069 6e76 6172 6961 6e74 7320 616e  he invariants an
+0001da30: 6420 7068 6173 6520 7465 6e73 6f72 2e20  d phase tensor. 
+0001da40: 0d0a 696e 2061 2072 6f73 6520 6469 6167  ..in a rose diag
+0001da50: 7261 6d20 6f66 2078 7920 706c 6f74 2e20  ram of xy plot. 
+0001da60: 0d0a 0d0a 5061 7261 6d65 7465 7273 200d  ....Parameters .
+0001da70: 0a2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a6c  .------------..l
+0001da80: 6973 745f 6f66 5f65 6469 733a 206c 6973  ist_of_edis: lis
+0001da90: 742c 200d 0a20 2020 2066 756c 6c20 7061  t, ..    full pa
+0001daa0: 7468 7320 746f 202e 6564 6920 6669 6c65  ths to .edi file
+0001dab0: 7320 746f 2070 6c6f 7420 6f72 206c 6973  s to plot or lis
+0001dac0: 7420 6f66 203a 7465 726d 3a60 4544 4960  t of :term:`EDI`
+0001dad0: 2066 696c 6573 2e20 0d0a 2020 2020 0d0a   files. ..    ..
+0001dae0: 2020 202e 2e20 7665 7273 696f 6e63 6861     .. versioncha
+0001daf0: 6e67 6564 3a3a 2030 2e32 2e30 200d 0a20  nged:: 0.2.0 .. 
+0001db00: 2020 2020 204e 6f20 6e65 6564 2074 6f20       No need to 
+0001db10: 7072 6f76 6964 6520 6120 6c69 7374 206f  provide a list o
+0001db20: 6620 7465 726d 3a60 4544 4960 2066 696c  f term:`EDI` fil
+0001db30: 6573 2e20 4865 6e63 6566 6f72 7468 2060  es. Henceforth `
+0001db40: 6c69 7374 5f6f 665f 6564 6973 600d 0a20  list_of_edis`.. 
+0001db50: 2020 2020 2061 6363 6570 7473 2074 6865       accepts the
+0001db60: 2045 4449 2070 6174 682d 6c69 6b65 206f   EDI path-like o
+0001db70: 626a 6563 7420 6f66 2073 696e 676c 6520  bject of single 
+0001db80: 4544 4920 6669 6c65 2074 6865 6e20 6173  EDI file then as
+0001db90: 7365 7274 7320 0d0a 2020 2020 2020 7468  serts ..      th
+0001dba0: 6520 7661 6c69 6469 7479 206f 6620 7468  e validity of th
+0001dbb0: 6520 4544 4920 6669 6c65 7320 6166 7465  e EDI files afte
+0001dbc0: 7277 6172 642e 200d 0a0d 0a6b 696e 643a  rward. ....kind:
+0001dbd0: 2069 6e74 2c20 6465 6661 756c 743d 3220   int, default=2 
+0001dbe0: 0d0a 2020 2020 4361 6e20 6265 205b 2031  ..    Can be [ 1
+0001dbf0: 207c 2032 205d 2077 6865 7265 3a0d 0a20   | 2 ] where:.. 
+0001dc00: 2020 2020 2020 0d0a 2020 202d 202a 312a        ..   - *1*
+0001dc10: 2074 6f20 706c 6f74 2069 6e64 6976 6964   to plot individ
+0001dc20: 7561 6c20 6465 6361 6465 7320 696e 206f  ual decades in o
+0001dc30: 6e65 2070 6c6f 740d 0a20 2020 2d20 2a32  ne plot..   - *2
+0001dc40: 2a20 746f 2070 6c6f 7420 616c 6c20 7065  * to plot all pe
+0001dc50: 7269 6f64 2072 616e 6765 7320 696e 746f  riod ranges into
+0001dc60: 206f 6e65 2070 6f6c 6172 2064 6961 6772   one polar diagr
+0001dc70: 616d 2066 6f72 2065 6163 6820 0d0a 2020  am for each ..  
+0001dc80: 2020 2073 7472 696b 6520 616e 676c 6520     strike angle 
+0001dc90: 6573 7469 6d61 7469 6f6e 0d0a 2020 2020  estimation..    
+0001dca0: 2020 2020 200d 0a20 2020 4f6e 6520 636f       ..   One co
+0001dcb0: 756c 6420 7472 7920 616c 736f 2070 6c6f  uld try also plo
+0001dcc0: 745f 7479 7065 203d 2031 2074 6f20 706c  t_type = 1 to pl
+0001dcd0: 6f74 2062 7920 6465 6361 6465 0d0a 2020  ot by decade..  
+0001dce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001dd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001dd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd30: 200d 0a66 6967 5f6e 756d 3a20 696e 742c   ..fig_num: int,
-0001dd40: 2064 6566 6175 6c74 3d31 2c20 0d0a 2020   default=1, ..  
-0001dd50: 2066 6967 7572 6520 6e75 6d62 6572 2074   figure number t
-0001dd60: 6f20 6265 2070 6c6f 7474 6564 2e20 2a44  o be plotted. *D
-0001dd70: 6566 6175 6c74 2a20 6973 2031 0d0a 2020  efault* is 1..  
-0001dd80: 2020 2020 2020 0d0a 666f 6e74 5f73 697a        ..font_siz
-0001dd90: 653a 2066 6c6f 6174 2c20 6465 6661 756c  e: float, defaul
-0001dda0: 743d 3130 2c20 0d0a 2020 2046 6967 7572  t=10, ..   Figur
-0001ddb0: 6520 7369 7a65 200d 0a20 2020 0d0a 726f  e size ..   ..ro
-0001ddc0: 745f 7a3a 2066 6c6f 6174 2c20 6465 6661  t_z: float, defa
-0001ddd0: 756c 743d 302e 2c20 0d0a 2020 2061 6e67  ult=0., ..   ang
-0001dde0: 6c65 206f 6620 726f 7461 7469 6f6e 2063  le of rotation c
-0001ddf0: 6c6f 636b 7769 7365 2070 6f73 6974 6976  lockwise positiv
-0001de00: 652e 200d 0a0d 0a70 6572 696f 645f 746f  e. ....period_to
-0001de10: 6c65 7261 6e63 653a 2066 6c6f 6174 2c20  lerance: float, 
-0001de20: 6465 6661 756c 743d 2e30 3520 0d0a 2020  default=.05 ..  
-0001de30: 2020 546f 6c65 7261 6e63 6520 6c65 7665    Tolerance leve
-0001de40: 6c20 746f 206d 6174 6368 2070 6572 696f  l to match perio
-0001de50: 6473 2066 726f 6d20 6469 6666 6572 656e  ds from differen
-0001de60: 7420 6564 6920 6669 6c65 732e 0d0a 2020  t edi files...  
-0001de70: 2020 2a44 6566 6175 6c74 2a20 6973 2030    *Default* is 0
-0001de80: 2e30 350d 0a0d 0a74 6578 745f 7061 643a  .05....text_pad:
-0001de90: 2066 6c6f 6174 2c20 6465 6661 756c 743d   float, default=
-0001dea0: 312e 3635 0d0a 2020 2070 6164 6469 6e67  1.65..   padding
-0001deb0: 206f 6620 7468 6520 616e 676c 6520 6c61   of the angle la
-0001dec0: 6265 6c20 6174 2074 6865 2062 6f74 746f  bel at the botto
-0001ded0: 6d20 6f66 2065 6163 680d 0a20 2020 2020  m of each..     
-0001dee0: 2020 2020 2020 2020 2020 2020 706f 6c61              pola
-0001def0: 7220 6469 6167 7261 6d2e 2020 2a44 6566  r diagram.  *Def
-0001df00: 6175 6c74 2a20 6973 2031 2e36 350d 0a70  ault* is 1.65..p
-0001df10: 6c6f 745f 7261 6e67 653a 2020 7374 722c  lot_range:  str,
-0001df20: 2074 7570 6c65 200d 0a20 2020 5468 6520   tuple ..   The 
-0001df30: 7065 7269 6f64 2072 616e 6765 2074 6f20  period range to 
-0001df40: 6573 7469 6d61 7465 2074 6865 2073 7472  estimate the str
-0001df50: 696b 6520 616e 676c 652e 2049 7420 6361  ike angle. It ca
-0001df60: 6e20 6265 200d 0a20 2020 5b20 2764 6174  n be ..   [ 'dat
-0001df70: 6127 207c 2028 7065 7269 6f64 5f6d 696e  a' | (period_min
-0001df80: 2c70 6572 696f 645f 6d61 7829 205d 2e20  ,period_max) ]. 
-0001df90: 204f 7074 696f 6e73 2061 7265 3a0d 0a20   Options are:.. 
-0001dfa0: 2020 2020 2020 0d0a 2020 202a 202a 2764        ..   * *'d
-0001dfb0: 6174 6127 2a20 666f 7220 6573 7469 6d61  ata'* for estima
-0001dfc0: 7469 6e67 2074 6865 2073 7472 696b 6520  ting the strike 
-0001dfd0: 666f 7220 616c 6c20 7065 7269 6f64 730d  for all periods.
-0001dfe0: 0a20 2020 2020 696e 2074 6865 2064 6174  .     in the dat
-0001dff0: 612e 0d0a 2020 202a 2028 706d 696e 2c70  a...   * (pmin,p
-0001e000: 6d61 7829 2066 6f72 2070 6572 696f 6420  max) for period 
-0001e010: 6d69 6e20 616e 6420 7065 7269 6f64 206d  min and period m
-0001e020: 6178 2c20 696e 7075 7420 6173 0d0a 2020  ax, input as..  
-0001e030: 2020 2028 6c6f 6731 3028 706d 696e 292c     (log10(pmin),
-0001e040: 6c6f 6731 3028 706d 6178 2929 0d0a 0d0a  log10(pmax))....
-0001e050: 706c 6f74 5f74 6970 7065 723a 205b 2054  plot_tipper: [ T
-0001e060: 7275 6520 7c20 4661 6c73 6520 5d0d 0a20  rue | False ].. 
-0001e070: 2020 202d 2054 7275 6520 746f 2070 6c6f     - True to plo
-0001e080: 7420 7468 6520 7469 7070 6572 2073 7472  t the tipper str
-0001e090: 696b 650d 0a20 2020 202d 2046 616c 7365  ike..    - False
-0001e0a0: 2074 6f20 6e6f 7420 706c 6f74 2074 6970   to not plot tip
-0001e0b0: 7065 7220 7374 7269 6b65 0d0a 2020 200d  per strike..   .
-0001e0c0: 0a70 745f 6572 726f 725f 666c 6f6f 723a  .pt_error_floor:
-0001e0d0: 2069 6e74 2c20 6f70 7469 6f6e 616c 200d   int, optional .
-0001e0e0: 0a20 2020 4d61 7869 6d75 6d20 6572 726f  .   Maximum erro
-0001e0f0: 7220 696e 2064 6567 7265 6573 2074 6861  r in degrees tha
-0001e100: 7420 6973 2061 6c6c 6f77 6564 2074 6f20  t is allowed to 
-0001e110: 0d0a 2020 2065 7374 696d 6174 6520 7374  ..   estimate st
-0001e120: 7269 6b65 2e20 2a44 6566 6175 6c74 2a20  rike. *Default* 
-0001e130: 6973 204e 6f6e 6520 616c 6c6f 7769 6e67  is None allowing
-0001e140: 2061 6c6c 200d 0a20 2020 6573 7469 6d61   all ..   estima
-0001e150: 7465 7320 746f 2062 6520 7573 6564 2e0d  tes to be used..
-0001e160: 0a0d 0a66 6f6c 643a 205b 2054 7275 6520  ...fold: [ True 
-0001e170: 7c20 4661 6c73 6520 5d0d 0a20 2020 2a20  | False ]..   * 
-0001e180: 5472 7565 2074 6f20 706c 6f74 206f 6e6c  True to plot onl
-0001e190: 7920 6672 6f6d 2030 2074 6f20 3138 300d  y from 0 to 180.
-0001e1a0: 0a20 2020 2a20 4661 6c73 6520 746f 2070  .   * False to p
-0001e1b0: 6c6f 7420 6672 6f6d 2030 2074 6f20 3336  lot from 0 to 36
-0001e1c0: 300d 0a20 2020 2020 2020 2020 2020 200d  0..            .
-0001e1d0: 0a70 6c6f 745f 6f72 7468 6f67 6f6e 616c  .plot_orthogonal
-0001e1e0: 3a20 5b20 5472 7565 207c 2046 616c 7365  : [ True | False
-0001e1f0: 5d0d 0a20 2020 202a 2054 7275 6520 746f  ]..    * True to
-0001e200: 2070 6c6f 7420 7468 6520 6f72 7468 6f67   plot the orthog
-0001e210: 6f6e 616c 2073 7472 696b 6520 6469 7265  onal strike dire
-0001e220: 6374 696f 6e73 0d0a 2020 2020 2a20 4661  ctions..    * Fa
-0001e230: 6c73 6520 746f 206e 6f74 0d0a 0d0a 636f  lse to not....co
-0001e240: 6c6f 723a 205b 2054 7275 6520 7c20 4661  lor: [ True | Fa
-0001e250: 6c73 6520 5d0d 0a20 2020 202a 2054 7275  lse ]..    * Tru
-0001e260: 6520 746f 2070 6c6f 7420 7368 6164 6520  e to plot shade 
-0001e270: 636f 6c6f 7273 0d0a 2020 2020 2a20 4661  colors..    * Fa
-0001e280: 6c73 6520 746f 2070 6c6f 7420 616c 6c20  lse to plot all 
-0001e290: 696e 206f 6e65 2063 6f6c 6f72 0d0a 2020  in one color..  
-0001e2a0: 2020 2020 2020 2020 2020 2020 0d0a 636f              ..co
-0001e2b0: 6c6f 725f 696e 763a 7374 722c 200d 0a20  lor_inv:str, .. 
-0001e2c0: 2020 636f 6c6f 7220 6f66 2069 6e76 6172    color of invar
-0001e2d0: 6961 6e74 7320 706c 6f74 730d 0a0d 0a63  iants plots....c
-0001e2e0: 6f6c 6f72 5f70 743a 2073 7472 2c20 0d0a  olor_pt: str, ..
-0001e2f0: 2020 2063 6f6c 6f72 206f 6620 7068 6173     color of phas
-0001e300: 6520 7465 6e73 6f72 2070 6c6f 7473 0d0a  e tensor plots..
-0001e310: 0d0a 636f 6c6f 725f 7469 703a 2073 7472  ..color_tip: str
-0001e320: 200d 0a20 2020 636f 6c6f 7220 6f66 2074   ..   color of t
-0001e330: 6970 7065 7220 706c 6f74 730d 0a0d 0a72  ipper plots....r
-0001e340: 696e 675f 7370 6163 696e 673a 2066 6c6f  ing_spacing: flo
-0001e350: 6174 2c20 6f70 7469 6f6e 616c 200d 0a20  at, optional .. 
-0001e360: 2020 2073 7061 6369 6e67 206f 6620 7269     spacing of ri
-0001e370: 6e67 7320 696e 2070 6f6c 6172 2070 6c6f  ngs in polar plo
-0001e380: 7473 0d0a 0d0a 7269 6e67 5f6c 696d 6974  ts....ring_limit
-0001e390: 733a 2074 7570 6c65 206f 6620 696e 742c  s: tuple of int,
-0001e3a0: 200d 0a20 2020 706c 6f74 206c 696d 6974   ..   plot limit
-0001e3b0: 7320 286d 696e 2063 6f75 6e74 2c20 6d61  s (min count, ma
-0001e3c0: 7820 636f 756e 7429 2073 6574 2065 6163  x count) set eac
-0001e3d0: 6820 706c 6f74 2068 6176 6520 7468 6573  h plot have thes
-0001e3e0: 6520 6c69 6d69 7473 200d 0a20 2020 2020  e limits ..     
-0001e3f0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-0001e400: 0a70 6c6f 745f 6f72 6965 6e74 6174 696f  .plot_orientatio
-0001e410: 6e3a 2073 7472 2c20 5b20 2768 2720 7c20  n: str, [ 'h' | 
-0001e420: 2776 2720 5d20 0d0a 2020 2068 6f72 697a  'v' ] ..   horiz
-0001e430: 6f6e 7461 6c20 6f72 2076 6572 7469 6361  ontal or vertica
-0001e440: 6c20 706c 6f74 730d 0a0d 0a0d 0a53 6565  l plots......See
-0001e450: 204d 6f72 650d 0a2d 2d2d 2d2d 2d2d 2d0d   More..--------.
-0001e460: 0a50 6c6f 7473 2074 6865 2073 7472 696b  .Plots the strik
-0001e470: 6520 616e 676c 6520 6173 2064 6574 6572  e angle as deter
-0001e480: 6d69 6e65 6420 6279 2069 6e76 6172 6961  mined by invaria
-0001e490: 6e74 7320 6f66 2074 6865 2069 6d70 6564  nts of the imped
-0001e4a0: 616e 6365 2074 656e 736f 7220 0d0a 2857  ance tensor ..(W
-0001e4b0: 6561 7665 7220 6574 2061 6c2e 205b 3230  eaver et al. [20
-0001e4c0: 3033 5d20 5b31 5d5f 2920 616e 6420 7068  03] [1]_) and ph
-0001e4d0: 6173 6520 7465 6e73 6f72 2061 7a69 6d75  ase tensor azimu
-0001e4e0: 7468 200d 0a28 4361 6c64 7765 6c6c 2065  th ..(Caldwell e
-0001e4f0: 7420 616c 2e20 5b32 3030 345d 205b 325d  t al. [2004] [2]
-0001e500: 5f29 200d 0a0d 0a54 6865 2064 6174 6120  _) ....The data 
-0001e510: 6973 2073 706c 6974 2069 6e74 6f20 6465  is split into de
-0001e520: 6361 6465 7320 7768 6572 6520 7468 6520  cades where the 
-0001e530: 6869 7374 6f67 7261 6d20 666f 7220 6561  histogram for ea
-0001e540: 6368 2069 7320 706c 6f74 7465 6420 696e  ch is plotted in
-0001e550: 0d0a 7468 6520 666f 726d 206f 6620 6120  ..the form of a 
-0001e560: 726f 7365 2064 6961 6772 616d 2077 6974  rose diagram wit
-0001e570: 6820 6120 7261 6e67 6520 6f66 2030 2074  h a range of 0 t
-0001e580: 6f20 3138 3020 6465 6772 6565 732e 0d0a  o 180 degrees...
-0001e590: 5768 6572 6520 3020 6973 204e 6f72 7468  Where 0 is North
-0001e5a0: 2061 6e64 2039 3020 6973 2045 6173 742e   and 90 is East.
-0001e5b0: 2020 5468 6520 6d65 6469 616e 2061 6e67    The median ang
-0001e5c0: 6c65 206f 6620 7468 6520 7065 7269 6f64  le of the period
-0001e5d0: 2062 616e 6420 6973 0d0a 7365 7420 696e   band is..set in
-0001e5e0: 2070 6f6c 6172 2064 6961 6772 616d 2e20   polar diagram. 
-0001e5f0: 2054 6865 2074 6f70 2072 6f77 2069 7320   The top row is 
-0001e600: 7468 6520 7374 7269 6b65 2065 7374 696d  the strike estim
-0001e610: 6174 6564 2066 726f 6d0d 0a74 6865 2069  ated from..the i
-0001e620: 6e76 6172 6961 6e74 7320 6f66 2074 6865  nvariants of the
-0001e630: 2069 6d70 6564 616e 6365 2074 656e 736f   impedance tenso
-0001e640: 722e 2020 5468 6520 626f 7474 6f6d 2072  r.  The bottom r
-0001e650: 6f77 2069 7320 7468 6520 617a 696d 7574  ow is the azimut
-0001e660: 680d 0a65 7374 696d 6174 6564 2066 726f  h..estimated fro
-0001e670: 6d20 7468 6520 7068 6173 6520 7465 6e73  m the phase tens
-0001e680: 6f72 2e20 2049 6620 7469 7070 6572 2069  or.  If tipper i
-0001e690: 7320 2779 2720 7468 656e 2074 6865 2033  s 'y' then the 3
-0001e6a0: 7264 2072 6f77 2069 7320 7468 650d 0a73  rd row is the..s
-0001e6b0: 7472 696b 6520 6465 7465 726d 696e 6564  trike determined
-0001e6c0: 2066 726f 6d20 7468 6520 7469 7070 6572   from the tipper
-0001e6d0: 2c20 7768 6963 6820 6973 206f 7274 686f  , which is ortho
-0001e6e0: 676f 6e61 6c20 746f 2074 6865 2069 6e64  gonal to the ind
-0001e6f0: 7563 7469 6f6e 0d0a 6172 726f 7720 6469  uction..arrow di
-0001e700: 7265 6374 696f 6e2e 0d0a 0d0a 5265 6665  rection.....Refe
-0001e710: 7265 6e63 6573 200d 0a2d 2d2d 2d2d 2d2d  rences ..-------
-0001e720: 2d2d 2d0d 0a2e 2e20 5b31 5d20 5765 6176  ---.... [1] Weav
-0001e730: 6572 204a 2e54 2c20 4c69 6c6c 6579 2046  er J.T, Lilley F
-0001e740: 2e45 2e4d 2e28 3230 3033 2920 2049 6e76  .E.M.(2003)  Inv
-0001e750: 6172 6961 6e74 7320 6f66 2072 6f74 6174  ariants of rotat
-0001e760: 696f 6e20 6f66 2061 7865 7320 616e 6420  ion of axes and 
-0001e770: 696e 6469 6361 746f 7273 206f 660d 0a20  indicators of.. 
-0001e780: 2020 2020 2020 6469 6d65 6e73 696f 6e61        dimensiona
-0001e790: 6c69 7479 2069 6e20 6d61 676e 6574 6f74  lity in magnetot
-0001e7a0: 656c 6c75 7269 6373 2c20 4175 7374 7261  ellurics, Austra
-0001e7b0: 6c69 616e 204e 6174 696f 6e61 6c20 556e  lian National Un
-0001e7c0: 6976 6572 7369 7479 2c0d 0a20 2020 2020  iversity,..     
-0001e7d0: 2020 556e 6976 6572 7369 7479 206f 6620    University of 
-0001e7e0: 5669 6374 6f72 6961 3b20 6874 7470 3a2f  Victoria; http:/
-0001e7f0: 2f62 6962 2e67 667a 2d70 6f74 7364 616d  /bib.gfz-potsdam
-0001e800: 2e64 652f 656d 7466 2f32 3030 372f 7064  .de/emtf/2007/pd
-0001e810: 662f 6c69 6c6c 6579 2e70 6466 0d0a 2e2e  f/lilley.pdf....
-0001e820: 205b 325d 2054 2e20 4772 616e 7420 4361   [2] T. Grant Ca
-0001e830: 6c64 7765 6c6c 2c20 4875 6768 204d 2e20  ldwell, Hugh M. 
-0001e840: 4269 6262 792c 2043 6f6c 696e 2042 726f  Bibby, Colin Bro
-0001e850: 776e 2c20 5468 6520 6d61 676e 6574 6f74  wn, The magnetot
-0001e860: 656c 6c75 7269 6320 7068 6173 6520 7465  elluric phase te
-0001e870: 6e73 6f72 2c20 0d0a 2020 2020 2020 2047  nsor, ..       G
-0001e880: 656f 7068 7973 6963 616c 204a 6f75 726e  eophysical Journ
-0001e890: 616c 2049 6e74 6572 6e61 7469 6f6e 616c  al International
-0001e8a0: 2c20 566f 6c75 6d65 2031 3538 2c20 4973  , Volume 158, Is
-0001e8b0: 7375 6520 322c 2041 7567 7573 7420 3230  sue 2, August 20
-0001e8c0: 3034 2c20 0d0a 2020 2020 2020 2050 6167  04, ..       Pag
-0001e8d0: 6573 2034 3537 e280 9334 3639 2c20 6874  es 457...469, ht
-0001e8e0: 7470 733a 2f2f 646f 692e 6f72 672f 3130  tps://doi.org/10
-0001e8f0: 2e31 3131 312f 6a2e 3133 3635 2d32 3436  .1111/j.1365-246
-0001e900: 582e 3230 3034 2e30 3232 3831 2e78 0d0a  X.2004.02281.x..
-0001e910: 4578 616d 706c 6573 200d 0a2d 2d2d 2d2d  Examples ..-----
-0001e920: 2d2d 2d2d 2d0d 0a3e 3e3e 2069 6d70 6f72  -----..>>> impor
-0001e930: 7420 6f73 200d 0a3e 3e3e 2066 726f 6d20  t os ..>>> from 
-0001e940: 7761 7465 782e 6461 7461 7365 7473 2069  watex.datasets i
-0001e950: 6d70 6f72 7420 6665 7463 685f 6461 7461  mport fetch_data
-0001e960: 200d 0a3e 3e3e 2066 726f 6d20 7761 7465   ..>>> from wate
-0001e970: 782e 7574 696c 732e 706c 6f74 7574 696c  x.utils.plotutil
-0001e980: 7320 696d 706f 7274 2070 6c6f 745f 7374  s import plot_st
-0001e990: 7269 6b65 200d 0a3e 3e3e 2066 726f 6d20  rike ..>>> from 
-0001e9a0: 7761 7465 782e 6461 7461 7365 7473 2e5f  watex.datasets._
-0001e9b0: 696f 2069 6d70 6f72 7420 6765 745f 6461  io import get_da
-0001e9c0: 7461 2023 2067 6574 2065 6469 6461 7461  ta # get edidata
-0001e9d0: 2069 6e20 6361 6368 6520 200d 0a3e 3e3e   in cache  ..>>>
-0001e9e0: 2066 6574 6368 5f64 6174 6120 2820 2768   fetch_data ( 'h
-0001e9f0: 7561 7975 616e 272c 2073 616d 706c 6573  uayuan', samples
-0001ea00: 203d 2032 3520 2920 2320 7374 6f72 6520   = 25 ) # store 
-0001ea10: 6564 6920 696e 2063 6163 6865 200d 0a3e  edi in cache ..>
-0001ea20: 3e3e 2023 2067 6574 2074 6865 2065 6469  >> # get the edi
-0001ea30: 2069 6e20 6361 6368 6520 616e 6420 706c   in cache and pl
-0001ea40: 6f74 5374 7269 6b65 200d 0a3e 3e3e 2065  otStrike ..>>> e
-0001ea50: 6469 5f66 6e5f 6c73 7420 3d20 5b6f 732e  di_fn_lst = [os.
-0001ea60: 7061 7468 2e6a 6f69 6e28 6765 745f 6461  path.join(get_da
-0001ea70: 7461 2829 2c66 6629 2066 6f72 2066 6620  ta(),ff) for ff 
-0001ea80: 696e 206f 732e 6c69 7374 6469 7228 6765  in os.listdir(ge
-0001ea90: 745f 6461 7461 2829 2920 0d0a 2e2e 2e20  t_data()) ..... 
-0001eaa0: 2020 2020 2020 2020 6966 2066 662e 656e          if ff.en
-0001eab0: 6473 7769 7468 2827 2e65 6469 2729 5d20  dswith('.edi')] 
-0001eac0: 0d0a 3e3e 3e20 706c 6f74 5f73 7472 696b  ..>>> plot_strik
-0001ead0: 6528 6564 695f 666e 5f6c 7374 2029 0d0a  e(edi_fn_lst )..
-0001eae0: 0d0a 2222 220d 0a64 6566 2070 6c6f 745f  .."""..def plot_
-0001eaf0: 7465 7874 2028 0d0a 2020 2020 782c 2079  text (..    x, y
-0001eb00: 2c20 0d0a 2020 2020 7465 7874 3d4e 6f6e  , ..    text=Non
-0001eb10: 6520 2c20 0d0a 2020 2020 6461 7461 203d  e , ..    data =
-0001eb20: 4e6f 6e65 2c20 0d0a 2020 2020 636f 6572  None, ..    coer
-0001eb30: 6365 203d 4661 6c73 652c 200d 0a20 2020  ce =False, ..   
-0001eb40: 2062 6173 656e 616d 6520 3d27 5327 2c20   basename ='S', 
-0001eb50: 0d0a 2020 2020 6669 675f 7369 7a65 203d  ..    fig_size =
-0001eb60: 2820 372c 2037 2029 2c20 0d0a 2020 2020  ( 7, 7 ), ..    
-0001eb70: 7368 6f77 5f6c 696e 6520 3d46 616c 7365  show_line =False
-0001eb80: 2c20 0d0a 2020 2020 7374 6570 203d 204e  , ..    step = N
-0001eb90: 6f6e 6520 2c20 0d0a 2020 2020 786c 6162  one , ..    xlab
-0001eba0: 656c 203d 2727 2c20 0d0a 2020 2020 796c  el ='', ..    yl
-0001ebb0: 6162 656c 203d 2727 2c20 0d0a 2020 2020  abel ='', ..    
-0001ebc0: 636f 6c6f 723d 4e6f 6e65 2c20 0d0a 2020  color=None, ..  
-0001ebd0: 2020 7368 6f77 5f6c 6567 203d 4661 6c73    show_leg =Fals
-0001ebe0: 652c 0d0a 2020 2020 6c69 6e65 6c61 6265  e,..    linelabe
-0001ebf0: 6c3d 2727 2c20 0d0a 2020 2020 6d61 726b  l='', ..    mark
-0001ec00: 6572 6c61 6265 6c3d 2727 2c20 0d0a 2020  erlabel='', ..  
-0001ec10: 2020 2a2a 7465 7874 5f6b 7773 0d0a 2020    **text_kws..  
-0001ec20: 2020 293a 200d 0a20 2020 2022 2222 2050    ): ..    """ P
-0001ec30: 6c6f 7420 7465 7874 2873 2920 696e 6469  lot text(s) indi
-0001ec40: 6361 7469 6e67 2065 6163 6820 706f 7369  cating each posi
-0001ec50: 7469 6f6e 2069 6e20 7468 6520 6c69 6e65  tion in the line
-0001ec60: 2e20 0d0a 2020 2020 0d0a 2020 2020 5061  . ..    ..    Pa
-0001ec70: 7261 6d65 7465 7273 200d 0a20 2020 202d  rameters ..    -
-0001ec80: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-0001ec90: 782c 2079 3a20 7374 722c 2066 6c6f 6174  x, y: str, float
-0001eca0: 2c20 4172 7261 792d 6c69 6b65 200d 0a20  , Array-like .. 
-0001ecb0: 2020 2020 2020 2054 6865 2070 6f73 6974         The posit
-0001ecc0: 696f 6e20 746f 2070 6c61 6365 2074 6865  ion to place the
-0001ecd0: 2074 6578 742e 2042 7920 6465 6661 756c   text. By defaul
-0001ece0: 742c 2074 6869 7320 6973 2069 6e20 6461  t, this is in da
-0001ecf0: 7461 200d 0a20 2020 2020 2020 2063 6f6f  ta ..        coo
-0001ed00: 7264 696e 6174 6573 2e20 5468 6520 636f  rdinates. The co
-0001ed10: 6f72 6469 6e61 7465 2073 7973 7465 6d20  ordinate system 
-0001ed20: 6361 6e20 6265 2063 6861 6e67 6564 2075  can be changed u
-0001ed30: 7369 6e67 2074 6865 200d 0a20 2020 2020  sing the ..     
-0001ed40: 2020 2074 7261 6e73 666f 726d 2070 6172     transform par
-0001ed50: 616d 6574 6572 2e0d 0a20 2020 2020 2020  ameter...       
-0001ed60: 200d 0a20 2020 2074 6578 743a 2073 7472   ..    text: str
-0001ed70: 2c20 0d0a 2020 2020 2020 2020 5468 6520  , ..        The 
-0001ed80: 7465 7874 0d0a 2020 2020 2020 2020 0d0a  text..        ..
-0001ed90: 2020 2020 6461 7461 3a20 7064 2e44 6174      data: pd.Dat
-0001eda0: 6146 7261 6d65 2c20 0d0a 2020 2020 2020  aFrame, ..      
-0001edb0: 2044 6174 6120 636f 6e74 6169 6e69 6e67   Data containing
-0001edc0: 2078 2061 6e64 2079 206e 616d 6573 2e20   x and y names. 
-0001edd0: 4e65 6564 2074 6f20 6265 2073 7570 706c  Need to be suppl
-0001ede0: 6965 6420 7768 656e 2078 2061 6e64 2079  ied when x and y
-0001edf0: 200d 0a20 2020 2020 2020 6172 6520 6769   ..       are gi
-0001ee00: 7665 6e20 6173 2073 7472 696e 6720 6e61  ven as string na
-0001ee10: 6d65 732e 200d 0a20 2020 2020 2020 0d0a  mes. ..       ..
-0001ee20: 2020 2020 636f 6572 6365 3a62 6f6f 6c2c      coerce:bool,
-0001ee30: 2064 6566 6175 6c74 3d46 616c 7365 200d   default=False .
-0001ee40: 0a20 2020 2020 2020 466f 7263 6520 7468  .       Force th
-0001ee50: 6520 706c 6f74 2064 6573 7069 7465 2074  e plot despite t
-0001ee60: 6865 2067 6976 656e 2074 6578 7465 7320  he given textes 
-0001ee70: 646f 206e 6f74 206d 6174 6368 2074 6865  do not match the
-0001ee80: 206e 756d 6265 7220 6f66 2020 0d0a 2020   number of  ..  
-0001ee90: 2020 2020 2070 6f73 6974 696f 6e73 2060       positions `
-0001eea0: 7860 2061 6e64 2060 7960 2e20 4966 2060  x` and `y`. If `
-0001eeb0: 6046 616c 7365 6060 2c20 6e75 6d62 6572  `False``, number
-0001eec0: 206f 6620 706f 7369 7469 6f6e 7320 6d75   of positions mu
-0001eed0: 7374 2062 6520 0d0a 2020 2020 2020 2063  st be ..       c
-0001eee0: 6f6e 7369 7374 656e 7420 7769 7468 2078  onsistent with x
-0001eef0: 2061 6e64 2079 2c20 6f74 6865 7277 6973   and y, otherwis
-0001ef00: 6520 6572 726f 7220 7261 6973 6573 2e20  e error raises. 
-0001ef10: 0d0a 2020 2020 2020 200d 0a20 2020 2062  ..       ..    b
-0001ef20: 6173 656e 616d 653a 2073 7472 2c20 6465  asename: str, de
-0001ef30: 6661 756c 743d 2753 2720 0d0a 2020 2020  fault='S' ..    
-0001ef40: 2020 2074 6865 2074 6578 7420 746f 2070     the text to p
-0001ef50: 7265 6669 7820 7468 6520 706f 7369 7469  refix the positi
-0001ef60: 6f6e 2077 6865 6e20 7468 6520 7465 7874  on when the text
-0001ef70: 2069 7320 6e6f 7420 6769 7665 6e2e 200d   is not given. .
-0001ef80: 0a20 2020 2020 2020 0d0a 2020 2020 6669  .       ..    fi
-0001ef90: 675f 7369 7a65 3a20 7475 706c 652c 2064  g_size: tuple, d
-0001efa0: 6566 6175 6c74 3d28 372c 2037 2920 0d0a  efault=(7, 7) ..
-0001efb0: 2020 2020 2020 204d 6174 706c 6f74 6c69         Matplotli
-0001efc0: 6220 6669 6775 7265 2073 697a 652e 0d0a  b figure size...
-0001efd0: 2020 2020 2020 200d 0a20 2020 2073 686f         ..    sho
-0001efe0: 775f 6c69 6e65 3a20 626f 6f6c 2c20 6465  w_line: bool, de
-0001eff0: 6661 756c 743d 4661 6c73 6520 0d0a 2020  fault=False ..  
-0001f000: 2020 2020 2044 6973 706c 6179 2074 6865       Display the
-0001f010: 206c 696e 6520 6672 6f6d 2078 2c20 792e   line from x, y.
-0001f020: 200d 0a20 2020 2020 2020 0d0a 2020 2020   ..       ..    
-0001f030: 7374 6570 3a20 696e 742c 4f70 7469 6f6e  step: int,Option
-0001f040: 616c 200d 0a20 2020 2020 2020 5468 6520  al ..       The 
-0001f050: 6e75 6d62 6572 206f 6620 696e 7465 726d  number of interm
-0001f060: 6564 6961 7465 2070 6f73 6974 696f 6e73  ediate positions
-0001f070: 2074 6f20 736b 6970 2069 6e20 7468 6520   to skip in the 
-0001f080: 706c 6f74 7469 6e67 2074 6578 742e 200d  plotting text. .
-0001f090: 0a20 2020 2020 2020 0d0a 2020 2020 786c  .       ..    xl
-0001f0a0: 6162 656c 2c20 796c 6162 656c 3a20 7374  abel, ylabel: st
-0001f0b0: 722c 204f 7074 696f 6e61 6c2c 200d 0a20  r, Optional, .. 
-0001f0c0: 2020 2020 2020 5468 6520 6c61 6265 6c73        The labels
-0001f0d0: 206f 6620 7820 616e 6420 792e 200d 0a20   of x and y. .. 
-0001f0e0: 2020 2063 6f6c 6f72 3a20 7374 722c 204f     color: str, O
-0001f0f0: 7074 696f 6e61 6c20 0d0a 2020 2020 2020  ptional ..      
-0001f100: 204c 696e 6520 636f 6c6f 7220 6966 2060   Line color if `
-0001f110: 7368 6f77 5f6c 696e 6560 2069 7320 7365  show_line` is se
-0001f120: 7420 746f 2060 6054 7275 6560 602e 200d  t to ``True``. .
-0001f130: 0a20 2020 2020 2020 0d0a 2020 2020 7368  .       ..    sh
-0001f140: 6f77 5f6c 6567 3a20 626f 6f6c 2c20 6465  ow_leg: bool, de
-0001f150: 6661 756c 743d 4661 6c73 6520 0d0a 2020  fault=False ..  
-0001f160: 2020 2020 2044 6973 706c 6179 2074 6865       Display the
-0001f170: 206c 6567 656e 6420 6f66 206c 696e 6520   legend of line 
-0001f180: 616e 6420 6d61 726b 6572 206c 6162 656c  and marker label
-0001f190: 732e 200d 0a20 2020 2020 2020 0d0a 2020  s. ..       ..  
-0001f1a0: 2020 6c69 6e65 6c61 6265 6c2c 206d 6172    linelabel, mar
-0001f1b0: 6b65 726c 6162 656c 3a20 7374 722c 204f  kerlabel: str, O
-0001f1c0: 7074 696f 6e61 6c20 0d0a 2020 2020 2020  ptional ..      
-0001f1d0: 2020 5468 6520 6c61 6265 6c73 206f 6620    The labels of 
-0001f1e0: 7468 6520 6c69 6e65 2061 6e64 206d 6172  the line and mar
-0001f1f0: 6b65 722e 200d 0a20 2020 2020 2020 0d0a  ker. ..       ..
-0001f200: 2020 2020 7465 7874 5f6b 7773 3a20 6469      text_kws: di
-0001f210: 6374 2c20 0d0a 2020 2020 2020 204b 6579  ct, ..       Key
-0001f220: 776f 7264 2061 7267 756d 656e 7473 2070  word arguments p
-0001f230: 6173 7365 6420 746f 203a 6d65 7468 3a60  assed to :meth:`
-0001f240: 6d61 7470 6c6f 746c 6962 2e61 7865 732e  matplotlib.axes.
-0001f250: 4178 6573 2e74 6578 7460 2e20 0d0a 0d0a  Axes.text`. ....
-0001f260: 2020 2020 4578 616d 706c 6573 200d 0a20      Examples .. 
-0001f270: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
-0001f280: 203e 3e3e 2069 6d70 6f72 7420 7761 7465   >>> import wate
-0001f290: 7820 6173 2077 7820 0d0a 2020 2020 3e3e  x as wx ..    >>
-0001f2a0: 3e20 6461 7461 203d 7778 2e6d 616b 655f  > data =wx.make_
-0001f2b0: 6572 7020 2861 735f 6672 616d 6520 3d54  erp (as_frame =T
-0001f2c0: 7275 652c 206e 5f73 7461 7469 6f6e 733d  rue, n_stations=
-0001f2d0: 2037 2029 0d0a 2020 2020 3e3e 3e20 7820   7 )..    >>> x 
-0001f2e0: 2c20 7920 3d5b 2030 2c20 312c 2033 205d  , y =[ 0, 1, 3 ]
-0001f2f0: 2c20 5b32 2c20 332c 2036 5d20 0d0a 2020  , [2, 3, 6] ..  
-0001f300: 2020 3e3e 3e20 7465 7874 6f20 3d20 5b27    >>> texto = ['
-0001f310: 414d 542d 4531 3134 3727 2c20 2741 4d54  AMT-E1147', 'AMT
-0001f320: 2d45 3131 3438 272c 2020 2741 4d54 2d45  -E1148',  'AMT-E
-0001f330: 3138 3027 5d0d 0a20 2020 203e 3e3e 2070  180']..    >>> p
-0001f340: 6c6f 745f 7465 7874 2028 782c 2079 202c  lot_text (x, y ,
-0001f350: 2074 6578 7420 3d20 7465 7874 6f29 2320   text = texto)# 
-0001f360: 6e6f 206e 6565 6420 746f 2073 6574 2020  no need to set  
-0001f370: 636f 6572 6365 2c20 7361 6d65 206c 656e  coerce, same len
-0001f380: 6774 6820 0d0a 2020 2020 3e3e 3e20 6461  gth ..    >>> da
-0001f390: 7461 203d 7778 2e6d 616b 655f 6572 7020  ta =wx.make_erp 
-0001f3a0: 2861 735f 6672 616d 6520 3d54 7275 652c  (as_frame =True,
-0001f3b0: 206e 5f73 7461 7469 6f6e 733d 2032 3020   n_stations= 20 
-0001f3c0: 290d 0a20 2020 203e 3e3e 2078 202c 2079  )..    >>> x , y
-0001f3d0: 203d 2064 6174 612e 6561 7374 696e 672c   = data.easting,
-0001f3e0: 2064 6174 612e 6e6f 7274 6869 6e67 0d0a   data.northing..
-0001f3f0: 2020 2020 3e3e 3e20 7465 7874 3120 3d20      >>> text1 = 
-0001f400: 5b27 414d 542d 4531 3134 3727 2c20 2741  ['AMT-E1147', 'A
-0001f410: 4d54 2d45 3131 3438 272c 2020 2741 4d54  MT-E1148',  'AMT
-0001f420: 2d45 3138 3027 5d20 0d0a 2020 2020 3e3e  -E180'] ..    >>
-0001f430: 3e20 706c 6f74 5f74 6578 7420 2878 2c20  > plot_text (x, 
-0001f440: 7920 2c20 636f 6572 6365 203d 5472 7565  y , coerce =True
-0001f450: 202c 2074 6578 7420 3d20 7465 7874 3120   , text = text1 
-0001f460: 2c20 7368 6f77 5f6c 6567 3d20 5472 7565  , show_leg= True
-0001f470: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-0001f480: 2020 2020 2020 2073 686f 775f 6c69 6e65         show_line
-0001f490: 3d54 7275 652c 206c 696e 656c 6162 656c  =True, linelabel
-0001f4a0: 3d27 4531 2d6c 696e 6527 2c20 6d61 726b  ='E1-line', mark
-0001f4b0: 6572 6c61 6265 6c3d 2027 5369 7465 272c  erlabel= 'Site',
-0001f4c0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0001f4d0: 2020 6261 7365 6e61 6d65 203d 2741 4d54    basename ='AMT
-0001f4e0: 2d45 3027 200d 0a20 2020 2020 2020 2020  -E0' ..         
-0001f4f0: 2020 2020 2020 290d 0a20 2020 2022 2222        )..    """
-0001f500: 0d0a 2020 2020 2320 6173 7375 6d65 2078  ..    # assume x
-0001f510: 2c20 7920 2073 6572 6965 7320 6172 6520  , y  series are 
-0001f520: 7061 7373 6564 200d 0a20 2020 2069 6620  passed ..    if 
-0001f530: 6973 696e 7374 616e 6365 2878 2c20 7374  isinstance(x, st
-0001f540: 7229 206f 7220 6861 7361 7474 7220 2820  r) or hasattr ( 
-0001f550: 782c 2027 6e61 6d65 2729 3a20 0d0a 2020  x, 'name'): ..  
-0001f560: 2020 2020 2020 786c 6162 656c 203d 2078        xlabel = x
-0001f570: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0001f580: 782c 2073 7472 2920 656c 7365 2078 2e6e  x, str) else x.n
-0001f590: 616d 6520 0d0a 2020 2020 2020 2020 0d0a  ame ..        ..
-0001f5a0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0001f5b0: 6528 792c 2073 7472 2920 6f72 2068 6173  e(y, str) or has
-0001f5c0: 6174 7472 2028 2079 2c20 276e 616d 6527  attr ( y, 'name'
-0001f5d0: 293a 200d 0a20 2020 2020 2020 2079 6c61  ): ..        yla
-0001f5e0: 6265 6c20 3d20 7920 2069 6620 6973 696e  bel = y  if isin
-0001f5f0: 7374 616e 6365 2879 2c20 7374 7229 2065  stance(y, str) e
-0001f600: 6c73 6520 792e 6e61 6d65 200d 0a20 2020  lse y.name ..   
-0001f610: 2020 2020 200d 0a20 2020 2069 6620 7820       ..    if x 
-0001f620: 6973 204e 6f6e 6520 616e 6420 2079 2069  is None and  y i
-0001f630: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
-0001f640: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-0001f650: 2822 7820 616e 6420 7920 6172 6520 6e65  ("x and y are ne
-0001f660: 6564 6564 2066 6f72 2074 6578 7420 706c  eded for text pl
-0001f670: 6f74 2e20 4e6f 6e65 5479 7065 220d 0a20  ot. NoneType".. 
-0001f680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f690: 2020 2020 2020 2022 2063 616e 6e6f 7420         " cannot 
-0001f6a0: 6265 2070 6c6f 7474 6564 2e22 2920 2020  be plotted.")   
-0001f6b0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-0001f6c0: 2078 2c20 7920 3d20 6173 7365 7274 5f78   x, y = assert_x
-0001f6d0: 795f 696e 2878 2c20 792c 2064 6174 6120  y_in(x, y, data 
-0001f6e0: 3d20 6461 7461 2029 200d 0a0d 0a20 2020  = data ) ....   
-0001f6f0: 2069 6620 7465 7874 2069 7320 4e6f 6e65   if text is None
-0001f700: 2061 6e64 206e 6f74 2063 6f65 7263 653a   and not coerce:
-0001f710: 200d 0a20 2020 2020 2020 7261 6973 6520   ..       raise 
-0001f720: 5479 7065 4572 726f 7220 2822 5465 7874  TypeError ("Text
-0001f730: 2063 616e 6e6f 7420 6265 2070 6c6f 7474   cannot be plott
-0001f740: 6564 2e20 546f 2066 6f72 6365 2070 6c6f  ed. To force plo
-0001f750: 7474 696e 6720 7465 7874 2077 6974 6822  tting text with"
-0001f760: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001f770: 2020 2020 2020 2020 2020 2220 7468 6520            " the 
-0001f780: 6261 7365 6e61 6d65 2c20 7365 7420 6060  basename, set ``
-0001f790: 636f 6572 6365 3d54 7275 6560 602e 2229  coerce=True``.")
-0001f7a0: 0d0a 0d0a 2020 2020 7465 7874 203d 2069  ....    text = i
-0001f7b0: 735f 6974 6572 6162 6c65 2874 6578 7420  s_iterable(text 
-0001f7c0: 2c20 6578 636c 7564 655f 7374 7269 6e67  , exclude_string
-0001f7d0: 3d20 5472 7565 202c 2074 7261 6e73 666f  = True , transfo
-0001f7e0: 726d 203d 5472 7565 2029 0d0a 2020 2020  rm =True )..    
-0001f7f0: 0d0a 2020 2020 6966 2028 206c 656e 2874  ..    if ( len(t
-0001f800: 6578 7429 2021 3d20 6c65 6e28 7929 200d  ext) != len(y) .
-0001f810: 0a20 2020 2020 2020 2061 6e64 206e 6f74  .        and not
-0001f820: 2063 6f65 7263 6529 203a 200d 0a20 2020   coerce) : ..   
-0001f830: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0001f840: 4572 726f 7228 2249 6e20 7072 696e 6369  Error("In princi
-0001f850: 706c 6520 7465 7874 2061 7272 6179 2061  ple text array a
-0001f860: 6e64 2078 2f79 206d 7573 7420 6265 2063  nd x/y must be c
-0001f870: 6f6e 7369 7374 656e 742e 220d 0a20 2020  onsistent."..   
-0001f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f890: 2020 2020 2020 6622 2047 6f74 207b 6c65        f" Got {le
-0001f8a0: 6e28 7465 7874 297d 2061 6e64 207b 6c65  n(text)} and {le
-0001f8b0: 6e28 7929 7d2e 2054 6f20 706c 6f74 2061  n(y)}. To plot a
-0001f8c0: 6e79 7761 792c 220d 0a20 2020 2020 2020  nyway,"..       
-0001f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f8e0: 2020 2220 7365 7420 6060 636f 6572 6365    " set ``coerce
-0001f8f0: 3d54 7275 6560 602e 2229 0d0a 2020 2020  =True``.")..    
-0001f900: 6966 2063 6f65 7263 6520 3a20 0d0a 2020  if coerce : ..  
-0001f910: 2020 2020 2020 6261 7365 6e61 6d65 203d        basename =
-0001f920: 7374 7228 6261 7365 6e61 6d65 290d 0a20  str(basename).. 
-0001f930: 2020 2020 2020 2074 6578 7420 2b3d 205b         text += [
-0001f940: 6627 7b62 6173 656e 616d 657d 7b69 2b6c  f'{basename}{i+l
-0001f950: 656e 2874 6578 7429 3a30 327d 2720 666f  en(text):02}' fo
-0001f960: 7220 6920 696e 2072 616e 6765 2028 6c65  r i in range (le
-0001f970: 6e28 7929 2029 5d0d 0a0d 0a20 2020 2069  n(y) )]....    i
-0001f980: 6620 7374 6570 2069 7320 6e6f 7420 4e6f  f step is not No
-0001f990: 6e65 3a20 0d0a 2020 2020 2020 2020 7374  ne: ..        st
-0001f9a0: 6570 203d 205f 6173 7365 7274 5f61 6c6c  ep = _assert_all
-0001f9b0: 5f74 7970 6573 2873 7465 7020 2c20 666c  _types(step , fl
-0001f9c0: 6f61 742c 2069 6e74 202c 206f 626a 6e61  oat, int , objna
-0001f9d0: 6d65 203d 2753 7465 7027 2920 0d0a 2020  me ='Step') ..  
-0001f9e0: 2020 2020 2020 666f 7220 6969 2069 6e20        for ii in 
-0001f9f0: 7261 6e67 6528 6c65 6e28 7465 7874 2929  range(len(text))
-0001fa00: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0001fa10: 6966 206e 6f74 2069 6925 2073 7465 7020  if not ii% step 
-0001fa20: 3d3d 303a 200d 0a20 2020 2020 2020 2020  ==0: ..         
-0001fa30: 2020 2020 2020 2074 6578 745b 6969 5d3d         text[ii]=
-0001fa40: 2727 0d0a 0d0a 2020 2020 6669 672c 2061  ''....    fig, a
-0001fa50: 7820 3d20 706c 742e 7375 6270 6c6f 7473  x = plt.subplots
-0001fa60: 2831 2c31 2c20 6669 6773 697a 6520 3d66  (1,1, figsize =f
-0001fa70: 6967 5f73 697a 6529 0d0a 2020 2020 0d0a  ig_size)..    ..
-0001fa80: 2020 2020 2320 706c 6f74 203d 2061 782e      # plot = ax.
-0001fa90: 7363 6174 7465 7220 6966 2073 686f 775f  scatter if show_
-0001faa0: 6c69 6e65 2065 6c73 6520 6178 2e70 6c6f  line else ax.plo
-0001fab0: 7420 0d0a 2020 2020 6178 5f6d 203d 204e  t ..    ax_m = N
-0001fac0: 6f6e 6520 0d0a 2020 2020 6966 2073 686f  one ..    if sho
-0001fad0: 775f 6c69 6e65 3a20 0d0a 2020 2020 2020  w_line: ..      
-0001fae0: 2020 6178 2e70 6c6f 7420 2878 2c20 7920    ax.plot (x, y 
-0001faf0: 2c20 6c61 6265 6c20 3d20 6c69 6e65 6c61  , label = linela
-0001fb00: 6265 6c2c 2063 6f6c 6f72 203d 636f 6c6f  bel, color =colo
-0001fb10: 7220 0d0a 2020 2020 2020 2020 2020 2020  r ..            
-0001fb20: 2020 2020 2029 200d 0a20 2020 2020 2020       ) ..       
-0001fb30: 200d 0a20 2020 2066 6f72 2069 782c 2069   ..    for ix, i
-0001fb40: 7920 2c20 6e61 6d65 2069 6e20 7a69 7020  y , name in zip 
-0001fb50: 2878 2c20 792c 2074 6578 7420 293a 200d  (x, y, text ): .
-0001fb60: 0a20 2020 2020 2020 2061 782e 7465 7874  .        ax.text
-0001fb70: 2028 2069 7820 2c20 6979 202c 206e 616d   ( ix , iy , nam
-0001fb80: 6520 2c20 2a2a 7465 7874 5f6b 7773 290d  e , **text_kws).
-0001fb90: 0a20 2020 2020 2020 2069 6620 6e61 6d65  .        if name
-0001fba0: 2021 3d27 273a 0d0a 2020 2020 2020 2020   !='':..        
-0001fbb0: 2020 2061 785f 6d20 203d 2061 782e 7363     ax_m  = ax.sc
-0001fbc0: 6174 7465 7220 2820 5b69 785d 2c20 5b69  atter ( [ix], [i
-0001fbd0: 795d 202c 206d 6172 6b65 7220 3d27 6f27  y] , marker ='o'
-0001fbe0: 2c20 636f 6c6f 7220 3d27 6b27 2c20 0d0a  , color ='k', ..
-0001fbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc00: 2020 2020 2020 2029 0d0a 2020 0d0a 2020         )..  ..  
-0001fc10: 2020 6178 2e73 6574 5f78 6c61 6265 6c20    ax.set_xlabel 
-0001fc20: 2878 6c61 6265 6c29 0d0a 2020 2020 6178  (xlabel)..    ax
-0001fc30: 2e73 6574 5f79 6c61 6265 6c20 2879 6c61  .set_ylabel (yla
-0001fc40: 6265 6c29 200d 0a20 2020 200d 0a20 2020  bel) ..    ..   
-0001fc50: 2061 785f 6d2e 7365 745f 6c61 6265 6c20   ax_m.set_label 
-0001fc60: 2820 6d61 726b 6572 6c61 6265 6c29 2069  ( markerlabel) i
-0001fc70: 6620 6178 5f6d 2069 7320 6e6f 7420 4e6f  f ax_m is not No
-0001fc80: 6e65 2065 6c73 6520 4e6f 6e65 200d 0a20  ne else None .. 
-0001fc90: 2020 200d 0a20 2020 2069 6620 7368 6f77     ..    if show
-0001fca0: 5f6c 6567 203a 200d 0a20 2020 2020 2020  _leg : ..       
-0001fcb0: 2061 782e 6c65 6765 6e64 2028 2920 0d0a   ax.legend () ..
-0001fcc0: 2020 2020 0d0a 6465 6620 706c 6f74 5f76      ..def plot_v
-0001fcd0: 6f72 6f6e 6f69 280d 0a20 2020 2058 2c20  oronoi(..    X, 
-0001fce0: 792c 202a 2c20 0d0a 2020 2020 636c 7573  y, *, ..    clus
-0001fcf0: 7465 725f 6365 6e74 6572 732c 0d0a 2020  ter_centers,..  
-0001fd00: 2020 6178 3d20 4e6f 6e65 2c0d 0a20 2020    ax= None,..   
-0001fd10: 2073 686f 775f 7665 7274 6963 6573 3d46   show_vertices=F
-0001fd20: 616c 7365 2c20 0d0a 2020 2020 6c69 6e65  alse, ..    line
-0001fd30: 5f63 6f6c 6f72 733d 276b 272c 0d0a 2020  _colors='k',..  
-0001fd40: 2020 6c69 6e65 5f77 6964 7468 3d31 2e20    line_width=1. 
-0001fd50: 2c0d 0a20 2020 206c 696e 655f 616c 7068  ,..    line_alph
-0001fd60: 613d 312e 2c20 2020 0d0a 2020 2020 6669  a=1.,   ..    fi
-0001fd70: 675f 7369 7a65 203d 2028 372c 2037 292c  g_size = (7, 7),
-0001fd80: 200d 0a20 2020 2066 6967 5f74 6974 6c65   ..    fig_title
-0001fd90: 203d 2027 270d 0a20 2020 2029 3a0d 0a20   = ''..    ):.. 
-0001fda0: 2020 2022 2222 506c 6f74 7320 7468 6520     """Plots the 
-0001fdb0: 566f 726f 6e6f 6920 6469 6167 7261 6d20  Voronoi diagram 
-0001fdc0: 6f66 2074 6865 206b 2d6d 6561 6e73 2063  of the k-means c
-0001fdd0: 6c75 7374 6572 7320 6f76 6572 6c61 6964  lusters overlaid
-0001fde0: 2077 6974 6820 0d0a 2020 2020 7468 6520   with ..    the 
-0001fdf0: 6461 7461 0d0a 2020 2020 0d0a 2020 2020  data..    ..    
-0001fe00: 5061 7261 6d65 7465 7273 200d 0a20 2020  Parameters ..   
-0001fe10: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020   -----------..  
-0001fe20: 2020 582c 2079 203a 204e 4461 7272 6179    X, y : NDarray
-0001fe30: 2c20 4172 7261 796c 696b 6520 3164 200d  , Arraylike 1d .
-0001fe40: 0a20 2020 2020 2044 6174 6120 7472 6169  .      Data trai
-0001fe50: 6e69 6e67 2058 2061 6e64 2079 2e20 4d75  ning X and y. Mu
-0001fe60: 7374 2068 6176 6520 7468 6520 7361 6d65  st have the same
-0001fe70: 206c 656e 6774 6820 0d0a 2020 2020 636c   length ..    cl
-0001fe80: 7573 7465 725f 6365 6e74 6572 3a20 696e  uster_center: in
-0001fe90: 742c 200d 0a20 2020 2020 2020 436c 7573  t, ..       Clus
-0001fea0: 7465 7220 6365 6e74 6572 2e20 436c 7573  ter center. Clus
-0001feb0: 7465 7220 6365 6e74 6572 2063 616e 2062  ter center can b
-0001fec0: 6520 6f62 7461 696e 2077 6974 6865 204b  e obtain withe K
-0001fed0: 4d65 616e 7320 616c 676f 7269 7468 6d73  Means algorithms
-0001fee0: 200d 0a20 2020 2073 686f 775f 7665 7274   ..    show_vert
-0001fef0: 6963 6573 203a 2062 6f6f 6c2c 206f 7074  ices : bool, opt
-0001ff00: 696f 6e61 6c0d 0a20 2020 2020 2020 2041  ional..        A
-0001ff10: 6464 2074 6865 2056 6f72 6f6e 6f69 2076  dd the Voronoi v
-0001ff20: 6572 7469 6365 7320 746f 2074 6865 2070  ertices to the p
-0001ff30: 6c6f 742e 0d0a 2020 2020 6c69 6e65 5f63  lot...    line_c
-0001ff40: 6f6c 6f72 7320 3a20 7374 7269 6e67 2c20  olors : string, 
-0001ff50: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-0001ff60: 2020 5370 6563 6966 6965 7320 7468 6520    Specifies the 
-0001ff70: 6c69 6e65 2063 6f6c 6f72 2066 6f72 2070  line color for p
-0001ff80: 6f6c 7967 6f6e 2062 6f75 6e64 6172 6965  olygon boundarie
-0001ff90: 730d 0a20 2020 206c 696e 655f 7769 6474  s..    line_widt
-0001ffa0: 6820 3a20 666c 6f61 742c 206f 7074 696f  h : float, optio
-0001ffb0: 6e61 6c0d 0a20 2020 2020 2020 2053 7065  nal..        Spe
-0001ffc0: 6369 6669 6573 2074 6865 206c 696e 6520  cifies the line 
-0001ffd0: 7769 6474 6820 666f 7220 706f 6c79 676f  width for polygo
-0001ffe0: 6e20 626f 756e 6461 7269 6573 0d0a 2020  n boundaries..  
-0001fff0: 2020 6c69 6e65 5f61 6c70 6861 203a 2066    line_alpha : f
-00020000: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0d0a  loat, optional..
-00020010: 2020 2020 2020 2020 5370 6563 6966 6965          Specifie
-00020020: 7320 7468 6520 6c69 6e65 2061 6c70 6861  s the line alpha
-00020030: 2066 6f72 2070 6f6c 7967 6f6e 2062 6f75   for polygon bou
-00020040: 6e64 6172 6965 730d 0a20 2020 2070 6f69  ndaries..    poi
-00020050: 6e74 5f73 697a 6520 3a20 666c 6f61 742c  nt_size : float,
-00020060: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-00020070: 2020 2053 7065 6369 6669 6573 2074 6865     Specifies the
-00020080: 2073 697a 6520 6f66 2070 6f69 6e74 730d   size of points.
-00020090: 0a20 2020 2061 783a 204d 6174 706c 6f74  .    ax: Matplot
-000200a0: 6c69 622e 4178 6573 200d 0a20 2020 2020  lib.Axes ..     
-000200b0: 2020 4d61 706c 6f74 6c69 6220 6178 6573    Maplotlib axes
-000200c0: 2e20 4966 2060 4e6f 6e65 602c 2061 2061  . If `None`, a a
-000200d0: 7869 7320 6973 2063 7265 6174 6564 2069  xis is created i
-000200e0: 6e73 7465 6164 2e20 0d0a 2020 2020 2020  nstead. ..      
-000200f0: 200d 0a20 2020 2066 6967 5f73 697a 653a   ..    fig_size:
-00020100: 2074 7570 6c65 2c20 6465 6661 756c 7420   tuple, default 
-00020110: 3d20 2837 2c20 3729 200d 0a20 2020 2020  = (7, 7) ..     
-00020120: 2020 5369 7a65 206f 6620 7468 6520 6669    Size of the fi
-00020130: 6775 7265 732e 200d 0a20 2020 2020 2020  gures. ..       
-00020140: 0d0a 2020 2020 5265 7475 726e 0d0a 2020  ..    Return..  
-00020150: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2061    -------..    a
-00020160: 783a 204d 6174 706c 6f74 6c69 622e 4178  x: Matplotlib.Ax
-00020170: 6573 200d 0a20 2020 2020 2020 4178 6573  es ..       Axes
-00020180: 2074 6f20 7375 7070 6f72 7420 7468 6520   to support the 
-00020190: 6669 6775 7265 0d0a 2020 2020 2020 200d  figure..       .
-000201a0: 0a20 2020 2045 7861 6d70 6c65 7320 0d0a  .    Examples ..
-000201b0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0d 0a20      ---------.. 
-000201c0: 2020 203e 3e3e 2066 726f 6d20 736b 6c65     >>> from skle
-000201d0: 6172 6e2e 6461 7461 7365 7473 2069 6d70  arn.datasets imp
-000201e0: 6f72 7420 6d61 6b65 5f6d 6f6f 6e73 0d0a  ort make_moons..
-000201f0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6b6c      >>> from skl
-00020200: 6561 726e 2e63 6c75 7374 6572 2069 6d70  earn.cluster imp
-00020210: 6f72 7420 4b4d 6561 6e73 200d 0a20 2020  ort KMeans ..   
-00020220: 203e 3e3e 2066 726f 6d20 7761 7465 782e   >>> from watex.
-00020230: 7574 696c 732e 706c 6f74 7574 696c 7320  utils.plotutils 
-00020240: 696d 706f 7274 2070 6c6f 745f 766f 726f  import plot_voro
-00020250: 6e6f 690d 0a20 2020 203e 3e3e 2058 2c20  noi..    >>> X, 
-00020260: 7920 3d20 6d61 6b65 5f6d 6f6f 6e73 286e  y = make_moons(n
-00020270: 5f73 616d 706c 6573 3d32 3030 302c 206e  _samples=2000, n
-00020280: 6f69 7365 3d30 2e32 290d 0a20 2020 203e  oise=0.2)..    >
-00020290: 3e3e 206b 6d20 3d20 4b4d 6561 6e73 2028  >> km = KMeans (
-000202a0: 6e5f 696e 6974 203d 2761 7574 6f27 292e  n_init ='auto').
-000202b0: 6669 7428 582c 2079 2029 200d 0a20 2020  fit(X, y ) ..   
-000202c0: 203e 3e3e 2070 6c6f 745f 766f 726f 6e6f   >>> plot_vorono
-000202d0: 6920 2820 582c 2079 202c 2063 6c75 7374  i ( X, y , clust
-000202e0: 6572 5f63 656e 7465 7273 203d 206b 6d2e  er_centers = km.
-000202f0: 636c 7573 7465 725f 6365 6e74 6572 735f  cluster_centers_
-00020300: 2920 0d0a 2020 2020 2222 220d 0a20 2020  ) ..    """..   
-00020310: 2058 2c20 7920 3d20 6368 6563 6b5f 585f   X, y = check_X_
-00020320: 7928 582c 2079 2c20 290d 0a20 2020 2063  y(X, y, )..    c
-00020330: 6c75 7374 6572 5f63 656e 7465 7273 203d  luster_centers =
-00020340: 2063 6865 636b 5f61 7272 6179 2863 6c75   check_array(clu
-00020350: 7374 6572 5f63 656e 7465 7273 2029 0d0a  ster_centers )..
-00020360: 2020 2020 0d0a 2020 2020 6966 2061 7820      ..    if ax 
-00020370: 6973 204e 6f6e 653a 200d 0a20 2020 2020  is None: ..     
-00020380: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
-00020390: 2e73 7562 706c 6f74 7328 312c 312c 2066  .subplots(1,1, f
-000203a0: 6967 7369 7a65 203d 6669 675f 7369 7a65  igsize =fig_size
-000203b0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-000203c0: 2066 726f 6d20 7363 6970 792e 7370 6174   from scipy.spat
-000203d0: 6961 6c20 696d 706f 7274 2056 6f72 6f6e  ial import Voron
-000203e0: 6f69 2c20 766f 726f 6e6f 695f 706c 6f74  oi, voronoi_plot
-000203f0: 5f32 640d 0a20 2020 200d 0a20 2020 2061  _2d..    ..    a
-00020400: 782e 7363 6174 7465 7228 585b 3a2c 2030  x.scatter(X[:, 0
-00020410: 5d2c 2058 5b3a 2c20 315d 2c20 633d 792c  ], X[:, 1], c=y,
-00020420: 2063 6d61 703d 2753 6574 3127 2c20 616c   cmap='Set1', al
-00020430: 7068 613d 302e 322c 200d 0a20 2020 2020  pha=0.2, ..     
-00020440: 2020 2020 2020 2020 2020 6c61 6265 6c20            label 
-00020450: 3d20 2756 6f72 6f6e 6f69 2070 6c6f 7427  = 'Voronoi plot'
-00020460: 290d 0a20 2020 2076 6f72 203d 2056 6f72  )..    vor = Vor
-00020470: 6f6e 6f69 2863 6c75 7374 6572 5f63 656e  onoi(cluster_cen
-00020480: 7465 7273 290d 0a20 2020 2076 6f72 6f6e  ters)..    voron
-00020490: 6f69 5f70 6c6f 745f 3264 2876 6f72 2c20  oi_plot_2d(vor, 
-000204a0: 6178 3d61 782c 2073 686f 775f 7665 7274  ax=ax, show_vert
-000204b0: 6963 6573 3d73 686f 775f 7665 7274 6963  ices=show_vertic
-000204c0: 6573 2c20 0d0a 2020 2020 2020 2020 2020  es, ..          
-000204d0: 2020 2020 2020 2020 2020 616c 7068 613d            alpha=
-000204e0: 302e 352c 200d 0a20 2020 2020 2020 2020  0.5, ..         
-000204f0: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-00020500: 636f 6c6f 7273 3d6c 696e 655f 636f 6c6f  colors=line_colo
-00020510: 7273 2c0d 0a20 2020 2020 2020 2020 2020  rs,..           
-00020520: 2020 2020 2020 2020 206c 696e 655f 7769           line_wi
-00020530: 6474 683d 6c69 6e65 5f77 6964 7468 202c  dth=line_width ,
-00020540: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00020550: 2020 2020 2020 6c69 6e65 5f61 6c70 6861        line_alpha
-00020560: 3d6c 696e 655f 616c 7068 612c 2020 0d0a  =line_alpha,  ..
-00020570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020580: 2020 2020 290d 0a20 2020 2023 6178 2e6c      )..    #ax.l
-00020590: 6567 656e 6428 2920 0d0a 2020 2020 6178  egend() ..    ax
-000205a0: 2e73 6574 5f74 6974 6c65 2028 6669 675f  .set_title (fig_
-000205b0: 7469 746c 6520 2c20 666f 6e74 7369 7a65  title , fontsize
-000205c0: 3d32 3029 0d0a 2020 2020 2366 6967 2e73  =20)..    #fig.s
-000205d0: 7570 7469 746c 6528 6669 675f 7469 746c  uptitle(fig_titl
-000205e0: 652c 2066 6f6e 7473 697a 653d 3230 2920  e, fontsize=20) 
-000205f0: 0d0a 2020 2020 0d0a 2020 2020 7265 7475  ..    ..    retu
-00020600: 726e 2061 7820 0d0a 200d 0a20 2020 200d  rn ax .. ..    .
-00020610: 0a64 6566 205f 6d61 6b65 5f61 7865 5f6d  .def _make_axe_m
-00020620: 756c 7469 706c 6520 2820 6e2c 206e 636f  ultiple ( n, nco
-00020630: 6c73 203d 2033 202c 2066 6967 5f73 697a  ls = 3 , fig_siz
-00020640: 6520 3d4e 6f6e 652c 2066 6967 203d 4e6f  e =None, fig =No
-00020650: 6e65 2c20 6178 3d20 2e2e 2e20 293a 200d  ne, ax= ... ): .
-00020660: 0a20 2020 2022 2222 204d 616b 6520 6d75  .    """ Make mu
-00020670: 6c74 6970 6c65 2073 7562 706c 6f74 2061  ltiple subplot a
-00020680: 7865 7320 6672 6f6d 206e 756d 6265 7220  xes from number 
-00020690: 6f66 206f 626a 6563 7473 2e20 2222 220d  of objects. """.
-000206a0: 0a20 2020 2069 6620 6973 5f69 7465 7261  .    if is_itera
-000206b0: 626c 6520 286e 293a 200d 0a20 2020 2020  ble (n): ..     
-000206c0: 2020 6e20 3d20 6c65 6e28 6e29 200d 0a20    n = len(n) .. 
-000206d0: 2020 2020 0d0a 2020 2020 6e72 6f77 7320      ..    nrows 
-000206e0: 3d20 6e20 2f2f 206e 636f 6c73 202b 2028  = n // ncols + (
-000206f0: 206e 2025 206e 636f 6c73 2029 200d 0a20   n % ncols ) .. 
-00020700: 2020 2069 6620 6e72 6f77 7320 3d3d 303a     if nrows ==0:
-00020710: 200d 0a20 2020 2020 2020 6e72 6f77 7320   ..       nrows 
-00020720: 3d31 200d 0a20 2020 2020 2020 0d0a 2020  =1 ..       ..  
-00020730: 2020 6966 2061 7820 696e 2028 202e 2e2e    if ax in ( ...
-00020740: 202c 204e 6f6e 6529 203a 200d 0a20 2020   , None) : ..   
-00020750: 2020 2020 2066 6967 2c20 6178 203d 2070       fig, ax = p
-00020760: 6c74 2e73 7562 706c 6f74 7320 286e 726f  lt.subplots (nro
-00020770: 7773 2c20 6e63 6f6c 732c 2066 6967 7369  ws, ncols, figsi
-00020780: 7a65 203d 2066 6967 5f73 697a 6520 2920  ze = fig_size ) 
-00020790: 200d 0a20 2020 200d 0a20 2020 2072 6574   ..    ..    ret
-000207a0: 7572 6e20 6669 6720 2c20 6178 200d 0a20  urn fig , ax .. 
-000207b0: 2020 200d 0a64 6566 2070 6c6f 745f 726f     ..def plot_ro
-000207c0: 635f 6375 7276 6573 2028 0d0a 2020 2063  c_curves (..   c
-000207d0: 6c66 732c 202f 2c20 0d0a 2020 2058 2c20  lfs, /, ..   X, 
-000207e0: 792c 200d 0a20 2020 6e61 6d65 7320 3d2e  y, ..   names =.
-000207f0: 2e2e 2c20 0d0a 2020 2063 6f6c 6f72 7320  .., ..   colors 
-00020800: 3d2e 2e2e 2c20 0d0a 2020 206e 636f 6c73  =..., ..   ncols
-00020810: 203d 2033 2c20 0d0a 2020 2067 6574 5f73   = 3, ..   get_s
-00020820: 636f 7265 3d46 616c 7365 2c20 0d0a 2020  core=False, ..  
-00020830: 2061 6c6c 3d46 616c 7365 2c0d 0a20 2020   all=False,..   
-00020840: 6178 203d 204e 6f6e 652c 2020 0d0a 2020  ax = None,  ..  
-00020850: 2066 6967 5f73 697a 653d 2820 372c 2037   fig_size=( 7, 7
-00020860: 292c 200d 0a20 2020 2a2a 726f 635f 6b77  ), ..   **roc_kw
-00020870: 7320 293a 200d 0a20 2020 2022 2222 2051  s ): ..    """ Q
-00020880: 7569 636b 2070 6c6f 7420 6f66 2052 6563  uick plot of Rec
-00020890: 6569 7669 6e67 204f 7065 7261 7469 6e67  eiving Operating
-000208a0: 2043 6861 7261 6374 6572 6973 6374 6963   Characterisctic
-000208b0: 2028 524f 4329 206f 6620 6669 7474 6564   (ROC) of fitted
-000208c0: 206d 6f64 656c 7320 0d0a 2020 2020 0d0a   models ..    ..
-000208d0: 2020 2020 5061 7261 6d65 7465 7273 200d      Parameters .
-000208e0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
-000208f0: 2d0d 0a20 2020 2063 6c66 733a 206c 6973  -..    clfs: lis
-00020900: 742c 200d 0a20 2020 2020 2020 6c69 7374  t, ..       list
-00020910: 206f 6620 6d6f 6465 6c73 2066 6f72 2052   of models for R
-00020920: 4f43 2065 7661 6c75 6174 696f 6e2e 204d  OC evaluation. M
-00020930: 6f64 656c 2073 686f 756c 6420 6265 2061  odel should be a
-00020940: 2073 6369 6b69 742d 6c65 6172 6e20 0d0a   scikit-learn ..
-00020950: 2020 2020 2020 206f 7220 2058 4742 6f6f         or  XGBoo
-00020960: 7374 2065 7374 696d 6174 6f72 7320 0d0a  st estimators ..
-00020970: 2020 2020 2020 200d 0a20 2020 2058 203a         ..    X :
-00020980: 207b 6172 7261 792d 6c69 6b65 2c20 7370   {array-like, sp
-00020990: 6172 7365 206d 6174 7269 787d 206f 6620  arse matrix} of 
-000209a0: 7368 6170 6520 286e 5f73 616d 706c 6573  shape (n_samples
-000209b0: 2c20 6e5f 6665 6174 7572 6573 290d 0a20  , n_features).. 
-000209c0: 2020 2020 2020 2054 7261 696e 696e 6720         Training 
-000209d0: 696e 7374 616e 6365 7320 746f 2063 6c75  instances to clu
-000209e0: 7374 6572 2e20 4974 206d 7573 7420 6265  ster. It must be
-000209f0: 206e 6f74 6564 2074 6861 7420 7468 6520   noted that the 
-00020a00: 6461 7461 0d0a 2020 2020 2020 2020 7769  data..        wi
-00020a10: 6c6c 2062 6520 636f 6e76 6572 7465 6420  ll be converted 
-00020a20: 746f 2043 206f 7264 6572 696e 672c 2077  to C ordering, w
-00020a30: 6869 6368 2077 696c 6c20 6361 7573 6520  hich will cause 
-00020a40: 6120 6d65 6d6f 7279 0d0a 2020 2020 2020  a memory..      
-00020a50: 2020 636f 7079 2069 6620 7468 6520 6769    copy if the gi
-00020a60: 7665 6e20 6461 7461 2069 7320 6e6f 7420  ven data is not 
-00020a70: 432d 636f 6e74 6967 756f 7573 2e0d 0a20  C-contiguous... 
-00020a80: 2020 2020 2020 2049 6620 6120 7370 6172         If a spar
-00020a90: 7365 206d 6174 7269 7820 6973 2070 6173  se matrix is pas
-00020aa0: 7365 642c 2061 2063 6f70 7920 7769 6c6c  sed, a copy will
-00020ab0: 2062 6520 6d61 6465 2069 6620 6974 2773   be made if it's
-00020ac0: 206e 6f74 2069 6e0d 0a20 2020 2020 2020   not in..       
-00020ad0: 2043 5352 2066 6f72 6d61 742e 0d0a 2020   CSR format...  
-00020ae0: 2020 0d0a 2020 2020 7920 3a20 6e64 6172    ..    y : ndar
-00020af0: 7261 7920 6f72 2053 6572 6965 7320 6f66  ray or Series of
-00020b00: 206c 656e 6774 6820 286e 5f73 616d 706c   length (n_sampl
-00020b10: 6573 2c20 290d 0a20 2020 2020 2020 2041  es, )..        A
-00020b20: 6e20 6172 7261 7920 6f72 2073 6572 6965  n array or serie
-00020b30: 7320 6f66 2074 6172 6765 7420 6f72 2063  s of target or c
-00020b40: 6c61 7373 2076 616c 7565 732e 2050 7265  lass values. Pre
-00020b50: 6665 7261 626c 792c 2074 6865 2061 7272  ferably, the arr
-00020b60: 6179 200d 0a20 2020 2020 2020 2072 6570  ay ..        rep
-00020b70: 7265 7365 6e74 2074 6865 2074 6573 7420  resent the test 
-00020b80: 636c 6173 7320 6c61 6265 6c73 2064 6174  class labels dat
-00020b90: 6120 666f 7220 6572 726f 7220 6576 616c  a for error eval
-00020ba0: 7561 7469 6f6e 2e20 200d 0a20 2020 200d  uation.  ..    .
-00020bb0: 0a20 2020 2063 6f6c 6f72 7320 3a20 7374  .    colors : st
-00020bc0: 722c 206c 6973 7420 0d0a 2020 2020 2020  r, list ..      
-00020bd0: 2043 6f6c 6f72 7320 746f 2073 7065 6369   Colors to speci
-00020be0: 6679 2065 6163 6820 6d6f 6465 6c20 706c  fy each model pl
-00020bf0: 6f74 2e20 0d0a 2020 2020 2020 200d 0a20  ot. ..       .. 
-00020c00: 2020 206e 636f 6c73 3a20 696e 742c 2064     ncols: int, d
-00020c10: 6566 6175 6c74 3d33 200d 0a20 2020 2020  efault=3 ..     
-00020c20: 2020 4e75 6d62 6572 206f 6620 706c 6f74    Number of plot
-00020c30: 2074 6f20 6265 2070 6c61 6365 6420 696e   to be placed in
-00020c40: 6c69 6e65 2062 6566 6f72 6520 736b 6970  line before skip
-00020c50: 7069 6e67 2074 6f20 7468 6520 6e65 7874  ping to the next
-00020c60: 2063 6f6c 756d 6e2e 200d 0a20 2020 2020   column. ..     
-00020c70: 2020 5468 6973 2069 7320 6665 6173 6962    This is feasib
-00020c80: 6c65 2069 6620 606d 616e 7960 2069 7320  le if `many` is 
-00020c90: 7365 7420 746f 2060 6054 7275 6560 602e  set to ``True``.
-00020ca0: 200d 0a20 2020 2020 2020 0d0a 2020 2020   ..       ..    
-00020cb0: 6765 745f 7363 6f72 653a 2062 6f6f 6c2c  get_score: bool,
-00020cc0: 6465 6661 756c 743d 5472 7565 0d0a 2020  default=True..  
-00020cd0: 2020 2020 4170 7065 6e64 2074 6865 2041      Append the A
-00020ce0: 7265 6120 556e 6465 7220 7468 6520 6375  rea Under the cu
-00020cf0: 7276 6520 746f 206c 6567 656e 642e 200d  rve to legend. .
-00020d00: 0a20 2020 2020 200d 0a20 2020 2020 202e  .      ..      .
-00020d10: 2e20 7665 7273 696f 6e61 6464 6564 3a3a  . versionadded::
-00020d20: 2030 2e32 2e34 200d 0a20 2020 2020 200d   0.2.4 ..      .
-00020d30: 0a20 2020 2061 6c6c 3a20 7374 722c 2064  .    all: str, d
-00020d40: 6566 6175 6c74 3d46 616c 7365 200d 0a20  efault=False .. 
-00020d50: 2020 2020 2020 6966 2060 6054 7275 6560        if ``True`
-00020d60: 602c 2070 6c6f 7420 6561 6368 2052 4f43  `, plot each ROC
-00020d70: 206d 6f64 656c 2073 6570 6172 6174 656c   model separatel
-00020d80: 7920 0d0a 2020 2020 200d 0a20 2020 206e  y ..     ..    n
-00020d90: 616d 6573 3a20 6c69 7374 2c20 0d0a 2020  ames: list, ..  
-00020da0: 2020 2020 204c 6973 7420 6f66 206d 6f64       List of mod
-00020db0: 656c 206e 616d 6573 2e20 4966 206e 6f74  el names. If not
-00020dc0: 2067 6976 656e 2c20 6120 7261 7720 6e61   given, a raw na
-00020dd0: 6d65 206f 6620 7468 6520 6d6f 6465 6c20  me of the model 
-00020de0: 6973 2070 6173 7365 6420 0d0a 2020 2020  is passed ..    
-00020df0: 2020 2069 6e73 7465 6164 2e0d 0a20 2020     instead...   
-00020e00: 2020 2020 0d0a 2020 2020 6b77 733a 2064      ..    kws: d
-00020e10: 6963 742c 0d0a 2020 2020 2020 2020 6b65  ict,..        ke
-00020e20: 7977 6f72 6420 6172 6775 6d65 6e74 206f  yword argument o
-00020e30: 6620 3a66 756e 633a 6073 6b6c 6561 726e  f :func:`sklearn
-00020e40: 2e6d 6574 7269 6373 2e72 6f63 5f63 7572  .metrics.roc_cur
-00020e50: 7665 200d 0a20 2020 2020 2020 200d 0a20  ve ..        .. 
-00020e60: 2020 2052 6574 7572 6e0d 0a20 2020 202d     Return..    -
-00020e70: 2d2d 2d2d 2d2d 0d0a 2020 2020 6178 3a20  ------..    ax: 
-00020e80: 4178 6573 2e53 7562 706c 6f74 2e20 0d0a  Axes.Subplot. ..
-00020e90: 2020 2020 0d0a 2020 2020 4578 616d 706c      ..    Exampl
-00020ea0: 6573 200d 0a20 2020 202d 2d2d 2d2d 2d2d  es ..    -------
-00020eb0: 2d0d 0a20 2020 203e 3e3e 2066 726f 6d20  -..    >>> from 
-00020ec0: 7761 7465 782e 7574 696c 732e 706c 6f74  watex.utils.plot
-00020ed0: 7574 696c 7320 696d 706f 7274 2070 6c6f  utils import plo
-00020ee0: 745f 726f 635f 6375 7276 6573 200d 0a20  t_roc_curves .. 
-00020ef0: 2020 203e 3e3e 2066 726f 6d20 736b 6c65     >>> from skle
-00020f00: 6172 6e2e 6461 7461 7365 7473 2069 6d70  arn.datasets imp
-00020f10: 6f72 7420 6d61 6b65 5f6d 6f6f 6e73 200d  ort make_moons .
-00020f20: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
-00020f30: 7465 782e 6578 6c69 6220 696d 706f 7274  tex.exlib import
-00020f40: 2028 2074 7261 696e 5f74 6573 745f 7370   ( train_test_sp
-00020f50: 6c69 742c 204b 4e65 6967 6862 6f72 7343  lit, KNeighborsC
-00020f60: 6c61 7373 6966 6965 722c 2053 5643 202c  lassifier, SVC ,
-00020f70: 0d0a 2020 2020 5847 4243 6c61 7373 6966  ..    XGBClassif
-00020f80: 6965 722c 204c 6f67 6973 7469 6352 6567  ier, LogisticReg
-00020f90: 7265 7373 696f 6e20 2920 0d0a 2020 2020  ression ) ..    
-00020fa0: 3e3e 3e20 582c 2079 203d 206d 616b 655f  >>> X, y = make_
-00020fb0: 6d6f 6f6e 7320 286e 5f73 616d 706c 6573  moons (n_samples
-00020fc0: 3d32 3030 302c 206e 6f69 7365 3d30 2e32  =2000, noise=0.2
-00020fd0: 290d 0a20 2020 203e 3e3e 2058 2c20 5874  )..    >>> X, Xt
-00020fe0: 2c20 792c 2079 7420 3d20 7472 6169 6e5f  , y, yt = train_
-00020ff0: 7465 7374 5f73 706c 6974 2028 582c 2079  test_split (X, y
-00021000: 2c20 7465 7374 5f73 697a 653d 302e 3229  , test_size=0.2)
-00021010: 200d 0a20 2020 203e 3e3e 2063 6c66 7320   ..    >>> clfs 
-00021020: 3d20 5b20 6d28 292e 6669 7428 582c 2079  = [ m().fit(X, y
-00021030: 2920 666f 7220 6d20 696e 2028 204b 4e65  ) for m in ( KNe
-00021040: 6967 6862 6f72 7343 6c61 7373 6966 6965  ighborsClassifie
-00021050: 722c 2053 5643 202c 200d 0a20 2020 2020  r, SVC , ..     
-00021060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021080: 2020 2020 5847 4243 6c61 7373 6966 6965      XGBClassifie
-00021090: 722c 204c 6f67 6973 7469 6352 6567 7265  r, LogisticRegre
-000210a0: 7373 696f 6e29 5d0d 0a20 2020 203e 3e3e  ssion)]..    >>>
-000210b0: 2070 6c6f 745f 726f 635f 6375 7276 6573   plot_roc_curves
-000210c0: 2863 6c66 732c 2058 742c 2079 7429 0d0a  (clfs, Xt, yt)..
-000210d0: 2020 2020 4f75 745b 3636 5d3a 203c 4178      Out[66]: <Ax
-000210e0: 6573 5375 6270 6c6f 743a 786c 6162 656c  esSubplot:xlabel
-000210f0: 3d27 4661 6c73 6520 506f 7369 7469 7665  ='False Positive
-00021100: 2052 6174 6520 2846 5052 2927 2c20 796c   Rate (FPR)', yl
-00021110: 6162 656c 3d27 5472 7565 2050 6f73 6974  abel='True Posit
-00021120: 6976 6520 5261 7465 2028 4650 5229 273e  ive Rate (FPR)'>
-00021130: 0d0a 2020 2020 3e3e 3e20 706c 6f74 5f72  ..    >>> plot_r
-00021140: 6f63 5f63 7572 7665 7328 636c 6673 2c20  oc_curves(clfs, 
-00021150: 5874 2c20 7974 2c61 6c6c 3d54 7275 652c  Xt, yt,all=True,
-00021160: 206e 636f 6c73 203d 2034 202c 2066 6967   ncols = 4 , fig
-00021170: 5f73 697a 6520 3d20 2831 302c 2034 2929  _size = (10, 4))
-00021180: 0d0a 2020 2020 2222 220d 0a20 2020 2066  ..    """..    f
-00021190: 726f 6d20 2e76 616c 6964 6174 6f72 2069  rom .validator i
-000211a0: 6d70 6f72 7420 2067 6574 5f65 7374 696d  mport  get_estim
-000211b0: 6174 6f72 5f6e 616d 650d 0a20 2020 200d  ator_name..    .
-000211c0: 0a20 2020 2064 6566 2070 6c6f 745f 726f  .    def plot_ro
-000211d0: 6328 6d6f 6465 6c2c 2064 6174 612c 206c  c(model, data, l
-000211e0: 6162 656c 732c 2067 6574 5f73 636f 7265  abels, get_score
-000211f0: 203d 4661 6c73 6520 293a 0d0a 2020 2020   =False ):..    
-00021200: 2020 2020 6966 2068 6173 6174 7472 286d      if hasattr(m
-00021210: 6f64 656c 2c20 2264 6563 6973 696f 6e5f  odel, "decision_
-00021220: 6675 6e63 7469 6f6e 2229 3a0d 0a20 2020  function"):..   
-00021230: 2020 2020 2020 2020 2070 7265 6469 6374           predict
-00021240: 696f 6e73 203d 206d 6f64 656c 2e64 6563  ions = model.dec
-00021250: 6973 696f 6e5f 6675 6e63 7469 6f6e 2864  ision_function(d
-00021260: 6174 6129 0d0a 2020 2020 2020 2020 656c  ata)..        el
-00021270: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00021280: 2070 7265 6469 6374 696f 6e73 203d 206d   predictions = m
-00021290: 6f64 656c 2e70 7265 6469 6374 5f70 726f  odel.predict_pro
-000212a0: 6261 2864 6174 6129 5b3a 2c31 5d0d 0a20  ba(data)[:,1].. 
-000212b0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-000212c0: 2020 2020 2066 7072 2c20 7470 722c 205f       fpr, tpr, _
-000212d0: 203d 2072 6f63 5f63 7572 7665 286c 6162   = roc_curve(lab
-000212e0: 656c 732c 2070 7265 6469 6374 696f 6e73  els, predictions
-000212f0: 2c20 2a2a 726f 635f 6b77 7320 290d 0a20  , **roc_kws ).. 
-00021300: 2020 2020 2020 2061 7563 5f73 636f 7265         auc_score
-00021310: 203d 204e 6f6e 6520 0d0a 2020 2020 2020   = None ..      
-00021320: 2020 6966 2067 6574 5f73 636f 7265 3a20    if get_score: 
-00021330: 0d0a 2020 2020 2020 2020 2020 2020 6175  ..            au
-00021340: 635f 7363 6f72 6520 3d20 726f 635f 6175  c_score = roc_au
-00021350: 635f 7363 6f72 6520 2820 6c61 6265 6c73  c_score ( labels
-00021360: 2c20 7072 6564 6963 7469 6f6e 732c 290d  , predictions,).
-00021370: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00021380: 2020 2020 2020 2072 6574 7572 6e20 6670         return fp
-00021390: 722c 2074 7072 202c 2061 7563 5f73 636f  r, tpr , auc_sco
-000213a0: 7265 0d0a 2020 2020 0d0a 2020 2020 6966  re..    ..    if
-000213b0: 206e 6f74 2069 735f 6974 6572 6162 6c65   not is_iterable
-000213c0: 2028 2063 6c66 7329 3a20 0d0a 2020 2020   ( clfs): ..    
-000213d0: 2020 2063 6c66 7320 3d20 6973 5f69 7465     clfs = is_ite
-000213e0: 7261 626c 6520 2820 636c 6673 2c20 6578  rable ( clfs, ex
-000213f0: 636c 7564 655f 7374 7269 6e67 203d 5472  clude_string =Tr
-00021400: 7565 202c 2074 7261 6e73 666f 726d 203d  ue , transform =
-00021410: 5472 7565 2029 200d 0a20 2020 2020 2020  True ) ..       
-00021420: 0d0a 2020 2020 2320 6d61 6b65 2064 6566  ..    # make def
-00021430: 6175 6c74 5f63 6f6c 6f72 7320 0d0a 2020  ault_colors ..  
-00021440: 2020 636f 6c6f 7273 203d 206d 616b 655f    colors = make_
-00021450: 706c 6f74 5f63 6f6c 6f72 7328 636c 6673  plot_colors(clfs
-00021460: 2c20 636f 6c6f 7273 203d 2063 6f6c 6f72  , colors = color
-00021470: 7320 290d 0a20 2020 2023 2073 6176 6520  s )..    # save 
-00021480: 7468 6520 6e61 6d65 206f 6620 6d6f 6465  the name of mode
-00021490: 6c73 200d 0a20 2020 206e 616d 6573 203d  ls ..    names =
-000214a0: 206d 616b 655f 6f62 6a5f 636f 6e73 6973   make_obj_consis
-000214b0: 7465 6e74 5f69 6620 280d 0a20 2020 2020  tent_if (..     
-000214c0: 2020 206e 616d 6573 202c 205b 2067 6574     names , [ get
-000214d0: 5f65 7374 696d 6174 6f72 5f6e 616d 6528  _estimator_name(
-000214e0: 6d29 2066 6f72 206d 2069 6e20 636c 6673  m) for m in clfs
-000214f0: 205d 2920 0d0a 0d0a 2020 2020 2320 6368   ]) ....    # ch
-00021500: 6563 6b20 7768 6574 6865 7220 7468 6520  eck whether the 
-00021510: 6d6f 6465 6c20 6973 2066 6974 7465 6420  model is fitted 
-00021520: 0d0a 2020 2020 6966 2061 6c6c 3a20 0d0a  ..    if all: ..
-00021530: 2020 2020 2020 2020 6669 672c 2061 7820          fig, ax 
-00021540: 3d20 5f6d 616b 655f 6178 655f 6d75 6c74  = _make_axe_mult
-00021550: 6970 6c65 2028 200d 0a20 2020 2020 2020  iple ( ..       
-00021560: 2020 2020 2063 6c66 732c 206e 636f 6c73       clfs, ncols
-00021570: 203d 206e 636f 6c73 202c 2061 7820 3d20   = ncols , ax = 
-00021580: 6178 2c20 6669 675f 7369 7a65 203d 2066  ax, fig_size = f
-00021590: 6967 5f73 697a 6520 0d0a 2020 2020 2020  ig_size ..      
-000215a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000215b0: 2020 2020 2020 2020 2020 2020 2920 0d0a              ) ..
-000215c0: 2020 2020 2020 2020 0d0a 2020 2020 656c          ..    el
-000215d0: 7365 3a20 0d0a 2020 2020 2020 2020 6966  se: ..        if
-000215e0: 2061 7820 6973 204e 6f6e 653a 200d 0a20   ax is None: .. 
-000215f0: 2020 2020 2020 2020 2020 2066 6967 2c20             fig, 
-00021600: 6178 203d 2070 6c74 2e73 7562 706c 6f74  ax = plt.subplot
-00021610: 7320 2831 2c20 312c 2066 6967 7369 7a65  s (1, 1, figsize
-00021620: 203d 2066 6967 5f73 697a 6520 2920 200d   = fig_size )  .
-00021630: 0a20 2020 200d 0a20 2020 2066 6f72 206b  .    ..    for k
-00021640: 2c20 2820 6d6f 6465 6c2c 206e 616d 6529  , ( model, name)
-00021650: 2020 696e 2065 6e75 6d65 7261 7465 2028    in enumerate (
-00021660: 7a69 7020 2863 6c66 732c 206e 616d 6573  zip (clfs, names
-00021670: 2029 293a 200d 0a20 2020 2020 2020 2063   )): ..        c
-00021680: 6865 636b 5f69 735f 6669 7474 6564 286d  heck_is_fitted(m
-00021690: 6f64 656c 2029 0d0a 2020 2020 2020 2020  odel )..        
-000216a0: 6670 722c 2074 7072 2c20 6175 635f 7363  fpr, tpr, auc_sc
-000216b0: 6f72 6520 3d20 706c 6f74 5f72 6f63 286d  ore = plot_roc(m
-000216c0: 6f64 656c 2c20 582c 2079 2c20 6765 745f  odel, X, y, get_
-000216d0: 7363 6f72 6529 0d0a 0d0a 2020 2020 2020  score)....      
-000216e0: 2020 6966 2068 6173 6174 7472 2028 6178    if hasattr (ax
-000216f0: 2c20 275f 5f6c 656e 5f5f 2729 3a20 0d0a  , '__len__'): ..
-00021700: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00021710: 656e 2861 782e 7368 6170 6529 3e31 3a20  en(ax.shape)>1: 
-00021720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00021730: 2020 692c 206a 2020 3d20 206b 202f 2f20    i, j  =  k // 
-00021740: 6e63 6f6c 7320 2c20 6b20 2520 6e63 6f6c  ncols , k % ncol
-00021750: 7320 0d0a 2020 2020 2020 2020 2020 2020  s ..            
-00021760: 2020 2020 6178 6520 3d20 6178 205b 692c      axe = ax [i,
-00021770: 206a 5d0d 0a20 2020 2020 2020 2020 2020   j]..           
-00021780: 2065 6c73 653a 2061 7865 203d 2061 785b   else: axe = ax[
-00021790: 6b5d 0d0a 2020 2020 2020 2020 656c 7365  k]..        else
-000217a0: 3a20 6178 6520 3d20 6178 200d 0a20 2020  : axe = ax ..   
-000217b0: 2020 2020 2020 2020 200d 0a0d 0a20 2020           ....   
-000217c0: 2020 2020 2061 7865 2e70 6c6f 7428 6670       axe.plot(fp
-000217d0: 722c 2074 7072 2c20 6c61 6265 6c3d 6e61  r, tpr, label=na
-000217e0: 6d65 202b 2028 2727 2069 6620 6175 635f  me + ('' if auc_
-000217f0: 7363 6f72 6520 6973 204e 6f6e 6520 0d0a  score is None ..
-00021800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021820: 2020 2020 2020 2020 2065 6c73 6520 6622           else f"
-00021830: 4155 433d 7b72 6f75 6e64 2861 7563 5f73  AUC={round(auc_s
-00021840: 636f 7265 2c20 3329 207d 2229 202c 200d  core, 3) }") , .
-00021850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021860: 2020 636f 6c6f 7220 3d20 636f 6c6f 7273    color = colors
-00021870: 5b6b 5d20 2029 0d0a 2020 2020 2020 2020  [k]  )..        
-00021880: 0d0a 2020 2020 2020 2020 6966 2061 6c6c  ..        if all
-00021890: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-000218a0: 6178 652e 706c 6f74 285b 302c 2031 5d2c  axe.plot([0, 1],
-000218b0: 205b 302c 2031 5d2c 2027 6b2d 2d27 2920   [0, 1], 'k--') 
-000218c0: 0d0a 2020 2020 2020 2020 2020 2020 6178  ..            ax
-000218d0: 652e 6c65 6765 6e64 2028 290d 0a20 2020  e.legend ()..   
-000218e0: 2020 2020 2020 2020 2061 7865 2e73 6574           axe.set
-000218f0: 5f78 6c61 6265 6c20 2822 4661 6c73 6520  _xlabel ("False 
-00021900: 506f 7369 7469 7665 2052 6174 6520 2846  Positive Rate (F
-00021910: 5052 2922 290d 0a20 2020 2020 2020 2020  PR)")..         
-00021920: 2020 2061 7865 2e73 6574 5f79 6c61 6265     axe.set_ylabe
-00021930: 6c20 2822 5472 7565 2050 6f73 6974 6976  l ("True Positiv
-00021940: 6520 5261 7465 2028 4650 5229 2229 0d0a  e Rate (FPR)")..
-00021950: 2020 2020 2020 2020 2320 656c 7365 3a20          # else: 
-00021960: 0d0a 2020 2020 2020 2020 2320 2020 2020  ..        #     
-00021970: 6178 2e70 6c6f 7428 6670 722c 2074 7072  ax.plot(fpr, tpr
-00021980: 2c20 6c61 6265 6c3d 6e61 6d65 2c20 636f  , label=name, co
-00021990: 6c6f 7220 3d20 636f 6c6f 7273 5b6b 5d29  lor = colors[k])
-000219a0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-000219b0: 2020 2020 6966 206e 6f74 2061 6c6c 3a20      if not all: 
-000219c0: 0d0a 2020 2020 2020 2020 6178 2e70 6c6f  ..        ax.plo
-000219d0: 7428 5b30 2c20 315d 2c20 5b30 2c20 315d  t([0, 1], [0, 1]
-000219e0: 2c20 276b 2d2d 2729 2023 2041 5543 203d  , 'k--') # AUC =
-000219f0: 2e35 200d 0a20 2020 2020 2020 2061 782e  .5 ..        ax.
-00021a00: 7365 745f 786c 6162 656c 2028 2246 616c  set_xlabel ("Fal
-00021a10: 7365 2050 6f73 6974 6976 6520 5261 7465  se Positive Rate
-00021a20: 2028 4650 5229 2229 0d0a 2020 2020 2020   (FPR)")..      
-00021a30: 2020 6178 2e73 6574 5f79 6c61 6265 6c20    ax.set_ylabel 
-00021a40: 2822 5472 7565 2050 6f73 6974 6976 6520  ("True Positive 
-00021a50: 5261 7465 2028 4650 5229 2229 0d0a 2020  Rate (FPR)")..  
-00021a60: 2020 2020 2020 6178 2e6c 6567 656e 6428        ax.legend(
-00021a70: 2920 0d0a 2020 2020 2020 2020 0d0a 2020  ) ..        ..  
-00021a80: 2020 7265 7475 726e 2061 7820 0d0a 2020    return ax ..  
-00021a90: 2020 2020 2020 0d0a 0d0a 2020 2020 0d0a        ....    ..
-00021aa0: 2020 0d0a 2020 2020 0d0a 2020 0d0a 2020    ..    ..  ..  
-00021ab0: 2020 0d0a 2020 0d0a 2020 2020 0d0a 2020    ..  ..    ..  
-00021ac0: 0d0a 2020 2020 0d0a 2020 0d0a 2020 2020  ..    ..  ..    
-00021ad0: 0d0a 2020 0d0a 2020 2020 0d0a 2020 0d0a  ..  ..    ..  ..
-00021ae0: 2020 2020 0d0a 2020 0d0a 2020 2020 0d0a      ..  ..    ..
-00021af0: 2020 0d0a 2020 2020 0d0a 2020 0d0a 2020    ..    ..  ..  
-00021b00: 2020 0d0a 2020 0d0a 2020 2020 0d0a 2020    ..  ..    ..  
-00021b10: 0d0a 2020 2020 0d0a 2020 0d0a 2020 2020  ..    ..  ..    
-00021b20: 0d0a 2020 0d0a 2020 2020 0d0a 2020 0d0a  ..  ..    ..  ..
-00021b30: 2020 2020 0d0a 2020 0d0a 2020 2020 0d0a      ..  ..    ..
-00021b40: 2020 0d0a 2020 2020 0d0a 2020 0d0a 2020    ..    ..  ..  
-00021b50: 2020 0d0a 2020 0d0a 2020 2020 0d0a 2020    ..  ..    ..  
-00021b60: 0d0a 2020 2020 0d0a 2020 0d0a 2020 2020  ..    ..  ..    
-00021b70: 0d0a 2020 0d0a 2020 2020 0d0a 2020 2020  ..  ..    ..    
-00021b80: 0d0a 2020 2020 0d0a 2020 2020 0d0a       ..    ..    ..
+0001dd20: 200d 0a66 6967 5f6e 756d 3a20 696e 742c   ..fig_num: int,
+0001dd30: 2064 6566 6175 6c74 3d31 2c20 0d0a 2020   default=1, ..  
+0001dd40: 2066 6967 7572 6520 6e75 6d62 6572 2074   figure number t
+0001dd50: 6f20 6265 2070 6c6f 7474 6564 2e20 2a44  o be plotted. *D
+0001dd60: 6566 6175 6c74 2a20 6973 2031 0d0a 2020  efault* is 1..  
+0001dd70: 2020 2020 2020 0d0a 666f 6e74 5f73 697a        ..font_siz
+0001dd80: 653a 2066 6c6f 6174 2c20 6465 6661 756c  e: float, defaul
+0001dd90: 743d 3130 2c20 0d0a 2020 2046 6967 7572  t=10, ..   Figur
+0001dda0: 6520 7369 7a65 200d 0a20 2020 0d0a 726f  e size ..   ..ro
+0001ddb0: 745f 7a3a 2066 6c6f 6174 2c20 6465 6661  t_z: float, defa
+0001ddc0: 756c 743d 302e 2c20 0d0a 2020 2061 6e67  ult=0., ..   ang
+0001ddd0: 6c65 206f 6620 726f 7461 7469 6f6e 2063  le of rotation c
+0001dde0: 6c6f 636b 7769 7365 2070 6f73 6974 6976  lockwise positiv
+0001ddf0: 652e 200d 0a0d 0a70 6572 696f 645f 746f  e. ....period_to
+0001de00: 6c65 7261 6e63 653a 2066 6c6f 6174 2c20  lerance: float, 
+0001de10: 6465 6661 756c 743d 2e30 3520 0d0a 2020  default=.05 ..  
+0001de20: 2020 546f 6c65 7261 6e63 6520 6c65 7665    Tolerance leve
+0001de30: 6c20 746f 206d 6174 6368 2070 6572 696f  l to match perio
+0001de40: 6473 2066 726f 6d20 6469 6666 6572 656e  ds from differen
+0001de50: 7420 6564 6920 6669 6c65 732e 0d0a 2020  t edi files...  
+0001de60: 2020 2a44 6566 6175 6c74 2a20 6973 2030    *Default* is 0
+0001de70: 2e30 350d 0a0d 0a74 6578 745f 7061 643a  .05....text_pad:
+0001de80: 2066 6c6f 6174 2c20 6465 6661 756c 743d   float, default=
+0001de90: 312e 3635 0d0a 2020 2070 6164 6469 6e67  1.65..   padding
+0001dea0: 206f 6620 7468 6520 616e 676c 6520 6c61   of the angle la
+0001deb0: 6265 6c20 6174 2074 6865 2062 6f74 746f  bel at the botto
+0001dec0: 6d20 6f66 2065 6163 680d 0a20 2020 2020  m of each..     
+0001ded0: 2020 2020 2020 2020 2020 2020 706f 6c61              pola
+0001dee0: 7220 6469 6167 7261 6d2e 2020 2a44 6566  r diagram.  *Def
+0001def0: 6175 6c74 2a20 6973 2031 2e36 350d 0a70  ault* is 1.65..p
+0001df00: 6c6f 745f 7261 6e67 653a 2020 7374 722c  lot_range:  str,
+0001df10: 2074 7570 6c65 200d 0a20 2020 5468 6520   tuple ..   The 
+0001df20: 7065 7269 6f64 2072 616e 6765 2074 6f20  period range to 
+0001df30: 6573 7469 6d61 7465 2074 6865 2073 7472  estimate the str
+0001df40: 696b 6520 616e 676c 652e 2049 7420 6361  ike angle. It ca
+0001df50: 6e20 6265 200d 0a20 2020 5b20 2764 6174  n be ..   [ 'dat
+0001df60: 6127 207c 2028 7065 7269 6f64 5f6d 696e  a' | (period_min
+0001df70: 2c70 6572 696f 645f 6d61 7829 205d 2e20  ,period_max) ]. 
+0001df80: 204f 7074 696f 6e73 2061 7265 3a0d 0a20   Options are:.. 
+0001df90: 2020 2020 2020 0d0a 2020 202a 202a 2764        ..   * *'d
+0001dfa0: 6174 6127 2a20 666f 7220 6573 7469 6d61  ata'* for estima
+0001dfb0: 7469 6e67 2074 6865 2073 7472 696b 6520  ting the strike 
+0001dfc0: 666f 7220 616c 6c20 7065 7269 6f64 730d  for all periods.
+0001dfd0: 0a20 2020 2020 696e 2074 6865 2064 6174  .     in the dat
+0001dfe0: 612e 0d0a 2020 202a 2028 706d 696e 2c70  a...   * (pmin,p
+0001dff0: 6d61 7829 2066 6f72 2070 6572 696f 6420  max) for period 
+0001e000: 6d69 6e20 616e 6420 7065 7269 6f64 206d  min and period m
+0001e010: 6178 2c20 696e 7075 7420 6173 0d0a 2020  ax, input as..  
+0001e020: 2020 2028 6c6f 6731 3028 706d 696e 292c     (log10(pmin),
+0001e030: 6c6f 6731 3028 706d 6178 2929 0d0a 0d0a  log10(pmax))....
+0001e040: 706c 6f74 5f74 6970 7065 723a 205b 2054  plot_tipper: [ T
+0001e050: 7275 6520 7c20 4661 6c73 6520 5d0d 0a20  rue | False ].. 
+0001e060: 2020 202d 2054 7275 6520 746f 2070 6c6f     - True to plo
+0001e070: 7420 7468 6520 7469 7070 6572 2073 7472  t the tipper str
+0001e080: 696b 650d 0a20 2020 202d 2046 616c 7365  ike..    - False
+0001e090: 2074 6f20 6e6f 7420 706c 6f74 2074 6970   to not plot tip
+0001e0a0: 7065 7220 7374 7269 6b65 0d0a 2020 200d  per strike..   .
+0001e0b0: 0a70 745f 6572 726f 725f 666c 6f6f 723a  .pt_error_floor:
+0001e0c0: 2069 6e74 2c20 6f70 7469 6f6e 616c 200d   int, optional .
+0001e0d0: 0a20 2020 4d61 7869 6d75 6d20 6572 726f  .   Maximum erro
+0001e0e0: 7220 696e 2064 6567 7265 6573 2074 6861  r in degrees tha
+0001e0f0: 7420 6973 2061 6c6c 6f77 6564 2074 6f20  t is allowed to 
+0001e100: 0d0a 2020 2065 7374 696d 6174 6520 7374  ..   estimate st
+0001e110: 7269 6b65 2e20 2a44 6566 6175 6c74 2a20  rike. *Default* 
+0001e120: 6973 204e 6f6e 6520 616c 6c6f 7769 6e67  is None allowing
+0001e130: 2061 6c6c 200d 0a20 2020 6573 7469 6d61   all ..   estima
+0001e140: 7465 7320 746f 2062 6520 7573 6564 2e0d  tes to be used..
+0001e150: 0a0d 0a66 6f6c 643a 205b 2054 7275 6520  ...fold: [ True 
+0001e160: 7c20 4661 6c73 6520 5d0d 0a20 2020 2a20  | False ]..   * 
+0001e170: 5472 7565 2074 6f20 706c 6f74 206f 6e6c  True to plot onl
+0001e180: 7920 6672 6f6d 2030 2074 6f20 3138 300d  y from 0 to 180.
+0001e190: 0a20 2020 2a20 4661 6c73 6520 746f 2070  .   * False to p
+0001e1a0: 6c6f 7420 6672 6f6d 2030 2074 6f20 3336  lot from 0 to 36
+0001e1b0: 300d 0a20 2020 2020 2020 2020 2020 200d  0..            .
+0001e1c0: 0a70 6c6f 745f 6f72 7468 6f67 6f6e 616c  .plot_orthogonal
+0001e1d0: 3a20 5b20 5472 7565 207c 2046 616c 7365  : [ True | False
+0001e1e0: 5d0d 0a20 2020 202a 2054 7275 6520 746f  ]..    * True to
+0001e1f0: 2070 6c6f 7420 7468 6520 6f72 7468 6f67   plot the orthog
+0001e200: 6f6e 616c 2073 7472 696b 6520 6469 7265  onal strike dire
+0001e210: 6374 696f 6e73 0d0a 2020 2020 2a20 4661  ctions..    * Fa
+0001e220: 6c73 6520 746f 206e 6f74 0d0a 0d0a 636f  lse to not....co
+0001e230: 6c6f 723a 205b 2054 7275 6520 7c20 4661  lor: [ True | Fa
+0001e240: 6c73 6520 5d0d 0a20 2020 202a 2054 7275  lse ]..    * Tru
+0001e250: 6520 746f 2070 6c6f 7420 7368 6164 6520  e to plot shade 
+0001e260: 636f 6c6f 7273 0d0a 2020 2020 2a20 4661  colors..    * Fa
+0001e270: 6c73 6520 746f 2070 6c6f 7420 616c 6c20  lse to plot all 
+0001e280: 696e 206f 6e65 2063 6f6c 6f72 0d0a 2020  in one color..  
+0001e290: 2020 2020 2020 2020 2020 2020 0d0a 636f              ..co
+0001e2a0: 6c6f 725f 696e 763a 7374 722c 200d 0a20  lor_inv:str, .. 
+0001e2b0: 2020 636f 6c6f 7220 6f66 2069 6e76 6172    color of invar
+0001e2c0: 6961 6e74 7320 706c 6f74 730d 0a0d 0a63  iants plots....c
+0001e2d0: 6f6c 6f72 5f70 743a 2073 7472 2c20 0d0a  olor_pt: str, ..
+0001e2e0: 2020 2063 6f6c 6f72 206f 6620 7068 6173     color of phas
+0001e2f0: 6520 7465 6e73 6f72 2070 6c6f 7473 0d0a  e tensor plots..
+0001e300: 0d0a 636f 6c6f 725f 7469 703a 2073 7472  ..color_tip: str
+0001e310: 200d 0a20 2020 636f 6c6f 7220 6f66 2074   ..   color of t
+0001e320: 6970 7065 7220 706c 6f74 730d 0a0d 0a72  ipper plots....r
+0001e330: 696e 675f 7370 6163 696e 673a 2066 6c6f  ing_spacing: flo
+0001e340: 6174 2c20 6f70 7469 6f6e 616c 200d 0a20  at, optional .. 
+0001e350: 2020 2073 7061 6369 6e67 206f 6620 7269     spacing of ri
+0001e360: 6e67 7320 696e 2070 6f6c 6172 2070 6c6f  ngs in polar plo
+0001e370: 7473 0d0a 0d0a 7269 6e67 5f6c 696d 6974  ts....ring_limit
+0001e380: 733a 2074 7570 6c65 206f 6620 696e 742c  s: tuple of int,
+0001e390: 200d 0a20 2020 706c 6f74 206c 696d 6974   ..   plot limit
+0001e3a0: 7320 286d 696e 2063 6f75 6e74 2c20 6d61  s (min count, ma
+0001e3b0: 7820 636f 756e 7429 2073 6574 2065 6163  x count) set eac
+0001e3c0: 6820 706c 6f74 2068 6176 6520 7468 6573  h plot have thes
+0001e3d0: 6520 6c69 6d69 7473 200d 0a20 2020 2020  e limits ..     
+0001e3e0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+0001e3f0: 0a70 6c6f 745f 6f72 6965 6e74 6174 696f  .plot_orientatio
+0001e400: 6e3a 2073 7472 2c20 5b20 2768 2720 7c20  n: str, [ 'h' | 
+0001e410: 2776 2720 5d20 0d0a 2020 2068 6f72 697a  'v' ] ..   horiz
+0001e420: 6f6e 7461 6c20 6f72 2076 6572 7469 6361  ontal or vertica
+0001e430: 6c20 706c 6f74 730d 0a0d 0a0d 0a53 6565  l plots......See
+0001e440: 204d 6f72 650d 0a2d 2d2d 2d2d 2d2d 2d0d   More..--------.
+0001e450: 0a50 6c6f 7473 2074 6865 2073 7472 696b  .Plots the strik
+0001e460: 6520 616e 676c 6520 6173 2064 6574 6572  e angle as deter
+0001e470: 6d69 6e65 6420 6279 2069 6e76 6172 6961  mined by invaria
+0001e480: 6e74 7320 6f66 2074 6865 2069 6d70 6564  nts of the imped
+0001e490: 616e 6365 2074 656e 736f 7220 0d0a 2857  ance tensor ..(W
+0001e4a0: 6561 7665 7220 6574 2061 6c2e 205b 3230  eaver et al. [20
+0001e4b0: 3033 5d20 5b31 5d5f 2920 616e 6420 7068  03] [1]_) and ph
+0001e4c0: 6173 6520 7465 6e73 6f72 2061 7a69 6d75  ase tensor azimu
+0001e4d0: 7468 200d 0a28 4361 6c64 7765 6c6c 2065  th ..(Caldwell e
+0001e4e0: 7420 616c 2e20 5b32 3030 345d 205b 325d  t al. [2004] [2]
+0001e4f0: 5f29 200d 0a0d 0a54 6865 2064 6174 6120  _) ....The data 
+0001e500: 6973 2073 706c 6974 2069 6e74 6f20 6465  is split into de
+0001e510: 6361 6465 7320 7768 6572 6520 7468 6520  cades where the 
+0001e520: 6869 7374 6f67 7261 6d20 666f 7220 6561  histogram for ea
+0001e530: 6368 2069 7320 706c 6f74 7465 6420 696e  ch is plotted in
+0001e540: 0d0a 7468 6520 666f 726d 206f 6620 6120  ..the form of a 
+0001e550: 726f 7365 2064 6961 6772 616d 2077 6974  rose diagram wit
+0001e560: 6820 6120 7261 6e67 6520 6f66 2030 2074  h a range of 0 t
+0001e570: 6f20 3138 3020 6465 6772 6565 732e 0d0a  o 180 degrees...
+0001e580: 5768 6572 6520 3020 6973 204e 6f72 7468  Where 0 is North
+0001e590: 2061 6e64 2039 3020 6973 2045 6173 742e   and 90 is East.
+0001e5a0: 2020 5468 6520 6d65 6469 616e 2061 6e67    The median ang
+0001e5b0: 6c65 206f 6620 7468 6520 7065 7269 6f64  le of the period
+0001e5c0: 2062 616e 6420 6973 0d0a 7365 7420 696e   band is..set in
+0001e5d0: 2070 6f6c 6172 2064 6961 6772 616d 2e20   polar diagram. 
+0001e5e0: 2054 6865 2074 6f70 2072 6f77 2069 7320   The top row is 
+0001e5f0: 7468 6520 7374 7269 6b65 2065 7374 696d  the strike estim
+0001e600: 6174 6564 2066 726f 6d0d 0a74 6865 2069  ated from..the i
+0001e610: 6e76 6172 6961 6e74 7320 6f66 2074 6865  nvariants of the
+0001e620: 2069 6d70 6564 616e 6365 2074 656e 736f   impedance tenso
+0001e630: 722e 2020 5468 6520 626f 7474 6f6d 2072  r.  The bottom r
+0001e640: 6f77 2069 7320 7468 6520 617a 696d 7574  ow is the azimut
+0001e650: 680d 0a65 7374 696d 6174 6564 2066 726f  h..estimated fro
+0001e660: 6d20 7468 6520 7068 6173 6520 7465 6e73  m the phase tens
+0001e670: 6f72 2e20 2049 6620 7469 7070 6572 2069  or.  If tipper i
+0001e680: 7320 2779 2720 7468 656e 2074 6865 2033  s 'y' then the 3
+0001e690: 7264 2072 6f77 2069 7320 7468 650d 0a73  rd row is the..s
+0001e6a0: 7472 696b 6520 6465 7465 726d 696e 6564  trike determined
+0001e6b0: 2066 726f 6d20 7468 6520 7469 7070 6572   from the tipper
+0001e6c0: 2c20 7768 6963 6820 6973 206f 7274 686f  , which is ortho
+0001e6d0: 676f 6e61 6c20 746f 2074 6865 2069 6e64  gonal to the ind
+0001e6e0: 7563 7469 6f6e 0d0a 6172 726f 7720 6469  uction..arrow di
+0001e6f0: 7265 6374 696f 6e2e 0d0a 0d0a 5265 6665  rection.....Refe
+0001e700: 7265 6e63 6573 200d 0a2d 2d2d 2d2d 2d2d  rences ..-------
+0001e710: 2d2d 2d0d 0a2e 2e20 5b31 5d20 5765 6176  ---.... [1] Weav
+0001e720: 6572 204a 2e54 2c20 4c69 6c6c 6579 2046  er J.T, Lilley F
+0001e730: 2e45 2e4d 2e28 3230 3033 2920 2049 6e76  .E.M.(2003)  Inv
+0001e740: 6172 6961 6e74 7320 6f66 2072 6f74 6174  ariants of rotat
+0001e750: 696f 6e20 6f66 2061 7865 7320 616e 6420  ion of axes and 
+0001e760: 696e 6469 6361 746f 7273 206f 660d 0a20  indicators of.. 
+0001e770: 2020 2020 2020 6469 6d65 6e73 696f 6e61        dimensiona
+0001e780: 6c69 7479 2069 6e20 6d61 676e 6574 6f74  lity in magnetot
+0001e790: 656c 6c75 7269 6373 2c20 4175 7374 7261  ellurics, Austra
+0001e7a0: 6c69 616e 204e 6174 696f 6e61 6c20 556e  lian National Un
+0001e7b0: 6976 6572 7369 7479 2c0d 0a20 2020 2020  iversity,..     
+0001e7c0: 2020 556e 6976 6572 7369 7479 206f 6620    University of 
+0001e7d0: 5669 6374 6f72 6961 3b20 6874 7470 3a2f  Victoria; http:/
+0001e7e0: 2f62 6962 2e67 667a 2d70 6f74 7364 616d  /bib.gfz-potsdam
+0001e7f0: 2e64 652f 656d 7466 2f32 3030 372f 7064  .de/emtf/2007/pd
+0001e800: 662f 6c69 6c6c 6579 2e70 6466 0d0a 2e2e  f/lilley.pdf....
+0001e810: 205b 325d 2054 2e20 4772 616e 7420 4361   [2] T. Grant Ca
+0001e820: 6c64 7765 6c6c 2c20 4875 6768 204d 2e20  ldwell, Hugh M. 
+0001e830: 4269 6262 792c 2043 6f6c 696e 2042 726f  Bibby, Colin Bro
+0001e840: 776e 2c20 5468 6520 6d61 676e 6574 6f74  wn, The magnetot
+0001e850: 656c 6c75 7269 6320 7068 6173 6520 7465  elluric phase te
+0001e860: 6e73 6f72 2c20 0d0a 2020 2020 2020 2047  nsor, ..       G
+0001e870: 656f 7068 7973 6963 616c 204a 6f75 726e  eophysical Journ
+0001e880: 616c 2049 6e74 6572 6e61 7469 6f6e 616c  al International
+0001e890: 2c20 566f 6c75 6d65 2031 3538 2c20 4973  , Volume 158, Is
+0001e8a0: 7375 6520 322c 2041 7567 7573 7420 3230  sue 2, August 20
+0001e8b0: 3034 2c20 0d0a 2020 2020 2020 2050 6167  04, ..       Pag
+0001e8c0: 6573 2034 3537 e280 9334 3639 2c20 6874  es 457...469, ht
+0001e8d0: 7470 733a 2f2f 646f 692e 6f72 672f 3130  tps://doi.org/10
+0001e8e0: 2e31 3131 312f 6a2e 3133 3635 2d32 3436  .1111/j.1365-246
+0001e8f0: 582e 3230 3034 2e30 3232 3831 2e78 0d0a  X.2004.02281.x..
+0001e900: 4578 616d 706c 6573 200d 0a2d 2d2d 2d2d  Examples ..-----
+0001e910: 2d2d 2d2d 2d0d 0a3e 3e3e 2069 6d70 6f72  -----..>>> impor
+0001e920: 7420 6f73 200d 0a3e 3e3e 2066 726f 6d20  t os ..>>> from 
+0001e930: 7761 7465 782e 6461 7461 7365 7473 2069  watex.datasets i
+0001e940: 6d70 6f72 7420 6665 7463 685f 6461 7461  mport fetch_data
+0001e950: 200d 0a3e 3e3e 2066 726f 6d20 7761 7465   ..>>> from wate
+0001e960: 782e 7574 696c 732e 706c 6f74 7574 696c  x.utils.plotutil
+0001e970: 7320 696d 706f 7274 2070 6c6f 745f 7374  s import plot_st
+0001e980: 7269 6b65 200d 0a3e 3e3e 2066 726f 6d20  rike ..>>> from 
+0001e990: 7761 7465 782e 6461 7461 7365 7473 2e5f  watex.datasets._
+0001e9a0: 696f 2069 6d70 6f72 7420 6765 745f 6461  io import get_da
+0001e9b0: 7461 2023 2067 6574 2065 6469 6461 7461  ta # get edidata
+0001e9c0: 2069 6e20 6361 6368 6520 200d 0a3e 3e3e   in cache  ..>>>
+0001e9d0: 2066 6574 6368 5f64 6174 6120 2820 2768   fetch_data ( 'h
+0001e9e0: 7561 7975 616e 272c 2073 616d 706c 6573  uayuan', samples
+0001e9f0: 203d 2032 3520 2920 2320 7374 6f72 6520   = 25 ) # store 
+0001ea00: 6564 6920 696e 2063 6163 6865 200d 0a3e  edi in cache ..>
+0001ea10: 3e3e 2023 2067 6574 2074 6865 2065 6469  >> # get the edi
+0001ea20: 2069 6e20 6361 6368 6520 616e 6420 706c   in cache and pl
+0001ea30: 6f74 5374 7269 6b65 200d 0a3e 3e3e 2065  otStrike ..>>> e
+0001ea40: 6469 5f66 6e5f 6c73 7420 3d20 5b6f 732e  di_fn_lst = [os.
+0001ea50: 7061 7468 2e6a 6f69 6e28 6765 745f 6461  path.join(get_da
+0001ea60: 7461 2829 2c66 6629 2066 6f72 2066 6620  ta(),ff) for ff 
+0001ea70: 696e 206f 732e 6c69 7374 6469 7228 6765  in os.listdir(ge
+0001ea80: 745f 6461 7461 2829 2920 0d0a 2e2e 2e20  t_data()) ..... 
+0001ea90: 2020 2020 2020 2020 6966 2066 662e 656e          if ff.en
+0001eaa0: 6473 7769 7468 2827 2e65 6469 2729 5d20  dswith('.edi')] 
+0001eab0: 0d0a 3e3e 3e20 706c 6f74 5f73 7472 696b  ..>>> plot_strik
+0001eac0: 6528 6564 695f 666e 5f6c 7374 2029 0d0a  e(edi_fn_lst )..
+0001ead0: 0d0a 2222 220d 0a64 6566 2070 6c6f 745f  .."""..def plot_
+0001eae0: 7465 7874 2028 0d0a 2020 2020 782c 2079  text (..    x, y
+0001eaf0: 2c20 0d0a 2020 2020 7465 7874 3d4e 6f6e  , ..    text=Non
+0001eb00: 6520 2c20 0d0a 2020 2020 6461 7461 203d  e , ..    data =
+0001eb10: 4e6f 6e65 2c20 0d0a 2020 2020 636f 6572  None, ..    coer
+0001eb20: 6365 203d 4661 6c73 652c 200d 0a20 2020  ce =False, ..   
+0001eb30: 2062 6173 656e 616d 6520 3d27 5327 2c20   basename ='S', 
+0001eb40: 0d0a 2020 2020 6669 675f 7369 7a65 203d  ..    fig_size =
+0001eb50: 2820 372c 2037 2029 2c20 0d0a 2020 2020  ( 7, 7 ), ..    
+0001eb60: 7368 6f77 5f6c 696e 6520 3d46 616c 7365  show_line =False
+0001eb70: 2c20 0d0a 2020 2020 7374 6570 203d 204e  , ..    step = N
+0001eb80: 6f6e 6520 2c20 0d0a 2020 2020 786c 6162  one , ..    xlab
+0001eb90: 656c 203d 2727 2c20 0d0a 2020 2020 796c  el ='', ..    yl
+0001eba0: 6162 656c 203d 2727 2c20 0d0a 2020 2020  abel ='', ..    
+0001ebb0: 636f 6c6f 723d 2027 6b27 2c20 0d0a 2020  color= 'k', ..  
+0001ebc0: 2020 6d63 6f6c 6f72 3d27 6b27 2c20 0d0a    mcolor='k', ..
+0001ebd0: 2020 2020 6c63 6f6c 6f72 3d4e 6f6e 652c      lcolor=None,
+0001ebe0: 200d 0a20 2020 2073 686f 775f 6c65 6720   ..    show_leg 
+0001ebf0: 3d46 616c 7365 2c0d 0a20 2020 206c 696e  =False,..    lin
+0001ec00: 656c 6162 656c 3d27 272c 200d 0a20 2020  elabel='', ..   
+0001ec10: 206d 6172 6b65 726c 6162 656c 3d27 272c   markerlabel='',
+0001ec20: 200d 0a20 2020 2061 783d 4e6f 6e65 2c20   ..    ax=None, 
+0001ec30: 0d0a 2020 2020 2a2a 7465 7874 5f6b 7773  ..    **text_kws
+0001ec40: 0d0a 2020 2020 293a 200d 0a20 2020 2022  ..    ): ..    "
+0001ec50: 2222 2050 6c6f 7420 7465 7874 2873 2920  "" Plot text(s) 
+0001ec60: 696e 6469 6361 7469 6e67 2065 6163 6820  indicating each 
+0001ec70: 706f 7369 7469 6f6e 2069 6e20 7468 6520  position in the 
+0001ec80: 6c69 6e65 2e20 0d0a 2020 2020 0d0a 2020  line. ..    ..  
+0001ec90: 2020 5061 7261 6d65 7465 7273 200d 0a20    Parameters .. 
+0001eca0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a     -----------..
+0001ecb0: 2020 2020 782c 2079 3a20 7374 722c 2066      x, y: str, f
+0001ecc0: 6c6f 6174 2c20 4172 7261 792d 6c69 6b65  loat, Array-like
+0001ecd0: 200d 0a20 2020 2020 2020 2054 6865 2070   ..        The p
+0001ece0: 6f73 6974 696f 6e20 746f 2070 6c61 6365  osition to place
+0001ecf0: 2074 6865 2074 6578 742e 2042 7920 6465   the text. By de
+0001ed00: 6661 756c 742c 2074 6869 7320 6973 2069  fault, this is i
+0001ed10: 6e20 6461 7461 200d 0a20 2020 2020 2020  n data ..       
+0001ed20: 2063 6f6f 7264 696e 6174 6573 2e20 5468   coordinates. Th
+0001ed30: 6520 636f 6f72 6469 6e61 7465 2073 7973  e coordinate sys
+0001ed40: 7465 6d20 6361 6e20 6265 2063 6861 6e67  tem can be chang
+0001ed50: 6564 2075 7369 6e67 2074 6865 200d 0a20  ed using the .. 
+0001ed60: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
+0001ed70: 2070 6172 616d 6574 6572 2e0d 0a20 2020   parameter...   
+0001ed80: 2020 2020 200d 0a20 2020 2074 6578 743a       ..    text:
+0001ed90: 2073 7472 2c20 0d0a 2020 2020 2020 2020   str, ..        
+0001eda0: 5468 6520 7465 7874 0d0a 2020 2020 2020  The text..      
+0001edb0: 2020 0d0a 2020 2020 6461 7461 3a20 7064    ..    data: pd
+0001edc0: 2e44 6174 6146 7261 6d65 2c20 0d0a 2020  .DataFrame, ..  
+0001edd0: 2020 2020 2044 6174 6120 636f 6e74 6169       Data contai
+0001ede0: 6e69 6e67 2078 2061 6e64 2079 206e 616d  ning x and y nam
+0001edf0: 6573 2e20 4e65 6564 2074 6f20 6265 2073  es. Need to be s
+0001ee00: 7570 706c 6965 6420 7768 656e 2078 2061  upplied when x a
+0001ee10: 6e64 2079 200d 0a20 2020 2020 2020 6172  nd y ..       ar
+0001ee20: 6520 6769 7665 6e20 6173 2073 7472 696e  e given as strin
+0001ee30: 6720 6e61 6d65 732e 200d 0a20 2020 2020  g names. ..     
+0001ee40: 2020 0d0a 2020 2020 636f 6572 6365 3a62    ..    coerce:b
+0001ee50: 6f6f 6c2c 2064 6566 6175 6c74 3d46 616c  ool, default=Fal
+0001ee60: 7365 200d 0a20 2020 2020 2020 466f 7263  se ..       Forc
+0001ee70: 6520 7468 6520 706c 6f74 2064 6573 7069  e the plot despi
+0001ee80: 7465 2074 6865 2067 6976 656e 2074 6578  te the given tex
+0001ee90: 7465 7320 646f 206e 6f74 206d 6174 6368  tes do not match
+0001eea0: 2074 6865 206e 756d 6265 7220 6f66 2020   the number of  
+0001eeb0: 0d0a 2020 2020 2020 2070 6f73 6974 696f  ..       positio
+0001eec0: 6e73 2060 7860 2061 6e64 2060 7960 2e20  ns `x` and `y`. 
+0001eed0: 4966 2060 6046 616c 7365 6060 2c20 6e75  If ``False``, nu
+0001eee0: 6d62 6572 206f 6620 706f 7369 7469 6f6e  mber of position
+0001eef0: 7320 6d75 7374 2062 6520 0d0a 2020 2020  s must be ..    
+0001ef00: 2020 2063 6f6e 7369 7374 656e 7420 7769     consistent wi
+0001ef10: 7468 2078 2061 6e64 2079 2c20 6f74 6865  th x and y, othe
+0001ef20: 7277 6973 6520 6572 726f 7220 7261 6973  rwise error rais
+0001ef30: 6573 2e20 0d0a 2020 2020 2020 200d 0a20  es. ..       .. 
+0001ef40: 2020 2062 6173 656e 616d 653a 2073 7472     basename: str
+0001ef50: 2c20 6465 6661 756c 743d 2753 2720 0d0a  , default='S' ..
+0001ef60: 2020 2020 2020 2074 6865 2074 6578 7420         the text 
+0001ef70: 746f 2070 7265 6669 7820 7468 6520 706f  to prefix the po
+0001ef80: 7369 7469 6f6e 2077 6865 6e20 7468 6520  sition when the 
+0001ef90: 7465 7874 2069 7320 6e6f 7420 6769 7665  text is not give
+0001efa0: 6e2e 200d 0a20 2020 2020 2020 0d0a 2020  n. ..       ..  
+0001efb0: 2020 6669 675f 7369 7a65 3a20 7475 706c    fig_size: tupl
+0001efc0: 652c 2064 6566 6175 6c74 3d28 372c 2037  e, default=(7, 7
+0001efd0: 2920 0d0a 2020 2020 2020 204d 6174 706c  ) ..       Matpl
+0001efe0: 6f74 6c69 6220 6669 6775 7265 2073 697a  otlib figure siz
+0001eff0: 652e 0d0a 2020 2020 2020 200d 0a20 2020  e...       ..   
+0001f000: 2073 686f 775f 6c69 6e65 3a20 626f 6f6c   show_line: bool
+0001f010: 2c20 6465 6661 756c 743d 4661 6c73 6520  , default=False 
+0001f020: 0d0a 2020 2020 2020 2044 6973 706c 6179  ..       Display
+0001f030: 2074 6865 206c 696e 6520 6672 6f6d 2078   the line from x
+0001f040: 2c20 792e 200d 0a20 2020 2020 2020 0d0a  , y. ..       ..
+0001f050: 2020 2020 7374 6570 3a20 696e 742c 4f70      step: int,Op
+0001f060: 7469 6f6e 616c 200d 0a20 2020 2020 2020  tional ..       
+0001f070: 5468 6520 6e75 6d62 6572 206f 6620 696e  The number of in
+0001f080: 7465 726d 6564 6961 7465 2070 6f73 6974  termediate posit
+0001f090: 696f 6e73 2074 6f20 736b 6970 2069 6e20  ions to skip in 
+0001f0a0: 7468 6520 706c 6f74 7469 6e67 2074 6578  the plotting tex
+0001f0b0: 742e 200d 0a20 2020 2020 2020 0d0a 2020  t. ..       ..  
+0001f0c0: 2020 786c 6162 656c 2c20 796c 6162 656c    xlabel, ylabel
+0001f0d0: 3a20 7374 722c 204f 7074 696f 6e61 6c2c  : str, Optional,
+0001f0e0: 200d 0a20 2020 2020 2020 5468 6520 6c61   ..       The la
+0001f0f0: 6265 6c73 206f 6620 7820 616e 6420 792e  bels of x and y.
+0001f100: 200d 0a20 2020 2020 2020 0d0a 2020 2020   ..       ..    
+0001f110: 636f 6c6f 723a 2073 7472 2c20 6465 6661  color: str, defa
+0001f120: 756c 743d 276b 272c 200d 0a20 2020 2020  ult='k', ..     
+0001f130: 2020 5465 7874 2063 6f6c 6f72 2e0d 0a20    Text color... 
+0001f140: 2020 2020 2020 0d0a 2020 2020 6d63 6f6c        ..    mcol
+0001f150: 6f72 3a20 7374 722c 2064 6566 6175 6c74  or: str, default
+0001f160: 3d27 6b27 2c20 0d0a 2020 2020 2020 204d  ='k', ..       M
+0001f170: 6172 6b65 7220 636f 6c6f 722e 200d 0a20  arker color. .. 
+0001f180: 2020 2020 2020 0d0a 2020 2020 6c63 6f6c        ..    lcol
+0001f190: 6f72 3a20 7374 722c 204f 7074 696f 6e61  or: str, Optiona
+0001f1a0: 6c20 0d0a 2020 2020 2020 204c 696e 6520  l ..       Line 
+0001f1b0: 636f 6c6f 7220 6966 2060 7368 6f77 5f6c  color if `show_l
+0001f1c0: 696e 6560 2069 7320 7365 7420 746f 2060  ine` is set to `
+0001f1d0: 6054 7275 6560 602e 200d 0a20 2020 2020  `True``. ..     
+0001f1e0: 2020 0d0a 2020 2020 7368 6f77 5f6c 6567    ..    show_leg
+0001f1f0: 3a20 626f 6f6c 2c20 6465 6661 756c 743d  : bool, default=
+0001f200: 4661 6c73 6520 0d0a 2020 2020 2020 2044  False ..       D
+0001f210: 6973 706c 6179 2074 6865 206c 6567 656e  isplay the legen
+0001f220: 6420 6f66 206c 696e 6520 616e 6420 6d61  d of line and ma
+0001f230: 726b 6572 206c 6162 656c 732e 200d 0a20  rker labels. .. 
+0001f240: 2020 2020 2020 0d0a 2020 2020 6c69 6e65        ..    line
+0001f250: 6c61 6265 6c2c 206d 6172 6b65 726c 6162  label, markerlab
+0001f260: 656c 3a20 7374 722c 204f 7074 696f 6e61  el: str, Optiona
+0001f270: 6c20 0d0a 2020 2020 2020 2020 5468 6520  l ..        The 
+0001f280: 6c61 6265 6c73 206f 6620 7468 6520 6c69  labels of the li
+0001f290: 6e65 2061 6e64 206d 6172 6b65 722e 200d  ne and marker. .
+0001f2a0: 0a20 2020 2020 2020 0d0a 2020 2020 6178  .       ..    ax
+0001f2b0: 3a20 4d61 7470 6c6f 746c 6962 2e41 7865  : Matplotlib.Axe
+0001f2c0: 732c 206f 7074 696f 6e61 6c20 0d0a 2020  s, optional ..  
+0001f2d0: 2020 2020 2053 7570 706f 7274 2070 6c6f       Support plo
+0001f2e0: 7420 746f 2061 6e6f 7468 6572 2061 7865  t to another axe
+0001f2f0: 7320 0d0a 2020 2020 2020 200d 0a20 2020  s ..       ..   
+0001f300: 2020 2020 2e2e 2076 6572 7369 6f6e 6164      .. versionad
+0001f310: 6465 643a 3a20 302e 322e 3520 0d0a 2020  ded:: 0.2.5 ..  
+0001f320: 2020 2020 200d 0a20 2020 2074 6578 745f       ..    text_
+0001f330: 6b77 733a 2064 6963 742c 200d 0a20 2020  kws: dict, ..   
+0001f340: 2020 2020 4b65 7977 6f72 6420 6172 6775      Keyword argu
+0001f350: 6d65 6e74 7320 7061 7373 6564 2074 6f20  ments passed to 
+0001f360: 3a6d 6574 683a 606d 6174 706c 6f74 6c69  :meth:`matplotli
+0001f370: 622e 6178 6573 2e41 7865 732e 7465 7874  b.axes.Axes.text
+0001f380: 602e 200d 0a0d 0a20 2020 2052 6574 7572  `. ....    Retur
+0001f390: 6e20 0d0a 2020 2020 2d2d 2d2d 2d2d 2d0d  n ..    -------.
+0001f3a0: 0a20 2020 2061 783a 204d 6174 706c 6f74  .    ax: Matplot
+0001f3b0: 6c69 6220 6178 6573 200d 0a20 2020 200d  lib axes ..    .
+0001f3c0: 0a20 2020 2045 7861 6d70 6c65 7320 0d0a  .    Examples ..
+0001f3d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020      --------..  
+0001f3e0: 2020 3e3e 3e20 696d 706f 7274 2077 6174    >>> import wat
+0001f3f0: 6578 2061 7320 7778 200d 0a20 2020 203e  ex as wx ..    >
+0001f400: 3e3e 2064 6174 6120 3d77 782e 6d61 6b65  >> data =wx.make
+0001f410: 5f65 7270 2028 6173 5f66 7261 6d65 203d  _erp (as_frame =
+0001f420: 5472 7565 2c20 6e5f 7374 6174 696f 6e73  True, n_stations
+0001f430: 3d20 3720 290d 0a20 2020 203e 3e3e 2078  = 7 )..    >>> x
+0001f440: 202c 2079 203d 5b20 302c 2031 2c20 3320   , y =[ 0, 1, 3 
+0001f450: 5d2c 205b 322c 2033 2c20 365d 200d 0a20  ], [2, 3, 6] .. 
+0001f460: 2020 203e 3e3e 2074 6578 746f 203d 205b     >>> texto = [
+0001f470: 2741 4d54 2d45 3131 3437 272c 2027 414d  'AMT-E1147', 'AM
+0001f480: 542d 4531 3134 3827 2c20 2027 414d 542d  T-E1148',  'AMT-
+0001f490: 4531 3830 275d 0d0a 2020 2020 3e3e 3e20  E180']..    >>> 
+0001f4a0: 706c 6f74 5f74 6578 7420 2878 2c20 7920  plot_text (x, y 
+0001f4b0: 2c20 7465 7874 203d 2074 6578 746f 2923  , text = texto)#
+0001f4c0: 206e 6f20 6e65 6564 2074 6f20 7365 7420   no need to set 
+0001f4d0: 2063 6f65 7263 652c 2073 616d 6520 6c65   coerce, same le
+0001f4e0: 6e67 7468 200d 0a20 2020 203e 3e3e 2064  ngth ..    >>> d
+0001f4f0: 6174 6120 3d77 782e 6d61 6b65 5f65 7270  ata =wx.make_erp
+0001f500: 2028 6173 5f66 7261 6d65 203d 5472 7565   (as_frame =True
+0001f510: 2c20 6e5f 7374 6174 696f 6e73 3d20 3230  , n_stations= 20
+0001f520: 2029 0d0a 2020 2020 3e3e 3e20 7820 2c20   )..    >>> x , 
+0001f530: 7920 3d20 6461 7461 2e65 6173 7469 6e67  y = data.easting
+0001f540: 2c20 6461 7461 2e6e 6f72 7468 696e 670d  , data.northing.
+0001f550: 0a20 2020 203e 3e3e 2074 6578 7431 203d  .    >>> text1 =
+0001f560: 205b 2741 4d54 2d45 3131 3437 272c 2027   ['AMT-E1147', '
+0001f570: 414d 542d 4531 3134 3827 2c20 2027 414d  AMT-E1148',  'AM
+0001f580: 542d 4531 3830 275d 200d 0a20 2020 203e  T-E180'] ..    >
+0001f590: 3e3e 2070 6c6f 745f 7465 7874 2028 782c  >> plot_text (x,
+0001f5a0: 2079 202c 2063 6f65 7263 6520 3d54 7275   y , coerce =Tru
+0001f5b0: 6520 2c20 7465 7874 203d 2074 6578 7431  e , text = text1
+0001f5c0: 202c 2073 686f 775f 6c65 673d 2054 7275   , show_leg= Tru
+0001f5d0: 652c 200d 0a20 2020 2020 2020 2020 2020  e, ..           
+0001f5e0: 2020 2020 2020 2020 7368 6f77 5f6c 696e          show_lin
+0001f5f0: 653d 5472 7565 2c20 6c69 6e65 6c61 6265  e=True, linelabe
+0001f600: 6c3d 2745 312d 6c69 6e65 272c 206d 6172  l='E1-line', mar
+0001f610: 6b65 726c 6162 656c 3d20 2753 6974 6527  kerlabel= 'Site'
+0001f620: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+0001f630: 2020 2062 6173 656e 616d 6520 3d27 414d     basename ='AM
+0001f640: 542d 4530 2720 0d0a 2020 2020 2020 2020  T-E0' ..        
+0001f650: 2020 2020 2020 2029 0d0a 2020 2020 2222         )..    ""
+0001f660: 220d 0a20 2020 2023 2061 7373 756d 6520  "..    # assume 
+0001f670: 782c 2079 2020 7365 7269 6573 2061 7265  x, y  series are
+0001f680: 2070 6173 7365 6420 0d0a 2020 2020 6966   passed ..    if
+0001f690: 2069 7369 6e73 7461 6e63 6528 782c 2073   isinstance(x, s
+0001f6a0: 7472 2920 6f72 2068 6173 6174 7472 2028  tr) or hasattr (
+0001f6b0: 2078 2c20 276e 616d 6527 293a 200d 0a20   x, 'name'): .. 
+0001f6c0: 2020 2020 2020 2078 6c61 6265 6c20 3d20         xlabel = 
+0001f6d0: 7820 2069 6620 6973 696e 7374 616e 6365  x  if isinstance
+0001f6e0: 2878 2c20 7374 7229 2065 6c73 6520 782e  (x, str) else x.
+0001f6f0: 6e61 6d65 200d 0a20 2020 2020 2020 200d  name ..        .
+0001f700: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+0001f710: 6365 2879 2c20 7374 7229 206f 7220 6861  ce(y, str) or ha
+0001f720: 7361 7474 7220 2820 792c 2027 6e61 6d65  sattr ( y, 'name
+0001f730: 2729 3a20 0d0a 2020 2020 2020 2020 796c  '): ..        yl
+0001f740: 6162 656c 203d 2079 2020 6966 2069 7369  abel = y  if isi
+0001f750: 6e73 7461 6e63 6528 792c 2073 7472 2920  nstance(y, str) 
+0001f760: 656c 7365 2079 2e6e 616d 6520 0d0a 2020  else y.name ..  
+0001f770: 2020 2020 2020 0d0a 2020 2020 6966 2078        ..    if x
+0001f780: 2069 7320 4e6f 6e65 2061 6e64 2020 7920   is None and  y 
+0001f790: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
+0001f7a0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+0001f7b0: 7228 2278 2061 6e64 2079 2061 7265 206e  r("x and y are n
+0001f7c0: 6565 6465 6420 666f 7220 7465 7874 2070  eeded for text p
+0001f7d0: 6c6f 742e 204e 6f6e 6554 7970 6522 0d0a  lot. NoneType"..
+0001f7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f7f0: 2020 2020 2020 2020 2220 6361 6e6e 6f74          " cannot
+0001f800: 2062 6520 706c 6f74 7465 642e 2229 2020   be plotted.")  
+0001f810: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
+0001f820: 2020 782c 2079 203d 2061 7373 6572 745f    x, y = assert_
+0001f830: 7879 5f69 6e28 782c 2079 2c20 6461 7461  xy_in(x, y, data
+0001f840: 203d 2064 6174 6120 2920 0d0a 0d0a 2020   = data ) ....  
+0001f850: 2020 6966 2074 6578 7420 6973 204e 6f6e    if text is Non
+0001f860: 6520 616e 6420 6e6f 7420 636f 6572 6365  e and not coerce
+0001f870: 3a20 0d0a 2020 2020 2020 2072 6169 7365  : ..       raise
+0001f880: 2054 7970 6545 7272 6f72 2028 2254 6578   TypeError ("Tex
+0001f890: 7420 6361 6e6e 6f74 2062 6520 706c 6f74  t cannot be plot
+0001f8a0: 7465 642e 2054 6f20 666f 7263 6520 706c  ted. To force pl
+0001f8b0: 6f74 7469 6e67 2074 6578 7420 7769 7468  otting text with
+0001f8c0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+0001f8d0: 2020 2020 2020 2020 2020 2022 2074 6865             " the
+0001f8e0: 2062 6173 656e 616d 652c 2073 6574 2060   basename, set `
+0001f8f0: 6063 6f65 7263 653d 5472 7565 6060 2e22  `coerce=True``."
+0001f900: 290d 0a0d 0a20 2020 2074 6578 7420 3d20  )....    text = 
+0001f910: 6973 5f69 7465 7261 626c 6528 7465 7874  is_iterable(text
+0001f920: 202c 2065 7863 6c75 6465 5f73 7472 696e   , exclude_strin
+0001f930: 673d 2054 7275 6520 2c20 7472 616e 7366  g= True , transf
+0001f940: 6f72 6d20 3d54 7275 6520 290d 0a20 2020  orm =True )..   
+0001f950: 200d 0a20 2020 2069 6620 2820 6c65 6e28   ..    if ( len(
+0001f960: 7465 7874 2920 213d 206c 656e 2879 2920  text) != len(y) 
+0001f970: 0d0a 2020 2020 2020 2020 616e 6420 6e6f  ..        and no
+0001f980: 7420 636f 6572 6365 2920 3a20 0d0a 2020  t coerce) : ..  
+0001f990: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0001f9a0: 6545 7272 6f72 2822 496e 2070 7269 6e63  eError("In princ
+0001f9b0: 6970 6c65 2074 6578 7420 6172 7261 7920  iple text array 
+0001f9c0: 616e 6420 782f 7920 6d75 7374 2062 6520  and x/y must be 
+0001f9d0: 636f 6e73 6973 7465 6e74 2e22 0d0a 2020  consistent."..  
+0001f9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f9f0: 2020 2020 2020 2066 2220 476f 7420 7b6c         f" Got {l
+0001fa00: 656e 2874 6578 7429 7d20 616e 6420 7b6c  en(text)} and {l
+0001fa10: 656e 2879 297d 2e20 546f 2070 6c6f 7420  en(y)}. To plot 
+0001fa20: 616e 7977 6179 2c22 0d0a 2020 2020 2020  anyway,"..      
+0001fa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fa40: 2020 2022 2073 6574 2060 6063 6f65 7263     " set ``coerc
+0001fa50: 653d 5472 7565 6060 2e22 290d 0a20 2020  e=True``.")..   
+0001fa60: 2069 6620 636f 6572 6365 203a 200d 0a20   if coerce : .. 
+0001fa70: 2020 2020 2020 2062 6173 656e 616d 6520         basename 
+0001fa80: 3d73 7472 2862 6173 656e 616d 6529 0d0a  =str(basename)..
+0001fa90: 2020 2020 2020 2020 7465 7874 202b 3d20          text += 
+0001faa0: 5b66 277b 6261 7365 6e61 6d65 7d7b 692b  [f'{basename}{i+
+0001fab0: 6c65 6e28 7465 7874 293a 3032 7d27 2066  len(text):02}' f
+0001fac0: 6f72 2069 2069 6e20 7261 6e67 6520 286c  or i in range (l
+0001fad0: 656e 2879 2920 295d 0d0a 0d0a 2020 2020  en(y) )]....    
+0001fae0: 6966 2073 7465 7020 6973 206e 6f74 204e  if step is not N
+0001faf0: 6f6e 653a 200d 0a20 2020 2020 2020 2073  one: ..        s
+0001fb00: 7465 7020 3d20 5f61 7373 6572 745f 616c  tep = _assert_al
+0001fb10: 6c5f 7479 7065 7328 7374 6570 202c 2066  l_types(step , f
+0001fb20: 6c6f 6174 2c20 696e 7420 2c20 6f62 6a6e  loat, int , objn
+0001fb30: 616d 6520 3d27 5374 6570 2729 200d 0a20  ame ='Step') .. 
+0001fb40: 2020 2020 2020 2066 6f72 2069 6920 696e         for ii in
+0001fb50: 2072 616e 6765 286c 656e 2874 6578 7429   range(len(text)
+0001fb60: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
+0001fb70: 2069 6620 6e6f 7420 6969 2520 7374 6570   if not ii% step
+0001fb80: 203d 3d30 3a20 0d0a 2020 2020 2020 2020   ==0: ..        
+0001fb90: 2020 2020 2020 2020 7465 7874 5b69 695d          text[ii]
+0001fba0: 3d27 270d 0a0d 0a20 2020 2069 6620 6178  =''....    if ax
+0001fbb0: 2069 7320 4e6f 6e65 3a20 0d0a 2020 2020   is None: ..    
+0001fbc0: 2020 2020 0d0a 2020 2020 2020 2020 6669      ..        fi
+0001fbd0: 672c 2061 7820 3d20 706c 742e 7375 6270  g, ax = plt.subp
+0001fbe0: 6c6f 7473 2831 2c31 2c20 6669 6773 697a  lots(1,1, figsiz
+0001fbf0: 6520 3d66 6967 5f73 697a 6529 0d0a 2020  e =fig_size)..  
+0001fc00: 2020 0d0a 2020 2020 2320 706c 6f74 203d    ..    # plot =
+0001fc10: 2061 782e 7363 6174 7465 7220 6966 2073   ax.scatter if s
+0001fc20: 686f 775f 6c69 6e65 2065 6c73 6520 6178  how_line else ax
+0001fc30: 2e70 6c6f 7420 0d0a 2020 2020 6178 5f6d  .plot ..    ax_m
+0001fc40: 203d 204e 6f6e 6520 0d0a 2020 2020 6966   = None ..    if
+0001fc50: 2073 686f 775f 6c69 6e65 3a20 0d0a 2020   show_line: ..  
+0001fc60: 2020 2020 2020 6178 2e70 6c6f 7420 2878        ax.plot (x
+0001fc70: 2c20 7920 2c20 6c61 6265 6c20 3d20 6c69  , y , label = li
+0001fc80: 6e65 6c61 6265 6c2c 2063 6f6c 6f72 203d  nelabel, color =
+0001fc90: 6c63 6f6c 6f72 200d 0a20 2020 2020 2020  lcolor ..       
+0001fca0: 2020 2020 2020 2020 2020 2920 0d0a 2020            ) ..  
+0001fcb0: 2020 2020 2020 0d0a 2020 2020 666f 7220        ..    for 
+0001fcc0: 6978 2c20 6979 202c 206e 616d 6520 696e  ix, iy , name in
+0001fcd0: 207a 6970 2028 782c 2079 2c20 7465 7874   zip (x, y, text
+0001fce0: 2029 3a20 0d0a 2020 2020 2020 2020 6178   ): ..        ax
+0001fcf0: 2e74 6578 7420 2820 6978 202c 2069 7920  .text ( ix , iy 
+0001fd00: 2c20 6e61 6d65 202c 2063 6f6c 6f72 203d  , name , color =
+0001fd10: 2063 6f6c 6f72 2c20 202a 2a74 6578 745f   color,  **text_
+0001fd20: 6b77 7329 0d0a 2020 2020 2020 2020 6966  kws)..        if
+0001fd30: 206e 616d 6520 213d 2727 3a0d 0a20 2020   name !='':..   
+0001fd40: 2020 2020 2020 2020 6178 5f6d 2020 3d20          ax_m  = 
+0001fd50: 6178 2e73 6361 7474 6572 2028 205b 6978  ax.scatter ( [ix
+0001fd60: 5d2c 205b 6979 5d20 2c20 6d61 726b 6572  ], [iy] , marker
+0001fd70: 203d 276f 272c 2063 6f6c 6f72 203d 6d63   ='o', color =mc
+0001fd80: 6f6c 6f72 2c20 0d0a 2020 2020 2020 2020  olor, ..        
+0001fd90: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001fda0: 0d0a 2020 0d0a 2020 2020 6178 2e73 6574  ..  ..    ax.set
+0001fdb0: 5f78 6c61 6265 6c20 2878 6c61 6265 6c29  _xlabel (xlabel)
+0001fdc0: 0d0a 2020 2020 6178 2e73 6574 5f79 6c61  ..    ax.set_yla
+0001fdd0: 6265 6c20 2879 6c61 6265 6c29 200d 0a20  bel (ylabel) .. 
+0001fde0: 2020 200d 0a20 2020 2061 785f 6d2e 7365     ..    ax_m.se
+0001fdf0: 745f 6c61 6265 6c20 2820 6d61 726b 6572  t_label ( marker
+0001fe00: 6c61 6265 6c29 2069 6620 6178 5f6d 2069  label) if ax_m i
+0001fe10: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
+0001fe20: 4e6f 6e65 200d 0a20 2020 200d 0a20 2020  None ..    ..   
+0001fe30: 2069 6620 7368 6f77 5f6c 6567 203a 200d   if show_leg : .
+0001fe40: 0a20 2020 2020 2020 2061 782e 6c65 6765  .        ax.lege
+0001fe50: 6e64 2028 2920 0d0a 2020 2020 2020 2020  nd () ..        
+0001fe60: 0d0a 2020 2020 7265 7475 726e 2061 7820  ..    return ax 
+0001fe70: 0d0a 0d0a 2020 2020 0d0a 6465 6620 706c  ....    ..def pl
+0001fe80: 6f74 5f76 6f72 6f6e 6f69 280d 0a20 2020  ot_voronoi(..   
+0001fe90: 2058 2c20 792c 202a 2c20 0d0a 2020 2020   X, y, *, ..    
+0001fea0: 636c 7573 7465 725f 6365 6e74 6572 732c  cluster_centers,
+0001feb0: 0d0a 2020 2020 6178 3d20 4e6f 6e65 2c0d  ..    ax= None,.
+0001fec0: 0a20 2020 2073 686f 775f 7665 7274 6963  .    show_vertic
+0001fed0: 6573 3d46 616c 7365 2c20 0d0a 2020 2020  es=False, ..    
+0001fee0: 6c69 6e65 5f63 6f6c 6f72 733d 276b 272c  line_colors='k',
+0001fef0: 0d0a 2020 2020 6c69 6e65 5f77 6964 7468  ..    line_width
+0001ff00: 3d31 2e20 2c0d 0a20 2020 206c 696e 655f  =1. ,..    line_
+0001ff10: 616c 7068 613d 312e 2c20 2020 0d0a 2020  alpha=1.,   ..  
+0001ff20: 2020 6669 675f 7369 7a65 203d 2028 372c    fig_size = (7,
+0001ff30: 2037 292c 200d 0a20 2020 2066 6967 5f74   7), ..    fig_t
+0001ff40: 6974 6c65 203d 2027 270d 0a20 2020 2029  itle = ''..    )
+0001ff50: 3a0d 0a20 2020 2022 2222 506c 6f74 7320  :..    """Plots 
+0001ff60: 7468 6520 566f 726f 6e6f 6920 6469 6167  the Voronoi diag
+0001ff70: 7261 6d20 6f66 2074 6865 206b 2d6d 6561  ram of the k-mea
+0001ff80: 6e73 2063 6c75 7374 6572 7320 6f76 6572  ns clusters over
+0001ff90: 6c61 6964 2077 6974 6820 0d0a 2020 2020  laid with ..    
+0001ffa0: 7468 6520 6461 7461 0d0a 2020 2020 0d0a  the data..    ..
+0001ffb0: 2020 2020 5061 7261 6d65 7465 7273 200d      Parameters .
+0001ffc0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
+0001ffd0: 0d0a 2020 2020 582c 2079 203a 204e 4461  ..    X, y : NDa
+0001ffe0: 7272 6179 2c20 4172 7261 796c 696b 6520  rray, Arraylike 
+0001fff0: 3164 200d 0a20 2020 2020 2044 6174 6120  1d ..      Data 
+00020000: 7472 6169 6e69 6e67 2058 2061 6e64 2079  training X and y
+00020010: 2e20 4d75 7374 2068 6176 6520 7468 6520  . Must have the 
+00020020: 7361 6d65 206c 656e 6774 6820 0d0a 2020  same length ..  
+00020030: 2020 636c 7573 7465 725f 6365 6e74 6572    cluster_center
+00020040: 3a20 696e 742c 200d 0a20 2020 2020 2020  : int, ..       
+00020050: 436c 7573 7465 7220 6365 6e74 6572 2e20  Cluster center. 
+00020060: 436c 7573 7465 7220 6365 6e74 6572 2063  Cluster center c
+00020070: 616e 2062 6520 6f62 7461 696e 2077 6974  an be obtain wit
+00020080: 6865 204b 4d65 616e 7320 616c 676f 7269  he KMeans algori
+00020090: 7468 6d73 200d 0a20 2020 2073 686f 775f  thms ..    show_
+000200a0: 7665 7274 6963 6573 203a 2062 6f6f 6c2c  vertices : bool,
+000200b0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+000200c0: 2020 2041 6464 2074 6865 2056 6f72 6f6e     Add the Voron
+000200d0: 6f69 2076 6572 7469 6365 7320 746f 2074  oi vertices to t
+000200e0: 6865 2070 6c6f 742e 0d0a 2020 2020 6c69  he plot...    li
+000200f0: 6e65 5f63 6f6c 6f72 7320 3a20 7374 7269  ne_colors : stri
+00020100: 6e67 2c20 6f70 7469 6f6e 616c 0d0a 2020  ng, optional..  
+00020110: 2020 2020 2020 5370 6563 6966 6965 7320        Specifies 
+00020120: 7468 6520 6c69 6e65 2063 6f6c 6f72 2066  the line color f
+00020130: 6f72 2070 6f6c 7967 6f6e 2062 6f75 6e64  or polygon bound
+00020140: 6172 6965 730d 0a20 2020 206c 696e 655f  aries..    line_
+00020150: 7769 6474 6820 3a20 666c 6f61 742c 206f  width : float, o
+00020160: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
+00020170: 2053 7065 6369 6669 6573 2074 6865 206c   Specifies the l
+00020180: 696e 6520 7769 6474 6820 666f 7220 706f  ine width for po
+00020190: 6c79 676f 6e20 626f 756e 6461 7269 6573  lygon boundaries
+000201a0: 0d0a 2020 2020 6c69 6e65 5f61 6c70 6861  ..    line_alpha
+000201b0: 203a 2066 6c6f 6174 2c20 6f70 7469 6f6e   : float, option
+000201c0: 616c 0d0a 2020 2020 2020 2020 5370 6563  al..        Spec
+000201d0: 6966 6965 7320 7468 6520 6c69 6e65 2061  ifies the line a
+000201e0: 6c70 6861 2066 6f72 2070 6f6c 7967 6f6e  lpha for polygon
+000201f0: 2062 6f75 6e64 6172 6965 730d 0a20 2020   boundaries..   
+00020200: 2070 6f69 6e74 5f73 697a 6520 3a20 666c   point_size : fl
+00020210: 6f61 742c 206f 7074 696f 6e61 6c0d 0a20  oat, optional.. 
+00020220: 2020 2020 2020 2053 7065 6369 6669 6573         Specifies
+00020230: 2074 6865 2073 697a 6520 6f66 2070 6f69   the size of poi
+00020240: 6e74 730d 0a20 2020 2061 783a 204d 6174  nts..    ax: Mat
+00020250: 706c 6f74 6c69 622e 4178 6573 200d 0a20  plotlib.Axes .. 
+00020260: 2020 2020 2020 4d61 706c 6f74 6c69 6220        Maplotlib 
+00020270: 6178 6573 2e20 4966 2060 4e6f 6e65 602c  axes. If `None`,
+00020280: 2061 2061 7869 7320 6973 2063 7265 6174   a axis is creat
+00020290: 6564 2069 6e73 7465 6164 2e20 0d0a 2020  ed instead. ..  
+000202a0: 2020 2020 200d 0a20 2020 2066 6967 5f73       ..    fig_s
+000202b0: 697a 653a 2074 7570 6c65 2c20 6465 6661  ize: tuple, defa
+000202c0: 756c 7420 3d20 2837 2c20 3729 200d 0a20  ult = (7, 7) .. 
+000202d0: 2020 2020 2020 5369 7a65 206f 6620 7468        Size of th
+000202e0: 6520 6669 6775 7265 732e 200d 0a20 2020  e figures. ..   
+000202f0: 2020 2020 0d0a 2020 2020 5265 7475 726e      ..    Return
+00020300: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20  ..    -------.. 
+00020310: 2020 2061 783a 204d 6174 706c 6f74 6c69     ax: Matplotli
+00020320: 622e 4178 6573 200d 0a20 2020 2020 2020  b.Axes ..       
+00020330: 4178 6573 2074 6f20 7375 7070 6f72 7420  Axes to support 
+00020340: 7468 6520 6669 6775 7265 0d0a 2020 2020  the figure..    
+00020350: 2020 200d 0a20 2020 2045 7861 6d70 6c65     ..    Example
+00020360: 7320 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  s ..    --------
+00020370: 2d0d 0a20 2020 203e 3e3e 2066 726f 6d20  -..    >>> from 
+00020380: 736b 6c65 6172 6e2e 6461 7461 7365 7473  sklearn.datasets
+00020390: 2069 6d70 6f72 7420 6d61 6b65 5f6d 6f6f   import make_moo
+000203a0: 6e73 0d0a 2020 2020 3e3e 3e20 6672 6f6d  ns..    >>> from
+000203b0: 2073 6b6c 6561 726e 2e63 6c75 7374 6572   sklearn.cluster
+000203c0: 2069 6d70 6f72 7420 4b4d 6561 6e73 200d   import KMeans .
+000203d0: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
+000203e0: 7465 782e 7574 696c 732e 706c 6f74 7574  tex.utils.plotut
+000203f0: 696c 7320 696d 706f 7274 2070 6c6f 745f  ils import plot_
+00020400: 766f 726f 6e6f 690d 0a20 2020 203e 3e3e  voronoi..    >>>
+00020410: 2058 2c20 7920 3d20 6d61 6b65 5f6d 6f6f   X, y = make_moo
+00020420: 6e73 286e 5f73 616d 706c 6573 3d32 3030  ns(n_samples=200
+00020430: 302c 206e 6f69 7365 3d30 2e32 290d 0a20  0, noise=0.2).. 
+00020440: 2020 203e 3e3e 206b 6d20 3d20 4b4d 6561     >>> km = KMea
+00020450: 6e73 2028 6e5f 696e 6974 203d 2761 7574  ns (n_init ='aut
+00020460: 6f27 292e 6669 7428 582c 2079 2029 200d  o').fit(X, y ) .
+00020470: 0a20 2020 203e 3e3e 2070 6c6f 745f 766f  .    >>> plot_vo
+00020480: 726f 6e6f 6920 2820 582c 2079 202c 2063  ronoi ( X, y , c
+00020490: 6c75 7374 6572 5f63 656e 7465 7273 203d  luster_centers =
+000204a0: 206b 6d2e 636c 7573 7465 725f 6365 6e74   km.cluster_cent
+000204b0: 6572 735f 2920 0d0a 2020 2020 2222 220d  ers_) ..    """.
+000204c0: 0a20 2020 2058 2c20 7920 3d20 6368 6563  .    X, y = chec
+000204d0: 6b5f 585f 7928 582c 2079 2c20 290d 0a20  k_X_y(X, y, ).. 
+000204e0: 2020 2063 6c75 7374 6572 5f63 656e 7465     cluster_cente
+000204f0: 7273 203d 2063 6865 636b 5f61 7272 6179  rs = check_array
+00020500: 2863 6c75 7374 6572 5f63 656e 7465 7273  (cluster_centers
+00020510: 2029 0d0a 2020 2020 0d0a 2020 2020 6966   )..    ..    if
+00020520: 2061 7820 6973 204e 6f6e 653a 200d 0a20   ax is None: .. 
+00020530: 2020 2020 2020 2066 6967 2c20 6178 203d         fig, ax =
+00020540: 2070 6c74 2e73 7562 706c 6f74 7328 312c   plt.subplots(1,
+00020550: 312c 2066 6967 7369 7a65 203d 6669 675f  1, figsize =fig_
+00020560: 7369 7a65 290d 0a20 2020 2020 2020 200d  size)..        .
+00020570: 0a20 2020 2066 726f 6d20 7363 6970 792e  .    from scipy.
+00020580: 7370 6174 6961 6c20 696d 706f 7274 2056  spatial import V
+00020590: 6f72 6f6e 6f69 2c20 766f 726f 6e6f 695f  oronoi, voronoi_
+000205a0: 706c 6f74 5f32 640d 0a20 2020 200d 0a20  plot_2d..    .. 
+000205b0: 2020 2061 782e 7363 6174 7465 7228 585b     ax.scatter(X[
+000205c0: 3a2c 2030 5d2c 2058 5b3a 2c20 315d 2c20  :, 0], X[:, 1], 
+000205d0: 633d 792c 2063 6d61 703d 2753 6574 3127  c=y, cmap='Set1'
+000205e0: 2c20 616c 7068 613d 302e 322c 200d 0a20  , alpha=0.2, .. 
+000205f0: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+00020600: 6265 6c20 3d20 2756 6f72 6f6e 6f69 2070  bel = 'Voronoi p
+00020610: 6c6f 7427 290d 0a20 2020 2076 6f72 203d  lot')..    vor =
+00020620: 2056 6f72 6f6e 6f69 2863 6c75 7374 6572   Voronoi(cluster
+00020630: 5f63 656e 7465 7273 290d 0a20 2020 2076  _centers)..    v
+00020640: 6f72 6f6e 6f69 5f70 6c6f 745f 3264 2876  oronoi_plot_2d(v
+00020650: 6f72 2c20 6178 3d61 782c 2073 686f 775f  or, ax=ax, show_
+00020660: 7665 7274 6963 6573 3d73 686f 775f 7665  vertices=show_ve
+00020670: 7274 6963 6573 2c20 0d0a 2020 2020 2020  rtices, ..      
+00020680: 2020 2020 2020 2020 2020 2020 2020 616c                al
+00020690: 7068 613d 302e 352c 200d 0a20 2020 2020  pha=0.5, ..     
+000206a0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+000206b0: 696e 655f 636f 6c6f 7273 3d6c 696e 655f  ine_colors=line_
+000206c0: 636f 6c6f 7273 2c0d 0a20 2020 2020 2020  colors,..       
+000206d0: 2020 2020 2020 2020 2020 2020 206c 696e               lin
+000206e0: 655f 7769 6474 683d 6c69 6e65 5f77 6964  e_width=line_wid
+000206f0: 7468 202c 0d0a 2020 2020 2020 2020 2020  th ,..          
+00020700: 2020 2020 2020 2020 2020 6c69 6e65 5f61            line_a
+00020710: 6c70 6861 3d6c 696e 655f 616c 7068 612c  lpha=line_alpha,
+00020720: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+00020730: 2020 2020 2020 2020 290d 0a20 2020 2023          )..    #
+00020740: 6178 2e6c 6567 656e 6428 2920 0d0a 2020  ax.legend() ..  
+00020750: 2020 6178 2e73 6574 5f74 6974 6c65 2028    ax.set_title (
+00020760: 6669 675f 7469 746c 6520 2c20 666f 6e74  fig_title , font
+00020770: 7369 7a65 3d32 3029 0d0a 2020 2020 2366  size=20)..    #f
+00020780: 6967 2e73 7570 7469 746c 6528 6669 675f  ig.suptitle(fig_
+00020790: 7469 746c 652c 2066 6f6e 7473 697a 653d  title, fontsize=
+000207a0: 3230 2920 0d0a 2020 2020 7265 7475 726e  20) ..    return
+000207b0: 2061 7820 0d0a 200d 0a20 2020 200d 0a64   ax .. ..    ..d
+000207c0: 6566 205f 6d61 6b65 5f61 7865 5f6d 756c  ef _make_axe_mul
+000207d0: 7469 706c 6520 2820 6e2c 206e 636f 6c73  tiple ( n, ncols
+000207e0: 203d 2033 202c 2066 6967 5f73 697a 6520   = 3 , fig_size 
+000207f0: 3d4e 6f6e 652c 2066 6967 203d 4e6f 6e65  =None, fig =None
+00020800: 2c20 6178 3d20 2e2e 2e20 293a 200d 0a20  , ax= ... ): .. 
+00020810: 2020 2022 2222 204d 616b 6520 6d75 6c74     """ Make mult
+00020820: 6970 6c65 2073 7562 706c 6f74 2061 7865  iple subplot axe
+00020830: 7320 6672 6f6d 206e 756d 6265 7220 6f66  s from number of
+00020840: 206f 626a 6563 7473 2e20 2222 220d 0a20   objects. """.. 
+00020850: 2020 2069 6620 6973 5f69 7465 7261 626c     if is_iterabl
+00020860: 6520 286e 293a 200d 0a20 2020 2020 2020  e (n): ..       
+00020870: 6e20 3d20 6c65 6e28 6e29 200d 0a20 2020  n = len(n) ..   
+00020880: 2020 0d0a 2020 2020 6e72 6f77 7320 3d20    ..    nrows = 
+00020890: 6e20 2f2f 206e 636f 6c73 202b 2028 206e  n // ncols + ( n
+000208a0: 2025 206e 636f 6c73 2029 200d 0a20 2020   % ncols ) ..   
+000208b0: 2069 6620 6e72 6f77 7320 3d3d 303a 200d   if nrows ==0: .
+000208c0: 0a20 2020 2020 2020 6e72 6f77 7320 3d31  .       nrows =1
+000208d0: 200d 0a20 2020 2020 2020 0d0a 2020 2020   ..       ..    
+000208e0: 6966 2061 7820 696e 2028 202e 2e2e 202c  if ax in ( ... ,
+000208f0: 204e 6f6e 6529 203a 200d 0a20 2020 2020   None) : ..     
+00020900: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
+00020910: 2e73 7562 706c 6f74 7320 286e 726f 7773  .subplots (nrows
+00020920: 2c20 6e63 6f6c 732c 2066 6967 7369 7a65  , ncols, figsize
+00020930: 203d 2066 6967 5f73 697a 6520 2920 200d   = fig_size )  .
+00020940: 0a20 2020 200d 0a20 2020 2072 6574 7572  .    ..    retur
+00020950: 6e20 6669 6720 2c20 6178 200d 0a20 2020  n fig , ax ..   
+00020960: 200d 0a64 6566 2070 6c6f 745f 726f 635f   ..def plot_roc_
+00020970: 6375 7276 6573 2028 0d0a 2020 2063 6c66  curves (..   clf
+00020980: 732c 202f 2c20 0d0a 2020 2058 2c20 792c  s, /, ..   X, y,
+00020990: 200d 0a20 2020 6e61 6d65 7320 3d2e 2e2e   ..   names =...
+000209a0: 2c20 0d0a 2020 2063 6f6c 6f72 7320 3d2e  , ..   colors =.
+000209b0: 2e2e 2c20 0d0a 2020 206e 636f 6c73 203d  .., ..   ncols =
+000209c0: 2033 2c20 0d0a 2020 2073 636f 7265 3d46   3, ..   score=F
+000209d0: 616c 7365 2c20 0d0a 2020 206b 696e 643d  alse, ..   kind=
+000209e0: 2269 6e6f 6e65 222c 0d0a 2020 2061 7820  "inone",..   ax 
+000209f0: 3d20 4e6f 6e65 2c20 200d 0a20 2020 6669  = None,  ..   fi
+00020a00: 675f 7369 7a65 3d28 2037 2c20 3729 2c20  g_size=( 7, 7), 
+00020a10: 0d0a 2020 202a 2a72 6f63 5f6b 7773 2029  ..   **roc_kws )
+00020a20: 3a20 0d0a 2020 2020 2222 2220 5175 6963  : ..    """ Quic
+00020a30: 6b20 706c 6f74 206f 6620 5265 6365 6976  k plot of Receiv
+00020a40: 696e 6720 4f70 6572 6174 696e 6720 4368  ing Operating Ch
+00020a50: 6172 6163 7465 7269 7363 7469 6320 2852  aracterisctic (R
+00020a60: 4f43 2920 6f66 2066 6974 7465 6420 6d6f  OC) of fitted mo
+00020a70: 6465 6c73 200d 0a20 2020 200d 0a20 2020  dels ..    ..   
+00020a80: 2050 6172 616d 6574 6572 7320 0d0a 2020   Parameters ..  
+00020a90: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a    ------------..
+00020aa0: 2020 2020 636c 6673 3a20 6c69 7374 2c20      clfs: list, 
+00020ab0: 0d0a 2020 2020 2020 206c 6973 7420 6f66  ..       list of
+00020ac0: 206d 6f64 656c 7320 666f 7220 524f 4320   models for ROC 
+00020ad0: 6576 616c 7561 7469 6f6e 2e20 4d6f 6465  evaluation. Mode
+00020ae0: 6c20 7368 6f75 6c64 2062 6520 6120 7363  l should be a sc
+00020af0: 696b 6974 2d6c 6561 726e 200d 0a20 2020  ikit-learn ..   
+00020b00: 2020 2020 6f72 2020 5847 426f 6f73 7420      or  XGBoost 
+00020b10: 6573 7469 6d61 746f 7273 200d 0a20 2020  estimators ..   
+00020b20: 2020 2020 0d0a 2020 2020 5820 3a20 7b61      ..    X : {a
+00020b30: 7272 6179 2d6c 696b 652c 2073 7061 7273  rray-like, spars
+00020b40: 6520 6d61 7472 6978 7d20 6f66 2073 6861  e matrix} of sha
+00020b50: 7065 2028 6e5f 7361 6d70 6c65 732c 206e  pe (n_samples, n
+00020b60: 5f66 6561 7475 7265 7329 0d0a 2020 2020  _features)..    
+00020b70: 2020 2020 5472 6169 6e69 6e67 2069 6e73      Training ins
+00020b80: 7461 6e63 6573 2074 6f20 636c 7573 7465  tances to cluste
+00020b90: 722e 2049 7420 6d75 7374 2062 6520 6e6f  r. It must be no
+00020ba0: 7465 6420 7468 6174 2074 6865 2064 6174  ted that the dat
+00020bb0: 610d 0a20 2020 2020 2020 2077 696c 6c20  a..        will 
+00020bc0: 6265 2063 6f6e 7665 7274 6564 2074 6f20  be converted to 
+00020bd0: 4320 6f72 6465 7269 6e67 2c20 7768 6963  C ordering, whic
+00020be0: 6820 7769 6c6c 2063 6175 7365 2061 206d  h will cause a m
+00020bf0: 656d 6f72 790d 0a20 2020 2020 2020 2063  emory..        c
+00020c00: 6f70 7920 6966 2074 6865 2067 6976 656e  opy if the given
+00020c10: 2064 6174 6120 6973 206e 6f74 2043 2d63   data is not C-c
+00020c20: 6f6e 7469 6775 6f75 732e 0d0a 2020 2020  ontiguous...    
+00020c30: 2020 2020 4966 2061 2073 7061 7273 6520      If a sparse 
+00020c40: 6d61 7472 6978 2069 7320 7061 7373 6564  matrix is passed
+00020c50: 2c20 6120 636f 7079 2077 696c 6c20 6265  , a copy will be
+00020c60: 206d 6164 6520 6966 2069 7427 7320 6e6f   made if it's no
+00020c70: 7420 696e 0d0a 2020 2020 2020 2020 4353  t in..        CS
+00020c80: 5220 666f 726d 6174 2e0d 0a20 2020 200d  R format...    .
+00020c90: 0a20 2020 2079 203a 206e 6461 7272 6179  .    y : ndarray
+00020ca0: 206f 7220 5365 7269 6573 206f 6620 6c65   or Series of le
+00020cb0: 6e67 7468 2028 6e5f 7361 6d70 6c65 732c  ngth (n_samples,
+00020cc0: 2029 0d0a 2020 2020 2020 2020 416e 2061   )..        An a
+00020cd0: 7272 6179 206f 7220 7365 7269 6573 206f  rray or series o
+00020ce0: 6620 7461 7267 6574 206f 7220 636c 6173  f target or clas
+00020cf0: 7320 7661 6c75 6573 2e20 5072 6566 6572  s values. Prefer
+00020d00: 6162 6c79 2c20 7468 6520 6172 7261 7920  ably, the array 
+00020d10: 0d0a 2020 2020 2020 2020 7265 7072 6573  ..        repres
+00020d20: 656e 7420 7468 6520 7465 7374 2063 6c61  ent the test cla
+00020d30: 7373 206c 6162 656c 7320 6461 7461 2066  ss labels data f
+00020d40: 6f72 2065 7272 6f72 2065 7661 6c75 6174  or error evaluat
+00020d50: 696f 6e2e 2020 0d0a 2020 2020 2020 2020  ion.  ..        
+00020d60: 0d0a 2020 2020 6e61 6d65 733a 206c 6973  ..    names: lis
+00020d70: 742c 200d 0a20 2020 2020 2020 4c69 7374  t, ..       List
+00020d80: 206f 6620 6d6f 6465 6c20 6e61 6d65 732e   of model names.
+00020d90: 2049 6620 6e6f 7420 6769 7665 6e2c 2061   If not given, a
+00020da0: 2072 6177 206e 616d 6520 6f66 2074 6865   raw name of the
+00020db0: 206d 6f64 656c 2069 7320 7061 7373 6564   model is passed
+00020dc0: 200d 0a20 2020 2020 2020 696e 7374 6561   ..       instea
+00020dd0: 642e 0d0a 2020 2020 200d 0a20 2020 206b  d...     ..    k
+00020de0: 696e 643a 2073 7472 2c20 6465 6661 756c  ind: str, defaul
+00020df0: 743d 2769 6e6f 6e65 2720 0d0a 2020 2020  t='inone' ..    
+00020e00: 2020 2049 6620 6060 5b27 696e 6469 7669     If ``['indivi
+00020e10: 6475 616c 277c 2732 277c 2773 696e 676c  dual'|'2'|'singl
+00020e20: 6527 5d60 602c 2070 6c6f 7420 6561 6368  e']``, plot each
+00020e30: 2052 4f43 206d 6f64 656c 2073 6570 6172   ROC model separ
+00020e40: 6174 656c 792e 200d 0a20 2020 2020 2020  ately. ..       
+00020e50: 416e 7920 6f74 6865 7220 7661 6c75 652c  Any other value,
+00020e60: 2067 726f 7570 206f 6620 524f 4320 6375   group of ROC cu
+00020e70: 7276 6573 2069 6e74 6f20 6120 7369 6e67  rves into a sing
+00020e80: 6c65 2070 6c6f 742e 200d 0a20 2020 2020  le plot. ..     
+00020e90: 2020 0d0a 2020 2020 2020 202e 2e20 7665    ..       .. ve
+00020ea0: 7273 696f 6e63 6861 6e67 6564 3a3a 2030  rsionchanged:: 0
+00020eb0: 2e32 2e35 200d 0a20 2020 2020 2020 2020  .2.5 ..         
+00020ec0: 2050 6172 616d 6574 6572 2060 616c 6c60   Parameter `all`
+00020ed0: 2069 7320 6465 7072 6563 6174 6564 2061   is deprecated a
+00020ee0: 6e64 2072 6570 6c61 6365 6420 6279 2060  nd replaced by `
+00020ef0: 6b69 6e64 602e 2049 7420 6865 6e63 6566  kind`. It hencef
+00020f00: 6f72 7468 200d 0a20 2020 2020 2020 2020  orth ..         
+00020f10: 2061 6363 6570 7473 2061 7267 756d 656e   accepts argumen
+00020f20: 7473 2060 6061 6c6c 696e 6f6e 657c 317c  ts ``allinone|1|
+00020f30: 6772 6f75 7065 6460 6020 6f72 2060 6069  grouped`` or ``i
+00020f40: 6e64 6976 6964 7561 6c7c 327c 7369 6e67  ndividual|2|sing
+00020f50: 6c65 6060 0d0a 2020 2020 2020 2020 2020  le``..          
+00020f60: 666f 7220 706c 6f74 7469 6e67 206d 7574  for plotting mut
+00020f70: 6c69 706c 6520 524f 4320 6375 7276 6573  liple ROC curves
+00020f80: 2069 6e20 6f6e 6520 6f72 2073 6570 6172   in one or separ
+00020f90: 6174 6520 6561 6368 2052 4f43 2063 7572  ate each ROC cur
+00020fa0: 7665 7320 0d0a 2020 2020 2020 2020 2020  ves ..          
+00020fb0: 7265 7370 6563 6976 656c 792e 200d 0a20  respecively. .. 
+00020fc0: 2020 2020 2020 2020 200d 0a20 2020 2063           ..    c
+00020fd0: 6f6c 6f72 7320 3a20 7374 722c 206c 6973  olors : str, lis
+00020fe0: 7420 0d0a 2020 2020 2020 2043 6f6c 6f72  t ..       Color
+00020ff0: 7320 746f 2073 7065 6369 6679 2065 6163  s to specify eac
+00021000: 6820 6d6f 6465 6c20 706c 6f74 2e20 0d0a  h model plot. ..
+00021010: 2020 2020 2020 200d 0a20 2020 206e 636f         ..    nco
+00021020: 6c73 3a20 696e 742c 2064 6566 6175 6c74  ls: int, default
+00021030: 3d33 200d 0a20 2020 2020 2020 4e75 6d62  =3 ..       Numb
+00021040: 6572 206f 6620 706c 6f74 2074 6f20 6265  er of plot to be
+00021050: 2070 6c61 6365 6420 696e 6c69 6e65 2062   placed inline b
+00021060: 6566 6f72 6520 736b 6970 7069 6e67 2074  efore skipping t
+00021070: 6f20 7468 6520 6e65 7874 2063 6f6c 756d  o the next colum
+00021080: 6e2e 200d 0a20 2020 2020 2020 5468 6973  n. ..       This
+00021090: 2069 7320 6665 6173 6962 6c65 2069 6620   is feasible if 
+000210a0: 606d 616e 7960 2069 7320 7365 7420 746f  `many` is set to
+000210b0: 2060 6054 7275 6560 602e 200d 0a20 2020   ``True``. ..   
+000210c0: 2020 2020 0d0a 2020 2020 7363 6f72 653a      ..    score:
+000210d0: 2062 6f6f 6c2c 6465 6661 756c 743d 5472   bool,default=Tr
+000210e0: 7565 0d0a 2020 2020 2020 4170 7065 6e64  ue..      Append
+000210f0: 2074 6865 2041 7265 6120 556e 6465 7220   the Area Under 
+00021100: 7468 6520 6375 7276 6520 7363 6f72 6520  the curve score 
+00021110: 746f 2074 6865 206c 6567 656e 642e 200d  to the legend. .
+00021120: 0a20 2020 2020 200d 0a20 2020 2020 202e  .      ..      .
+00021130: 2e20 7665 7273 696f 6e61 6464 6564 3a3a  . versionadded::
+00021140: 2030 2e32 2e34 200d 0a20 2020 2020 200d   0.2.4 ..      .
+00021150: 0a20 2020 2061 6c6c 3a20 7374 722c 2064  .    all: str, d
+00021160: 6566 6175 6c74 3d46 616c 7365 200d 0a20  efault=False .. 
+00021170: 2020 2020 2020 6966 2060 6054 7275 6560        if ``True`
+00021180: 602c 2070 6c6f 7420 6561 6368 2052 4f43  `, plot each ROC
+00021190: 206d 6f64 656c 2073 6570 6172 6174 656c   model separatel
+000211a0: 7920 0d0a 0d0a 2020 2020 6b77 733a 2064  y ....    kws: d
+000211b0: 6963 742c 0d0a 2020 2020 2020 2020 6b65  ict,..        ke
+000211c0: 7977 6f72 6420 6172 6775 6d65 6e74 206f  yword argument o
+000211d0: 6620 3a66 756e 633a 6073 6b6c 6561 726e  f :func:`sklearn
+000211e0: 2e6d 6574 7269 6373 2e72 6f63 5f63 7572  .metrics.roc_cur
+000211f0: 7665 200d 0a20 2020 2020 2020 200d 0a20  ve ..        .. 
+00021200: 2020 2052 6574 7572 6e0d 0a20 2020 202d     Return..    -
+00021210: 2d2d 2d2d 2d2d 0d0a 2020 2020 6178 3a20  ------..    ax: 
+00021220: 4178 6573 2e53 7562 706c 6f74 2e20 0d0a  Axes.Subplot. ..
+00021230: 2020 2020 0d0a 2020 2020 4578 616d 706c      ..    Exampl
+00021240: 6573 200d 0a20 2020 202d 2d2d 2d2d 2d2d  es ..    -------
+00021250: 2d0d 0a20 2020 203e 3e3e 2066 726f 6d20  -..    >>> from 
+00021260: 7761 7465 782e 7574 696c 732e 706c 6f74  watex.utils.plot
+00021270: 7574 696c 7320 696d 706f 7274 2070 6c6f  utils import plo
+00021280: 745f 726f 635f 6375 7276 6573 200d 0a20  t_roc_curves .. 
+00021290: 2020 203e 3e3e 2066 726f 6d20 736b 6c65     >>> from skle
+000212a0: 6172 6e2e 6461 7461 7365 7473 2069 6d70  arn.datasets imp
+000212b0: 6f72 7420 6d61 6b65 5f6d 6f6f 6e73 200d  ort make_moons .
+000212c0: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
+000212d0: 7465 782e 6578 6c69 6220 696d 706f 7274  tex.exlib import
+000212e0: 2028 2074 7261 696e 5f74 6573 745f 7370   ( train_test_sp
+000212f0: 6c69 742c 204b 4e65 6967 6862 6f72 7343  lit, KNeighborsC
+00021300: 6c61 7373 6966 6965 722c 2053 5643 202c  lassifier, SVC ,
+00021310: 0d0a 2020 2020 5847 4243 6c61 7373 6966  ..    XGBClassif
+00021320: 6965 722c 204c 6f67 6973 7469 6352 6567  ier, LogisticReg
+00021330: 7265 7373 696f 6e20 2920 0d0a 2020 2020  ression ) ..    
+00021340: 3e3e 3e20 582c 2079 203d 206d 616b 655f  >>> X, y = make_
+00021350: 6d6f 6f6e 7320 286e 5f73 616d 706c 6573  moons (n_samples
+00021360: 3d32 3030 302c 206e 6f69 7365 3d30 2e32  =2000, noise=0.2
+00021370: 290d 0a20 2020 203e 3e3e 2058 2c20 5874  )..    >>> X, Xt
+00021380: 2c20 792c 2079 7420 3d20 7472 6169 6e5f  , y, yt = train_
+00021390: 7465 7374 5f73 706c 6974 2028 582c 2079  test_split (X, y
+000213a0: 2c20 7465 7374 5f73 697a 653d 302e 3229  , test_size=0.2)
+000213b0: 200d 0a20 2020 203e 3e3e 2063 6c66 7320   ..    >>> clfs 
+000213c0: 3d20 5b20 6d28 292e 6669 7428 582c 2079  = [ m().fit(X, y
+000213d0: 2920 666f 7220 6d20 696e 2028 204b 4e65  ) for m in ( KNe
+000213e0: 6967 6862 6f72 7343 6c61 7373 6966 6965  ighborsClassifie
+000213f0: 722c 2053 5643 202c 200d 0a20 2020 2020  r, SVC , ..     
+00021400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021420: 2020 2020 5847 4243 6c61 7373 6966 6965      XGBClassifie
+00021430: 722c 204c 6f67 6973 7469 6352 6567 7265  r, LogisticRegre
+00021440: 7373 696f 6e29 5d0d 0a20 2020 203e 3e3e  ssion)]..    >>>
+00021450: 2070 6c6f 745f 726f 635f 6375 7276 6573   plot_roc_curves
+00021460: 2863 6c66 732c 2058 742c 2079 7429 0d0a  (clfs, Xt, yt)..
+00021470: 2020 2020 4f75 745b 3636 5d3a 203c 4178      Out[66]: <Ax
+00021480: 6573 5375 6270 6c6f 743a 786c 6162 656c  esSubplot:xlabel
+00021490: 3d27 4661 6c73 6520 506f 7369 7469 7665  ='False Positive
+000214a0: 2052 6174 6520 2846 5052 2927 2c20 796c   Rate (FPR)', yl
+000214b0: 6162 656c 3d27 5472 7565 2050 6f73 6974  abel='True Posit
+000214c0: 6976 6520 5261 7465 2028 4650 5229 273e  ive Rate (FPR)'>
+000214d0: 0d0a 2020 2020 3e3e 3e20 706c 6f74 5f72  ..    >>> plot_r
+000214e0: 6f63 5f63 7572 7665 7328 636c 6673 2c20  oc_curves(clfs, 
+000214f0: 5874 2c20 7974 2c6b 696e 643d 2732 272c  Xt, yt,kind='2',
+00021500: 206e 636f 6c73 203d 2034 202c 2066 6967   ncols = 4 , fig
+00021510: 5f73 697a 6520 3d20 2831 302c 2034 2929  _size = (10, 4))
+00021520: 0d0a 2020 2020 2222 220d 0a20 2020 2066  ..    """..    f
+00021530: 726f 6d20 2e76 616c 6964 6174 6f72 2069  rom .validator i
+00021540: 6d70 6f72 7420 2067 6574 5f65 7374 696d  mport  get_estim
+00021550: 6174 6f72 5f6e 616d 650d 0a20 2020 200d  ator_name..    .
+00021560: 0a20 2020 206b 696e 6420 3d20 2732 2720  .    kind = '2' 
+00021570: 6966 2073 7472 286b 696e 6429 2e6c 6f77  if str(kind).low
+00021580: 6572 2829 2069 6e20 2769 6e64 6976 6964  er() in 'individ
+00021590: 7561 6c32 7369 6e67 6c65 2720 656c 7365  ual2single' else
+000215a0: 2027 3127 0d0a 0d0a 2020 2020 6465 6620   '1'....    def 
+000215b0: 706c 6f74 5f72 6f63 286d 6f64 656c 2c20  plot_roc(model, 
+000215c0: 6461 7461 2c20 6c61 6265 6c73 2c20 7363  data, labels, sc
+000215d0: 6f72 6520 3d46 616c 7365 2029 3a0d 0a20  ore =False ):.. 
+000215e0: 2020 2020 2020 2069 6620 6861 7361 7474         if hasatt
+000215f0: 7228 6d6f 6465 6c2c 2022 6465 6369 7369  r(model, "decisi
+00021600: 6f6e 5f66 756e 6374 696f 6e22 293a 0d0a  on_function"):..
+00021610: 2020 2020 2020 2020 2020 2020 7072 6564              pred
+00021620: 6963 7469 6f6e 7320 3d20 6d6f 6465 6c2e  ictions = model.
+00021630: 6465 6369 7369 6f6e 5f66 756e 6374 696f  decision_functio
+00021640: 6e28 6461 7461 290d 0a20 2020 2020 2020  n(data)..       
+00021650: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00021660: 2020 2020 7072 6564 6963 7469 6f6e 7320      predictions 
+00021670: 3d20 6d6f 6465 6c2e 7072 6564 6963 745f  = model.predict_
+00021680: 7072 6f62 6128 6461 7461 295b 3a2c 315d  proba(data)[:,1]
+00021690: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+000216a0: 2020 2020 2020 2020 6670 722c 2074 7072          fpr, tpr
+000216b0: 2c20 5f20 3d20 726f 635f 6375 7276 6528  , _ = roc_curve(
+000216c0: 6c61 6265 6c73 2c20 7072 6564 6963 7469  labels, predicti
+000216d0: 6f6e 732c 202a 2a72 6f63 5f6b 7773 2029  ons, **roc_kws )
+000216e0: 0d0a 2020 2020 2020 2020 6175 635f 7363  ..        auc_sc
+000216f0: 6f72 6520 3d20 4e6f 6e65 200d 0a20 2020  ore = None ..   
+00021700: 2020 2020 2069 6620 7363 6f72 653a 200d       if score: .
+00021710: 0a20 2020 2020 2020 2020 2020 2061 7563  .            auc
+00021720: 5f73 636f 7265 203d 2072 6f63 5f61 7563  _score = roc_auc
+00021730: 5f73 636f 7265 2028 206c 6162 656c 732c  _score ( labels,
+00021740: 2070 7265 6469 6374 696f 6e73 2c29 0d0a   predictions,)..
+00021750: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00021760: 2020 2020 2020 7265 7475 726e 2066 7072        return fpr
+00021770: 2c20 7470 7220 2c20 6175 635f 7363 6f72  , tpr , auc_scor
+00021780: 650d 0a20 2020 200d 0a20 2020 2069 6620  e..    ..    if 
+00021790: 6e6f 7420 6973 5f69 7465 7261 626c 6520  not is_iterable 
+000217a0: 2820 636c 6673 293a 200d 0a20 2020 2020  ( clfs): ..     
+000217b0: 2020 636c 6673 203d 2069 735f 6974 6572    clfs = is_iter
+000217c0: 6162 6c65 2028 2063 6c66 732c 2065 7863  able ( clfs, exc
+000217d0: 6c75 6465 5f73 7472 696e 6720 3d54 7275  lude_string =Tru
+000217e0: 6520 2c20 7472 616e 7366 6f72 6d20 3d54  e , transform =T
+000217f0: 7275 6520 2920 0d0a 2020 2020 2020 200d  rue ) ..       .
+00021800: 0a20 2020 2023 206d 616b 6520 6465 6661  .    # make defa
+00021810: 756c 745f 636f 6c6f 7273 200d 0a20 2020  ult_colors ..   
+00021820: 2063 6f6c 6f72 7320 3d20 6d61 6b65 5f70   colors = make_p
+00021830: 6c6f 745f 636f 6c6f 7273 2863 6c66 732c  lot_colors(clfs,
+00021840: 2063 6f6c 6f72 7320 3d20 636f 6c6f 7273   colors = colors
+00021850: 2029 0d0a 2020 2020 2320 7361 7665 2074   )..    # save t
+00021860: 6865 206e 616d 6520 6f66 206d 6f64 656c  he name of model
+00021870: 7320 0d0a 2020 2020 6e61 6d65 7320 3d20  s ..    names = 
+00021880: 6d61 6b65 5f6f 626a 5f63 6f6e 7369 7374  make_obj_consist
+00021890: 656e 745f 6966 2028 0d0a 2020 2020 2020  ent_if (..      
+000218a0: 2020 6e61 6d65 7320 2c20 5b20 6765 745f    names , [ get_
+000218b0: 6573 7469 6d61 746f 725f 6e61 6d65 286d  estimator_name(m
+000218c0: 2920 666f 7220 6d20 696e 2063 6c66 7320  ) for m in clfs 
+000218d0: 5d29 200d 0a0d 0a20 2020 2023 2063 6865  ]) ....    # che
+000218e0: 636b 2077 6865 7468 6572 2074 6865 206d  ck whether the m
+000218f0: 6f64 656c 2069 7320 6669 7474 6564 200d  odel is fitted .
+00021900: 0a20 2020 2069 6620 6b69 6e64 3d3d 2732  .    if kind=='2
+00021910: 273a 200d 0a20 2020 2020 2020 2066 6967  ': ..        fig
+00021920: 2c20 6178 203d 205f 6d61 6b65 5f61 7865  , ax = _make_axe
+00021930: 5f6d 756c 7469 706c 6520 2820 0d0a 2020  _multiple ( ..  
+00021940: 2020 2020 2020 2020 2020 636c 6673 2c20            clfs, 
+00021950: 6e63 6f6c 7320 3d20 6e63 6f6c 7320 2c20  ncols = ncols , 
+00021960: 6178 203d 2061 782c 2066 6967 5f73 697a  ax = ax, fig_siz
+00021970: 6520 3d20 6669 675f 7369 7a65 200d 0a20  e = fig_size .. 
+00021980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219a0: 2029 200d 0a20 2020 2020 2020 200d 0a20   ) ..        .. 
+000219b0: 2020 2065 6c73 653a 200d 0a20 2020 2020     else: ..     
+000219c0: 2020 2069 6620 6178 2069 7320 4e6f 6e65     if ax is None
+000219d0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+000219e0: 6669 672c 2061 7820 3d20 706c 742e 7375  fig, ax = plt.su
+000219f0: 6270 6c6f 7473 2028 312c 2031 2c20 6669  bplots (1, 1, fi
+00021a00: 6773 697a 6520 3d20 6669 675f 7369 7a65  gsize = fig_size
+00021a10: 2029 2020 0d0a 2020 2020 0d0a 2020 2020   )  ..    ..    
+00021a20: 666f 7220 6b2c 2028 206d 6f64 656c 2c20  for k, ( model, 
+00021a30: 6e61 6d65 2920 2069 6e20 656e 756d 6572  name)  in enumer
+00021a40: 6174 6520 287a 6970 2028 636c 6673 2c20  ate (zip (clfs, 
+00021a50: 6e61 6d65 7320 2929 3a20 0d0a 2020 2020  names )): ..    
+00021a60: 2020 2020 6368 6563 6b5f 6973 5f66 6974      check_is_fit
+00021a70: 7465 6428 6d6f 6465 6c20 290d 0a20 2020  ted(model )..   
+00021a80: 2020 2020 2066 7072 2c20 7470 722c 2061       fpr, tpr, a
+00021a90: 7563 5f73 636f 7265 203d 2070 6c6f 745f  uc_score = plot_
+00021aa0: 726f 6328 6d6f 6465 6c2c 2058 2c20 792c  roc(model, X, y,
+00021ab0: 2073 636f 7265 290d 0a0d 0a20 2020 2020   score)....     
+00021ac0: 2020 2069 6620 6861 7361 7474 7220 2861     if hasattr (a
+00021ad0: 782c 2027 5f5f 6c65 6e5f 5f27 293a 200d  x, '__len__'): .
+00021ae0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00021af0: 6c65 6e28 6178 2e73 6861 7065 293e 313a  len(ax.shape)>1:
+00021b00: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00021b10: 2020 2069 2c20 6a20 203d 2020 6b20 2f2f     i, j  =  k //
+00021b20: 206e 636f 6c73 202c 206b 2025 206e 636f   ncols , k % nco
+00021b30: 6c73 200d 0a20 2020 2020 2020 2020 2020  ls ..           
+00021b40: 2020 2020 2061 7865 203d 2061 7820 5b69       axe = ax [i
+00021b50: 2c20 6a5d 0d0a 2020 2020 2020 2020 2020  , j]..          
+00021b60: 2020 656c 7365 3a20 6178 6520 3d20 6178    else: axe = ax
+00021b70: 5b6b 5d0d 0a20 2020 2020 2020 2065 6c73  [k]..        els
+00021b80: 653a 2061 7865 203d 2061 7820 0d0a 0d0a  e: axe = ax ....
+00021b90: 2020 2020 2020 2020 6178 652e 706c 6f74          axe.plot
+00021ba0: 2866 7072 2c20 7470 722c 206c 6162 656c  (fpr, tpr, label
+00021bb0: 3d6e 616d 6520 2b20 2827 2720 6966 2061  =name + ('' if a
+00021bc0: 7563 5f73 636f 7265 2069 7320 4e6f 6e65  uc_score is None
+00021bd0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00021be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021bf0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00021c00: 2066 2241 5543 3d7b 726f 756e 6428 6175   f"AUC={round(au
+00021c10: 635f 7363 6f72 652c 2033 2920 7d22 2920  c_score, 3) }") 
+00021c20: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00021c30: 2020 2020 2063 6f6c 6f72 203d 2063 6f6c       color = col
+00021c40: 6f72 735b 6b5d 2020 290d 0a20 2020 2020  ors[k]  )..     
+00021c50: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
+00021c60: 6b69 6e64 3d3d 2732 273a 200d 0a20 2020  kind=='2': ..   
+00021c70: 2020 2020 2020 2020 2061 7865 2e70 6c6f           axe.plo
+00021c80: 7428 5b30 2c20 315d 2c20 5b30 2c20 315d  t([0, 1], [0, 1]
+00021c90: 2c20 276b 2d2d 2729 200d 0a20 2020 2020  , 'k--') ..     
+00021ca0: 2020 2020 2020 2061 7865 2e6c 6567 656e         axe.legen
+00021cb0: 6420 2829 0d0a 2020 2020 2020 2020 2020  d ()..          
+00021cc0: 2020 6178 652e 7365 745f 786c 6162 656c    axe.set_xlabel
+00021cd0: 2028 2246 616c 7365 2050 6f73 6974 6976   ("False Positiv
+00021ce0: 6520 5261 7465 2028 4650 5229 2229 0d0a  e Rate (FPR)")..
+00021cf0: 2020 2020 2020 2020 2020 2020 6178 652e              axe.
+00021d00: 7365 745f 796c 6162 656c 2028 2254 7275  set_ylabel ("Tru
+00021d10: 6520 506f 7369 7469 7665 2052 6174 6520  e Positive Rate 
+00021d20: 2846 5052 2922 290d 0a20 2020 2020 2020  (FPR)")..       
+00021d30: 2023 2065 6c73 653a 200d 0a20 2020 2020   # else: ..     
+00021d40: 2020 2023 2020 2020 2061 782e 706c 6f74     #     ax.plot
+00021d50: 2866 7072 2c20 7470 722c 206c 6162 656c  (fpr, tpr, label
+00021d60: 3d6e 616d 652c 2063 6f6c 6f72 203d 2063  =name, color = c
+00021d70: 6f6c 6f72 735b 6b5d 290d 0a20 2020 2020  olors[k])..     
+00021d80: 2020 2020 2020 200d 0a20 2020 2069 6620         ..    if 
+00021d90: 6b69 6e64 213d 2732 273a 200d 0a20 2020  kind!='2': ..   
+00021da0: 2020 2020 2061 782e 706c 6f74 285b 302c       ax.plot([0,
+00021db0: 2031 5d2c 205b 302c 2031 5d2c 2027 6b2d   1], [0, 1], 'k-
+00021dc0: 2d27 2920 2320 4155 4320 3d2e 3520 0d0a  -') # AUC =.5 ..
+00021dd0: 2020 2020 2020 2020 6178 2e73 6574 5f78          ax.set_x
+00021de0: 6c61 6265 6c20 2822 4661 6c73 6520 506f  label ("False Po
+00021df0: 7369 7469 7665 2052 6174 6520 2846 5052  sitive Rate (FPR
+00021e00: 2922 290d 0a20 2020 2020 2020 2061 782e  )")..        ax.
+00021e10: 7365 745f 796c 6162 656c 2028 2254 7275  set_ylabel ("Tru
+00021e20: 6520 506f 7369 7469 7665 2052 6174 6520  e Positive Rate 
+00021e30: 2846 5052 2922 290d 0a20 2020 2020 2020  (FPR)")..       
+00021e40: 2061 782e 6c65 6765 6e64 2829 200d 0a20   ax.legend() .. 
+00021e50: 2020 2020 2020 200d 0a20 2020 2072 6574         ..    ret
+00021e60: 7572 6e20 6178 200d 0a20 2020 2020 2020  urn ax ..       
+00021e70: 200d 0a0d 0a20 2020 200d 0a20 200d 0a20   ....    ..  .. 
+00021e80: 2020 200d 0a20 200d 0a20 2020 200d 0a20     ..  ..    .. 
+00021e90: 200d 0a20 2020 200d 0a20 200d 0a20 2020   ..    ..  ..   
+00021ea0: 200d 0a20 200d 0a20 2020 200d 0a20 200d   ..  ..    ..  .
+00021eb0: 0a20 2020 200d 0a20 200d 0a20 2020 200d  .    ..  ..    .
+00021ec0: 0a20 200d 0a20 2020 200d 0a20 200d 0a20  .  ..    ..  .. 
+00021ed0: 2020 200d 0a20 200d 0a20 2020 200d 0a20     ..  ..    .. 
+00021ee0: 200d 0a20 2020 200d 0a20 200d 0a20 2020   ..    ..  ..   
+00021ef0: 200d 0a20 200d 0a20 2020 200d 0a20 200d   ..  ..    ..  .
+00021f00: 0a20 2020 200d 0a20 200d 0a20 2020 200d  .    ..  ..    .
+00021f10: 0a20 200d 0a20 2020 200d 0a20 200d 0a20  .  ..    ..  .. 
+00021f20: 2020 200d 0a20 200d 0a20 2020 200d 0a20     ..  ..    .. 
+00021f30: 200d 0a20 2020 200d 0a20 200d 0a20 2020   ..    ..  ..   
+00021f40: 200d 0a20 200d 0a20 2020 200d 0a20 200d   ..  ..    ..  .
+00021f50: 0a20 2020 200d 0a20 2020 200d 0a20 2020  .    ..    ..   
+00021f60: 200d 0a20 2020 200d 0a                    ..    ..
```

### Comparing `watex-0.2.4/watex/utils/setup.py` & `watex-0.2.5/watex/utils/setup.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/utils/thread.py` & `watex-0.2.5/watex/utils/thread.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/utils/validator.py` & `watex-0.2.5/watex/utils/validator.py`

 * *Files 0% similar despite different names*

```diff
@@ -409,15 +409,15 @@
     
     data: DataFrame, 
         It is composed of spacing values `AB` and  the apparent resistivity 
         values `rhoa`. If `data` is given, params `AB` and `rhoa` should be 
         kept to ``None``.
     ensure_2d: bool, default=False, 
         If ``True`` return array-like of two dimensional where the first and 
-        second cimunns are AB and rhoa respectively. 
+        second columns are AB and rhoa respectively. 
     as_frame: bool, default=False
         If ``True``, returns a pd.dataframe of AB and rhoa columns. 
         
     Returns 
     --------
     (AB, rhoa): Tuple of arraylike (1d ) 
         returns 2D matrix of shape (n_measurement, 2) if `ensure_2d` is ``True``.
@@ -523,15 +523,15 @@
     
     This helper function tries to return array from object attribute  where 
     object attribute is the array name if exists. Otherwise raises an error. 
     
     Parameters
     ----------
     obj : object 
-       Object that is expect to contain the array attribute.
+       Object that is expected to contain the array attribute.
     Returns
     -------
     X : array
        Array fetched from its name in `obj`. 
     """
     
     type_ = type(obj)
@@ -1221,15 +1221,15 @@
             return estimator
         else:
             return estimator.__class__.__name__
     return None
 
 def set_array_back (X, *,  to_frame=False, columns = None, input_name ='X'): 
     """ Set array back to frame, reconvert the Numpy array to pandas series 
-    or dataframe.
+    or dataframe. 
     
     Parameters 
     ----------
     X: Array-like 
         Array to convert to frame. 
     columns: str or list of str 
         Series name or columns names for pandas.Series and DataFrame.
```

### Comparing `watex-0.2.4/watex/utils/version.py` & `watex-0.2.5/watex/utils/version.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/view/__init__.py` & `watex-0.2.5/watex/view/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/view/mlplot.py` & `watex-0.2.5/watex/view/mlplot.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/view/plot.py` & `watex-0.2.5/watex/view/plot.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex/wlog.yml` & `watex-0.2.5/watex/wlog.yml`

 * *Files identical despite different names*

### Comparing `watex-0.2.4/watex.egg-info/PKG-INFO` & `watex-0.2.5/watex.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: watex
-Version: 0.2.4
+Version: 0.2.5
 Summary: Machine learning research in water exploration
 Home-page: https://github.com/WEgeophysics/watex
 Download-URL: https://pypi.org/project/watex/#files
 Author: Laurent Kouadio
 Author-email: etanoyau@gmail.com
 Maintainer: Laurent Kouadio
 Maintainer-email: etanoyau@gmail.com
```

### Comparing `watex-0.2.4/watex.egg-info/SOURCES.txt` & `watex-0.2.5/watex.egg-info/SOURCES.txt`

 * *Files 1% similar despite different names*

```diff
@@ -88,14 +88,15 @@
 docs/whatsnew/v0.1.8.rst
 docs/whatsnew/v0.1.9.rst
 docs/whatsnew/v0.2.0.rst
 docs/whatsnew/v0.2.1.rst
 docs/whatsnew/v0.2.2.rst
 docs/whatsnew/v0.2.3.rst
 docs/whatsnew/v0.2.4.rst
+docs/whatsnew/v0.2.5.rst
 examples/README.txt
 examples/analysis/README.txt
 examples/analysis/plot_decision_regions.py
 examples/analysis/plot_explained_variance_ratio.py
 examples/analysis/plot_linear_discriminant_analysis.py
 examples/analysis/plot_pca_vs_factor_with_scedatic_noises.py
 examples/applications/README.txt
@@ -142,14 +143,15 @@
 examples/utils/plot_pca_components.py
 examples/utils/plot_regularization_path.py
 examples/utils/plot_rf_feature_importances.py
 examples/utils/plot_savitzky_golay1d.py
 examples/utils/plot_sbs_feature_selection.py
 examples/utils/plot_sfi.py
 examples/utils/plot_skew.py
+examples/utils/plot_stratalog.py
 examples/utils/plot_strike.py
 examples/utils/plot_voronoi.py
 examples/view/README.txt
 examples/view/plot_2d_filtered_tensors.py
 examples/view/plot_base_distributions.py
 examples/view/plot_biplot.py
 examples/view/plot_box.py
@@ -240,14 +242,16 @@
 watex/datasets/data/boundiali_ves.csv
 watex/datasets/data/dcerp_gbalo.csv
 watex/datasets/data/dcves_gbalo.csv
 watex/datasets/data/e.h5
 watex/datasets/data/h.h5
 watex/datasets/data/iris.csv
 watex/datasets/data/mxs.joblib
+watex/datasets/data/nlogs+.csv
+watex/datasets/data/nlogs.csv
 watex/datasets/data/semien_ves.csv
 watex/datasets/data/tankesse.csv
 watex/datasets/data/wine_data.csv
 watex/datasets/data/edis/__init__.py
 watex/datasets/data/edis/raw.E.zip
 watex/datasets/data/edis/s.E.zip
 watex/datasets/descr/__init__.py
@@ -255,14 +259,16 @@
 watex/datasets/descr/boston_house_prices.rst
 watex/datasets/descr/boundiali_ves.rst
 watex/datasets/descr/california_housing.rst
 watex/datasets/descr/gbalo_erp.rst
 watex/datasets/descr/gbalo_ves.rst
 watex/datasets/descr/huayuan_edis.rst
 watex/datasets/descr/iris.rst
+watex/datasets/descr/nanshang+.rst
+watex/datasets/descr/nanshang.rst
 watex/datasets/descr/wine_data.rst
 watex/etc/AGSO.csv
 watex/etc/AGSO_STCODES.csv
 watex/etc/__XTyT.pkl
 watex/etc/__Xy.pkl
 watex/etc/__init__.py
 watex/etc/__memory.pkl
```

