# Comparing `tmp/pydevkit-2.1.1-py3-none-any.whl.zip` & `tmp/pydevkit-3.2.2-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,14 +1,16 @@
-Zip file size: 13813 bytes, number of entries: 12
--rw-rw-r--  2.0 unx       48 b- defN 22-Apr-02 21:41 pydevkit/__init__.py
--rw-rw-r--  2.0 unx      142 b- defN 22-May-06 10:01 pydevkit/__version__.py
--rw-rw-r--  2.0 unx     1160 b- defN 22-Apr-03 07:06 pydevkit/argparse.py
--rw-rw-r--  2.0 unx      773 b- defN 22-Apr-03 07:06 pydevkit/shell.py
--rw-rw-r--  2.0 unx     1338 b- defN 22-May-05 23:11 pydevkit/term.py
--rw-rw-r--  2.0 unx     5501 b- defN 22-May-06 08:35 pydevkit/log/__init__.py
--rw-rw-r--  2.0 unx     3627 b- defN 22-May-06 09:57 pydevkit/log/config.py
--rw-rw-r--  2.0 unx    18040 b- defN 22-May-06 10:01 pydevkit-2.1.1.dist-info/LICENSE
--rw-rw-r--  2.0 unx     1125 b- defN 22-May-06 10:01 pydevkit-2.1.1.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 22-May-06 10:01 pydevkit-2.1.1.dist-info/WHEEL
--rw-rw-r--  2.0 unx        9 b- defN 22-May-06 10:01 pydevkit-2.1.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx      928 b- defN 22-May-06 10:01 pydevkit-2.1.1.dist-info/RECORD
-12 files, 32783 bytes uncompressed, 12267 bytes compressed:  62.6%
+Zip file size: 17125 bytes, number of entries: 14
+-rw-rw-r--  2.0 unx      160 b- defN 16-Jan-01 00:00 pydevkit/__init__.py
+-rw-rw-r--  2.0 unx     5816 b- defN 16-Jan-01 00:00 pydevkit/argparse.py
+-rw-rw-r--  2.0 unx      196 b- defN 16-Jan-01 00:00 pydevkit/conf.py
+-rw-rw-r--  2.0 unx      561 b- defN 16-Jan-01 00:00 pydevkit/log/__init__.py
+-rw-rw-r--  2.0 unx     3307 b- defN 16-Jan-01 00:00 pydevkit/log/base.py
+-rw-rw-r--  2.0 unx     3687 b- defN 16-Jan-01 00:00 pydevkit/log/config.py
+-rw-rw-r--  2.0 unx      566 b- defN 16-Jan-01 00:00 pydevkit/log/extra.py
+-rw-rw-r--  2.0 unx      775 b- defN 16-Jan-01 00:00 pydevkit/shell.py
+-rw-rw-r--  2.0 unx     1424 b- defN 16-Jan-01 00:00 pydevkit/term.py
+-rw-rw-r--  2.0 unx       21 b- defN 16-Jan-01 00:00 pydevkit/__version__.py
+?rw-------  2.0 unx       87 b- defN 16-Jan-01 00:00 pydevkit-3.2.2.dist-info/WHEEL
+?rw-------  2.0 unx     5395 b- defN 16-Jan-01 00:00 pydevkit-3.2.2.dist-info/METADATA
+-rw-rw-r--  2.0 unx    18040 b- defN 16-Jan-01 00:00 pydevkit-3.2.2.dist-info/licenses/LICENSE
+?rw-------  2.0 unx     1070 b- defN 16-Jan-01 00:00 pydevkit-3.2.2.dist-info/RECORD
+14 files, 41105 bytes uncompressed, 15371 bytes compressed:  62.6%
```

## zipnote {}

```diff
@@ -1,37 +1,43 @@
 Filename: pydevkit/__init__.py
 Comment: 
 
-Filename: pydevkit/__version__.py
-Comment: 
-
 Filename: pydevkit/argparse.py
 Comment: 
 
-Filename: pydevkit/shell.py
+Filename: pydevkit/conf.py
 Comment: 
 
-Filename: pydevkit/term.py
+Filename: pydevkit/log/__init__.py
 Comment: 
 
-Filename: pydevkit/log/__init__.py
+Filename: pydevkit/log/base.py
 Comment: 
 
 Filename: pydevkit/log/config.py
 Comment: 
 
-Filename: pydevkit-2.1.1.dist-info/LICENSE
+Filename: pydevkit/log/extra.py
+Comment: 
+
+Filename: pydevkit/shell.py
+Comment: 
+
+Filename: pydevkit/term.py
+Comment: 
+
+Filename: pydevkit/__version__.py
 Comment: 
 
-Filename: pydevkit-2.1.1.dist-info/METADATA
+Filename: pydevkit-3.2.2.dist-info/WHEEL
 Comment: 
 
-Filename: pydevkit-2.1.1.dist-info/WHEEL
+Filename: pydevkit-3.2.2.dist-info/METADATA
 Comment: 
 
-Filename: pydevkit-2.1.1.dist-info/top_level.txt
+Filename: pydevkit-3.2.2.dist-info/licenses/LICENSE
 Comment: 
 
-Filename: pydevkit-2.1.1.dist-info/RECORD
+Filename: pydevkit-3.2.2.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## pydevkit/__init__.py

```diff
@@ -1 +1,8 @@
-from .__version__ import version as __version__
+try:
+    from .__version__ import __version__
+except Exception:
+    # editable install during development
+    __version__ = "0.1.0"
+
+
+__all__ = ["__version__"]
```

## pydevkit/__version__.py

```diff
@@ -1,5 +1 @@
-# coding: utf-8
-# file generated by setuptools_scm
-# don't change, don't track in version control
-version = '2.1.1'
-version_tuple = (2, 1, 1)
+__version__ = '3.2.2'
```

## pydevkit/argparse.py

```diff
@@ -1,39 +1,175 @@
-
 import argparse
-import sys
+import os
 from pydevkit.log import prettify
-from pydevkit.log import log_argparse
 
 import logging
-log = logging.getLogger(__name__)
 
+# log = logging.getLogger(__name__)
+
+
+class EnvAction(argparse.Action):
+    def __init__(self, envvar, default=None, **kwargs):
+        self.envvar = envvar
+        self.orig_default = default
+        if envvar in os.environ:
+            default = os.environ[envvar]
+        super(EnvAction, self).__init__(default=default, **kwargs)
+
+    def __call__(self, parser, namespace, values, option_string=None):
+        setattr(namespace, self.dest, values)
+
+
+class PdkHelpFormatter(argparse.RawDescriptionHelpFormatter):
+    def __init__(self, prog, show_default=True, show_envvar=True, **kwargs):
+        super().__init__(prog, **kwargs)
+        self.show_default = show_default
+        self.show_envvar = show_envvar
+
+    def _get_help_string(self, action):
+        help = action.help
+        defaulting_nargs = [argparse.OPTIONAL, argparse.ZERO_OR_MORE]
+        if (
+            self.show_default
+            and ("%(default)" not in action.help)
+            and (action.default is not argparse.SUPPRESS)
+            and (action.option_strings or action.nargs in defaulting_nargs)
+        ):
+            help += " (default: %(default)s)"
+        if hasattr(action, "orig_default"):
+            help = help.replace("%(default)", "%(orig_default)")
+
+        if self.show_envvar and hasattr(action, "envvar"):
+            help += " (envvar: %(envvar)s)"
+
+        return help
+
+    def _format_usage_short(self, usage, actions, groups, prefix):
+        groups = []
+        # print("XXX: add_usage: usage:", usage)
+        for action in actions:
+            tmp = getattr(action, "container", None)
+            if tmp.title and tmp.title not in groups:
+                groups.append(tmp.title)
+        groups = " ".join(["[" + g + "]" for g in groups])
+        return "usage: %s %s\n" % (self._prog, groups)
+
+    def add_usage(self, usage, actions, groups, prefix=None):
+        if usage == "short":
+            args = usage, actions, groups, prefix
+            self._add_item(self._format_usage_short, args)
+        elif usage == "full" or usage is None:
+            args = None, actions, groups, prefix
+            self._add_item(self._format_usage, args)
+        else:
+            args = usage, actions, groups, prefix
+            self._add_item(self._format_usage, args)
+
+
+class LoggingArgumentParser(argparse.ArgumentParser):
+    def __init__(self):
+        super().__init__(add_help=False)
+        log_levels = ["debug", "info", "warning", "error", "critical"]
+        log_handlers = ["app", "app_mini", "json", "json_mini"]
+        # p = self.add_argument_group('logging', 'logging configuration')
+        p = self.add_argument_group("logging", None)
+        p.add_argument(
+            "--log-level",
+            help="values: %(choices)s",
+            metavar="arg",
+            choices=log_levels,
+            action=EnvAction,
+            envvar="PYDEVKIT_LOG_LEVEL",
+            default="info",
+        )
+        p.add_argument(
+            "--log-color",
+            help="colorfull logs: %(choices)s",
+            metavar="arg",
+            choices=["auto", "yes", "no"],
+            action=EnvAction,
+            envvar="PYDEVKIT_LOG_COLOR",
+            default="auto",
+        )
+        p.add_argument(
+            "--log-handler",
+            help="message format: %(choices)s",
+            metavar="arg",
+            choices=log_handlers,
+            action=EnvAction,
+            envvar="PYDEVKIT_LOG_HANDLER",
+            default="app_mini",
+        )
+        p.add_argument(
+            "--log-date",
+            help="date format: 'datetime', 'date', 'time'"
+            " or strftime format eg '%%Y-%%m-%%d'",
+            metavar="arg",
+            action=EnvAction,
+            envvar="PYDEVKIT_LOG_DATE",
+            default="datetime",
+        )
+        p.add_argument(
+            "--log-threads",
+            help="show thread name: %(choices)s",
+            metavar="arg",
+            choices=["yes", "no"],
+            action=EnvAction,
+            envvar="PYDEVKIT_LOG_THREADS",
+            default="no",
+        )
+
+
+class PdkArgumentParser(argparse.ArgumentParser):
+    def __init__(
+        self,
+        version=None,
+        usage="full",
+        show_default=True,
+        show_envvar=True,
+        **kwargs
+    ):
+        def _fmt(prog):
+            return PdkHelpFormatter(
+                prog, show_envvar=show_envvar, show_default=show_default
+            )
+
+        kwargs["formatter_class"] = _fmt
+
+        app_help = kwargs.get("help")
+        if app_help is not None:
+            tmp = app_help.split("\nEPILOG:\n")
+            kwargs["description"] = tmp[0]
+            kwargs["epilog"] = tmp[1] if len(tmp) == 2 else None
+            del kwargs["help"]
+
+        kwargs["usage"] = usage
+
+        app_parents = kwargs.get("parents", [])
+        kwargs["parents"] = app_parents + [LoggingArgumentParser()]
+
+        super().__init__(**kwargs)
+        if version:
+            self.add_argument("--version", action="version", version=version)
 
-def ArgumentParser(_help=None, args=None, app_name=None):
-    if app_name is None:
-        app_name = sys.argv[0].split('/')[-1]
-    if _help is None:
-        _help = ""
-    tmp = _help.split('\nEPILOG:\n')
-    app_help = tmp[0]
-    app_epilog = tmp[1] if len(tmp) == 2 else ''
-
-    p = argparse.ArgumentParser(
-        prog=app_name,
-        formatter_class=argparse.RawDescriptionHelpFormatter,
-        description=app_help,
-        epilog=app_epilog)
-    # p.add_argument("--debug", help="debug mode", action="store_true")
-    log_argparse(p)
-
-    def args_resolve(self, args=args):
-        Args, UnknownArgs = self.parse_known_args(args)
-        log.debug("Args: %s", prettify(vars(Args)))
+    def parse_known_args(self, args=None, namespace=None):
+        Args, UnknownArgs = super().parse_known_args(args, namespace)
         if UnknownArgs:
-            log.debug("Not all arguments were parsed: '%s'", UnknownArgs)
-            if UnknownArgs[0] == '--':
+            if UnknownArgs[0] == "--":
                 del UnknownArgs[0]
-        log.debug("UnknownArgs: %s", UnknownArgs)
+        # print("X"* 20, "parse args", prettify(vars(Args)))
+        log = logging.getLogger(__name__)
+        log.debug(
+            "argparse:\nArgs: %s\nUnknownArgs: %s\n",
+            prettify(vars(Args)),
+            UnknownArgs,
+        )
         return Args, UnknownArgs
 
-    p.args_resolve = args_resolve.__get__(p)
-    return p
+
+class ArgumentParser(PdkArgumentParser):
+    def __init__(self, _help=None, help=None, **kwargs):
+        kwargs["help"] = _help or help
+        super().__init__(**kwargs)
+
+    def args_resolve(self, args=None):
+        return self.parse_known_args(args)
```

## pydevkit/shell.py

```diff
@@ -1,25 +1,26 @@
 import subprocess as sp
 
 import logging
+
 log = logging.getLogger(__name__)
 
 
 class Shell(object):
-    def __init__(self, exe='/bin/bash'):
+    def __init__(self, exe="/bin/bash"):
         self.fmt = {}
         self.exe = exe
 
     def __call__(self, cmd, output=False):
         cmd = cmd % self.fmt
         log.debug("shell '%s'", cmd)
         kwargs = {
-            'shell': True,
-            'executable': self.exe,
-            'universal_newlines': True
+            "shell": True,
+            "executable": self.exe,
+            "universal_newlines": True,
         }
         if output:
             rc = sp.check_output(cmd, **kwargs).strip()
         else:
             rc = sp.check_call(cmd, **kwargs)
         return rc
```

## pydevkit/term.py

```diff
@@ -1,58 +1,63 @@
 import sys
+from .conf import conf_get
 
 import logging
+
 log = logging.getLogger(__name__)
 
 
 class Terminal:
-
     color_codes = {
         "black": "0",
         "red": "1",
         "green": "2",
         "yellow": "3",
         "blue": "4",
         "magenta": "5",
         "cyan": "6",
-        "white": "7"
+        "white": "7",
     }
 
     tone_codes = {
         "normal": "0",
         "bold": "1",
         "dim": "2",
         "italic": "3",
         "underline": "4",
         "blink": "5",
         "blink2": "6",
         "reverse": "7",
         "hide": "8",
-        "overstrike": "9"
+        "overstrike": "9",
     }
 
     def __init__(self, colors="auto"):
-        if colors == 'auto':
+        if colors == "auto":
             colors = "yes" if sys.stderr.isatty() else "no"
         self.colors = colors
 
     def __getattr__(self, name):
         # log.debug("term: attr %s", name)
         if self.colors != "yes":
             return ""
         cflag = "fg"
         rc = []
-        for n in name.split('_'):
-            if n == 'on':
+        for n in name.split("_"):
+            if n == "on":
                 cflag = "bg"
                 continue
             if n in self.color_codes:
                 pfx = "3" if cflag == "fg" else "4"
                 rc.append(pfx + self.color_codes[n])
                 cflag = "fg"
                 continue
             if n in self.tone_codes:
                 rc.append(self.tone_codes[n])
 
         if rc:
-            return '\x1b[' + ';'.join(rc) + 'm'
+            return "\x1b[" + ";".join(rc) + "m"
         return ""
+
+
+def term_get():
+    return Terminal(conf_get("color"))
```

## pydevkit/log/__init__.py

```diff
@@ -1,186 +1,29 @@
-import logging
-import sys
-import re
-import os
-import json
-import datetime
-import threading
-from ..term import Terminal
-
-
-conf = {
-    'term': None
-}
-
-
-def conf_set(key, value):
-    conf[key] = value
-
-
-def conf_get(key, value=None):
-    return conf.get(key, value)
+from pydevkit.term import Terminal
+from pydevkit.conf import conf_set, conf_get
+from .extra import prettify
+from .base import ColorLevelFormatter, JsonFormatter
+from .base import TimeFilter, ExtraFilter, LogNameFilter, AppNameFilter
 
 
+# {{{
+# FIXME: remove this, use term_get from term.py
 def term_set(state):
-    conf_set('term', Terminal(state))
+    conf_set("term", Terminal(state))
 
 
 def term_get():
-    return conf_get('term')
+    return conf_get("term")
+
 
+# }}}
 
-class ColorLevelFormatter(logging.Formatter):
-    """Logging Formatter to add colors and count warning / errors"""
 
-    def __init__(self, *args, **kwargs):
-        # print("fmt args", args)
-        # print("fmt kwargs", kwargs)
-        term = term_get()
-        # term_print("ColorLevelFormatter")
-        self.colors = {
-            "DEBUG": term.cyan_dim,
-            "INFO": term.grey,
-            "WARNING": term.yellow,
-            "ERROR": term.red_bold,
-            "CRITICAL": term.red_bold_underline
-        }
-        if 'format' in kwargs:
-            kwargs['fmt'] = kwargs['format']
-            del kwargs['format']
-        if 'colors' in kwargs:
-            self.colors.update(kwargs['colors'])
-            del kwargs['colors']
-        logging.Formatter.__init__(self, *args, **kwargs)
-
-    def format(self, record):
-        term = term_get()
-        record.clr_level = self.colors.get(record.levelname, '')
-        record.clr_details = term.white_dim
-        record.clr_reset = term.normal
-        return logging.Formatter.format(self, record)
-
-
-class JsonFormatter(logging.Formatter):
-    """Json Formatter"""
-
-    def __init__(self, *args, **kwargs):
-        # print('='*20 + ' JsonFormatter ' + str(kwargs))
-        # term_print("JsonFormatter")
-        if 'format' in kwargs:
-            kwargs['fmt'] = kwargs['format']
-            del kwargs['format']
-        reg = '%\\((?P<name>[^)]+)\\)s'
-        self.props = [p.group(1) for p in re.finditer(reg, kwargs['fmt'])]
-        logging.Formatter.__init__(self, *args, **kwargs)
-
-    def format(self, record):
-        # print(dir(record))
-        record.message = record.msg % record.args
-        rc = {}
-        for a in self.props:
-            rc[a] = getattr(record, a, "")
-        return json.dumps(rc)
-
-
-_app_name = sys.argv[0].split('/')[-1]
-
-
-class AppNameFilter(logging.Filter):
-
-    def __init__(self, name=None, threads="no"):
-        self.app_name = name if name else _app_name
-        self.threads = threads
-        logging.Filter.__init__(self)
-
-    def filter(self, record):
-        record.appname = self.app_name
-        if self.threads == "yes":
-            record.appname += ':' + threading.current_thread().name
-        return True
-
-
-class TimeFilter(logging.Filter):
-    _format = {
-        "datetime": '%Y-%m-%d %H:%M:%S',
-        "date": '%Y-%m-%d',
-        "time": '%H:%M:%S'
-    }
-
-    def __init__(self, format="datetime"):
-        self.format = self._format.get(format, format)
-
-    def filter(self, record):
-        tmp = datetime.datetime.fromtimestamp(record.created)
-        tmp = tmp.strftime(self.format)
-        record.time = tmp
-        return True
-
-
-class ExtraFilter(logging.Filter):
-
-    def filter(self, record):
-        if not hasattr(record, "extra"):
-            record.extra = ""
-        return True
-
-
-class LogNameFilter(logging.Filter):
-
-    def filter(self, record):
-        record.logname = record.name
-        pfx = "debug."
-        if record.logname.startswith(pfx):
-            record.logname = record.logname[len(pfx):]
-        pfx = "__main__"
-        if record.logname.startswith(pfx):
-            record.logname = 'main' + record.logname[len(pfx):]
-        return True
-
-
-class AllEncoder(json.JSONEncoder):
-    reg = re.compile('\\s+at\\s+[^>]+')
-
-    def no_addr(self, s):
-        return self.reg.sub('', s)
-
-    def default(self, obj):
-        if hasattr(obj, '__call__'):
-            return self.no_addr(str(obj))
-        elif isinstance(obj, object):
-            return self.no_addr(str(obj))
-        try:
-            return json.JSONEncoder.default(self, obj)
-        except:
-            return str(obj)
-
-
-def prettify(eobj):
-    return json.dumps(eobj, indent=4, sort_keys=True, cls=AllEncoder)
-
-
-def log_argparse(p):
-    p.add_argument("--log-level",
-                   help="values: %(choices)s; default is %(default)s",
-                   metavar="arg",
-                   choices=['debug', 'info', 'warning', 'error', 'critical'],
-                   default=os.environ.get('PYDEVKIT_LOG_LEVEL', "info"))
-    p.add_argument("--log-color",
-                   help="values: %(choices)s; default is %(default)s",
-                   metavar="arg",
-                   choices=['auto', 'yes', 'no'],
-                   default=os.environ.get('PYDEVKIT_LOG_COLOR', "auto"))
-    p.add_argument("--log-handler",
-                   help="values: %(choices)s; default is %(default)s",
-                   metavar="arg",
-                   choices=['app', 'app_mini', 'json', 'json_mini'],
-                   default=os.environ.get('PYDEVKIT_LOG_HANDLER', "app_mini"))
-    p.add_argument("--log-date",
-                   help="values: predefined formats: 'datetime', 'date', 'time'"
-                        " or strftime format eg '%%Y-%%m-%%d'",
-                   metavar="arg",
-                   default=os.environ.get('PYDEVKIT_LOG_DATE', "datetime"))
-    p.add_argument("--log-threads",
-                   help="values: %(choices)s; default is %(default)s",
-                   metavar="arg",
-                   choices=['yes', 'no'],
-                   default=os.environ.get('PYDEVKIT_LOG_THREADS', "no"))
+__all__ = [
+    "prettify",
+    "ColorLevelFormatter",
+    "JsonFormatter",
+    "TimeFilter",
+    "ExtraFilter",
+    "LogNameFilter",
+    "AppNameFilter",
+]
```

## pydevkit/log/config.py

```diff
@@ -1,13 +1,15 @@
 import logging.config
-import sys
 import os
 import json
+import sys
 
-from . import conf_set, conf_get, term_set
+from . import term_set
+from pydevkit.conf import conf_set, conf_get
+from pydevkit.argparse import LoggingArgumentParser
 
 
 defaultConf = {
     "version": 1,
     "disable_existing_loggers": True,
     "loggers": {
         "": {"level": "%LEVEL%", "handlers": ["app_handler"]},
@@ -23,100 +25,98 @@
             "formatter": "%FMT%",
             "class": "logging.StreamHandler",
             "stream": "ext://sys.stderr",
             "filters": ["app_name", "time", "extra"],
         },
     },
     "filters": {
-        "app_name": {
-            "()": "pydevkit.log.AppNameFilter",
-            "threads": "no"
-        },
+        "app_name": {"()": "pydevkit.log.AppNameFilter", "threads": "no"},
         "time": {
             "()": "pydevkit.log.TimeFilter",
             "format": "%DATE%",
         },
         "extra": {"()": "pydevkit.log.ExtraFilter"},
     },
     "formatters": {
         "app_mini": {
             "()": "pydevkit.log.ColorLevelFormatter",
             "format": "%(clr_details)s%(time)s%(clr_reset)s :: %(appname)s :: "
-                      "%(clr_level)s%(levelname)s%(clr_reset)s :: %(message)s %(extra)s",
+            "%(clr_level)s%(levelname)-5s%(clr_reset)s :: "
+            "%(message)s %(extra)s",
         },
         "app": {
             "()": "pydevkit.log.ColorLevelFormatter",
             "format": "%(clr_details)s%(time)s%(clr_reset)s :: %(appname)s :: "
-                      "%(clr_level)s%(levelname)-7s%(clr_reset)s :: %(message)s "
-                      "%(extra)s :: %(clr_details)s%(name)s%(clr_reset)s",
+            "%(clr_level)s%(levelname)-5s%(clr_reset)s :: "
+            "%(message)s "
+            "%(extra)s :: %(clr_details)s%(name)s%(clr_reset)s",
         },
         "json_mini": {
             "()": "pydevkit.log.JsonFormatter",
-            "format": "%(appname)s %(name)s %(levelname)s %(message)s %(extra)s",
+            "format": "%(appname)s %(name)s %(levelname)s %(message)s "
+            "%(extra)s",
         },
         "json": {
             "()": "pydevkit.log.JsonFormatter",
-            "format": "%(time)s %(appname)s %(levelno)s %(levelname)s %(message)s %(extra)s %(name)s",
+            "format": "%(time)s %(appname)s %(levelno)s %(levelname)s "
+            "%(message)s %(extra)s %(name)s",
         },
     },
 }
 
 
 def _get_conf(kwargs):
     ovals = {
         "level": "INFO",
         "handler": "app_mini",
         "date": "datetime",
         "color": "auto",
-        "threads": 'yes'
+        "threads": "yes",
     }
     vals = dict(ovals)
     vals.update(kwargs)
-    conf_set('level', vals["level"].upper())
-    defaultConf["loggers"][""]["level"] = conf_get('level')
+    conf_set("level", vals["level"].upper())
+    defaultConf["loggers"][""]["level"] = conf_get("level")
     defaultConf["handlers"]["app_handler"]["formatter"] = vals["handler"]
     if vals["handler"] == "app_mini":
         if "date" not in kwargs:
             vals["date"] = "time"
-    term_set(vals["color"])
+    color = vals["color"]
+    if color == "auto":
+        color = "yes" if sys.stderr.isatty() else "no"
+    conf_set("color", color)
+    term_set(color)
 
     defaultConf["filters"]["time"]["format"] = vals["date"]
-    defaultConf["filters"]["app_name"]["threads"] = vals['threads']
+    defaultConf["filters"]["app_name"]["threads"] = vals["threads"]
     return defaultConf
 
 
-from pydevkit.argparse import ArgumentParser
-
-
 def _logging_config():
+    # print("X"* 20, "config log")
     conf_path = os.environ.get("PYDEVKIT_LOG_CONFIG", None)
     if conf_path:
         if conf_path.endswith(".json"):
             conf = json.load(open(conf_path, "r"))
             logging.config.dictConfig(conf)
         else:
             logging.config.fileConfig(conf_path)
     else:
-        args = []
-        for a in sys.argv[1:]:
-            if a == '--':
-                break
-            if a.startswith('--log-'):
-                args.append(a)
-        p = ArgumentParser(args=args)
-        Args, UnknownArgs = p.args_resolve()
+        p = LoggingArgumentParser()
+        Args, UnknownArgs = p.parse_known_args()
         args = vars(Args)
-        # print("Args", prettify(args))
         kwargs = {}
         for k, v in args.items():
             # print("Args", k, v)
             if not k.startswith("log_"):
                 continue
             kwargs[k[4:]] = v
 
         conf = _get_conf(kwargs)
         logging.config.dictConfig(conf)
+    log = logging.getLogger(__name__)
+    log.debug("logging: configured")
 
 
 _logging_config()
 
 # }}}
```

## Comparing `pydevkit-2.1.1.dist-info/LICENSE` & `pydevkit-3.2.2.dist-info/licenses/LICENSE`

 * *Files identical despite different names*

## Comparing `pydevkit-2.1.1.dist-info/RECORD` & `pydevkit-3.2.2.dist-info/RECORD`

 * *Files 24% similar despite different names*

```diff
@@ -1,12 +1,14 @@
-pydevkit/__init__.py,sha256=lnFmuDq7mlb05c-yT5dIUDe8NvKdp_JtLx26K4224lg,48
-pydevkit/__version__.py,sha256=YBQOusEKam0TtaZ41NZaI9j8cSWTQUTHwT_8j2KgpGs,142
-pydevkit/argparse.py,sha256=oXFRCW-oaWISvbOgXxW3xu9uH2Gx5T2yxtpuJgEMz5s,1160
-pydevkit/shell.py,sha256=qvceIjaOI5WcvuwomI0met0E1k7Hyvk0wUon6s57gDA,773
-pydevkit/term.py,sha256=8CaE7ewWk-PnLq0LcibMgszwxAHzpwEN2RBkUoGuBJM,1338
-pydevkit/log/__init__.py,sha256=apwvDwvYn1-kF0mNpK_dnKDijPGRE8y_dqe_axu42rc,5501
-pydevkit/log/config.py,sha256=3W8T15pTCwqgtr-WqVIHIdxR-qCWdOAJUH3iVm4AnQo,3627
-pydevkit-2.1.1.dist-info/LICENSE,sha256=pdbKqBAL_SBG1hRjxfTzbHX4DRDkgYhXgU9jHTR2j54,18040
-pydevkit-2.1.1.dist-info/METADATA,sha256=uwO8IacfGoCW-cFZeom1nxUakks6Ib_Gmt69-jCXu20,1125
-pydevkit-2.1.1.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-pydevkit-2.1.1.dist-info/top_level.txt,sha256=mjpYJ0Q3BEfpK6Gu3yJPk_kNLFceZy9WZpjYB_jF3k4,9
-pydevkit-2.1.1.dist-info/RECORD,,
+pydevkit/__init__.py,sha256=z6wfs6rLKrBxFKviVD4mhopUYd8p9VKRhEIsCmVDZ1I,160
+pydevkit/argparse.py,sha256=zqD65FAsJpUsiToUhYvi4tET63JhPKQoOGtCElVDrWM,5816
+pydevkit/conf.py,sha256=o6knP0sArcGTYOvVu1P-ya4kvexvGuNzzC8dM7tgOwg,196
+pydevkit/log/__init__.py,sha256=RFlF3E3KOG9GV4ZkzA5mFBtRkhbpgEVEOhEJIIUFRbA,561
+pydevkit/log/base.py,sha256=ZNxXNMh8SVcrKuEIYYBFU0k2-k98s-f5V3fE6hpn6UY,3307
+pydevkit/log/config.py,sha256=QmwoWCcb6ctFKVZ9WuLK8LsVXyrcnPZ8Hr44W9oU39c,3687
+pydevkit/log/extra.py,sha256=7h5GTnYXxX4pflLPYLSSmShRNJ9rsxkz-kFZbCkwz-s,566
+pydevkit/shell.py,sha256=IWRTuck2AtDhN5QSFCGU0AmJXg8wy4tblQqT8QLUdts,775
+pydevkit/term.py,sha256=twlqjM9nZlOM5zlM0ngMyd2toJWTBXJBb0lk34W8HR0,1424
+pydevkit/__version__.py,sha256=Bjigemc5Sjk7jFWj14TgnlEttks8mol8xcr8qXRAKHk,21
+pydevkit-3.2.2.dist-info/WHEEL,sha256=B19PGBCYhWaz2p_UjAoRVh767nYQfk14Sn4TpIZ-nfU,87
+pydevkit-3.2.2.dist-info/METADATA,sha256=N6o8tUi-rYyI--SSTk454fTvoA0590WnP5Ok4Ulp8UQ,5395
+pydevkit-3.2.2.dist-info/licenses/LICENSE,sha256=pdbKqBAL_SBG1hRjxfTzbHX4DRDkgYhXgU9jHTR2j54,18040
+pydevkit-3.2.2.dist-info/RECORD,,
```

