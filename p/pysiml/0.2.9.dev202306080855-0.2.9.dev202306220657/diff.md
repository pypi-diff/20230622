# Comparing `tmp/pysiml-0.2.9.dev202306080855-py3-none-any.whl.zip` & `tmp/pysiml-0.2.9.dev202306220657-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,8 +1,8 @@
-Zip file size: 171644 bytes, number of entries: 137
+Zip file size: 170251 bytes, number of entries: 138
 -rw-r--r--  2.0 unx     1520 b- defN 80-Jan-01 00:00 pyproject.toml
 -rw-r--r--  2.0 unx      638 b- defN 80-Jan-01 00:00 siml/__init__.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 siml/__main__/__init__.py
 -rw-r--r--  2.0 unx      900 b- defN 80-Jan-01 00:00 siml/__main__/convert_interim_data.py
 -rw-r--r--  2.0 unx     1400 b- defN 80-Jan-01 00:00 siml/__main__/convert_raw_data.py
 -rw-r--r--  2.0 unx     1742 b- defN 80-Jan-01 00:00 siml/__main__/optimize.py
 -rw-r--r--  2.0 unx     8663 b- defN 80-Jan-01 00:00 siml/__main__/plot_losses.py
@@ -109,31 +109,32 @@
 -rw-r--r--  2.0 unx     5603 b- defN 80-Jan-01 00:00 siml/services/inference/postprocessing/post_fem_data.py
 -rw-r--r--  2.0 unx     4979 b- defN 80-Jan-01 00:00 siml/services/inference/postprocessing/postprocessor.py
 -rw-r--r--  2.0 unx     7052 b- defN 80-Jan-01 00:00 siml/services/inference/postprocessing/save_processor.py
 -rw-r--r--  2.0 unx     1082 b- defN 80-Jan-01 00:00 siml/services/inference/record_object.py
 -rw-r--r--  2.0 unx     2574 b- defN 80-Jan-01 00:00 siml/services/model_builder.py
 -rw-r--r--  2.0 unx     4978 b- defN 80-Jan-01 00:00 siml/services/model_selector.py
 -rw-r--r--  2.0 unx     7124 b- defN 80-Jan-01 00:00 siml/services/path_rules.py
--rw-r--r--  2.0 unx    50226 b- defN 80-Jan-01 00:00 siml/setting.py
--rw-r--r--  2.0 unx    11028 b- defN 80-Jan-01 00:00 siml/siml_manager.py
+-rw-r--r--  2.0 unx       57 b- defN 80-Jan-01 00:00 siml/services/training/__init__.py
+-rw-r--r--  2.0 unx     2383 b- defN 80-Jan-01 00:00 siml/services/training/inner_settings.py
+-rw-r--r--  2.0 unx    50394 b- defN 80-Jan-01 00:00 siml/setting.py
 -rw-r--r--  2.0 unx      163 b- defN 80-Jan-01 00:00 siml/siml_variables/__init__.py
 -rw-r--r--  2.0 unx      594 b- defN 80-Jan-01 00:00 siml/siml_variables/array_variables/__init__.py
 -rw-r--r--  2.0 unx     1573 b- defN 80-Jan-01 00:00 siml/siml_variables/array_variables/interface_wrapper.py
 -rw-r--r--  2.0 unx     1398 b- defN 80-Jan-01 00:00 siml/siml_variables/array_variables/ndarray_wrapper.py
 -rw-r--r--  2.0 unx     1809 b- defN 80-Jan-01 00:00 siml/siml_variables/array_variables/sparce_array_wrapper.py
 -rw-r--r--  2.0 unx     4156 b- defN 80-Jan-01 00:00 siml/siml_variables/tensor_variables/tensor_variables.py
 -rw-r--r--  2.0 unx    13021 b- defN 80-Jan-01 00:00 siml/study.py
--rw-r--r--  2.0 unx    34886 b- defN 80-Jan-01 00:00 siml/trainer.py
+-rw-r--r--  2.0 unx    36269 b- defN 80-Jan-01 00:00 siml/trainer.py
 -rw-r--r--  2.0 unx      211 b- defN 80-Jan-01 00:00 siml/update_functions/__init__.py
 -rw-r--r--  2.0 unx     1774 b- defN 80-Jan-01 00:00 siml/update_functions/element_batch_update.py
 -rw-r--r--  2.0 unx     3623 b- defN 80-Jan-01 00:00 siml/update_functions/pseudo_batch_update.py
 -rw-r--r--  2.0 unx     2702 b- defN 80-Jan-01 00:00 siml/update_functions/standard_update.py
 -rw-r--r--  2.0 unx      429 b- defN 80-Jan-01 00:00 siml/update_functions/update_interface.py
 -rw-r--r--  2.0 unx    23027 b- defN 80-Jan-01 00:00 siml/util.py
 -rw-r--r--  2.0 unx       37 b- defN 80-Jan-01 00:00 siml/utils/__init__.py
 -rw-r--r--  2.0 unx     7682 b- defN 80-Jan-01 00:00 siml/utils/fem_data_utils.py
--rw-r--r--  2.0 unx    11431 b- defN 80-Jan-01 00:00 pysiml-0.2.9.dev202306080855.dist-info/LICENSE
--rw-r--r--  2.0 unx     1638 b- defN 80-Jan-01 00:00 pysiml-0.2.9.dev202306080855.dist-info/METADATA
--rw-r--r--  2.0 unx       88 b- defN 80-Jan-01 00:00 pysiml-0.2.9.dev202306080855.dist-info/WHEEL
--rw-r--r--  2.0 unx      388 b- defN 80-Jan-01 00:00 pysiml-0.2.9.dev202306080855.dist-info/entry_points.txt
-?rw-r--r--  2.0 unx    12472 b- defN 16-Jan-01 00:00 pysiml-0.2.9.dev202306080855.dist-info/RECORD
-137 files, 607408 bytes uncompressed, 151722 bytes compressed:  75.0%
+-rw-r--r--  2.0 unx    11431 b- defN 80-Jan-01 00:00 pysiml-0.2.9.dev202306220657.dist-info/LICENSE
+-rw-r--r--  2.0 unx     1638 b- defN 80-Jan-01 00:00 pysiml-0.2.9.dev202306220657.dist-info/METADATA
+-rw-r--r--  2.0 unx       88 b- defN 80-Jan-01 00:00 pysiml-0.2.9.dev202306220657.dist-info/WHEEL
+-rw-r--r--  2.0 unx      388 b- defN 80-Jan-01 00:00 pysiml-0.2.9.dev202306220657.dist-info/entry_points.txt
+?rw-r--r--  2.0 unx    12580 b- defN 16-Jan-01 00:00 pysiml-0.2.9.dev202306220657.dist-info/RECORD
+138 files, 600479 bytes uncompressed, 150145 bytes compressed:  75.0%
```

## zipnote {}

```diff
@@ -336,18 +336,21 @@
 
 Filename: siml/services/model_selector.py
 Comment: 
 
 Filename: siml/services/path_rules.py
 Comment: 
 
-Filename: siml/setting.py
+Filename: siml/services/training/__init__.py
+Comment: 
+
+Filename: siml/services/training/inner_settings.py
 Comment: 
 
-Filename: siml/siml_manager.py
+Filename: siml/setting.py
 Comment: 
 
 Filename: siml/siml_variables/__init__.py
 Comment: 
 
 Filename: siml/siml_variables/array_variables/__init__.py
 Comment: 
@@ -390,23 +393,23 @@
 
 Filename: siml/utils/__init__.py
 Comment: 
 
 Filename: siml/utils/fem_data_utils.py
 Comment: 
 
-Filename: pysiml-0.2.9.dev202306080855.dist-info/LICENSE
+Filename: pysiml-0.2.9.dev202306220657.dist-info/LICENSE
 Comment: 
 
-Filename: pysiml-0.2.9.dev202306080855.dist-info/METADATA
+Filename: pysiml-0.2.9.dev202306220657.dist-info/METADATA
 Comment: 
 
-Filename: pysiml-0.2.9.dev202306080855.dist-info/WHEEL
+Filename: pysiml-0.2.9.dev202306220657.dist-info/WHEEL
 Comment: 
 
-Filename: pysiml-0.2.9.dev202306080855.dist-info/entry_points.txt
+Filename: pysiml-0.2.9.dev202306220657.dist-info/entry_points.txt
 Comment: 
 
-Filename: pysiml-0.2.9.dev202306080855.dist-info/RECORD
+Filename: pysiml-0.2.9.dev202306220657.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## pyproject.toml

```diff
@@ -1,10 +1,10 @@
 [tool.poetry]
 name = "pysiml"
-version = "0.2.9.dev202306080855"
+version = "0.2.9.dev202306220657"
 description = "SiML - a Simulation ML library"
 license = "Apache-2.0"
 authors = ["RICOS Co. Ltd."]
 readme = "README.md"
 repository = "https://github.com/ricosjp/pysiml"
 documentation = "https://ricosjp.github.io/pysiml/"
 packages = [
```

## siml/setting.py

```diff
@@ -1153,22 +1153,22 @@
                 raise ValueError(
                     f"Invalid format of preprocess setting: {self}")
         return
 
 
 @dc.dataclass
 class MainSetting:
-    data: DataSetting = DataSetting()
-    conversion: ConversionSetting = ConversionSetting()
+    data: DataSetting = dc.field(default_factory=DataSetting)
+    conversion: ConversionSetting = dc.field(default_factory=ConversionSetting)
     preprocess: dict = dc.field(default_factory=dict)
-    trainer: TrainerSetting = TrainerSetting()
-    inferer: InfererSetting = InfererSetting()
-    model: ModelSetting = ModelSetting()
-    optuna: OptunaSetting = OptunaSetting()
-    study: StudySetting = StudySetting()
+    trainer: TrainerSetting = dc.field(default_factory=TrainerSetting)
+    inferer: InfererSetting = dc.field(default_factory=InfererSetting)
+    model: ModelSetting = dc.field(default_factory=ModelSetting)
+    optuna: OptunaSetting = dc.field(default_factory=OptunaSetting)
+    study: StudySetting = dc.field(default_factory=StudySetting)
     replace_preprocessed: bool = False
     misc: dict = dc.field(default_factory=dict)
 
     @classmethod
     def read_settings_yaml(
         cls,
         settings_yaml: Path,
```

## siml/trainer.py

```diff
@@ -1,11 +1,10 @@
 import enum
 import io
 import time
-import pathlib
 from typing import Callable
 import random
 
 import ignite
 import matplotlib.pyplot as plt
 import numpy as np
 import optuna
@@ -14,25 +13,30 @@
 from torch import Tensor
 from tqdm import tqdm
 import yaml
 
 from . import datasets
 from . import networks
 from . import setting
-from . import siml_manager
 from . import util
 
 from . import update_functions
-from .siml_variables import siml_tensor_variables
 
+from siml.siml_variables import siml_tensor_variables
+from siml.loss_operations import LossCalculatorBuilder
+from siml.services.model_selector import ModelSelectorBuilder
+from siml.services.model_builder import ModelBuilder
+from siml.services.environment import ModelEnvironmentSetting
+from siml.services.training import InnerTrainingSetting
 
-class Trainer(siml_manager.SimlManager):
+
+class Trainer:
 
     def __init__(self,
-                 settings,
+                 main_settings: setting.MainSetting,
                  *,
                  optuna_trial=None,
                  user_loss_function_dic:
                  dict[str, Callable[[Tensor, Tensor], Tensor]] = None):
         """Initialize SimlManager object.
 
         Parameters
@@ -44,30 +48,40 @@
         optuna_trial: optuna.Trial
             Optuna trial object. Used for pruning.
 
         Returns
         --------
         None
         """
-        if isinstance(settings, pathlib.Path) or isinstance(
-                settings, io.TextIOBase):
-            self.setting = setting.MainSetting.read_settings_yaml(
-                settings)
-        elif isinstance(settings, setting.MainSetting):
-            self.setting = settings
-        else:
+
+        if not isinstance(main_settings, setting.MainSetting):
             raise ValueError(
-                f"Unknown type for settings: {settings.__class__}")
+                f"Unknown type for settings: {main_settings.__class__}")
         self.inference_mode = False
         self.user_loss_function_dic = user_loss_function_dic
 
-        self._update_setting_if_needed()
+        inner_setting = InnerTrainingSetting(main_settings=main_settings)
+        # HACK: temporarly hack. Better to handle as a inner setting.
+        self.setting = inner_setting.main_settings
+
         self.optuna_trial = optuna_trial
+        self._env_setting = self._create_model_env_setting()
         return
 
+    def _create_model_env_setting(self) -> ModelEnvironmentSetting:
+        trainer_setting = self.setting.trainer
+        _model_env = ModelEnvironmentSetting(
+            gpu_id=trainer_setting.gpu_id,
+            seed=trainer_setting.seed,
+            data_parallel=trainer_setting.data_parallel,
+            model_parallel=trainer_setting.model_parallel,
+            time_series=trainer_setting.time_series
+        )
+        return _model_env
+
     def train(self):
         """Perform training.
 
         Parameters
         ----------
         None
 
@@ -139,15 +153,15 @@
 
         return validation_loss
 
     def evaluate(self, evaluate_test=False, load_best_model=False):
         if load_best_model:
             self.setting.trainer.pretrain_directory \
                 = self.setting.trainer.output_directory
-            self._load_pretrained_model_if_needed()
+            self.model = self._setup_model()
         train_state = self.evaluator.run(self.train_loader)
         if len(self.validation_loader) > 0:
             validation_state = self.evaluator.run(self.validation_loader)
         else:
             validation_state = None
 
         if evaluate_test:
@@ -169,40 +183,40 @@
     def _display_mergin(self, input_string, reference_string=None):
         if not reference_string:
             reference_string = input_string
         return input_string.ljust(
             len(reference_string) + self.setting.trainer.display_mergin, ' ')
 
     def prepare_training(self, draw=True):
-        self.set_seed()
+        self._env_setting.set_seed()
 
         if len(self.setting.trainer.input_names) == 0:
             raise ValueError('No input_names fed')
         if len(self.setting.trainer.output_names) == 0:
             raise ValueError('No output_names fed')
 
         # Define model
-        self.model = networks.Network(self.setting.model, self.setting.trainer)
+        self.model = self._setup_model()
         if self.setting.trainer.draw_network and draw:
             self.model.draw(self.setting.trainer.output_directory)
 
-        self.element_wise = self._determine_element_wise()
-        self.loss = self._create_loss_function()
+        self.element_wise = self.setting.trainer.determine_element_wise()
+        self.loss = LossCalculatorBuilder.create(
+            trainer_setting=self.setting.trainer,
+            user_loss_function_dic=self.user_loss_function_dic
+        )
 
         # Manage settings
         if self.optuna_trial is None \
                 and self.setting.trainer.prune:
             self.setting.trainer.prune = False
             print('No optuna.trial fed. Set prune = False.')
 
-        self._select_device()
-        self._generate_trainer()
-
         # Manage restart and pretrain
-        self._load_pretrained_model_if_needed()
+        self._generate_trainer()
         self._load_restart_model_if_needed()
 
         # Expand data directories
         self.setting.data.train = self.train_loader.dataset.data_directories
         self.setting.data.validation \
             = self.validation_loader.dataset.data_directories
         self.setting.data.test = self.test_loader.dataset.data_directories
@@ -525,16 +539,16 @@
     ) -> update_functions.IStepUpdateFunction:
         if self.setting.trainer.pseudo_batch_size >= 1:
             return update_functions.PseudoBatchStep(
                 batch_size=self.setting.trainer.pseudo_batch_size,
                 loss_func=self.loss,
                 other_loss_func=self._calculate_other_loss,
                 split_data_func=self._split_data_if_needed,
-                device=self.device,
-                output_device=self.output_device,
+                device=self._env_setting.get_device(),
+                output_device=self._env_setting.get_output_device(),
                 loss_slice=self.setting.trainer.loss_slice,
                 time_series_split=self.setting.trainer.time_series_split,
                 clip_grad_norm=self.setting.trainer.clip_grad_norm,
                 clip_grad_value=self.setting.trainer.clip_grad_value
             )
         elif not self.element_wise \
                 and self.setting.trainer.element_batch_size > 0:
@@ -547,35 +561,35 @@
                 clip_grad_value=self.setting.trainer.clip_grad_value
             )
         else:
             return update_functions.StandardUpdate(
                 loss_func=self.loss,
                 other_loss_func=self._calculate_other_loss,
                 split_data_func=self._split_data_if_needed,
-                device=self.device,
-                output_device=self.output_device,
+                device=self._env_setting.get_device(),
+                output_device=self._env_setting.get_output_device(),
                 loss_slice=self.setting.trainer.loss_slice,
                 time_series_split=self.setting.trainer.time_series_split,
                 clip_grad_norm=self.setting.trainer.clip_grad_norm,
                 clip_grad_value=self.setting.trainer.clip_grad_value
             )
 
     def _create_supervised_trainer(self):
 
         update_function = self._select_step_update_function()
 
         def update_model(engine, batch):
             self.model.train()
             if self.setting.trainer.time_series_split is None:
-                input_device = self.device
-                support_device = self.device
-                output_device = self.output_device
+                input_device = self._env_setting.get_device()
+                support_device = self._env_setting.get_device()
+                output_device = self._env_setting.get_output_device()
             else:
                 input_device = 'cpu'
-                support_device = self.device
+                support_device = self._env_setting.get_device()
                 output_device = 'cpu'
             x, y = self.prepare_batch(
                 batch, device=input_device, output_device=output_device,
                 support_device=support_device,
                 non_blocking=self.setting.trainer.non_blocking)
             loss = update_function(x, y, self.model, self.optimizer)
             if self.setting.trainer.output_stats:
@@ -655,34 +669,35 @@
         return loss
 
     def _create_supervised_evaluator(self):
 
         def _inference(engine, batch):
             self.model.eval()
             if self.setting.trainer.time_series_split_evaluation is None:
-                input_device = self.device
-                support_device = self.device
+                input_device = self._env_setting.get_device()
+                support_device = self._env_setting.get_device()
             else:
                 input_device = 'cpu'
-                support_device = self.device
+                support_device = self._env_setting.get_device()
 
             with torch.no_grad():
                 x, y = self.prepare_batch(
                     batch, device=input_device,
                     output_device='cpu',
                     support_device=support_device,
                     non_blocking=self.setting.trainer.non_blocking)
                 split_xs, split_ys = self._split_data_if_needed(
                     x, y,
                     self.setting.trainer.time_series_split_evaluation)
 
                 y_pred = []
+                device = self._env_setting.get_device()
                 for split_x in split_xs:
                     siml_x = siml_tensor_variables(split_x['x'])
-                    split_x['x'] = siml_x.send(self.device).get_values()
+                    split_x['x'] = siml_x.send(device).get_values()
                     y_pred.append(self.model(split_x))
 
                 if self.setting.trainer.time_series_split_evaluation is None:
                     original_shapes = x['original_shapes']
                 else:
                     cat_x = util.cat_time_series(
                         [split_x['x'] for split_x in split_xs],
@@ -693,15 +708,16 @@
                     y_pred, time_series_keys=self.output_time_series_keys)
 
                 ans_y = util.cat_time_series(
                     split_ys,
                     time_series_keys=self.output_time_series_keys
                 )
                 ans_siml_y = siml_tensor_variables(ans_y)
-                y = ans_siml_y.send(self.output_device).get_values()
+                output_device = self._env_setting.get_output_device()
+                y = ans_siml_y.send(output_device).get_values()
                 return y_pred, y, {
                     'original_shapes': original_shapes,
                     'model': self.model}
 
         evaluator_engine = ignite.engine.Engine(_inference)
 
         metrics = {'loss': ignite.metrics.Loss(self.loss)}
@@ -831,32 +847,46 @@
                 raise ValueError(
                     f"{variable_name} dimension incorrect: "
                     f"{shape} vs {variable_information['dim']}")
         else:
             pass
         return
 
+    def _setup_model(self):
+        model_loader = ModelBuilder(
+            model_setting=self.setting.model,
+            trainer_setting=self.setting.trainer,
+            env_setting=self._env_setting
+        )
+        if self.setting.trainer.pretrain_directory is None:
+            return model_loader.create_initialized()
+
+        selector = ModelSelectorBuilder.create(
+            self.setting.trainer.snapshot_choise_method
+        )
+        snapshot_file = selector.select_model(
+            self.setting.trainer.pretrain_directory)
+
+        return model_loader.create_loaded(
+            snapshot_file.file_path,
+            decrypt_key=self.setting.get_crypt_key()
+        )
+
     def _load_restart_model_if_needed(self):
         if self.setting.trainer.restart_directory is None:
             return
-        snapshot = self._select_snapshot(
-            self.setting.trainer.restart_directory, method='latest')
 
-        key = None
-        if self.setting.trainer.model_key is not None:
-            key = self.setting.trainer.model_key
-        if self.setting.inferer.model_key is not None:
-            key = self.setting.inferer.model_key
-        if snapshot.suffix == '.enc':
-            if key is None:
-                raise ValueError('Feed key to load encrypted model')
-            checkpoint = torch.load(
-                util.decrypt_file(key, snapshot), map_location=self.device)
-        else:
-            checkpoint = torch.load(snapshot, map_location=self.device)
+        selector = ModelSelectorBuilder.create('latest')
+        snapshot_file = selector.select_model(
+            self.setting.trainer.restart_directory
+        )
+        checkpoint = snapshot_file.load(
+            device=self._env_setting.get_device(),
+            decrypt_key=self.setting.get_crypt_key()
+        )
 
         self.model.load_state_dict(checkpoint['model_state_dict'])
         self.optimizer.load_state_dict(checkpoint['optimizer_state_dict'])
         self.trainer.load_state_dict({
             'epoch': checkpoint['epoch'],
             'validation_loss': checkpoint['validation_loss'],
             'seed': self.setting.trainer.seed,
@@ -867,9 +897,9 @@
         if self.setting.trainer.n_epoch == checkpoint['epoch']:
             raise FileExistsError(
                 "Checkpoint at last epoch exists. "
                 "Model to restart has already finished"
             )
 
         # self.loss = checkpoint['loss']
-        print(f"{snapshot} loaded for restart.")
+        print(f"{snapshot_file.file_path} loaded for restart.")
         return
```

## Comparing `pysiml-0.2.9.dev202306080855.dist-info/LICENSE` & `pysiml-0.2.9.dev202306220657.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `pysiml-0.2.9.dev202306080855.dist-info/METADATA` & `pysiml-0.2.9.dev202306220657.dist-info/METADATA`

 * *Files 9% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pysiml
-Version: 0.2.9.dev202306080855
+Version: 0.2.9.dev202306220657
 Summary: SiML - a Simulation ML library
 Home-page: https://github.com/ricosjp/pysiml
 License: Apache-2.0
 Author: RICOS Co. Ltd.
 Requires-Python: >=3.9,<3.10
 Classifier: License :: OSI Approved :: Apache Software License
 Classifier: Programming Language :: Python :: 3
```

## Comparing `pysiml-0.2.9.dev202306080855.dist-info/RECORD` & `pysiml-0.2.9.dev202306220657.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-pyproject.toml,sha256=TUMmGEpgH-Rlqv6v8Rm6_GWw_cAVIj1ocGQgV7fMl8c,1520
+pyproject.toml,sha256=lLsllupURffw1NjzfRuh9a2wjUVzbCWoNaWkuu_Oj-M,1520
 siml/__init__.py,sha256=mC61oSLHO5F6zXHhOrzH51R-vkH0mL4MShhSBiRRe6s,638
 siml/__main__/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 siml/__main__/convert_interim_data.py,sha256=jA6GD7BlnsEjARcln3UBwXlFj64BeFALAmgD1ohBkqo,900
 siml/__main__/convert_raw_data.py,sha256=VNVOyx9lChopF2Q-9OXtN_-MtfBsyjS_JvFwCjdkv0c,1400
 siml/__main__/optimize.py,sha256=6HALn60Mxh4GUiPbSXjvrdpkoQ4NgYSzCHCBRbli4W0,1742
 siml/__main__/plot_losses.py,sha256=0uMsoPN-xR0JhPg0WzSQL5GbD80ovuFO12eVpc0x6Xc,8663
 siml/__main__/prepare_preprocess_converters.py,sha256=w_rzic--RUyISagQOJw_5-oEkOFEKXUN7G1TkTOxd8g,927
@@ -108,30 +108,31 @@
 siml/services/inference/postprocessing/post_fem_data.py,sha256=8apB2-cUyssum_6BOx9uVUhmNNvBjoXRnSWn4w4aJ-A,5603
 siml/services/inference/postprocessing/postprocessor.py,sha256=lnHod9-Wa87QLb4ZMq7cOOeRxFjKQYq4NeuPaTHD6Nk,4979
 siml/services/inference/postprocessing/save_processor.py,sha256=oJVxJJplyH8dLiYIpG1GJWD_Y58RwrnAwlqNt_dLuA0,7052
 siml/services/inference/record_object.py,sha256=9cSmtHyNuVwtQbAxkMoUOhCg7TQ6fgyFFwWqyBJ3Gw4,1082
 siml/services/model_builder.py,sha256=ybQorVluaFo-7gBFftUp4h5GaKCUhUDYfqG2PLl6o8M,2574
 siml/services/model_selector.py,sha256=q2oXdJcujaOa6Y_HFHZ1emxkNaRN00BAGi_kc0zXmvE,4978
 siml/services/path_rules.py,sha256=fPNdpXcf8GZtI6ZfMrEkKcdo0JkxxPNmnvohbY1evI8,7124
-siml/setting.py,sha256=brzjJydqLTzNngj-Lc6BsMGXkk3UGgqzzL_v_oJJWmQ,50226
-siml/siml_manager.py,sha256=HVDMjvFPq81UsKBlbwv7SrBnYE8USqQHfxZ8tb_iD84,11028
+siml/services/training/__init__.py,sha256=AbzAnWrtCsQ-ORTjrOP27OmTxsmXhWKEldP8CPCVwe0,57
+siml/services/training/inner_settings.py,sha256=pTkhRuZptV2sFw3jHnsIkJpm8hI1Hy9bp_tZDh6aTso,2383
+siml/setting.py,sha256=0DQ9_jJ7PCwgLwghIwrJwi0xtVfGr1YcxFQtw9Gt59U,50394
 siml/siml_variables/__init__.py,sha256=Nt8iJ0yLPBJpg1o6K_b5Qr-go5iurvC9FnHxI4lD6eg,163
 siml/siml_variables/array_variables/__init__.py,sha256=Y2syJXtd98L-Z3kRTCOlCEVZffc-xBbuMIS1uv3ekQU,594
 siml/siml_variables/array_variables/interface_wrapper.py,sha256=Wi0GcuEexwx6sqTqVcBCtWo2K7kw_LQN6LOdoXnNFYw,1573
 siml/siml_variables/array_variables/ndarray_wrapper.py,sha256=oNOfbQu_5twQZq9AM_NEWcbswnCzASAEGzCPpUXcujM,1398
 siml/siml_variables/array_variables/sparce_array_wrapper.py,sha256=yyWwfuKHn686-aQemDMIgcig4K9a6XC-HCTYETJS0O8,1809
 siml/siml_variables/tensor_variables/tensor_variables.py,sha256=Nh3W1ft6FbGID7cp88lw2VyVVxTkrx_1ovI_I2DFSX0,4156
 siml/study.py,sha256=VsiEuAiwcC0a1voORjic9RcZcnPVJiBowV-mobS6tAQ,13021
-siml/trainer.py,sha256=ORHxQApG2xluirfsi4jFvZdJf0bdxb_s4OK-qIyc4QI,34886
+siml/trainer.py,sha256=GuS6q7M1hNouTNx_ZzBPCfs_JbFfnwqa-4RmJN-mN0Y,36269
 siml/update_functions/__init__.py,sha256=fQY19xMEhZv7k6flZPBmhIgLl3uHuBWkay-YCFfaY64,211
 siml/update_functions/element_batch_update.py,sha256=93_L9jl4D9lFQXmEX1Lo8l4n3rDf1wdZljPJIQd9rUs,1774
 siml/update_functions/pseudo_batch_update.py,sha256=7PS6SEXOMB57uaJQhZ8VrtEiIkDF59JE1c6yyrKL3YY,3623
 siml/update_functions/standard_update.py,sha256=jIgeQ_c9R1dgcxDQWzx-w5TkJ7naDKmNi_WUFFchxc4,2702
 siml/update_functions/update_interface.py,sha256=O1fGrE21iXckz7NTOTDNlyQ4rll1SQDehdc_Kk5we0Q,429
 siml/util.py,sha256=AzvnYN1svE28ioHGPgMjkpiK35hCA5m5qwFEDb3agHA,23027
 siml/utils/__init__.py,sha256=DVdxWEBXfapWAWNM0jUouKJzru4RyK2ru2QheBmrm_s,37
 siml/utils/fem_data_utils.py,sha256=LDB_MxYPg_WELl6D_az9ikMZxAF5Ml5qKUXR2CnuxvE,7682
-pysiml-0.2.9.dev202306080855.dist-info/LICENSE,sha256=Ok4O8jxCIpLhGZjTNzgBW8V8xITF_SUVEp1juLijZpA,11431
-pysiml-0.2.9.dev202306080855.dist-info/METADATA,sha256=EUbOhQ4SL1BedhhOPJ4Dn2au9QDJx7oBHashtESWmPI,1638
-pysiml-0.2.9.dev202306080855.dist-info/WHEEL,sha256=7Z8_27uaHI_UZAc4Uox4PpBhQ9Y5_modZXWMxtUi4NU,88
-pysiml-0.2.9.dev202306080855.dist-info/entry_points.txt,sha256=zXU0Gd56XeUfgaeG-CGXcYaTpORSU6kVeQ_vVvjIFPs,388
-pysiml-0.2.9.dev202306080855.dist-info/RECORD,,
+pysiml-0.2.9.dev202306220657.dist-info/LICENSE,sha256=Ok4O8jxCIpLhGZjTNzgBW8V8xITF_SUVEp1juLijZpA,11431
+pysiml-0.2.9.dev202306220657.dist-info/METADATA,sha256=kWhJ6Yj0kslZmNa1slwoGhuR8FmLxGG1oesoFk24ucg,1638
+pysiml-0.2.9.dev202306220657.dist-info/WHEEL,sha256=7Z8_27uaHI_UZAc4Uox4PpBhQ9Y5_modZXWMxtUi4NU,88
+pysiml-0.2.9.dev202306220657.dist-info/entry_points.txt,sha256=zXU0Gd56XeUfgaeG-CGXcYaTpORSU6kVeQ_vVvjIFPs,388
+pysiml-0.2.9.dev202306220657.dist-info/RECORD,,
```

